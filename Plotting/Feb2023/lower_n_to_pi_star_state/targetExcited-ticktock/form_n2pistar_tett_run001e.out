Rank =    0  Free Memory = 90544 MB
Rank =    1  Free Memory = 90544 MB
Rank =    2  Free Memory = 90544 MB
Rank =    3  Free Memory = 90544 MB
Rank =    4  Free Memory = 90543 MB
Rank =    5  Free Memory = 90543 MB
Rank =    6  Free Memory = 90542 MB
Rank =    7  Free Memory = 90542 MB
Rank =    8  Free Memory = 90542 MB
Rank =    9  Free Memory = 90542 MB
Rank =   10  Free Memory = 90542 MB
Rank =   11  Free Memory = 90542 MB
Rank =   12  Free Memory = 90542 MB
Rank =   13  Free Memory = 90542 MB
Rank =   14  Free Memory = 90541 MB
Rank =   15  Free Memory = 90529 MB
Rank =   16  Free Memory = 90528 MB
Rank =   17  Free Memory = 90528 MB
Rank =   18  Free Memory = 90528 MB
Rank =   19  Free Memory = 90528 MB
Rank =   20  Free Memory = 90528 MB
Rank =   21  Free Memory = 90528 MB
Rank =   22  Free Memory = 90527 MB
Rank =   23  Free Memory = 90527 MB
Rank =   24  Free Memory = 90527 MB
Rank =   25  Free Memory = 90527 MB
Rank =   26  Free Memory = 90527 MB
Rank =   27  Free Memory = 90527 MB
Rank =   28  Free Memory = 90527 MB
Rank =   29  Free Memory = 90527 MB
Rank =   30  Free Memory = 90527 MB
Rank =   31  Free Memory = 90527 MB
Rank =   32  Free Memory = 89612 MB
Rank =   33  Free Memory = 89612 MB
Rank =   34  Free Memory = 89612 MB
Rank =   35  Free Memory = 89612 MB
Rank =   36  Free Memory = 89612 MB
Rank =   37  Free Memory = 89612 MB
Rank =   38  Free Memory = 89612 MB
Rank =   39  Free Memory = 89612 MB
Rank =   40  Free Memory = 89612 MB
Rank =   41  Free Memory = 89612 MB
Rank =   42  Free Memory = 89612 MB
Rank =   43  Free Memory = 89612 MB
Rank =   44  Free Memory = 89612 MB
Rank =   45  Free Memory = 89612 MB
Rank =   46  Free Memory = 89612 MB
Rank =   47  Free Memory = 89612 MB
Rank =   48  Free Memory = 89612 MB
Rank =   49  Free Memory = 89612 MB
Rank =   50  Free Memory = 89612 MB
Rank =   51  Free Memory = 89612 MB
Rank =   52  Free Memory = 89612 MB
Rank =   53  Free Memory = 89612 MB
Rank =   54  Free Memory = 89612 MB
Rank =   55  Free Memory = 89612 MB
Rank =   56  Free Memory = 89612 MB
Rank =   57  Free Memory = 89612 MB
Rank =   58  Free Memory = 89612 MB
Rank =   59  Free Memory = 89612 MB
Rank =   60  Free Memory = 89612 MB
Rank =   61  Free Memory = 89612 MB
Rank =   62  Free Memory = 89612 MB
Rank =   63  Free Memory = 89612 MB
Rank =   64  Free Memory = 83452 MB
Rank =   65  Free Memory = 83452 MB
Rank =   66  Free Memory = 83452 MB
Rank =   67  Free Memory = 83452 MB
Rank =   68  Free Memory = 83452 MB
Rank =   69  Free Memory = 83452 MB
Rank =   70  Free Memory = 83452 MB
Rank =   71  Free Memory = 83452 MB
Rank =   72  Free Memory = 83452 MB
Rank =   73  Free Memory = 83452 MB
Rank =   74  Free Memory = 83452 MB
Rank =   75  Free Memory = 83452 MB
Rank =   76  Free Memory = 83452 MB
Rank =   77  Free Memory = 83451 MB
Rank =   78  Free Memory = 83451 MB
Rank =   79  Free Memory = 83451 MB
Rank =   80  Free Memory = 83451 MB
Rank =   81  Free Memory = 83451 MB
Rank =   82  Free Memory = 83451 MB
Rank =   83  Free Memory = 83451 MB
Rank =   84  Free Memory = 83451 MB
Rank =   85  Free Memory = 83451 MB
Rank =   86  Free Memory = 83451 MB
Rank =   87  Free Memory = 83451 MB
Rank =   88  Free Memory = 83451 MB
Rank =   89  Free Memory = 83451 MB
Rank =   90  Free Memory = 83451 MB
Rank =   91  Free Memory = 83451 MB
Rank =   92  Free Memory = 83451 MB
Rank =   93  Free Memory = 83451 MB
Rank =   94  Free Memory = 83451 MB
Rank =   95  Free Memory = 83451 MB
Rank =   96  Free Memory = 89787 MB
Rank =   97  Free Memory = 89786 MB
Rank =   98  Free Memory = 89786 MB
Rank =   99  Free Memory = 89786 MB
Rank =  100  Free Memory = 89786 MB
Rank =  101  Free Memory = 89786 MB
Rank =  102  Free Memory = 89786 MB
Rank =  103  Free Memory = 89786 MB
Rank =  104  Free Memory = 89786 MB
Rank =  105  Free Memory = 89786 MB
Rank =  106  Free Memory = 89786 MB
Rank =  107  Free Memory = 89786 MB
Rank =  108  Free Memory = 89786 MB
Rank =  109  Free Memory = 89786 MB
Rank =  110  Free Memory = 89786 MB
Rank =  111  Free Memory = 89786 MB
Rank =  112  Free Memory = 89786 MB
Rank =  113  Free Memory = 89786 MB
Rank =  114  Free Memory = 89786 MB
Rank =  115  Free Memory = 89786 MB
Rank =  116  Free Memory = 89786 MB
Rank =  117  Free Memory = 89786 MB
Rank =  118  Free Memory = 89786 MB
Rank =  119  Free Memory = 89786 MB
Rank =  120  Free Memory = 89786 MB
Rank =  121  Free Memory = 89786 MB
Rank =  122  Free Memory = 89786 MB
Rank =  123  Free Memory = 89786 MB
Rank =  124  Free Memory = 89786 MB
Rank =  125  Free Memory = 89786 MB
Rank =  126  Free Memory = 89786 MB
Rank =  127  Free Memory = 89786 MB
  Input file(s): opt_form_n2pistar_tett_run001e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_tett_run001e.xml

  Project = FORM
  date    = 2023-03-10 17:59:38 PST
  host    = n0068.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 138

  Range of prime numbers to use as seeds over processors and threads = 809-1721


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.376605e-01    1         1 OFF
     uu_1                 1.767718e-01    1         1 OFF
     uu_2                 7.723728e-02    1         1 OFF
     uu_3                 1.710004e-02    1         1 OFF
     uu_4                -1.910459e-02    1         1 OFF
     uu_5                -4.280304e-02    1         1 OFF
     uu_6                -5.785204e-02    1         1 OFF
     uu_7                -6.393266e-02    1         1 OFF
     uu_8                -5.909684e-02    1         1 OFF
     uu_9                -4.158284e-02    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.949806e-01    1         1 OFF
     ud_1                 1.544390e-01    1         1 OFF
     ud_2                 3.547833e-02    1         1 OFF
     ud_3                -2.628345e-02    1         1 OFF
     ud_4                -6.009293e-02    1         1 OFF
     ud_5                -7.932808e-02    1         1 OFF
     ud_6                -8.808073e-02    1         1 OFF
     ud_7                -8.737226e-02    1         1 OFF
     ud_8                -7.743479e-02    1         1 OFF
     ud_9                -5.391827e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -4.823946e-01    1         1 OFF
     eC_1                -3.665890e-01    1         1 OFF
     eC_2                -1.701695e-01    1         1 OFF
     eC_3                -7.185681e-02    1         1 OFF
     eC_4                -5.170423e-02    1         1 OFF
     eC_5                 3.187715e-02    1         1 OFF
     eC_6                 1.415405e-01    1         1 OFF
     eC_7                 3.067080e-01    1         1 OFF
     eC_8                 4.123941e-01    1         1 OFF
     eC_9                 2.340638e-01    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.052897e+00    1         1 OFF
     eO_1                -7.482421e-01    1         1 OFF
     eO_2                -3.414708e-01    1         1 OFF
     eO_3                -4.201517e-02    1         1 OFF
     eO_4                 1.479195e-01    1         1 OFF
     eO_5                 3.007146e-01    1         1 OFF
     eO_6                 3.501199e-01    1         1 OFF
     eO_7                 3.647544e-01    1         1 OFF
     eO_8                 3.143343e-01    1         1 OFF
     eO_9                 3.237420e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.436100e-01    1         1 OFF
     eH1_1                -1.410507e-01    1         1 OFF
     eH1_2                -9.420369e-02    1         1 OFF
     eH1_3                -6.742883e-02    1         1 OFF
     eH1_4                 7.012899e-03    1         1 OFF
     eH1_5                 6.648303e-02    1         1 OFF
     eH1_6                 1.029657e-01    1         1 OFF
     eH1_7                 7.841590e-02    1         1 OFF
     eH1_8                 4.345977e-02    1         1 OFF
     eH1_9                 1.390192e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.403491e-01    1         1 OFF
     eH2_1                -1.394467e-01    1         1 OFF
     eH2_2                -9.471563e-02    1         1 OFF
     eH2_3                -6.879321e-02    1         1 OFF
     eH2_4                 5.917577e-03    1         1 OFF
     eH2_5                 6.770113e-02    1         1 OFF
     eH2_6                 1.052555e-01    1         1 OFF
     eH2_7                 7.452344e-02    1         1 OFF
     eH2_8                 3.347000e-02    1         1 OFF
     eH2_9                -2.106280e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.000220e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.1654e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6251
    reference variance = 0.356256
====================================================
  Execution time = 2.6906e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.4496e-01
  Total weights = 1.955381946e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436767985098
                                         uncertainty =       0.001993883355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436767985098
                                         uncertainty =       0.001993883355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467307178
  error estimate for blocks of size 2^( 2) =       0.000491675316
  error estimate for blocks of size 2^( 3) =       0.000513415815
  error estimate for blocks of size 2^( 4) =       0.000529016949
  error estimate for blocks of size 2^( 5) =       0.000537488438
  error estimate for blocks of size 2^( 6) =       0.000541851127
  error estimate for blocks of size 2^( 7) =       0.000547058713

      target function =      -0.749418382248
              le_mean =     -22.659848929331
             les_mean =     513.913716139933
             stat err =       0.000538853807
             autocorr =       1.329648983122
   target nu stat err =       0.000538853807
   target dn stat err =       0.002310240735
      target stat err =       0.001998102359
              std dev =       0.660872149363
             le_variance =       0.436751997804


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.265984892933e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749422768434       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749464359153       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749472277349       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749474501498       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749475119066       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749475101235       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749475023520       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749475029711       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749475081499       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749475145125       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749475109793       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749475120018       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 5.686578e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749422768434       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749434598956       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749436742206       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749437324268       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749437472768       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749437458965       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749437438914       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749437440478       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749437454509       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749437465708       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749437458031       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749437459935       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 1.591943e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749422768434       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749425831585       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749426378349       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749426525354       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749426561887       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749426557804       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749426552804       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749426553216       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749426556787       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749426559246       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749426557438       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 4.101809e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1777e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001 -7.019827e-01                3 1 ON  0
ci_002 -7.059911e-01                3 1 ON  1
ci_003 -5.333698e-02                3 1 ON  2
ci_004 -5.433432e-02                3 1 ON  3
ci_005 1.966095e-02                 3 1 ON  4
ci_006 1.978256e-02                 3 1 ON  5
ci_007 1.603951e-02                 3 1 ON  6
ci_008 1.590183e-02                 3 1 ON  7
ci_009 -1.225092e-02                3 1 ON  8
ci_010 -1.262678e-02                3 1 ON  9
ci_011 -9.690578e-03                3 1 ON  10
ci_012 -9.847298e-03                3 1 ON  11
ci_013 8.861733e-03                 3 1 ON  12
ci_014 8.805447e-03                 3 1 ON  13
ci_015 9.296596e-03                 3 1 ON  14
ci_016 9.567655e-03                 3 1 ON  15
ci_017 8.663991e-03                 3 1 ON  16
ci_018 8.255308e-03                 3 1 ON  17
ci_019 -1.355211e-03                3 1 ON  18
ci_020 -1.210573e-03                3 1 ON  19
ci_021 -1.046556e-02                3 1 ON  20
ci_022 -1.113934e-02                3 1 ON  21
ci_023 5.516407e-03                 3 1 ON  22
ci_024 5.221751e-03                 3 1 ON  23
ci_025 1.292220e-02                 3 1 ON  24
ci_026 1.253762e-02                 3 1 ON  25
ci_027 6.269518e-03                 3 1 ON  26
ci_028 6.243335e-03                 3 1 ON  27
ci_029 -3.683198e-03                3 1 ON  28
ci_030 -4.436195e-03                3 1 ON  29
ci_031 4.128873e-03                 3 1 ON  30
ci_032 3.707659e-03                 3 1 ON  31
ci_033 3.413229e-03                 3 1 ON  32
ci_034 3.376585e-03                 3 1 ON  33
ci_035 2.236371e-03                 3 1 ON  34
ci_036 2.122270e-03                 3 1 ON  35
ci_037 3.421575e-03                 3 1 ON  36
ci_038 3.310468e-03                 3 1 ON  37
ci_039 4.295657e-03                 3 1 ON  38
ci_040 4.412830e-03                 3 1 ON  39
ci_041 2.814462e-03                 3 1 ON  40
ci_042 2.887643e-03                 3 1 ON  41
ci_043 3.481344e-03                 3 1 ON  42
ci_044 3.152211e-03                 3 1 ON  43
ci_045 2.553361e-03                 3 1 ON  44
ci_046 2.932486e-03                 3 1 ON  45
ci_047 -9.938368e-04                3 1 ON  46
ci_048 -1.143813e-03                3 1 ON  47
ci_049 6.978293e-04                 3 1 ON  48
ci_050 7.667159e-04                 3 1 ON  49
ci_051 -1.507923e-03                3 1 ON  50
ci_052 -1.366103e-03                3 1 ON  51
ci_053 -2.561268e-03                3 1 ON  52
ci_054 -2.660138e-03                3 1 ON  53
ci_055 -1.600369e-03                3 1 ON  54
ci_056 -1.301335e-03                3 1 ON  55
ci_057 -1.005217e-03                3 1 ON  56
ci_058 -9.658836e-04                3 1 ON  57
ci_059 -3.710564e-04                3 1 ON  58
ci_060 -2.137374e-04                3 1 ON  59
ci_061 -6.616818e-04                3 1 ON  60
ci_062 -4.675076e-04                3 1 ON  61
ci_063 -6.451096e-04                3 1 ON  62
ci_064 -7.977641e-04                3 1 ON  63
ci_065 -1.759429e-03                3 1 ON  64
ci_066 -1.699351e-03                3 1 ON  65
ci_067 -1.635393e-03                3 1 ON  66
ci_068 -1.594657e-03                3 1 ON  67
ci_069 -4.344632e-05                3 1 ON  68
ci_070 1.303297e-04                 3 1 ON  69
ci_071 -1.508847e-03                3 1 ON  70
ci_072 -1.936294e-03                3 1 ON  71
ci_073 1.047673e-04                 3 1 ON  72
ci_074 1.537452e-04                 3 1 ON  73
ci_075 1.198643e-04                 3 1 ON  74
ci_076 2.310633e-04                 3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.7119
    reference variance = 0.562187
====================================================
  Execution time = 2.5603e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4918e-01
  Total weights = 1.9553e+06
  Execution time = 3.6151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439485481791
                                         uncertainty =       0.002058381821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439485481791
                                         uncertainty =       0.002058381821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468739995
  error estimate for blocks of size 2^( 2) =       0.000492453510
  error estimate for blocks of size 2^( 3) =       0.000514782999
  error estimate for blocks of size 2^( 4) =       0.000530959334
  error estimate for blocks of size 2^( 5) =       0.000541015145
  error estimate for blocks of size 2^( 6) =       0.000546307782
  error estimate for blocks of size 2^( 7) =       0.000545287729

      target function =      -0.745711541104
              le_mean =     -22.661175123264
             les_mean =     513.978353955193
             stat err =       0.000540892497
             autocorr =       1.331551269292
   target nu stat err =       0.000540892497
   target dn stat err =       0.002578792626
      target stat err =       0.002194697346
              std dev =       0.662898458063
             le_variance =       0.439434365702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439425580890
                                         uncertainty =       0.002058352664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439425580890
                                         uncertainty =       0.002058352664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468708021
  error estimate for blocks of size 2^( 2) =       0.000492433036
  error estimate for blocks of size 2^( 3) =       0.000514770164
  error estimate for blocks of size 2^( 4) =       0.000530947852
  error estimate for blocks of size 2^( 5) =       0.000541007137
  error estimate for blocks of size 2^( 6) =       0.000546301255
  error estimate for blocks of size 2^( 7) =       0.000545273046

      target function =      -0.745823938985
              le_mean =     -22.661182248815
             les_mean =     513.978539758210
             stat err =       0.000540882322
             autocorr =       1.331682840420
   target nu stat err =       0.000540882322
   target dn stat err =       0.002595736949
      target stat err =       0.002208725865
              std dev =       0.662853240328
             le_variance =       0.439374418213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439445717273
                                         uncertainty =       0.002058327387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439445717273
                                         uncertainty =       0.002058327387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468718776
  error estimate for blocks of size 2^( 2) =       0.000492438790
  error estimate for blocks of size 2^( 3) =       0.000514772839
  error estimate for blocks of size 2^( 4) =       0.000530950082
  error estimate for blocks of size 2^( 5) =       0.000541008077
  error estimate for blocks of size 2^( 6) =       0.000546301345
  error estimate for blocks of size 2^( 7) =       0.000545276491

      target function =      -0.746044074266
              le_mean =     -22.661178418748
             les_mean =     513.978097667162
             stat err =       0.000540883999
             autocorr =       1.331629985301
   target nu stat err =       0.000540883999
   target dn stat err =       0.002577455696
      target stat err =       0.002195536139
              std dev =       0.662868449498
             le_variance =       0.439394581340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439479545128
                                         uncertainty =       0.002058362257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439479545128
                                         uncertainty =       0.002058362257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468736828
  error estimate for blocks of size 2^( 2) =       0.000492451205
  error estimate for blocks of size 2^( 3) =       0.000514781329
  error estimate for blocks of size 2^( 4) =       0.000530957635
  error estimate for blocks of size 2^( 5) =       0.000541013829
  error estimate for blocks of size 2^( 6) =       0.000546306817
  error estimate for blocks of size 2^( 7) =       0.000545285967

      target function =      -0.724335784840
              le_mean =     -22.661175518542
             les_mean =     514.004497390411
             stat err =       0.000540891062
             autocorr =       1.331562195244
   target nu stat err =       0.000540891062
   target dn stat err =       0.026393490318
      target stat err =       0.020425601689
              std dev =       0.662893979005
             le_variance =       0.439428427401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745711541104        initial
     2.5000e-01     2.5000e+00             5.6866e-04        -0.745823938985
     1.0000e+00     1.0000e+01             1.5919e-04        -0.746044074266  <--
     4.0000e+00     4.0000e+01             4.1018e-05        -0.724335784840

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.3849e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
ci_001                -7.019827e-01 3 1  ON 0
ci_002                -7.059911e-01 3 1  ON 1
ci_003                -5.333698e-02 3 1  ON 2
ci_004                -5.433432e-02 3 1  ON 3
ci_005                 1.966095e-02 3 1  ON 4
ci_006                 1.978256e-02 3 1  ON 5
ci_007                 1.603951e-02 3 1  ON 6
ci_008                 1.590183e-02 3 1  ON 7
ci_009                -1.225092e-02 3 1  ON 8
ci_010                -1.262678e-02 3 1  ON 9
ci_011                -9.690578e-03 3 1  ON 10
ci_012                -9.847298e-03 3 1  ON 11
ci_013                 8.861733e-03 3 1  ON 12
ci_014                 8.805447e-03 3 1  ON 13
ci_015                 9.296596e-03 3 1  ON 14
ci_016                 9.567655e-03 3 1  ON 15
ci_017                 8.663991e-03 3 1  ON 16
ci_018                 8.255308e-03 3 1  ON 17
ci_019                -1.355211e-03 3 1  ON 18
ci_020                -1.210573e-03 3 1  ON 19
ci_021                -1.046556e-02 3 1  ON 20
ci_022                -1.113934e-02 3 1  ON 21
ci_023                 5.516407e-03 3 1  ON 22
ci_024                 5.221751e-03 3 1  ON 23
ci_025                 1.292220e-02 3 1  ON 24
ci_026                 1.253762e-02 3 1  ON 25
ci_027                 6.269518e-03 3 1  ON 26
ci_028                 6.243335e-03 3 1  ON 27
ci_029                -3.683198e-03 3 1  ON 28
ci_030                -4.436195e-03 3 1  ON 29
ci_031                 4.128873e-03 3 1  ON 30
ci_032                 3.707659e-03 3 1  ON 31
ci_033                 3.413229e-03 3 1  ON 32
ci_034                 3.376585e-03 3 1  ON 33
ci_035                 2.236371e-03 3 1  ON 34
ci_036                 2.122270e-03 3 1  ON 35
ci_037                 3.421575e-03 3 1  ON 36
ci_038                 3.310468e-03 3 1  ON 37
ci_039                 4.295657e-03 3 1  ON 38
ci_040                 4.412830e-03 3 1  ON 39
ci_041                 2.814462e-03 3 1  ON 40
ci_042                 2.887643e-03 3 1  ON 41
ci_043                 3.481344e-03 3 1  ON 42
ci_044                 3.152211e-03 3 1  ON 43
ci_045                 2.553361e-03 3 1  ON 44
ci_046                 2.932486e-03 3 1  ON 45
ci_047                -9.938368e-04 3 1  ON 46
ci_048                -1.143813e-03 3 1  ON 47
ci_049                 6.978293e-04 3 1  ON 48
ci_050                 7.667159e-04 3 1  ON 49
ci_051                -1.507923e-03 3 1  ON 50
ci_052                -1.366103e-03 3 1  ON 51
ci_053                -2.561268e-03 3 1  ON 52
ci_054                -2.660138e-03 3 1  ON 53
ci_055                -1.600369e-03 3 1  ON 54
ci_056                -1.301335e-03 3 1  ON 55
ci_057                -1.005217e-03 3 1  ON 56
ci_058                -9.658836e-04 3 1  ON 57
ci_059                -3.710564e-04 3 1  ON 58
ci_060                -2.137374e-04 3 1  ON 59
ci_061                -6.616818e-04 3 1  ON 60
ci_062                -4.675076e-04 3 1  ON 61
ci_063                -6.451096e-04 3 1  ON 62
ci_064                -7.977641e-04 3 1  ON 63
ci_065                -1.759429e-03 3 1  ON 64
ci_066                -1.699351e-03 3 1  ON 65
ci_067                -1.635393e-03 3 1  ON 66
ci_068                -1.594657e-03 3 1  ON 67
ci_069                -4.344632e-05 3 1  ON 68
ci_070                 1.303297e-04 3 1  ON 69
ci_071                -1.508847e-03 3 1  ON 70
ci_072                -1.936294e-03 3 1  ON 71
ci_073                 1.047673e-04 3 1  ON 72
ci_074                 1.537452e-04 3 1  ON 73
ci_075                 1.198643e-04 3 1  ON 74
ci_076                 2.310633e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5653e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6486
    reference variance = 1.09534
====================================================
  Execution time = 2.6222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4768e-01
  Total weights = 1.955173674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438784615018
                                         uncertainty =       0.002069347700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438784615018
                                         uncertainty =       0.002069347700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468380721
  error estimate for blocks of size 2^( 2) =       0.000492441364
  error estimate for blocks of size 2^( 3) =       0.000515239459
  error estimate for blocks of size 2^( 4) =       0.000531764929
  error estimate for blocks of size 2^( 5) =       0.000541887878
  error estimate for blocks of size 2^( 6) =       0.000546124206
  error estimate for blocks of size 2^( 7) =       0.000546645518

      target function =      -0.747215912561
              le_mean =     -22.661940304764
             les_mean =     514.011216016432
             stat err =       0.000541605633
             autocorr =       1.337113654159
   target nu stat err =       0.000541605633
   target dn stat err =       0.002537317211
      target stat err =       0.002173073931
              std dev =       0.662390367670
             le_variance =       0.438760999183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266194030476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747221346991       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747286965199       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747301783545       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747303460778       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747304124326       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747304832019       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747305097938       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747305203790       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747305153358       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747305135528       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747305134549       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747305133152       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 6.619575e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747221346991       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747240035713       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747244034025       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747244468303       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747244628444       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747244795536       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747244848623       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747244869367       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747244855414       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747244850821       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747244850951       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747244850735       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 1.842103e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747221346991       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747226187655       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747227206741       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747227316094       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747227355574       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747227396562       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747227408949       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747227413763       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747227410215       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747227409083       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747227409138       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747227409092       residual = 1.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 4.739589e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1018e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.021249e-01 3 1  ON 0
ci_002                -7.058785e-01 3 1  ON 1
ci_003                -5.327531e-02 3 1  ON 2
ci_004                -5.419459e-02 3 1  ON 3
ci_005                 1.957671e-02 3 1  ON 4
ci_006                 1.970895e-02 3 1  ON 5
ci_007                 1.594378e-02 3 1  ON 6
ci_008                 1.575756e-02 3 1  ON 7
ci_009                -1.220880e-02 3 1  ON 8
ci_010                -1.254831e-02 3 1  ON 9
ci_011                -9.698582e-03 3 1  ON 10
ci_012                -9.771883e-03 3 1  ON 11
ci_013                 8.765823e-03 3 1  ON 12
ci_014                 8.779070e-03 3 1  ON 13
ci_015                 9.194745e-03 3 1  ON 14
ci_016                 9.494793e-03 3 1  ON 15
ci_017                 8.640495e-03 3 1  ON 16
ci_018                 8.210182e-03 3 1  ON 17
ci_019                -1.465532e-03 3 1  ON 18
ci_020                -1.295390e-03 3 1  ON 19
ci_021                -1.064977e-02 3 1  ON 20
ci_022                -1.115035e-02 3 1  ON 21
ci_023                 5.519974e-03 3 1  ON 22
ci_024                 5.171733e-03 3 1  ON 23
ci_025                 1.294593e-02 3 1  ON 24
ci_026                 1.257754e-02 3 1  ON 25
ci_027                 6.314183e-03 3 1  ON 26
ci_028                 6.244725e-03 3 1  ON 27
ci_029                -3.748798e-03 3 1  ON 28
ci_030                -4.401738e-03 3 1  ON 29
ci_031                 4.283834e-03 3 1  ON 30
ci_032                 3.738874e-03 3 1  ON 31
ci_033                 3.477446e-03 3 1  ON 32
ci_034                 3.337228e-03 3 1  ON 33
ci_035                 2.222391e-03 3 1  ON 34
ci_036                 2.055125e-03 3 1  ON 35
ci_037                 3.342842e-03 3 1  ON 36
ci_038                 3.327808e-03 3 1  ON 37
ci_039                 4.302347e-03 3 1  ON 38
ci_040                 4.390835e-03 3 1  ON 39
ci_041                 2.801046e-03 3 1  ON 40
ci_042                 2.899423e-03 3 1  ON 41
ci_043                 3.486843e-03 3 1  ON 42
ci_044                 3.147271e-03 3 1  ON 43
ci_045                 2.516002e-03 3 1  ON 44
ci_046                 2.879164e-03 3 1  ON 45
ci_047                -9.316278e-04 3 1  ON 46
ci_048                -1.132855e-03 3 1  ON 47
ci_049                 6.475033e-04 3 1  ON 48
ci_050                 7.689196e-04 3 1  ON 49
ci_051                -1.466888e-03 3 1  ON 50
ci_052                -1.280800e-03 3 1  ON 51
ci_053                -2.582215e-03 3 1  ON 52
ci_054                -2.744758e-03 3 1  ON 53
ci_055                -1.553159e-03 3 1  ON 54
ci_056                -1.332978e-03 3 1  ON 55
ci_057                -1.008734e-03 3 1  ON 56
ci_058                -9.533216e-04 3 1  ON 57
ci_059                -3.660678e-04 3 1  ON 58
ci_060                -3.036193e-04 3 1  ON 59
ci_061                -6.473775e-04 3 1  ON 60
ci_062                -5.052465e-04 3 1  ON 61
ci_063                -6.733104e-04 3 1  ON 62
ci_064                -7.558665e-04 3 1  ON 63
ci_065                -1.681384e-03 3 1  ON 64
ci_066                -1.660275e-03 3 1  ON 65
ci_067                -1.651594e-03 3 1  ON 66
ci_068                -1.511637e-03 3 1  ON 67
ci_069                -2.575784e-05 3 1  ON 68
ci_070                 8.247119e-05 3 1  ON 69
ci_071                -1.462335e-03 3 1  ON 70
ci_072                -1.930852e-03 3 1  ON 71
ci_073                 6.338530e-05 3 1  ON 72
ci_074                 1.884790e-04 3 1  ON 73
ci_075                 8.321069e-05 3 1  ON 74
ci_076                 2.600279e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6959
    reference variance = 0.351704
====================================================
  Execution time = 2.5563e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5537e-01
  Total weights = 1.9549e+06
  Execution time = 3.6068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443509072235
                                         uncertainty =       0.002012156083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443509072235
                                         uncertainty =       0.002012156083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470942819
  error estimate for blocks of size 2^( 2) =       0.000495330320
  error estimate for blocks of size 2^( 3) =       0.000517664934
  error estimate for blocks of size 2^( 4) =       0.000533334314
  error estimate for blocks of size 2^( 5) =       0.000543522656
  error estimate for blocks of size 2^( 6) =       0.000547914133
  error estimate for blocks of size 2^( 7) =       0.000550830753

      target function =      -0.740926327427
              le_mean =     -22.660626519757
             les_mean =     513.959360348347
             stat err =       0.000543900464
             autocorr =       1.333836200310
   target nu stat err =       0.000543900464
   target dn stat err =       0.003195137946
      target stat err =       0.002649375239
              std dev =       0.666013722115
             le_variance =       0.443574278045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443553775754
                                         uncertainty =       0.002019798327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443553775754
                                         uncertainty =       0.002019798327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470966020
  error estimate for blocks of size 2^( 2) =       0.000495372857
  error estimate for blocks of size 2^( 3) =       0.000517717129
  error estimate for blocks of size 2^( 4) =       0.000533386440
  error estimate for blocks of size 2^( 5) =       0.000543583974
  error estimate for blocks of size 2^( 6) =       0.000547977938
  error estimate for blocks of size 2^( 7) =       0.000550905764

      target function =      -0.740494616464
              le_mean =     -22.660630104591
             les_mean =     513.960056784884
             stat err =       0.000543963529
             autocorr =       1.334014089328
   target nu stat err =       0.000543963529
   target dn stat err =       0.003278262568
      target stat err =       0.002711830886
              std dev =       0.666046533450
             le_variance =       0.443617984720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525198748
                                         uncertainty =       0.002016306632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443525198748
                                         uncertainty =       0.002016306632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470951067
  error estimate for blocks of size 2^( 2) =       0.000495349500
  error estimate for blocks of size 2^( 3) =       0.000517689704
  error estimate for blocks of size 2^( 4) =       0.000533359024
  error estimate for blocks of size 2^( 5) =       0.000543552308
  error estimate for blocks of size 2^( 6) =       0.000547945431
  error estimate for blocks of size 2^( 7) =       0.000550868171

      target function =      -0.740821589435
              le_mean =     -22.660627354556
             les_mean =     513.959527532376
             stat err =       0.000543931233
             autocorr =       1.333940397772
   target nu stat err =       0.000543931233
   target dn stat err =       0.003235170676
      target stat err =       0.002680187613
              std dev =       0.666025385696
             le_variance =       0.443589814391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443509860955
                                         uncertainty =       0.002012663951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443509860955
                                         uncertainty =       0.002012663951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470943196
  error estimate for blocks of size 2^( 2) =       0.000495332111
  error estimate for blocks of size 2^( 3) =       0.000517667453
  error estimate for blocks of size 2^( 4) =       0.000533336871
  error estimate for blocks of size 2^( 5) =       0.000543525824
  error estimate for blocks of size 2^( 6) =       0.000547917460
  error estimate for blocks of size 2^( 7) =       0.000550834924

      target function =      -0.740953210246
              le_mean =     -22.660626441690
             les_mean =     513.959323518134
             stat err =       0.000543903770
             autocorr =       1.333850280132
   target nu stat err =       0.000543903770
   target dn stat err =       0.003198917813
      target stat err =       0.002652540647
              std dev =       0.666014254667
             le_variance =       0.443574987419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740926327427        initial
     2.5000e-01     2.5000e+00             6.6196e-04        -0.740494616464
     1.0000e+00     1.0000e+01             1.8421e-04        -0.740821589435
     4.0000e+00     4.0000e+01             4.7396e-05        -0.740953210246  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3850e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
ci_001                -7.020183e-01 3 1  ON 0
ci_002                -7.059630e-01 3 1  ON 1
ci_003                -5.332131e-02 3 1  ON 2
ci_004                -5.429907e-02 3 1  ON 3
ci_005                 1.963904e-02 3 1  ON 4
ci_006                 1.976348e-02 3 1  ON 5
ci_007                 1.601482e-02 3 1  ON 6
ci_008                 1.586463e-02 3 1  ON 7
ci_009                -1.223999e-02 3 1  ON 8
ci_010                -1.260650e-02 3 1  ON 9
ci_011                -9.692625e-03 3 1  ON 10
ci_012                -9.827856e-03 3 1  ON 11
ci_013                 8.836984e-03 3 1  ON 12
ci_014                 8.798576e-03 3 1  ON 13
ci_015                 9.270358e-03 3 1  ON 14
ci_016                 9.548941e-03 3 1  ON 15
ci_017                 8.657909e-03 3 1  ON 16
ci_018                 8.243663e-03 3 1  ON 17
ci_019                -1.383626e-03 3 1  ON 18
ci_020                -1.232411e-03 3 1  ON 19
ci_021                -1.051296e-02 3 1  ON 20
ci_022                -1.114219e-02 3 1  ON 21
ci_023                 5.517331e-03 3 1  ON 22
ci_024                 5.208797e-03 3 1  ON 23
ci_025                 1.292825e-02 3 1  ON 24
ci_026                 1.254789e-02 3 1  ON 25
ci_027                 6.281104e-03 3 1  ON 26
ci_028                 6.243700e-03 3 1  ON 27
ci_029                -3.700114e-03 3 1  ON 28
ci_030                -4.427326e-03 3 1  ON 29
ci_031                 4.168720e-03 3 1  ON 30
ci_032                 3.715703e-03 3 1  ON 31
ci_033                 3.429761e-03 3 1  ON 32
ci_034                 3.366424e-03 3 1  ON 33
ci_035                 2.232753e-03 3 1  ON 34
ci_036                 2.104871e-03 3 1  ON 35
ci_037                 3.401256e-03 3 1  ON 36
ci_038                 3.314955e-03 3 1  ON 37
ci_039                 4.297400e-03 3 1  ON 38
ci_040                 4.407131e-03 3 1  ON 39
ci_041                 2.810969e-03 3 1  ON 40
ci_042                 2.890705e-03 3 1  ON 41
ci_043                 3.482762e-03 3 1  ON 42
ci_044                 3.150933e-03 3 1  ON 43
ci_045                 2.543747e-03 3 1  ON 44
ci_046                 2.918722e-03 3 1  ON 45
ci_047                -9.776717e-04 3 1  ON 46
ci_048                -1.140973e-03 3 1  ON 47
ci_049                 6.848198e-04 3 1  ON 48
ci_050                 7.672807e-04 3 1  ON 49
ci_051                -1.497361e-03 3 1  ON 50
ci_052                -1.344119e-03 3 1  ON 51
ci_053                -2.566620e-03 3 1  ON 52
ci_054                -2.681943e-03 3 1  ON 53
ci_055                -1.588246e-03 3 1  ON 54
ci_056                -1.309473e-03 3 1  ON 55
ci_057                -1.006114e-03 3 1  ON 56
ci_058                -9.626279e-04 3 1  ON 57
ci_059                -3.697779e-04 3 1  ON 58
ci_060                -2.370734e-04 3 1  ON 59
ci_061                -6.579924e-04 3 1  ON 60
ci_062                -4.772295e-04 3 1  ON 61
ci_063                -6.523602e-04 3 1  ON 62
ci_064                -7.869857e-04 3 1  ON 63
ci_065                -1.739290e-03 3 1  ON 64
ci_066                -1.689271e-03 3 1  ON 65
ci_067                -1.639537e-03 3 1  ON 66
ci_068                -1.573253e-03 3 1  ON 67
ci_069                -3.886067e-05 3 1  ON 68
ci_070                 1.179676e-04 3 1  ON 69
ci_071                -1.496854e-03 3 1  ON 70
ci_072                -1.934922e-03 3 1  ON 71
ci_073                 9.400924e-05 3 1  ON 72
ci_074                 1.627557e-04 3 1  ON 73
ci_075                 1.103957e-04 3 1  ON 74
ci_076                 2.385505e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6309
    reference variance = 0.384584
====================================================
  Execution time = 2.8232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.7236e-01
  Total weights = 1.954946489e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463929951248
                                         uncertainty =       0.024741638895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.463929951248
                                         uncertainty =       0.024741638895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000481608246
  error estimate for blocks of size 2^( 2) =       0.000505116690
  error estimate for blocks of size 2^( 3) =       0.000526897953
  error estimate for blocks of size 2^( 4) =       0.000542274913
  error estimate for blocks of size 2^( 5) =       0.000552039916
  error estimate for blocks of size 2^( 6) =       0.000556966397
  error estimate for blocks of size 2^( 7) =       0.000559238592

      target function =      -0.726930878956
              le_mean =     -22.661934013050
             les_mean =     514.035615744068
             stat err =       0.000552629955
             autocorr =       1.316682354003
   target nu stat err =       0.000552629955
   target dn stat err =       0.024560093931
      target stat err =       0.019164120303
              std dev =       0.681096912828
             le_variance =       0.463893004664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266193401305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.727431586111       residual = 9.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.727536731497       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.727549978482       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.727555284070       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.727560026719       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.727562933671       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.727563620275       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.727563715550       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.727563712308       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.727563708795       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.727563692618       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.727563694224       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.727563691605       residual = 1.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 9.796509e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.727431586111       residual = 9.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.727458746245       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.727462117956       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.727463456067       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.727464635969       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.727465327231       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.727465484520       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.727465506139       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.727465504857       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.727465503728       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.727465499922       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.727465500312       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 2.453998e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.727431586111       residual = 9.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.727438433032       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.727439279749       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.727439614981       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.727439909522       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.727440080070       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.727440118507       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.727440123777       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.727440123428       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.727440123132       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.727440122196       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.727440122292       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 6.138180e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133647 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3033e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.017789e-01 3 1  ON 0
ci_002                -7.062084e-01 3 1  ON 1
ci_003                -5.326234e-02 3 1  ON 2
ci_004                -5.429914e-02 3 1  ON 3
ci_005                 1.963712e-02 3 1  ON 4
ci_006                 1.976304e-02 3 1  ON 5
ci_007                 1.596589e-02 3 1  ON 6
ci_008                 1.585937e-02 3 1  ON 7
ci_009                -1.223765e-02 3 1  ON 8
ci_010                -1.259268e-02 3 1  ON 9
ci_011                -9.680567e-03 3 1  ON 10
ci_012                -9.805994e-03 3 1  ON 11
ci_013                 8.863342e-03 3 1  ON 12
ci_014                 8.778828e-03 3 1  ON 13
ci_015                 9.186839e-03 3 1  ON 14
ci_016                 9.570486e-03 3 1  ON 15
ci_017                 8.586099e-03 3 1  ON 16
ci_018                 8.328604e-03 3 1  ON 17
ci_019                -1.519325e-03 3 1  ON 18
ci_020                -1.279296e-03 3 1  ON 19
ci_021                -1.051574e-02 3 1  ON 20
ci_022                -1.115278e-02 3 1  ON 21
ci_023                 5.422251e-03 3 1  ON 22
ci_024                 5.207002e-03 3 1  ON 23
ci_025                 1.293080e-02 3 1  ON 24
ci_026                 1.258143e-02 3 1  ON 25
ci_027                 6.247948e-03 3 1  ON 26
ci_028                 6.246718e-03 3 1  ON 27
ci_029                -3.695490e-03 3 1  ON 28
ci_030                -4.435244e-03 3 1  ON 29
ci_031                 4.068673e-03 3 1  ON 30
ci_032                 3.735784e-03 3 1  ON 31
ci_033                 3.439136e-03 3 1  ON 32
ci_034                 3.333793e-03 3 1  ON 33
ci_035                 2.217805e-03 3 1  ON 34
ci_036                 2.094549e-03 3 1  ON 35
ci_037                 3.401362e-03 3 1  ON 36
ci_038                 3.314766e-03 3 1  ON 37
ci_039                 4.292710e-03 3 1  ON 38
ci_040                 4.432033e-03 3 1  ON 39
ci_041                 2.823818e-03 3 1  ON 40
ci_042                 2.891579e-03 3 1  ON 41
ci_043                 3.423664e-03 3 1  ON 42
ci_044                 3.144167e-03 3 1  ON 43
ci_045                 2.521019e-03 3 1  ON 44
ci_046                 2.940112e-03 3 1  ON 45
ci_047                -9.748531e-04 3 1  ON 46
ci_048                -1.143124e-03 3 1  ON 47
ci_049                 7.402395e-04 3 1  ON 48
ci_050                 7.588634e-04 3 1  ON 49
ci_051                -1.488113e-03 3 1  ON 50
ci_052                -1.350265e-03 3 1  ON 51
ci_053                -2.639462e-03 3 1  ON 52
ci_054                -2.668865e-03 3 1  ON 53
ci_055                -1.589517e-03 3 1  ON 54
ci_056                -1.319569e-03 3 1  ON 55
ci_057                -1.018359e-03 3 1  ON 56
ci_058                -9.590789e-04 3 1  ON 57
ci_059                -3.780810e-04 3 1  ON 58
ci_060                -2.213492e-04 3 1  ON 59
ci_061                -6.501966e-04 3 1  ON 60
ci_062                -4.839822e-04 3 1  ON 61
ci_063                -6.123200e-04 3 1  ON 62
ci_064                -7.752510e-04 3 1  ON 63
ci_065                -1.824978e-03 3 1  ON 64
ci_066                -1.681431e-03 3 1  ON 65
ci_067                -1.634855e-03 3 1  ON 66
ci_068                -1.576389e-03 3 1  ON 67
ci_069                -9.185768e-05 3 1  ON 68
ci_070                 1.283376e-04 3 1  ON 69
ci_071                -1.478944e-03 3 1  ON 70
ci_072                -1.933506e-03 3 1  ON 71
ci_073                 7.509377e-05 3 1  ON 72
ci_074                 1.500403e-04 3 1  ON 73
ci_075                 1.258257e-04 3 1  ON 74
ci_076                 2.435592e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6893
    reference variance = 0.348418
====================================================
  Execution time = 2.5340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5390e-01
  Total weights = 1.9548e+06
  Execution time = 3.6086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442663431344
                                         uncertainty =       0.002359039141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442663431344
                                         uncertainty =       0.002359039141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470431370
  error estimate for blocks of size 2^( 2) =       0.000494108368
  error estimate for blocks of size 2^( 3) =       0.000516247391
  error estimate for blocks of size 2^( 4) =       0.000531827713
  error estimate for blocks of size 2^( 5) =       0.000540838239
  error estimate for blocks of size 2^( 6) =       0.000545964606
  error estimate for blocks of size 2^( 7) =       0.000547911270

      target function =      -0.742243241708
              le_mean =     -22.661342009456
             les_mean =     513.990167002365
             stat err =       0.000541635457
             autocorr =       1.325627867453
   target nu stat err =       0.000541635457
   target dn stat err =       0.003412713661
      target stat err =       0.002833301931
              std dev =       0.665290423289
             le_variance =       0.442611347320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442676256975
                                         uncertainty =       0.002387251973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442676256975
                                         uncertainty =       0.002387251973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470438341
  error estimate for blocks of size 2^( 2) =       0.000494112747
  error estimate for blocks of size 2^( 3) =       0.000516250240
  error estimate for blocks of size 2^( 4) =       0.000531835379
  error estimate for blocks of size 2^( 5) =       0.000540840010
  error estimate for blocks of size 2^( 6) =       0.000545968264
  error estimate for blocks of size 2^( 7) =       0.000547901091

      target function =      -0.740390149735
              le_mean =     -22.661344980260
             les_mean =     513.992582385912
             stat err =       0.000541636186
             autocorr =       1.325592145083
   target nu stat err =       0.000541636186
   target dn stat err =       0.004309520222
      target stat err =       0.003531156582
              std dev =       0.665300282659
             le_variance =       0.442624466106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442662517745
                                         uncertainty =       0.002372483325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442662517745
                                         uncertainty =       0.002372483325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470430966
  error estimate for blocks of size 2^( 2) =       0.000494106793
  error estimate for blocks of size 2^( 3) =       0.000516244876
  error estimate for blocks of size 2^( 4) =       0.000531827712
  error estimate for blocks of size 2^( 5) =       0.000540835835
  error estimate for blocks of size 2^( 6) =       0.000545962338
  error estimate for blocks of size 2^( 7) =       0.000547903572

      target function =      -0.741801946560
              le_mean =     -22.661342907347
             les_mean =     513.990749857378
             stat err =       0.000541632364
             autocorr =       1.325615004327
   target nu stat err =       0.000541632364
   target dn stat err =       0.003638209745
      target stat err =       0.003009068159
              std dev =       0.665289852308
             le_variance =       0.442610587585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442662535178
                                         uncertainty =       0.002360607178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442662535178
                                         uncertainty =       0.002360607178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470430904
  error estimate for blocks of size 2^( 2) =       0.000494107761
  error estimate for blocks of size 2^( 3) =       0.000516246669
  error estimate for blocks of size 2^( 4) =       0.000531827349
  error estimate for blocks of size 2^( 5) =       0.000540837610
  error estimate for blocks of size 2^( 6) =       0.000545963997
  error estimate for blocks of size 2^( 7) =       0.000547909998

      target function =      -0.742243977435
              le_mean =     -22.661342034995
             les_mean =     513.990167112899
             stat err =       0.000541634739
             autocorr =       1.325626976522
   target nu stat err =       0.000541634739
   target dn stat err =       0.003431457190
      target stat err =       0.002848190483
              std dev =       0.665289764491
             le_variance =       0.442610470736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742243241708        initial
     1.0000e+00     1.0000e+01             9.7965e-04        -0.740390149735
     4.0000e+00     4.0000e+01             2.4540e-04        -0.741801946560
     1.6000e+01     1.6000e+02             6.1382e-05        -0.742243977435  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.3664e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
ci_001                -7.019584e-01 3 1  ON 0
ci_002                -7.060244e-01 3 1  ON 1
ci_003                -5.330654e-02 3 1  ON 2
ci_004                -5.429908e-02 3 1  ON 3
ci_005                 1.963857e-02 3 1  ON 4
ci_006                 1.976335e-02 3 1  ON 5
ci_007                 1.600250e-02 3 1  ON 6
ci_008                 1.586330e-02 3 1  ON 7
ci_009                -1.223940e-02 3 1  ON 8
ci_010                -1.260302e-02 3 1  ON 9
ci_011                -9.689607e-03 3 1  ON 10
ci_012                -9.822341e-03 3 1  ON 11
ci_013                 8.843628e-03 3 1  ON 12
ci_014                 8.793595e-03 3 1  ON 13
ci_015                 9.249332e-03 3 1  ON 14
ci_016                 9.554354e-03 3 1  ON 15
ci_017                 8.639827e-03 3 1  ON 16
ci_018                 8.265057e-03 3 1  ON 17
ci_019                -1.417802e-03 3 1  ON 18
ci_020                -1.244206e-03 3 1  ON 19
ci_021                -1.051368e-02 3 1  ON 20
ci_022                -1.114485e-02 3 1  ON 21
ci_023                 5.493347e-03 3 1  ON 22
ci_024                 5.208341e-03 3 1  ON 23
ci_025                 1.292889e-02 3 1  ON 24
ci_026                 1.255632e-02 3 1  ON 25
ci_027                 6.272737e-03 3 1  ON 26
ci_028                 6.244457e-03 3 1  ON 27
ci_029                -3.698965e-03 3 1  ON 28
ci_030                -4.429320e-03 3 1  ON 29
ci_031                 4.143513e-03 3 1  ON 30
ci_032                 3.720754e-03 3 1  ON 31
ci_033                 3.432121e-03 3 1  ON 32
ci_034                 3.358204e-03 3 1  ON 33
ci_035                 2.228983e-03 3 1  ON 34
ci_036                 2.102265e-03 3 1  ON 35
ci_037                 3.401283e-03 3 1  ON 36
ci_038                 3.314907e-03 3 1  ON 37
ci_039                 4.296221e-03 3 1  ON 38
ci_040                 4.413410e-03 3 1  ON 39
ci_041                 2.814213e-03 3 1  ON 40
ci_042                 2.890924e-03 3 1  ON 41
ci_043                 3.467881e-03 3 1  ON 42
ci_044                 3.149222e-03 3 1  ON 43
ci_045                 2.538024e-03 3 1  ON 44
ci_046                 2.924113e-03 3 1  ON 45
ci_047                -9.769614e-04 3 1  ON 46
ci_048                -1.141517e-03 3 1  ON 47
ci_049                 6.987963e-04 3 1  ON 48
ci_050                 7.651583e-04 3 1  ON 49
ci_051                -1.495033e-03 3 1  ON 50
ci_052                -1.345668e-03 3 1  ON 51
ci_053                -2.584981e-03 3 1  ON 52
ci_054                -2.678644e-03 3 1  ON 53
ci_055                -1.588570e-03 3 1  ON 54
ci_056                -1.312015e-03 3 1  ON 55
ci_057                -1.009206e-03 3 1  ON 56
ci_058                -9.617330e-04 3 1  ON 57
ci_059                -3.718779e-04 3 1  ON 58
ci_060                -2.331074e-04 3 1  ON 59
ci_061                -6.560333e-04 3 1  ON 60
ci_062                -4.789255e-04 3 1  ON 61
ci_063                -6.422745e-04 3 1  ON 62
ci_064                -7.840290e-04 3 1  ON 63
ci_065                -1.760890e-03 3 1  ON 64
ci_066                -1.687296e-03 3 1  ON 65
ci_067                -1.638367e-03 3 1  ON 66
ci_068                -1.574041e-03 3 1  ON 67
ci_069                -5.222564e-05 3 1  ON 68
ci_070                 1.205818e-04 3 1  ON 69
ci_071                -1.492344e-03 3 1  ON 70
ci_072                -1.934566e-03 3 1  ON 71
ci_073                 8.923315e-05 3 1  ON 72
ci_074                 1.595447e-04 3 1  ON 73
ci_075                 1.142847e-04 3 1  ON 74
ci_076                 2.398112e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6705e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7157
    reference variance = 0.692255
====================================================
  Execution time = 2.6180e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4437e-01
  Total weights = 1.954890272e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435885231490
                                         uncertainty =       0.002136415338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435885231490
                                         uncertainty =       0.002136415338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466859682
  error estimate for blocks of size 2^( 2) =       0.000491087665
  error estimate for blocks of size 2^( 3) =       0.000513257261
  error estimate for blocks of size 2^( 4) =       0.000529766048
  error estimate for blocks of size 2^( 5) =       0.000538903925
  error estimate for blocks of size 2^( 6) =       0.000544326049
  error estimate for blocks of size 2^( 7) =       0.000544852013

      target function =      -0.749950588904
              le_mean =     -22.662044163523
             les_mean =     514.012615722117
             stat err =       0.000539462009
             autocorr =       1.335208198902
   target nu stat err =       0.000539462009
   target dn stat err =       0.002750991303
      target stat err =       0.002359151121
              std dev =       0.660239294096
             le_variance =       0.435915925469


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266204416352e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749957078677       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749961504142       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749962072217       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749962190283       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749962258116       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749962298097       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749962286311       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749962284292       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749962282503       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 4.977473e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749957078677       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749958195103       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749958337727       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749958367294       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749958384241       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749958394163       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749958391199       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749958390694       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749958390252       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 1.248083e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749957078677       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749957358419       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749957394113       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749957401508       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749957405744       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749957408220       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749957407478       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749957407351       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749957407241       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.4000e+01 is 3.122540e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136884 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0951e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.019602e-01 3 1  ON 0
ci_002                -7.060243e-01 3 1  ON 1
ci_003                -5.330071e-02 3 1  ON 2
ci_004                -5.428659e-02 3 1  ON 3
ci_005                 1.963815e-02 3 1  ON 4
ci_006                 1.976115e-02 3 1  ON 5
ci_007                 1.599759e-02 3 1  ON 6
ci_008                 1.586385e-02 3 1  ON 7
ci_009                -1.224102e-02 3 1  ON 8
ci_010                -1.259898e-02 3 1  ON 9
ci_011                -9.683931e-03 3 1  ON 10
ci_012                -9.816477e-03 3 1  ON 11
ci_013                 8.835020e-03 3 1  ON 12
ci_014                 8.789274e-03 3 1  ON 13
ci_015                 9.249315e-03 3 1  ON 14
ci_016                 9.548447e-03 3 1  ON 15
ci_017                 8.643705e-03 3 1  ON 16
ci_018                 8.259128e-03 3 1  ON 17
ci_019                -1.424230e-03 3 1  ON 18
ci_020                -1.254334e-03 3 1  ON 19
ci_021                -1.051892e-02 3 1  ON 20
ci_022                -1.115334e-02 3 1  ON 21
ci_023                 5.487736e-03 3 1  ON 22
ci_024                 5.206941e-03 3 1  ON 23
ci_025                 1.292882e-02 3 1  ON 24
ci_026                 1.256087e-02 3 1  ON 25
ci_027                 6.272566e-03 3 1  ON 26
ci_028                 6.246954e-03 3 1  ON 27
ci_029                -3.700110e-03 3 1  ON 28
ci_030                -4.427556e-03 3 1  ON 29
ci_031                 4.152845e-03 3 1  ON 30
ci_032                 3.721210e-03 3 1  ON 31
ci_033                 3.432173e-03 3 1  ON 32
ci_034                 3.353515e-03 3 1  ON 33
ci_035                 2.224839e-03 3 1  ON 34
ci_036                 2.103481e-03 3 1  ON 35
ci_037                 3.405737e-03 3 1  ON 36
ci_038                 3.318281e-03 3 1  ON 37
ci_039                 4.296984e-03 3 1  ON 38
ci_040                 4.416003e-03 3 1  ON 39
ci_041                 2.812265e-03 3 1  ON 40
ci_042                 2.893997e-03 3 1  ON 41
ci_043                 3.466697e-03 3 1  ON 42
ci_044                 3.150049e-03 3 1  ON 43
ci_045                 2.533901e-03 3 1  ON 44
ci_046                 2.921561e-03 3 1  ON 45
ci_047                -9.792784e-04 3 1  ON 46
ci_048                -1.141716e-03 3 1  ON 47
ci_049                 6.946549e-04 3 1  ON 48
ci_050                 7.676953e-04 3 1  ON 49
ci_051                -1.494277e-03 3 1  ON 50
ci_052                -1.345210e-03 3 1  ON 51
ci_053                -2.583056e-03 3 1  ON 52
ci_054                -2.681756e-03 3 1  ON 53
ci_055                -1.589256e-03 3 1  ON 54
ci_056                -1.311319e-03 3 1  ON 55
ci_057                -1.008206e-03 3 1  ON 56
ci_058                -9.644755e-04 3 1  ON 57
ci_059                -3.692377e-04 3 1  ON 58
ci_060                -2.295555e-04 3 1  ON 59
ci_061                -6.564093e-04 3 1  ON 60
ci_062                -4.817174e-04 3 1  ON 61
ci_063                -6.419918e-04 3 1  ON 62
ci_064                -7.800632e-04 3 1  ON 63
ci_065                -1.762350e-03 3 1  ON 64
ci_066                -1.689059e-03 3 1  ON 65
ci_067                -1.640855e-03 3 1  ON 66
ci_068                -1.574173e-03 3 1  ON 67
ci_069                -5.246054e-05 3 1  ON 68
ci_070                 1.206897e-04 3 1  ON 69
ci_071                -1.491351e-03 3 1  ON 70
ci_072                -1.928061e-03 3 1  ON 71
ci_073                 8.616089e-05 3 1  ON 72
ci_074                 1.587649e-04 3 1  ON 73
ci_075                 1.152093e-04 3 1  ON 74
ci_076                 2.409949e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.5956
    reference variance = 0.33484
====================================================
  Execution time = 2.5381e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5130e-01
  Total weights = 1.9550e+06
  Execution time = 3.6188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440514225138
                                         uncertainty =       0.002360114923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440514225138
                                         uncertainty =       0.002360114923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469275222
  error estimate for blocks of size 2^( 2) =       0.000493836735
  error estimate for blocks of size 2^( 3) =       0.000515713791
  error estimate for blocks of size 2^( 4) =       0.000531984753
  error estimate for blocks of size 2^( 5) =       0.000540562253
  error estimate for blocks of size 2^( 6) =       0.000544222865
  error estimate for blocks of size 2^( 7) =       0.000548330206

      target function =      -0.744243588310
              le_mean =     -22.662398523850
             les_mean =     514.035609389018
             stat err =       0.000541275019
             autocorr =       1.330395355158
   target nu stat err =       0.000541275019
   target dn stat err =       0.003245967140
      target stat err =       0.002719438274
              std dev =       0.663655384089
             le_variance =       0.440438468830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440502020451
                                         uncertainty =       0.002358619164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440502020451
                                         uncertainty =       0.002358619164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469268707
  error estimate for blocks of size 2^( 2) =       0.000493831031
  error estimate for blocks of size 2^( 3) =       0.000515708727
  error estimate for blocks of size 2^( 4) =       0.000531979723
  error estimate for blocks of size 2^( 5) =       0.000540556140
  error estimate for blocks of size 2^( 6) =       0.000544216305
  error estimate for blocks of size 2^( 7) =       0.000548322999

      target function =      -0.744238654788
              le_mean =     -22.662398443682
             les_mean =     514.035611805343
             stat err =       0.000541268792
             autocorr =       1.330401683680
   target nu stat err =       0.000541268792
   target dn stat err =       0.003243750657
      target stat err =       0.002717633087
              std dev =       0.663646169987
             le_variance =       0.440426238939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508020464
                                         uncertainty =       0.002359357583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508020464
                                         uncertainty =       0.002359357583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469271910
  error estimate for blocks of size 2^( 2) =       0.000493833833
  error estimate for blocks of size 2^( 3) =       0.000515711211
  error estimate for blocks of size 2^( 4) =       0.000531982191
  error estimate for blocks of size 2^( 5) =       0.000540559147
  error estimate for blocks of size 2^( 6) =       0.000544219537
  error estimate for blocks of size 2^( 7) =       0.000548326549

      target function =      -0.744246250034
              le_mean =     -22.662398479763
             les_mean =     514.035604142876
             stat err =       0.000541271856
             autocorr =       1.330398585641
   target nu stat err =       0.000541271856
   target dn stat err =       0.003244787000
      target stat err =       0.002718514853
              std dev =       0.663650699920
             le_variance =       0.440432251504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440513442541
                                         uncertainty =       0.002360019833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440513442541
                                         uncertainty =       0.002360019833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469274805
  error estimate for blocks of size 2^( 2) =       0.000493836369
  error estimate for blocks of size 2^( 3) =       0.000515713465
  error estimate for blocks of size 2^( 4) =       0.000531984430
  error estimate for blocks of size 2^( 5) =       0.000540561862
  error estimate for blocks of size 2^( 6) =       0.000544222445
  error estimate for blocks of size 2^( 7) =       0.000548329745

      target function =      -0.744239188986
              le_mean =     -22.662398517613
             les_mean =     514.035614488774
             stat err =       0.000541274621
             autocorr =       1.330395763411
   target nu stat err =       0.000541274621
   target dn stat err =       0.003245817079
      target stat err =       0.002719287059
              std dev =       0.663654793287
             le_variance =       0.440437684652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744243588310        initial
     4.0000e+00     4.0000e+01             4.9775e-05        -0.744238654788
     1.6000e+01     1.6000e+02             1.2481e-05        -0.744246250034  <--
     6.4000e+01     6.4000e+02             3.1225e-06        -0.744239188986

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.4862e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
ci_001                -7.019602e-01 3 1  ON 0
ci_002                -7.060243e-01 3 1  ON 1
ci_003                -5.330071e-02 3 1  ON 2
ci_004                -5.428659e-02 3 1  ON 3
ci_005                 1.963815e-02 3 1  ON 4
ci_006                 1.976115e-02 3 1  ON 5
ci_007                 1.599759e-02 3 1  ON 6
ci_008                 1.586385e-02 3 1  ON 7
ci_009                -1.224102e-02 3 1  ON 8
ci_010                -1.259898e-02 3 1  ON 9
ci_011                -9.683931e-03 3 1  ON 10
ci_012                -9.816477e-03 3 1  ON 11
ci_013                 8.835020e-03 3 1  ON 12
ci_014                 8.789274e-03 3 1  ON 13
ci_015                 9.249315e-03 3 1  ON 14
ci_016                 9.548447e-03 3 1  ON 15
ci_017                 8.643705e-03 3 1  ON 16
ci_018                 8.259128e-03 3 1  ON 17
ci_019                -1.424230e-03 3 1  ON 18
ci_020                -1.254334e-03 3 1  ON 19
ci_021                -1.051892e-02 3 1  ON 20
ci_022                -1.115334e-02 3 1  ON 21
ci_023                 5.487736e-03 3 1  ON 22
ci_024                 5.206941e-03 3 1  ON 23
ci_025                 1.292882e-02 3 1  ON 24
ci_026                 1.256087e-02 3 1  ON 25
ci_027                 6.272566e-03 3 1  ON 26
ci_028                 6.246954e-03 3 1  ON 27
ci_029                -3.700110e-03 3 1  ON 28
ci_030                -4.427556e-03 3 1  ON 29
ci_031                 4.152845e-03 3 1  ON 30
ci_032                 3.721210e-03 3 1  ON 31
ci_033                 3.432173e-03 3 1  ON 32
ci_034                 3.353515e-03 3 1  ON 33
ci_035                 2.224839e-03 3 1  ON 34
ci_036                 2.103481e-03 3 1  ON 35
ci_037                 3.405737e-03 3 1  ON 36
ci_038                 3.318281e-03 3 1  ON 37
ci_039                 4.296984e-03 3 1  ON 38
ci_040                 4.416003e-03 3 1  ON 39
ci_041                 2.812265e-03 3 1  ON 40
ci_042                 2.893997e-03 3 1  ON 41
ci_043                 3.466697e-03 3 1  ON 42
ci_044                 3.150049e-03 3 1  ON 43
ci_045                 2.533901e-03 3 1  ON 44
ci_046                 2.921561e-03 3 1  ON 45
ci_047                -9.792784e-04 3 1  ON 46
ci_048                -1.141716e-03 3 1  ON 47
ci_049                 6.946549e-04 3 1  ON 48
ci_050                 7.676953e-04 3 1  ON 49
ci_051                -1.494277e-03 3 1  ON 50
ci_052                -1.345210e-03 3 1  ON 51
ci_053                -2.583056e-03 3 1  ON 52
ci_054                -2.681756e-03 3 1  ON 53
ci_055                -1.589256e-03 3 1  ON 54
ci_056                -1.311319e-03 3 1  ON 55
ci_057                -1.008206e-03 3 1  ON 56
ci_058                -9.644755e-04 3 1  ON 57
ci_059                -3.692377e-04 3 1  ON 58
ci_060                -2.295555e-04 3 1  ON 59
ci_061                -6.564093e-04 3 1  ON 60
ci_062                -4.817174e-04 3 1  ON 61
ci_063                -6.419918e-04 3 1  ON 62
ci_064                -7.800632e-04 3 1  ON 63
ci_065                -1.762350e-03 3 1  ON 64
ci_066                -1.689059e-03 3 1  ON 65
ci_067                -1.640855e-03 3 1  ON 66
ci_068                -1.574173e-03 3 1  ON 67
ci_069                -5.246054e-05 3 1  ON 68
ci_070                 1.206897e-04 3 1  ON 69
ci_071                -1.491351e-03 3 1  ON 70
ci_072                -1.928061e-03 3 1  ON 71
ci_073                 8.616089e-05 3 1  ON 72
ci_074                 1.587649e-04 3 1  ON 73
ci_075                 1.152093e-04 3 1  ON 74
ci_076                 2.409949e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5914e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.633
    reference variance = 0.275365
====================================================
  Execution time = 2.6241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5309e-01
  Total weights = 1.955237825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440202649629
                                         uncertainty =       0.002770343920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440202649629
                                         uncertainty =       0.002770343920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469165469
  error estimate for blocks of size 2^( 2) =       0.000493223000
  error estimate for blocks of size 2^( 3) =       0.000515970173
  error estimate for blocks of size 2^( 4) =       0.000531655130
  error estimate for blocks of size 2^( 5) =       0.000541184186
  error estimate for blocks of size 2^( 6) =       0.000544561136
  error estimate for blocks of size 2^( 7) =       0.000549943372

      target function =      -0.742776044119
              le_mean =     -22.661906586670
             les_mean =     514.015100936067
             stat err =       0.000541835956
             autocorr =       1.333778035978
   target nu stat err =       0.000541835956
   target dn stat err =       0.003988970637
      target stat err =       0.003299710723
              std dev =       0.663500169705
             le_variance =       0.440232475199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266190658667e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742789732190       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742794128664       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742794909981       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742794984834       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742794994912       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742795009388       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742795020561       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742795016588       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742795017835       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742795017325       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742795017375       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 6.285485e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742789732190       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742790840904       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742791036963       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742791055693       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742791058209       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742791061808       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742791064556       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742791063557       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742791063867       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742791063739       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742791063753       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 1.582708e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742789732190       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742790009975       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742790059035       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742790063719       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742790064347       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742790065246       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742790065930       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742790065680       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742790065757       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742790065725       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742790065729       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.4000e+01 is 3.963919e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1004e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.019524e-01 3 1  ON 0
ci_002                -7.060328e-01 3 1  ON 1
ci_003                -5.330149e-02 3 1  ON 2
ci_004                -5.428297e-02 3 1  ON 3
ci_005                 1.963510e-02 3 1  ON 4
ci_006                 1.975864e-02 3 1  ON 5
ci_007                 1.599038e-02 3 1  ON 6
ci_008                 1.585921e-02 3 1  ON 7
ci_009                -1.223433e-02 3 1  ON 8
ci_010                -1.259549e-02 3 1  ON 9
ci_011                -9.679124e-03 3 1  ON 10
ci_012                -9.815548e-03 3 1  ON 11
ci_013                 8.825038e-03 3 1  ON 12
ci_014                 8.782822e-03 3 1  ON 13
ci_015                 9.252180e-03 3 1  ON 14
ci_016                 9.543547e-03 3 1  ON 15
ci_017                 8.641573e-03 3 1  ON 16
ci_018                 8.257761e-03 3 1  ON 17
ci_019                -1.430332e-03 3 1  ON 18
ci_020                -1.260018e-03 3 1  ON 19
ci_021                -1.052631e-02 3 1  ON 20
ci_022                -1.116916e-02 3 1  ON 21
ci_023                 5.485464e-03 3 1  ON 22
ci_024                 5.209645e-03 3 1  ON 23
ci_025                 1.293098e-02 3 1  ON 24
ci_026                 1.256496e-02 3 1  ON 25
ci_027                 6.271128e-03 3 1  ON 26
ci_028                 6.245872e-03 3 1  ON 27
ci_029                -3.694957e-03 3 1  ON 28
ci_030                -4.422300e-03 3 1  ON 29
ci_031                 4.157846e-03 3 1  ON 30
ci_032                 3.732146e-03 3 1  ON 31
ci_033                 3.430262e-03 3 1  ON 32
ci_034                 3.351832e-03 3 1  ON 33
ci_035                 2.222605e-03 3 1  ON 34
ci_036                 2.103787e-03 3 1  ON 35
ci_037                 3.397169e-03 3 1  ON 36
ci_038                 3.318792e-03 3 1  ON 37
ci_039                 4.299405e-03 3 1  ON 38
ci_040                 4.414524e-03 3 1  ON 39
ci_041                 2.814331e-03 3 1  ON 40
ci_042                 2.894250e-03 3 1  ON 41
ci_043                 3.465667e-03 3 1  ON 42
ci_044                 3.145895e-03 3 1  ON 43
ci_045                 2.534922e-03 3 1  ON 44
ci_046                 2.921732e-03 3 1  ON 45
ci_047                -9.827459e-04 3 1  ON 46
ci_048                -1.143518e-03 3 1  ON 47
ci_049                 6.960012e-04 3 1  ON 48
ci_050                 7.658421e-04 3 1  ON 49
ci_051                -1.490061e-03 3 1  ON 50
ci_052                -1.340664e-03 3 1  ON 51
ci_053                -2.581480e-03 3 1  ON 52
ci_054                -2.680885e-03 3 1  ON 53
ci_055                -1.590070e-03 3 1  ON 54
ci_056                -1.309341e-03 3 1  ON 55
ci_057                -1.008885e-03 3 1  ON 56
ci_058                -9.623448e-04 3 1  ON 57
ci_059                -3.659286e-04 3 1  ON 58
ci_060                -2.306751e-04 3 1  ON 59
ci_061                -6.576921e-04 3 1  ON 60
ci_062                -4.766274e-04 3 1  ON 61
ci_063                -6.428107e-04 3 1  ON 62
ci_064                -7.826130e-04 3 1  ON 63
ci_065                -1.762808e-03 3 1  ON 64
ci_066                -1.690737e-03 3 1  ON 65
ci_067                -1.641399e-03 3 1  ON 66
ci_068                -1.575860e-03 3 1  ON 67
ci_069                -5.470419e-05 3 1  ON 68
ci_070                 1.200826e-04 3 1  ON 69
ci_071                -1.490754e-03 3 1  ON 70
ci_072                -1.924623e-03 3 1  ON 71
ci_073                 8.719279e-05 3 1  ON 72
ci_074                 1.569743e-04 3 1  ON 73
ci_075                 1.146871e-04 3 1  ON 74
ci_076                 2.416543e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.662
    reference variance = 0.351432
====================================================
  Execution time = 2.5568e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5041e-01
  Total weights = 1.9549e+06
  Execution time = 3.5998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441513111895
                                         uncertainty =       0.003036064499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441513111895
                                         uncertainty =       0.003036064499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469818029
  error estimate for blocks of size 2^( 2) =       0.000494095087
  error estimate for blocks of size 2^( 3) =       0.000515870714
  error estimate for blocks of size 2^( 4) =       0.000532337227
  error estimate for blocks of size 2^( 5) =       0.000541285121
  error estimate for blocks of size 2^( 6) =       0.000545774372
  error estimate for blocks of size 2^( 7) =       0.000548061311

      target function =      -0.744958981361
              le_mean =     -22.661535532025
             les_mean =     513.995606411779
             stat err =       0.000541864508
             autocorr =       1.330215653755
   target nu stat err =       0.000541864508
   target dn stat err =       0.003618167953
      target stat err =       0.003019073948
              std dev =       0.664423028420
             le_variance =       0.441457960694

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441505899913
                                         uncertainty =       0.003036681639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441505899913
                                         uncertainty =       0.003036681639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469814207
  error estimate for blocks of size 2^( 2) =       0.000494092126
  error estimate for blocks of size 2^( 3) =       0.000515868635
  error estimate for blocks of size 2^( 4) =       0.000532335247
  error estimate for blocks of size 2^( 5) =       0.000541284211
  error estimate for blocks of size 2^( 6) =       0.000545773251
  error estimate for blocks of size 2^( 7) =       0.000548059490

      target function =      -0.744978674269
              le_mean =     -22.661535714957
             les_mean =     513.995590635027
             stat err =       0.000541863050
             autocorr =       1.330230135389
   target nu stat err =       0.000541863050
   target dn stat err =       0.003617846108
      target stat err =       0.003018972825
              std dev =       0.664417624028
             le_variance =       0.441450779119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441509430345
                                         uncertainty =       0.003036373185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441509430345
                                         uncertainty =       0.003036373185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469816078
  error estimate for blocks of size 2^( 2) =       0.000494093570
  error estimate for blocks of size 2^( 3) =       0.000515869642
  error estimate for blocks of size 2^( 4) =       0.000532336207
  error estimate for blocks of size 2^( 5) =       0.000541284639
  error estimate for blocks of size 2^( 6) =       0.000545773781
  error estimate for blocks of size 2^( 7) =       0.000548060363

      target function =      -0.744970477602
              le_mean =     -22.661535617581
             les_mean =     513.995596238797
             stat err =       0.000541863748
             autocorr =       1.330222968299
   target nu stat err =       0.000541863748
   target dn stat err =       0.003617982120
      target stat err =       0.003019016489
              std dev =       0.664420269455
             le_variance =       0.441454294463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441512645605
                                         uncertainty =       0.003036102965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441512645605
                                         uncertainty =       0.003036102965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469817782
  error estimate for blocks of size 2^( 2) =       0.000494094894
  error estimate for blocks of size 2^( 3) =       0.000515870577
  error estimate for blocks of size 2^( 4) =       0.000532337097
  error estimate for blocks of size 2^( 5) =       0.000541285059
  error estimate for blocks of size 2^( 6) =       0.000545774295
  error estimate for blocks of size 2^( 7) =       0.000548061190

      target function =      -0.744960760529
              le_mean =     -22.661535541825
             les_mean =     513.995604681366
             stat err =       0.000541864410
             autocorr =       1.330216573836
   target nu stat err =       0.000541864410
   target dn stat err =       0.003618141774
      target stat err =       0.003019067115
              std dev =       0.664422678967
             le_variance =       0.441457496326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744958981361        initial
     4.0000e+00     4.0000e+01             6.2855e-05        -0.744978674269  <--
     1.6000e+01     1.6000e+02             1.5827e-05        -0.744970477602
     6.4000e+01     6.4000e+02             3.9639e-06        -0.744960760529

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.3903e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
ci_001                -7.019290e-01 3 1  ON 0
ci_002                -7.060584e-01 3 1  ON 1
ci_003                -5.330385e-02 3 1  ON 2
ci_004                -5.427213e-02 3 1  ON 3
ci_005                 1.962605e-02 3 1  ON 4
ci_006                 1.975122e-02 3 1  ON 5
ci_007                 1.596898e-02 3 1  ON 6
ci_008                 1.584547e-02 3 1  ON 7
ci_009                -1.221446e-02 3 1  ON 8
ci_010                -1.258513e-02 3 1  ON 9
ci_011                -9.664858e-03 3 1  ON 10
ci_012                -9.812803e-03 3 1  ON 11
ci_013                 8.795381e-03 3 1  ON 12
ci_014                 8.763678e-03 3 1  ON 13
ci_015                 9.260696e-03 3 1  ON 14
ci_016                 9.528987e-03 3 1  ON 15
ci_017                 8.635249e-03 3 1  ON 16
ci_018                 8.253691e-03 3 1  ON 17
ci_019                -1.448460e-03 3 1  ON 18
ci_020                -1.276891e-03 3 1  ON 19
ci_021                -1.054826e-02 3 1  ON 20
ci_022                -1.121619e-02 3 1  ON 21
ci_023                 5.478725e-03 3 1  ON 22
ci_024                 5.217663e-03 3 1  ON 23
ci_025                 1.293742e-02 3 1  ON 24
ci_026                 1.257712e-02 3 1  ON 25
ci_027                 6.266867e-03 3 1  ON 26
ci_028                 6.242673e-03 3 1  ON 27
ci_029                -3.679649e-03 3 1  ON 28
ci_030                -4.406692e-03 3 1  ON 29
ci_031                 4.172704e-03 3 1  ON 30
ci_032                 3.764653e-03 3 1  ON 31
ci_033                 3.424589e-03 3 1  ON 32
ci_034                 3.346831e-03 3 1  ON 33
ci_035                 2.215983e-03 3 1  ON 34
ci_036                 2.104685e-03 3 1  ON 35
ci_037                 3.371727e-03 3 1  ON 36
ci_038                 3.320309e-03 3 1  ON 37
ci_039                 4.306572e-03 3 1  ON 38
ci_040                 4.410148e-03 3 1  ON 39
ci_041                 2.820455e-03 3 1  ON 40
ci_042                 2.895002e-03 3 1  ON 41
ci_043                 3.462608e-03 3 1  ON 42
ci_044                 3.133574e-03 3 1  ON 43
ci_045                 2.537954e-03 3 1  ON 44
ci_046                 2.922240e-03 3 1  ON 45
ci_047                -9.930052e-04 3 1  ON 46
ci_048                -1.148856e-03 3 1  ON 47
ci_049                 6.999969e-04 3 1  ON 48
ci_050                 7.603453e-04 3 1  ON 49
ci_051                -1.477535e-03 3 1  ON 50
ci_052                -1.327168e-03 3 1  ON 51
ci_053                -2.576804e-03 3 1  ON 52
ci_054                -2.678301e-03 3 1  ON 53
ci_055                -1.592495e-03 3 1  ON 54
ci_056                -1.303458e-03 3 1  ON 55
ci_057                -1.010899e-03 3 1  ON 56
ci_058                -9.560289e-04 3 1  ON 57
ci_059                -3.561262e-04 3 1  ON 58
ci_060                -2.339885e-04 3 1  ON 59
ci_061                -6.615011e-04 3 1  ON 60
ci_062                -4.615200e-04 3 1  ON 61
ci_063                -6.452498e-04 3 1  ON 62
ci_064                -7.901890e-04 3 1  ON 63
ci_065                -1.764167e-03 3 1  ON 64
ci_066                -1.695721e-03 3 1  ON 65
ci_067                -1.643009e-03 3 1  ON 66
ci_068                -1.580879e-03 3 1  ON 67
ci_069                -6.136330e-05 3 1  ON 68
ci_070                 1.182791e-04 3 1  ON 69
ci_071                -1.488984e-03 3 1  ON 70
ci_072                -1.914420e-03 3 1  ON 71
ci_073                 9.024497e-05 3 1  ON 72
ci_074                 1.516678e-04 3 1  ON 73
ci_075                 1.131369e-04 3 1  ON 74
ci_076                 2.436180e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.623
    reference variance = 0.330763
====================================================
  Execution time = 2.6215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4807e-01
  Total weights = 1.955237344e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7642e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439442368955
                                         uncertainty =       0.002208456328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439442368955
                                         uncertainty =       0.002208456328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468730397
  error estimate for blocks of size 2^( 2) =       0.000492884679
  error estimate for blocks of size 2^( 3) =       0.000515416112
  error estimate for blocks of size 2^( 4) =       0.000531270797
  error estimate for blocks of size 2^( 5) =       0.000539649790
  error estimate for blocks of size 2^( 6) =       0.000544058851
  error estimate for blocks of size 2^( 7) =       0.000547709121

      target function =      -0.746890212765
              le_mean =     -22.661792921277
             les_mean =     514.004927895725
             stat err =       0.000540672140
             autocorr =       1.330521037965
   target nu stat err =       0.000540672140
   target dn stat err =       0.002780020147
      target stat err =       0.002363123642
              std dev =       0.662884884856
             le_variance =       0.439416370570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266179292128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746896700089       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746908497950       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746910405285       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746910656068       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746910623995       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746910614905       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746910654710       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746910650222       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746910655446       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 1.374839e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746896700089       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746899759119       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746900244759       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746900307635       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746900299308       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746900297095       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746900306811       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746900305649       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746900306887       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 3.537166e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746896700089       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746897472015       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746897593980       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746897609707       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746897607606       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746897607057       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746897609470       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746897609177       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746897609482       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 8.907782e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0987e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.019283e-01 3 1  ON 0
ci_002                -7.060657e-01 3 1  ON 1
ci_003                -5.328852e-02 3 1  ON 2
ci_004                -5.424872e-02 3 1  ON 3
ci_005                 1.959742e-02 3 1  ON 4
ci_006                 1.973150e-02 3 1  ON 5
ci_007                 1.595816e-02 3 1  ON 6
ci_008                 1.582837e-02 3 1  ON 7
ci_009                -1.219631e-02 3 1  ON 8
ci_010                -1.257650e-02 3 1  ON 9
ci_011                -9.669007e-03 3 1  ON 10
ci_012                -9.804422e-03 3 1  ON 11
ci_013                 8.783604e-03 3 1  ON 12
ci_014                 8.746671e-03 3 1  ON 13
ci_015                 9.247870e-03 3 1  ON 14
ci_016                 9.519953e-03 3 1  ON 15
ci_017                 8.627687e-03 3 1  ON 16
ci_018                 8.243876e-03 3 1  ON 17
ci_019                -1.481653e-03 3 1  ON 18
ci_020                -1.292650e-03 3 1  ON 19
ci_021                -1.053391e-02 3 1  ON 20
ci_022                -1.122545e-02 3 1  ON 21
ci_023                 5.484017e-03 3 1  ON 22
ci_024                 5.223387e-03 3 1  ON 23
ci_025                 1.292112e-02 3 1  ON 24
ci_026                 1.258432e-02 3 1  ON 25
ci_027                 6.262262e-03 3 1  ON 26
ci_028                 6.243808e-03 3 1  ON 27
ci_029                -3.665350e-03 3 1  ON 28
ci_030                -4.408954e-03 3 1  ON 29
ci_031                 4.192416e-03 3 1  ON 30
ci_032                 3.800025e-03 3 1  ON 31
ci_033                 3.417069e-03 3 1  ON 32
ci_034                 3.339102e-03 3 1  ON 33
ci_035                 2.203860e-03 3 1  ON 34
ci_036                 2.110090e-03 3 1  ON 35
ci_037                 3.372902e-03 3 1  ON 36
ci_038                 3.318170e-03 3 1  ON 37
ci_039                 4.290821e-03 3 1  ON 38
ci_040                 4.417992e-03 3 1  ON 39
ci_041                 2.796397e-03 3 1  ON 40
ci_042                 2.887616e-03 3 1  ON 41
ci_043                 3.452515e-03 3 1  ON 42
ci_044                 3.126310e-03 3 1  ON 43
ci_045                 2.532816e-03 3 1  ON 44
ci_046                 2.921660e-03 3 1  ON 45
ci_047                -9.926544e-04 3 1  ON 46
ci_048                -1.151242e-03 3 1  ON 47
ci_049                 6.894459e-04 3 1  ON 48
ci_050                 7.556496e-04 3 1  ON 49
ci_051                -1.490014e-03 3 1  ON 50
ci_052                -1.331708e-03 3 1  ON 51
ci_053                -2.578473e-03 3 1  ON 52
ci_054                -2.672721e-03 3 1  ON 53
ci_055                -1.566404e-03 3 1  ON 54
ci_056                -1.296392e-03 3 1  ON 55
ci_057                -1.014642e-03 3 1  ON 56
ci_058                -9.481982e-04 3 1  ON 57
ci_059                -3.564059e-04 3 1  ON 58
ci_060                -2.406146e-04 3 1  ON 59
ci_061                -6.511442e-04 3 1  ON 60
ci_062                -4.718668e-04 3 1  ON 61
ci_063                -6.414546e-04 3 1  ON 62
ci_064                -7.966643e-04 3 1  ON 63
ci_065                -1.770505e-03 3 1  ON 64
ci_066                -1.705304e-03 3 1  ON 65
ci_067                -1.645980e-03 3 1  ON 66
ci_068                -1.574830e-03 3 1  ON 67
ci_069                -6.408832e-05 3 1  ON 68
ci_070                 1.038575e-04 3 1  ON 69
ci_071                -1.475275e-03 3 1  ON 70
ci_072                -1.910214e-03 3 1  ON 71
ci_073                 1.006804e-04 3 1  ON 72
ci_074                 1.489032e-04 3 1  ON 73
ci_075                 1.207787e-04 3 1  ON 74
ci_076                 2.457454e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6284
    reference variance = 0.316104
====================================================
  Execution time = 2.5618e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5375e-01
  Total weights = 1.9548e+06
  Execution time = 3.6132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444609980748
                                         uncertainty =       0.003794026851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444609980748
                                         uncertainty =       0.003794026851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471540125
  error estimate for blocks of size 2^( 2) =       0.000495222665
  error estimate for blocks of size 2^( 3) =       0.000517042742
  error estimate for blocks of size 2^( 4) =       0.000532793930
  error estimate for blocks of size 2^( 5) =       0.000541195729
  error estimate for blocks of size 2^( 6) =       0.000547525652
  error estimate for blocks of size 2^( 7) =       0.000551444649

      target function =      -0.742242842904
              le_mean =     -22.662135527412
             les_mean =     514.026133887236
             stat err =       0.000543239990
             autocorr =       1.327229897523
   target nu stat err =       0.000543239990
   target dn stat err =       0.004103767724
      target stat err =       0.003388265707
              std dev =       0.666858440170
             le_variance =       0.444700179226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444633639131
                                         uncertainty =       0.003837754173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444633639131
                                         uncertainty =       0.003837754173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471552753
  error estimate for blocks of size 2^( 2) =       0.000495239773
  error estimate for blocks of size 2^( 3) =       0.000517061744
  error estimate for blocks of size 2^( 4) =       0.000532815379
  error estimate for blocks of size 2^( 5) =       0.000541217346
  error estimate for blocks of size 2^( 6) =       0.000547553806
  error estimate for blocks of size 2^( 7) =       0.000551474300

      target function =      -0.711576183209
              le_mean =     -22.662137162998
             les_mean =     514.064057987741
             stat err =       0.000543265208
             autocorr =       1.327282030498
   target nu stat err =       0.000543265208
   target dn stat err =       0.038078125274
      target stat err =       0.028496831340
              std dev =       0.666876299363
             le_variance =       0.444723998652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444620087399
                                         uncertainty =       0.003816012144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444620087399
                                         uncertainty =       0.003816012144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471545530
  error estimate for blocks of size 2^( 2) =       0.000495230425
  error estimate for blocks of size 2^( 3) =       0.000517051936
  error estimate for blocks of size 2^( 4) =       0.000532804225
  error estimate for blocks of size 2^( 5) =       0.000541205705
  error estimate for blocks of size 2^( 6) =       0.000547536016
  error estimate for blocks of size 2^( 7) =       0.000551456486

      target function =      -0.742203876254
              le_mean =     -22.662135735087
             les_mean =     514.026191063949
             stat err =       0.000543250608
             autocorr =       1.327251356929
   target nu stat err =       0.000543250608
   target dn stat err =       0.004123639311
      target stat err =       0.003403819828
              std dev =       0.666866083628
             le_variance =       0.444710373494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444611166129
                                         uncertainty =       0.003796766026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444611166129
                                         uncertainty =       0.003796766026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471540759
  error estimate for blocks of size 2^( 2) =       0.000495223598
  error estimate for blocks of size 2^( 3) =       0.000517043855
  error estimate for blocks of size 2^( 4) =       0.000532795183
  error estimate for blocks of size 2^( 5) =       0.000541196941
  error estimate for blocks of size 2^( 6) =       0.000547526910
  error estimate for blocks of size 2^( 7) =       0.000551446088

      target function =      -0.742246110831
              le_mean =     -22.662135546298
             les_mean =     514.026130701013
             stat err =       0.000543241281
             autocorr =       1.327232633405
   target nu stat err =       0.000543241281
   target dn stat err =       0.004106136618
      target stat err =       0.003390191118
              std dev =       0.666859337256
             le_variance =       0.444701375686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742242842904        initial
     1.0000e+00     1.0000e+01             1.3748e-04        -0.711576183209
     4.0000e+00     4.0000e+01             3.5372e-05        -0.742203876254
     1.6000e+01     1.6000e+02             8.9078e-06        -0.742246110831  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.7821e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
ci_001                -7.019288e-01 3 1  ON 0
ci_002                -7.060602e-01 3 1  ON 1
ci_003                -5.330001e-02 3 1  ON 2
ci_004                -5.426626e-02 3 1  ON 3
ci_005                 1.961883e-02 3 1  ON 4
ci_006                 1.974624e-02 3 1  ON 5
ci_007                 1.596625e-02 3 1  ON 6
ci_008                 1.584116e-02 3 1  ON 7
ci_009                -1.220988e-02 3 1  ON 8
ci_010                -1.258295e-02 3 1  ON 9
ci_011                -9.665902e-03 3 1  ON 10
ci_012                -9.810688e-03 3 1  ON 11
ci_013                 8.792413e-03 3 1  ON 12
ci_014                 8.759391e-03 3 1  ON 13
ci_015                 9.257466e-03 3 1  ON 14
ci_016                 9.526712e-03 3 1  ON 15
ci_017                 8.633342e-03 3 1  ON 16
ci_018                 8.251216e-03 3 1  ON 17
ci_019                -1.456817e-03 3 1  ON 18
ci_020                -1.280858e-03 3 1  ON 19
ci_021                -1.054465e-02 3 1  ON 20
ci_022                -1.121852e-02 3 1  ON 21
ci_023                 5.480060e-03 3 1  ON 22
ci_024                 5.219107e-03 3 1  ON 23
ci_025                 1.293331e-02 3 1  ON 24
ci_026                 1.257893e-02 3 1  ON 25
ci_027                 6.265703e-03 3 1  ON 26
ci_028                 6.242960e-03 3 1  ON 27
ci_029                -3.676046e-03 3 1  ON 28
ci_030                -4.407265e-03 3 1  ON 29
ci_031                 4.177672e-03 3 1  ON 30
ci_032                 3.773561e-03 3 1  ON 31
ci_033                 3.422694e-03 3 1  ON 32
ci_034                 3.344884e-03 3 1  ON 33
ci_035                 2.212924e-03 3 1  ON 34
ci_036                 2.106052e-03 3 1  ON 35
ci_037                 3.372025e-03 3 1  ON 36
ci_038                 3.319774e-03 3 1  ON 37
ci_039                 4.302594e-03 3 1  ON 38
ci_040                 4.412128e-03 3 1  ON 39
ci_041                 2.814382e-03 3 1  ON 40
ci_042                 2.893139e-03 3 1  ON 41
ci_043                 3.460064e-03 3 1  ON 42
ci_044                 3.131743e-03 3 1  ON 43
ci_045                 2.536659e-03 3 1  ON 44
ci_046                 2.922093e-03 3 1  ON 45
ci_047                -9.929174e-04 3 1  ON 46
ci_048                -1.149460e-03 3 1  ON 47
ci_049                 6.973362e-04 3 1  ON 48
ci_050                 7.591613e-04 3 1  ON 49
ci_051                -1.480680e-03 3 1  ON 50
ci_052                -1.328310e-03 3 1  ON 51
ci_053                -2.577224e-03 3 1  ON 52
ci_054                -2.676894e-03 3 1  ON 53
ci_055                -1.585925e-03 3 1  ON 54
ci_056                -1.301678e-03 3 1  ON 55
ci_057                -1.011844e-03 3 1  ON 56
ci_058                -9.540534e-04 3 1  ON 57
ci_059                -3.561960e-04 3 1  ON 58
ci_060                -2.356611e-04 3 1  ON 59
ci_061                -6.588917e-04 3 1  ON 60
ci_062                -4.641289e-04 3 1  ON 61
ci_063                -6.442944e-04 3 1  ON 62
ci_064                -7.918208e-04 3 1  ON 63
ci_065                -1.765765e-03 3 1  ON 64
ci_066                -1.698138e-03 3 1  ON 65
ci_067                -1.643758e-03 3 1  ON 66
ci_068                -1.579355e-03 3 1  ON 67
ci_069                -6.204998e-05 3 1  ON 68
ci_070                 1.146441e-04 3 1  ON 69
ci_071                -1.485531e-03 3 1  ON 70
ci_072                -1.913362e-03 3 1  ON 71
ci_073                 9.287869e-05 3 1  ON 72
ci_074                 1.509701e-04 3 1  ON 73
ci_075                 1.150622e-04 3 1  ON 74
ci_076                 2.441522e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6396
    reference variance = 0.350576
====================================================
  Execution time = 2.6081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4972e-01
  Total weights = 1.955168200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7499e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437431811799
                                         uncertainty =       0.001595578787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437431811799
                                         uncertainty =       0.001595578787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467645593
  error estimate for blocks of size 2^( 2) =       0.000491695955
  error estimate for blocks of size 2^( 3) =       0.000513624958
  error estimate for blocks of size 2^( 4) =       0.000529267289
  error estimate for blocks of size 2^( 5) =       0.000538937558
  error estimate for blocks of size 2^( 6) =       0.000541884097
  error estimate for blocks of size 2^( 7) =       0.000543597740

      target function =      -0.745527344532
              le_mean =     -22.661107094784
             les_mean =     513.975492998203
             stat err =       0.000538421671
             autocorr =       1.325596566417
   target nu stat err =       0.000538421671
   target dn stat err =       0.002820552870
      target stat err =       0.002383915845
              std dev =       0.661350740178
             le_variance =       0.437384801534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266110709478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745534068482       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745541478332       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745542897710       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745543115142       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745543131120       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745543163277       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745543218610       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745543224303       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745543236130       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745543238615       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745543244474       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745543243656       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 5.273296e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745534068482       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745535939988       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745536296662       residual = 9.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745536351013       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745536354948       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745536362973       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745536376696       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745536378099       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745536381035       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745536381635       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745536383064       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745536382861       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 1.318972e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745534068482       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745534537564       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745534626847       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745534640434       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745534641414       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745534643420       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745534646843       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745534647193       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745534647925       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745534648074       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745534648429       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745534648379       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.4000e+01 is 3.297840e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0841e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.019420e-01 3 1  ON 0
ci_002                -7.060474e-01 3 1  ON 1
ci_003                -5.329573e-02 3 1  ON 2
ci_004                -5.427873e-02 3 1  ON 3
ci_005                 1.961151e-02 3 1  ON 4
ci_006                 1.973581e-02 3 1  ON 5
ci_007                 1.596327e-02 3 1  ON 6
ci_008                 1.583773e-02 3 1  ON 7
ci_009                -1.220606e-02 3 1  ON 8
ci_010                -1.257647e-02 3 1  ON 9
ci_011                -9.663043e-03 3 1  ON 10
ci_012                -9.803827e-03 3 1  ON 11
ci_013                 8.788458e-03 3 1  ON 12
ci_014                 8.764581e-03 3 1  ON 13
ci_015                 9.244664e-03 3 1  ON 14
ci_016                 9.515562e-03 3 1  ON 15
ci_017                 8.629920e-03 3 1  ON 16
ci_018                 8.248602e-03 3 1  ON 17
ci_019                -1.466752e-03 3 1  ON 18
ci_020                -1.285235e-03 3 1  ON 19
ci_021                -1.054856e-02 3 1  ON 20
ci_022                -1.122175e-02 3 1  ON 21
ci_023                 5.478985e-03 3 1  ON 22
ci_024                 5.217007e-03 3 1  ON 23
ci_025                 1.293640e-02 3 1  ON 24
ci_026                 1.258742e-02 3 1  ON 25
ci_027                 6.266060e-03 3 1  ON 26
ci_028                 6.242559e-03 3 1  ON 27
ci_029                -3.679799e-03 3 1  ON 28
ci_030                -4.403784e-03 3 1  ON 29
ci_031                 4.188260e-03 3 1  ON 30
ci_032                 3.780020e-03 3 1  ON 31
ci_033                 3.420796e-03 3 1  ON 32
ci_034                 3.340927e-03 3 1  ON 33
ci_035                 2.212311e-03 3 1  ON 34
ci_036                 2.104940e-03 3 1  ON 35
ci_037                 3.373384e-03 3 1  ON 36
ci_038                 3.318137e-03 3 1  ON 37
ci_039                 4.303740e-03 3 1  ON 38
ci_040                 4.413521e-03 3 1  ON 39
ci_041                 2.812723e-03 3 1  ON 40
ci_042                 2.891296e-03 3 1  ON 41
ci_043                 3.460063e-03 3 1  ON 42
ci_044                 3.126921e-03 3 1  ON 43
ci_045                 2.535752e-03 3 1  ON 44
ci_046                 2.922884e-03 3 1  ON 45
ci_047                -9.934517e-04 3 1  ON 46
ci_048                -1.146950e-03 3 1  ON 47
ci_049                 6.951176e-04 3 1  ON 48
ci_050                 7.588254e-04 3 1  ON 49
ci_051                -1.480706e-03 3 1  ON 50
ci_052                -1.321680e-03 3 1  ON 51
ci_053                -2.582946e-03 3 1  ON 52
ci_054                -2.676709e-03 3 1  ON 53
ci_055                -1.598414e-03 3 1  ON 54
ci_056                -1.301334e-03 3 1  ON 55
ci_057                -1.010393e-03 3 1  ON 56
ci_058                -9.568420e-04 3 1  ON 57
ci_059                -3.550940e-04 3 1  ON 58
ci_060                -2.448689e-04 3 1  ON 59
ci_061                -6.598836e-04 3 1  ON 60
ci_062                -4.606973e-04 3 1  ON 61
ci_063                -6.449884e-04 3 1  ON 62
ci_064                -7.925965e-04 3 1  ON 63
ci_065                -1.768849e-03 3 1  ON 64
ci_066                -1.700093e-03 3 1  ON 65
ci_067                -1.645857e-03 3 1  ON 66
ci_068                -1.575376e-03 3 1  ON 67
ci_069                -6.074082e-05 3 1  ON 68
ci_070                 1.142130e-04 3 1  ON 69
ci_071                -1.486379e-03 3 1  ON 70
ci_072                -1.917937e-03 3 1  ON 71
ci_073                 9.233380e-05 3 1  ON 72
ci_074                 1.519149e-04 3 1  ON 73
ci_075                 1.150223e-04 3 1  ON 74
ci_076                 2.442357e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.5753
    reference variance = 0.348679
====================================================
  Execution time = 2.5627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4965e-01
  Total weights = 1.9550e+06
  Execution time = 3.6180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439759276043
                                         uncertainty =       0.002111518465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439759276043
                                         uncertainty =       0.002111518465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468883521
  error estimate for blocks of size 2^( 2) =       0.000492746346
  error estimate for blocks of size 2^( 3) =       0.000515173484
  error estimate for blocks of size 2^( 4) =       0.000530069927
  error estimate for blocks of size 2^( 5) =       0.000539539216
  error estimate for blocks of size 2^( 6) =       0.000544906099
  error estimate for blocks of size 2^( 7) =       0.000549875333

      target function =      -0.745566921545
              le_mean =     -22.661296178760
             les_mean =     513.984018025026
             stat err =       0.000541097644
             autocorr =       1.331745830592
   target nu stat err =       0.000541097644
   target dn stat err =       0.002731991522
      target stat err =       0.002315373649
              std dev =       0.663101434946
             le_variance =       0.439703513028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439745754223
                                         uncertainty =       0.002112126461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439745754223
                                         uncertainty =       0.002112126461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468876318
  error estimate for blocks of size 2^( 2) =       0.000492741373
  error estimate for blocks of size 2^( 3) =       0.000515168852
  error estimate for blocks of size 2^( 4) =       0.000530065859
  error estimate for blocks of size 2^( 5) =       0.000539536258
  error estimate for blocks of size 2^( 6) =       0.000544903053
  error estimate for blocks of size 2^( 7) =       0.000549872960

      target function =      -0.745576603673
              le_mean =     -22.661296024246
             les_mean =     513.983999195625
             stat err =       0.000541094532
             autocorr =       1.331771434730
   target nu stat err =       0.000541094532
   target dn stat err =       0.002732510465
      target stat err =       0.002315841236
              std dev =       0.663091247843
             le_variance =       0.439690002967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439752368221
                                         uncertainty =       0.002111823404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439752368221
                                         uncertainty =       0.002111823404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468879841
  error estimate for blocks of size 2^( 2) =       0.000492743794
  error estimate for blocks of size 2^( 3) =       0.000515171104
  error estimate for blocks of size 2^( 4) =       0.000530067835
  error estimate for blocks of size 2^( 5) =       0.000539537685
  error estimate for blocks of size 2^( 6) =       0.000544904526
  error estimate for blocks of size 2^( 7) =       0.000549874106

      target function =      -0.745599593530
              le_mean =     -22.661296093105
             les_mean =     513.983974255028
             stat err =       0.000541096038
             autocorr =       1.331758830157
   target nu stat err =       0.000541096038
   target dn stat err =       0.002731967638
      target stat err =       0.002315550238
              std dev =       0.663096230709
             le_variance =       0.439696611181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439758399908
                                         uncertainty =       0.002111556429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439758399908
                                         uncertainty =       0.002111556429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468883055
  error estimate for blocks of size 2^( 2) =       0.000492746021
  error estimate for blocks of size 2^( 3) =       0.000515173180
  error estimate for blocks of size 2^( 4) =       0.000530069660
  error estimate for blocks of size 2^( 5) =       0.000539539019
  error estimate for blocks of size 2^( 6) =       0.000544905896
  error estimate for blocks of size 2^( 7) =       0.000549875174

      target function =      -0.745573354619
              le_mean =     -22.661296166785
             les_mean =     513.984009628310
             stat err =       0.000541097437
             autocorr =       1.331747464747
   target nu stat err =       0.000541097437
   target dn stat err =       0.002731968167
      target stat err =       0.002315393699
              std dev =       0.663100774879
             le_variance =       0.439702637645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745566921545        initial
     4.0000e+00     4.0000e+01             5.2733e-05        -0.745576603673
     1.6000e+01     1.6000e+02             1.3190e-05        -0.745599593530  <--
     6.4000e+01     6.4000e+02             3.2978e-06        -0.745573354619

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 4.3891e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
ci_001                -7.019420e-01 3 1  ON 0
ci_002                -7.060474e-01 3 1  ON 1
ci_003                -5.329573e-02 3 1  ON 2
ci_004                -5.427873e-02 3 1  ON 3
ci_005                 1.961151e-02 3 1  ON 4
ci_006                 1.973581e-02 3 1  ON 5
ci_007                 1.596327e-02 3 1  ON 6
ci_008                 1.583773e-02 3 1  ON 7
ci_009                -1.220606e-02 3 1  ON 8
ci_010                -1.257647e-02 3 1  ON 9
ci_011                -9.663043e-03 3 1  ON 10
ci_012                -9.803827e-03 3 1  ON 11
ci_013                 8.788458e-03 3 1  ON 12
ci_014                 8.764581e-03 3 1  ON 13
ci_015                 9.244664e-03 3 1  ON 14
ci_016                 9.515562e-03 3 1  ON 15
ci_017                 8.629920e-03 3 1  ON 16
ci_018                 8.248602e-03 3 1  ON 17
ci_019                -1.466752e-03 3 1  ON 18
ci_020                -1.285235e-03 3 1  ON 19
ci_021                -1.054856e-02 3 1  ON 20
ci_022                -1.122175e-02 3 1  ON 21
ci_023                 5.478985e-03 3 1  ON 22
ci_024                 5.217007e-03 3 1  ON 23
ci_025                 1.293640e-02 3 1  ON 24
ci_026                 1.258742e-02 3 1  ON 25
ci_027                 6.266060e-03 3 1  ON 26
ci_028                 6.242559e-03 3 1  ON 27
ci_029                -3.679799e-03 3 1  ON 28
ci_030                -4.403784e-03 3 1  ON 29
ci_031                 4.188260e-03 3 1  ON 30
ci_032                 3.780020e-03 3 1  ON 31
ci_033                 3.420796e-03 3 1  ON 32
ci_034                 3.340927e-03 3 1  ON 33
ci_035                 2.212311e-03 3 1  ON 34
ci_036                 2.104940e-03 3 1  ON 35
ci_037                 3.373384e-03 3 1  ON 36
ci_038                 3.318137e-03 3 1  ON 37
ci_039                 4.303740e-03 3 1  ON 38
ci_040                 4.413521e-03 3 1  ON 39
ci_041                 2.812723e-03 3 1  ON 40
ci_042                 2.891296e-03 3 1  ON 41
ci_043                 3.460063e-03 3 1  ON 42
ci_044                 3.126921e-03 3 1  ON 43
ci_045                 2.535752e-03 3 1  ON 44
ci_046                 2.922884e-03 3 1  ON 45
ci_047                -9.934517e-04 3 1  ON 46
ci_048                -1.146950e-03 3 1  ON 47
ci_049                 6.951176e-04 3 1  ON 48
ci_050                 7.588254e-04 3 1  ON 49
ci_051                -1.480706e-03 3 1  ON 50
ci_052                -1.321680e-03 3 1  ON 51
ci_053                -2.582946e-03 3 1  ON 52
ci_054                -2.676709e-03 3 1  ON 53
ci_055                -1.598414e-03 3 1  ON 54
ci_056                -1.301334e-03 3 1  ON 55
ci_057                -1.010393e-03 3 1  ON 56
ci_058                -9.568420e-04 3 1  ON 57
ci_059                -3.550940e-04 3 1  ON 58
ci_060                -2.448689e-04 3 1  ON 59
ci_061                -6.598836e-04 3 1  ON 60
ci_062                -4.606973e-04 3 1  ON 61
ci_063                -6.449884e-04 3 1  ON 62
ci_064                -7.925965e-04 3 1  ON 63
ci_065                -1.768849e-03 3 1  ON 64
ci_066                -1.700093e-03 3 1  ON 65
ci_067                -1.645857e-03 3 1  ON 66
ci_068                -1.575376e-03 3 1  ON 67
ci_069                -6.074082e-05 3 1  ON 68
ci_070                 1.142130e-04 3 1  ON 69
ci_071                -1.486379e-03 3 1  ON 70
ci_072                -1.917937e-03 3 1  ON 71
ci_073                 9.233380e-05 3 1  ON 72
ci_074                 1.519149e-04 3 1  ON 73
ci_075                 1.150223e-04 3 1  ON 74
ci_076                 2.442357e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2648e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6706
    reference variance = 0.396404
====================================================
  Execution time = 2.6482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5260e-01
  Total weights = 1.955055398e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442160214978
                                         uncertainty =       0.004106955979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442160214978
                                         uncertainty =       0.004106955979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470219029
  error estimate for blocks of size 2^( 2) =       0.000494240665
  error estimate for blocks of size 2^( 3) =       0.000516636487
  error estimate for blocks of size 2^( 4) =       0.000532998250
  error estimate for blocks of size 2^( 5) =       0.000542372139
  error estimate for blocks of size 2^( 6) =       0.000547162344
  error estimate for blocks of size 2^( 7) =       0.000551150212

      target function =      -0.743166233039
              le_mean =     -22.661644639725
             les_mean =     514.002737500632
             stat err =       0.000543420736
             autocorr =       1.335586472175
   target nu stat err =       0.000543420736
   target dn stat err =       0.004889447898
      target stat err =       0.004025571043
              std dev =       0.664990128696
             le_variance =       0.442211871263


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266164463972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743187247091       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743192317006       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743193417183       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743193728104       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743193892767       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743194018858       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743194032729       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743194045586       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743194060750       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743194065166       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743194065324       residual = 6.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 8.965400e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743187247091       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743188525700       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743188801716       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743188879578       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743188920547       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743188951807       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743188955208       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743188958382       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743188962110       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743188963179       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743188963212       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 2.247871e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743187247091       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743187567446       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743187636511       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743187655985       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743187666214       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743187674013       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743187674859       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743187675650       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743187676578       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743187676843       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743187676851       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.4000e+01 is 5.623769e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1255e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.019265e-01 3 1  ON 0
ci_002                -7.060657e-01 3 1  ON 1
ci_003                -5.328722e-02 3 1  ON 2
ci_004                -5.425626e-02 3 1  ON 3
ci_005                 1.961169e-02 3 1  ON 4
ci_006                 1.972933e-02 3 1  ON 5
ci_007                 1.595655e-02 3 1  ON 6
ci_008                 1.583548e-02 3 1  ON 7
ci_009                -1.220807e-02 3 1  ON 8
ci_010                -1.257349e-02 3 1  ON 9
ci_011                -9.655596e-03 3 1  ON 10
ci_012                -9.799217e-03 3 1  ON 11
ci_013                 8.782883e-03 3 1  ON 12
ci_014                 8.757485e-03 3 1  ON 13
ci_015                 9.239371e-03 3 1  ON 14
ci_016                 9.509295e-03 3 1  ON 15
ci_017                 8.631398e-03 3 1  ON 16
ci_018                 8.248756e-03 3 1  ON 17
ci_019                -1.478698e-03 3 1  ON 18
ci_020                -1.295949e-03 3 1  ON 19
ci_021                -1.054742e-02 3 1  ON 20
ci_022                -1.122976e-02 3 1  ON 21
ci_023                 5.477885e-03 3 1  ON 22
ci_024                 5.214025e-03 3 1  ON 23
ci_025                 1.294694e-02 3 1  ON 24
ci_026                 1.258952e-02 3 1  ON 25
ci_027                 6.259849e-03 3 1  ON 26
ci_028                 6.243518e-03 3 1  ON 27
ci_029                -3.683352e-03 3 1  ON 28
ci_030                -4.407190e-03 3 1  ON 29
ci_031                 4.196894e-03 3 1  ON 30
ci_032                 3.785749e-03 3 1  ON 31
ci_033                 3.415832e-03 3 1  ON 32
ci_034                 3.341697e-03 3 1  ON 33
ci_035                 2.212489e-03 3 1  ON 34
ci_036                 2.102061e-03 3 1  ON 35
ci_037                 3.371797e-03 3 1  ON 36
ci_038                 3.317335e-03 3 1  ON 37
ci_039                 4.304016e-03 3 1  ON 38
ci_040                 4.412198e-03 3 1  ON 39
ci_041                 2.812188e-03 3 1  ON 40
ci_042                 2.890732e-03 3 1  ON 41
ci_043                 3.452972e-03 3 1  ON 42
ci_044                 3.127377e-03 3 1  ON 43
ci_045                 2.535587e-03 3 1  ON 44
ci_046                 2.921025e-03 3 1  ON 45
ci_047                -9.934151e-04 3 1  ON 46
ci_048                -1.149224e-03 3 1  ON 47
ci_049                 6.973788e-04 3 1  ON 48
ci_050                 7.602653e-04 3 1  ON 49
ci_051                -1.479038e-03 3 1  ON 50
ci_052                -1.322857e-03 3 1  ON 51
ci_053                -2.584641e-03 3 1  ON 52
ci_054                -2.673147e-03 3 1  ON 53
ci_055                -1.598883e-03 3 1  ON 54
ci_056                -1.305792e-03 3 1  ON 55
ci_057                -1.012729e-03 3 1  ON 56
ci_058                -9.577446e-04 3 1  ON 57
ci_059                -3.585720e-04 3 1  ON 58
ci_060                -2.461670e-04 3 1  ON 59
ci_061                -6.568116e-04 3 1  ON 60
ci_062                -4.594916e-04 3 1  ON 61
ci_063                -6.437825e-04 3 1  ON 62
ci_064                -7.947992e-04 3 1  ON 63
ci_065                -1.768234e-03 3 1  ON 64
ci_066                -1.694438e-03 3 1  ON 65
ci_067                -1.645627e-03 3 1  ON 66
ci_068                -1.575507e-03 3 1  ON 67
ci_069                -6.048850e-05 3 1  ON 68
ci_070                 1.124500e-04 3 1  ON 69
ci_071                -1.485910e-03 3 1  ON 70
ci_072                -1.919531e-03 3 1  ON 71
ci_073                 9.279097e-05 3 1  ON 72
ci_074                 1.519331e-04 3 1  ON 73
ci_075                 1.179722e-04 3 1  ON 74
ci_076                 2.487508e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7668
    reference variance = 0.471552
====================================================
  Execution time = 2.5679e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4904e-01
  Total weights = 1.9551e+06
  Execution time = 3.6204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439777054243
                                         uncertainty =       0.001910799659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439777054243
                                         uncertainty =       0.001910799659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468928750
  error estimate for blocks of size 2^( 2) =       0.000493374955
  error estimate for blocks of size 2^( 3) =       0.000516002793
  error estimate for blocks of size 2^( 4) =       0.000532068675
  error estimate for blocks of size 2^( 5) =       0.000542004712
  error estimate for blocks of size 2^( 6) =       0.000545751931
  error estimate for blocks of size 2^( 7) =       0.000547876962

      target function =      -0.746107283143
              le_mean =     -22.661885813974
             les_mean =     514.010093676244
             stat err =       0.000541925570
             autocorr =       1.335566649984
   target nu stat err =       0.000541925570
   target dn stat err =       0.002552017728
      target stat err =       0.002178401720
              std dev =       0.663165397884
             le_variance =       0.439788344951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771528424
                                         uncertainty =       0.001911372185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771528424
                                         uncertainty =       0.001911372185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468925771
  error estimate for blocks of size 2^( 2) =       0.000493372455
  error estimate for blocks of size 2^( 3) =       0.000516000163
  error estimate for blocks of size 2^( 4) =       0.000532065872
  error estimate for blocks of size 2^( 5) =       0.000542001074
  error estimate for blocks of size 2^( 6) =       0.000545747246
  error estimate for blocks of size 2^( 7) =       0.000547872668

      target function =      -0.746022312750
              le_mean =     -22.661885220569
             les_mean =     514.010170237864
             stat err =       0.000541921715
             autocorr =       1.335564616502
   target nu stat err =       0.000541921715
   target dn stat err =       0.002559892173
      target stat err =       0.002184138384
              std dev =       0.663161185455
             le_variance =       0.439782757895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439774182754
                                         uncertainty =       0.001911084844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439774182754
                                         uncertainty =       0.001911084844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468927203
  error estimate for blocks of size 2^( 2) =       0.000493373656
  error estimate for blocks of size 2^( 3) =       0.000516001425
  error estimate for blocks of size 2^( 4) =       0.000532067217
  error estimate for blocks of size 2^( 5) =       0.000542002825
  error estimate for blocks of size 2^( 6) =       0.000545749523
  error estimate for blocks of size 2^( 7) =       0.000547874753

      target function =      -0.746084134226
              le_mean =     -22.661885513177
             les_mean =     514.010108217008
             stat err =       0.000541923579
             autocorr =       1.335565652943
   target nu stat err =       0.000541923579
   target dn stat err =       0.002555387386
      target stat err =       0.002180930850
              std dev =       0.663163209649
             le_variance =       0.439785442631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439776685121
                                         uncertainty =       0.001910835089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439776685121
                                         uncertainty =       0.001910835089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468928551
  error estimate for blocks of size 2^( 2) =       0.000493374788
  error estimate for blocks of size 2^( 3) =       0.000516002617
  error estimate for blocks of size 2^( 4) =       0.000532068488
  error estimate for blocks of size 2^( 5) =       0.000542004471
  error estimate for blocks of size 2^( 6) =       0.000545751625
  error estimate for blocks of size 2^( 7) =       0.000547876681

      target function =      -0.746105086163
              le_mean =     -22.661885775837
             les_mean =     514.010094620957
             stat err =       0.000541925316
             autocorr =       1.335566533635
   target nu stat err =       0.000541925316
   target dn stat err =       0.002552416947
      target stat err =       0.002178704415
              std dev =       0.663165116675
             le_variance =       0.439787971975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746107283143        initial  <--
     4.0000e+00     4.0000e+01             8.9654e-05        -0.746022312750
     1.6000e+01     1.6000e+02             2.2479e-05        -0.746084134226
     6.4000e+01     6.4000e+02             5.6238e-06        -0.746105086163

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.1277
  </log>
  <optVariables href="FORM.s007.opt.xml">
ci_001                -7.019420e-01 3 1  ON 0
ci_002                -7.060474e-01 3 1  ON 1
ci_003                -5.329573e-02 3 1  ON 2
ci_004                -5.427873e-02 3 1  ON 3
ci_005                 1.961151e-02 3 1  ON 4
ci_006                 1.973581e-02 3 1  ON 5
ci_007                 1.596327e-02 3 1  ON 6
ci_008                 1.583773e-02 3 1  ON 7
ci_009                -1.220606e-02 3 1  ON 8
ci_010                -1.257647e-02 3 1  ON 9
ci_011                -9.663043e-03 3 1  ON 10
ci_012                -9.803827e-03 3 1  ON 11
ci_013                 8.788458e-03 3 1  ON 12
ci_014                 8.764581e-03 3 1  ON 13
ci_015                 9.244664e-03 3 1  ON 14
ci_016                 9.515562e-03 3 1  ON 15
ci_017                 8.629920e-03 3 1  ON 16
ci_018                 8.248602e-03 3 1  ON 17
ci_019                -1.466752e-03 3 1  ON 18
ci_020                -1.285235e-03 3 1  ON 19
ci_021                -1.054856e-02 3 1  ON 20
ci_022                -1.122175e-02 3 1  ON 21
ci_023                 5.478985e-03 3 1  ON 22
ci_024                 5.217007e-03 3 1  ON 23
ci_025                 1.293640e-02 3 1  ON 24
ci_026                 1.258742e-02 3 1  ON 25
ci_027                 6.266060e-03 3 1  ON 26
ci_028                 6.242559e-03 3 1  ON 27
ci_029                -3.679799e-03 3 1  ON 28
ci_030                -4.403784e-03 3 1  ON 29
ci_031                 4.188260e-03 3 1  ON 30
ci_032                 3.780020e-03 3 1  ON 31
ci_033                 3.420796e-03 3 1  ON 32
ci_034                 3.340927e-03 3 1  ON 33
ci_035                 2.212311e-03 3 1  ON 34
ci_036                 2.104940e-03 3 1  ON 35
ci_037                 3.373384e-03 3 1  ON 36
ci_038                 3.318137e-03 3 1  ON 37
ci_039                 4.303740e-03 3 1  ON 38
ci_040                 4.413521e-03 3 1  ON 39
ci_041                 2.812723e-03 3 1  ON 40
ci_042                 2.891296e-03 3 1  ON 41
ci_043                 3.460063e-03 3 1  ON 42
ci_044                 3.126921e-03 3 1  ON 43
ci_045                 2.535752e-03 3 1  ON 44
ci_046                 2.922884e-03 3 1  ON 45
ci_047                -9.934517e-04 3 1  ON 46
ci_048                -1.146950e-03 3 1  ON 47
ci_049                 6.951176e-04 3 1  ON 48
ci_050                 7.588254e-04 3 1  ON 49
ci_051                -1.480706e-03 3 1  ON 50
ci_052                -1.321680e-03 3 1  ON 51
ci_053                -2.582946e-03 3 1  ON 52
ci_054                -2.676709e-03 3 1  ON 53
ci_055                -1.598414e-03 3 1  ON 54
ci_056                -1.301334e-03 3 1  ON 55
ci_057                -1.010393e-03 3 1  ON 56
ci_058                -9.568420e-04 3 1  ON 57
ci_059                -3.550940e-04 3 1  ON 58
ci_060                -2.448689e-04 3 1  ON 59
ci_061                -6.598836e-04 3 1  ON 60
ci_062                -4.606973e-04 3 1  ON 61
ci_063                -6.449884e-04 3 1  ON 62
ci_064                -7.925965e-04 3 1  ON 63
ci_065                -1.768849e-03 3 1  ON 64
ci_066                -1.700093e-03 3 1  ON 65
ci_067                -1.645857e-03 3 1  ON 66
ci_068                -1.575376e-03 3 1  ON 67
ci_069                -6.074082e-05 3 1  ON 68
ci_070                 1.142130e-04 3 1  ON 69
ci_071                -1.486379e-03 3 1  ON 70
ci_072                -1.917937e-03 3 1  ON 71
ci_073                 9.233380e-05 3 1  ON 72
ci_074                 1.519149e-04 3 1  ON 73
ci_075                 1.150223e-04 3 1  ON 74
ci_076                 2.442357e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7162
    reference variance = 0.304965
====================================================
  Execution time = 2.6119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4929e-01
  Total weights = 1.955030497e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440628878249
                                         uncertainty =       0.002096229470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440628878249
                                         uncertainty =       0.002096229470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469344211
  error estimate for blocks of size 2^( 2) =       0.000493303666
  error estimate for blocks of size 2^( 3) =       0.000515429231
  error estimate for blocks of size 2^( 4) =       0.000531133658
  error estimate for blocks of size 2^( 5) =       0.000540214466
  error estimate for blocks of size 2^( 6) =       0.000546225688
  error estimate for blocks of size 2^( 7) =       0.000546572825

      target function =      -0.745897112716
              le_mean =     -22.662145275086
             les_mean =     514.022113612318
             stat err =       0.000541036659
             autocorr =       1.328833149598
   target nu stat err =       0.000541036659
   target dn stat err =       0.002517452783
      target stat err =       0.002150508574
              std dev =       0.663752948867
             le_variance =       0.440567977130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266214527509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745902440380       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745902753535       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745902833914       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745902845480       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745902847805       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745902848713       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745902849627       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745902849642       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745902849792       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745902849635       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745902849557       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745902849576       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 4.580765e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745902440380       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745902518740       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745902538845       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745902541737       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745902542318       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745902542545       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745902542773       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745902542776       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745902542814       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745902542775       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745902542755       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745902542760       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+02 is 1.146002e-06

solving harmonic davidson linear method for identity shift 6.4000e+02, overlap shift 6.4000e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745902440380       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745902459975       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745902465002       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745902465725       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745902465870       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745902465927       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745902465984       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745902465985       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745902465994       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745902465982       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745902465979       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745902465980       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.4000e+02 is 2.865511e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0860e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.019414e-01 3 1  ON 0
ci_002                -7.060481e-01 3 1  ON 1
ci_003                -5.329492e-02 3 1  ON 2
ci_004                -5.427885e-02 3 1  ON 3
ci_005                 1.961125e-02 3 1  ON 4
ci_006                 1.973546e-02 3 1  ON 5
ci_007                 1.596315e-02 3 1  ON 6
ci_008                 1.583749e-02 3 1  ON 7
ci_009                -1.220579e-02 3 1  ON 8
ci_010                -1.257630e-02 3 1  ON 9
ci_011                -9.662487e-03 3 1  ON 10
ci_012                -9.803262e-03 3 1  ON 11
ci_013                 8.788367e-03 3 1  ON 12
ci_014                 8.764208e-03 3 1  ON 13
ci_015                 9.244119e-03 3 1  ON 14
ci_016                 9.515337e-03 3 1  ON 15
ci_017                 8.630170e-03 3 1  ON 16
ci_018                 8.248578e-03 3 1  ON 17
ci_019                -1.467889e-03 3 1  ON 18
ci_020                -1.286381e-03 3 1  ON 19
ci_021                -1.054899e-02 3 1  ON 20
ci_022                -1.122201e-02 3 1  ON 21
ci_023                 5.478604e-03 3 1  ON 22
ci_024                 5.217145e-03 3 1  ON 23
ci_025                 1.293627e-02 3 1  ON 24
ci_026                 1.258853e-02 3 1  ON 25
ci_027                 6.266286e-03 3 1  ON 26
ci_028                 6.242584e-03 3 1  ON 27
ci_029                -3.679706e-03 3 1  ON 28
ci_030                -4.403559e-03 3 1  ON 29
ci_031                 4.188557e-03 3 1  ON 30
ci_032                 3.780477e-03 3 1  ON 31
ci_033                 3.420557e-03 3 1  ON 32
ci_034                 3.340815e-03 3 1  ON 33
ci_035                 2.212149e-03 3 1  ON 34
ci_036                 2.104511e-03 3 1  ON 35
ci_037                 3.373376e-03 3 1  ON 36
ci_038                 3.317852e-03 3 1  ON 37
ci_039                 4.303664e-03 3 1  ON 38
ci_040                 4.413256e-03 3 1  ON 39
ci_041                 2.812554e-03 3 1  ON 40
ci_042                 2.890825e-03 3 1  ON 41
ci_043                 3.459800e-03 3 1  ON 42
ci_044                 3.126777e-03 3 1  ON 43
ci_045                 2.536058e-03 3 1  ON 44
ci_046                 2.923100e-03 3 1  ON 45
ci_047                -9.936721e-04 3 1  ON 46
ci_048                -1.146697e-03 3 1  ON 47
ci_049                 6.953480e-04 3 1  ON 48
ci_050                 7.590579e-04 3 1  ON 49
ci_051                -1.480553e-03 3 1  ON 50
ci_052                -1.321594e-03 3 1  ON 51
ci_053                -2.583623e-03 3 1  ON 52
ci_054                -2.676297e-03 3 1  ON 53
ci_055                -1.597982e-03 3 1  ON 54
ci_056                -1.301203e-03 3 1  ON 55
ci_057                -1.010274e-03 3 1  ON 56
ci_058                -9.570126e-04 3 1  ON 57
ci_059                -3.552219e-04 3 1  ON 58
ci_060                -2.447712e-04 3 1  ON 59
ci_061                -6.597811e-04 3 1  ON 60
ci_062                -4.608773e-04 3 1  ON 61
ci_063                -6.449668e-04 3 1  ON 62
ci_064                -7.925634e-04 3 1  ON 63
ci_065                -1.769109e-03 3 1  ON 64
ci_066                -1.700270e-03 3 1  ON 65
ci_067                -1.645564e-03 3 1  ON 66
ci_068                -1.575162e-03 3 1  ON 67
ci_069                -6.093122e-05 3 1  ON 68
ci_070                 1.142241e-04 3 1  ON 69
ci_071                -1.486504e-03 3 1  ON 70
ci_072                -1.917884e-03 3 1  ON 71
ci_073                 9.202777e-05 3 1  ON 72
ci_074                 1.520350e-04 3 1  ON 73
ci_075                 1.149888e-04 3 1  ON 74
ci_076                 2.440162e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6821
    reference variance = 0.407951
====================================================
  Execution time = 2.5737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4736e-01
  Total weights = 1.9553e+06
  Execution time = 3.6048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439491320167
                                         uncertainty =       0.001982373645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439491320167
                                         uncertainty =       0.001982373645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468739515
  error estimate for blocks of size 2^( 2) =       0.000492843640
  error estimate for blocks of size 2^( 3) =       0.000514861358
  error estimate for blocks of size 2^( 4) =       0.000531007481
  error estimate for blocks of size 2^( 5) =       0.000541472329
  error estimate for blocks of size 2^( 6) =       0.000546277500
  error estimate for blocks of size 2^( 7) =       0.000548107952

      target function =      -0.747467499289
              le_mean =     -22.661519369726
             les_mean =     513.991825995492
             stat err =       0.000541716315
             autocorr =       1.335613191037
   target nu stat err =       0.000541716315
   target dn stat err =       0.002288432124
      target stat err =       0.001976878876
              std dev =       0.662897778824
             le_variance =       0.439433465170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439490473982
                                         uncertainty =       0.001982358801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439490473982
                                         uncertainty =       0.001982358801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468739064
  error estimate for blocks of size 2^( 2) =       0.000492843239
  error estimate for blocks of size 2^( 3) =       0.000514861024
  error estimate for blocks of size 2^( 4) =       0.000531007133
  error estimate for blocks of size 2^( 5) =       0.000541472004
  error estimate for blocks of size 2^( 6) =       0.000546277079
  error estimate for blocks of size 2^( 7) =       0.000548107567

      target function =      -0.747472086714
              le_mean =     -22.661519376888
             les_mean =     513.991820750343
             stat err =       0.000541715946
             autocorr =       1.335613937530
   target nu stat err =       0.000541715946
   target dn stat err =       0.002288330594
      target stat err =       0.001976822219
              std dev =       0.662897141117
             le_variance =       0.439432619701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439490896405
                                         uncertainty =       0.001982366203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439490896405
                                         uncertainty =       0.001982366203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468739289
  error estimate for blocks of size 2^( 2) =       0.000492843439
  error estimate for blocks of size 2^( 3) =       0.000514861191
  error estimate for blocks of size 2^( 4) =       0.000531007307
  error estimate for blocks of size 2^( 5) =       0.000541472166
  error estimate for blocks of size 2^( 6) =       0.000546277289
  error estimate for blocks of size 2^( 7) =       0.000548107759

      target function =      -0.747469836298
              le_mean =     -22.661519373231
             les_mean =     513.991823316886
             stat err =       0.000541716130
             autocorr =       1.335613564898
   target nu stat err =       0.000541716130
   target dn stat err =       0.002288379868
      target stat err =       0.001976849596
              std dev =       0.662897459466
             le_variance =       0.439433041766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439491267149
                                         uncertainty =       0.001982372713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439491267149
                                         uncertainty =       0.001982372713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468739486
  error estimate for blocks of size 2^( 2) =       0.000492843615
  error estimate for blocks of size 2^( 3) =       0.000514861337
  error estimate for blocks of size 2^( 4) =       0.000531007459
  error estimate for blocks of size 2^( 5) =       0.000541472308
  error estimate for blocks of size 2^( 6) =       0.000546277474
  error estimate for blocks of size 2^( 7) =       0.000548107928

      target function =      -0.747467796190
              le_mean =     -22.661519370156
             les_mean =     513.991825654488
             stat err =       0.000541716292
             autocorr =       1.335613237790
   target nu stat err =       0.000541716292
   target dn stat err =       0.002288425424
      target stat err =       0.001976875108
              std dev =       0.662897738869
             le_variance =       0.439433412198


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747467499289        initial
     4.0000e+01     4.0000e+02             4.5808e-06        -0.747472086714  <--
     1.6000e+02     1.6000e+03             1.1460e-06        -0.747469836298
     6.4000e+02     6.4000e+03             2.8655e-07        -0.747467796190

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 4.3957e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
ci_001                -7.019396e-01 3 1  ON 0
ci_002                -7.060502e-01 3 1  ON 1
ci_003                -5.329250e-02 3 1  ON 2
ci_004                -5.427921e-02 3 1  ON 3
ci_005                 1.961046e-02 3 1  ON 4
ci_006                 1.973443e-02 3 1  ON 5
ci_007                 1.596281e-02 3 1  ON 6
ci_008                 1.583677e-02 3 1  ON 7
ci_009                -1.220498e-02 3 1  ON 8
ci_010                -1.257578e-02 3 1  ON 9
ci_011                -9.660822e-03 3 1  ON 10
ci_012                -9.801569e-03 3 1  ON 11
ci_013                 8.788094e-03 3 1  ON 12
ci_014                 8.763090e-03 3 1  ON 13
ci_015                 9.242487e-03 3 1  ON 14
ci_016                 9.514664e-03 3 1  ON 15
ci_017                 8.630921e-03 3 1  ON 16
ci_018                 8.248508e-03 3 1  ON 17
ci_019                -1.471299e-03 3 1  ON 18
ci_020                -1.289816e-03 3 1  ON 19
ci_021                -1.055031e-02 3 1  ON 20
ci_022                -1.122281e-02 3 1  ON 21
ci_023                 5.477460e-03 3 1  ON 22
ci_024                 5.217556e-03 3 1  ON 23
ci_025                 1.293591e-02 3 1  ON 24
ci_026                 1.259187e-02 3 1  ON 25
ci_027                 6.266962e-03 3 1  ON 26
ci_028                 6.242659e-03 3 1  ON 27
ci_029                -3.679425e-03 3 1  ON 28
ci_030                -4.402886e-03 3 1  ON 29
ci_031                 4.189445e-03 3 1  ON 30
ci_032                 3.781849e-03 3 1  ON 31
ci_033                 3.419840e-03 3 1  ON 32
ci_034                 3.340481e-03 3 1  ON 33
ci_035                 2.211664e-03 3 1  ON 34
ci_036                 2.103224e-03 3 1  ON 35
ci_037                 3.373355e-03 3 1  ON 36
ci_038                 3.316997e-03 3 1  ON 37
ci_039                 4.303435e-03 3 1  ON 38
ci_040                 4.412460e-03 3 1  ON 39
ci_041                 2.812048e-03 3 1  ON 40
ci_042                 2.889412e-03 3 1  ON 41
ci_043                 3.459013e-03 3 1  ON 42
ci_044                 3.126348e-03 3 1  ON 43
ci_045                 2.536974e-03 3 1  ON 44
ci_046                 2.923748e-03 3 1  ON 45
ci_047                -9.943321e-04 3 1  ON 46
ci_048                -1.145939e-03 3 1  ON 47
ci_049                 6.960384e-04 3 1  ON 48
ci_050                 7.597546e-04 3 1  ON 49
ci_051                -1.480092e-03 3 1  ON 50
ci_052                -1.321339e-03 3 1  ON 51
ci_053                -2.585651e-03 3 1  ON 52
ci_054                -2.675062e-03 3 1  ON 53
ci_055                -1.596689e-03 3 1  ON 54
ci_056                -1.300807e-03 3 1  ON 55
ci_057                -1.009919e-03 3 1  ON 56
ci_058                -9.575237e-04 3 1  ON 57
ci_059                -3.556050e-04 3 1  ON 58
ci_060                -2.444785e-04 3 1  ON 59
ci_061                -6.594740e-04 3 1  ON 60
ci_062                -4.614165e-04 3 1  ON 61
ci_063                -6.449020e-04 3 1  ON 62
ci_064                -7.924641e-04 3 1  ON 63
ci_065                -1.769887e-03 3 1  ON 64
ci_066                -1.700799e-03 3 1  ON 65
ci_067                -1.644686e-03 3 1  ON 66
ci_068                -1.574521e-03 3 1  ON 67
ci_069                -6.150171e-05 3 1  ON 68
ci_070                 1.142576e-04 3 1  ON 69
ci_071                -1.486878e-03 3 1  ON 70
ci_072                -1.917727e-03 3 1  ON 71
ci_073                 9.111084e-05 3 1  ON 72
ci_074                 1.523946e-04 3 1  ON 73
ci_075                 1.148885e-04 3 1  ON 74
ci_076                 2.433586e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4973e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6938
    reference variance = 0.413503
====================================================
  Execution time = 2.6070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5289e-01
  Total weights = 1.955427773e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444759840964
                                         uncertainty =       0.002881549845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444759840964
                                         uncertainty =       0.002881549845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471564891
  error estimate for blocks of size 2^( 2) =       0.000495686797
  error estimate for blocks of size 2^( 3) =       0.000517653265
  error estimate for blocks of size 2^( 4) =       0.000532871674
  error estimate for blocks of size 2^( 5) =       0.000543000893
  error estimate for blocks of size 2^( 6) =       0.000547341171
  error estimate for blocks of size 2^( 7) =       0.000549687042

      target function =      -0.742942370483
              le_mean =     -22.661528357517
             les_mean =     513.997753481043
             stat err =       0.000543225195
             autocorr =       1.327018208412
   target nu stat err =       0.000543225195
   target dn stat err =       0.003590056800
      target stat err =       0.002980914009
              std dev =       0.666893464419
             le_variance =       0.444746892885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266152835752e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742953209067       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742956404320       residual = 4.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742956735119       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742956812395       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742956812424       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742956820718       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742956820030       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742956823329       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742956822920       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742956822926       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742956823284       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742956823331       residual = 3.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.546457e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742953209067       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742954010699       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742954093493       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742954112865       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742954112871       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742954114942       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742954114773       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742954115593       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742954115491       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742954115492       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742954115581       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742954115593       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 6.386555e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742953209067       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742953409652       residual = 4.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742953430356       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742953435203       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742953435204       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742953435721       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742953435679       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742953435884       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742953435859       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742953435859       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742953435881       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742953435884       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+02 is 1.597920e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0824e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.019414e-01 3 1  ON 0
ci_002                -7.060487e-01 3 1  ON 1
ci_003                -5.329292e-02 3 1  ON 2
ci_004                -5.427780e-02 3 1  ON 3
ci_005                 1.960797e-02 3 1  ON 4
ci_006                 1.973132e-02 3 1  ON 5
ci_007                 1.596047e-02 3 1  ON 6
ci_008                 1.583613e-02 3 1  ON 7
ci_009                -1.220302e-02 3 1  ON 8
ci_010                -1.257527e-02 3 1  ON 9
ci_011                -9.660904e-03 3 1  ON 10
ci_012                -9.799478e-03 3 1  ON 11
ci_013                 8.789235e-03 3 1  ON 12
ci_014                 8.761047e-03 3 1  ON 13
ci_015                 9.240826e-03 3 1  ON 14
ci_016                 9.514498e-03 3 1  ON 15
ci_017                 8.630191e-03 3 1  ON 16
ci_018                 8.246567e-03 3 1  ON 17
ci_019                -1.475944e-03 3 1  ON 18
ci_020                -1.295025e-03 3 1  ON 19
ci_021                -1.054870e-02 3 1  ON 20
ci_022                -1.122390e-02 3 1  ON 21
ci_023                 5.475722e-03 3 1  ON 22
ci_024                 5.217673e-03 3 1  ON 23
ci_025                 1.294005e-02 3 1  ON 24
ci_026                 1.259404e-02 3 1  ON 25
ci_027                 6.266908e-03 3 1  ON 26
ci_028                 6.243306e-03 3 1  ON 27
ci_029                -3.681094e-03 3 1  ON 28
ci_030                -4.400300e-03 3 1  ON 29
ci_031                 4.192227e-03 3 1  ON 30
ci_032                 3.785947e-03 3 1  ON 31
ci_033                 3.415617e-03 3 1  ON 32
ci_034                 3.338907e-03 3 1  ON 33
ci_035                 2.211683e-03 3 1  ON 34
ci_036                 2.102975e-03 3 1  ON 35
ci_037                 3.375337e-03 3 1  ON 36
ci_038                 3.316798e-03 3 1  ON 37
ci_039                 4.303351e-03 3 1  ON 38
ci_040                 4.411736e-03 3 1  ON 39
ci_041                 2.812594e-03 3 1  ON 40
ci_042                 2.887337e-03 3 1  ON 41
ci_043                 3.458126e-03 3 1  ON 42
ci_044                 3.125779e-03 3 1  ON 43
ci_045                 2.537453e-03 3 1  ON 44
ci_046                 2.923391e-03 3 1  ON 45
ci_047                -9.920831e-04 3 1  ON 46
ci_048                -1.145459e-03 3 1  ON 47
ci_049                 6.962628e-04 3 1  ON 48
ci_050                 7.586700e-04 3 1  ON 49
ci_051                -1.480144e-03 3 1  ON 50
ci_052                -1.321430e-03 3 1  ON 51
ci_053                -2.586680e-03 3 1  ON 52
ci_054                -2.675611e-03 3 1  ON 53
ci_055                -1.595391e-03 3 1  ON 54
ci_056                -1.296371e-03 3 1  ON 55
ci_057                -1.010629e-03 3 1  ON 56
ci_058                -9.594826e-04 3 1  ON 57
ci_059                -3.537751e-04 3 1  ON 58
ci_060                -2.432849e-04 3 1  ON 59
ci_061                -6.599849e-04 3 1  ON 60
ci_062                -4.596806e-04 3 1  ON 61
ci_063                -6.385154e-04 3 1  ON 62
ci_064                -7.928203e-04 3 1  ON 63
ci_065                -1.772339e-03 3 1  ON 64
ci_066                -1.702441e-03 3 1  ON 65
ci_067                -1.644194e-03 3 1  ON 66
ci_068                -1.572379e-03 3 1  ON 67
ci_069                -6.132544e-05 3 1  ON 68
ci_070                 1.144466e-04 3 1  ON 69
ci_071                -1.483478e-03 3 1  ON 70
ci_072                -1.916806e-03 3 1  ON 71
ci_073                 9.159074e-05 3 1  ON 72
ci_074                 1.511535e-04 3 1  ON 73
ci_075                 1.156347e-04 3 1  ON 74
ci_076                 2.449951e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6773
    reference variance = 0.362979
====================================================
  Execution time = 2.5372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4700e-01
  Total weights = 1.9553e+06
  Execution time = 3.6097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437982622883
                                         uncertainty =       0.001722705131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437982622883
                                         uncertainty =       0.001722705131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468061927
  error estimate for blocks of size 2^( 2) =       0.000492218989
  error estimate for blocks of size 2^( 3) =       0.000515143832
  error estimate for blocks of size 2^( 4) =       0.000530871671
  error estimate for blocks of size 2^( 5) =       0.000539242233
  error estimate for blocks of size 2^( 6) =       0.000544197411
  error estimate for blocks of size 2^( 7) =       0.000548020492

      target function =      -0.747768205527
              le_mean =     -22.661611829275
             les_mean =     513.995652240321
             stat err =       0.000540582952
             autocorr =       1.333883985183
   target nu stat err =       0.000540582952
   target dn stat err =       0.002487471375
      target stat err =       0.002135315911
              std dev =       0.661939524961
             le_variance =       0.438163934706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437979228219
                                         uncertainty =       0.001722474952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437979228219
                                         uncertainty =       0.001722474952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468060035
  error estimate for blocks of size 2^( 2) =       0.000492217851
  error estimate for blocks of size 2^( 3) =       0.000515143393
  error estimate for blocks of size 2^( 4) =       0.000530871755
  error estimate for blocks of size 2^( 5) =       0.000539242591
  error estimate for blocks of size 2^( 6) =       0.000544197696
  error estimate for blocks of size 2^( 7) =       0.000548020916

      target function =      -0.747778032906
              le_mean =     -22.661611921301
             les_mean =     513.995644506830
             stat err =       0.000540583240
             autocorr =       1.333896190216
   target nu stat err =       0.000540583240
   target dn stat err =       0.002484652453
      target stat err =       0.002133138861
              std dev =       0.661936849045
             le_variance =       0.438160392123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437980907079
                                         uncertainty =       0.001722589450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437980907079
                                         uncertainty =       0.001722589450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468060971
  error estimate for blocks of size 2^( 2) =       0.000492218411
  error estimate for blocks of size 2^( 3) =       0.000515143605
  error estimate for blocks of size 2^( 4) =       0.000530871707
  error estimate for blocks of size 2^( 5) =       0.000539242406
  error estimate for blocks of size 2^( 6) =       0.000544197546
  error estimate for blocks of size 2^( 7) =       0.000548020696

      target function =      -0.747774720901
              le_mean =     -22.661611873800
             les_mean =     513.995646363407
             stat err =       0.000540583089
             autocorr =       1.333890110738
   target nu stat err =       0.000540583089
   target dn stat err =       0.002485989165
      target stat err =       0.002134178571
              std dev =       0.661938172859
             le_variance =       0.438162144687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437982406815
                                         uncertainty =       0.001722690640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437982406815
                                         uncertainty =       0.001722690640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468061806
  error estimate for blocks of size 2^( 2) =       0.000492218916
  error estimate for blocks of size 2^( 3) =       0.000515143803
  error estimate for blocks of size 2^( 4) =       0.000530871675
  error estimate for blocks of size 2^( 5) =       0.000539242254
  error estimate for blocks of size 2^( 6) =       0.000544197427
  error estimate for blocks of size 2^( 7) =       0.000548020516

      target function =      -0.747769155265
              le_mean =     -22.661611834657
             les_mean =     513.995651333234
             stat err =       0.000540582968
             autocorr =       1.333884751852
   target nu stat err =       0.000540582968
   target dn stat err =       0.002487278726
      target stat err =       0.002135168649
              std dev =       0.661939354738
             le_variance =       0.438163709350


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747768205527        initial
     1.0000e+01     1.0000e+02             2.5465e-05        -0.747778032906  <--
     4.0000e+01     4.0000e+02             6.3866e-06        -0.747774720901
     1.6000e+02     1.6000e+03             1.5979e-06        -0.747769155265

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.4687e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
ci_001                -7.019468e-01 3 1  ON 0
ci_002                -7.060443e-01 3 1  ON 1
ci_003                -5.329418e-02 3 1  ON 2
ci_004                -5.427356e-02 3 1  ON 3
ci_005                 1.960054e-02 3 1  ON 4
ci_006                 1.972201e-02 3 1  ON 5
ci_007                 1.595347e-02 3 1  ON 6
ci_008                 1.583423e-02 3 1  ON 7
ci_009                -1.219718e-02 3 1  ON 8
ci_010                -1.257373e-02 3 1  ON 9
ci_011                -9.661151e-03 3 1  ON 10
ci_012                -9.793232e-03 3 1  ON 11
ci_013                 8.792647e-03 3 1  ON 12
ci_014                 8.754944e-03 3 1  ON 13
ci_015                 9.235868e-03 3 1  ON 14
ci_016                 9.514003e-03 3 1  ON 15
ci_017                 8.628011e-03 3 1  ON 16
ci_018                 8.240768e-03 3 1  ON 17
ci_019                -1.489828e-03 3 1  ON 18
ci_020                -1.310593e-03 3 1  ON 19
ci_021                -1.054391e-02 3 1  ON 20
ci_022                -1.122713e-02 3 1  ON 21
ci_023                 5.470530e-03 3 1  ON 22
ci_024                 5.218023e-03 3 1  ON 23
ci_025                 1.295245e-02 3 1  ON 24
ci_026                 1.260050e-02 3 1  ON 25
ci_027                 6.266746e-03 3 1  ON 26
ci_028                 6.245237e-03 3 1  ON 27
ci_029                -3.686079e-03 3 1  ON 28
ci_030                -4.392574e-03 3 1  ON 29
ci_031                 4.200540e-03 3 1  ON 30
ci_032                 3.798193e-03 3 1  ON 31
ci_033                 3.403004e-03 3 1  ON 32
ci_034                 3.334206e-03 3 1  ON 33
ci_035                 2.211742e-03 3 1  ON 34
ci_036                 2.102230e-03 3 1  ON 35
ci_037                 3.381261e-03 3 1  ON 36
ci_038                 3.316203e-03 3 1  ON 37
ci_039                 4.303099e-03 3 1  ON 38
ci_040                 4.409575e-03 3 1  ON 39
ci_041                 2.814228e-03 3 1  ON 40
ci_042                 2.881140e-03 3 1  ON 41
ci_043                 3.455475e-03 3 1  ON 42
ci_044                 3.124076e-03 3 1  ON 43
ci_045                 2.538887e-03 3 1  ON 44
ci_046                 2.922325e-03 3 1  ON 45
ci_047                -9.853707e-04 3 1  ON 46
ci_048                -1.144029e-03 3 1  ON 47
ci_049                 6.969321e-04 3 1  ON 48
ci_050                 7.554317e-04 3 1  ON 49
ci_051                -1.480303e-03 3 1  ON 50
ci_052                -1.321702e-03 3 1  ON 51
ci_053                -2.589756e-03 3 1  ON 52
ci_054                -2.677253e-03 3 1  ON 53
ci_055                -1.591513e-03 3 1  ON 54
ci_056                -1.283114e-03 3 1  ON 55
ci_057                -1.012747e-03 3 1  ON 56
ci_058                -9.653311e-04 3 1  ON 57
ci_059                -3.483127e-04 3 1  ON 58
ci_060                -2.397217e-04 3 1  ON 59
ci_061                -6.615134e-04 3 1  ON 60
ci_062                -4.544966e-04 3 1  ON 61
ci_063                -6.194374e-04 3 1  ON 62
ci_064                -7.938860e-04 3 1  ON 63
ci_065                -1.779661e-03 3 1  ON 64
ci_066                -1.707343e-03 3 1  ON 65
ci_067                -1.642723e-03 3 1  ON 66
ci_068                -1.565982e-03 3 1  ON 67
ci_069                -6.079901e-05 3 1  ON 68
ci_070                 1.150119e-04 3 1  ON 69
ci_071                -1.473323e-03 3 1  ON 70
ci_072                -1.914055e-03 3 1  ON 71
ci_073                 9.302190e-05 3 1  ON 72
ci_074                 1.474488e-04 3 1  ON 73
ci_075                 1.178644e-04 3 1  ON 74
ci_076                 2.498825e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6731
    reference variance = 0.434412
====================================================
  Execution time = 2.6092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5319e-01
  Total weights = 1.955127052e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443367298532
                                         uncertainty =       0.002320685885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443367298532
                                         uncertainty =       0.002320685885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470821325
  error estimate for blocks of size 2^( 2) =       0.000494869862
  error estimate for blocks of size 2^( 3) =       0.000517148128
  error estimate for blocks of size 2^( 4) =       0.000533437013
  error estimate for blocks of size 2^( 5) =       0.000541658360
  error estimate for blocks of size 2^( 6) =       0.000546564464
  error estimate for blocks of size 2^( 7) =       0.000550411953

      target function =      -0.742700968837
              le_mean =     -22.662086234709
             les_mean =     514.023343385244
             stat err =       0.000543017947
             autocorr =       1.330197469947
   target nu stat err =       0.000543017947
   target dn stat err =       0.003208409809
      target stat err =       0.002677808905
              std dev =       0.665841903088
             le_variance =       0.443345439907


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266208623471e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742709685766       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742722228850       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742724020748       residual = 7.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742724318161       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742724360691       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742724413678       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742724435898       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742724447256       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742724455036       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742724453988       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742724452125       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742724452446       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 8.203672e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742709685766       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742712869019       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742713320569       residual = 7.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742713395086       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742713405571       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742713418643       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742713424122       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742713426893       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742713428815       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742713428519       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742713428063       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742713428138       residual = 1.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.078186e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742709685766       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742710484604       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742710597716       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742710616355       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742710618966       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742710622223       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742710623588       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742710624277       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742710624756       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742710624680       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742710624566       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742710624585       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 5.212796e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168129 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0829e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.019331e-01 3 1  ON 0
ci_002                -7.060578e-01 3 1  ON 1
ci_003                -5.328927e-02 3 1  ON 2
ci_004                -5.429325e-02 3 1  ON 3
ci_005                 1.959191e-02 3 1  ON 4
ci_006                 1.971314e-02 3 1  ON 5
ci_007                 1.594572e-02 3 1  ON 6
ci_008                 1.582996e-02 3 1  ON 7
ci_009                -1.219970e-02 3 1  ON 8
ci_010                -1.255295e-02 3 1  ON 9
ci_011                -9.662469e-03 3 1  ON 10
ci_012                -9.785630e-03 3 1  ON 11
ci_013                 8.783469e-03 3 1  ON 12
ci_014                 8.751719e-03 3 1  ON 13
ci_015                 9.217229e-03 3 1  ON 14
ci_016                 9.509082e-03 3 1  ON 15
ci_017                 8.628165e-03 3 1  ON 16
ci_018                 8.237988e-03 3 1  ON 17
ci_019                -1.484469e-03 3 1  ON 18
ci_020                -1.323807e-03 3 1  ON 19
ci_021                -1.055857e-02 3 1  ON 20
ci_022                -1.123724e-02 3 1  ON 21
ci_023                 5.464050e-03 3 1  ON 22
ci_024                 5.209783e-03 3 1  ON 23
ci_025                 1.295635e-02 3 1  ON 24
ci_026                 1.261051e-02 3 1  ON 25
ci_027                 6.277760e-03 3 1  ON 26
ci_028                 6.250459e-03 3 1  ON 27
ci_029                -3.689674e-03 3 1  ON 28
ci_030                -4.389001e-03 3 1  ON 29
ci_031                 4.210228e-03 3 1  ON 30
ci_032                 3.800887e-03 3 1  ON 31
ci_033                 3.396319e-03 3 1  ON 32
ci_034                 3.338376e-03 3 1  ON 33
ci_035                 2.208651e-03 3 1  ON 34
ci_036                 2.098947e-03 3 1  ON 35
ci_037                 3.377875e-03 3 1  ON 36
ci_038                 3.305730e-03 3 1  ON 37
ci_039                 4.308995e-03 3 1  ON 38
ci_040                 4.413205e-03 3 1  ON 39
ci_041                 2.818652e-03 3 1  ON 40
ci_042                 2.879201e-03 3 1  ON 41
ci_043                 3.453751e-03 3 1  ON 42
ci_044                 3.118465e-03 3 1  ON 43
ci_045                 2.544715e-03 3 1  ON 44
ci_046                 2.923025e-03 3 1  ON 45
ci_047                -9.858946e-04 3 1  ON 46
ci_048                -1.137149e-03 3 1  ON 47
ci_049                 6.843553e-04 3 1  ON 48
ci_050                 7.399053e-04 3 1  ON 49
ci_051                -1.476133e-03 3 1  ON 50
ci_052                -1.325465e-03 3 1  ON 51
ci_053                -2.584350e-03 3 1  ON 52
ci_054                -2.673155e-03 3 1  ON 53
ci_055                -1.592183e-03 3 1  ON 54
ci_056                -1.280008e-03 3 1  ON 55
ci_057                -1.020171e-03 3 1  ON 56
ci_058                -9.692245e-04 3 1  ON 57
ci_059                -3.525529e-04 3 1  ON 58
ci_060                -2.393632e-04 3 1  ON 59
ci_061                -6.608987e-04 3 1  ON 60
ci_062                -4.560329e-04 3 1  ON 61
ci_063                -6.128830e-04 3 1  ON 62
ci_064                -7.910319e-04 3 1  ON 63
ci_065                -1.791355e-03 3 1  ON 64
ci_066                -1.716955e-03 3 1  ON 65
ci_067                -1.631439e-03 3 1  ON 66
ci_068                -1.565096e-03 3 1  ON 67
ci_069                -6.242601e-05 3 1  ON 68
ci_070                 1.181388e-04 3 1  ON 69
ci_071                -1.481304e-03 3 1  ON 70
ci_072                -1.911920e-03 3 1  ON 71
ci_073                 8.611374e-05 3 1  ON 72
ci_074                 1.510329e-04 3 1  ON 73
ci_075                 1.199619e-04 3 1  ON 74
ci_076                 2.440855e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6867
    reference variance = 0.357661
====================================================
  Execution time = 2.5387e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.7380e-01
  Total weights = 1.9553e+06
  Execution time = 3.6106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450825118311
                                         uncertainty =       0.005245596396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450825118311
                                         uncertainty =       0.005245596396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474762789
  error estimate for blocks of size 2^( 2) =       0.000498400562
  error estimate for blocks of size 2^( 3) =       0.000520442053
  error estimate for blocks of size 2^( 4) =       0.000536438278
  error estimate for blocks of size 2^( 5) =       0.000544589389
  error estimate for blocks of size 2^( 6) =       0.000548781315
  error estimate for blocks of size 2^( 7) =       0.000548298699

      target function =      -0.726151252139
              le_mean =     -22.661915981029
             les_mean =     514.036300244650
             stat err =       0.000544526920
             autocorr =       1.315483378630
   target nu stat err =       0.000544526920
   target dn stat err =       0.011500988977
      target stat err =       0.008964595344
              std dev =       0.671415975574
             le_variance =       0.450799412255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450787895991
                                         uncertainty =       0.005232897868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450787895991
                                         uncertainty =       0.005232897868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474743305
  error estimate for blocks of size 2^( 2) =       0.000498384250
  error estimate for blocks of size 2^( 3) =       0.000520428112
  error estimate for blocks of size 2^( 4) =       0.000536426309
  error estimate for blocks of size 2^( 5) =       0.000544578746
  error estimate for blocks of size 2^( 6) =       0.000548770108
  error estimate for blocks of size 2^( 7) =       0.000548285445

      target function =      -0.725864819299
              le_mean =     -22.661915649143
             les_mean =     514.036654105249
             stat err =       0.000544515152
             autocorr =       1.315534497712
   target nu stat err =       0.000544515152
   target dn stat err =       0.011485349310
      target stat err =       0.008945400218
              std dev =       0.671388420363
             le_variance =       0.450762410997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450806047179
                                         uncertainty =       0.005239161163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450806047179
                                         uncertainty =       0.005239161163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474752806
  error estimate for blocks of size 2^( 2) =       0.000498392180
  error estimate for blocks of size 2^( 3) =       0.000520434894
  error estimate for blocks of size 2^( 4) =       0.000536432108
  error estimate for blocks of size 2^( 5) =       0.000544584014
  error estimate for blocks of size 2^( 6) =       0.000548775632
  error estimate for blocks of size 2^( 7) =       0.000548292289

      target function =      -0.726075794125
              le_mean =     -22.661915780229
             les_mean =     514.036388464779
             stat err =       0.000544521011
             autocorr =       1.315510151732
   target nu stat err =       0.000544521011
   target dn stat err =       0.011490327101
      target stat err =       0.008954456774
              std dev =       0.671401856900
             le_variance =       0.450780453449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450822702937
                                         uncertainty =       0.005244788495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450822702937
                                         uncertainty =       0.005244788495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474761525
  error estimate for blocks of size 2^( 2) =       0.000498399498
  error estimate for blocks of size 2^( 3) =       0.000520441141
  error estimate for blocks of size 2^( 4) =       0.000536437488
  error estimate for blocks of size 2^( 5) =       0.000544588697
  error estimate for blocks of size 2^( 6) =       0.000548780583
  error estimate for blocks of size 2^( 7) =       0.000548297885

      target function =      -0.726172973343
              le_mean =     -22.661915952345
             les_mean =     514.036271055527
             stat err =       0.000544526163
             autocorr =       1.315486726913
   target nu stat err =       0.000544526163
   target dn stat err =       0.011499213902
      target stat err =       0.008963751925
              std dev =       0.671414187360
             le_variance =       0.450797010989


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.726151252139        initial
     2.5000e+00     2.5000e+01             8.2037e-05        -0.725864819299
     1.0000e+01     1.0000e+02             2.0782e-05        -0.726075794125
     4.0000e+01     4.0000e+02             5.2128e-06        -0.726172973343  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+01     and shift_s =   4.0000e+02
*****************************************************************************

  Execution time = 4.3586e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
ci_001                -7.019434e-01 3 1  ON 0
ci_002                -7.060477e-01 3 1  ON 1
ci_003                -5.329295e-02 3 1  ON 2
ci_004                -5.427848e-02 3 1  ON 3
ci_005                 1.959838e-02 3 1  ON 4
ci_006                 1.971979e-02 3 1  ON 5
ci_007                 1.595153e-02 3 1  ON 6
ci_008                 1.583316e-02 3 1  ON 7
ci_009                -1.219781e-02 3 1  ON 8
ci_010                -1.256852e-02 3 1  ON 9
ci_011                -9.661481e-03 3 1  ON 10
ci_012                -9.791325e-03 3 1  ON 11
ci_013                 8.790345e-03 3 1  ON 12
ci_014                 8.754136e-03 3 1  ON 13
ci_015                 9.231195e-03 3 1  ON 14
ci_016                 9.512769e-03 3 1  ON 15
ci_017                 8.628051e-03 3 1  ON 16
ci_018                 8.240070e-03 3 1  ON 17
ci_019                -1.488483e-03 3 1  ON 18
ci_020                -1.313906e-03 3 1  ON 19
ci_021                -1.054759e-02 3 1  ON 20
ci_022                -1.122966e-02 3 1  ON 21
ci_023                 5.468905e-03 3 1  ON 22
ci_024                 5.215955e-03 3 1  ON 23
ci_025                 1.295343e-02 3 1  ON 24
ci_026                 1.260301e-02 3 1  ON 25
ci_027                 6.269511e-03 3 1  ON 26
ci_028                 6.246548e-03 3 1  ON 27
ci_029                -3.686981e-03 3 1  ON 28
ci_030                -4.391679e-03 3 1  ON 29
ci_031                 4.202969e-03 3 1  ON 30
ci_032                 3.798868e-03 3 1  ON 31
ci_033                 3.401328e-03 3 1  ON 32
ci_034                 3.335252e-03 3 1  ON 33
ci_035                 2.210966e-03 3 1  ON 34
ci_036                 2.101406e-03 3 1  ON 35
ci_037                 3.380412e-03 3 1  ON 36
ci_038                 3.313576e-03 3 1  ON 37
ci_039                 4.304579e-03 3 1  ON 38
ci_040                 4.410486e-03 3 1  ON 39
ci_041                 2.815339e-03 3 1  ON 40
ci_042                 2.880653e-03 3 1  ON 41
ci_043                 3.455043e-03 3 1  ON 42
ci_044                 3.122668e-03 3 1  ON 43
ci_045                 2.540349e-03 3 1  ON 44
ci_046                 2.922501e-03 3 1  ON 45
ci_047                -9.855019e-04 3 1  ON 46
ci_048                -1.142302e-03 3 1  ON 47
ci_049                 6.937765e-04 3 1  ON 48
ci_050                 7.515345e-04 3 1  ON 49
ci_051                -1.479258e-03 3 1  ON 50
ci_052                -1.322646e-03 3 1  ON 51
ci_053                -2.588400e-03 3 1  ON 52
ci_054                -2.676225e-03 3 1  ON 53
ci_055                -1.591680e-03 3 1  ON 54
ci_056                -1.282335e-03 3 1  ON 55
ci_057                -1.014611e-03 3 1  ON 56
ci_058                -9.663083e-04 3 1  ON 57
ci_059                -3.493769e-04 3 1  ON 58
ci_060                -2.396319e-04 3 1  ON 59
ci_061                -6.613593e-04 3 1  ON 60
ci_062                -4.548817e-04 3 1  ON 61
ci_063                -6.177933e-04 3 1  ON 62
ci_064                -7.931702e-04 3 1  ON 63
ci_065                -1.782594e-03 3 1  ON 64
ci_066                -1.709754e-03 3 1  ON 65
ci_067                -1.639893e-03 3 1  ON 66
ci_068                -1.565759e-03 3 1  ON 67
ci_069                -6.120707e-05 3 1  ON 68
ci_070                 1.157957e-04 3 1  ON 69
ci_071                -1.475324e-03 3 1  ON 70
ci_072                -1.913520e-03 3 1  ON 71
ci_073                 9.128750e-05 3 1  ON 72
ci_074                 1.483486e-04 3 1  ON 73
ci_075                 1.183904e-04 3 1  ON 74
ci_076                 2.484278e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5482
    reference variance = 0.307586
====================================================
  Execution time = 2.6196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4906e-01
  Total weights = 1.954923914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439542887797
                                         uncertainty =       0.002961231132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439542887797
                                         uncertainty =       0.002961231132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468800611
  error estimate for blocks of size 2^( 2) =       0.000492541775
  error estimate for blocks of size 2^( 3) =       0.000514613418
  error estimate for blocks of size 2^( 4) =       0.000531181771
  error estimate for blocks of size 2^( 5) =       0.000540903727
  error estimate for blocks of size 2^( 6) =       0.000545513488
  error estimate for blocks of size 2^( 7) =       0.000545432068

      target function =      -0.746073466904
              le_mean =     -22.661816310087
             les_mean =     514.006979528104
             stat err =       0.000540757763
             autocorr =       1.330543839898
   target nu stat err =       0.000540757763
   target dn stat err =       0.003181471562
      target stat err =       0.002678393044
              std dev =       0.662984181636
             le_variance =       0.439548025100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266181631009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746082217501       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746084006597       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746084356238       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746084465862       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746084527905       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746084581959       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746084635728       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746084633775       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746084633877       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746084631489       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746084630298       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746084630135       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 3.798587e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746082217501       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746082666453       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746082754049       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746082781479       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746082796982       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746082810468       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746082823839       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746082823341       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746082823364       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746082822769       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746082822474       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746082822433       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 9.497932e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746082217501       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746082329844       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746082351755       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746082358614       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746082362489       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746082365859       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746082369198       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746082369072       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746082369078       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746082368929       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746082368855       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746082368846       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+02 is 2.374575e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172982 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0954e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.019344e-01 3 1  ON 0
ci_002                -7.060572e-01 3 1  ON 1
ci_003                -5.329244e-02 3 1  ON 2
ci_004                -5.427647e-02 3 1  ON 3
ci_005                 1.959500e-02 3 1  ON 4
ci_006                 1.971640e-02 3 1  ON 5
ci_007                 1.595042e-02 3 1  ON 6
ci_008                 1.583024e-02 3 1  ON 7
ci_009                -1.219716e-02 3 1  ON 8
ci_010                -1.256790e-02 3 1  ON 9
ci_011                -9.661818e-03 3 1  ON 10
ci_012                -9.789880e-03 3 1  ON 11
ci_013                 8.789307e-03 3 1  ON 12
ci_014                 8.753167e-03 3 1  ON 13
ci_015                 9.227158e-03 3 1  ON 14
ci_016                 9.512030e-03 3 1  ON 15
ci_017                 8.625928e-03 3 1  ON 16
ci_018                 8.239543e-03 3 1  ON 17
ci_019                -1.491837e-03 3 1  ON 18
ci_020                -1.318312e-03 3 1  ON 19
ci_021                -1.054775e-02 3 1  ON 20
ci_022                -1.123098e-02 3 1  ON 21
ci_023                 5.467738e-03 3 1  ON 22
ci_024                 5.217092e-03 3 1  ON 23
ci_025                 1.295535e-02 3 1  ON 24
ci_026                 1.260334e-02 3 1  ON 25
ci_027                 6.269571e-03 3 1  ON 26
ci_028                 6.246909e-03 3 1  ON 27
ci_029                -3.685157e-03 3 1  ON 28
ci_030                -4.391897e-03 3 1  ON 29
ci_031                 4.203655e-03 3 1  ON 30
ci_032                 3.800855e-03 3 1  ON 31
ci_033                 3.400284e-03 3 1  ON 32
ci_034                 3.334110e-03 3 1  ON 33
ci_035                 2.211904e-03 3 1  ON 34
ci_036                 2.100208e-03 3 1  ON 35
ci_037                 3.379387e-03 3 1  ON 36
ci_038                 3.313625e-03 3 1  ON 37
ci_039                 4.306573e-03 3 1  ON 38
ci_040                 4.411409e-03 3 1  ON 39
ci_041                 2.815124e-03 3 1  ON 40
ci_042                 2.882044e-03 3 1  ON 41
ci_043                 3.455345e-03 3 1  ON 42
ci_044                 3.121629e-03 3 1  ON 43
ci_045                 2.542116e-03 3 1  ON 44
ci_046                 2.921935e-03 3 1  ON 45
ci_047                -9.854587e-04 3 1  ON 46
ci_048                -1.143386e-03 3 1  ON 47
ci_049                 6.937908e-04 3 1  ON 48
ci_050                 7.496717e-04 3 1  ON 49
ci_051                -1.478070e-03 3 1  ON 50
ci_052                -1.324120e-03 3 1  ON 51
ci_053                -2.586798e-03 3 1  ON 52
ci_054                -2.675648e-03 3 1  ON 53
ci_055                -1.591156e-03 3 1  ON 54
ci_056                -1.284738e-03 3 1  ON 55
ci_057                -1.014191e-03 3 1  ON 56
ci_058                -9.666076e-04 3 1  ON 57
ci_059                -3.488211e-04 3 1  ON 58
ci_060                -2.395241e-04 3 1  ON 59
ci_061                -6.591426e-04 3 1  ON 60
ci_062                -4.546396e-04 3 1  ON 61
ci_063                -6.191139e-04 3 1  ON 62
ci_064                -7.923260e-04 3 1  ON 63
ci_065                -1.784674e-03 3 1  ON 64
ci_066                -1.708805e-03 3 1  ON 65
ci_067                -1.638257e-03 3 1  ON 66
ci_068                -1.566017e-03 3 1  ON 67
ci_069                -6.059316e-05 3 1  ON 68
ci_070                 1.151704e-04 3 1  ON 69
ci_071                -1.475973e-03 3 1  ON 70
ci_072                -1.914124e-03 3 1  ON 71
ci_073                 9.135470e-05 3 1  ON 72
ci_074                 1.483791e-04 3 1  ON 73
ci_075                 1.197706e-04 3 1  ON 74
ci_076                 2.486842e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7691
    reference variance = 0.641501
====================================================
  Execution time = 2.5469e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4761e-01
  Total weights = 1.9550e+06
  Execution time = 3.6943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437894589626
                                         uncertainty =       0.002408418816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437894589626
                                         uncertainty =       0.002408418816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467855722
  error estimate for blocks of size 2^( 2) =       0.000492031566
  error estimate for blocks of size 2^( 3) =       0.000514323541
  error estimate for blocks of size 2^( 4) =       0.000529679463
  error estimate for blocks of size 2^( 5) =       0.000539458796
  error estimate for blocks of size 2^( 6) =       0.000544751634
  error estimate for blocks of size 2^( 7) =       0.000544080688

      target function =      -0.747178671113
              le_mean =     -22.660870855143
             les_mean =     513.962768366881
             stat err =       0.000539492645
             autocorr =       1.329680090651
   target nu stat err =       0.000539492645
   target dn stat err =       0.002963453579
      target stat err =       0.002507605779
              std dev =       0.661647907387
             le_variance =       0.437777953350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437890955758
                                         uncertainty =       0.002409052573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437890955758
                                         uncertainty =       0.002409052573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467853773
  error estimate for blocks of size 2^( 2) =       0.000492030282
  error estimate for blocks of size 2^( 3) =       0.000514322627
  error estimate for blocks of size 2^( 4) =       0.000529678675
  error estimate for blocks of size 2^( 5) =       0.000539458109
  error estimate for blocks of size 2^( 6) =       0.000544750883
  error estimate for blocks of size 2^( 7) =       0.000544080096

      target function =      -0.747348895955
              le_mean =     -22.660870789798
             les_mean =     513.962558552282
             stat err =       0.000539491941
             autocorr =       1.329687698840
   target nu stat err =       0.000539491941
   target dn stat err =       0.002938975471
      target stat err =       0.002489158919
              std dev =       0.661645150325
             le_variance =       0.437774304949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437892757637
                                         uncertainty =       0.002408736407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437892757637
                                         uncertainty =       0.002408736407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467854739
  error estimate for blocks of size 2^( 2) =       0.000492030917
  error estimate for blocks of size 2^( 3) =       0.000514323078
  error estimate for blocks of size 2^( 4) =       0.000529679063
  error estimate for blocks of size 2^( 5) =       0.000539458447
  error estimate for blocks of size 2^( 6) =       0.000544751254
  error estimate for blocks of size 2^( 7) =       0.000544080386

      target function =      -0.747293482076
              le_mean =     -22.660870821652
             les_mean =     513.962627306709
             stat err =       0.000539492288
             autocorr =       1.329683913984
   target nu stat err =       0.000539492288
   target dn stat err =       0.002949560726
      target stat err =       0.002497255337
              std dev =       0.661646517473
             le_variance =       0.437776114085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437894359442
                                         uncertainty =       0.002408458525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437894359442
                                         uncertainty =       0.002408458525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467855599
  error estimate for blocks of size 2^( 2) =       0.000492031484
  error estimate for blocks of size 2^( 3) =       0.000514323482
  error estimate for blocks of size 2^( 4) =       0.000529679413
  error estimate for blocks of size 2^( 5) =       0.000539458752
  error estimate for blocks of size 2^( 6) =       0.000544751586
  error estimate for blocks of size 2^( 7) =       0.000544080650

      target function =      -0.747201495735
              le_mean =     -22.660870850912
             les_mean =     513.962740427818
             stat err =       0.000539492600
             autocorr =       1.329680569670
   target nu stat err =       0.000539492600
   target dn stat err =       0.002961112477
      target stat err =       0.002505884571
              std dev =       0.661647732753
             le_variance =       0.437777722257


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747178671113        initial
     1.0000e+01     1.0000e+02             3.7986e-05        -0.747348895955  <--
     4.0000e+01     4.0000e+02             9.4979e-06        -0.747293482076
     1.6000e+02     1.6000e+03             2.3746e-06        -0.747201495735

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.4273e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
ci_001                -7.019074e-01 3 1  ON 0
ci_002                -7.060857e-01 3 1  ON 1
ci_003                -5.329089e-02 3 1  ON 2
ci_004                -5.427045e-02 3 1  ON 3
ci_005                 1.958492e-02 3 1  ON 4
ci_006                 1.970628e-02 3 1  ON 5
ci_007                 1.594710e-02 3 1  ON 6
ci_008                 1.582152e-02 3 1  ON 7
ci_009                -1.219522e-02 3 1  ON 8
ci_010                -1.256603e-02 3 1  ON 9
ci_011                -9.662826e-03 3 1  ON 10
ci_012                -9.785563e-03 3 1  ON 11
ci_013                 8.786203e-03 3 1  ON 12
ci_014                 8.750275e-03 3 1  ON 13
ci_015                 9.215096e-03 3 1  ON 14
ci_016                 9.509824e-03 3 1  ON 15
ci_017                 8.619584e-03 3 1  ON 16
ci_018                 8.237971e-03 3 1  ON 17
ci_019                -1.501860e-03 3 1  ON 18
ci_020                -1.331478e-03 3 1  ON 19
ci_021                -1.054823e-02 3 1  ON 20
ci_022                -1.123490e-02 3 1  ON 21
ci_023                 5.464254e-03 3 1  ON 22
ci_024                 5.220487e-03 3 1  ON 23
ci_025                 1.296111e-02 3 1  ON 24
ci_026                 1.260435e-02 3 1  ON 25
ci_027                 6.269750e-03 3 1  ON 26
ci_028                 6.247989e-03 3 1  ON 27
ci_029                -3.679705e-03 3 1  ON 28
ci_030                -4.392548e-03 3 1  ON 29
ci_031                 4.205705e-03 3 1  ON 30
ci_032                 3.806791e-03 3 1  ON 31
ci_033                 3.397165e-03 3 1  ON 32
ci_034                 3.330698e-03 3 1  ON 33
ci_035                 2.214704e-03 3 1  ON 34
ci_036                 2.096633e-03 3 1  ON 35
ci_037                 3.376322e-03 3 1  ON 36
ci_038                 3.313768e-03 3 1  ON 37
ci_039                 4.312522e-03 3 1  ON 38
ci_040                 4.414166e-03 3 1  ON 39
ci_041                 2.814483e-03 3 1  ON 40
ci_042                 2.886198e-03 3 1  ON 41
ci_043                 3.456248e-03 3 1  ON 42
ci_044                 3.118526e-03 3 1  ON 43
ci_045                 2.547396e-03 3 1  ON 44
ci_046                 2.920249e-03 3 1  ON 45
ci_047                -9.853290e-04 3 1  ON 46
ci_048                -1.146621e-03 3 1  ON 47
ci_049                 6.938336e-04 3 1  ON 48
ci_050                 7.441085e-04 3 1  ON 49
ci_051                -1.474521e-03 3 1  ON 50
ci_052                -1.328524e-03 3 1  ON 51
ci_053                -2.582013e-03 3 1  ON 52
ci_054                -2.673927e-03 3 1  ON 53
ci_055                -1.589591e-03 3 1  ON 54
ci_056                -1.291921e-03 3 1  ON 55
ci_057                -1.012940e-03 3 1  ON 56
ci_058                -9.675022e-04 3 1  ON 57
ci_059                -3.471624e-04 3 1  ON 58
ci_060                -2.392026e-04 3 1  ON 59
ci_061                -6.525189e-04 3 1  ON 60
ci_062                -4.539159e-04 3 1  ON 61
ci_063                -6.230599e-04 3 1  ON 62
ci_064                -7.898053e-04 3 1  ON 63
ci_065                -1.790889e-03 3 1  ON 64
ci_066                -1.705970e-03 3 1  ON 65
ci_067                -1.633371e-03 3 1  ON 66
ci_068                -1.566785e-03 3 1  ON 67
ci_069                -5.875997e-05 3 1  ON 68
ci_070                 1.133022e-04 3 1  ON 69
ci_071                -1.477910e-03 3 1  ON 70
ci_072                -1.915927e-03 3 1  ON 71
ci_073                 9.155431e-05 3 1  ON 72
ci_074                 1.484693e-04 3 1  ON 73
ci_075                 1.238932e-04 3 1  ON 74
ci_076                 2.494505e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7202
    reference variance = 0.341886
====================================================
  Execution time = 2.6068e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4853e-01
  Total weights = 1.955457272e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439009498187
                                         uncertainty =       0.002160263030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439009498187
                                         uncertainty =       0.002160263030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468498670
  error estimate for blocks of size 2^( 2) =       0.000492501536
  error estimate for blocks of size 2^( 3) =       0.000515243221
  error estimate for blocks of size 2^( 4) =       0.000532240908
  error estimate for blocks of size 2^( 5) =       0.000540935682
  error estimate for blocks of size 2^( 6) =       0.000545410663
  error estimate for blocks of size 2^( 7) =       0.000549114494

      target function =      -0.746516360619
              le_mean =     -22.662265821232
             les_mean =     514.026825361590
             stat err =       0.000541925437
             autocorr =       1.338019207618
   target nu stat err =       0.000541925437
   target dn stat err =       0.002535137133
      target stat err =       0.002168575482
              std dev =       0.662557173170
             le_variance =       0.438982007719


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266226582123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746521756683       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746526907943       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746527680265       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746527778782       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746527884347       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746527934477       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746527954934       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746527975455       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746527988099       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746527999460       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746527997436       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746527997333       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 6.224374e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746521756683       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746523063187       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746523257615       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746523282250       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746523308657       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746523321047       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746523326060       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746523331140       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746523334245       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746523336999       residual = 9.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746523336481       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746523336454       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.573739e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746521756683       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746522084499       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746522133190       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746522139349       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746522145951       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746522149040       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746522150287       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746522151554       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746522152326       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746522153009       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746522152879       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746522152872       residual = 1.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 3.945531e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0792e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.018948e-01 3 1  ON 0
ci_002                -7.061006e-01 3 1  ON 1
ci_003                -5.328104e-02 3 1  ON 2
ci_004                -5.425757e-02 3 1  ON 3
ci_005                 1.957672e-02 3 1  ON 4
ci_006                 1.970632e-02 3 1  ON 5
ci_007                 1.594378e-02 3 1  ON 6
ci_008                 1.581886e-02 3 1  ON 7
ci_009                -1.220059e-02 3 1  ON 8
ci_010                -1.256649e-02 3 1  ON 9
ci_011                -9.652458e-03 3 1  ON 10
ci_012                -9.779030e-03 3 1  ON 11
ci_013                 8.774569e-03 3 1  ON 12
ci_014                 8.752789e-03 3 1  ON 13
ci_015                 9.210743e-03 3 1  ON 14
ci_016                 9.503677e-03 3 1  ON 15
ci_017                 8.616795e-03 3 1  ON 16
ci_018                 8.235985e-03 3 1  ON 17
ci_019                -1.503513e-03 3 1  ON 18
ci_020                -1.347216e-03 3 1  ON 19
ci_021                -1.055389e-02 3 1  ON 20
ci_022                -1.123429e-02 3 1  ON 21
ci_023                 5.455673e-03 3 1  ON 22
ci_024                 5.216236e-03 3 1  ON 23
ci_025                 1.296484e-02 3 1  ON 24
ci_026                 1.260845e-02 3 1  ON 25
ci_027                 6.269016e-03 3 1  ON 26
ci_028                 6.250974e-03 3 1  ON 27
ci_029                -3.689378e-03 3 1  ON 28
ci_030                -4.396464e-03 3 1  ON 29
ci_031                 4.202180e-03 3 1  ON 30
ci_032                 3.806339e-03 3 1  ON 31
ci_033                 3.399317e-03 3 1  ON 32
ci_034                 3.331375e-03 3 1  ON 33
ci_035                 2.209223e-03 3 1  ON 34
ci_036                 2.092939e-03 3 1  ON 35
ci_037                 3.371263e-03 3 1  ON 36
ci_038                 3.309729e-03 3 1  ON 37
ci_039                 4.307646e-03 3 1  ON 38
ci_040                 4.416083e-03 3 1  ON 39
ci_041                 2.812195e-03 3 1  ON 40
ci_042                 2.882065e-03 3 1  ON 41
ci_043                 3.456773e-03 3 1  ON 42
ci_044                 3.118609e-03 3 1  ON 43
ci_045                 2.546287e-03 3 1  ON 44
ci_046                 2.919337e-03 3 1  ON 45
ci_047                -9.901893e-04 3 1  ON 46
ci_048                -1.146462e-03 3 1  ON 47
ci_049                 6.993951e-04 3 1  ON 48
ci_050                 7.459102e-04 3 1  ON 49
ci_051                -1.469048e-03 3 1  ON 50
ci_052                -1.327956e-03 3 1  ON 51
ci_053                -2.575875e-03 3 1  ON 52
ci_054                -2.677172e-03 3 1  ON 53
ci_055                -1.584660e-03 3 1  ON 54
ci_056                -1.295315e-03 3 1  ON 55
ci_057                -1.014917e-03 3 1  ON 56
ci_058                -9.711904e-04 3 1  ON 57
ci_059                -3.450394e-04 3 1  ON 58
ci_060                -2.409282e-04 3 1  ON 59
ci_061                -6.540137e-04 3 1  ON 60
ci_062                -4.486707e-04 3 1  ON 61
ci_063                -6.301343e-04 3 1  ON 62
ci_064                -7.877245e-04 3 1  ON 63
ci_065                -1.793376e-03 3 1  ON 64
ci_066                -1.704521e-03 3 1  ON 65
ci_067                -1.640135e-03 3 1  ON 66
ci_068                -1.563985e-03 3 1  ON 67
ci_069                -4.893532e-05 3 1  ON 68
ci_070                 1.117784e-04 3 1  ON 69
ci_071                -1.481810e-03 3 1  ON 70
ci_072                -1.914668e-03 3 1  ON 71
ci_073                 9.096709e-05 3 1  ON 72
ci_074                 1.512919e-04 3 1  ON 73
ci_075                 1.268868e-04 3 1  ON 74
ci_076                 2.487500e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.5365
    reference variance = 1.39274
====================================================
  Execution time = 2.5332e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4939e-01
  Total weights = 1.9553e+06
  Execution time = 3.5995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439822361191
                                         uncertainty =       0.002422428515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439822361191
                                         uncertainty =       0.002422428515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468945470
  error estimate for blocks of size 2^( 2) =       0.000492734285
  error estimate for blocks of size 2^( 3) =       0.000514376462
  error estimate for blocks of size 2^( 4) =       0.000530246719
  error estimate for blocks of size 2^( 5) =       0.000538422986
  error estimate for blocks of size 2^( 6) =       0.000544893633
  error estimate for blocks of size 2^( 7) =       0.000545249576

      target function =      -0.745799417730
              le_mean =     -22.661655698132
             les_mean =     514.000032265026
             stat err =       0.000539703229
             autocorr =       1.324540802908
   target nu stat err =       0.000539703229
   target dn stat err =       0.003082589659
      target stat err =       0.002596575482
              std dev =       0.663189044361
             le_variance =       0.439819708560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439829504437
                                         uncertainty =       0.002424324146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439829504437
                                         uncertainty =       0.002424324146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468949295
  error estimate for blocks of size 2^( 2) =       0.000492738591
  error estimate for blocks of size 2^( 3) =       0.000514381210
  error estimate for blocks of size 2^( 4) =       0.000530251799
  error estimate for blocks of size 2^( 5) =       0.000538426812
  error estimate for blocks of size 2^( 6) =       0.000544896339
  error estimate for blocks of size 2^( 7) =       0.000545254432

      target function =      -0.745821684275
              le_mean =     -22.661655907661
             les_mean =     514.000014667025
             stat err =       0.000539707345
             autocorr =       1.324539407993
   target nu stat err =       0.000539707345
   target dn stat err =       0.003074530823
      target stat err =       0.002590294529
              std dev =       0.663194452426
             le_variance =       0.439826881728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439825884872
                                         uncertainty =       0.002423381076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439825884872
                                         uncertainty =       0.002423381076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468947357
  error estimate for blocks of size 2^( 2) =       0.000492736418
  error estimate for blocks of size 2^( 3) =       0.000514378822
  error estimate for blocks of size 2^( 4) =       0.000530249247
  error estimate for blocks of size 2^( 5) =       0.000538424880
  error estimate for blocks of size 2^( 6) =       0.000544894966
  error estimate for blocks of size 2^( 7) =       0.000545252001

      target function =      -0.745814481359
              le_mean =     -22.661655793732
             les_mean =     514.000018259215
             stat err =       0.000539705274
             autocorr =       1.324540182731
   target nu stat err =       0.000539705274
   target dn stat err =       0.003078309715
      target stat err =       0.002593261570
              std dev =       0.663191712569
             le_variance =       0.439823247620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439822793644
                                         uncertainty =       0.002422547356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439822793644
                                         uncertainty =       0.002422547356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468945702
  error estimate for blocks of size 2^( 2) =       0.000492734547
  error estimate for blocks of size 2^( 3) =       0.000514376753
  error estimate for blocks of size 2^( 4) =       0.000530247031
  error estimate for blocks of size 2^( 5) =       0.000538423219
  error estimate for blocks of size 2^( 6) =       0.000544893796
  error estimate for blocks of size 2^( 7) =       0.000545249877

      target function =      -0.745801930012
              le_mean =     -22.661655708955
             les_mean =     514.000029695903
             stat err =       0.000539703481
             autocorr =       1.324540733263
   target nu stat err =       0.000539703481
   target dn stat err =       0.003082026565
      target stat err =       0.002596143072
              std dev =       0.663189371864
             le_variance =       0.439820142953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745799417730        initial
     2.5000e+00     2.5000e+01             6.2244e-05        -0.745821684275  <--
     1.0000e+01     1.0000e+02             1.5737e-05        -0.745814481359
     4.0000e+01     4.0000e+02             3.9455e-06        -0.745801930012

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.3480e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
ci_001                -7.018571e-01 3 1  ON 0
ci_002                -7.061452e-01 3 1  ON 1
ci_003                -5.325163e-02 3 1  ON 2
ci_004                -5.421915e-02 3 1  ON 3
ci_005                 1.955259e-02 3 1  ON 4
ci_006                 1.970647e-02 3 1  ON 5
ci_007                 1.593397e-02 3 1  ON 6
ci_008                 1.581103e-02 3 1  ON 7
ci_009                -1.221644e-02 3 1  ON 8
ci_010                -1.256788e-02 3 1  ON 9
ci_011                -9.621891e-03 3 1  ON 10
ci_012                -9.759765e-03 3 1  ON 11
ci_013                 8.740242e-03 3 1  ON 12
ci_014                 8.760239e-03 3 1  ON 13
ci_015                 9.197888e-03 3 1  ON 14
ci_016                 9.485509e-03 3 1  ON 15
ci_017                 8.608577e-03 3 1  ON 16
ci_018                 8.230134e-03 3 1  ON 17
ci_019                -1.508401e-03 3 1  ON 18
ci_020                -1.393722e-03 3 1  ON 19
ci_021                -1.057062e-02 3 1  ON 20
ci_022                -1.123246e-02 3 1  ON 21
ci_023                 5.430427e-03 3 1  ON 22
ci_024                 5.203732e-03 3 1  ON 23
ci_025                 1.297585e-02 3 1  ON 24
ci_026                 1.262060e-02 3 1  ON 25
ci_027                 6.266854e-03 3 1  ON 26
ci_028                 6.259751e-03 3 1  ON 27
ci_029                -3.717927e-03 3 1  ON 28
ci_030                -4.408037e-03 3 1  ON 29
ci_031                 4.191783e-03 3 1  ON 30
ci_032                 3.805001e-03 3 1  ON 31
ci_033                 3.405677e-03 3 1  ON 32
ci_034                 3.333381e-03 3 1  ON 33
ci_035                 2.193111e-03 3 1  ON 34
ci_036                 2.082071e-03 3 1  ON 35
ci_037                 3.356316e-03 3 1  ON 36
ci_038                 3.297832e-03 3 1  ON 37
ci_039                 4.293327e-03 3 1  ON 38
ci_040                 4.421723e-03 3 1  ON 39
ci_041                 2.805459e-03 3 1  ON 40
ci_042                 2.869915e-03 3 1  ON 41
ci_043                 3.458292e-03 3 1  ON 42
ci_044                 3.118857e-03 3 1  ON 43
ci_045                 2.542998e-03 3 1  ON 44
ci_046                 2.916648e-03 3 1  ON 45
ci_047                -1.004465e-03 3 1  ON 46
ci_048                -1.145999e-03 3 1  ON 47
ci_049                 7.157761e-04 3 1  ON 48
ci_050                 7.512278e-04 3 1  ON 49
ci_051                -1.452884e-03 3 1  ON 50
ci_052                -1.326285e-03 3 1  ON 51
ci_053                -2.557780e-03 3 1  ON 52
ci_054                -2.686763e-03 3 1  ON 53
ci_055                -1.570095e-03 3 1  ON 54
ci_056                -1.305349e-03 3 1  ON 55
ci_057                -1.020729e-03 3 1  ON 56
ci_058                -9.820452e-04 3 1  ON 57
ci_059                -3.387935e-04 3 1  ON 58
ci_060                -2.460046e-04 3 1  ON 59
ci_061                -6.584114e-04 3 1  ON 60
ci_062                -4.332039e-04 3 1  ON 61
ci_063                -6.510258e-04 3 1  ON 62
ci_064                -7.815839e-04 3 1  ON 63
ci_065                -1.800707e-03 3 1  ON 64
ci_066                -1.700236e-03 3 1  ON 65
ci_067                -1.660072e-03 3 1  ON 66
ci_068                -1.555719e-03 3 1  ON 67
ci_069                -1.997204e-05 3 1  ON 68
ci_070                 1.072885e-04 3 1  ON 69
ci_071                -1.493322e-03 3 1  ON 70
ci_072                -1.910942e-03 3 1  ON 71
ci_073                 8.923356e-05 3 1  ON 72
ci_074                 1.595920e-04 3 1  ON 73
ci_075                 1.357007e-04 3 1  ON 74
ci_076                 2.466771e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.716
    reference variance = 1.2211
====================================================
  Execution time = 2.5850e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6261e-01
  Total weights = 1.954932278e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445491349724
                                         uncertainty =       0.003168258312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445491349724
                                         uncertainty =       0.003168258312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472046254
  error estimate for blocks of size 2^( 2) =       0.000496342761
  error estimate for blocks of size 2^( 3) =       0.000518487504
  error estimate for blocks of size 2^( 4) =       0.000534475902
  error estimate for blocks of size 2^( 5) =       0.000544551420
  error estimate for blocks of size 2^( 6) =       0.000549932180
  error estimate for blocks of size 2^( 7) =       0.000552844869

      target function =      -0.735000085809
              le_mean =     -22.661901630924
             les_mean =     514.024398855860
             stat err =       0.000545451093
             autocorr =       1.335188309133
   target nu stat err =       0.000545451093
   target dn stat err =       0.011832546657
      target stat err =       0.009447606866
              std dev =       0.667574214679
             le_variance =       0.445655332105


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266190163092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735120980249       residual = 8.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735734715186       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735752487934       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735755038636       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735755412499       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735755712494       residual = 7.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735756000112       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735755984696       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735755982410       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735756002658       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735756007173       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735755995989       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 1.000775e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735120980249       residual = 8.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735285485214       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735290173454       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735290824114       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735290917026       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735290996147       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735291064954       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735291058486       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735291057920       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735291062597       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735291063498       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735291060986       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 2.673174e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735120980249       residual = 8.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735162861306       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735164049747       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735164213214       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735164236392       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735164256450       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735164273425       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735164271646       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735164271508       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735164272653       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735164272864       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735164272254       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 6.799366e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182749 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1187e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.019491e-01 3 1  ON 0
ci_002                -7.060635e-01 3 1  ON 1
ci_003                -5.323564e-02 3 1  ON 2
ci_004                -5.420111e-02 3 1  ON 3
ci_005                 1.953146e-02 3 1  ON 4
ci_006                 1.969890e-02 3 1  ON 5
ci_007                 1.589598e-02 3 1  ON 6
ci_008                 1.586297e-02 3 1  ON 7
ci_009                -1.220636e-02 3 1  ON 8
ci_010                -1.255483e-02 3 1  ON 9
ci_011                -9.592821e-03 3 1  ON 10
ci_012                -9.737775e-03 3 1  ON 11
ci_013                 8.747795e-03 3 1  ON 12
ci_014                 8.677962e-03 3 1  ON 13
ci_015                 9.169845e-03 3 1  ON 14
ci_016                 9.436468e-03 3 1  ON 15
ci_017                 8.647067e-03 3 1  ON 16
ci_018                 8.260282e-03 3 1  ON 17
ci_019                -1.548325e-03 3 1  ON 18
ci_020                -1.240025e-03 3 1  ON 19
ci_021                -1.060816e-02 3 1  ON 20
ci_022                -1.127522e-02 3 1  ON 21
ci_023                 5.437045e-03 3 1  ON 22
ci_024                 4.940209e-03 3 1  ON 23
ci_025                 1.298227e-02 3 1  ON 24
ci_026                 1.235328e-02 3 1  ON 25
ci_027                 6.253173e-03 3 1  ON 26
ci_028                 6.258804e-03 3 1  ON 27
ci_029                -3.731934e-03 3 1  ON 28
ci_030                -4.420502e-03 3 1  ON 29
ci_031                 4.228873e-03 3 1  ON 30
ci_032                 3.881532e-03 3 1  ON 31
ci_033                 3.391223e-03 3 1  ON 32
ci_034                 3.350846e-03 3 1  ON 33
ci_035                 2.188297e-03 3 1  ON 34
ci_036                 2.073950e-03 3 1  ON 35
ci_037                 3.338912e-03 3 1  ON 36
ci_038                 3.286040e-03 3 1  ON 37
ci_039                 4.295367e-03 3 1  ON 38
ci_040                 4.352941e-03 3 1  ON 39
ci_041                 2.799533e-03 3 1  ON 40
ci_042                 2.860536e-03 3 1  ON 41
ci_043                 3.470525e-03 3 1  ON 42
ci_044                 3.129422e-03 3 1  ON 43
ci_045                 2.542589e-03 3 1  ON 44
ci_046                 2.900841e-03 3 1  ON 45
ci_047                -1.012571e-03 3 1  ON 46
ci_048                -1.156765e-03 3 1  ON 47
ci_049                 7.750167e-04 3 1  ON 48
ci_050                 1.017439e-03 3 1  ON 49
ci_051                -1.456321e-03 3 1  ON 50
ci_052                -1.428606e-03 3 1  ON 51
ci_053                -2.585196e-03 3 1  ON 52
ci_054                -2.688605e-03 3 1  ON 53
ci_055                -1.551603e-03 3 1  ON 54
ci_056                -1.266166e-03 3 1  ON 55
ci_057                -9.999251e-04 3 1  ON 56
ci_058                -9.663027e-04 3 1  ON 57
ci_059                -3.555280e-04 3 1  ON 58
ci_060                -2.533891e-04 3 1  ON 59
ci_061                -6.361455e-04 3 1  ON 60
ci_062                -4.314758e-04 3 1  ON 61
ci_063                -6.415256e-04 3 1  ON 62
ci_064                -8.351068e-04 3 1  ON 63
ci_065                -1.812690e-03 3 1  ON 64
ci_066                -1.684597e-03 3 1  ON 65
ci_067                -1.655268e-03 3 1  ON 66
ci_068                -1.554802e-03 3 1  ON 67
ci_069                -2.131165e-05 3 1  ON 68
ci_070                 7.550121e-05 3 1  ON 69
ci_071                -1.505668e-03 3 1  ON 70
ci_072                -2.110868e-03 3 1  ON 71
ci_073                 8.505576e-05 3 1  ON 72
ci_074                 1.400940e-04 3 1  ON 73
ci_075                 1.428466e-04 3 1  ON 74
ci_076                 2.620481e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6588
    reference variance = 0.309686
====================================================
  Execution time = 2.5255e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5248e-01
  Total weights = 1.9553e+06
  Execution time = 3.6050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440972815260
                                         uncertainty =       0.002679899534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440972815260
                                         uncertainty =       0.002679899534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469593003
  error estimate for blocks of size 2^( 2) =       0.000493616261
  error estimate for blocks of size 2^( 3) =       0.000515783536
  error estimate for blocks of size 2^( 4) =       0.000531187554
  error estimate for blocks of size 2^( 5) =       0.000539735692
  error estimate for blocks of size 2^( 6) =       0.000544236658
  error estimate for blocks of size 2^( 7) =       0.000547940831

      target function =      -0.743158053818
              le_mean =     -22.662145878777
             les_mean =     514.025480139403
             stat err =       0.000540775184
             autocorr =       1.326142743040
   target nu stat err =       0.000540775184
   target dn stat err =       0.003945298112
      target stat err =       0.003269004813
              std dev =       0.664104793116
             le_variance =       0.441035176240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441055839502
                                         uncertainty =       0.002681100429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441055839502
                                         uncertainty =       0.002681100429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469637102
  error estimate for blocks of size 2^( 2) =       0.000493665823
  error estimate for blocks of size 2^( 3) =       0.000515834023
  error estimate for blocks of size 2^( 4) =       0.000531232916
  error estimate for blocks of size 2^( 5) =       0.000539770480
  error estimate for blocks of size 2^( 6) =       0.000544264405
  error estimate for blocks of size 2^( 7) =       0.000547958135

      target function =      -0.742958942917
              le_mean =     -22.662152922961
             les_mean =     514.026043813866
             stat err =       0.000540806484
             autocorr =       1.326047192915
   target nu stat err =       0.000540806484
   target dn stat err =       0.003956867698
      target stat err =       0.003276589105
              std dev =       0.664167159488
             le_variance =       0.441118015743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005480952
                                         uncertainty =       0.002680300866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441005480952
                                         uncertainty =       0.002680300866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469610342
  error estimate for blocks of size 2^( 2) =       0.000493636540
  error estimate for blocks of size 2^( 3) =       0.000515804277
  error estimate for blocks of size 2^( 4) =       0.000531205593
  error estimate for blocks of size 2^( 5) =       0.000539747964
  error estimate for blocks of size 2^( 6) =       0.000544243347
  error estimate for blocks of size 2^( 7) =       0.000547939808

      target function =      -0.742634856242
              le_mean =     -22.662147758002
             les_mean =     514.026207720562
             stat err =       0.000540784178
             autocorr =       1.326088925156
   target nu stat err =       0.000540784178
   target dn stat err =       0.003965610071
      target stat err =       0.003280745171
              std dev =       0.664129315040
             le_variance =       0.441067747096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440990198504
                                         uncertainty =       0.002678923999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440990198504
                                         uncertainty =       0.002678923999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469602247
  error estimate for blocks of size 2^( 2) =       0.000493624926
  error estimate for blocks of size 2^( 3) =       0.000515790169
  error estimate for blocks of size 2^( 4) =       0.000531192105
  error estimate for blocks of size 2^( 5) =       0.000539736977
  error estimate for blocks of size 2^( 6) =       0.000544229946
  error estimate for blocks of size 2^( 7) =       0.000547918444

      target function =      -0.723817809495
              le_mean =     -22.662143258433
             les_mean =     514.049131762125
             stat err =       0.000540769368
             autocorr =       1.326062009399
   target nu stat err =       0.000540769368
   target dn stat err =       0.024025383879
      target stat err =       0.018591917095
              std dev =       0.664117866815
             le_variance =       0.441052541023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743158053818        initial  <--
     6.2500e-01     6.2500e+00             1.0008e-03        -0.742958942917
     2.5000e+00     2.5000e+01             2.6732e-04        -0.742634856242
     1.0000e+01     1.0000e+02             6.7994e-05        -0.723817809495

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.3752
  </log>
  <optVariables href="FORM.s013.opt.xml">
ci_001                -7.018571e-01 3 1  ON 0
ci_002                -7.061452e-01 3 1  ON 1
ci_003                -5.325163e-02 3 1  ON 2
ci_004                -5.421915e-02 3 1  ON 3
ci_005                 1.955259e-02 3 1  ON 4
ci_006                 1.970647e-02 3 1  ON 5
ci_007                 1.593397e-02 3 1  ON 6
ci_008                 1.581103e-02 3 1  ON 7
ci_009                -1.221644e-02 3 1  ON 8
ci_010                -1.256788e-02 3 1  ON 9
ci_011                -9.621891e-03 3 1  ON 10
ci_012                -9.759765e-03 3 1  ON 11
ci_013                 8.740242e-03 3 1  ON 12
ci_014                 8.760239e-03 3 1  ON 13
ci_015                 9.197888e-03 3 1  ON 14
ci_016                 9.485509e-03 3 1  ON 15
ci_017                 8.608577e-03 3 1  ON 16
ci_018                 8.230134e-03 3 1  ON 17
ci_019                -1.508401e-03 3 1  ON 18
ci_020                -1.393722e-03 3 1  ON 19
ci_021                -1.057062e-02 3 1  ON 20
ci_022                -1.123246e-02 3 1  ON 21
ci_023                 5.430427e-03 3 1  ON 22
ci_024                 5.203732e-03 3 1  ON 23
ci_025                 1.297585e-02 3 1  ON 24
ci_026                 1.262060e-02 3 1  ON 25
ci_027                 6.266854e-03 3 1  ON 26
ci_028                 6.259751e-03 3 1  ON 27
ci_029                -3.717927e-03 3 1  ON 28
ci_030                -4.408037e-03 3 1  ON 29
ci_031                 4.191783e-03 3 1  ON 30
ci_032                 3.805001e-03 3 1  ON 31
ci_033                 3.405677e-03 3 1  ON 32
ci_034                 3.333381e-03 3 1  ON 33
ci_035                 2.193111e-03 3 1  ON 34
ci_036                 2.082071e-03 3 1  ON 35
ci_037                 3.356316e-03 3 1  ON 36
ci_038                 3.297832e-03 3 1  ON 37
ci_039                 4.293327e-03 3 1  ON 38
ci_040                 4.421723e-03 3 1  ON 39
ci_041                 2.805459e-03 3 1  ON 40
ci_042                 2.869915e-03 3 1  ON 41
ci_043                 3.458292e-03 3 1  ON 42
ci_044                 3.118857e-03 3 1  ON 43
ci_045                 2.542998e-03 3 1  ON 44
ci_046                 2.916648e-03 3 1  ON 45
ci_047                -1.004465e-03 3 1  ON 46
ci_048                -1.145999e-03 3 1  ON 47
ci_049                 7.157761e-04 3 1  ON 48
ci_050                 7.512278e-04 3 1  ON 49
ci_051                -1.452884e-03 3 1  ON 50
ci_052                -1.326285e-03 3 1  ON 51
ci_053                -2.557780e-03 3 1  ON 52
ci_054                -2.686763e-03 3 1  ON 53
ci_055                -1.570095e-03 3 1  ON 54
ci_056                -1.305349e-03 3 1  ON 55
ci_057                -1.020729e-03 3 1  ON 56
ci_058                -9.820452e-04 3 1  ON 57
ci_059                -3.387935e-04 3 1  ON 58
ci_060                -2.460046e-04 3 1  ON 59
ci_061                -6.584114e-04 3 1  ON 60
ci_062                -4.332039e-04 3 1  ON 61
ci_063                -6.510258e-04 3 1  ON 62
ci_064                -7.815839e-04 3 1  ON 63
ci_065                -1.800707e-03 3 1  ON 64
ci_066                -1.700236e-03 3 1  ON 65
ci_067                -1.660072e-03 3 1  ON 66
ci_068                -1.555719e-03 3 1  ON 67
ci_069                -1.997204e-05 3 1  ON 68
ci_070                 1.072885e-04 3 1  ON 69
ci_071                -1.493322e-03 3 1  ON 70
ci_072                -1.910942e-03 3 1  ON 71
ci_073                 8.923356e-05 3 1  ON 72
ci_074                 1.595920e-04 3 1  ON 73
ci_075                 1.357007e-04 3 1  ON 74
ci_076                 2.466771e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6569e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6631
    reference variance = 0.251888
====================================================
  Execution time = 2.5806e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4420e-01
  Total weights = 1.955225791e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436162147958
                                         uncertainty =       0.001913438567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436162147958
                                         uncertainty =       0.001913438567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466990724
  error estimate for blocks of size 2^( 2) =       0.000491449471
  error estimate for blocks of size 2^( 3) =       0.000513842852
  error estimate for blocks of size 2^( 4) =       0.000529933170
  error estimate for blocks of size 2^( 5) =       0.000538941085
  error estimate for blocks of size 2^( 6) =       0.000542832017
  error estimate for blocks of size 2^( 7) =       0.000548346689

      target function =      -0.750092813721
              le_mean =     -22.661835002036
             les_mean =     514.002962329933
             stat err =       0.000540013240
             autocorr =       1.337187498230
   target nu stat err =       0.000540013240
   target dn stat err =       0.002254607479
      target stat err =       0.001963762212
              std dev =       0.660424615717
             le_variance =       0.436160673045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266183500204e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750096992434       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750098970587       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750099310122       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750099348200       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750099350834       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750099354302       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750099360074       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750099360814       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750099361203       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+00 is 2.607060e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750096992434       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750097489808       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750097574945       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750097584474       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750097585126       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750097585988       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750097587423       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750097587606       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750097587702       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 6.547819e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750096992434       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750097116956       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750097138256       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750097140639       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750097140802       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750097141017       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750097141375       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750097141421       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750097141445       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+02 is 1.638851e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185908 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0485e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.018569e-01 3 1  ON 0
ci_002                -7.061455e-01 3 1  ON 1
ci_003                -5.325148e-02 3 1  ON 2
ci_004                -5.422342e-02 3 1  ON 3
ci_005                 1.955107e-02 3 1  ON 4
ci_006                 1.970478e-02 3 1  ON 5
ci_007                 1.593021e-02 3 1  ON 6
ci_008                 1.580872e-02 3 1  ON 7
ci_009                -1.221426e-02 3 1  ON 8
ci_010                -1.256540e-02 3 1  ON 9
ci_011                -9.622406e-03 3 1  ON 10
ci_012                -9.755614e-03 3 1  ON 11
ci_013                 8.739389e-03 3 1  ON 12
ci_014                 8.756420e-03 3 1  ON 13
ci_015                 9.200779e-03 3 1  ON 14
ci_016                 9.481443e-03 3 1  ON 15
ci_017                 8.604192e-03 3 1  ON 16
ci_018                 8.226210e-03 3 1  ON 17
ci_019                -1.514949e-03 3 1  ON 18
ci_020                -1.398316e-03 3 1  ON 19
ci_021                -1.057160e-02 3 1  ON 20
ci_022                -1.123437e-02 3 1  ON 21
ci_023                 5.428765e-03 3 1  ON 22
ci_024                 5.202964e-03 3 1  ON 23
ci_025                 1.297601e-02 3 1  ON 24
ci_026                 1.262073e-02 3 1  ON 25
ci_027                 6.268195e-03 3 1  ON 26
ci_028                 6.258338e-03 3 1  ON 27
ci_029                -3.715531e-03 3 1  ON 28
ci_030                -4.407212e-03 3 1  ON 29
ci_031                 4.195242e-03 3 1  ON 30
ci_032                 3.805484e-03 3 1  ON 31
ci_033                 3.406289e-03 3 1  ON 32
ci_034                 3.334362e-03 3 1  ON 33
ci_035                 2.193608e-03 3 1  ON 34
ci_036                 2.079981e-03 3 1  ON 35
ci_037                 3.356854e-03 3 1  ON 36
ci_038                 3.297092e-03 3 1  ON 37
ci_039                 4.293020e-03 3 1  ON 38
ci_040                 4.423051e-03 3 1  ON 39
ci_041                 2.803355e-03 3 1  ON 40
ci_042                 2.868314e-03 3 1  ON 41
ci_043                 3.457606e-03 3 1  ON 42
ci_044                 3.118011e-03 3 1  ON 43
ci_045                 2.543978e-03 3 1  ON 44
ci_046                 2.918261e-03 3 1  ON 45
ci_047                -1.003145e-03 3 1  ON 46
ci_048                -1.146440e-03 3 1  ON 47
ci_049                 7.124435e-04 3 1  ON 48
ci_050                 7.507885e-04 3 1  ON 49
ci_051                -1.452932e-03 3 1  ON 50
ci_052                -1.327989e-03 3 1  ON 51
ci_053                -2.557469e-03 3 1  ON 52
ci_054                -2.688219e-03 3 1  ON 53
ci_055                -1.568470e-03 3 1  ON 54
ci_056                -1.305343e-03 3 1  ON 55
ci_057                -1.019800e-03 3 1  ON 56
ci_058                -9.832249e-04 3 1  ON 57
ci_059                -3.399085e-04 3 1  ON 58
ci_060                -2.428459e-04 3 1  ON 59
ci_061                -6.619017e-04 3 1  ON 60
ci_062                -4.321518e-04 3 1  ON 61
ci_063                -6.551829e-04 3 1  ON 62
ci_064                -7.812700e-04 3 1  ON 63
ci_065                -1.801938e-03 3 1  ON 64
ci_066                -1.699270e-03 3 1  ON 65
ci_067                -1.661647e-03 3 1  ON 66
ci_068                -1.555400e-03 3 1  ON 67
ci_069                -2.092241e-05 3 1  ON 68
ci_070                 1.090220e-04 3 1  ON 69
ci_071                -1.494836e-03 3 1  ON 70
ci_072                -1.909819e-03 3 1  ON 71
ci_073                 8.890040e-05 3 1  ON 72
ci_074                 1.581742e-04 3 1  ON 73
ci_075                 1.349772e-04 3 1  ON 74
ci_076                 2.453133e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6605
    reference variance = 0.302528
====================================================
  Execution time = 2.5203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.4917e-01
  Total weights = 1.9553e+06
  Execution time = 3.5935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439010237340
                                         uncertainty =       0.002153858204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439010237340
                                         uncertainty =       0.002153858204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468541776
  error estimate for blocks of size 2^( 2) =       0.000492792288
  error estimate for blocks of size 2^( 3) =       0.000514900842
  error estimate for blocks of size 2^( 4) =       0.000530838809
  error estimate for blocks of size 2^( 5) =       0.000540346578
  error estimate for blocks of size 2^( 6) =       0.000545136515
  error estimate for blocks of size 2^( 7) =       0.000547811689

      target function =      -0.745968319895
              le_mean =     -22.660341935450
             les_mean =     513.940263447360
             stat err =       0.000541033398
             autocorr =       1.333372553627
   target nu stat err =       0.000541033398
   target dn stat err =       0.002730043654
      target stat err =       0.002312971174
              std dev =       0.662618133697
             le_variance =       0.439062791104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439005342521
                                         uncertainty =       0.002153908897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439005342521
                                         uncertainty =       0.002153908897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468539126
  error estimate for blocks of size 2^( 2) =       0.000492790384
  error estimate for blocks of size 2^( 3) =       0.000514899283
  error estimate for blocks of size 2^( 4) =       0.000530837374
  error estimate for blocks of size 2^( 5) =       0.000540345151
  error estimate for blocks of size 2^( 6) =       0.000545134774
  error estimate for blocks of size 2^( 7) =       0.000547809525

      target function =      -0.745962980295
              le_mean =     -22.660342241516
             les_mean =     513.940283841062
             stat err =       0.000541031706
             autocorr =       1.333379299322
   target nu stat err =       0.000541031706
   target dn stat err =       0.002730779348
      target stat err =       0.002313521936
              std dev =       0.662614385953
             le_variance =       0.439057824472

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439007760529
                                         uncertainty =       0.002153883235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439007760529
                                         uncertainty =       0.002153883235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468540435
  error estimate for blocks of size 2^( 2) =       0.000492791322
  error estimate for blocks of size 2^( 3) =       0.000514900050
  error estimate for blocks of size 2^( 4) =       0.000530838080
  error estimate for blocks of size 2^( 5) =       0.000540345853
  error estimate for blocks of size 2^( 6) =       0.000545135634
  error estimate for blocks of size 2^( 7) =       0.000547810595

      target function =      -0.745965939963
              le_mean =     -22.660342087617
             les_mean =     513.940273250983
             stat err =       0.000541032540
             autocorr =       1.333375958874
   target nu stat err =       0.000541032540
   target dn stat err =       0.002730401187
      target stat err =       0.002313240125
              std dev =       0.662616237499
             le_variance =       0.439060278197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439009925563
                                         uncertainty =       0.002153861302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439009925563
                                         uncertainty =       0.002153861302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468541607
  error estimate for blocks of size 2^( 2) =       0.000492792166
  error estimate for blocks of size 2^( 3) =       0.000514900742
  error estimate for blocks of size 2^( 4) =       0.000530838717
  error estimate for blocks of size 2^( 5) =       0.000540346486
  error estimate for blocks of size 2^( 6) =       0.000545136404
  error estimate for blocks of size 2^( 7) =       0.000547811552

      target function =      -0.745968058559
              le_mean =     -22.660341954299
             les_mean =     513.940264620889
             stat err =       0.000541033290
             autocorr =       1.333372981211
   target nu stat err =       0.000541033290
   target dn stat err =       0.002730087146
      target stat err =       0.002313004059
              std dev =       0.662617895026
             le_variance =       0.439062474809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745968319895        initial  <--
     6.2500e+00     6.2500e+01             2.6071e-05        -0.745962980295
     2.5000e+01     2.5000e+02             6.5478e-06        -0.745965939963
     1.0000e+02     1.0000e+03             1.6389e-06        -0.745968058559

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2439
  </log>
  <optVariables href="FORM.s014.opt.xml">
ci_001                -7.018571e-01 3 1  ON 0
ci_002                -7.061452e-01 3 1  ON 1
ci_003                -5.325163e-02 3 1  ON 2
ci_004                -5.421915e-02 3 1  ON 3
ci_005                 1.955259e-02 3 1  ON 4
ci_006                 1.970647e-02 3 1  ON 5
ci_007                 1.593397e-02 3 1  ON 6
ci_008                 1.581103e-02 3 1  ON 7
ci_009                -1.221644e-02 3 1  ON 8
ci_010                -1.256788e-02 3 1  ON 9
ci_011                -9.621891e-03 3 1  ON 10
ci_012                -9.759765e-03 3 1  ON 11
ci_013                 8.740242e-03 3 1  ON 12
ci_014                 8.760239e-03 3 1  ON 13
ci_015                 9.197888e-03 3 1  ON 14
ci_016                 9.485509e-03 3 1  ON 15
ci_017                 8.608577e-03 3 1  ON 16
ci_018                 8.230134e-03 3 1  ON 17
ci_019                -1.508401e-03 3 1  ON 18
ci_020                -1.393722e-03 3 1  ON 19
ci_021                -1.057062e-02 3 1  ON 20
ci_022                -1.123246e-02 3 1  ON 21
ci_023                 5.430427e-03 3 1  ON 22
ci_024                 5.203732e-03 3 1  ON 23
ci_025                 1.297585e-02 3 1  ON 24
ci_026                 1.262060e-02 3 1  ON 25
ci_027                 6.266854e-03 3 1  ON 26
ci_028                 6.259751e-03 3 1  ON 27
ci_029                -3.717927e-03 3 1  ON 28
ci_030                -4.408037e-03 3 1  ON 29
ci_031                 4.191783e-03 3 1  ON 30
ci_032                 3.805001e-03 3 1  ON 31
ci_033                 3.405677e-03 3 1  ON 32
ci_034                 3.333381e-03 3 1  ON 33
ci_035                 2.193111e-03 3 1  ON 34
ci_036                 2.082071e-03 3 1  ON 35
ci_037                 3.356316e-03 3 1  ON 36
ci_038                 3.297832e-03 3 1  ON 37
ci_039                 4.293327e-03 3 1  ON 38
ci_040                 4.421723e-03 3 1  ON 39
ci_041                 2.805459e-03 3 1  ON 40
ci_042                 2.869915e-03 3 1  ON 41
ci_043                 3.458292e-03 3 1  ON 42
ci_044                 3.118857e-03 3 1  ON 43
ci_045                 2.542998e-03 3 1  ON 44
ci_046                 2.916648e-03 3 1  ON 45
ci_047                -1.004465e-03 3 1  ON 46
ci_048                -1.145999e-03 3 1  ON 47
ci_049                 7.157761e-04 3 1  ON 48
ci_050                 7.512278e-04 3 1  ON 49
ci_051                -1.452884e-03 3 1  ON 50
ci_052                -1.326285e-03 3 1  ON 51
ci_053                -2.557780e-03 3 1  ON 52
ci_054                -2.686763e-03 3 1  ON 53
ci_055                -1.570095e-03 3 1  ON 54
ci_056                -1.305349e-03 3 1  ON 55
ci_057                -1.020729e-03 3 1  ON 56
ci_058                -9.820452e-04 3 1  ON 57
ci_059                -3.387935e-04 3 1  ON 58
ci_060                -2.460046e-04 3 1  ON 59
ci_061                -6.584114e-04 3 1  ON 60
ci_062                -4.332039e-04 3 1  ON 61
ci_063                -6.510258e-04 3 1  ON 62
ci_064                -7.815839e-04 3 1  ON 63
ci_065                -1.800707e-03 3 1  ON 64
ci_066                -1.700236e-03 3 1  ON 65
ci_067                -1.660072e-03 3 1  ON 66
ci_068                -1.555719e-03 3 1  ON 67
ci_069                -1.997204e-05 3 1  ON 68
ci_070                 1.072885e-04 3 1  ON 69
ci_071                -1.493322e-03 3 1  ON 70
ci_072                -1.910942e-03 3 1  ON 71
ci_073                 8.923356e-05 3 1  ON 72
ci_074                 1.595920e-04 3 1  ON 73
ci_075                 1.357007e-04 3 1  ON 74
ci_076                 2.466771e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3754e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.614
    reference variance = 0.41568
====================================================
  Execution time = 2.5967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.7425e-01
  Total weights = 1.955337432e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450761243662
                                         uncertainty =       0.011752134731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450761243662
                                         uncertainty =       0.011752134731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474723834
  error estimate for blocks of size 2^( 2) =       0.000498691357
  error estimate for blocks of size 2^( 3) =       0.000520544166
  error estimate for blocks of size 2^( 4) =       0.000536279020
  error estimate for blocks of size 2^( 5) =       0.000545101702
  error estimate for blocks of size 2^( 6) =       0.000550515928
  error estimate for blocks of size 2^( 7) =       0.000553729192

      target function =      -0.725452301015
              le_mean =     -22.661454988558
             les_mean =     514.015788961524
             stat err =       0.000546406461
             autocorr =       1.324797736611
   target nu stat err =       0.000546406461
   target dn stat err =       0.024973336053
      target stat err =       0.019393737710
              std dev =       0.671360885105
             le_variance =       0.450725438050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266145498856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.725971790560       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.725977243466       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.725977853413       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.725978080934       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.725978221069       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.725978324510       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.725978348044       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.725978352956       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.725978355040       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.725978353751       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.725978353250       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.725978353115       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.725978353111       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 2.303307e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.725971790560       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.725973154569       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.725973307119       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.725973364010       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.725973399045       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.725973424889       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.725973430766       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.725973431991       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.725973432511       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.725973432188       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.725973432063       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.725973432031       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.725973432028       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+02 is 5.761561e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.725971790560       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.725972131611       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.725972169752       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.725972183976       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.725972192734       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.725972199197       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.725972200663       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.725972200970       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.725972201099       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.725972201021       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.725972200988       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.725972200978       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.725972200978       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+03 is 1.440596e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0632e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.018625e-01 3 1  ON 0
ci_002                -7.061397e-01 3 1  ON 1
ci_003                -5.325510e-02 3 1  ON 2
ci_004                -5.421875e-02 3 1  ON 3
ci_005                 1.955263e-02 3 1  ON 4
ci_006                 1.970586e-02 3 1  ON 5
ci_007                 1.593193e-02 3 1  ON 6
ci_008                 1.581101e-02 3 1  ON 7
ci_009                -1.221669e-02 3 1  ON 8
ci_010                -1.256728e-02 3 1  ON 9
ci_011                -9.621667e-03 3 1  ON 10
ci_012                -9.759765e-03 3 1  ON 11
ci_013                 8.740206e-03 3 1  ON 12
ci_014                 8.759415e-03 3 1  ON 13
ci_015                 9.197431e-03 3 1  ON 14
ci_016                 9.488875e-03 3 1  ON 15
ci_017                 8.602816e-03 3 1  ON 16
ci_018                 8.230214e-03 3 1  ON 17
ci_019                -1.507995e-03 3 1  ON 18
ci_020                -1.393210e-03 3 1  ON 19
ci_021                -1.057103e-02 3 1  ON 20
ci_022                -1.123451e-02 3 1  ON 21
ci_023                 5.430292e-03 3 1  ON 22
ci_024                 5.203720e-03 3 1  ON 23
ci_025                 1.297664e-02 3 1  ON 24
ci_026                 1.262136e-02 3 1  ON 25
ci_027                 6.266974e-03 3 1  ON 26
ci_028                 6.259827e-03 3 1  ON 27
ci_029                -3.717524e-03 3 1  ON 28
ci_030                -4.409159e-03 3 1  ON 29
ci_031                 4.192175e-03 3 1  ON 30
ci_032                 3.805353e-03 3 1  ON 31
ci_033                 3.404693e-03 3 1  ON 32
ci_034                 3.333350e-03 3 1  ON 33
ci_035                 2.193381e-03 3 1  ON 34
ci_036                 2.081875e-03 3 1  ON 35
ci_037                 3.356363e-03 3 1  ON 36
ci_038                 3.297889e-03 3 1  ON 37
ci_039                 4.293697e-03 3 1  ON 38
ci_040                 4.421635e-03 3 1  ON 39
ci_041                 2.805350e-03 3 1  ON 40
ci_042                 2.870009e-03 3 1  ON 41
ci_043                 3.458589e-03 3 1  ON 42
ci_044                 3.118426e-03 3 1  ON 43
ci_045                 2.544055e-03 3 1  ON 44
ci_046                 2.916964e-03 3 1  ON 45
ci_047                -1.004273e-03 3 1  ON 46
ci_048                -1.145576e-03 3 1  ON 47
ci_049                 7.164208e-04 3 1  ON 48
ci_050                 7.516211e-04 3 1  ON 49
ci_051                -1.454768e-03 3 1  ON 50
ci_052                -1.326466e-03 3 1  ON 51
ci_053                -2.557727e-03 3 1  ON 52
ci_054                -2.687481e-03 3 1  ON 53
ci_055                -1.570121e-03 3 1  ON 54
ci_056                -1.305645e-03 3 1  ON 55
ci_057                -1.020380e-03 3 1  ON 56
ci_058                -9.824751e-04 3 1  ON 57
ci_059                -3.386071e-04 3 1  ON 58
ci_060                -2.458898e-04 3 1  ON 59
ci_061                -6.582036e-04 3 1  ON 60
ci_062                -4.332389e-04 3 1  ON 61
ci_063                -6.510731e-04 3 1  ON 62
ci_064                -7.825064e-04 3 1  ON 63
ci_065                -1.801387e-03 3 1  ON 64
ci_066                -1.700283e-03 3 1  ON 65
ci_067                -1.660031e-03 3 1  ON 66
ci_068                -1.554924e-03 3 1  ON 67
ci_069                -1.967080e-05 3 1  ON 68
ci_070                 1.069112e-04 3 1  ON 69
ci_071                -1.494293e-03 3 1  ON 70
ci_072                -1.911016e-03 3 1  ON 71
ci_073                 8.938612e-05 3 1  ON 72
ci_074                 1.594742e-04 3 1  ON 73
ci_075                 1.355494e-04 3 1  ON 74
ci_076                 2.461601e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6724
    reference variance = 0.334395
====================================================
  Execution time = 2.5218e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5039e-01
  Total weights = 1.9548e+06
  Execution time = 3.5893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440299947391
                                         uncertainty =       0.002374718418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440299947391
                                         uncertainty =       0.002374718418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469264203
  error estimate for blocks of size 2^( 2) =       0.000493159416
  error estimate for blocks of size 2^( 3) =       0.000515620212
  error estimate for blocks of size 2^( 4) =       0.000532280831
  error estimate for blocks of size 2^( 5) =       0.000541577722
  error estimate for blocks of size 2^( 6) =       0.000546761145
  error estimate for blocks of size 2^( 7) =       0.000550707819

      target function =      -0.744985265135
              le_mean =     -22.662205637223
             les_mean =     514.025958589892
             stat err =       0.000542831879
             autocorr =       1.338122387235
   target nu stat err =       0.000542831879
   target dn stat err =       0.003169790868
      target stat err =       0.002663496416
              std dev =       0.663639800690
             le_variance =       0.440417785060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440300989990
                                         uncertainty =       0.002375023013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440300989990
                                         uncertainty =       0.002375023013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469264759
  error estimate for blocks of size 2^( 2) =       0.000493160027
  error estimate for blocks of size 2^( 3) =       0.000515620985
  error estimate for blocks of size 2^( 4) =       0.000532281484
  error estimate for blocks of size 2^( 5) =       0.000541578366
  error estimate for blocks of size 2^( 6) =       0.000546761645
  error estimate for blocks of size 2^( 7) =       0.000550708173

      target function =      -0.744985064700
              le_mean =     -22.662205639500
             les_mean =     514.025958938174
             stat err =       0.000542832417
             autocorr =       1.338121873461
   target nu stat err =       0.000542832417
   target dn stat err =       0.003169740682
      target stat err =       0.002663455106
              std dev =       0.663640585879
             le_variance =       0.440418827226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440300464746
                                         uncertainty =       0.002374870478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440300464746
                                         uncertainty =       0.002374870478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469264479
  error estimate for blocks of size 2^( 2) =       0.000493159720
  error estimate for blocks of size 2^( 3) =       0.000515620596
  error estimate for blocks of size 2^( 4) =       0.000532281155
  error estimate for blocks of size 2^( 5) =       0.000541578042
  error estimate for blocks of size 2^( 6) =       0.000546761393
  error estimate for blocks of size 2^( 7) =       0.000550707993

      target function =      -0.744985333536
              le_mean =     -22.662205637939
             les_mean =     514.025958538996
             stat err =       0.000542832146
             autocorr =       1.338122131092
   target nu stat err =       0.000542832146
   target dn stat err =       0.003169764091
      target stat err =       0.002663475590
              std dev =       0.663640190315
             le_variance =       0.440418302201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440300011624
                                         uncertainty =       0.002374737398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440300011624
                                         uncertainty =       0.002374737398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469264238
  error estimate for blocks of size 2^( 2) =       0.000493159454
  error estimate for blocks of size 2^( 3) =       0.000515620260
  error estimate for blocks of size 2^( 4) =       0.000532280871
  error estimate for blocks of size 2^( 5) =       0.000541577762
  error estimate for blocks of size 2^( 6) =       0.000546761176
  error estimate for blocks of size 2^( 7) =       0.000550707840

      target function =      -0.744985283974
              le_mean =     -22.662205637270
             les_mean =     514.025958569043
             stat err =       0.000542831912
             autocorr =       1.338122355280
   target nu stat err =       0.000542831912
   target dn stat err =       0.003169787338
      target stat err =       0.002663493739
              std dev =       0.663639849064
             le_variance =       0.440417849266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744985265135        initial
     6.2500e+01     6.2500e+02             2.3033e-05        -0.744985064700
     2.5000e+02     2.5000e+03             5.7616e-06        -0.744985333536  <--
     1.0000e+03     1.0000e+04             1.4406e-06        -0.744985283974

*****************************************************************************
Applying the update for shift_i =   2.5000e+02     and shift_s =   2.5000e+03
*****************************************************************************

  Execution time = 4.4216e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
ci_001                -7.018625e-01 3 1  ON 0
ci_002                -7.061397e-01 3 1  ON 1
ci_003                -5.325510e-02 3 1  ON 2
ci_004                -5.421875e-02 3 1  ON 3
ci_005                 1.955263e-02 3 1  ON 4
ci_006                 1.970586e-02 3 1  ON 5
ci_007                 1.593193e-02 3 1  ON 6
ci_008                 1.581101e-02 3 1  ON 7
ci_009                -1.221669e-02 3 1  ON 8
ci_010                -1.256728e-02 3 1  ON 9
ci_011                -9.621667e-03 3 1  ON 10
ci_012                -9.759765e-03 3 1  ON 11
ci_013                 8.740206e-03 3 1  ON 12
ci_014                 8.759415e-03 3 1  ON 13
ci_015                 9.197431e-03 3 1  ON 14
ci_016                 9.488875e-03 3 1  ON 15
ci_017                 8.602816e-03 3 1  ON 16
ci_018                 8.230214e-03 3 1  ON 17
ci_019                -1.507995e-03 3 1  ON 18
ci_020                -1.393210e-03 3 1  ON 19
ci_021                -1.057103e-02 3 1  ON 20
ci_022                -1.123451e-02 3 1  ON 21
ci_023                 5.430292e-03 3 1  ON 22
ci_024                 5.203720e-03 3 1  ON 23
ci_025                 1.297664e-02 3 1  ON 24
ci_026                 1.262136e-02 3 1  ON 25
ci_027                 6.266974e-03 3 1  ON 26
ci_028                 6.259827e-03 3 1  ON 27
ci_029                -3.717524e-03 3 1  ON 28
ci_030                -4.409159e-03 3 1  ON 29
ci_031                 4.192175e-03 3 1  ON 30
ci_032                 3.805353e-03 3 1  ON 31
ci_033                 3.404693e-03 3 1  ON 32
ci_034                 3.333350e-03 3 1  ON 33
ci_035                 2.193381e-03 3 1  ON 34
ci_036                 2.081875e-03 3 1  ON 35
ci_037                 3.356363e-03 3 1  ON 36
ci_038                 3.297889e-03 3 1  ON 37
ci_039                 4.293697e-03 3 1  ON 38
ci_040                 4.421635e-03 3 1  ON 39
ci_041                 2.805350e-03 3 1  ON 40
ci_042                 2.870009e-03 3 1  ON 41
ci_043                 3.458589e-03 3 1  ON 42
ci_044                 3.118426e-03 3 1  ON 43
ci_045                 2.544055e-03 3 1  ON 44
ci_046                 2.916964e-03 3 1  ON 45
ci_047                -1.004273e-03 3 1  ON 46
ci_048                -1.145576e-03 3 1  ON 47
ci_049                 7.164208e-04 3 1  ON 48
ci_050                 7.516211e-04 3 1  ON 49
ci_051                -1.454768e-03 3 1  ON 50
ci_052                -1.326466e-03 3 1  ON 51
ci_053                -2.557727e-03 3 1  ON 52
ci_054                -2.687481e-03 3 1  ON 53
ci_055                -1.570121e-03 3 1  ON 54
ci_056                -1.305645e-03 3 1  ON 55
ci_057                -1.020380e-03 3 1  ON 56
ci_058                -9.824751e-04 3 1  ON 57
ci_059                -3.386071e-04 3 1  ON 58
ci_060                -2.458898e-04 3 1  ON 59
ci_061                -6.582036e-04 3 1  ON 60
ci_062                -4.332389e-04 3 1  ON 61
ci_063                -6.510731e-04 3 1  ON 62
ci_064                -7.825064e-04 3 1  ON 63
ci_065                -1.801387e-03 3 1  ON 64
ci_066                -1.700283e-03 3 1  ON 65
ci_067                -1.660031e-03 3 1  ON 66
ci_068                -1.554924e-03 3 1  ON 67
ci_069                -1.967080e-05 3 1  ON 68
ci_070                 1.069112e-04 3 1  ON 69
ci_071                -1.494293e-03 3 1  ON 70
ci_072                -1.911016e-03 3 1  ON 71
ci_073                 8.938612e-05 3 1  ON 72
ci_074                 1.594742e-04 3 1  ON 73
ci_075                 1.355494e-04 3 1  ON 74
ci_076                 2.461601e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4874e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.5836
    reference variance = 0.796214
====================================================
  Execution time = 2.5737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4520e-01
  Total weights = 1.954944245e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437415348691
                                         uncertainty =       0.002309200413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437415348691
                                         uncertainty =       0.002309200413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467638383
  error estimate for blocks of size 2^( 2) =       0.000491814676
  error estimate for blocks of size 2^( 3) =       0.000513945723
  error estimate for blocks of size 2^( 4) =       0.000530614612
  error estimate for blocks of size 2^( 5) =       0.000539742237
  error estimate for blocks of size 2^( 6) =       0.000545373288
  error estimate for blocks of size 2^( 7) =       0.000550461660

      target function =      -0.749258695773
              le_mean =     -22.661799056183
             les_mean =     514.002338507381
             stat err =       0.000541547949
             autocorr =       1.341076431647
   target nu stat err =       0.000541547949
   target dn stat err =       0.002297067097
      target stat err =       0.001993513404
              std dev =       0.661340544144
             le_variance =       0.437371315328


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266179905618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749263086139       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749263309562       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749263346511       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749263351392       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749263351561       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749263351877       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749263351930       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749263352250       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749263352428       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749263352476       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749263352477       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+01 is 2.617136e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749263086139       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749263142027       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749263151267       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749263152488       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749263152530       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749263152609       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749263152622       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749263152702       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749263152747       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749263152759       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749263152759       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+02 is 6.545888e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749263086139       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749263100113       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749263102423       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749263102728       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749263102739       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749263102759       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749263102762       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749263102782       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749263102793       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749263102796       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749263102796       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+03 is 1.636663e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0413e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.018624e-01 3 1  ON 0
ci_002                -7.061398e-01 3 1  ON 1
ci_003                -5.325472e-02 3 1  ON 2
ci_004                -5.421849e-02 3 1  ON 3
ci_005                 1.955237e-02 3 1  ON 4
ci_006                 1.970540e-02 3 1  ON 5
ci_007                 1.593170e-02 3 1  ON 6
ci_008                 1.581085e-02 3 1  ON 7
ci_009                -1.221663e-02 3 1  ON 8
ci_010                -1.256718e-02 3 1  ON 9
ci_011                -9.621377e-03 3 1  ON 10
ci_012                -9.759368e-03 3 1  ON 11
ci_013                 8.740059e-03 3 1  ON 12
ci_014                 8.759002e-03 3 1  ON 13
ci_015                 9.197213e-03 3 1  ON 14
ci_016                 9.489156e-03 3 1  ON 15
ci_017                 8.602468e-03 3 1  ON 16
ci_018                 8.229837e-03 3 1  ON 17
ci_019                -1.508650e-03 3 1  ON 18
ci_020                -1.393746e-03 3 1  ON 19
ci_021                -1.057128e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430459e-03 3 1  ON 22
ci_024                 5.203630e-03 3 1  ON 23
ci_025                 1.297669e-02 3 1  ON 24
ci_026                 1.262149e-02 3 1  ON 25
ci_027                 6.266884e-03 3 1  ON 26
ci_028                 6.259846e-03 3 1  ON 27
ci_029                -3.717727e-03 3 1  ON 28
ci_030                -4.409363e-03 3 1  ON 29
ci_031                 4.192269e-03 3 1  ON 30
ci_032                 3.805591e-03 3 1  ON 31
ci_033                 3.404651e-03 3 1  ON 32
ci_034                 3.333398e-03 3 1  ON 33
ci_035                 2.193284e-03 3 1  ON 34
ci_036                 2.081792e-03 3 1  ON 35
ci_037                 3.356569e-03 3 1  ON 36
ci_038                 3.297790e-03 3 1  ON 37
ci_039                 4.293869e-03 3 1  ON 38
ci_040                 4.421541e-03 3 1  ON 39
ci_041                 2.805318e-03 3 1  ON 40
ci_042                 2.870127e-03 3 1  ON 41
ci_043                 3.458287e-03 3 1  ON 42
ci_044                 3.117994e-03 3 1  ON 43
ci_045                 2.544260e-03 3 1  ON 44
ci_046                 2.917073e-03 3 1  ON 45
ci_047                -1.004424e-03 3 1  ON 46
ci_048                -1.145695e-03 3 1  ON 47
ci_049                 7.165481e-04 3 1  ON 48
ci_050                 7.513597e-04 3 1  ON 49
ci_051                -1.454578e-03 3 1  ON 50
ci_052                -1.326503e-03 3 1  ON 51
ci_053                -2.557459e-03 3 1  ON 52
ci_054                -2.687333e-03 3 1  ON 53
ci_055                -1.570190e-03 3 1  ON 54
ci_056                -1.305757e-03 3 1  ON 55
ci_057                -1.020450e-03 3 1  ON 56
ci_058                -9.824018e-04 3 1  ON 57
ci_059                -3.385569e-04 3 1  ON 58
ci_060                -2.459272e-04 3 1  ON 59
ci_061                -6.580722e-04 3 1  ON 60
ci_062                -4.334841e-04 3 1  ON 61
ci_063                -6.509075e-04 3 1  ON 62
ci_064                -7.823147e-04 3 1  ON 63
ci_065                -1.801573e-03 3 1  ON 64
ci_066                -1.700248e-03 3 1  ON 65
ci_067                -1.660135e-03 3 1  ON 66
ci_068                -1.555073e-03 3 1  ON 67
ci_069                -1.963111e-05 3 1  ON 68
ci_070                 1.065598e-04 3 1  ON 69
ci_071                -1.494413e-03 3 1  ON 70
ci_072                -1.910924e-03 3 1  ON 71
ci_073                 8.912222e-05 3 1  ON 72
ci_074                 1.594319e-04 3 1  ON 73
ci_075                 1.355189e-04 3 1  ON 74
ci_076                 2.467838e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6427
    reference variance = 0.274937
====================================================
  Execution time = 2.5536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5287e-01
  Total weights = 1.9555e+06
  Execution time = 3.5923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442410832909
                                         uncertainty =       0.004976499276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442410832909
                                         uncertainty =       0.004976499276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470322980
  error estimate for blocks of size 2^( 2) =       0.000494615914
  error estimate for blocks of size 2^( 3) =       0.000517476951
  error estimate for blocks of size 2^( 4) =       0.000533656908
  error estimate for blocks of size 2^( 5) =       0.000543083597
  error estimate for blocks of size 2^( 6) =       0.000547826157
  error estimate for blocks of size 2^( 7) =       0.000551848280

      target function =      -0.742929444876
              le_mean =     -22.661192242951
             les_mean =     513.982505251830
             stat err =       0.000544103736
             autocorr =       1.338354049598
   target nu stat err =       0.000544103736
   target dn stat err =       0.006074704388
      target stat err =       0.004975808405
              std dev =       0.665137137097
             le_variance =       0.442407411146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442410580976
                                         uncertainty =       0.004976702475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442410580976
                                         uncertainty =       0.004976702475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470322846
  error estimate for blocks of size 2^( 2) =       0.000494615838
  error estimate for blocks of size 2^( 3) =       0.000517476942
  error estimate for blocks of size 2^( 4) =       0.000533656938
  error estimate for blocks of size 2^( 5) =       0.000543083682
  error estimate for blocks of size 2^( 6) =       0.000547826122
  error estimate for blocks of size 2^( 7) =       0.000551848234

      target function =      -0.742928254425
              le_mean =     -22.661192251876
             les_mean =     513.982507115998
             stat err =       0.000544103744
             autocorr =       1.338354850071
   target nu stat err =       0.000544103744
   target dn stat err =       0.006075035931
      target stat err =       0.004976060339
              std dev =       0.665136948186
             le_variance =       0.442407159843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442410706766
                                         uncertainty =       0.004976600942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442410706766
                                         uncertainty =       0.004976600942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470322913
  error estimate for blocks of size 2^( 2) =       0.000494615876
  error estimate for blocks of size 2^( 3) =       0.000517476947
  error estimate for blocks of size 2^( 4) =       0.000533656923
  error estimate for blocks of size 2^( 5) =       0.000543083639
  error estimate for blocks of size 2^( 6) =       0.000547826140
  error estimate for blocks of size 2^( 7) =       0.000551848257

      target function =      -0.742928856378
              le_mean =     -22.661192247397
             les_mean =     513.982506174873
             stat err =       0.000544103740
             autocorr =       1.338354450112
   target nu stat err =       0.000544103740
   target dn stat err =       0.006074870162
      target stat err =       0.004975934464
              std dev =       0.665137042509
             le_variance =       0.442407285317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442410817124
                                         uncertainty =       0.004976511986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442410817124
                                         uncertainty =       0.004976511986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470322972
  error estimate for blocks of size 2^( 2) =       0.000494615909
  error estimate for blocks of size 2^( 3) =       0.000517476950
  error estimate for blocks of size 2^( 4) =       0.000533656909
  error estimate for blocks of size 2^( 5) =       0.000543083603
  error estimate for blocks of size 2^( 6) =       0.000547826155
  error estimate for blocks of size 2^( 7) =       0.000551848277

      target function =      -0.742929372068
              le_mean =     -22.661192243505
             les_mean =     513.982505366190
             stat err =       0.000544103736
             autocorr =       1.338354099678
   target nu stat err =       0.000544103736
   target dn stat err =       0.006074725102
      target stat err =       0.004975824166
              std dev =       0.665137125261
             le_variance =       0.442407395401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742929444876        initial  <--
     6.2500e+01     6.2500e+02             2.6171e-06        -0.742928254425
     2.5000e+02     2.5000e+03             6.5459e-07        -0.742928856378
     1.0000e+03     1.0000e+04             1.6367e-07        -0.742929372068

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6149
  </log>
  <optVariables href="FORM.s016.opt.xml">
ci_001                -7.018625e-01 3 1  ON 0
ci_002                -7.061397e-01 3 1  ON 1
ci_003                -5.325510e-02 3 1  ON 2
ci_004                -5.421875e-02 3 1  ON 3
ci_005                 1.955263e-02 3 1  ON 4
ci_006                 1.970586e-02 3 1  ON 5
ci_007                 1.593193e-02 3 1  ON 6
ci_008                 1.581101e-02 3 1  ON 7
ci_009                -1.221669e-02 3 1  ON 8
ci_010                -1.256728e-02 3 1  ON 9
ci_011                -9.621667e-03 3 1  ON 10
ci_012                -9.759765e-03 3 1  ON 11
ci_013                 8.740206e-03 3 1  ON 12
ci_014                 8.759415e-03 3 1  ON 13
ci_015                 9.197431e-03 3 1  ON 14
ci_016                 9.488875e-03 3 1  ON 15
ci_017                 8.602816e-03 3 1  ON 16
ci_018                 8.230214e-03 3 1  ON 17
ci_019                -1.507995e-03 3 1  ON 18
ci_020                -1.393210e-03 3 1  ON 19
ci_021                -1.057103e-02 3 1  ON 20
ci_022                -1.123451e-02 3 1  ON 21
ci_023                 5.430292e-03 3 1  ON 22
ci_024                 5.203720e-03 3 1  ON 23
ci_025                 1.297664e-02 3 1  ON 24
ci_026                 1.262136e-02 3 1  ON 25
ci_027                 6.266974e-03 3 1  ON 26
ci_028                 6.259827e-03 3 1  ON 27
ci_029                -3.717524e-03 3 1  ON 28
ci_030                -4.409159e-03 3 1  ON 29
ci_031                 4.192175e-03 3 1  ON 30
ci_032                 3.805353e-03 3 1  ON 31
ci_033                 3.404693e-03 3 1  ON 32
ci_034                 3.333350e-03 3 1  ON 33
ci_035                 2.193381e-03 3 1  ON 34
ci_036                 2.081875e-03 3 1  ON 35
ci_037                 3.356363e-03 3 1  ON 36
ci_038                 3.297889e-03 3 1  ON 37
ci_039                 4.293697e-03 3 1  ON 38
ci_040                 4.421635e-03 3 1  ON 39
ci_041                 2.805350e-03 3 1  ON 40
ci_042                 2.870009e-03 3 1  ON 41
ci_043                 3.458589e-03 3 1  ON 42
ci_044                 3.118426e-03 3 1  ON 43
ci_045                 2.544055e-03 3 1  ON 44
ci_046                 2.916964e-03 3 1  ON 45
ci_047                -1.004273e-03 3 1  ON 46
ci_048                -1.145576e-03 3 1  ON 47
ci_049                 7.164208e-04 3 1  ON 48
ci_050                 7.516211e-04 3 1  ON 49
ci_051                -1.454768e-03 3 1  ON 50
ci_052                -1.326466e-03 3 1  ON 51
ci_053                -2.557727e-03 3 1  ON 52
ci_054                -2.687481e-03 3 1  ON 53
ci_055                -1.570121e-03 3 1  ON 54
ci_056                -1.305645e-03 3 1  ON 55
ci_057                -1.020380e-03 3 1  ON 56
ci_058                -9.824751e-04 3 1  ON 57
ci_059                -3.386071e-04 3 1  ON 58
ci_060                -2.458898e-04 3 1  ON 59
ci_061                -6.582036e-04 3 1  ON 60
ci_062                -4.332389e-04 3 1  ON 61
ci_063                -6.510731e-04 3 1  ON 62
ci_064                -7.825064e-04 3 1  ON 63
ci_065                -1.801387e-03 3 1  ON 64
ci_066                -1.700283e-03 3 1  ON 65
ci_067                -1.660031e-03 3 1  ON 66
ci_068                -1.554924e-03 3 1  ON 67
ci_069                -1.967080e-05 3 1  ON 68
ci_070                 1.069112e-04 3 1  ON 69
ci_071                -1.494293e-03 3 1  ON 70
ci_072                -1.911016e-03 3 1  ON 71
ci_073                 8.938612e-05 3 1  ON 72
ci_074                 1.594742e-04 3 1  ON 73
ci_075                 1.355494e-04 3 1  ON 74
ci_076                 2.461601e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4051e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.5826
    reference variance = 0.397197
====================================================
  Execution time = 2.6091e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4631e-01
  Total weights = 1.955131038e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436523269883
                                         uncertainty =       0.001703713709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436523269883
                                         uncertainty =       0.001703713709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467193616
  error estimate for blocks of size 2^( 2) =       0.000491157249
  error estimate for blocks of size 2^( 3) =       0.000514032523
  error estimate for blocks of size 2^( 4) =       0.000528425200
  error estimate for blocks of size 2^( 5) =       0.000537217225
  error estimate for blocks of size 2^( 6) =       0.000543023380
  error estimate for blocks of size 2^( 7) =       0.000545982394

      target function =      -0.748350777459
              le_mean =     -22.662419970522
             les_mean =     514.031589544886
             stat err =       0.000538662050
             autocorr =       1.329348834825
   target nu stat err =       0.000538662050
   target dn stat err =       0.002589339145
      target stat err =       0.002221484092
              std dev =       0.660711548034
             le_variance =       0.436539749706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266241997052e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748356425740       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748356448504       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748356451539       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748356452339       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748356452397       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748356452556       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748356452484       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748356452437       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748356452494       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748356452525       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748356452527       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748356452526       residual = 9.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+02 is 2.928716e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748356425740       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748356431431       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748356432190       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748356432390       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748356432405       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748356432439       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748356432426       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748356432411       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748356432429       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748356432433       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748356432435       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748356432445       residual = 9.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+03 is 7.321939e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748356425740       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748356427163       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748356427352       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748356427402       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748356427421       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748356427405       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748356427411       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748356427403       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748356427400       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748356427416       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748356427431       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748356427401       residual = 9.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+04 is 1.830494e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0826e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.018625e-01 3 1  ON 0
ci_002                -7.061396e-01 3 1  ON 1
ci_003                -5.325503e-02 3 1  ON 2
ci_004                -5.421869e-02 3 1  ON 3
ci_005                 1.955261e-02 3 1  ON 4
ci_006                 1.970582e-02 3 1  ON 5
ci_007                 1.593190e-02 3 1  ON 6
ci_008                 1.581097e-02 3 1  ON 7
ci_009                -1.221665e-02 3 1  ON 8
ci_010                -1.256725e-02 3 1  ON 9
ci_011                -9.621642e-03 3 1  ON 10
ci_012                -9.759765e-03 3 1  ON 11
ci_013                 8.740161e-03 3 1  ON 12
ci_014                 8.759379e-03 3 1  ON 13
ci_015                 9.197406e-03 3 1  ON 14
ci_016                 9.488858e-03 3 1  ON 15
ci_017                 8.602830e-03 3 1  ON 16
ci_018                 8.230185e-03 3 1  ON 17
ci_019                -1.508031e-03 3 1  ON 18
ci_020                -1.393260e-03 3 1  ON 19
ci_021                -1.057108e-02 3 1  ON 20
ci_022                -1.123456e-02 3 1  ON 21
ci_023                 5.430286e-03 3 1  ON 22
ci_024                 5.203718e-03 3 1  ON 23
ci_025                 1.297665e-02 3 1  ON 24
ci_026                 1.262141e-02 3 1  ON 25
ci_027                 6.266963e-03 3 1  ON 26
ci_028                 6.259838e-03 3 1  ON 27
ci_029                -3.717516e-03 3 1  ON 28
ci_030                -4.409149e-03 3 1  ON 29
ci_031                 4.192191e-03 3 1  ON 30
ci_032                 3.805347e-03 3 1  ON 31
ci_033                 3.404685e-03 3 1  ON 32
ci_034                 3.333305e-03 3 1  ON 33
ci_035                 2.193372e-03 3 1  ON 34
ci_036                 2.081880e-03 3 1  ON 35
ci_037                 3.356361e-03 3 1  ON 36
ci_038                 3.297877e-03 3 1  ON 37
ci_039                 4.293667e-03 3 1  ON 38
ci_040                 4.421622e-03 3 1  ON 39
ci_041                 2.805349e-03 3 1  ON 40
ci_042                 2.870023e-03 3 1  ON 41
ci_043                 3.458568e-03 3 1  ON 42
ci_044                 3.118408e-03 3 1  ON 43
ci_045                 2.544038e-03 3 1  ON 44
ci_046                 2.916976e-03 3 1  ON 45
ci_047                -1.004268e-03 3 1  ON 46
ci_048                -1.145565e-03 3 1  ON 47
ci_049                 7.164317e-04 3 1  ON 48
ci_050                 7.516269e-04 3 1  ON 49
ci_051                -1.454748e-03 3 1  ON 50
ci_052                -1.326462e-03 3 1  ON 51
ci_053                -2.557716e-03 3 1  ON 52
ci_054                -2.687485e-03 3 1  ON 53
ci_055                -1.570133e-03 3 1  ON 54
ci_056                -1.305654e-03 3 1  ON 55
ci_057                -1.020384e-03 3 1  ON 56
ci_058                -9.824861e-04 3 1  ON 57
ci_059                -3.385983e-04 3 1  ON 58
ci_060                -2.459015e-04 3 1  ON 59
ci_061                -6.581626e-04 3 1  ON 60
ci_062                -4.332263e-04 3 1  ON 61
ci_063                -6.510493e-04 3 1  ON 62
ci_064                -7.824945e-04 3 1  ON 63
ci_065                -1.801392e-03 3 1  ON 64
ci_066                -1.700277e-03 3 1  ON 65
ci_067                -1.660024e-03 3 1  ON 66
ci_068                -1.554929e-03 3 1  ON 67
ci_069                -1.965509e-05 3 1  ON 68
ci_070                 1.069060e-04 3 1  ON 69
ci_071                -1.494321e-03 3 1  ON 70
ci_072                -1.911000e-03 3 1  ON 71
ci_073                 8.939479e-05 3 1  ON 72
ci_074                 1.594591e-04 3 1  ON 73
ci_075                 1.355772e-04 3 1  ON 74
ci_076                 2.461637e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.645
    reference variance = 0.372976
====================================================
  Execution time = 2.5504e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4901e-01
  Total weights = 1.9550e+06
  Execution time = 3.6085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438606644278
                                         uncertainty =       0.002153880097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438606644278
                                         uncertainty =       0.002153880097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468302632
  error estimate for blocks of size 2^( 2) =       0.000491878499
  error estimate for blocks of size 2^( 3) =       0.000514560914
  error estimate for blocks of size 2^( 4) =       0.000530831753
  error estimate for blocks of size 2^( 5) =       0.000541262609
  error estimate for blocks of size 2^( 6) =       0.000547497680
  error estimate for blocks of size 2^( 7) =       0.000550329952

      target function =      -0.746119178393
              le_mean =     -22.662016210578
             les_mean =     514.015987933931
             stat err =       0.000542480499
             autocorr =       1.341884277594
   target nu stat err =       0.000542480499
   target dn stat err =       0.003111628470
      target stat err =       0.002624041550
              std dev =       0.662279932847
             le_variance =       0.438614709452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438606602749
                                         uncertainty =       0.002153880633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438606602749
                                         uncertainty =       0.002153880633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468302609
  error estimate for blocks of size 2^( 2) =       0.000491878484
  error estimate for blocks of size 2^( 3) =       0.000514560902
  error estimate for blocks of size 2^( 4) =       0.000530831743
  error estimate for blocks of size 2^( 5) =       0.000541262595
  error estimate for blocks of size 2^( 6) =       0.000547497668
  error estimate for blocks of size 2^( 7) =       0.000550329935

      target function =      -0.746119335534
              le_mean =     -22.662016210666
             les_mean =     514.015987746815
             stat err =       0.000542480486
             autocorr =       1.341884340522
   target nu stat err =       0.000542480486
   target dn stat err =       0.003111591965
      target stat err =       0.002624013432
              std dev =       0.662279901463
             le_variance =       0.438614667882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438606623511
                                         uncertainty =       0.002153880365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438606623511
                                         uncertainty =       0.002153880365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468302620
  error estimate for blocks of size 2^( 2) =       0.000491878492
  error estimate for blocks of size 2^( 3) =       0.000514560908
  error estimate for blocks of size 2^( 4) =       0.000530831748
  error estimate for blocks of size 2^( 5) =       0.000541262602
  error estimate for blocks of size 2^( 6) =       0.000547497674
  error estimate for blocks of size 2^( 7) =       0.000550329944

      target function =      -0.746119282885
              le_mean =     -22.662016210622
             les_mean =     514.015987808812
             stat err =       0.000542480492
             autocorr =       1.341884309068
   target nu stat err =       0.000542480492
   target dn stat err =       0.003111610206
      target stat err =       0.002624027659
              std dev =       0.662279917153
             le_variance =       0.438614688664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438606641682
                                         uncertainty =       0.002153880130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438606641682
                                         uncertainty =       0.002153880130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468302630
  error estimate for blocks of size 2^( 2) =       0.000491878498
  error estimate for blocks of size 2^( 3) =       0.000514560913
  error estimate for blocks of size 2^( 4) =       0.000530831753
  error estimate for blocks of size 2^( 5) =       0.000541262608
  error estimate for blocks of size 2^( 6) =       0.000547497679
  error estimate for blocks of size 2^( 7) =       0.000550329951

      target function =      -0.746119193516
              le_mean =     -22.662016210583
             les_mean =     514.015987915781
             stat err =       0.000542480498
             autocorr =       1.341884281526
   target nu stat err =       0.000542480498
   target dn stat err =       0.003111626185
      target stat err =       0.002624039826
              std dev =       0.662279930885
             le_variance =       0.438614706854


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746119178393        initial
     6.2500e+02     6.2500e+03             2.9287e-07        -0.746119335534  <--
     2.5000e+03     2.5000e+04             7.3219e-08        -0.746119282885
     1.0000e+04     1.0000e+05             1.8305e-08        -0.746119193516

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 4.5584e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759271e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331885e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6688
    reference variance = 0.354702
====================================================
  Execution time = 2.5946e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4834e-01
  Total weights = 1.955286566e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7148e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439814367580
                                         uncertainty =       0.002241783581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439814367580
                                         uncertainty =       0.002241783581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468947197
  error estimate for blocks of size 2^( 2) =       0.000492940928
  error estimate for blocks of size 2^( 3) =       0.000515164048
  error estimate for blocks of size 2^( 4) =       0.000530690550
  error estimate for blocks of size 2^( 5) =       0.000539041152
  error estimate for blocks of size 2^( 6) =       0.000543146814
  error estimate for blocks of size 2^( 7) =       0.000543342645

      target function =      -0.746679163654
              le_mean =     -22.662378208153
             les_mean =     514.031723319575
             stat err =       0.000539055290
             autocorr =       1.321352638955
   target nu stat err =       0.000539055290
   target dn stat err =       0.002501283481
      target stat err =       0.002142198814
              std dev =       0.663191485735
             le_variance =       0.439822946752


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266237820815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746684402903       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746684483123       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746684494261       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746684495108       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746684495261       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746684495405       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746684495457       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746684495364       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746684495339       residual = 6.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+02 is 1.187360e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746684402903       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746684422963       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746684425747       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746684425959       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746684425997       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746684426033       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746684426047       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746684426023       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746684426018       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+02 is 2.968981e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746684402903       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746684407918       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746684408615       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746684408667       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746684408677       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746684408686       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746684408689       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746684408684       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746684408686       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+03 is 7.422815e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203683 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0670e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.018625e-01 3 1  ON 0
ci_002                -7.061396e-01 3 1  ON 1
ci_003                -5.325482e-02 3 1  ON 2
ci_004                -5.421850e-02 3 1  ON 3
ci_005                 1.955248e-02 3 1  ON 4
ci_006                 1.970563e-02 3 1  ON 5
ci_007                 1.593185e-02 3 1  ON 6
ci_008                 1.581077e-02 3 1  ON 7
ci_009                -1.221637e-02 3 1  ON 8
ci_010                -1.256713e-02 3 1  ON 9
ci_011                -9.621552e-03 3 1  ON 10
ci_012                -9.759599e-03 3 1  ON 11
ci_013                 8.740006e-03 3 1  ON 12
ci_014                 8.759216e-03 3 1  ON 13
ci_015                 9.197235e-03 3 1  ON 14
ci_016                 9.488658e-03 3 1  ON 15
ci_017                 8.602906e-03 3 1  ON 16
ci_018                 8.230038e-03 3 1  ON 17
ci_019                -1.508437e-03 3 1  ON 18
ci_020                -1.393582e-03 3 1  ON 19
ci_021                -1.057143e-02 3 1  ON 20
ci_022                -1.123482e-02 3 1  ON 21
ci_023                 5.430167e-03 3 1  ON 22
ci_024                 5.203716e-03 3 1  ON 23
ci_025                 1.297679e-02 3 1  ON 24
ci_026                 1.262164e-02 3 1  ON 25
ci_027                 6.266912e-03 3 1  ON 26
ci_028                 6.259925e-03 3 1  ON 27
ci_029                -3.717522e-03 3 1  ON 28
ci_030                -4.409059e-03 3 1  ON 29
ci_031                 4.192372e-03 3 1  ON 30
ci_032                 3.805612e-03 3 1  ON 31
ci_033                 3.404639e-03 3 1  ON 32
ci_034                 3.333259e-03 3 1  ON 33
ci_035                 2.193332e-03 3 1  ON 34
ci_036                 2.081894e-03 3 1  ON 35
ci_037                 3.356349e-03 3 1  ON 36
ci_038                 3.297769e-03 3 1  ON 37
ci_039                 4.293508e-03 3 1  ON 38
ci_040                 4.421594e-03 3 1  ON 39
ci_041                 2.805338e-03 3 1  ON 40
ci_042                 2.870039e-03 3 1  ON 41
ci_043                 3.458468e-03 3 1  ON 42
ci_044                 3.118391e-03 3 1  ON 43
ci_045                 2.543989e-03 3 1  ON 44
ci_046                 2.916978e-03 3 1  ON 45
ci_047                -1.004249e-03 3 1  ON 46
ci_048                -1.145557e-03 3 1  ON 47
ci_049                 7.164313e-04 3 1  ON 48
ci_050                 7.517166e-04 3 1  ON 49
ci_051                -1.454710e-03 3 1  ON 50
ci_052                -1.326377e-03 3 1  ON 51
ci_053                -2.557678e-03 3 1  ON 52
ci_054                -2.687531e-03 3 1  ON 53
ci_055                -1.570173e-03 3 1  ON 54
ci_056                -1.305603e-03 3 1  ON 55
ci_057                -1.020414e-03 3 1  ON 56
ci_058                -9.825084e-04 3 1  ON 57
ci_059                -3.386251e-04 3 1  ON 58
ci_060                -2.459869e-04 3 1  ON 59
ci_061                -6.580580e-04 3 1  ON 60
ci_062                -4.333153e-04 3 1  ON 61
ci_063                -6.509768e-04 3 1  ON 62
ci_064                -7.825669e-04 3 1  ON 63
ci_065                -1.801400e-03 3 1  ON 64
ci_066                -1.700265e-03 3 1  ON 65
ci_067                -1.660041e-03 3 1  ON 66
ci_068                -1.555043e-03 3 1  ON 67
ci_069                -1.966179e-05 3 1  ON 68
ci_070                 1.069215e-04 3 1  ON 69
ci_071                -1.494496e-03 3 1  ON 70
ci_072                -1.910960e-03 3 1  ON 71
ci_073                 8.951282e-05 3 1  ON 72
ci_074                 1.593948e-04 3 1  ON 73
ci_075                 1.356506e-04 3 1  ON 74
ci_076                 2.461585e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6075
    reference variance = 0.42896
====================================================
  Execution time = 2.5123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5071e-01
  Total weights = 1.9548e+06
  Execution time = 3.6056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059710918
                                         uncertainty =       0.002163577650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059710918
                                         uncertainty =       0.002163577650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469630049
  error estimate for blocks of size 2^( 2) =       0.000493425740
  error estimate for blocks of size 2^( 3) =       0.000516094626
  error estimate for blocks of size 2^( 4) =       0.000532110652
  error estimate for blocks of size 2^( 5) =       0.000542213185
  error estimate for blocks of size 2^( 6) =       0.000545797455
  error estimate for blocks of size 2^( 7) =       0.000549441590

      target function =      -0.744719059444
              le_mean =     -22.661255855365
             les_mean =     513.983226617058
             stat err =       0.000542390720
             autocorr =       1.333867674187
   target nu stat err =       0.000542390720
   target dn stat err =       0.002667652386
      target stat err =       0.002259748654
              std dev =       0.664157184126
             le_variance =       0.441104765226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059596505
                                         uncertainty =       0.002163570442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059596505
                                         uncertainty =       0.002163570442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469629988
  error estimate for blocks of size 2^( 2) =       0.000493425697
  error estimate for blocks of size 2^( 3) =       0.000516094591
  error estimate for blocks of size 2^( 4) =       0.000532110608
  error estimate for blocks of size 2^( 5) =       0.000542213132
  error estimate for blocks of size 2^( 6) =       0.000545797380
  error estimate for blocks of size 2^( 7) =       0.000549441524

      target function =      -0.744718733492
              le_mean =     -22.661255849265
             les_mean =     513.983226738969
             stat err =       0.000542390661
             autocorr =       1.333867727911
   target nu stat err =       0.000542390661
   target dn stat err =       0.002667715999
      target stat err =       0.002259796856
              std dev =       0.664157098193
             le_variance =       0.441104651080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059653683
                                         uncertainty =       0.002163574045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059653683
                                         uncertainty =       0.002163574045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469630018
  error estimate for blocks of size 2^( 2) =       0.000493425719
  error estimate for blocks of size 2^( 3) =       0.000516094608
  error estimate for blocks of size 2^( 4) =       0.000532110630
  error estimate for blocks of size 2^( 5) =       0.000542213159
  error estimate for blocks of size 2^( 6) =       0.000545797418
  error estimate for blocks of size 2^( 7) =       0.000549441557

      target function =      -0.744718897085
              le_mean =     -22.661255852312
             les_mean =     513.983226677110
             stat err =       0.000542390691
             autocorr =       1.333867701062
   target nu stat err =       0.000542390691
   target dn stat err =       0.002667684185
      target stat err =       0.002259772752
              std dev =       0.664157141138
             le_variance =       0.441104708125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059703761
                                         uncertainty =       0.002163577199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441059703761
                                         uncertainty =       0.002163577199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469630045
  error estimate for blocks of size 2^( 2) =       0.000493425737
  error estimate for blocks of size 2^( 3) =       0.000516094623
  error estimate for blocks of size 2^( 4) =       0.000532110649
  error estimate for blocks of size 2^( 5) =       0.000542213182
  error estimate for blocks of size 2^( 6) =       0.000545797450
  error estimate for blocks of size 2^( 7) =       0.000549441586

      target function =      -0.744719039219
              le_mean =     -22.661255854983
             les_mean =     513.983226624465
             stat err =       0.000542390717
             autocorr =       1.333867677543
   target nu stat err =       0.000542390717
   target dn stat err =       0.002667656360
      target stat err =       0.002259751666
              std dev =       0.664157178751
             le_variance =       0.441104758086


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744719059444        initial  <--
     1.5625e+02     1.5625e+03             1.1874e-06        -0.744718733492
     6.2500e+02     6.2500e+03             2.9690e-07        -0.744718897085
     2.5000e+03     2.5000e+04             7.4228e-08        -0.744719039219

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2319
  </log>
  <optVariables href="FORM.s018.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759271e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331885e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3982e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.695
    reference variance = 0.35681
====================================================
  Execution time = 2.6095e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4571e-01
  Total weights = 1.955166711e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437218629796
                                         uncertainty =       0.002022030156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437218629796
                                         uncertainty =       0.002022030156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467565986
  error estimate for blocks of size 2^( 2) =       0.000491944911
  error estimate for blocks of size 2^( 3) =       0.000514005359
  error estimate for blocks of size 2^( 4) =       0.000529691372
  error estimate for blocks of size 2^( 5) =       0.000537530003
  error estimate for blocks of size 2^( 6) =       0.000544178390
  error estimate for blocks of size 2^( 7) =       0.000547508486

      target function =      -0.748819233224
              le_mean =     -22.660977865183
             les_mean =     513.965632035474
             stat err =       0.000539727063
             autocorr =       1.332485740953
   target nu stat err =       0.000539727063
   target dn stat err =       0.002530918157
      target stat err =       0.002173313828
              std dev =       0.661238158127
             le_variance =       0.437235901763


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266097786518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748824596576       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748824607301       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748824609185       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748824609238       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748824609268       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748824609298       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748824609291       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748824609290       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748824609291       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+03 is 1.241017e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748824596576       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748824599257       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748824599728       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748824599741       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748824599750       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748824599756       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748824599755       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748824599755       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748824599751       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+03 is 3.102599e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748824596576       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748824597246       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748824597364       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748824597386       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748824597369       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748824597375       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748824597336       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748824597381       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748824597399       residual = 8.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+04 is 7.756533e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0790e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325480e-02 3 1  ON 2
ci_004                -5.421849e-02 3 1  ON 3
ci_005                 1.955254e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593179e-02 3 1  ON 6
ci_008                 1.581083e-02 3 1  ON 7
ci_009                -1.221654e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621572e-03 3 1  ON 10
ci_012                -9.759758e-03 3 1  ON 11
ci_013                 8.740017e-03 3 1  ON 12
ci_014                 8.759257e-03 3 1  ON 13
ci_015                 9.197316e-03 3 1  ON 14
ci_016                 9.488793e-03 3 1  ON 15
ci_017                 8.602859e-03 3 1  ON 16
ci_018                 8.230090e-03 3 1  ON 17
ci_019                -1.508152e-03 3 1  ON 18
ci_020                -1.393439e-03 3 1  ON 19
ci_021                -1.057123e-02 3 1  ON 20
ci_022                -1.123473e-02 3 1  ON 21
ci_023                 5.430258e-03 3 1  ON 22
ci_024                 5.203711e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262158e-02 3 1  ON 25
ci_027                 6.266927e-03 3 1  ON 26
ci_028                 6.259872e-03 3 1  ON 27
ci_029                -3.717502e-03 3 1  ON 28
ci_030                -4.409120e-03 3 1  ON 29
ci_031                 4.192256e-03 3 1  ON 30
ci_032                 3.805330e-03 3 1  ON 31
ci_033                 3.404660e-03 3 1  ON 32
ci_034                 3.333164e-03 3 1  ON 33
ci_035                 2.193342e-03 3 1  ON 34
ci_036                 2.081890e-03 3 1  ON 35
ci_037                 3.356347e-03 3 1  ON 36
ci_038                 3.297842e-03 3 1  ON 37
ci_039                 4.293579e-03 3 1  ON 38
ci_040                 4.421571e-03 3 1  ON 39
ci_041                 2.805343e-03 3 1  ON 40
ci_042                 2.870058e-03 3 1  ON 41
ci_043                 3.458500e-03 3 1  ON 42
ci_044                 3.118348e-03 3 1  ON 43
ci_045                 2.543974e-03 3 1  ON 44
ci_046                 2.917006e-03 3 1  ON 45
ci_047                -1.004256e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164660e-04 3 1  ON 48
ci_050                 7.516470e-04 3 1  ON 49
ci_051                -1.454683e-03 3 1  ON 50
ci_052                -1.326440e-03 3 1  ON 51
ci_053                -2.557680e-03 3 1  ON 52
ci_054                -2.687489e-03 3 1  ON 53
ci_055                -1.570167e-03 3 1  ON 54
ci_056                -1.305693e-03 3 1  ON 55
ci_057                -1.020385e-03 3 1  ON 56
ci_058                -9.825246e-04 3 1  ON 57
ci_059                -3.385658e-04 3 1  ON 58
ci_060                -2.459301e-04 3 1  ON 59
ci_061                -6.580289e-04 3 1  ON 60
ci_062                -4.331846e-04 3 1  ON 61
ci_063                -6.509792e-04 3 1  ON 62
ci_064                -7.824503e-04 3 1  ON 63
ci_065                -1.801409e-03 3 1  ON 64
ci_066                -1.700265e-03 3 1  ON 65
ci_067                -1.660008e-03 3 1  ON 66
ci_068                -1.554955e-03 3 1  ON 67
ci_069                -1.960556e-05 3 1  ON 68
ci_070                 1.068798e-04 3 1  ON 69
ci_071                -1.494410e-03 3 1  ON 70
ci_072                -1.910935e-03 3 1  ON 71
ci_073                 8.942641e-05 3 1  ON 72
ci_074                 1.594108e-04 3 1  ON 73
ci_075                 1.356569e-04 3 1  ON 74
ci_076                 2.461759e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6743
    reference variance = 0.262586
====================================================
  Execution time = 2.5427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5303e-01
  Total weights = 1.9551e+06
  Execution time = 3.5980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443420563915
                                         uncertainty =       0.002833200727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443420563915
                                         uncertainty =       0.002833200727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470847763
  error estimate for blocks of size 2^( 2) =       0.000494950764
  error estimate for blocks of size 2^( 3) =       0.000516746448
  error estimate for blocks of size 2^( 4) =       0.000532827742
  error estimate for blocks of size 2^( 5) =       0.000543230993
  error estimate for blocks of size 2^( 6) =       0.000548335788
  error estimate for blocks of size 2^( 7) =       0.000550144140

      target function =      -0.742829041213
              le_mean =     -22.662165021148
             les_mean =     514.026758188014
             stat err =       0.000543634666
             autocorr =       1.333070945624
   target nu stat err =       0.000543634666
   target dn stat err =       0.003134395647
      target stat err =       0.002620455665
              std dev =       0.665879291659
             le_variance =       0.443395231061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443420539761
                                         uncertainty =       0.002833199165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443420539761
                                         uncertainty =       0.002833199165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470847750
  error estimate for blocks of size 2^( 2) =       0.000494950753
  error estimate for blocks of size 2^( 3) =       0.000516746439
  error estimate for blocks of size 2^( 4) =       0.000532827734
  error estimate for blocks of size 2^( 5) =       0.000543230984
  error estimate for blocks of size 2^( 6) =       0.000548335778
  error estimate for blocks of size 2^( 7) =       0.000550144130

      target function =      -0.742828662422
              le_mean =     -22.662165022070
             les_mean =     514.026758694364
             stat err =       0.000543634657
             autocorr =       1.333070972485
   target nu stat err =       0.000543634657
   target dn stat err =       0.003134498778
      target stat err =       0.002620534829
              std dev =       0.665879273551
             le_variance =       0.443395206945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443420551837
                                         uncertainty =       0.002833199946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443420551837
                                         uncertainty =       0.002833199946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470847756
  error estimate for blocks of size 2^( 2) =       0.000494950758
  error estimate for blocks of size 2^( 3) =       0.000516746444
  error estimate for blocks of size 2^( 4) =       0.000532827738
  error estimate for blocks of size 2^( 5) =       0.000543230989
  error estimate for blocks of size 2^( 6) =       0.000548335783
  error estimate for blocks of size 2^( 7) =       0.000550144135

      target function =      -0.742828851998
              le_mean =     -22.662165021609
             les_mean =     514.026758440965
             stat err =       0.000543634661
             autocorr =       1.333070959054
   target nu stat err =       0.000543634661
   target dn stat err =       0.003134447196
      target stat err =       0.002620495235
              std dev =       0.665879282605
             le_variance =       0.443395219002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443420562406
                                         uncertainty =       0.002833200629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443420562406
                                         uncertainty =       0.002833200629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470847762
  error estimate for blocks of size 2^( 2) =       0.000494950763
  error estimate for blocks of size 2^( 3) =       0.000516746447
  error estimate for blocks of size 2^( 4) =       0.000532827741
  error estimate for blocks of size 2^( 5) =       0.000543230993
  error estimate for blocks of size 2^( 6) =       0.000548335787
  error estimate for blocks of size 2^( 7) =       0.000550144140

      target function =      -0.742829017581
              le_mean =     -22.662165021206
             les_mean =     514.026758219608
             stat err =       0.000543634665
             autocorr =       1.333070947305
   target nu stat err =       0.000543634665
   target dn stat err =       0.003134402089
      target stat err =       0.002620460610
              std dev =       0.665879290528
             le_variance =       0.443395229553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742829041213        initial  <--
     1.5625e+03     1.5625e+04             1.2410e-07        -0.742828662422
     6.2500e+03     6.2500e+04             3.1026e-08        -0.742828851998
     2.5000e+04     2.5000e+05             7.7565e-09        -0.742829017581

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7751
  </log>
  <optVariables href="FORM.s019.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759271e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331885e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.7782
    reference variance = 0.302005
====================================================
  Execution time = 2.5986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4900e-01
  Total weights = 1.954831447e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439456305264
                                         uncertainty =       0.002206696446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439456305264
                                         uncertainty =       0.002206696446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468709446
  error estimate for blocks of size 2^( 2) =       0.000493281646
  error estimate for blocks of size 2^( 3) =       0.000516008136
  error estimate for blocks of size 2^( 4) =       0.000532923782
  error estimate for blocks of size 2^( 5) =       0.000541225806
  error estimate for blocks of size 2^( 6) =       0.000545588084
  error estimate for blocks of size 2^( 7) =       0.000549059767

      target function =      -0.746121397185
              le_mean =     -22.661718117167
             les_mean =     514.002472658000
             stat err =       0.000542199360
             autocorr =       1.338167842297
   target nu stat err =       0.000542199360
   target dn stat err =       0.002637814174
      target stat err =       0.002245840220
              std dev =       0.662855255106
             le_variance =       0.439377089221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266171811717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746127235305       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746127236050       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746127236231       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746127236265       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746127236277       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746127236277       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746127236305       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746127236284       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746127236285       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746127236236       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746127236285       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746127236246       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+04 is 1.006178e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746127235305       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746127235491       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746127235536       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746127235545       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746127235551       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746127235580       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746127235543       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746127235633       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746127235368       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746127235419       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746127235672       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746127235614       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+04 is 2.515450e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746127235305       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746127235352       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746127235363       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746127235365       residual = 8.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746127235366       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746127235366       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746127235471       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746127235088       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746127235403       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746127235240       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746127234748       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746127234913       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+05 is 6.288629e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0709e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221654e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621569e-03 3 1  ON 10
ci_012                -9.759762e-03 3 1  ON 11
ci_013                 8.740027e-03 3 1  ON 12
ci_014                 8.759269e-03 3 1  ON 13
ci_015                 9.197330e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602870e-03 3 1  ON 16
ci_018                 8.230100e-03 3 1  ON 17
ci_019                -1.508141e-03 3 1  ON 18
ci_020                -1.393410e-03 3 1  ON 19
ci_021                -1.057122e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203713e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192242e-03 3 1  ON 30
ci_032                 3.805331e-03 3 1  ON 31
ci_033                 3.404662e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297842e-03 3 1  ON 37
ci_039                 4.293577e-03 3 1  ON 38
ci_040                 4.421586e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004252e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164637e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687496e-03 3 1  ON 53
ci_055                -1.570172e-03 3 1  ON 54
ci_056                -1.305679e-03 3 1  ON 55
ci_057                -1.020397e-03 3 1  ON 56
ci_058                -9.825191e-04 3 1  ON 57
ci_059                -3.385721e-04 3 1  ON 58
ci_060                -2.459362e-04 3 1  ON 59
ci_061                -6.580386e-04 3 1  ON 60
ci_062                -4.331885e-04 3 1  ON 61
ci_063                -6.509788e-04 3 1  ON 62
ci_064                -7.824581e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960788e-05 3 1  ON 68
ci_070                 1.068900e-04 3 1  ON 69
ci_071                -1.494402e-03 3 1  ON 70
ci_072                -1.910954e-03 3 1  ON 71
ci_073                 8.942083e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461748e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.638
    reference variance = 0.233616
====================================================
  Execution time = 2.5378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5256e-01
  Total weights = 1.9550e+06
  Execution time = 3.6068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440264927401
                                         uncertainty =       0.002863644423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440264927401
                                         uncertainty =       0.002863644423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469514518
  error estimate for blocks of size 2^( 2) =       0.000493631829
  error estimate for blocks of size 2^( 3) =       0.000515953294
  error estimate for blocks of size 2^( 4) =       0.000531554485
  error estimate for blocks of size 2^( 5) =       0.000539639770
  error estimate for blocks of size 2^( 6) =       0.000543604679
  error estimate for blocks of size 2^( 7) =       0.000545821930

      target function =      -0.743209052500
              le_mean =     -22.662067383227
             les_mean =     514.021862595501
             stat err =       0.000540155216
             autocorr =       1.323546175632
   target nu stat err =       0.000540155216
   target dn stat err =       0.003524693420
      target stat err =       0.002932529395
              std dev =       0.663993798516
             le_variance =       0.440887764467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440264924931
                                         uncertainty =       0.002863644390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440264924931
                                         uncertainty =       0.002863644390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469514516
  error estimate for blocks of size 2^( 2) =       0.000493631828
  error estimate for blocks of size 2^( 3) =       0.000515953293
  error estimate for blocks of size 2^( 4) =       0.000531554485
  error estimate for blocks of size 2^( 5) =       0.000539639769
  error estimate for blocks of size 2^( 6) =       0.000543604678
  error estimate for blocks of size 2^( 7) =       0.000545821929

      target function =      -0.743209014958
              le_mean =     -22.662067383254
             les_mean =     514.021862642772
             stat err =       0.000540155215
             autocorr =       1.323546179172
   target nu stat err =       0.000540155215
   target dn stat err =       0.003524696247
      target stat err =       0.002932531360
              std dev =       0.663993796674
             le_variance =       0.440887762021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440264926166
                                         uncertainty =       0.002863644407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440264926166
                                         uncertainty =       0.002863644407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469514517
  error estimate for blocks of size 2^( 2) =       0.000493631829
  error estimate for blocks of size 2^( 3) =       0.000515953293
  error estimate for blocks of size 2^( 4) =       0.000531554485
  error estimate for blocks of size 2^( 5) =       0.000539639769
  error estimate for blocks of size 2^( 6) =       0.000543604678
  error estimate for blocks of size 2^( 7) =       0.000545821929

      target function =      -0.743209033736
              le_mean =     -22.662067383241
             les_mean =     514.021862619129
             stat err =       0.000540155216
             autocorr =       1.323546177406
   target nu stat err =       0.000540155216
   target dn stat err =       0.003524694833
      target stat err =       0.002932530377
              std dev =       0.663993797595
             le_variance =       0.440887763244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440264927247
                                         uncertainty =       0.002863644421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440264927247
                                         uncertainty =       0.002863644421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469514518
  error estimate for blocks of size 2^( 2) =       0.000493631829
  error estimate for blocks of size 2^( 3) =       0.000515953294
  error estimate for blocks of size 2^( 4) =       0.000531554485
  error estimate for blocks of size 2^( 5) =       0.000539639770
  error estimate for blocks of size 2^( 6) =       0.000543604679
  error estimate for blocks of size 2^( 7) =       0.000545821930

      target function =      -0.743209050156
              le_mean =     -22.662067383229
             les_mean =     514.021862598454
             stat err =       0.000540155216
             autocorr =       1.323546175863
   target nu stat err =       0.000540155216
   target dn stat err =       0.003524693597
      target stat err =       0.002932529517
              std dev =       0.663993798401
             le_variance =       0.440887764314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743209052500        initial  <--
     1.5625e+04     1.5625e+05             1.0062e-08        -0.743209014958
     6.2500e+04     6.2500e+05             2.5155e-09        -0.743209033736
     2.5000e+05     2.5000e+06             6.2886e-10        -0.743209050156

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5293
  </log>
  <optVariables href="FORM.s020.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759271e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331885e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6284
    reference variance = 0.263718
====================================================
  Execution time = 2.5873e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5187e-01
  Total weights = 1.955184129e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6570e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443624010656
                                         uncertainty =       0.005470692457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443624010656
                                         uncertainty =       0.005470692457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470944448
  error estimate for blocks of size 2^( 2) =       0.000495112194
  error estimate for blocks of size 2^( 3) =       0.000517427590
  error estimate for blocks of size 2^( 4) =       0.000533393551
  error estimate for blocks of size 2^( 5) =       0.000542752059
  error estimate for blocks of size 2^( 6) =       0.000546763609
  error estimate for blocks of size 2^( 7) =       0.000548628757

      target function =      -0.743748616404
              le_mean =     -22.661218347502
             les_mean =     513.982691433386
             stat err =       0.000542884494
             autocorr =       1.328848625724
   target nu stat err =       0.000542884494
   target dn stat err =       0.005403916975
      target stat err =       0.004444362170
              std dev =       0.666016025887
             le_variance =       0.443577346739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266121834750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743773951460       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743773951791       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743773951831       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743773951841       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743773951867       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743773952041       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743773951636       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743773951684       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743773951666       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743773951885       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743773951927       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743773951655       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+05 is 2.686369e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743773951460       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743773951543       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743773951553       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743773951555       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743773951556       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743773951557       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743773951557       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743773951674       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743773951956       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743773951907       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743773952193       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743773952399       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+05 is 6.715924e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743773951460       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743773951481       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743773951483       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743773951484       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743773951456       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743773950594       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743773947725       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743773949859       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743773947404       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743773954691       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743773953800       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743773947195       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+06 is 1.678981e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216459 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0540e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621569e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602870e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293577e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164648e-04 3 1  ON 48
ci_050                 7.516444e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825190e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331883e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960813e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942085e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.7069
    reference variance = 0.330672
====================================================
  Execution time = 2.5877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4466e-01
  Total weights = 1.9553e+06
  Execution time = 3.5913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435613872988
                                         uncertainty =       0.001891767574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435613872988
                                         uncertainty =       0.001891767574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466660072
  error estimate for blocks of size 2^( 2) =       0.000490701835
  error estimate for blocks of size 2^( 3) =       0.000513329726
  error estimate for blocks of size 2^( 4) =       0.000530091449
  error estimate for blocks of size 2^( 5) =       0.000539260635
  error estimate for blocks of size 2^( 6) =       0.000544268255
  error estimate for blocks of size 2^( 7) =       0.000547056647

      target function =      -0.749696007202
              le_mean =     -22.661399834855
             les_mean =     513.983706475320
             stat err =       0.000540169246
             autocorr =       1.339856912464
   target nu stat err =       0.000540169246
   target dn stat err =       0.002491497065
      target stat err =       0.002148316246
              std dev =       0.659957003349
             le_variance =       0.435543246269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435613872519
                                         uncertainty =       0.001891767504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435613872519
                                         uncertainty =       0.001891767504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466660072
  error estimate for blocks of size 2^( 2) =       0.000490701835
  error estimate for blocks of size 2^( 3) =       0.000513329726
  error estimate for blocks of size 2^( 4) =       0.000530091449
  error estimate for blocks of size 2^( 5) =       0.000539260635
  error estimate for blocks of size 2^( 6) =       0.000544268254
  error estimate for blocks of size 2^( 7) =       0.000547056647

      target function =      -0.749696006418
              le_mean =     -22.661399834848
             les_mean =     513.983706475966
             stat err =       0.000540169246
             autocorr =       1.339856913352
   target nu stat err =       0.000540169246
   target dn stat err =       0.002491497026
      target stat err =       0.002148316211
              std dev =       0.659957002994
             le_variance =       0.435543245800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435613872754
                                         uncertainty =       0.001891767539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435613872754
                                         uncertainty =       0.001891767539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466660072
  error estimate for blocks of size 2^( 2) =       0.000490701835
  error estimate for blocks of size 2^( 3) =       0.000513329726
  error estimate for blocks of size 2^( 4) =       0.000530091449
  error estimate for blocks of size 2^( 5) =       0.000539260635
  error estimate for blocks of size 2^( 6) =       0.000544268255
  error estimate for blocks of size 2^( 7) =       0.000547056647

      target function =      -0.749696006810
              le_mean =     -22.661399834852
             les_mean =     513.983706475643
             stat err =       0.000540169246
             autocorr =       1.339856912909
   target nu stat err =       0.000540169246
   target dn stat err =       0.002491497046
      target stat err =       0.002148316229
              std dev =       0.659957003171
             le_variance =       0.435543246035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435613872959
                                         uncertainty =       0.001891767569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435613872959
                                         uncertainty =       0.001891767569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466660072
  error estimate for blocks of size 2^( 2) =       0.000490701835
  error estimate for blocks of size 2^( 3) =       0.000513329726
  error estimate for blocks of size 2^( 4) =       0.000530091449
  error estimate for blocks of size 2^( 5) =       0.000539260635
  error estimate for blocks of size 2^( 6) =       0.000544268255
  error estimate for blocks of size 2^( 7) =       0.000547056647

      target function =      -0.749696007153
              le_mean =     -22.661399834855
             les_mean =     513.983706475361
             stat err =       0.000540169246
             autocorr =       1.339856912517
   target nu stat err =       0.000540169246
   target dn stat err =       0.002491497063
      target stat err =       0.002148316244
              std dev =       0.659957003327
             le_variance =       0.435543246240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749696007202        initial  <--
     1.5625e+05     1.5625e+06             2.6864e-09        -0.749696006418
     6.2500e+05     6.2500e+06             6.7159e-10        -0.749696006810
     2.5000e+06     2.5000e+07             1.6790e-10        -0.749696007153

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.5096
  </log>
  <optVariables href="FORM.s021.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759271e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331885e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.5944
    reference variance = 0.417582
====================================================
  Execution time = 2.5963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5071e-01
  Total weights = 1.955280283e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440945450101
                                         uncertainty =       0.002548978306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440945450101
                                         uncertainty =       0.002548978306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469482837
  error estimate for blocks of size 2^( 2) =       0.000493456754
  error estimate for blocks of size 2^( 3) =       0.000515653040
  error estimate for blocks of size 2^( 4) =       0.000531300239
  error estimate for blocks of size 2^( 5) =       0.000540552645
  error estimate for blocks of size 2^( 6) =       0.000544685647
  error estimate for blocks of size 2^( 7) =       0.000548613090

      target function =      -0.744726038924
              le_mean =     -22.661842776765
             les_mean =     514.009825243451
             stat err =       0.000541287905
             autocorr =       1.329282250248
   target nu stat err =       0.000541287905
   target dn stat err =       0.003018284166
      target stat err =       0.002539249829
              std dev =       0.663948995530
             le_variance =       0.440828268665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266184277677e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744733710141       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744733710153       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744733710155       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744733710291       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744733710515       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744733708266       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744733710228       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744733710719       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744733707501       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744733704794       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744733708987       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+06 is 1.414338e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744733710141       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744733710144       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744733710144       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744733710145       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744733707038       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744733710145       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744733707727       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744733705639       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744733705057       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744733707214       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744733708989       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+06 is 3.535845e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744733710141       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744733710142       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744733710142       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744733710142       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744733719804       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744733707033       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744733689094       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744733724858       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744733650351       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744733650924       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744733740879       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+07 is 8.839603e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220624 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0698e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759271e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331885e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6521
    reference variance = 0.264224
====================================================
  Execution time = 2.5508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5014e-01
  Total weights = 1.9555e+06
  Execution time = 3.5971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441600744363
                                         uncertainty =       0.002598616059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441600744363
                                         uncertainty =       0.002598616059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469871225
  error estimate for blocks of size 2^( 2) =       0.000494411696
  error estimate for blocks of size 2^( 3) =       0.000516922115
  error estimate for blocks of size 2^( 4) =       0.000532883566
  error estimate for blocks of size 2^( 5) =       0.000542134358
  error estimate for blocks of size 2^( 6) =       0.000547587222
  error estimate for blocks of size 2^( 7) =       0.000549947590

      target function =      -0.745186795373
              le_mean =     -22.661710321691
             les_mean =     514.003257492044
             stat err =       0.000543138184
             autocorr =       1.336173862657
   target nu stat err =       0.000543138184
   target dn stat err =       0.002963521310
      target stat err =       0.002498722606
              std dev =       0.664498259273
             le_variance =       0.441557936577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441600744339
                                         uncertainty =       0.002598616060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441600744339
                                         uncertainty =       0.002598616060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469871225
  error estimate for blocks of size 2^( 2) =       0.000494411696
  error estimate for blocks of size 2^( 3) =       0.000516922115
  error estimate for blocks of size 2^( 4) =       0.000532883566
  error estimate for blocks of size 2^( 5) =       0.000542134358
  error estimate for blocks of size 2^( 6) =       0.000547587222
  error estimate for blocks of size 2^( 7) =       0.000549947590

      target function =      -0.745186795234
              le_mean =     -22.661710321691
             les_mean =     514.003257492230
             stat err =       0.000543138184
             autocorr =       1.336173862712
   target nu stat err =       0.000543138184
   target dn stat err =       0.002963521313
      target stat err =       0.002498722607
              std dev =       0.664498259255
             le_variance =       0.441557936553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441600744351
                                         uncertainty =       0.002598616060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441600744351
                                         uncertainty =       0.002598616060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469871225
  error estimate for blocks of size 2^( 2) =       0.000494411696
  error estimate for blocks of size 2^( 3) =       0.000516922115
  error estimate for blocks of size 2^( 4) =       0.000532883566
  error estimate for blocks of size 2^( 5) =       0.000542134358
  error estimate for blocks of size 2^( 6) =       0.000547587222
  error estimate for blocks of size 2^( 7) =       0.000549947590

      target function =      -0.745186795303
              le_mean =     -22.661710321691
             les_mean =     514.003257492137
             stat err =       0.000543138184
             autocorr =       1.336173862680
   target nu stat err =       0.000543138184
   target dn stat err =       0.002963521311
      target stat err =       0.002498722607
              std dev =       0.664498259264
             le_variance =       0.441557936565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441600744361
                                         uncertainty =       0.002598616059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441600744361
                                         uncertainty =       0.002598616059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469871225
  error estimate for blocks of size 2^( 2) =       0.000494411696
  error estimate for blocks of size 2^( 3) =       0.000516922115
  error estimate for blocks of size 2^( 4) =       0.000532883566
  error estimate for blocks of size 2^( 5) =       0.000542134358
  error estimate for blocks of size 2^( 6) =       0.000547587222
  error estimate for blocks of size 2^( 7) =       0.000549947590

      target function =      -0.745186795364
              le_mean =     -22.661710321691
             les_mean =     514.003257492056
             stat err =       0.000543138184
             autocorr =       1.336173862650
   target nu stat err =       0.000543138184
   target dn stat err =       0.002963521310
      target stat err =       0.002498722606
              std dev =       0.664498259272
             le_variance =       0.441557936575


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745186795373        initial  <--
     1.5625e+06     1.5625e+07             1.4143e-10        -0.745186795234
     6.2500e+06     6.2500e+07             3.5358e-11        -0.745186795303
     2.5000e+07     2.5000e+08             8.8396e-12        -0.745186795364

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6068
  </log>
  <optVariables href="FORM.s022.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759271e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331885e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4312e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.5608
    reference variance = 0.392957
====================================================
  Execution time = 2.6056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5036e-01
  Total weights = 1.955372205e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438863019148
                                         uncertainty =       0.002064287989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438863019148
                                         uncertainty =       0.002064287989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468488186
  error estimate for blocks of size 2^( 2) =       0.000492654315
  error estimate for blocks of size 2^( 3) =       0.000515508296
  error estimate for blocks of size 2^( 4) =       0.000532139102
  error estimate for blocks of size 2^( 5) =       0.000541728617
  error estimate for blocks of size 2^( 6) =       0.000546125673
  error estimate for blocks of size 2^( 7) =       0.000548435447

      target function =      -0.745004795220
              le_mean =     -22.661443348024
             les_mean =     513.991375175150
             stat err =       0.000542107210
             autocorr =       1.338976881939
   target nu stat err =       0.000542107210
   target dn stat err =       0.003063401552
      target stat err =       0.002575708767
              std dev =       0.662542346781
             le_variance =       0.438962361278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266144334802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745012657399       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745012657400       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745012657400       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745012657401       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745012657401       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745012657401       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745012657401       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745012657401       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745012657401       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745012657401       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745012657401       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745012718172       residual = 1.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+07 is 1.685949e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745012657399       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745012657399       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745012657399       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745012657399       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745012657399       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745012584004       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745012657399       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745012657399       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745012624187       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745012761177       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745012690998       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745012539754       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+07 is 4.214858e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745012657399       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745012657399       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745012657399       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745012657399       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745012657399       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745012677389       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745012851119       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745012371197       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745012657399       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745012774940       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745012745050       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745011873825       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+08 is 1.053673e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225440 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0787e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759271e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331885e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.711
    reference variance = 0.373488
====================================================
  Execution time = 2.5347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4785e-01
  Total weights = 1.9552e+06
  Execution time = 3.7978e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438887618461
                                         uncertainty =       0.002320310026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438887618461
                                         uncertainty =       0.002320310026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468433779
  error estimate for blocks of size 2^( 2) =       0.000492008841
  error estimate for blocks of size 2^( 3) =       0.000515103420
  error estimate for blocks of size 2^( 4) =       0.000531462985
  error estimate for blocks of size 2^( 5) =       0.000539265999
  error estimate for blocks of size 2^( 6) =       0.000544220612
  error estimate for blocks of size 2^( 7) =       0.000544657592

      target function =      -0.747069778877
              le_mean =     -22.661538326331
             les_mean =     513.993167797442
             stat err =       0.000539901797
             autocorr =       1.328413062961
   target nu stat err =       0.000539901797
   target dn stat err =       0.002466384585
      target stat err =       0.002114389832
              std dev =       0.662465402718
             le_variance =       0.438860409798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438887618458
                                         uncertainty =       0.002320310026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438887618458
                                         uncertainty =       0.002320310026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468433779
  error estimate for blocks of size 2^( 2) =       0.000492008841
  error estimate for blocks of size 2^( 3) =       0.000515103420
  error estimate for blocks of size 2^( 4) =       0.000531462985
  error estimate for blocks of size 2^( 5) =       0.000539265999
  error estimate for blocks of size 2^( 6) =       0.000544220612
  error estimate for blocks of size 2^( 7) =       0.000544657592

      target function =      -0.747069778967
              le_mean =     -22.661538326331
             les_mean =     513.993167797339
             stat err =       0.000539901797
             autocorr =       1.328413062970
   target nu stat err =       0.000539901797
   target dn stat err =       0.002466384585
      target stat err =       0.002114389832
              std dev =       0.662465402717
             le_variance =       0.438860409796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438887618460
                                         uncertainty =       0.002320310026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438887618460
                                         uncertainty =       0.002320310026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468433779
  error estimate for blocks of size 2^( 2) =       0.000492008841
  error estimate for blocks of size 2^( 3) =       0.000515103420
  error estimate for blocks of size 2^( 4) =       0.000531462985
  error estimate for blocks of size 2^( 5) =       0.000539265999
  error estimate for blocks of size 2^( 6) =       0.000544220612
  error estimate for blocks of size 2^( 7) =       0.000544657592

      target function =      -0.747069778922
              le_mean =     -22.661538326331
             les_mean =     513.993167797391
             stat err =       0.000539901797
             autocorr =       1.328413062978
   target nu stat err =       0.000539901797
   target dn stat err =       0.002466384585
      target stat err =       0.002114389832
              std dev =       0.662465402717
             le_variance =       0.438860409797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438887618461
                                         uncertainty =       0.002320310026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438887618461
                                         uncertainty =       0.002320310026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468433779
  error estimate for blocks of size 2^( 2) =       0.000492008841
  error estimate for blocks of size 2^( 3) =       0.000515103420
  error estimate for blocks of size 2^( 4) =       0.000531462985
  error estimate for blocks of size 2^( 5) =       0.000539265999
  error estimate for blocks of size 2^( 6) =       0.000544220612
  error estimate for blocks of size 2^( 7) =       0.000544657592

      target function =      -0.747069778883
              le_mean =     -22.661538326331
             les_mean =     513.993167797436
             stat err =       0.000539901797
             autocorr =       1.328413062964
   target nu stat err =       0.000539901797
   target dn stat err =       0.002466384585
      target stat err =       0.002114389832
              std dev =       0.662465402718
             le_variance =       0.438860409799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747069778877        initial
     1.5625e+07     1.5625e+08             1.6859e-11        -0.747069778967  <--
     6.2500e+07     6.2500e+08             4.2149e-12        -0.747069778922
     2.5000e+08     2.5000e+09             1.0537e-12        -0.747069778883

*****************************************************************************
Applying the update for shift_i =   1.5625e+07     and shift_s =   1.5625e+08
*****************************************************************************

  Execution time = 4.4281e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759271e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5233e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6528
    reference variance = 0.583696
====================================================
  Execution time = 2.5959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4594e-01
  Total weights = 1.954837121e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437192972279
                                         uncertainty =       0.001803372212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437192972279
                                         uncertainty =       0.001803372212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467565619
  error estimate for blocks of size 2^( 2) =       0.000491735584
  error estimate for blocks of size 2^( 3) =       0.000514228698
  error estimate for blocks of size 2^( 4) =       0.000530031290
  error estimate for blocks of size 2^( 5) =       0.000541007983
  error estimate for blocks of size 2^( 6) =       0.000547509223
  error estimate for blocks of size 2^( 7) =       0.000551252642

      target function =      -0.748634378978
              le_mean =     -22.660892802273
             les_mean =     513.961998691013
             stat err =       0.000542450284
             autocorr =       1.345968029353
   target nu stat err =       0.000542450284
   target dn stat err =       0.002556516079
      target stat err =       0.002193152916
              std dev =       0.661237639683
             le_variance =       0.437235216133


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266089280227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748639845317       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748639845321       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748639845322       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748639845322       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748639845322       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748639845322       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748639845322       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748639845322       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748639845322       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+06 is 3.933848e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748639845317       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748639845318       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748639845319       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748639845319       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748639845319       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748639845319       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748639845319       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748639845319       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748639779557       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+07 is 9.834581e-12

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748639845317       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748639845318       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748639845318       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748639845318       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748639845318       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748639845318       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748639870575       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748639864112       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748639856526       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+07 is 2.458692e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228585 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0688e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.6817
    reference variance = 0.339997
====================================================
  Execution time = 2.5274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4381e-01
  Total weights = 1.9550e+06
  Execution time = 3.5994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436195707827
                                         uncertainty =       0.001901465794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436195707827
                                         uncertainty =       0.001901465794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466964347
  error estimate for blocks of size 2^( 2) =       0.000491130283
  error estimate for blocks of size 2^( 3) =       0.000512986026
  error estimate for blocks of size 2^( 4) =       0.000529530176
  error estimate for blocks of size 2^( 5) =       0.000538601648
  error estimate for blocks of size 2^( 6) =       0.000545068077
  error estimate for blocks of size 2^( 7) =       0.000547222547

      target function =      -0.750402079643
              le_mean =     -22.661155860615
             les_mean =     513.971791797071
             stat err =       0.000540105612
             autocorr =       1.337796125189
   target nu stat err =       0.000540105612
   target dn stat err =       0.002397291832
      target stat err =       0.002076446889
              std dev =       0.660387312424
             le_variance =       0.436111402410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436195707818
                                         uncertainty =       0.001901465794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436195707818
                                         uncertainty =       0.001901465794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466964347
  error estimate for blocks of size 2^( 2) =       0.000491130283
  error estimate for blocks of size 2^( 3) =       0.000512986026
  error estimate for blocks of size 2^( 4) =       0.000529530176
  error estimate for blocks of size 2^( 5) =       0.000538601648
  error estimate for blocks of size 2^( 6) =       0.000545068077
  error estimate for blocks of size 2^( 7) =       0.000547222547

      target function =      -0.750402079652
              le_mean =     -22.661155860615
             les_mean =     513.971791797054
             stat err =       0.000540105612
             autocorr =       1.337796125233
   target nu stat err =       0.000540105612
   target dn stat err =       0.002397291836
      target stat err =       0.002076446893
              std dev =       0.660387312417
             le_variance =       0.436111402401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436195707823
                                         uncertainty =       0.001901465794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436195707823
                                         uncertainty =       0.001901465794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466964347
  error estimate for blocks of size 2^( 2) =       0.000491130283
  error estimate for blocks of size 2^( 3) =       0.000512986026
  error estimate for blocks of size 2^( 4) =       0.000529530176
  error estimate for blocks of size 2^( 5) =       0.000538601648
  error estimate for blocks of size 2^( 6) =       0.000545068077
  error estimate for blocks of size 2^( 7) =       0.000547222547

      target function =      -0.750402079648
              le_mean =     -22.661155860615
             les_mean =     513.971791797063
             stat err =       0.000540105612
             autocorr =       1.337796125210
   target nu stat err =       0.000540105612
   target dn stat err =       0.002397291834
      target stat err =       0.002076446891
              std dev =       0.660387312420
             le_variance =       0.436111402405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436195707827
                                         uncertainty =       0.001901465794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436195707827
                                         uncertainty =       0.001901465794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466964347
  error estimate for blocks of size 2^( 2) =       0.000491130283
  error estimate for blocks of size 2^( 3) =       0.000512986026
  error estimate for blocks of size 2^( 4) =       0.000529530176
  error estimate for blocks of size 2^( 5) =       0.000538601648
  error estimate for blocks of size 2^( 6) =       0.000545068077
  error estimate for blocks of size 2^( 7) =       0.000547222547

      target function =      -0.750402079644
              le_mean =     -22.661155860615
             les_mean =     513.971791797070
             stat err =       0.000540105612
             autocorr =       1.337796125196
   target nu stat err =       0.000540105612
   target dn stat err =       0.002397291832
      target stat err =       0.002076446889
              std dev =       0.660387312423
             le_variance =       0.436111402410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750402079643        initial
     3.9062e+06     3.9062e+07             3.9338e-11        -0.750402079652  <--
     1.5625e+07     1.5625e+08             9.8346e-12        -0.750402079648
     6.2500e+07     6.2500e+08             2.4587e-12        -0.750402079644

*****************************************************************************
Applying the update for shift_i =   3.9062e+06     and shift_s =   3.9062e+07
*****************************************************************************

  Execution time = 4.3378e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4122e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.5562
    reference variance = 0.366275
====================================================
  Execution time = 2.5688e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5164e-01
  Total weights = 1.955327794e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440037189099
                                         uncertainty =       0.002624637733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440037189099
                                         uncertainty =       0.002624637733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469112292
  error estimate for blocks of size 2^( 2) =       0.000493084090
  error estimate for blocks of size 2^( 3) =       0.000515407022
  error estimate for blocks of size 2^( 4) =       0.000531543757
  error estimate for blocks of size 2^( 5) =       0.000541380925
  error estimate for blocks of size 2^( 6) =       0.000545758634
  error estimate for blocks of size 2^( 7) =       0.000550308556

      target function =      -0.743955298675
              le_mean =     -22.661308014828
             les_mean =     513.986521998000
             stat err =       0.000542247968
             autocorr =       1.336110085174
   target nu stat err =       0.000542247968
   target dn stat err =       0.003396052866
      target stat err =       0.002832811760
              std dev =       0.663424964942
             le_variance =       0.440132684108


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266130801483e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743965187446       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743965187476       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743965187482       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743965187522       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743965187482       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743965187482       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743965187483       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743965187483       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743965187483       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743965187483       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743965187483       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743965187483       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+05 is 3.787038e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743965187446       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743965187454       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743965187455       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743965187455       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743965187405       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743965189522       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743965188450       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743965188808       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743965190691       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743965181500       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743965183177       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743965186703       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+06 is 9.467593e-11

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743965187446       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743965187448       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743965187448       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743965182435       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743965187448       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743965187448       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743965187448       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743965187448       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743965187448       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743965215434       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743965187448       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743965187448       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+07 is 2.366899e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0416e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960797e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942080e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.6393
    reference variance = 0.341865
====================================================
  Execution time = 2.5289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5140e-01
  Total weights = 1.9553e+06
  Execution time = 3.5998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437523313597
                                         uncertainty =       0.001859003581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437523313597
                                         uncertainty =       0.001859003581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467799762
  error estimate for blocks of size 2^( 2) =       0.000491930697
  error estimate for blocks of size 2^( 3) =       0.000513871043
  error estimate for blocks of size 2^( 4) =       0.000530983560
  error estimate for blocks of size 2^( 5) =       0.000540370140
  error estimate for blocks of size 2^( 6) =       0.000544948527
  error estimate for blocks of size 2^( 7) =       0.000548744281

      target function =      -0.744153570011
              le_mean =     -22.661653504948
             les_mean =     514.001942632843
             stat err =       0.000541261627
             autocorr =       1.338734586074
   target nu stat err =       0.000541261627
   target dn stat err =       0.003325851890
      target stat err =       0.002779486935
              std dev =       0.661568768268
             le_variance =       0.437673235148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437523313548
                                         uncertainty =       0.001859003583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437523313548
                                         uncertainty =       0.001859003583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467799762
  error estimate for blocks of size 2^( 2) =       0.000491930697
  error estimate for blocks of size 2^( 3) =       0.000513871043
  error estimate for blocks of size 2^( 4) =       0.000530983560
  error estimate for blocks of size 2^( 5) =       0.000540370140
  error estimate for blocks of size 2^( 6) =       0.000544948527
  error estimate for blocks of size 2^( 7) =       0.000548744281

      target function =      -0.744153569595
              le_mean =     -22.661653504950
             les_mean =     514.001942633446
             stat err =       0.000541261627
             autocorr =       1.338734586142
   target nu stat err =       0.000541261627
   target dn stat err =       0.003325851921
      target stat err =       0.002779486956
              std dev =       0.661568768232
             le_variance =       0.437673235100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437523313573
                                         uncertainty =       0.001859003582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437523313573
                                         uncertainty =       0.001859003582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467799762
  error estimate for blocks of size 2^( 2) =       0.000491930697
  error estimate for blocks of size 2^( 3) =       0.000513871043
  error estimate for blocks of size 2^( 4) =       0.000530983560
  error estimate for blocks of size 2^( 5) =       0.000540370140
  error estimate for blocks of size 2^( 6) =       0.000544948527
  error estimate for blocks of size 2^( 7) =       0.000548744281

      target function =      -0.744153569803
              le_mean =     -22.661653504949
             les_mean =     514.001942633144
             stat err =       0.000541261627
             autocorr =       1.338734586107
   target nu stat err =       0.000541261627
   target dn stat err =       0.003325851905
      target stat err =       0.002779486945
              std dev =       0.661568768250
             le_variance =       0.437673235123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437523313594
                                         uncertainty =       0.001859003582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437523313594
                                         uncertainty =       0.001859003582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467799762
  error estimate for blocks of size 2^( 2) =       0.000491930697
  error estimate for blocks of size 2^( 3) =       0.000513871043
  error estimate for blocks of size 2^( 4) =       0.000530983560
  error estimate for blocks of size 2^( 5) =       0.000540370140
  error estimate for blocks of size 2^( 6) =       0.000544948527
  error estimate for blocks of size 2^( 7) =       0.000548744281

      target function =      -0.744153569985
              le_mean =     -22.661653504948
             les_mean =     514.001942632880
             stat err =       0.000541261627
             autocorr =       1.338734586081
   target nu stat err =       0.000541261627
   target dn stat err =       0.003325851892
      target stat err =       0.002779486936
              std dev =       0.661568768266
             le_variance =       0.437673235145


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744153570011        initial  <--
     9.7656e+05     9.7656e+06             3.7870e-10        -0.744153569595
     3.9062e+06     3.9062e+07             9.4676e-11        -0.744153569803
     1.5625e+07     1.5625e+08             2.3669e-11        -0.744153569985

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7454
  </log>
  <optVariables href="FORM.s025.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5169e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6877
    reference variance = 0.339226
====================================================
  Execution time = 2.5986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5306e-01
  Total weights = 1.955082550e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442402743560
                                         uncertainty =       0.002429834659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442402743560
                                         uncertainty =       0.002429834659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470278759
  error estimate for blocks of size 2^( 2) =       0.000493888144
  error estimate for blocks of size 2^( 3) =       0.000515835402
  error estimate for blocks of size 2^( 4) =       0.000531969845
  error estimate for blocks of size 2^( 5) =       0.000541474778
  error estimate for blocks of size 2^( 6) =       0.000545328712
  error estimate for blocks of size 2^( 7) =       0.000549254643

      target function =      -0.742811542767
              le_mean =     -22.662473656467
             les_mean =     514.040768807952
             stat err =       0.000542006994
             autocorr =       1.328308814141
   target nu stat err =       0.000542006994
   target dn stat err =       0.003460183467
      target stat err =       0.002880193254
              std dev =       0.665074599454
             le_variance =       0.442324222839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266247365647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742821860257       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742821860259       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742821860260       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742821860260       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742821860260       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742821859511       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742821860260       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742821853897       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742821850986       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742821860260       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742821854010       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742821860260       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+06 is 2.661886e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742821860257       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742821860257       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742821860258       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742821860408       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742821864468       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742821838916       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742821889899       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742821935373       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742821936737       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742821899434       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742821807249       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742821801729       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+07 is 6.654705e-12

solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742821860257       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742821860257       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742821860257       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742821860257       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742821861512       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742821978710       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742822096509       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742821860257       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742821860257       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742821615204       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742821860257       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742821860257       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+08 is 1.663681e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0670e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6002
    reference variance = 0.424734
====================================================
  Execution time = 2.5155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5049e-01
  Total weights = 1.9552e+06
  Execution time = 3.5895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487580721
                                         uncertainty =       0.001940787567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487580721
                                         uncertainty =       0.001940787567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469370507
  error estimate for blocks of size 2^( 2) =       0.000493218983
  error estimate for blocks of size 2^( 3) =       0.000515702102
  error estimate for blocks of size 2^( 4) =       0.000532295027
  error estimate for blocks of size 2^( 5) =       0.000541764276
  error estimate for blocks of size 2^( 6) =       0.000547599429
  error estimate for blocks of size 2^( 7) =       0.000551078239

      target function =      -0.744903699274
              le_mean =     -22.661751325522
             les_mean =     514.005463746097
             stat err =       0.000543184243
             autocorr =       1.339253322200
   target nu stat err =       0.000543184243
   target dn stat err =       0.002710683013
      target stat err =       0.002296692546
              std dev =       0.663790136257
             le_variance =       0.440617344992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487580719
                                         uncertainty =       0.001940787567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487580719
                                         uncertainty =       0.001940787567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469370507
  error estimate for blocks of size 2^( 2) =       0.000493218983
  error estimate for blocks of size 2^( 3) =       0.000515702102
  error estimate for blocks of size 2^( 4) =       0.000532295027
  error estimate for blocks of size 2^( 5) =       0.000541764276
  error estimate for blocks of size 2^( 6) =       0.000547599429
  error estimate for blocks of size 2^( 7) =       0.000551078239

      target function =      -0.744903699283
              le_mean =     -22.661751325522
             les_mean =     514.005463746080
             stat err =       0.000543184243
             autocorr =       1.339253322205
   target nu stat err =       0.000543184243
   target dn stat err =       0.002710683011
      target stat err =       0.002296692545
              std dev =       0.663790136256
             le_variance =       0.440617344990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487580720
                                         uncertainty =       0.001940787567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487580720
                                         uncertainty =       0.001940787567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469370507
  error estimate for blocks of size 2^( 2) =       0.000493218983
  error estimate for blocks of size 2^( 3) =       0.000515702102
  error estimate for blocks of size 2^( 4) =       0.000532295027
  error estimate for blocks of size 2^( 5) =       0.000541764276
  error estimate for blocks of size 2^( 6) =       0.000547599429
  error estimate for blocks of size 2^( 7) =       0.000551078239

      target function =      -0.744903699279
              le_mean =     -22.661751325522
             les_mean =     514.005463746089
             stat err =       0.000543184243
             autocorr =       1.339253322205
   target nu stat err =       0.000543184243
   target dn stat err =       0.002710683012
      target stat err =       0.002296692545
              std dev =       0.663790136256
             le_variance =       0.440617344991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487580721
                                         uncertainty =       0.001940787567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487580721
                                         uncertainty =       0.001940787567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469370507
  error estimate for blocks of size 2^( 2) =       0.000493218983
  error estimate for blocks of size 2^( 3) =       0.000515702102
  error estimate for blocks of size 2^( 4) =       0.000532295027
  error estimate for blocks of size 2^( 5) =       0.000541764276
  error estimate for blocks of size 2^( 6) =       0.000547599429
  error estimate for blocks of size 2^( 7) =       0.000551078239

      target function =      -0.744903699275
              le_mean =     -22.661751325522
             les_mean =     514.005463746096
             stat err =       0.000543184243
             autocorr =       1.339253322194
   target nu stat err =       0.000543184243
   target dn stat err =       0.002710683013
      target stat err =       0.002296692546
              std dev =       0.663790136257
             le_variance =       0.440617344992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744903699274        initial
     9.7656e+06     9.7656e+07             2.6619e-11        -0.744903699283  <--
     3.9062e+07     3.9062e+08             6.6547e-12        -0.744903699279
     1.5625e+08     1.5625e+09             1.6637e-12        -0.744903699275

*****************************************************************************
Applying the update for shift_i =   9.7656e+06     and shift_s =   9.7656e+07
*****************************************************************************

  Execution time = 4.3247e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960796e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942081e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7676
    reference variance = 0.296378
====================================================
  Execution time = 2.5748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.5901e-01
  Total weights = 1.954981740e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445027514240
                                         uncertainty =       0.002736589616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445027514240
                                         uncertainty =       0.002736589616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471690715
  error estimate for blocks of size 2^( 2) =       0.000495799074
  error estimate for blocks of size 2^( 3) =       0.000518142240
  error estimate for blocks of size 2^( 4) =       0.000533762142
  error estimate for blocks of size 2^( 5) =       0.000543215372
  error estimate for blocks of size 2^( 6) =       0.000548162375
  error estimate for blocks of size 2^( 7) =       0.000549063156

      target function =      -0.737981359363
              le_mean =     -22.660260712224
             les_mean =     513.946420891571
             stat err =       0.000543550761
             autocorr =       1.327900584137
   target nu stat err =       0.000543550761
   target dn stat err =       0.005159291466
      target stat err =       0.004176096356
              std dev =       0.667071406076
             le_variance =       0.444984260805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266026071222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738004287429       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738004287448       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738004287452       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738004287463       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738004284687       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738004286633       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738004285564       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738004290079       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738004287199       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738004285569       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738004286232       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738004285980       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+06 is 3.156167e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738004287429       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738004287434       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738004287435       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738004287435       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738004287621       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738004285777       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738004315433       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738004270323       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738004298670       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738004305127       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738004311283       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738004250767       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+06 is 7.890427e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738004287429       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738004287430       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738004287430       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738004287430       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738004287431       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738004286850       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738004309999       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738004263008       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738004290500       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738004289245       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738004279527       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738004384196       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+07 is 1.972597e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242982 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0449e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602870e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554944e-03 3 1  ON 67
ci_069                -1.960797e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942081e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6676
    reference variance = 0.230812
====================================================
  Execution time = 2.5175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4911e-01
  Total weights = 1.9555e+06
  Execution time = 3.5867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439393926501
                                         uncertainty =       0.002590961172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439393926501
                                         uncertainty =       0.002590961172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468747476
  error estimate for blocks of size 2^( 2) =       0.000493008075
  error estimate for blocks of size 2^( 3) =       0.000515548235
  error estimate for blocks of size 2^( 4) =       0.000531182348
  error estimate for blocks of size 2^( 5) =       0.000541315925
  error estimate for blocks of size 2^( 6) =       0.000543714267
  error estimate for blocks of size 2^( 7) =       0.000545837207

      target function =      -0.746033309012
              le_mean =     -22.661655639797
             les_mean =     513.999745222826
             stat err =       0.000540512437
             autocorr =       1.329638241219
   target nu stat err =       0.000540512437
   target dn stat err =       0.002964863909
      target stat err =       0.002504422450
              std dev =       0.662909038448
             le_variance =       0.439448393256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439393926246
                                         uncertainty =       0.002590961042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439393926246
                                         uncertainty =       0.002590961042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468747476
  error estimate for blocks of size 2^( 2) =       0.000493008075
  error estimate for blocks of size 2^( 3) =       0.000515548235
  error estimate for blocks of size 2^( 4) =       0.000531182348
  error estimate for blocks of size 2^( 5) =       0.000541315925
  error estimate for blocks of size 2^( 6) =       0.000543714267
  error estimate for blocks of size 2^( 7) =       0.000545837207

      target function =      -0.746033309435
              le_mean =     -22.661655639794
             les_mean =     513.999745222186
             stat err =       0.000540512437
             autocorr =       1.329638241442
   target nu stat err =       0.000540512437
   target dn stat err =       0.002964863809
      target stat err =       0.002504422373
              std dev =       0.662909038256
             le_variance =       0.439448393002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439393926374
                                         uncertainty =       0.002590961107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439393926374
                                         uncertainty =       0.002590961107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468747476
  error estimate for blocks of size 2^( 2) =       0.000493008075
  error estimate for blocks of size 2^( 3) =       0.000515548235
  error estimate for blocks of size 2^( 4) =       0.000531182348
  error estimate for blocks of size 2^( 5) =       0.000541315925
  error estimate for blocks of size 2^( 6) =       0.000543714267
  error estimate for blocks of size 2^( 7) =       0.000545837207

      target function =      -0.746033309223
              le_mean =     -22.661655639796
             les_mean =     513.999745222506
             stat err =       0.000540512437
             autocorr =       1.329638241333
   target nu stat err =       0.000540512437
   target dn stat err =       0.002964863859
      target stat err =       0.002504422412
              std dev =       0.662909038352
             le_variance =       0.439448393129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439393926485
                                         uncertainty =       0.002590961164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439393926485
                                         uncertainty =       0.002590961164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468747476
  error estimate for blocks of size 2^( 2) =       0.000493008075
  error estimate for blocks of size 2^( 3) =       0.000515548235
  error estimate for blocks of size 2^( 4) =       0.000531182348
  error estimate for blocks of size 2^( 5) =       0.000541315925
  error estimate for blocks of size 2^( 6) =       0.000543714267
  error estimate for blocks of size 2^( 7) =       0.000545837207

      target function =      -0.746033309038
              le_mean =     -22.661655639797
             les_mean =     513.999745222786
             stat err =       0.000540512437
             autocorr =       1.329638241236
   target nu stat err =       0.000540512437
   target dn stat err =       0.002964863903
      target stat err =       0.002504422445
              std dev =       0.662909038436
             le_variance =       0.439448393240


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746033309012        initial
     2.4414e+06     2.4414e+07             3.1562e-10        -0.746033309435  <--
     9.7656e+06     9.7656e+07             7.8904e-11        -0.746033309223
     3.9062e+07     3.9062e+08             1.9726e-11        -0.746033309038

*****************************************************************************
Applying the update for shift_i =   2.4414e+06     and shift_s =   2.4414e+07
*****************************************************************************

  Execution time = 4.5570e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602870e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960800e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942080e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6031e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7416
    reference variance = 0.310591
====================================================
  Execution time = 2.5846e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4483e-01
  Total weights = 1.955418581e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436896876167
                                         uncertainty =       0.002072058912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436896876167
                                         uncertainty =       0.002072058912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467421963
  error estimate for blocks of size 2^( 2) =       0.000491173251
  error estimate for blocks of size 2^( 3) =       0.000513086751
  error estimate for blocks of size 2^( 4) =       0.000529746903
  error estimate for blocks of size 2^( 5) =       0.000539076796
  error estimate for blocks of size 2^( 6) =       0.000543606781
  error estimate for blocks of size 2^( 7) =       0.000544119674

      target function =      -0.749543028484
              le_mean =     -22.660734482243
             les_mean =     513.953721176922
             stat err =       0.000539137538
             autocorr =       1.330395943860
   target nu stat err =       0.000539137538
   target dn stat err =       0.002315790745
      target stat err =       0.002005820686
              std dev =       0.661034480048
             le_variance =       0.436966583812


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266073448224e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749547503390       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749547503416       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749547503419       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749547503419       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749547503419       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749547503419       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749547503419       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749547503453       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749547503419       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749547503353       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749547503914       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+05 is 3.756878e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749547503390       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749547503396       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749547503397       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749547503397       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749547503397       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749547503397       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749547503397       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749547503397       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749547497404       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749547503397       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749547503139       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+06 is 9.392196e-11

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749547503390       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749547503391       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749547503392       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749547503392       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749547503392       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749547503392       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749547503392       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749547483536       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749547519914       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749547503305       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749547510206       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+06 is 2.348046e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247148 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0535e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602870e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393408e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164643e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385717e-04 3 1  ON 58
ci_060                -2.459365e-04 3 1  ON 59
ci_061                -6.580398e-04 3 1  ON 60
ci_062                -4.331884e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960800e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942081e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7213
    reference variance = 0.381891
====================================================
  Execution time = 2.5569e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5743e-01
  Total weights = 1.9553e+06
  Execution time = 3.5896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443604707720
                                         uncertainty =       0.002896758094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443604707720
                                         uncertainty =       0.002896758094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470939121
  error estimate for blocks of size 2^( 2) =       0.000495204671
  error estimate for blocks of size 2^( 3) =       0.000516932077
  error estimate for blocks of size 2^( 4) =       0.000532321783
  error estimate for blocks of size 2^( 5) =       0.000541236265
  error estimate for blocks of size 2^( 6) =       0.000547035947
  error estimate for blocks of size 2^( 7) =       0.000548716812

      target function =      -0.739257922572
              le_mean =     -22.662303783184
             les_mean =     514.037445299435
             stat err =       0.000542327702
             autocorr =       1.326154244962
   target nu stat err =       0.000542327702
   target dn stat err =       0.004362697032
      target stat err =       0.003567912464
              std dev =       0.666008491621
             le_variance =       0.443567310911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443604707628
                                         uncertainty =       0.002896758081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443604707628
                                         uncertainty =       0.002896758081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470939121
  error estimate for blocks of size 2^( 2) =       0.000495204671
  error estimate for blocks of size 2^( 3) =       0.000516932077
  error estimate for blocks of size 2^( 4) =       0.000532321783
  error estimate for blocks of size 2^( 5) =       0.000541236265
  error estimate for blocks of size 2^( 6) =       0.000547035947
  error estimate for blocks of size 2^( 7) =       0.000548716812

      target function =      -0.739257922638
              le_mean =     -22.662303783183
             les_mean =     514.037445299333
             stat err =       0.000542327702
             autocorr =       1.326154245156
   target nu stat err =       0.000542327702
   target dn stat err =       0.004362696946
      target stat err =       0.003567912396
              std dev =       0.666008491552
             le_variance =       0.443567310820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443604707674
                                         uncertainty =       0.002896758087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443604707674
                                         uncertainty =       0.002896758087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470939121
  error estimate for blocks of size 2^( 2) =       0.000495204671
  error estimate for blocks of size 2^( 3) =       0.000516932077
  error estimate for blocks of size 2^( 4) =       0.000532321783
  error estimate for blocks of size 2^( 5) =       0.000541236265
  error estimate for blocks of size 2^( 6) =       0.000547035947
  error estimate for blocks of size 2^( 7) =       0.000548716812

      target function =      -0.739257922605
              le_mean =     -22.662303783183
             les_mean =     514.037445299384
             stat err =       0.000542327702
             autocorr =       1.326154245059
   target nu stat err =       0.000542327702
   target dn stat err =       0.004362696989
      target stat err =       0.003567912430
              std dev =       0.666008491587
             le_variance =       0.443567310865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443604707714
                                         uncertainty =       0.002896758093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443604707714
                                         uncertainty =       0.002896758093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470939121
  error estimate for blocks of size 2^( 2) =       0.000495204671
  error estimate for blocks of size 2^( 3) =       0.000516932077
  error estimate for blocks of size 2^( 4) =       0.000532321783
  error estimate for blocks of size 2^( 5) =       0.000541236265
  error estimate for blocks of size 2^( 6) =       0.000547035947
  error estimate for blocks of size 2^( 7) =       0.000548716812

      target function =      -0.739257922577
              le_mean =     -22.662303783183
             les_mean =     514.037445299429
             stat err =       0.000542327702
             autocorr =       1.326154244972
   target nu stat err =       0.000542327702
   target dn stat err =       0.004362697027
      target stat err =       0.003567912460
              std dev =       0.666008491617
             le_variance =       0.443567310906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739257922572        initial
     6.1035e+05     6.1035e+06             3.7569e-10        -0.739257922638  <--
     2.4414e+06     2.4414e+07             9.3922e-11        -0.739257922605
     9.7656e+06     9.7656e+07             2.3480e-11        -0.739257922577

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 4.3735e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516444e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960800e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4277e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.5622
    reference variance = 0.459039
====================================================
  Execution time = 2.6040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.5059e-01
  Total weights = 1.955280708e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441882367622
                                         uncertainty =       0.002265883407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441882367622
                                         uncertainty =       0.002265883407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470024568
  error estimate for blocks of size 2^( 2) =       0.000494155783
  error estimate for blocks of size 2^( 3) =       0.000515956034
  error estimate for blocks of size 2^( 4) =       0.000531114719
  error estimate for blocks of size 2^( 5) =       0.000539473667
  error estimate for blocks of size 2^( 6) =       0.000544793703
  error estimate for blocks of size 2^( 7) =       0.000546497892

      target function =      -0.744801245609
              le_mean =     -22.660307939526
             les_mean =     513.940148902721
             stat err =       0.000540469995
             autocorr =       1.322214935866
   target nu stat err =       0.000540469995
   target dn stat err =       0.002892318749
      target stat err =       0.002433951940
              std dev =       0.664715119312
             le_variance =       0.441846189842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266030793953e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744808176982       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744808177056       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744808177070       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744808177072       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744808177114       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744808177236       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744808177517       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744808177032       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744808177297       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744808177144       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744808176962       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 1.084617e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744808176982       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744808177001       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744808177004       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744808177005       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744808177033       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744808177633       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744808176890       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744808176752       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744808177051       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744808177316       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744808174641       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+05 is 2.711541e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744808176982       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744808176987       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744808176988       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744808176988       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744808176988       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744808179580       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744808176722       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744808176864       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744808180317       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744808175622       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744808178611       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+06 is 6.778846e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0776e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602870e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193345e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516444e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331881e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960806e-05 3 1  ON 68
ci_070                 1.068906e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942075e-05 3 1  ON 72
ci_074                 1.594139e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.5638
    reference variance = 0.602566
====================================================
  Execution time = 2.5395e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4784e-01
  Total weights = 1.9548e+06
  Execution time = 3.6016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439322726622
                                         uncertainty =       0.003673859842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439322726622
                                         uncertainty =       0.003673859842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468645482
  error estimate for blocks of size 2^( 2) =       0.000492188005
  error estimate for blocks of size 2^( 3) =       0.000514135342
  error estimate for blocks of size 2^( 4) =       0.000529865475
  error estimate for blocks of size 2^( 5) =       0.000539756060
  error estimate for blocks of size 2^( 6) =       0.000542351918
  error estimate for blocks of size 2^( 7) =       0.000543013068

      target function =      -0.747067066209
              le_mean =     -22.661284875001
             les_mean =     513.981669538004
             stat err =       0.000538746630
             autocorr =       1.321539850736
   target nu stat err =       0.000538746630
   target dn stat err =       0.003840239097
      target stat err =       0.003213369440
              std dev =       0.662764797141
             le_variance =       0.439257176329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439322726338
                                         uncertainty =       0.003673859793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439322726338
                                         uncertainty =       0.003673859793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468645482
  error estimate for blocks of size 2^( 2) =       0.000492188005
  error estimate for blocks of size 2^( 3) =       0.000514135342
  error estimate for blocks of size 2^( 4) =       0.000529865475
  error estimate for blocks of size 2^( 5) =       0.000539756060
  error estimate for blocks of size 2^( 6) =       0.000542351918
  error estimate for blocks of size 2^( 7) =       0.000543013068

      target function =      -0.747067066084
              le_mean =     -22.661284875003
             les_mean =     513.981669538217
             stat err =       0.000538746630
             autocorr =       1.321539851069
   target nu stat err =       0.000538746630
   target dn stat err =       0.003840239045
      target stat err =       0.003213369397
              std dev =       0.662764796927
             le_variance =       0.439257176045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439322726480
                                         uncertainty =       0.003673859817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439322726480
                                         uncertainty =       0.003673859817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468645482
  error estimate for blocks of size 2^( 2) =       0.000492188005
  error estimate for blocks of size 2^( 3) =       0.000514135342
  error estimate for blocks of size 2^( 4) =       0.000529865475
  error estimate for blocks of size 2^( 5) =       0.000539756060
  error estimate for blocks of size 2^( 6) =       0.000542351918
  error estimate for blocks of size 2^( 7) =       0.000543013068

      target function =      -0.747067066146
              le_mean =     -22.661284875002
             les_mean =     513.981669538111
             stat err =       0.000538746630
             autocorr =       1.321539850894
   target nu stat err =       0.000538746630
   target dn stat err =       0.003840239071
      target stat err =       0.003213369418
              std dev =       0.662764797034
             le_variance =       0.439257176187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439322726604
                                         uncertainty =       0.003673859839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439322726604
                                         uncertainty =       0.003673859839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468645482
  error estimate for blocks of size 2^( 2) =       0.000492188005
  error estimate for blocks of size 2^( 3) =       0.000514135342
  error estimate for blocks of size 2^( 4) =       0.000529865475
  error estimate for blocks of size 2^( 5) =       0.000539756060
  error estimate for blocks of size 2^( 6) =       0.000542351918
  error estimate for blocks of size 2^( 7) =       0.000543013068

      target function =      -0.747067066201
              le_mean =     -22.661284875001
             les_mean =     513.981669538017
             stat err =       0.000538746630
             autocorr =       1.321539850745
   target nu stat err =       0.000538746630
   target dn stat err =       0.003840239093
      target stat err =       0.003213369437
              std dev =       0.662764797127
             le_variance =       0.439257176311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747067066209        initial  <--
     1.5259e+05     1.5259e+06             1.0846e-09        -0.747067066084
     6.1035e+05     6.1035e+06             2.7115e-10        -0.747067066146
     2.4414e+06     2.4414e+07             6.7788e-11        -0.747067066201

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.4598
  </log>
  <optVariables href="FORM.s029.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516444e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960800e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6262e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6038
    reference variance = 0.411378
====================================================
  Execution time = 2.5765e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5043e-01
  Total weights = 1.955281194e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440970919435
                                         uncertainty =       0.002880547644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440970919435
                                         uncertainty =       0.002880547644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469494489
  error estimate for blocks of size 2^( 2) =       0.000493667553
  error estimate for blocks of size 2^( 3) =       0.000515664257
  error estimate for blocks of size 2^( 4) =       0.000531844005
  error estimate for blocks of size 2^( 5) =       0.000540697681
  error estimate for blocks of size 2^( 6) =       0.000544771951
  error estimate for blocks of size 2^( 7) =       0.000544176985

      target function =      -0.744956803976
              le_mean =     -22.662699631478
             les_mean =     514.048389490479
             stat err =       0.000540372656
             autocorr =       1.324724995953
   target nu stat err =       0.000540372656
   target dn stat err =       0.003200879704
      target stat err =       0.002689476791
              std dev =       0.663965473843
             le_variance =       0.440850150455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266269963148e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744965609712       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744965609728       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744965609731       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744965609731       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744965609731       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744965609731       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744965609731       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744965609731       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744965609731       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744965609731       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744965609170       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744965607041       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+06 is 1.416640e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744965609712       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744965609716       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744965609717       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744965609717       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744965609717       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744965609717       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744965609717       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744965607769       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744965609717       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744965608835       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744965606233       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744965600457       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+06 is 3.541613e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744965609712       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744965609713       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744965609713       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744965609713       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744965609713       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744965609713       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744965650461       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744965559223       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744965609713       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744965609713       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744965609713       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744965628409       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+07 is 8.854062e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256102 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0474e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960800e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6566
    reference variance = 0.250205
====================================================
  Execution time = 2.5289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5014e-01
  Total weights = 1.9550e+06
  Execution time = 3.6150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440041385540
                                         uncertainty =       0.002494846216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440041385540
                                         uncertainty =       0.002494846216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469055373
  error estimate for blocks of size 2^( 2) =       0.000492912286
  error estimate for blocks of size 2^( 3) =       0.000515144954
  error estimate for blocks of size 2^( 4) =       0.000531222155
  error estimate for blocks of size 2^( 5) =       0.000539614935
  error estimate for blocks of size 2^( 6) =       0.000541155727
  error estimate for blocks of size 2^( 7) =       0.000541680517

      target function =      -0.745180337105
              le_mean =     -22.661470524465
             les_mean =     513.992391116906
             stat err =       0.000538418333
             autocorr =       1.317623853440
   target nu stat err =       0.000538418333
   target dn stat err =       0.003293270677
      target stat err =       0.002759517155
              std dev =       0.663344469946
             le_variance =       0.440025885808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440041385494
                                         uncertainty =       0.002494846213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440041385494
                                         uncertainty =       0.002494846213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469055373
  error estimate for blocks of size 2^( 2) =       0.000492912286
  error estimate for blocks of size 2^( 3) =       0.000515144954
  error estimate for blocks of size 2^( 4) =       0.000531222155
  error estimate for blocks of size 2^( 5) =       0.000539614935
  error estimate for blocks of size 2^( 6) =       0.000541155727
  error estimate for blocks of size 2^( 7) =       0.000541680517

      target function =      -0.745180337062
              le_mean =     -22.661470524467
             les_mean =     513.992391117027
             stat err =       0.000538418333
             autocorr =       1.317623853517
   target nu stat err =       0.000538418333
   target dn stat err =       0.003293270675
      target stat err =       0.002759517153
              std dev =       0.663344469912
             le_variance =       0.440025885763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440041385517
                                         uncertainty =       0.002494846214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440041385517
                                         uncertainty =       0.002494846214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469055373
  error estimate for blocks of size 2^( 2) =       0.000492912286
  error estimate for blocks of size 2^( 3) =       0.000515144954
  error estimate for blocks of size 2^( 4) =       0.000531222155
  error estimate for blocks of size 2^( 5) =       0.000539614935
  error estimate for blocks of size 2^( 6) =       0.000541155727
  error estimate for blocks of size 2^( 7) =       0.000541680517

      target function =      -0.745180337084
              le_mean =     -22.661470524466
             les_mean =     513.992391116967
             stat err =       0.000538418333
             autocorr =       1.317623853474
   target nu stat err =       0.000538418333
   target dn stat err =       0.003293270676
      target stat err =       0.002759517154
              std dev =       0.663344469929
             le_variance =       0.440025885786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440041385537
                                         uncertainty =       0.002494846216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440041385537
                                         uncertainty =       0.002494846216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469055373
  error estimate for blocks of size 2^( 2) =       0.000492912286
  error estimate for blocks of size 2^( 3) =       0.000515144954
  error estimate for blocks of size 2^( 4) =       0.000531222155
  error estimate for blocks of size 2^( 5) =       0.000539614935
  error estimate for blocks of size 2^( 6) =       0.000541155727
  error estimate for blocks of size 2^( 7) =       0.000541680517

      target function =      -0.745180337103
              le_mean =     -22.661470524465
             les_mean =     513.992391116914
             stat err =       0.000538418333
             autocorr =       1.317623853448
   target nu stat err =       0.000538418333
   target dn stat err =       0.003293270676
      target stat err =       0.002759517155
              std dev =       0.663344469944
             le_variance =       0.440025885806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745180337105        initial  <--
     1.5259e+06     1.5259e+07             1.4166e-10        -0.745180337062
     6.1035e+06     6.1035e+07             3.5416e-11        -0.745180337084
     2.4414e+07     2.4414e+08             8.8541e-12        -0.745180337103

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4278
  </log>
  <optVariables href="FORM.s030.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516444e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960800e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3922e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.681
    reference variance = 0.313609
====================================================
  Execution time = 2.5902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4840e-01
  Total weights = 1.954955973e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438477307911
                                         uncertainty =       0.002165073400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438477307911
                                         uncertainty =       0.002165073400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468156989
  error estimate for blocks of size 2^( 2) =       0.000492354695
  error estimate for blocks of size 2^( 3) =       0.000515506263
  error estimate for blocks of size 2^( 4) =       0.000531172921
  error estimate for blocks of size 2^( 5) =       0.000540575444
  error estimate for blocks of size 2^( 6) =       0.000545680257
  error estimate for blocks of size 2^( 7) =       0.000551822137

      target function =      -0.746631220340
              le_mean =     -22.662537777937
             les_mean =     514.039015561968
             stat err =       0.000542312690
             autocorr =       1.341888745815
   target nu stat err =       0.000542312690
   target dn stat err =       0.002689479259
      target stat err =       0.002292576450
              std dev =       0.662073963734
             le_variance =       0.438341933454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266253777794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746637286982       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746637286983       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746637286983       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746637286983       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746637286983       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746637286983       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746637310310       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746637249411       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746637277261       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746637259424       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746637292551       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+07 is 8.984100e-12

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746637286982       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746637286983       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746637286983       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746637286983       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746637287024       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746637286886       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746637227052       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746637273768       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746637357762       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746637131891       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746637427164       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+07 is 2.246084e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746637286982       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746637286982       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746637286982       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746637290435       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746637286982       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746637324510       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746636941191       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746637106518       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746636989144       residual = 8.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746637079357       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746637322895       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+08 is 5.615550e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.260219 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0625e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516444e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960801e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6405
    reference variance = 0.405252
====================================================
  Execution time = 2.5250e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5367e-01
  Total weights = 1.9549e+06
  Execution time = 3.5940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442892351756
                                         uncertainty =       0.003711748074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442892351756
                                         uncertainty =       0.003711748074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470556255
  error estimate for blocks of size 2^( 2) =       0.000494494919
  error estimate for blocks of size 2^( 3) =       0.000516778997
  error estimate for blocks of size 2^( 4) =       0.000533413443
  error estimate for blocks of size 2^( 5) =       0.000541276074
  error estimate for blocks of size 2^( 6) =       0.000545387876
  error estimate for blocks of size 2^( 7) =       0.000549888751

      target function =      -0.742304758047
              le_mean =     -22.661797645420
             les_mean =     514.010738087957
             stat err =       0.000542491536
             autocorr =       1.329115830792
   target nu stat err =       0.000542491536
   target dn stat err =       0.004397086316
      target stat err =       0.003621886105
              std dev =       0.665467038270
             le_variance =       0.442846379024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442892351753
                                         uncertainty =       0.003711748074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442892351753
                                         uncertainty =       0.003711748074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470556255
  error estimate for blocks of size 2^( 2) =       0.000494494919
  error estimate for blocks of size 2^( 3) =       0.000516778997
  error estimate for blocks of size 2^( 4) =       0.000533413443
  error estimate for blocks of size 2^( 5) =       0.000541276074
  error estimate for blocks of size 2^( 6) =       0.000545387876
  error estimate for blocks of size 2^( 7) =       0.000549888751

      target function =      -0.742304758063
              le_mean =     -22.661797645420
             les_mean =     514.010738087932
             stat err =       0.000542491536
             autocorr =       1.329115830807
   target nu stat err =       0.000542491536
   target dn stat err =       0.004397086313
      target stat err =       0.003621886102
              std dev =       0.665467038268
             le_variance =       0.442846379022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442892351755
                                         uncertainty =       0.003711748074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442892351755
                                         uncertainty =       0.003711748074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470556255
  error estimate for blocks of size 2^( 2) =       0.000494494919
  error estimate for blocks of size 2^( 3) =       0.000516778997
  error estimate for blocks of size 2^( 4) =       0.000533413443
  error estimate for blocks of size 2^( 5) =       0.000541276074
  error estimate for blocks of size 2^( 6) =       0.000545387876
  error estimate for blocks of size 2^( 7) =       0.000549888751

      target function =      -0.742304758055
              le_mean =     -22.661797645420
             les_mean =     514.010738087945
             stat err =       0.000542491536
             autocorr =       1.329115830794
   target nu stat err =       0.000542491536
   target dn stat err =       0.004397086314
      target stat err =       0.003621886103
              std dev =       0.665467038269
             le_variance =       0.442846379023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442892351756
                                         uncertainty =       0.003711748074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442892351756
                                         uncertainty =       0.003711748074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470556255
  error estimate for blocks of size 2^( 2) =       0.000494494919
  error estimate for blocks of size 2^( 3) =       0.000516778997
  error estimate for blocks of size 2^( 4) =       0.000533413443
  error estimate for blocks of size 2^( 5) =       0.000541276074
  error estimate for blocks of size 2^( 6) =       0.000545387876
  error estimate for blocks of size 2^( 7) =       0.000549888751

      target function =      -0.742304758048
              le_mean =     -22.661797645420
             les_mean =     514.010738087955
             stat err =       0.000542491536
             autocorr =       1.329115830800
   target nu stat err =       0.000542491536
   target dn stat err =       0.004397086316
      target stat err =       0.003621886104
              std dev =       0.665467038270
             le_variance =       0.442846379024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742304758047        initial
     1.5259e+07     1.5259e+08             8.9841e-12        -0.742304758063  <--
     6.1035e+07     6.1035e+08             2.2461e-12        -0.742304758055
     2.4414e+08     2.4414e+09             5.6155e-13        -0.742304758048

*****************************************************************************
Applying the update for shift_i =   1.5259e+07     and shift_s =   1.5259e+08
*****************************************************************************

  Execution time = 4.4706e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516444e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960801e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356604e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5403e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.628
    reference variance = 0.54365
====================================================
  Execution time = 2.5940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5408e-01
  Total weights = 1.955261039e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444057278227
                                         uncertainty =       0.002165771333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444057278227
                                         uncertainty =       0.002165771333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471198028
  error estimate for blocks of size 2^( 2) =       0.000495119775
  error estimate for blocks of size 2^( 3) =       0.000517801567
  error estimate for blocks of size 2^( 4) =       0.000533410178
  error estimate for blocks of size 2^( 5) =       0.000544230582
  error estimate for blocks of size 2^( 6) =       0.000550389608
  error estimate for blocks of size 2^( 7) =       0.000553357635

      target function =      -0.741981229027
              le_mean =     -22.662511931116
             les_mean =     514.043527999737
             stat err =       0.000545347000
             autocorr =       1.339488314973
   target nu stat err =       0.000545347000
   target dn stat err =       0.002978411014
      target stat err =       0.002493143634
              std dev =       0.666374641420
             le_variance =       0.444055162728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266251193112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741988669995       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741988670000       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741988670001       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741988669826       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741988670007       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741988668761       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741988669402       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741988672310       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741988669335       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741988673896       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741988669305       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+06 is 6.154170e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741988669995       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741988669996       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741988669996       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741988664583       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741988674288       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741988669996       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741988673564       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741988719228       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741988679329       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741988627947       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741988655531       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+07 is 1.538542e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741988669995       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741988669995       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741988669995       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741988669348       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741988669988       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741988704433       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741988782529       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741989006314       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741988634976       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741988561986       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741988674465       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+07 is 3.846372e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264403 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0657e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516444e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960801e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461744e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6651
    reference variance = 0.367023
====================================================
  Execution time = 2.5449e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5328e-01
  Total weights = 1.9549e+06
  Execution time = 3.6912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437634642616
                                         uncertainty =       0.001689996963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437634642616
                                         uncertainty =       0.001689996963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467728310
  error estimate for blocks of size 2^( 2) =       0.000491817282
  error estimate for blocks of size 2^( 3) =       0.000514086111
  error estimate for blocks of size 2^( 4) =       0.000529309599
  error estimate for blocks of size 2^( 5) =       0.000538342015
  error estimate for blocks of size 2^( 6) =       0.000544663314
  error estimate for blocks of size 2^( 7) =       0.000546543916

      target function =      -0.742566995880
              le_mean =     -22.662012401459
             les_mean =     514.020089596601
             stat err =       0.000539714711
             autocorr =       1.331500079938
   target nu stat err =       0.000539714711
   target dn stat err =       0.008671399238
      target stat err =       0.007078408385
              std dev =       0.661467720016
             le_variance =       0.437539544624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437634642581
                                         uncertainty =       0.001689996952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437634642581
                                         uncertainty =       0.001689996952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467728310
  error estimate for blocks of size 2^( 2) =       0.000491817282
  error estimate for blocks of size 2^( 3) =       0.000514086111
  error estimate for blocks of size 2^( 4) =       0.000529309599
  error estimate for blocks of size 2^( 5) =       0.000538342015
  error estimate for blocks of size 2^( 6) =       0.000544663314
  error estimate for blocks of size 2^( 7) =       0.000546543916

      target function =      -0.742566996546
              le_mean =     -22.662012401459
             les_mean =     514.020089595787
             stat err =       0.000539714711
             autocorr =       1.331500079983
   target nu stat err =       0.000539714711
   target dn stat err =       0.008671399028
      target stat err =       0.007078408228
              std dev =       0.661467719990
             le_variance =       0.437539544589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437634642598
                                         uncertainty =       0.001689996958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437634642598
                                         uncertainty =       0.001689996958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467728310
  error estimate for blocks of size 2^( 2) =       0.000491817282
  error estimate for blocks of size 2^( 3) =       0.000514086111
  error estimate for blocks of size 2^( 4) =       0.000529309599
  error estimate for blocks of size 2^( 5) =       0.000538342015
  error estimate for blocks of size 2^( 6) =       0.000544663314
  error estimate for blocks of size 2^( 7) =       0.000546543916

      target function =      -0.742566996213
              le_mean =     -22.662012401459
             les_mean =     514.020089596194
             stat err =       0.000539714711
             autocorr =       1.331500079961
   target nu stat err =       0.000539714711
   target dn stat err =       0.008671399133
      target stat err =       0.007078408307
              std dev =       0.661467720004
             le_variance =       0.437539544607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437634642614
                                         uncertainty =       0.001689996962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437634642614
                                         uncertainty =       0.001689996962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467728310
  error estimate for blocks of size 2^( 2) =       0.000491817282
  error estimate for blocks of size 2^( 3) =       0.000514086111
  error estimate for blocks of size 2^( 4) =       0.000529309599
  error estimate for blocks of size 2^( 5) =       0.000538342015
  error estimate for blocks of size 2^( 6) =       0.000544663314
  error estimate for blocks of size 2^( 7) =       0.000546543916

      target function =      -0.742566995922
              le_mean =     -22.662012401459
             les_mean =     514.020089596550
             stat err =       0.000539714711
             autocorr =       1.331500079940
   target nu stat err =       0.000539714711
   target dn stat err =       0.008671399225
      target stat err =       0.007078408376
              std dev =       0.661467720015
             le_variance =       0.437539544622


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742566995880        initial
     3.8147e+06     3.8147e+07             6.1542e-11        -0.742566996546  <--
     1.5259e+07     1.5259e+08             1.5385e-11        -0.742566996213
     6.1035e+07     6.1035e+08             3.8464e-12        -0.742566995922

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 4.3646e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.608
    reference variance = 0.392919
====================================================
  Execution time = 2.5777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4646e-01
  Total weights = 1.955112922e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436916714087
                                         uncertainty =       0.001919709018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436916714087
                                         uncertainty =       0.001919709018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467400099
  error estimate for blocks of size 2^( 2) =       0.000491889838
  error estimate for blocks of size 2^( 3) =       0.000514042703
  error estimate for blocks of size 2^( 4) =       0.000529876348
  error estimate for blocks of size 2^( 5) =       0.000538383179
  error estimate for blocks of size 2^( 6) =       0.000542821602
  error estimate for blocks of size 2^( 7) =       0.000544218555

      target function =      -0.748202740136
              le_mean =     -22.661180774781
             les_mean =     513.975579001606
             stat err =       0.000538824921
             autocorr =       1.328977865522
   target nu stat err =       0.000538824921
   target dn stat err =       0.002670450684
      target stat err =       0.002281153012
              std dev =       0.661003558986
             le_variance =       0.436925704993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266118077478e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748208700092       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748208700108       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748208700111       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748208700111       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748208700111       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748208701495       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748208698895       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748208700111       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748208699574       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+05 is 2.012021e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748208700092       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748208700096       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748208700097       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748208700097       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748208700097       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748208700097       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748208700097       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748208700089       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748208700097       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+06 is 5.030054e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748208700092       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748208700093       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748208700093       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748208700886       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748208700093       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748208695705       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748208704046       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748208700093       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748208695429       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+07 is 1.257511e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0525e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488807e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960801e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.6844
    reference variance = 0.287022
====================================================
  Execution time = 2.5383e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6126e-01
  Total weights = 1.9549e+06
  Execution time = 3.5994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446856705709
                                         uncertainty =       0.004046270058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446856705709
                                         uncertainty =       0.004046270058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472681645
  error estimate for blocks of size 2^( 2) =       0.000496605829
  error estimate for blocks of size 2^( 3) =       0.000518894504
  error estimate for blocks of size 2^( 4) =       0.000535079189
  error estimate for blocks of size 2^( 5) =       0.000545646792
  error estimate for blocks of size 2^( 6) =       0.000550447678
  error estimate for blocks of size 2^( 7) =       0.000552525487

      target function =      -0.736162122014
              le_mean =     -22.662065525275
             les_mean =     514.030474463601
             stat err =       0.000545924787
             autocorr =       1.333914977940
   target nu stat err =       0.000545924787
   target dn stat err =       0.006663581052
      target stat err =       0.005360434428
              std dev =       0.668472793240
             le_variance =       0.446855875302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446856705703
                                         uncertainty =       0.004046270065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446856705703
                                         uncertainty =       0.004046270065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472681645
  error estimate for blocks of size 2^( 2) =       0.000496605829
  error estimate for blocks of size 2^( 3) =       0.000518894504
  error estimate for blocks of size 2^( 4) =       0.000535079189
  error estimate for blocks of size 2^( 5) =       0.000545646792
  error estimate for blocks of size 2^( 6) =       0.000550447678
  error estimate for blocks of size 2^( 7) =       0.000552525487

      target function =      -0.736162121654
              le_mean =     -22.662065525275
             les_mean =     514.030474464052
             stat err =       0.000545924787
             autocorr =       1.333914978013
   target nu stat err =       0.000545924787
   target dn stat err =       0.006663581728
      target stat err =       0.005360434961
              std dev =       0.668472793236
             le_variance =       0.446855875296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446856705706
                                         uncertainty =       0.004046270061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446856705706
                                         uncertainty =       0.004046270061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472681645
  error estimate for blocks of size 2^( 2) =       0.000496605829
  error estimate for blocks of size 2^( 3) =       0.000518894504
  error estimate for blocks of size 2^( 4) =       0.000535079189
  error estimate for blocks of size 2^( 5) =       0.000545646792
  error estimate for blocks of size 2^( 6) =       0.000550447678
  error estimate for blocks of size 2^( 7) =       0.000552525487

      target function =      -0.736162121834
              le_mean =     -22.662065525275
             les_mean =     514.030474463826
             stat err =       0.000545924787
             autocorr =       1.333914977976
   target nu stat err =       0.000545924787
   target dn stat err =       0.006663581390
      target stat err =       0.005360434694
              std dev =       0.668472793238
             le_variance =       0.446855875299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446856705709
                                         uncertainty =       0.004046270059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446856705709
                                         uncertainty =       0.004046270059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472681645
  error estimate for blocks of size 2^( 2) =       0.000496605829
  error estimate for blocks of size 2^( 3) =       0.000518894504
  error estimate for blocks of size 2^( 4) =       0.000535079189
  error estimate for blocks of size 2^( 5) =       0.000545646792
  error estimate for blocks of size 2^( 6) =       0.000550447678
  error estimate for blocks of size 2^( 7) =       0.000552525487

      target function =      -0.736162121992
              le_mean =     -22.662065525275
             les_mean =     514.030474463629
             stat err =       0.000545924787
             autocorr =       1.333914977954
   target nu stat err =       0.000545924787
   target dn stat err =       0.006663581094
      target stat err =       0.005360434461
              std dev =       0.668472793240
             le_variance =       0.446855875301


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736162122014        initial  <--
     9.5367e+05     9.5367e+06             2.0120e-10        -0.736162121654
     3.8147e+06     3.8147e+07             5.0301e-11        -0.736162121834
     1.5259e+07     1.5259e+08             1.2575e-11        -0.736162121992

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.0925
  </log>
  <optVariables href="FORM.s033.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5641e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6203
    reference variance = 0.251077
====================================================
  Execution time = 2.6173e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4804e-01
  Total weights = 1.954975279e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437077736176
                                         uncertainty =       0.002015141631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437077736176
                                         uncertainty =       0.002015141631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467520030
  error estimate for blocks of size 2^( 2) =       0.000491533034
  error estimate for blocks of size 2^( 3) =       0.000513529790
  error estimate for blocks of size 2^( 4) =       0.000529294137
  error estimate for blocks of size 2^( 5) =       0.000539792542
  error estimate for blocks of size 2^( 6) =       0.000544731347
  error estimate for blocks of size 2^( 7) =       0.000547572266

      target function =      -0.746920250996
              le_mean =     -22.662369943024
             les_mean =     514.031052600234
             stat err =       0.000540347573
             autocorr =       1.335813920293
   target nu stat err =       0.000540347573
   target dn stat err =       0.003006412446
      target stat err =       0.002546064877
              std dev =       0.661173167796
             le_variance =       0.437149957813


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266236994302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928022215       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928022218       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746928022218       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746928022218       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746928023132       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746928019765       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746928032026       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746928022218       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746928011995       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746928012189       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746928001588       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+06 is 2.998777e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928022215       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928022216       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746928022216       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746928022216       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746928006161       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746928051473       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746928064918       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746928028910       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746927960168       residual = 7.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746927999346       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746928155950       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+07 is 7.497044e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928022215       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928022215       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746928022215       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746928022215       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746928022215       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746927988356       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746928029848       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746928158043       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746928222508       residual = 7.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746928022166       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746928264949       residual = 9.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+08 is 1.874227e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0877e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.5583
    reference variance = 0.272462
====================================================
  Execution time = 2.5263e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5426e-01
  Total weights = 1.9547e+06
  Execution time = 3.6401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441476543295
                                         uncertainty =       0.001901835792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441476543295
                                         uncertainty =       0.001901835792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469816153
  error estimate for blocks of size 2^( 2) =       0.000493745438
  error estimate for blocks of size 2^( 3) =       0.000515559639
  error estimate for blocks of size 2^( 4) =       0.000532257073
  error estimate for blocks of size 2^( 5) =       0.000541569659
  error estimate for blocks of size 2^( 6) =       0.000547699997
  error estimate for blocks of size 2^( 7) =       0.000551322702

      target function =      -0.741825037222
              le_mean =     -22.661568207325
             les_mean =     514.000935133347
             stat err =       0.000543212358
             autocorr =       1.336852194548
   target nu stat err =       0.000543212358
   target dn stat err =       0.003579589658
      target stat err =       0.002963985878
              std dev =       0.664420376055
             le_variance =       0.441454436117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441476543289
                                         uncertainty =       0.001901835792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441476543289
                                         uncertainty =       0.001901835792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469816153
  error estimate for blocks of size 2^( 2) =       0.000493745438
  error estimate for blocks of size 2^( 3) =       0.000515559639
  error estimate for blocks of size 2^( 4) =       0.000532257073
  error estimate for blocks of size 2^( 5) =       0.000541569659
  error estimate for blocks of size 2^( 6) =       0.000547699997
  error estimate for blocks of size 2^( 7) =       0.000551322702

      target function =      -0.741825037216
              le_mean =     -22.661568207325
             les_mean =     514.000935133349
             stat err =       0.000543212358
             autocorr =       1.336852194562
   target nu stat err =       0.000543212358
   target dn stat err =       0.003579589659
      target stat err =       0.002963985879
              std dev =       0.664420376050
             le_variance =       0.441454436111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441476543292
                                         uncertainty =       0.001901835792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441476543292
                                         uncertainty =       0.001901835792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469816153
  error estimate for blocks of size 2^( 2) =       0.000493745438
  error estimate for blocks of size 2^( 3) =       0.000515559639
  error estimate for blocks of size 2^( 4) =       0.000532257073
  error estimate for blocks of size 2^( 5) =       0.000541569659
  error estimate for blocks of size 2^( 6) =       0.000547699997
  error estimate for blocks of size 2^( 7) =       0.000551322702

      target function =      -0.741825037219
              le_mean =     -22.661568207325
             les_mean =     514.000935133348
             stat err =       0.000543212358
             autocorr =       1.336852194556
   target nu stat err =       0.000543212358
   target dn stat err =       0.003579589658
      target stat err =       0.002963985878
              std dev =       0.664420376052
             le_variance =       0.441454436114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441476543295
                                         uncertainty =       0.001901835792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441476543295
                                         uncertainty =       0.001901835792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469816153
  error estimate for blocks of size 2^( 2) =       0.000493745438
  error estimate for blocks of size 2^( 3) =       0.000515559639
  error estimate for blocks of size 2^( 4) =       0.000532257073
  error estimate for blocks of size 2^( 5) =       0.000541569659
  error estimate for blocks of size 2^( 6) =       0.000547699997
  error estimate for blocks of size 2^( 7) =       0.000551322702

      target function =      -0.741825037222
              le_mean =     -22.661568207325
             les_mean =     514.000935133347
             stat err =       0.000543212358
             autocorr =       1.336852194558
   target nu stat err =       0.000543212358
   target dn stat err =       0.003579589658
      target stat err =       0.002963985878
              std dev =       0.664420376054
             le_variance =       0.441454436116


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741825037222        initial  <--
     9.5367e+06     9.5367e+07             2.9988e-11        -0.741825037216
     3.8147e+07     3.8147e+08             7.4970e-12        -0.741825037219
     1.5259e+08     1.5259e+09             1.8742e-12        -0.741825037222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4288
  </log>
  <optVariables href="FORM.s034.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7156
    reference variance = 0.317156
====================================================
  Execution time = 2.5977e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4726e-01
  Total weights = 1.954791213e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438585674242
                                         uncertainty =       0.001641777746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438585674242
                                         uncertainty =       0.001641777746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468262770
  error estimate for blocks of size 2^( 2) =       0.000492722417
  error estimate for blocks of size 2^( 3) =       0.000514883269
  error estimate for blocks of size 2^( 4) =       0.000530570658
  error estimate for blocks of size 2^( 5) =       0.000540111685
  error estimate for blocks of size 2^( 6) =       0.000545793665
  error estimate for blocks of size 2^( 7) =       0.000551240891

      target function =      -0.747557844796
              le_mean =     -22.661491588809
             les_mean =     513.990456280039
             stat err =       0.000541929225
             autocorr =       1.339386400963
   target nu stat err =       0.000541929225
   target dn stat err =       0.002355588899
      target stat err =       0.002030129415
              std dev =       0.662223559528
             le_variance =       0.438540042794


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266149158881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747562408703       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747562408703       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747562408703       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747562408703       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747562409964       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747562481374       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747562503606       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747562432542       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747562387440       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+07 is 1.943448e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747562408703       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747562408703       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747562408703       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747562363973       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747562408682       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747562387414       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747562443648       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747562642348       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747562215908       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+08 is 4.858499e-13

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747562408703       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747562408703       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747562408703       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747562404317       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747562408703       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747562290706       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747562596477       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747561092991       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747559177267       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+09 is 1.214864e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274774 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0676e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.6293
    reference variance = 0.439955
====================================================
  Execution time = 2.5296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4604e-01
  Total weights = 1.9551e+06
  Execution time = 3.6089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437307427134
                                         uncertainty =       0.002096042090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437307427134
                                         uncertainty =       0.002096042090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467571000
  error estimate for blocks of size 2^( 2) =       0.000491592039
  error estimate for blocks of size 2^( 3) =       0.000513943036
  error estimate for blocks of size 2^( 4) =       0.000529297693
  error estimate for blocks of size 2^( 5) =       0.000537603464
  error estimate for blocks of size 2^( 6) =       0.000544418401
  error estimate for blocks of size 2^( 7) =       0.000544054003

      target function =      -0.748558279768
              le_mean =     -22.661304828414
             les_mean =     513.980774931696
             stat err =       0.000538843390
             autocorr =       1.328097581391
   target nu stat err =       0.000538843390
   target dn stat err =       0.002337311924
      target stat err =       0.002019346549
              std dev =       0.661245249327
             le_variance =       0.437245279758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437307427134
                                         uncertainty =       0.002096042090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437307427134
                                         uncertainty =       0.002096042090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467571000
  error estimate for blocks of size 2^( 2) =       0.000491592039
  error estimate for blocks of size 2^( 3) =       0.000513943036
  error estimate for blocks of size 2^( 4) =       0.000529297693
  error estimate for blocks of size 2^( 5) =       0.000537603464
  error estimate for blocks of size 2^( 6) =       0.000544418401
  error estimate for blocks of size 2^( 7) =       0.000544054003

      target function =      -0.748558279722
              le_mean =     -22.661304828414
             les_mean =     513.980774931752
             stat err =       0.000538843390
             autocorr =       1.328097581386
   target nu stat err =       0.000538843390
   target dn stat err =       0.002337311929
      target stat err =       0.002019346553
              std dev =       0.661245249327
             le_variance =       0.437245279758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437307427134
                                         uncertainty =       0.002096042090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437307427134
                                         uncertainty =       0.002096042090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467571000
  error estimate for blocks of size 2^( 2) =       0.000491592039
  error estimate for blocks of size 2^( 3) =       0.000513943036
  error estimate for blocks of size 2^( 4) =       0.000529297693
  error estimate for blocks of size 2^( 5) =       0.000537603464
  error estimate for blocks of size 2^( 6) =       0.000544418401
  error estimate for blocks of size 2^( 7) =       0.000544054003

      target function =      -0.748558279745
              le_mean =     -22.661304828414
             les_mean =     513.980774931724
             stat err =       0.000538843390
             autocorr =       1.328097581387
   target nu stat err =       0.000538843390
   target dn stat err =       0.002337311926
      target stat err =       0.002019346551
              std dev =       0.661245249327
             le_variance =       0.437245279758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437307427134
                                         uncertainty =       0.002096042090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437307427134
                                         uncertainty =       0.002096042090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467571000
  error estimate for blocks of size 2^( 2) =       0.000491592039
  error estimate for blocks of size 2^( 3) =       0.000513943036
  error estimate for blocks of size 2^( 4) =       0.000529297693
  error estimate for blocks of size 2^( 5) =       0.000537603464
  error estimate for blocks of size 2^( 6) =       0.000544418401
  error estimate for blocks of size 2^( 7) =       0.000544054003

      target function =      -0.748558279766
              le_mean =     -22.661304828414
             les_mean =     513.980774931700
             stat err =       0.000538843390
             autocorr =       1.328097581390
   target nu stat err =       0.000538843390
   target dn stat err =       0.002337311924
      target stat err =       0.002019346549
              std dev =       0.661245249327
             le_variance =       0.437245279758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748558279768        initial  <--
     9.5367e+07     9.5367e+08             1.9434e-12        -0.748558279722
     3.8147e+08     3.8147e+09             4.8585e-13        -0.748558279745
     1.5259e+09     1.5259e+10             1.2149e-13        -0.748558279766

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.9300
  </log>
  <optVariables href="FORM.s035.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5685e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7534
    reference variance = 0.30646
====================================================
  Execution time = 2.5937e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4721e-01
  Total weights = 1.955247850e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437636374673
                                         uncertainty =       0.002001991133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437636374673
                                         uncertainty =       0.002001991133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467801189
  error estimate for blocks of size 2^( 2) =       0.000491858958
  error estimate for blocks of size 2^( 3) =       0.000514047811
  error estimate for blocks of size 2^( 4) =       0.000530486018
  error estimate for blocks of size 2^( 5) =       0.000540283936
  error estimate for blocks of size 2^( 6) =       0.000544234396
  error estimate for blocks of size 2^( 7) =       0.000545552006

      target function =      -0.747583034658
              le_mean =     -22.660858195897
             les_mean =     513.961704663851
             stat err =       0.000540139089
             autocorr =       1.333179336123
   target nu stat err =       0.000540139089
   target dn stat err =       0.002640786363
      target stat err =       0.002253241732
              std dev =       0.661570785423
             le_variance =       0.437675904125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266085819590e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747588898078       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747588898078       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747588898078       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747588898078       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747589456983       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747588570992       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747588671263       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747586717572       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747588878349       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747586612469       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747589091055       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747588185708       residual = 9.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+08 is 2.584014e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747588898078       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747588898078       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747588898078       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747588898078       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747588898077       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747587770761       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747588097930       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747589620948       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747589381502       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747600007300       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747584639772       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747576911786       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+09 is 6.452897e-14

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747588898078       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747588898078       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747588898078       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747586040448       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747588812670       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747572200762       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747584376486       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747568034302       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747588140357       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747541127425       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747568493892       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747525916219       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747591754512       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747562661537       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747606432027       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747608251534       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747627912435       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747599455535       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747618712076       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747666285116       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747698029648       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747006952684       residual = 6.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747695103210       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747824256830       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747860527639       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747229144728       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747877140276       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747864192870       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744981532987       residual = 9.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.753911385594       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746730924047       residual = 4.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746860361231       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.761458584720       residual = 7.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.090615398761       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.782668472467       residual = 3.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.866461341274       residual = 4.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.707960168879       residual = 1.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.641998393156       residual = 3.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.916861037155       residual = 2.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -2.948193410639       residual = 2.39e+04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.455943584039       residual = 1.80e+04           smallest_sin_value = 1.00e+00
davidson iteration   41 stopping due to too large eigenvalue change
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+10 is 1.615956e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0645e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6864
    reference variance = 0.474779
====================================================
  Execution time = 2.5513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6472e-01
  Total weights = 1.9556e+06
  Execution time = 3.5968e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267359425
                                         uncertainty =       0.002530381665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267359425
                                         uncertainty =       0.002530381665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470774579
  error estimate for blocks of size 2^( 2) =       0.000494746244
  error estimate for blocks of size 2^( 3) =       0.000516687489
  error estimate for blocks of size 2^( 4) =       0.000532730238
  error estimate for blocks of size 2^( 5) =       0.000542183128
  error estimate for blocks of size 2^( 6) =       0.000547574332
  error estimate for blocks of size 2^( 7) =       0.000547749647

      target function =      -0.733372162150
              le_mean =     -22.662113782973
             les_mean =     514.036123804591
             stat err =       0.000542559336
             autocorr =       1.328215289822
   target nu stat err =       0.000542559336
   target dn stat err =       0.009088681325
      target stat err =       0.007236126519
              std dev =       0.665775794355
             le_variance =       0.443257408349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267359425
                                         uncertainty =       0.002530381665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267359425
                                         uncertainty =       0.002530381665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470774579
  error estimate for blocks of size 2^( 2) =       0.000494746244
  error estimate for blocks of size 2^( 3) =       0.000516687489
  error estimate for blocks of size 2^( 4) =       0.000532730238
  error estimate for blocks of size 2^( 5) =       0.000542183128
  error estimate for blocks of size 2^( 6) =       0.000547574332
  error estimate for blocks of size 2^( 7) =       0.000547749647

      target function =      -0.733372162149
              le_mean =     -22.662113782973
             les_mean =     514.036123804591
             stat err =       0.000542559336
             autocorr =       1.328215289827
   target nu stat err =       0.000542559336
   target dn stat err =       0.009088681325
      target stat err =       0.007236126519
              std dev =       0.665775794355
             le_variance =       0.443257408349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267359425
                                         uncertainty =       0.002530381665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267359425
                                         uncertainty =       0.002530381665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470774579
  error estimate for blocks of size 2^( 2) =       0.000494746244
  error estimate for blocks of size 2^( 3) =       0.000516687489
  error estimate for blocks of size 2^( 4) =       0.000532730238
  error estimate for blocks of size 2^( 5) =       0.000542183128
  error estimate for blocks of size 2^( 6) =       0.000547574332
  error estimate for blocks of size 2^( 7) =       0.000547749647

      target function =      -0.733372162149
              le_mean =     -22.662113782973
             les_mean =     514.036123804591
             stat err =       0.000542559336
             autocorr =       1.328215289814
   target nu stat err =       0.000542559336
   target dn stat err =       0.009088681325
      target stat err =       0.007236126519
              std dev =       0.665775794355
             le_variance =       0.443257408349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267359425
                                         uncertainty =       0.002530381665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443267359425
                                         uncertainty =       0.002530381665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470774579
  error estimate for blocks of size 2^( 2) =       0.000494746244
  error estimate for blocks of size 2^( 3) =       0.000516687489
  error estimate for blocks of size 2^( 4) =       0.000532730238
  error estimate for blocks of size 2^( 5) =       0.000542183128
  error estimate for blocks of size 2^( 6) =       0.000547574332
  error estimate for blocks of size 2^( 7) =       0.000547749647

      target function =      -0.733372162150
              le_mean =     -22.662113782973
             les_mean =     514.036123804591
             stat err =       0.000542559336
             autocorr =       1.328215289823
   target nu stat err =       0.000542559336
   target dn stat err =       0.009088681325
      target stat err =       0.007236126519
              std dev =       0.665775794355
             le_variance =       0.443257408349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.733372162150        initial  <--
     9.5367e+08     9.5367e+09             2.5840e-13        -0.733372162149
     3.8147e+09     3.8147e+10             6.4529e-14        -0.733372162149
     1.5259e+10     1.5259e+11             1.6160e-14        -0.733372162150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6161
  </log>
  <optVariables href="FORM.s036.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4283e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6631
    reference variance = 0.257825
====================================================
  Execution time = 2.5782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5077e-01
  Total weights = 1.955268693e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440318907315
                                         uncertainty =       0.002286024425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440318907315
                                         uncertainty =       0.002286024425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469212428
  error estimate for blocks of size 2^( 2) =       0.000493307039
  error estimate for blocks of size 2^( 3) =       0.000515869818
  error estimate for blocks of size 2^( 4) =       0.000532361462
  error estimate for blocks of size 2^( 5) =       0.000541658965
  error estimate for blocks of size 2^( 6) =       0.000547333964
  error estimate for blocks of size 2^( 7) =       0.000549111031

      target function =      -0.744683889901
              le_mean =     -22.662766197395
             les_mean =     514.051742169134
             stat err =       0.000542616356
             autocorr =       1.337355129807
   target nu stat err =       0.000542616356
   target dn stat err =       0.002967798040
      target stat err =       0.002502603014
              std dev =       0.663566578644
             le_variance =       0.440320604293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266276619740e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744691373326       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744691373326       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744691373326       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744689678842       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744691373326       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744691373325       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744692954249       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744699915903       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744692154277       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744714686848       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744674605216       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744687587564       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+09 is 2.033663e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744691373326       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744691373326       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744691373326       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744691373326       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744709974387       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744671050916       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744691373326       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744666179522       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744703507252       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744721931476       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744734475743       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744590977926       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744680119833       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744879562209       residual = 9.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744649882422       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744715584857       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744695017458       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745764397651       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743992318302       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744299305975       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743759372087       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.684446088553       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.210782709586       residual = 4.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.678061647930       residual = 3.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.822636876923       residual = 3.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.594011072655       residual = 1.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.216822347526       residual = 4.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.778372490397       residual = 1.33e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.899640525725       residual = 1.58e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -5.279523349643       residual = 8.63e+04           smallest_sin_value = 1.00e+00
davidson iteration   30 stopping due to too large eigenvalue change
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+10 is 5.089754e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744691373326       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744691373326       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744691373326       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744691373326       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744634161374       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744632175900       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744691240688       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744691434227       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744555839374       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745186028412       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744957096948       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744555109497       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744731508168       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744569712721       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743910656104       residual = 8.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.730172163620       residual = 7.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.756009055141       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.642873026720       residual = 1.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.852125409769       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.516164392223       residual = 3.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.093044578353       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -2.361367593972       residual = 4.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.170899264887       residual = 1.53e+04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.024707375145       residual = 2.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -3.628712500545       residual = 3.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   25 stopping due to too large eigenvalue change
davidson solver did not converge after         25 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+11 is 1.272160e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0498e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6775
    reference variance = 0.367066
====================================================
  Execution time = 2.5544e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4410e-01
  Total weights = 1.9552e+06
  Execution time = 3.6091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435415465752
                                         uncertainty =       0.001983540550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435415465752
                                         uncertainty =       0.001983540550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466677603
  error estimate for blocks of size 2^( 2) =       0.000491213560
  error estimate for blocks of size 2^( 3) =       0.000512980397
  error estimate for blocks of size 2^( 4) =       0.000529123082
  error estimate for blocks of size 2^( 5) =       0.000538541580
  error estimate for blocks of size 2^( 6) =       0.000542852081
  error estimate for blocks of size 2^( 7) =       0.000546836184

      target function =      -0.750174596466
              le_mean =     -22.661961542575
             les_mean =     514.008596638539
             stat err =       0.000539338232
             autocorr =       1.335637170083
   target nu stat err =       0.000539338232
   target dn stat err =       0.003135744986
      target stat err =       0.002670414606
              std dev =       0.659981795442
             le_variance =       0.435575970314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435415465752
                                         uncertainty =       0.001983540550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435415465752
                                         uncertainty =       0.001983540550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466677603
  error estimate for blocks of size 2^( 2) =       0.000491213560
  error estimate for blocks of size 2^( 3) =       0.000512980397
  error estimate for blocks of size 2^( 4) =       0.000529123082
  error estimate for blocks of size 2^( 5) =       0.000538541580
  error estimate for blocks of size 2^( 6) =       0.000542852081
  error estimate for blocks of size 2^( 7) =       0.000546836184

      target function =      -0.750174596466
              le_mean =     -22.661961542575
             les_mean =     514.008596638539
             stat err =       0.000539338232
             autocorr =       1.335637170083
   target nu stat err =       0.000539338232
   target dn stat err =       0.003135744986
      target stat err =       0.002670414606
              std dev =       0.659981795442
             le_variance =       0.435575970314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435415465752
                                         uncertainty =       0.001983540550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435415465752
                                         uncertainty =       0.001983540550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466677603
  error estimate for blocks of size 2^( 2) =       0.000491213560
  error estimate for blocks of size 2^( 3) =       0.000512980397
  error estimate for blocks of size 2^( 4) =       0.000529123082
  error estimate for blocks of size 2^( 5) =       0.000538541580
  error estimate for blocks of size 2^( 6) =       0.000542852081
  error estimate for blocks of size 2^( 7) =       0.000546836184

      target function =      -0.750174596466
              le_mean =     -22.661961542575
             les_mean =     514.008596638539
             stat err =       0.000539338232
             autocorr =       1.335637170083
   target nu stat err =       0.000539338232
   target dn stat err =       0.003135744986
      target stat err =       0.002670414606
              std dev =       0.659981795442
             le_variance =       0.435575970314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435415465752
                                         uncertainty =       0.001983540550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435415465752
                                         uncertainty =       0.001983540550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466677603
  error estimate for blocks of size 2^( 2) =       0.000491213560
  error estimate for blocks of size 2^( 3) =       0.000512980397
  error estimate for blocks of size 2^( 4) =       0.000529123082
  error estimate for blocks of size 2^( 5) =       0.000538541580
  error estimate for blocks of size 2^( 6) =       0.000542852081
  error estimate for blocks of size 2^( 7) =       0.000546836184

      target function =      -0.750174596466
              le_mean =     -22.661961542575
             les_mean =     514.008596638539
             stat err =       0.000539338232
             autocorr =       1.335637170083
   target nu stat err =       0.000539338232
   target dn stat err =       0.003135744986
      target stat err =       0.002670414606
              std dev =       0.659981795442
             le_variance =       0.435575970314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750174596466        initial
     9.5367e+09     9.5367e+10             2.0337e-14        -0.750174596466  <--
     3.8147e+10     3.8147e+11             5.0898e-15        -0.750174596466
     1.5259e+11     1.5259e+12             1.2722e-15        -0.750174596466

*****************************************************************************
Applying the update for shift_i =   9.5367e+09     and shift_s =   9.5367e+10
*****************************************************************************

  Execution time = 4.5477e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5989e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.729
    reference variance = 0.449976
====================================================
  Execution time = 2.6469e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5347e-01
  Total weights = 1.955232823e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441201754456
                                         uncertainty =       0.002984825977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441201754456
                                         uncertainty =       0.002984825977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469658407
  error estimate for blocks of size 2^( 2) =       0.000493936929
  error estimate for blocks of size 2^( 3) =       0.000516250976
  error estimate for blocks of size 2^( 4) =       0.000532252389
  error estimate for blocks of size 2^( 5) =       0.000541577785
  error estimate for blocks of size 2^( 6) =       0.000545162617
  error estimate for blocks of size 2^( 7) =       0.000546621130

      target function =      -0.742461362236
              le_mean =     -22.661543249080
             les_mean =     513.999015846601
             stat err =       0.000541403480
             autocorr =       1.328855886663
   target nu stat err =       0.000541403480
   target dn stat err =       0.004068407923
      target stat err =       0.003358630281
              std dev =       0.664197288827
             le_variance =       0.441158038484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266154324908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742475678816       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742475678816       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742475678816       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742475678816       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742475678816       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742475678815       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742475048245       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742472643631       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742473506300       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742474581947       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742472306308       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+09 is 1.147643e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742475678816       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742475678816       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742475678816       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742475678816       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742475678816       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742474092643       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742475679865       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742449966996       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742466247448       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742465471871       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742480469700       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742480283551       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+09 is 2.869046e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742475678816       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742475678816       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742475678816       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742475678816       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742475678785       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742477918910       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742475656515       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742475416104       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742462436183       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742520773646       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742482277207       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742416449778       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742398669334       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742400757750       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742476955887       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742405646387       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742522933550       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742466397076       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742887110146       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742441318333       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742084276603       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742571624083       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742711366536       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742832762998       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742821242210       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.737789672089       residual = 6.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743101501575       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.712034967396       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.730563944969       residual = 3.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.411822005423       residual = 3.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.581235879088       residual = 1.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -7.511295399917       residual = 6.80e+04           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+10 is 7.131636e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.346389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1175e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7417
    reference variance = 0.290882
====================================================
  Execution time = 2.5626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4958e-01
  Total weights = 1.9550e+06
  Execution time = 3.6017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440012283691
                                         uncertainty =       0.002080992227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440012283691
                                         uncertainty =       0.002080992227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469005755
  error estimate for blocks of size 2^( 2) =       0.000492646247
  error estimate for blocks of size 2^( 3) =       0.000514800290
  error estimate for blocks of size 2^( 4) =       0.000530738326
  error estimate for blocks of size 2^( 5) =       0.000539553597
  error estimate for blocks of size 2^( 6) =       0.000543634272
  error estimate for blocks of size 2^( 7) =       0.000545507121

      target function =      -0.745642618395
              le_mean =     -22.661450999735
             les_mean =     513.990943211392
             stat err =       0.000539858329
             autocorr =       1.324961530551
   target nu stat err =       0.000539858329
   target dn stat err =       0.003023020675
      target stat err =       0.002547270678
              std dev =       0.663274299261
             le_variance =       0.439932796061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440012283691
                                         uncertainty =       0.002080992227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440012283691
                                         uncertainty =       0.002080992227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469005755
  error estimate for blocks of size 2^( 2) =       0.000492646247
  error estimate for blocks of size 2^( 3) =       0.000514800290
  error estimate for blocks of size 2^( 4) =       0.000530738326
  error estimate for blocks of size 2^( 5) =       0.000539553597
  error estimate for blocks of size 2^( 6) =       0.000543634272
  error estimate for blocks of size 2^( 7) =       0.000545507121

      target function =      -0.745642618395
              le_mean =     -22.661450999735
             les_mean =     513.990943211392
             stat err =       0.000539858329
             autocorr =       1.324961530551
   target nu stat err =       0.000539858329
   target dn stat err =       0.003023020675
      target stat err =       0.002547270678
              std dev =       0.663274299261
             le_variance =       0.439932796060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440012283691
                                         uncertainty =       0.002080992227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440012283691
                                         uncertainty =       0.002080992227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469005755
  error estimate for blocks of size 2^( 2) =       0.000492646247
  error estimate for blocks of size 2^( 3) =       0.000514800290
  error estimate for blocks of size 2^( 4) =       0.000530738326
  error estimate for blocks of size 2^( 5) =       0.000539553597
  error estimate for blocks of size 2^( 6) =       0.000543634272
  error estimate for blocks of size 2^( 7) =       0.000545507121

      target function =      -0.745642618395
              le_mean =     -22.661450999735
             les_mean =     513.990943211392
             stat err =       0.000539858329
             autocorr =       1.324961530554
   target nu stat err =       0.000539858329
   target dn stat err =       0.003023020675
      target stat err =       0.002547270678
              std dev =       0.663274299261
             le_variance =       0.439932796060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440012283691
                                         uncertainty =       0.002080992227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440012283691
                                         uncertainty =       0.002080992227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469005755
  error estimate for blocks of size 2^( 2) =       0.000492646247
  error estimate for blocks of size 2^( 3) =       0.000514800290
  error estimate for blocks of size 2^( 4) =       0.000530738326
  error estimate for blocks of size 2^( 5) =       0.000539553597
  error estimate for blocks of size 2^( 6) =       0.000543634272
  error estimate for blocks of size 2^( 7) =       0.000545507121

      target function =      -0.745642618395
              le_mean =     -22.661450999735
             les_mean =     513.990943211392
             stat err =       0.000539858329
             autocorr =       1.324961530550
   target nu stat err =       0.000539858329
   target dn stat err =       0.003023020675
      target stat err =       0.002547270678
              std dev =       0.663274299261
             le_variance =       0.439932796060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745642618395        initial
     2.3842e+09     2.3842e+10             1.1476e-13        -0.745642618395  <--
     9.5367e+09     9.5367e+10             2.8690e-14        -0.745642618395
     3.8147e+10     3.8147e+11             7.1316e-15        -0.745642618395

*****************************************************************************
Applying the update for shift_i =   2.3842e+09     and shift_s =   2.3842e+10
*****************************************************************************

  Execution time = 4.3762e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4943e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6689
    reference variance = 0.366563
====================================================
  Execution time = 2.6417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4892e-01
  Total weights = 1.955189591e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439183521685
                                         uncertainty =       0.002271414673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439183521685
                                         uncertainty =       0.002271414673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468608009
  error estimate for blocks of size 2^( 2) =       0.000492274514
  error estimate for blocks of size 2^( 3) =       0.000514424636
  error estimate for blocks of size 2^( 4) =       0.000530479588
  error estimate for blocks of size 2^( 5) =       0.000538849680
  error estimate for blocks of size 2^( 6) =       0.000543694557
  error estimate for blocks of size 2^( 7) =       0.000548748033

      target function =      -0.746192325373
              le_mean =     -22.661884645663
             les_mean =     514.009934498308
             stat err =       0.000540442964
             autocorr =       1.330087832647
   target nu stat err =       0.000540442964
   target dn stat err =       0.002998505127
      target stat err =       0.002533133268
              std dev =       0.662711802175
             le_variance =       0.439186932743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266188464566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746199903475       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746199903475       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746199903475       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746199903475       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746199881069       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746199903475       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746200724881       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746199483303       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746199903475       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746199060472       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746200623842       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+08 is 2.981937e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746199903475       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746199903475       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746199903475       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746199903475       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746200088154       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746199019657       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746200490293       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746201067107       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746200944629       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746193761697       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746197199731       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+09 is 7.462245e-14

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746199903475       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746199903475       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746199903475       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746199903475       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746199903475       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746199903475       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746199903475       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746191578315       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746200973503       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746179757820       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746199903475       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+09 is 1.859154e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1109e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.599
    reference variance = 0.338483
====================================================
  Execution time = 2.5610e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4912e-01
  Total weights = 1.9553e+06
  Execution time = 3.8394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438790683467
                                         uncertainty =       0.002053242780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438790683467
                                         uncertainty =       0.002053242780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468369830
  error estimate for blocks of size 2^( 2) =       0.000492758431
  error estimate for blocks of size 2^( 3) =       0.000514706587
  error estimate for blocks of size 2^( 4) =       0.000531139971
  error estimate for blocks of size 2^( 5) =       0.000540441964
  error estimate for blocks of size 2^( 6) =       0.000546212525
  error estimate for blocks of size 2^( 7) =       0.000547579072

      target function =      -0.746019545172
              le_mean =     -22.661473772516
             les_mean =     513.991517282783
             stat err =       0.000541343383
             autocorr =       1.335881210105
   target nu stat err =       0.000541343383
   target dn stat err =       0.002814682039
      target stat err =       0.002384392358
              std dev =       0.662374965474
             le_variance =       0.438740594886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438790683467
                                         uncertainty =       0.002053242780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438790683467
                                         uncertainty =       0.002053242780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468369830
  error estimate for blocks of size 2^( 2) =       0.000492758431
  error estimate for blocks of size 2^( 3) =       0.000514706587
  error estimate for blocks of size 2^( 4) =       0.000531139971
  error estimate for blocks of size 2^( 5) =       0.000540441964
  error estimate for blocks of size 2^( 6) =       0.000546212525
  error estimate for blocks of size 2^( 7) =       0.000547579072

      target function =      -0.746019545172
              le_mean =     -22.661473772516
             les_mean =     513.991517282783
             stat err =       0.000541343383
             autocorr =       1.335881210113
   target nu stat err =       0.000541343383
   target dn stat err =       0.002814682039
      target stat err =       0.002384392358
              std dev =       0.662374965473
             le_variance =       0.438740594886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438790683467
                                         uncertainty =       0.002053242780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438790683467
                                         uncertainty =       0.002053242780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468369830
  error estimate for blocks of size 2^( 2) =       0.000492758431
  error estimate for blocks of size 2^( 3) =       0.000514706587
  error estimate for blocks of size 2^( 4) =       0.000531139971
  error estimate for blocks of size 2^( 5) =       0.000540441964
  error estimate for blocks of size 2^( 6) =       0.000546212525
  error estimate for blocks of size 2^( 7) =       0.000547579072

      target function =      -0.746019545172
              le_mean =     -22.661473772516
             les_mean =     513.991517282783
             stat err =       0.000541343383
             autocorr =       1.335881210113
   target nu stat err =       0.000541343383
   target dn stat err =       0.002814682039
      target stat err =       0.002384392358
              std dev =       0.662374965473
             le_variance =       0.438740594886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438790683467
                                         uncertainty =       0.002053242780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438790683467
                                         uncertainty =       0.002053242780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468369830
  error estimate for blocks of size 2^( 2) =       0.000492758431
  error estimate for blocks of size 2^( 3) =       0.000514706587
  error estimate for blocks of size 2^( 4) =       0.000531139971
  error estimate for blocks of size 2^( 5) =       0.000540441964
  error estimate for blocks of size 2^( 6) =       0.000546212525
  error estimate for blocks of size 2^( 7) =       0.000547579072

      target function =      -0.746019545172
              le_mean =     -22.661473772516
             les_mean =     513.991517282783
             stat err =       0.000541343383
             autocorr =       1.335881210109
   target nu stat err =       0.000541343383
   target dn stat err =       0.002814682039
      target stat err =       0.002384392358
              std dev =       0.662374965474
             le_variance =       0.438740594886


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746019545172        initial  <--
     5.9605e+08     5.9605e+09             2.9819e-13        -0.746019545172
     2.3842e+09     2.3842e+10             7.4622e-14        -0.746019545172
     9.5367e+09     9.5367e+10             1.8592e-14        -0.746019545172

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4761
  </log>
  <optVariables href="FORM.s039.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5605e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.627
    reference variance = 0.238
====================================================
  Execution time = 2.6480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4550e-01
  Total weights = 1.955126642e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437012200322
                                         uncertainty =       0.001745321858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437012200322
                                         uncertainty =       0.001745321858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467426143
  error estimate for blocks of size 2^( 2) =       0.000491485071
  error estimate for blocks of size 2^( 3) =       0.000513949151
  error estimate for blocks of size 2^( 4) =       0.000529793215
  error estimate for blocks of size 2^( 5) =       0.000539471268
  error estimate for blocks of size 2^( 6) =       0.000544744843
  error estimate for blocks of size 2^( 7) =       0.000547374258

      target function =      -0.749019380910
              le_mean =     -22.662228170396
             les_mean =     514.022084801337
             stat err =       0.000540345896
             autocorr =       1.336342307897
   target nu stat err =       0.000540345896
   target dn stat err =       0.002501856959
      target stat err =       0.002155504450
              std dev =       0.661040390228
             le_variance =       0.436974397512


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266222817040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749024585115       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749024585115       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749024585115       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749024585115       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749024585115       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749033053082       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749029105422       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749023696780       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749036057642       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749016922505       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749015971312       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749028299658       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+09 is 2.873223e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749024585115       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749024585115       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749024585115       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749024585115       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749001099694       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749020091991       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749009719776       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749021012940       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749022636227       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748995475354       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749013118147       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748999904514       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748969887344       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749042969954       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749013159449       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749050763697       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749040786127       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748992920259       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748903768773       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748900644896       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749033800174       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749050957523       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750091038767       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747710040912       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.838164703538       residual = 8.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.977816030861       residual = 1.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.660160241782       residual = 9.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.750329249271       residual = 7.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -5.119091627930       residual = 7.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.948751133359       residual = 6.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   30 stopping due to too large eigenvalue change
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+10 is 7.183521e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749024585115       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749024585115       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749024585115       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749024585115       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749036237422       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748986796897       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749100312660       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749178563976       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748868582317       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749252508019       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749024585115       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748958321084       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749182203046       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748947804698       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749007719113       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747843222969       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.753438556039       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747249253860       residual = 7.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748833481599       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746787651957       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749782222445       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749499255867       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747485339618       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749879999820       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747758577071       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742407489517       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751134974197       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741899381598       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750493195738       residual = 6.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.753277584703       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.733525047316       residual = 4.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.301986146547       residual = 2.74e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -5.513991773557       residual = 1.10e+05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -6.776918064042       residual = 9.68e+05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       3.149083696904       residual = 1.42e+05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       3.899666633324       residual = 5.27e+05           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+10 is 1.817155e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383260 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1246e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6508
    reference variance = 0.566973
====================================================
  Execution time = 2.5734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5388e-01
  Total weights = 1.9550e+06
  Execution time = 3.6102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442634963548
                                         uncertainty =       0.002126010646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442634963548
                                         uncertainty =       0.002126010646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470403404
  error estimate for blocks of size 2^( 2) =       0.000494752186
  error estimate for blocks of size 2^( 3) =       0.000517113245
  error estimate for blocks of size 2^( 4) =       0.000532914955
  error estimate for blocks of size 2^( 5) =       0.000542544245
  error estimate for blocks of size 2^( 6) =       0.000547723941
  error estimate for blocks of size 2^( 7) =       0.000550827165

      target function =      -0.742145403524
              le_mean =     -22.662987262843
             les_mean =     514.064872451988
             stat err =       0.000543502576
             autocorr =       1.334941709403
   target nu stat err =       0.000543502576
   target dn stat err =       0.003185863337
      target stat err =       0.002659698883
              std dev =       0.665250873936
             le_variance =       0.442558725273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442634963548
                                         uncertainty =       0.002126010646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442634963548
                                         uncertainty =       0.002126010646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470403404
  error estimate for blocks of size 2^( 2) =       0.000494752186
  error estimate for blocks of size 2^( 3) =       0.000517113245
  error estimate for blocks of size 2^( 4) =       0.000532914955
  error estimate for blocks of size 2^( 5) =       0.000542544245
  error estimate for blocks of size 2^( 6) =       0.000547723941
  error estimate for blocks of size 2^( 7) =       0.000550827165

      target function =      -0.742145403524
              le_mean =     -22.662987262843
             les_mean =     514.064872451988
             stat err =       0.000543502576
             autocorr =       1.334941709400
   target nu stat err =       0.000543502576
   target dn stat err =       0.003185863337
      target stat err =       0.002659698883
              std dev =       0.665250873936
             le_variance =       0.442558725273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442634963548
                                         uncertainty =       0.002126010646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442634963548
                                         uncertainty =       0.002126010646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470403404
  error estimate for blocks of size 2^( 2) =       0.000494752186
  error estimate for blocks of size 2^( 3) =       0.000517113245
  error estimate for blocks of size 2^( 4) =       0.000532914955
  error estimate for blocks of size 2^( 5) =       0.000542544245
  error estimate for blocks of size 2^( 6) =       0.000547723941
  error estimate for blocks of size 2^( 7) =       0.000550827165

      target function =      -0.742145403524
              le_mean =     -22.662987262843
             les_mean =     514.064872451988
             stat err =       0.000543502576
             autocorr =       1.334941709397
   target nu stat err =       0.000543502576
   target dn stat err =       0.003185863337
      target stat err =       0.002659698883
              std dev =       0.665250873936
             le_variance =       0.442558725273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442634963548
                                         uncertainty =       0.002126010646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442634963548
                                         uncertainty =       0.002126010646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470403404
  error estimate for blocks of size 2^( 2) =       0.000494752186
  error estimate for blocks of size 2^( 3) =       0.000517113245
  error estimate for blocks of size 2^( 4) =       0.000532914955
  error estimate for blocks of size 2^( 5) =       0.000542544245
  error estimate for blocks of size 2^( 6) =       0.000547723941
  error estimate for blocks of size 2^( 7) =       0.000550827165

      target function =      -0.742145403524
              le_mean =     -22.662987262843
             les_mean =     514.064872451988
             stat err =       0.000543502576
             autocorr =       1.334941709404
   target nu stat err =       0.000543502576
   target dn stat err =       0.003185863337
      target stat err =       0.002659698883
              std dev =       0.665250873936
             le_variance =       0.442558725273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742145403524        initial
     5.9605e+09     5.9605e+10             2.8732e-14        -0.742145403524  <--
     2.3842e+10     2.3842e+11             7.1835e-15        -0.742145403524
     9.5367e+10     9.5367e+11             1.8172e-15        -0.742145403524

*****************************************************************************
Applying the update for shift_i =   5.9605e+09     and shift_s =   5.9605e+10
*****************************************************************************

  Execution time = 4.3913e+01
  </log>
  <optVariables href="FORM.s040.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.5484
    reference variance = 1.42665
====================================================
  Execution time = 2.6378e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5232e-01
  Total weights = 1.955086418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441524302019
                                         uncertainty =       0.002254267315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441524302019
                                         uncertainty =       0.002254267315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469835195
  error estimate for blocks of size 2^( 2) =       0.000493994174
  error estimate for blocks of size 2^( 3) =       0.000516027988
  error estimate for blocks of size 2^( 4) =       0.000532314843
  error estimate for blocks of size 2^( 5) =       0.000540327482
  error estimate for blocks of size 2^( 6) =       0.000546008410
  error estimate for blocks of size 2^( 7) =       0.000547019577

      target function =      -0.743413183852
              le_mean =     -22.662311209597
             les_mean =     514.032670673474
             stat err =       0.000541417578
             autocorr =       1.327925195217
   target nu stat err =       0.000541417578
   target dn stat err =       0.002829864915
      target stat err =       0.002383216541
              std dev =       0.664447304617
             le_variance =       0.441490220613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266231120960e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743419882773       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743419882773       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743419882773       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743419882773       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743419882763       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743420146440       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743420462603       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743416352204       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743416806372       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743418573269       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743421034915       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743411673424       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+09 is 1.152676e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743419882773       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743419882773       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743419882773       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743419882773       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743419882767       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743419882932       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743419234794       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743406429569       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743423159349       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743416774692       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743408737051       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743419562027       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+09 is 2.879012e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743419882773       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743419882773       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743419882773       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743419882772       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743419882734       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743430378870       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743406860379       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743371371266       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743481502150       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743431555552       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743423928785       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743415803208       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743362482523       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743488705642       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743412659363       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743442321980       residual = 6.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743322390101       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743423395651       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743435076544       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743422502183       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743311301240       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743441182508       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743415207161       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743444473701       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743603305527       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744408848064       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741164878822       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.808308467202       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.849345399109       residual = 2.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.698816654207       residual = 2.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.756074032066       residual = 6.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.754694694728       residual = 1.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.672004726130       residual = 2.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.497279563375       residual = 4.63e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.195232277987       residual = 8.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.016357806353       residual = 5.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.994681106250       residual = 1.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.590960235342       residual = 4.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -7.583498697765       residual = 9.44e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.126239276095       residual = 8.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+10 is 7.214378e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.412638 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1123e+01
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7194
    reference variance = 0.306579
====================================================
  Execution time = 2.5885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4944e-01
  Total weights = 1.9552e+06
  Execution time = 3.6105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439886614643
                                         uncertainty =       0.002225084005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439886614643
                                         uncertainty =       0.002225084005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469093127
  error estimate for blocks of size 2^( 2) =       0.000493097922
  error estimate for blocks of size 2^( 3) =       0.000515194159
  error estimate for blocks of size 2^( 4) =       0.000531209826
  error estimate for blocks of size 2^( 5) =       0.000539512226
  error estimate for blocks of size 2^( 6) =       0.000546017705
  error estimate for blocks of size 2^( 7) =       0.000547249192

      target function =      -0.745762319717
              le_mean =     -22.661402756727
             les_mean =     513.988610583000
             stat err =       0.000540997237
             autocorr =       1.330062212109
   target nu stat err =       0.000540997237
   target dn stat err =       0.002929925002
      target stat err =       0.002474039385
              std dev =       0.663397861975
             le_variance =       0.440096723273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439886614643
                                         uncertainty =       0.002225084005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439886614643
                                         uncertainty =       0.002225084005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469093127
  error estimate for blocks of size 2^( 2) =       0.000493097922
  error estimate for blocks of size 2^( 3) =       0.000515194159
  error estimate for blocks of size 2^( 4) =       0.000531209826
  error estimate for blocks of size 2^( 5) =       0.000539512226
  error estimate for blocks of size 2^( 6) =       0.000546017705
  error estimate for blocks of size 2^( 7) =       0.000547249192

      target function =      -0.745762319717
              le_mean =     -22.661402756727
             les_mean =     513.988610583001
             stat err =       0.000540997237
             autocorr =       1.330062212112
   target nu stat err =       0.000540997237
   target dn stat err =       0.002929925002
      target stat err =       0.002474039385
              std dev =       0.663397861975
             le_variance =       0.440096723273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439886614643
                                         uncertainty =       0.002225084005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439886614643
                                         uncertainty =       0.002225084005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469093127
  error estimate for blocks of size 2^( 2) =       0.000493097922
  error estimate for blocks of size 2^( 3) =       0.000515194159
  error estimate for blocks of size 2^( 4) =       0.000531209826
  error estimate for blocks of size 2^( 5) =       0.000539512226
  error estimate for blocks of size 2^( 6) =       0.000546017705
  error estimate for blocks of size 2^( 7) =       0.000547249192

      target function =      -0.745762319717
              le_mean =     -22.661402756727
             les_mean =     513.988610583001
             stat err =       0.000540997237
             autocorr =       1.330062212107
   target nu stat err =       0.000540997237
   target dn stat err =       0.002929925002
      target stat err =       0.002474039385
              std dev =       0.663397861975
             le_variance =       0.440096723273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439886614643
                                         uncertainty =       0.002225084005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439886614643
                                         uncertainty =       0.002225084005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469093127
  error estimate for blocks of size 2^( 2) =       0.000493097922
  error estimate for blocks of size 2^( 3) =       0.000515194159
  error estimate for blocks of size 2^( 4) =       0.000531209826
  error estimate for blocks of size 2^( 5) =       0.000539512226
  error estimate for blocks of size 2^( 6) =       0.000546017705
  error estimate for blocks of size 2^( 7) =       0.000547249192

      target function =      -0.745762319717
              le_mean =     -22.661402756727
             les_mean =     513.988610583000
             stat err =       0.000540997237
             autocorr =       1.330062212109
   target nu stat err =       0.000540997237
   target dn stat err =       0.002929925002
      target stat err =       0.002474039385
              std dev =       0.663397861975
             le_variance =       0.440096723273


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745762319717        initial  <--
     1.4901e+09     1.4901e+10             1.1527e-13        -0.745762319717
     5.9605e+09     5.9605e+10             2.8790e-14        -0.745762319717
     2.3842e+10     2.3842e+11             7.2144e-15        -0.745762319717

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.3526
  </log>
  <optVariables href="FORM.s041.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7226
    reference variance = 0.420391
====================================================
  Execution time = 2.6453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4715e-01
  Total weights = 1.954499177e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437134548816
                                         uncertainty =       0.002223279644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437134548816
                                         uncertainty =       0.002223279644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467467162
  error estimate for blocks of size 2^( 2) =       0.000491436267
  error estimate for blocks of size 2^( 3) =       0.000513297182
  error estimate for blocks of size 2^( 4) =       0.000529137020
  error estimate for blocks of size 2^( 5) =       0.000538260765
  error estimate for blocks of size 2^( 6) =       0.000542950498
  error estimate for blocks of size 2^( 7) =       0.000546069674

      target function =      -0.747646002871
              le_mean =     -22.661885356618
             les_mean =     514.008202172552
             stat err =       0.000539104489
             autocorr =       1.329975621739
   target nu stat err =       0.000539104489
   target dn stat err =       0.002608446744
      target stat err =       0.002231013235
              std dev =       0.661098399812
             le_variance =       0.437051094234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266188535662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747651766847       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747651766847       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747651766847       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747653799435       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747660991887       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747652465045       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747651915712       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747692151809       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747663894091       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747631459432       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747643547473       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747635950036       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747657267190       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747667708579       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747680076752       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747699380457       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747636094484       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747585771966       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747638637573       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747656126523       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747652182109       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747712307170       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747634230476       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747652999191       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747644997760       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747694306723       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747730241730       residual = 5.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747619926191       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747607618676       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747643262414       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747688853601       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747633823180       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.748017933804       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.751457545322       residual = 2.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.745533766080       residual = 8.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.629096990570       residual = 4.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.663694062112       residual = 6.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.748048580178       residual = 1.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       0.808358751154       residual = 2.20e+04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -3.932224993410       residual = 3.09e+05           smallest_sin_value = 1.00e+00
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+10 is 2.658896e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747651766847       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747651766847       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747651766847       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747650102744       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747619799742       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747684253566       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747652000574       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747782035780       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747583663095       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747695489585       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747634007150       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747655706067       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747621080464       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747633412198       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747601933769       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747747687675       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747687316312       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747620554196       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747650205368       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747678615354       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747727187254       residual = 6.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748777636401       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747473401568       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748580977096       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745226600093       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746997284192       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742482840663       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746436606565       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745506306097       residual = 2.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.756552655184       residual = 1.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747909380348       residual = 6.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740881537805       residual = 4.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.702366960517       residual = 3.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -6.419427804035       residual = 9.97e+05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.853726004441       residual = 5.93e+05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.122973078346       residual = 2.14e+05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       6.602271760200       residual = 7.83e+06           smallest_sin_value = 1.00e+00
davidson iteration   37 stopping due to too large eigenvalue change
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+10 is 6.640504e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747651766847       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747651766847       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747651766847       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747652000296       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747651766855       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747733606503       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747743186687       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747820358166       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747605564409       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747873054922       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747691391049       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748736798410       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747592496469       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747515274410       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747384560201       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747686227454       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747766461097       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747605582229       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747617470817       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746956889281       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747232018722       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747548643176       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747386015250       residual = 8.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748052425926       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747967524325       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749053817161       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747597741214       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747799237860       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747236445821       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744463814738       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747388972695       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.747684130991       residual = 4.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747796293835       residual = 6.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.759743543110       residual = 9.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.771959960498       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.741055362140       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.736778462882       residual = 2.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.675200736438       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.276706294222       residual = 5.61e+02           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.689543762587       residual = 1.02e+03           smallest_sin_value = 9.97e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+11 is 1.673391e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.484121 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1298e+01
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7526
    reference variance = 0.277551
====================================================
  Execution time = 2.5683e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5052e-01
  Total weights = 1.9553e+06
  Execution time = 3.6043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440046819364
                                         uncertainty =       0.002194807510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440046819364
                                         uncertainty =       0.002194807510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469292366
  error estimate for blocks of size 2^( 2) =       0.000493348557
  error estimate for blocks of size 2^( 3) =       0.000515652698
  error estimate for blocks of size 2^( 4) =       0.000532345782
  error estimate for blocks of size 2^( 5) =       0.000542546733
  error estimate for blocks of size 2^( 6) =       0.000548765641
  error estimate for blocks of size 2^( 7) =       0.000550420909

      target function =      -0.744874626643
              le_mean =     -22.661787081289
             les_mean =     514.007117543806
             stat err =       0.000543519766
             autocorr =       1.341354919322
   target nu stat err =       0.000543519766
   target dn stat err =       0.003161534162
      target stat err =       0.002654668214
              std dev =       0.663679628720
             le_variance =       0.440470649578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440046819364
                                         uncertainty =       0.002194807510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440046819364
                                         uncertainty =       0.002194807510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469292366
  error estimate for blocks of size 2^( 2) =       0.000493348557
  error estimate for blocks of size 2^( 3) =       0.000515652698
  error estimate for blocks of size 2^( 4) =       0.000532345782
  error estimate for blocks of size 2^( 5) =       0.000542546733
  error estimate for blocks of size 2^( 6) =       0.000548765641
  error estimate for blocks of size 2^( 7) =       0.000550420909

      target function =      -0.744874626643
              le_mean =     -22.661787081289
             les_mean =     514.007117543806
             stat err =       0.000543519766
             autocorr =       1.341354919321
   target nu stat err =       0.000543519766
   target dn stat err =       0.003161534162
      target stat err =       0.002654668214
              std dev =       0.663679628720
             le_variance =       0.440470649577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440046819364
                                         uncertainty =       0.002194807510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440046819364
                                         uncertainty =       0.002194807510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469292366
  error estimate for blocks of size 2^( 2) =       0.000493348557
  error estimate for blocks of size 2^( 3) =       0.000515652698
  error estimate for blocks of size 2^( 4) =       0.000532345782
  error estimate for blocks of size 2^( 5) =       0.000542546733
  error estimate for blocks of size 2^( 6) =       0.000548765641
  error estimate for blocks of size 2^( 7) =       0.000550420909

      target function =      -0.744874626643
              le_mean =     -22.661787081289
             les_mean =     514.007117543806
             stat err =       0.000543519766
             autocorr =       1.341354919323
   target nu stat err =       0.000543519766
   target dn stat err =       0.003161534162
      target stat err =       0.002654668214
              std dev =       0.663679628720
             le_variance =       0.440470649578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440046819364
                                         uncertainty =       0.002194807510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440046819364
                                         uncertainty =       0.002194807510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469292366
  error estimate for blocks of size 2^( 2) =       0.000493348557
  error estimate for blocks of size 2^( 3) =       0.000515652698
  error estimate for blocks of size 2^( 4) =       0.000532345782
  error estimate for blocks of size 2^( 5) =       0.000542546733
  error estimate for blocks of size 2^( 6) =       0.000548765641
  error estimate for blocks of size 2^( 7) =       0.000550420909

      target function =      -0.744874626643
              le_mean =     -22.661787081289
             les_mean =     514.007117543806
             stat err =       0.000543519766
             autocorr =       1.341354919322
   target nu stat err =       0.000543519766
   target dn stat err =       0.003161534162
      target stat err =       0.002654668214
              std dev =       0.663679628720
             le_variance =       0.440470649578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744874626643        initial  <--
     1.4901e+10     1.4901e+11             2.6589e-14        -0.744874626643
     5.9605e+10     5.9605e+11             6.6405e-15        -0.744874626643
     2.3842e+11     2.3842e+12             1.6734e-15        -0.744874626643

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8204
  </log>
  <optVariables href="FORM.s042.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5126e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.8331
    reference variance = 0.475863
====================================================
  Execution time = 2.6314e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4617e-01
  Total weights = 1.955177829e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437379964657
                                         uncertainty =       0.001666896972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437379964657
                                         uncertainty =       0.001666896972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467641522
  error estimate for blocks of size 2^( 2) =       0.000491500281
  error estimate for blocks of size 2^( 3) =       0.000514009587
  error estimate for blocks of size 2^( 4) =       0.000529634992
  error estimate for blocks of size 2^( 5) =       0.000540153392
  error estimate for blocks of size 2^( 6) =       0.000545318087
  error estimate for blocks of size 2^( 7) =       0.000549141603

      target function =      -0.748450328090
              le_mean =     -22.661185934007
             les_mean =     513.975514802891
             stat err =       0.000541062019
             autocorr =       1.338652850715
   target nu stat err =       0.000541062019
   target dn stat err =       0.002305124869
      target stat err =       0.001993794171
              std dev =       0.661344982141
             le_variance =       0.437377185403


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266118593401e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748454674155       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748454674155       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748454674155       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748454674153       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748446047018       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748501952763       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748465615923       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748364971955       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748684304835       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748575394675       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748163452424       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748406037885       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748412941395       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748536889905       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748376898755       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748427305393       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748456372311       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.757117719269       residual = 3.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746098798815       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.770325491630       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.765317024256       residual = 1.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.513146946566       residual = 8.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       0.087092800063       residual = 8.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       3.964215845721       residual = 3.44e+05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -4.368742510436       residual = 1.78e+05           smallest_sin_value = 1.00e+00
davidson iteration   25 stopping due to too large eigenvalue change
davidson solver did not converge after         25 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+11 is 1.137212e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748454674155       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748454674155       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748454674155       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748454674155       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748454674155       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748454674155       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748391869115       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748747722976       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747679329632       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748498606104       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749263676154       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749166745863       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748099282078       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747918788957       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747515647931       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749190830247       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747992752693       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748112531329       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750325619024       residual = 2.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.761193179051       residual = 2.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.868814802280       residual = 3.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.708404212970       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.867237054917       residual = 9.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.824702057758       residual = 2.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.426993639437       residual = 7.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.640364255641       residual = 2.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.791961873625       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.325199503122       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.656668092436       residual = 7.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.802837554382       residual = 1.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.164142306320       residual = 8.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.538363073588       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.754192792499       residual = 2.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -6.206933753566       residual = 7.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.534555945229       residual = 9.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   35 stopping due to too large eigenvalue change
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+11 is 2.884508e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748454674155       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748454674155       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748454674155       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748454674155       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748454674120       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748803487844       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748453459973       residual = 9.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749016010465       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743331659207       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738198048867       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.752929463425       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749682043771       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746640933327       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.754072003126       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747589749070       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747051860890       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749361478219       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747137996737       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.757414194469       residual = 2.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.768015150097       residual = 2.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.713646744708       residual = 6.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.755568783678       residual = 7.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.310721637212       residual = 7.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.978949444319       residual = 4.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       6.048230746141       residual = 3.88e+04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.658919165926       residual = 1.81e+04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -9.327658951880       residual = 7.00e+05           smallest_sin_value = 1.00e+00
davidson iteration   27 stopping due to too large eigenvalue change
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+12 is 7.648638e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.518632 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1115e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.577
    reference variance = 0.437438
====================================================
  Execution time = 2.6023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5839e-01
  Total weights = 1.9553e+06
  Execution time = 4.1491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985233591
                                         uncertainty =       0.002710579256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985233591
                                         uncertainty =       0.002710579256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469551313
  error estimate for blocks of size 2^( 2) =       0.000493424017
  error estimate for blocks of size 2^( 3) =       0.000515525148
  error estimate for blocks of size 2^( 4) =       0.000531452376
  error estimate for blocks of size 2^( 5) =       0.000539288895
  error estimate for blocks of size 2^( 6) =       0.000544884150
  error estimate for blocks of size 2^( 7) =       0.000547514379

      target function =      -0.738440330976
              le_mean =     -22.661645298574
             les_mean =     514.008554994187
             stat err =       0.000540784950
             autocorr =       1.326426146789
   target nu stat err =       0.000540784950
   target dn stat err =       0.008546292323
      target stat err =       0.006896289725
              std dev =       0.664045835683
             le_variance =       0.440956871888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985233591
                                         uncertainty =       0.002710579256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985233591
                                         uncertainty =       0.002710579256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469551313
  error estimate for blocks of size 2^( 2) =       0.000493424017
  error estimate for blocks of size 2^( 3) =       0.000515525148
  error estimate for blocks of size 2^( 4) =       0.000531452376
  error estimate for blocks of size 2^( 5) =       0.000539288895
  error estimate for blocks of size 2^( 6) =       0.000544884150
  error estimate for blocks of size 2^( 7) =       0.000547514379

      target function =      -0.738440330976
              le_mean =     -22.661645298574
             les_mean =     514.008554994187
             stat err =       0.000540784950
             autocorr =       1.326426146790
   target nu stat err =       0.000540784950
   target dn stat err =       0.008546292323
      target stat err =       0.006896289725
              std dev =       0.664045835683
             le_variance =       0.440956871888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985233591
                                         uncertainty =       0.002710579256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985233591
                                         uncertainty =       0.002710579256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469551313
  error estimate for blocks of size 2^( 2) =       0.000493424017
  error estimate for blocks of size 2^( 3) =       0.000515525148
  error estimate for blocks of size 2^( 4) =       0.000531452376
  error estimate for blocks of size 2^( 5) =       0.000539288895
  error estimate for blocks of size 2^( 6) =       0.000544884150
  error estimate for blocks of size 2^( 7) =       0.000547514379

      target function =      -0.738440330976
              le_mean =     -22.661645298574
             les_mean =     514.008554994187
             stat err =       0.000540784950
             autocorr =       1.326426146792
   target nu stat err =       0.000540784950
   target dn stat err =       0.008546292323
      target stat err =       0.006896289725
              std dev =       0.664045835683
             le_variance =       0.440956871888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985233591
                                         uncertainty =       0.002710579256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440985233591
                                         uncertainty =       0.002710579256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469551313
  error estimate for blocks of size 2^( 2) =       0.000493424017
  error estimate for blocks of size 2^( 3) =       0.000515525148
  error estimate for blocks of size 2^( 4) =       0.000531452376
  error estimate for blocks of size 2^( 5) =       0.000539288895
  error estimate for blocks of size 2^( 6) =       0.000544884150
  error estimate for blocks of size 2^( 7) =       0.000547514379

      target function =      -0.738440330976
              le_mean =     -22.661645298574
             les_mean =     514.008554994187
             stat err =       0.000540784950
             autocorr =       1.326426146789
   target nu stat err =       0.000540784950
   target dn stat err =       0.008546292323
      target stat err =       0.006896289725
              std dev =       0.664045835683
             le_variance =       0.440956871888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738440330976        initial
     1.4901e+11     1.4901e+12             1.1372e-15        -0.738440330976
     5.9605e+11     5.9605e+12             2.8845e-16        -0.738440330976
     2.3842e+12     2.3842e+13             7.6486e-17        -0.738440330976  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e+12     and shift_s =   2.3842e+13
*****************************************************************************

  Execution time = 4.4633e+01
  </log>
  <optVariables href="FORM.s043.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7407
    reference variance = 0.32245
====================================================
  Execution time = 2.6541e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4907e-01
  Total weights = 1.955361764e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440495493287
                                         uncertainty =       0.002212713034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440495493287
                                         uncertainty =       0.002212713034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469295863
  error estimate for blocks of size 2^( 2) =       0.000493257534
  error estimate for blocks of size 2^( 3) =       0.000515433293
  error estimate for blocks of size 2^( 4) =       0.000530718301
  error estimate for blocks of size 2^( 5) =       0.000539403440
  error estimate for blocks of size 2^( 6) =       0.000544988550
  error estimate for blocks of size 2^( 7) =       0.000546045471

      target function =      -0.746065587654
              le_mean =     -22.661763645789
             les_mean =     514.004604953221
             stat err =       0.000540288940
             autocorr =       1.325435822816
   target nu stat err =       0.000540288940
   target dn stat err =       0.002644342722
      target stat err =       0.002250277030
              std dev =       0.663684573757
             le_variance =       0.440477213444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266176364579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746071383256       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746071383256       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746071383256       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746071383256       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746071383256       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746431868916       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745737353297       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745839266531       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746188705686       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747889459510       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745261021406       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745825571979       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746143094194       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746076720052       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745371047417       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745814011165       residual = 7.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745864432814       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746526233896       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745300270272       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747879967477       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744491195867       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746933432382       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748152344382       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742934442400       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748732841568       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745669694593       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743772746062       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.748791929417       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739694134979       residual = 6.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.734904052447       residual = 6.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.711531220792       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.726600769251       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.683574273046       residual = 1.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.804682878999       residual = 1.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.693938797652       residual = 9.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.610928230131       residual = 5.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.826680797919       residual = 5.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.534048405446       residual = 1.77e+01           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.714890177430       residual = 1.28e+00           smallest_sin_value = 9.97e-01
davidson iteration   39 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+11 is 2.662837e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746071383256       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746071383256       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746071383256       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746933901910       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746071383256       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746071383256       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744918826496       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744701995085       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749062613979       residual = 5.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752850297415       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739792642182       residual = 7.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747294129724       residual = 7.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745133795016       residual = 8.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745681910503       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746860466360       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746439276549       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747417390159       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.774699344341       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745588732184       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744283351044       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744325559714       residual = 9.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748681255637       residual = 8.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746328373987       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.775859677294       residual = 3.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.718030487436       residual = 5.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.733153071156       residual = 5.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.750077850509       residual = 8.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.728976924584       residual = 1.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.630368059542       residual = 3.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751441406566       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.719316675748       residual = 4.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.635963075344       residual = 4.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749081302631       residual = 2.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       0.408324548376       residual = 3.74e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.531855498776       residual = 8.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       1.043913788109       residual = 9.54e+03           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+12 is 6.738478e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746071383256       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746071383256       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 8.88e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.561610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1350e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7063
    reference variance = 0.402721
====================================================
  Execution time = 2.5502e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5102e-01
  Total weights = 1.9552e+06
  Execution time = 3.5944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440201771282
                                         uncertainty =       0.002324994965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440201771282
                                         uncertainty =       0.002324994965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469156040
  error estimate for blocks of size 2^( 2) =       0.000493566336
  error estimate for blocks of size 2^( 3) =       0.000516019558
  error estimate for blocks of size 2^( 4) =       0.000532132000
  error estimate for blocks of size 2^( 5) =       0.000542256700
  error estimate for blocks of size 2^( 6) =       0.000545695805
  error estimate for blocks of size 2^( 7) =       0.000547355818

      target function =      -0.744460446743
              le_mean =     -22.661405116203
             les_mean =     513.990305184969
             stat err =       0.000541860081
             autocorr =       1.333950430970
   target nu stat err =       0.000541860081
   target dn stat err =       0.003418801990
      target stat err =       0.002855063918
              std dev =       0.663486834110
             le_variance =       0.440214779037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440201771282
                                         uncertainty =       0.002324994965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440201771282
                                         uncertainty =       0.002324994965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469156040
  error estimate for blocks of size 2^( 2) =       0.000493566336
  error estimate for blocks of size 2^( 3) =       0.000516019558
  error estimate for blocks of size 2^( 4) =       0.000532132000
  error estimate for blocks of size 2^( 5) =       0.000542256700
  error estimate for blocks of size 2^( 6) =       0.000545695805
  error estimate for blocks of size 2^( 7) =       0.000547355818

      target function =      -0.744460446743
              le_mean =     -22.661405116203
             les_mean =     513.990305184969
             stat err =       0.000541860081
             autocorr =       1.333950430969
   target nu stat err =       0.000541860081
   target dn stat err =       0.003418801990
      target stat err =       0.002855063918
              std dev =       0.663486834110
             le_variance =       0.440214779037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440201771282
                                         uncertainty =       0.002324994965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440201771282
                                         uncertainty =       0.002324994965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469156040
  error estimate for blocks of size 2^( 2) =       0.000493566336
  error estimate for blocks of size 2^( 3) =       0.000516019558
  error estimate for blocks of size 2^( 4) =       0.000532132000
  error estimate for blocks of size 2^( 5) =       0.000542256700
  error estimate for blocks of size 2^( 6) =       0.000545695805
  error estimate for blocks of size 2^( 7) =       0.000547355818

      target function =      -0.744460446743
              le_mean =     -22.661405116203
             les_mean =     513.990305184969
             stat err =       0.000541860081
             autocorr =       1.333950430968
   target nu stat err =       0.000541860081
   target dn stat err =       0.003418801990
      target stat err =       0.002855063918
              std dev =       0.663486834110
             le_variance =       0.440214779037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440201771282
                                         uncertainty =       0.002324994965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440201771282
                                         uncertainty =       0.002324994965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469156040
  error estimate for blocks of size 2^( 2) =       0.000493566336
  error estimate for blocks of size 2^( 3) =       0.000516019558
  error estimate for blocks of size 2^( 4) =       0.000532132000
  error estimate for blocks of size 2^( 5) =       0.000542256700
  error estimate for blocks of size 2^( 6) =       0.000545695805
  error estimate for blocks of size 2^( 7) =       0.000547355818

      target function =      -0.744460446743
              le_mean =     -22.661405116203
             les_mean =     513.990305184969
             stat err =       0.000541860081
             autocorr =       1.333950430970
   target nu stat err =       0.000541860081
   target dn stat err =       0.003418801990
      target stat err =       0.002855063918
              std dev =       0.663486834110
             le_variance =       0.440214779037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744460446743        initial
     5.9605e+11     5.9605e+12             2.6628e-16        -0.744460446743  <--
     2.3842e+12     2.3842e+13             6.7385e-17        -0.744460446743
     9.5367e+12     9.5367e+13             0.0000e+00        -0.744460446743

*****************************************************************************
Applying the update for shift_i =   5.9605e+11     and shift_s =   5.9605e+12
*****************************************************************************

  Execution time = 4.3580e+01
  </log>
  <optVariables href="FORM.s044.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4936e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6706
    reference variance = 0.340245
====================================================
  Execution time = 2.6290e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5237e-01
  Total weights = 1.955261433e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443196331434
                                         uncertainty =       0.002552125529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443196331434
                                         uncertainty =       0.002552125529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470726978
  error estimate for blocks of size 2^( 2) =       0.000494715797
  error estimate for blocks of size 2^( 3) =       0.000516586444
  error estimate for blocks of size 2^( 4) =       0.000532622638
  error estimate for blocks of size 2^( 5) =       0.000542422217
  error estimate for blocks of size 2^( 6) =       0.000547072428
  error estimate for blocks of size 2^( 7) =       0.000549675590

      target function =      -0.743368803212
              le_mean =     -22.662267009814
             les_mean =     514.030720431273
             stat err =       0.000542948218
             autocorr =       1.330389000766
   target nu stat err =       0.000542948218
   target dn stat err =       0.002952125385
      target stat err =       0.002479864512
              std dev =       0.665708476968
             le_variance =       0.443167776307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266226700981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743376218681       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743376218681       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743376218681       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743376218681       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743399163300       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743430879360       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743240932101       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743615884515       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743027543832       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743321983212       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743318300486       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743663532768       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743473116734       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743702772612       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742925995759       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743258404103       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.728914246166       residual = 3.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741293995516       residual = 4.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741899678190       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748731321799       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.800198076493       residual = 5.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.787629180377       residual = 4.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.829257706016       residual = 1.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.530176249681       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       0.652634916534       residual = 3.03e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.387912656850       residual = 1.16e+04           smallest_sin_value = 1.00e+00
davidson iteration   26 stopping due to too large eigenvalue change
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+11 is 1.139172e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743376218681       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743376218681       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743376218681       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743376218682       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743360189941       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743376218681       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743381966208       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743704233662       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743026558127       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742733313929       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744324040111       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743398418926       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742613653748       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741822822774       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742970753867       residual = 7.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742826254054       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743720454363       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743792500858       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739936279717       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744107862928       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744874790210       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741404160980       residual = 4.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.752677549200       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741077548075       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747914630435       residual = 4.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744040703985       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747748017466       residual = 9.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.757967574495       residual = 3.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.888822402027       residual = 6.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.455896290521       residual = 5.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -2.632509785682       residual = 1.72e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.637445953574       residual = 1.02e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.020171778509       residual = 4.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.750056659552       residual = 8.17e+04           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+11 is 2.885734e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743376218681       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743376218681       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743376218681       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743371819644       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744283583081       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744761375456       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741956586994       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743558752256       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740643249400       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741286970345       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740587142724       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741686451424       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742744938920       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743719184183       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745194441400       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750405913102       residual = 6.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.780380329758       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.723946673515       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736622681004       residual = 3.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.820623681747       residual = 6.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.791789867647       residual = 4.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740442123188       residual = 6.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.833473806080       residual = 2.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.144850497708       residual = 2.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.993485563173       residual = 3.89e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.999448995880       residual = 5.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       3.134524356861       residual = 2.59e+04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       0.186332095768       residual = 4.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.735738606731       residual = 6.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.272068033807       residual = 1.26e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       6.877511632215       residual = 5.46e+05           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+12 is 5.921221e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.598545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1024e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6237
    reference variance = 0.260437
====================================================
  Execution time = 2.5779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5741e-01
  Total weights = 1.9548e+06
  Execution time = 3.5931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441690920850
                                         uncertainty =       0.002979197670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441690920850
                                         uncertainty =       0.002979197670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922108
  error estimate for blocks of size 2^( 2) =       0.000494135139
  error estimate for blocks of size 2^( 3) =       0.000515925744
  error estimate for blocks of size 2^( 4) =       0.000532696052
  error estimate for blocks of size 2^( 5) =       0.000542771654
  error estimate for blocks of size 2^( 6) =       0.000546795593
  error estimate for blocks of size 2^( 7) =       0.000549808785

      target function =      -0.739266876393
              le_mean =     -22.661537241668
             les_mean =     514.002676404454
             stat err =       0.000543018021
             autocorr =       1.335293488765
   target nu stat err =       0.000543018021
   target dn stat err =       0.005535840483
      target stat err =       0.004498866451
              std dev =       0.664570217985
             le_variance =       0.441653574633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441690920850
                                         uncertainty =       0.002979197670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441690920850
                                         uncertainty =       0.002979197670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922108
  error estimate for blocks of size 2^( 2) =       0.000494135139
  error estimate for blocks of size 2^( 3) =       0.000515925744
  error estimate for blocks of size 2^( 4) =       0.000532696052
  error estimate for blocks of size 2^( 5) =       0.000542771654
  error estimate for blocks of size 2^( 6) =       0.000546795593
  error estimate for blocks of size 2^( 7) =       0.000549808785

      target function =      -0.739266876393
              le_mean =     -22.661537241668
             les_mean =     514.002676404454
             stat err =       0.000543018021
             autocorr =       1.335293488764
   target nu stat err =       0.000543018021
   target dn stat err =       0.005535840483
      target stat err =       0.004498866451
              std dev =       0.664570217985
             le_variance =       0.441653574633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441690920850
                                         uncertainty =       0.002979197670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441690920850
                                         uncertainty =       0.002979197670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922108
  error estimate for blocks of size 2^( 2) =       0.000494135139
  error estimate for blocks of size 2^( 3) =       0.000515925744
  error estimate for blocks of size 2^( 4) =       0.000532696052
  error estimate for blocks of size 2^( 5) =       0.000542771654
  error estimate for blocks of size 2^( 6) =       0.000546795593
  error estimate for blocks of size 2^( 7) =       0.000549808785

      target function =      -0.739266876393
              le_mean =     -22.661537241668
             les_mean =     514.002676404454
             stat err =       0.000543018021
             autocorr =       1.335293488764
   target nu stat err =       0.000543018021
   target dn stat err =       0.005535840483
      target stat err =       0.004498866451
              std dev =       0.664570217985
             le_variance =       0.441653574633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441690920850
                                         uncertainty =       0.002979197670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441690920850
                                         uncertainty =       0.002979197670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922108
  error estimate for blocks of size 2^( 2) =       0.000494135139
  error estimate for blocks of size 2^( 3) =       0.000515925744
  error estimate for blocks of size 2^( 4) =       0.000532696052
  error estimate for blocks of size 2^( 5) =       0.000542771654
  error estimate for blocks of size 2^( 6) =       0.000546795593
  error estimate for blocks of size 2^( 7) =       0.000549808785

      target function =      -0.739266876393
              le_mean =     -22.661537241668
             les_mean =     514.002676404454
             stat err =       0.000543018021
             autocorr =       1.335293488764
   target nu stat err =       0.000543018021
   target dn stat err =       0.005535840483
      target stat err =       0.004498866451
              std dev =       0.664570217985
             le_variance =       0.441653574633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739266876393        initial
     1.4901e+11     1.4901e+12             1.1392e-15        -0.739266876393
     5.9605e+11     5.9605e+12             2.8857e-16        -0.739266876393  <--
     2.3842e+12     2.3842e+13             5.9212e-17        -0.739266876393

*****************************************************************************
Applying the update for shift_i =   5.9605e+11     and shift_s =   5.9605e+12
*****************************************************************************

  Execution time = 4.7685e+01
  </log>
  <optVariables href="FORM.s045.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8721e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.7401
    reference variance = 0.841853
====================================================
  Execution time = 2.6391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4349e-01
  Total weights = 1.955236427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435270492318
                                         uncertainty =       0.001834242382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435270492318
                                         uncertainty =       0.001834242382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466546481
  error estimate for blocks of size 2^( 2) =       0.000490553593
  error estimate for blocks of size 2^( 3) =       0.000512433644
  error estimate for blocks of size 2^( 4) =       0.000528378429
  error estimate for blocks of size 2^( 5) =       0.000539804737
  error estimate for blocks of size 2^( 6) =       0.000544001629
  error estimate for blocks of size 2^( 7) =       0.000549108176

      target function =      -0.750681912996
              le_mean =     -22.661839128070
             les_mean =     514.002438964200
             stat err =       0.000540323243
             autocorr =       1.341273866568
   target nu stat err =       0.000540323243
   target dn stat err =       0.002454547752
      target stat err =       0.002125711473
              std dev =       0.659796361226
             le_variance =       0.435331238287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266183912807e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750686956896       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750686956896       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750686956896       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750692627571       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750686956863       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750686956896       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750655996962       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750438546044       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751181349890       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750642792864       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750864855079       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750374355469       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750518257743       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750692192793       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750627916101       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750789302349       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750984488492       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751490468231       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749379952690       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749555383968       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749256476192       residual = 5.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.910600054340       residual = 7.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.755159993972       residual = 1.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.756581914933       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -2.466212278017       residual = 2.61e+05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.220045358196       residual = 4.45e+04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.915395719680       residual = 1.94e+05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.471146634004       residual = 2.71e+04           smallest_sin_value = 1.00e+00
davidson iteration   28 stopping due to too large eigenvalue change
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+11 is 1.384092e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750686956896       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750686956896       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750686956896       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.750686956896       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.750686956916       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750686859271       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750176953310       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750740514714       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752273626577       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.750380955304       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750516971270       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751369161198       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749449123597       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750071929371       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.750532968710       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.752043467928       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.752145056007       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.753246005000       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.753042560348       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748646276206       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.781040907481       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.758477746600       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.762970204083       residual = 9.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.931230010721       residual = 3.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.767920156880       residual = 4.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.656682344661       residual = 2.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.833337587722       residual = 6.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -2.815238052314       residual = 1.34e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.173039483844       residual = 7.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to too large eigenvalue change
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+11 is 3.129539e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.750686956896       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.750686956896       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.750686956896       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751057812031       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751587943980       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.750962185286       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750460717130       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749157217385       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.756883103405       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752387182189       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745346047440       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747034255760       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748987296624       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.754152247397       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740594498412       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.775289949328       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.766404700541       residual = 7.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744142427626       residual = 1.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.557039292977       residual = 2.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.695885458972       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.816192803942       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       1.033629250319       residual = 8.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       3.740687873652       residual = 3.91e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.126257237387       residual = 2.49e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.642789938619       residual = 5.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.862223217656       residual = 4.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   26 stopping due to too large eigenvalue change
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+12 is 6.556129e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.627209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1112e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6572
    reference variance = 0.31739
====================================================
  Execution time = 2.5627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4865e-01
  Total weights = 1.9550e+06
  Execution time = 3.5996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438039315093
                                         uncertainty =       0.002123591473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438039315093
                                         uncertainty =       0.002123591473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467925157
  error estimate for blocks of size 2^( 2) =       0.000491492794
  error estimate for blocks of size 2^( 3) =       0.000513765902
  error estimate for blocks of size 2^( 4) =       0.000529943193
  error estimate for blocks of size 2^( 5) =       0.000539954322
  error estimate for blocks of size 2^( 6) =       0.000545484134
  error estimate for blocks of size 2^( 7) =       0.000545637017

      target function =      -0.746421402122
              le_mean =     -22.662367479333
             les_mean =     514.031546590550
             stat err =       0.000540254666
             autocorr =       1.333043325726
   target nu stat err =       0.000540254666
   target dn stat err =       0.003098162706
      target stat err =       0.002616134248
              std dev =       0.661746102650
             le_variance =       0.437907904373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438039315093
                                         uncertainty =       0.002123591473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438039315093
                                         uncertainty =       0.002123591473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467925157
  error estimate for blocks of size 2^( 2) =       0.000491492794
  error estimate for blocks of size 2^( 3) =       0.000513765902
  error estimate for blocks of size 2^( 4) =       0.000529943193
  error estimate for blocks of size 2^( 5) =       0.000539954322
  error estimate for blocks of size 2^( 6) =       0.000545484134
  error estimate for blocks of size 2^( 7) =       0.000545637017

      target function =      -0.746421402122
              le_mean =     -22.662367479333
             les_mean =     514.031546590550
             stat err =       0.000540254666
             autocorr =       1.333043325724
   target nu stat err =       0.000540254666
   target dn stat err =       0.003098162706
      target stat err =       0.002616134248
              std dev =       0.661746102650
             le_variance =       0.437907904373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438039315093
                                         uncertainty =       0.002123591473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438039315093
                                         uncertainty =       0.002123591473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467925157
  error estimate for blocks of size 2^( 2) =       0.000491492794
  error estimate for blocks of size 2^( 3) =       0.000513765902
  error estimate for blocks of size 2^( 4) =       0.000529943193
  error estimate for blocks of size 2^( 5) =       0.000539954322
  error estimate for blocks of size 2^( 6) =       0.000545484134
  error estimate for blocks of size 2^( 7) =       0.000545637017

      target function =      -0.746421402122
              le_mean =     -22.662367479333
             les_mean =     514.031546590550
             stat err =       0.000540254666
             autocorr =       1.333043325724
   target nu stat err =       0.000540254666
   target dn stat err =       0.003098162706
      target stat err =       0.002616134248
              std dev =       0.661746102650
             le_variance =       0.437907904373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438039315093
                                         uncertainty =       0.002123591473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438039315093
                                         uncertainty =       0.002123591473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467925157
  error estimate for blocks of size 2^( 2) =       0.000491492794
  error estimate for blocks of size 2^( 3) =       0.000513765902
  error estimate for blocks of size 2^( 4) =       0.000529943193
  error estimate for blocks of size 2^( 5) =       0.000539954322
  error estimate for blocks of size 2^( 6) =       0.000545484134
  error estimate for blocks of size 2^( 7) =       0.000545637017

      target function =      -0.746421402122
              le_mean =     -22.662367479333
             les_mean =     514.031546590550
             stat err =       0.000540254666
             autocorr =       1.333043325724
   target nu stat err =       0.000540254666
   target dn stat err =       0.003098162706
      target stat err =       0.002616134248
              std dev =       0.661746102650
             le_variance =       0.437907904373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746421402122        initial
     1.4901e+11     1.4901e+12             1.3841e-15        -0.746421402122  <--
     5.9605e+11     5.9605e+12             3.1295e-16        -0.746421402122
     2.3842e+12     2.3842e+13             6.5561e-17        -0.746421402122

*****************************************************************************
Applying the update for shift_i =   1.4901e+11     and shift_s =   1.4901e+12
*****************************************************************************

  Execution time = 4.3748e+01
  </log>
  <optVariables href="FORM.s046.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7674
    reference variance = 0.388111
====================================================
  Execution time = 2.6288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4898e-01
  Total weights = 1.955380795e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187714460
                                         uncertainty =       0.002822555704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187714460
                                         uncertainty =       0.002822555704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469139814
  error estimate for blocks of size 2^( 2) =       0.000493219128
  error estimate for blocks of size 2^( 3) =       0.000515844849
  error estimate for blocks of size 2^( 4) =       0.000532550033
  error estimate for blocks of size 2^( 5) =       0.000543012466
  error estimate for blocks of size 2^( 6) =       0.000547444253
  error estimate for blocks of size 2^( 7) =       0.000549513970

      target function =      -0.746131314094
              le_mean =     -22.661227401065
             les_mean =     513.980205209310
             stat err =       0.000543130181
             autocorr =       1.340303929037
   target nu stat err =       0.000543130181
   target dn stat err =       0.003607150680
      target stat err =       0.003018438616
              std dev =       0.663463887111
             le_variance =       0.440184329501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266122740107e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746142462340       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746142462340       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746142462340       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746145601736       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746120664592       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746150211997       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746142462340       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746129503096       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746093283965       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746193931017       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746200250298       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746139654596       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746092632004       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746136074250       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746056714573       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746146794925       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746064423274       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746058491694       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746220299848       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746050194515       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746040128842       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745086865521       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741510278368       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744858746757       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.756357621303       residual = 6.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.754295256765       residual = 6.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.728773009357       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.735384071982       residual = 5.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748612900833       residual = 5.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.485331572834       residual = 6.55e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.844289531071       residual = 1.25e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.295858978017       residual = 1.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.193368367303       residual = 7.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.184184801081       residual = 3.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+10 is 5.483880e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746142462340       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746142462340       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746142462340       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746127437235       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746142462340       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746114896407       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746142462340       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746113669067       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746107935824       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746043615549       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746053249299       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746218727306       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745836638243       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746563936468       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746276262177       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745854585735       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745973086348       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746072112441       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746792279084       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746745619343       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745383836777       residual = 6.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747789319087       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745650963706       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745846358542       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748456826239       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746249109836       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746622506111       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746916216425       residual = 7.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.751059383833       residual = 3.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.739768247052       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.740231349801       residual = 3.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744265263553       residual = 9.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750733407029       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.786240638602       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.694673833647       residual = 9.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.094589504801       residual = 7.41e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.948266106900       residual = 1.67e+04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.467622967471       residual = 2.99e+05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.020288604272       residual = 8.80e+06           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       4.190493162225       residual = 5.38e+06           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -4.242357874531       residual = 1.32e+07           smallest_sin_value = 9.98e-01
davidson iteration   41 stopping due to too large eigenvalue change
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+11 is 1.333030e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746142462340       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746142462340       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746142462340       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746142462340       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746142462340       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746142462340       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746142462340       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746142462340       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747457885752       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745716221820       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744984196693       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745563552466       residual = 5.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745767837494       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.725733649154       residual = 5.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.694443865681       residual = 5.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.533394553513       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.518168573548       residual = 9.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.063958520235       residual = 9.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =       0.332658204181       residual = 1.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.736175478475       residual = 8.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =       0.967753949239       residual = 4.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       0.585839922966       residual = 2.24e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.806128690000       residual = 5.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   23 stopping due to too large eigenvalue change
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+11 is 3.597547e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.677742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1085e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.706
    reference variance = 0.314105
====================================================
  Execution time = 2.8058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4444e-01
  Total weights = 1.9549e+06
  Execution time = 3.5921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648554763
                                         uncertainty =       0.001718655272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648554763
                                         uncertainty =       0.001718655272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465670203
  error estimate for blocks of size 2^( 2) =       0.000489690755
  error estimate for blocks of size 2^( 3) =       0.000512256107
  error estimate for blocks of size 2^( 4) =       0.000528422349
  error estimate for blocks of size 2^( 5) =       0.000536643427
  error estimate for blocks of size 2^( 6) =       0.000542508134
  error estimate for blocks of size 2^( 7) =       0.000543140059

      target function =      -0.749889732967
              le_mean =     -22.661709794005
             les_mean =     513.997528402261
             stat err =       0.000537678492
             autocorr =       1.333178893945
   target nu stat err =       0.000537678492
   target dn stat err =       0.002457833097
      target stat err =       0.002122793387
              std dev =       0.658557117003
             le_variance =       0.433697476355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648554763
                                         uncertainty =       0.001718655272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648554763
                                         uncertainty =       0.001718655272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465670203
  error estimate for blocks of size 2^( 2) =       0.000489690755
  error estimate for blocks of size 2^( 3) =       0.000512256107
  error estimate for blocks of size 2^( 4) =       0.000528422349
  error estimate for blocks of size 2^( 5) =       0.000536643427
  error estimate for blocks of size 2^( 6) =       0.000542508134
  error estimate for blocks of size 2^( 7) =       0.000543140059

      target function =      -0.749889732967
              le_mean =     -22.661709794005
             les_mean =     513.997528402261
             stat err =       0.000537678492
             autocorr =       1.333178893941
   target nu stat err =       0.000537678492
   target dn stat err =       0.002457833097
      target stat err =       0.002122793387
              std dev =       0.658557117003
             le_variance =       0.433697476355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648554763
                                         uncertainty =       0.001718655272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648554763
                                         uncertainty =       0.001718655272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465670203
  error estimate for blocks of size 2^( 2) =       0.000489690755
  error estimate for blocks of size 2^( 3) =       0.000512256107
  error estimate for blocks of size 2^( 4) =       0.000528422349
  error estimate for blocks of size 2^( 5) =       0.000536643427
  error estimate for blocks of size 2^( 6) =       0.000542508134
  error estimate for blocks of size 2^( 7) =       0.000543140059

      target function =      -0.749889732967
              le_mean =     -22.661709794005
             les_mean =     513.997528402261
             stat err =       0.000537678492
             autocorr =       1.333178893947
   target nu stat err =       0.000537678492
   target dn stat err =       0.002457833097
      target stat err =       0.002122793387
              std dev =       0.658557117003
             le_variance =       0.433697476355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648554763
                                         uncertainty =       0.001718655272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433648554763
                                         uncertainty =       0.001718655272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465670203
  error estimate for blocks of size 2^( 2) =       0.000489690755
  error estimate for blocks of size 2^( 3) =       0.000512256107
  error estimate for blocks of size 2^( 4) =       0.000528422349
  error estimate for blocks of size 2^( 5) =       0.000536643427
  error estimate for blocks of size 2^( 6) =       0.000542508134
  error estimate for blocks of size 2^( 7) =       0.000543140059

      target function =      -0.749889732967
              le_mean =     -22.661709794005
             les_mean =     513.997528402261
             stat err =       0.000537678492
             autocorr =       1.333178893942
   target nu stat err =       0.000537678492
   target dn stat err =       0.002457833097
      target stat err =       0.002122793387
              std dev =       0.658557117003
             le_variance =       0.433697476355


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749889732967        initial
     3.7253e+10     3.7253e+11             5.4839e-15        -0.749889732967
     1.4901e+11     1.4901e+12             1.3330e-15        -0.749889732967  <--
     5.9605e+11     5.9605e+12             3.5975e-16        -0.749889732967

*****************************************************************************
Applying the update for shift_i =   1.4901e+11     and shift_s =   1.4901e+12
*****************************************************************************

  Execution time = 4.6137e+01
  </log>
  <optVariables href="FORM.s047.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7344e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6054
    reference variance = 0.443291
====================================================
  Execution time = 2.6485e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4815e-01
  Total weights = 1.955205500e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439560658903
                                         uncertainty =       0.002030939469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439560658903
                                         uncertainty =       0.002030939469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468785696
  error estimate for blocks of size 2^( 2) =       0.000493083966
  error estimate for blocks of size 2^( 3) =       0.000514931504
  error estimate for blocks of size 2^( 4) =       0.000530524964
  error estimate for blocks of size 2^( 5) =       0.000540305328
  error estimate for blocks of size 2^( 6) =       0.000545422547
  error estimate for blocks of size 2^( 7) =       0.000547099326

      target function =      -0.746821503847
              le_mean =     -22.661638318838
             les_mean =     513.998002487912
             stat err =       0.000540838041
             autocorr =       1.331023607515
   target nu stat err =       0.000540838041
   target dn stat err =       0.002622613845
      target stat err =       0.002237195645
              std dev =       0.662963089499
             le_variance =       0.439520058038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266163831884e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746827275015       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746827275015       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746827275015       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746827275015       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746827275015       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746827275015       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746813979237       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746827275015       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746809030405       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746789426983       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746865430794       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746611542949       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746786156401       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746771083456       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746795996094       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746834542738       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746864059546       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746870859674       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746798870237       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746581730641       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746995243497       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746916815657       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746353653823       residual = 7.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746297975828       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746434422819       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.746290897215       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748599060410       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745173679974       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.750497484300       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745767039518       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.633338012490       residual = 2.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.740568541617       residual = 3.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.726668761379       residual = 3.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.847563422543       residual = 3.41e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.382780901614       residual = 3.62e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       5.991472042501       residual = 4.87e+05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       9.060894416302       residual = 3.44e+06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       5.569300172876       residual = 1.69e+06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -4.394069611767       residual = 2.64e+05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -8.259706430541       residual = 1.22e+07           smallest_sin_value = 1.00e+00
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+10 is 5.484882e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746827275015       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746827275015       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746827275015       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746827275015       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746827537933       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746989058309       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746734181861       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746979487321       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747092952970       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746399040707       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746615852302       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746408851106       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746996847887       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746852036007       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746652470648       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747296250378       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746758203993       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746760308333       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746747527073       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746451232293       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.752102535917       residual = 5.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.779108970952       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.693366575219       residual = 2.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.893321925169       residual = 2.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.719433346363       residual = 5.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.521380167451       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.845091858129       residual = 1.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       0.223425929424       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       0.379505978479       residual = 1.70e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       7.651971383135       residual = 5.98e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -7.393824025099       residual = 4.30e+05           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+11 is 1.379992e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746827275015       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746827275015       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746827275015       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746819841317       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746827274893       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747124481584       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746273894196       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747273004698       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746588209308       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746070980053       residual = 4.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747772232468       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747112001700       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746455325435       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747540015146       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.751073590412       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.766173430231       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.730133661517       residual = 4.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.711188421497       residual = 4.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741181140534       residual = 8.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.807885306996       residual = 5.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =       0.119335349013       residual = 1.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.252209018647       residual = 6.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.075753739514       residual = 1.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       5.509463990749       residual = 3.97e+04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -5.851727486571       residual = 1.34e+05           smallest_sin_value = 1.00e+00
davidson iteration   25 stopping due to too large eigenvalue change
davidson solver did not converge after         25 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+11 is 3.561882e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.724389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1237e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6876
    reference variance = 0.721223
====================================================
  Execution time = 2.5832e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5431e-01
  Total weights = 1.9551e+06
  Execution time = 3.6105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440445751038
                                         uncertainty =       0.002063743351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440445751038
                                         uncertainty =       0.002063743351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469316225
  error estimate for blocks of size 2^( 2) =       0.000493141725
  error estimate for blocks of size 2^( 3) =       0.000515531699
  error estimate for blocks of size 2^( 4) =       0.000531519579
  error estimate for blocks of size 2^( 5) =       0.000540169585
  error estimate for blocks of size 2^( 6) =       0.000545164093
  error estimate for blocks of size 2^( 7) =       0.000548007615

      target function =      -0.741784711136
              le_mean =     -22.661595784166
             les_mean =     514.002235751869
             stat err =       0.000541215218
             autocorr =       1.329869000819
   target nu stat err =       0.000541215218
   target dn stat err =       0.003487743530
      target stat err =       0.002890387733
              std dev =       0.663713369809
             le_variance =       0.440515437264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440445751038
                                         uncertainty =       0.002063743351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440445751038
                                         uncertainty =       0.002063743351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469316225
  error estimate for blocks of size 2^( 2) =       0.000493141725
  error estimate for blocks of size 2^( 3) =       0.000515531699
  error estimate for blocks of size 2^( 4) =       0.000531519579
  error estimate for blocks of size 2^( 5) =       0.000540169585
  error estimate for blocks of size 2^( 6) =       0.000545164093
  error estimate for blocks of size 2^( 7) =       0.000548007615

      target function =      -0.741784711136
              le_mean =     -22.661595784166
             les_mean =     514.002235751869
             stat err =       0.000541215218
             autocorr =       1.329869000822
   target nu stat err =       0.000541215218
   target dn stat err =       0.003487743530
      target stat err =       0.002890387733
              std dev =       0.663713369809
             le_variance =       0.440515437264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440445751038
                                         uncertainty =       0.002063743351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440445751038
                                         uncertainty =       0.002063743351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469316225
  error estimate for blocks of size 2^( 2) =       0.000493141725
  error estimate for blocks of size 2^( 3) =       0.000515531699
  error estimate for blocks of size 2^( 4) =       0.000531519579
  error estimate for blocks of size 2^( 5) =       0.000540169585
  error estimate for blocks of size 2^( 6) =       0.000545164093
  error estimate for blocks of size 2^( 7) =       0.000548007615

      target function =      -0.741784711136
              le_mean =     -22.661595784166
             les_mean =     514.002235751869
             stat err =       0.000541215218
             autocorr =       1.329869000821
   target nu stat err =       0.000541215218
   target dn stat err =       0.003487743530
      target stat err =       0.002890387733
              std dev =       0.663713369809
             le_variance =       0.440515437264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440445751038
                                         uncertainty =       0.002063743351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440445751038
                                         uncertainty =       0.002063743351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469316225
  error estimate for blocks of size 2^( 2) =       0.000493141725
  error estimate for blocks of size 2^( 3) =       0.000515531699
  error estimate for blocks of size 2^( 4) =       0.000531519579
  error estimate for blocks of size 2^( 5) =       0.000540169585
  error estimate for blocks of size 2^( 6) =       0.000545164093
  error estimate for blocks of size 2^( 7) =       0.000548007615

      target function =      -0.741784711136
              le_mean =     -22.661595784166
             les_mean =     514.002235751869
             stat err =       0.000541215218
             autocorr =       1.329869000821
   target nu stat err =       0.000541215218
   target dn stat err =       0.003487743530
      target stat err =       0.002890387733
              std dev =       0.663713369809
             le_variance =       0.440515437264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741784711136        initial
     3.7253e+10     3.7253e+11             5.4849e-15        -0.741784711136  <--
     1.4901e+11     1.4901e+12             1.3800e-15        -0.741784711136
     5.9605e+11     5.9605e+12             3.5619e-16        -0.741784711136

*****************************************************************************
Applying the update for shift_i =   3.7253e+10     and shift_s =   3.7253e+11
*****************************************************************************

  Execution time = 4.4007e+01
  </log>
  <optVariables href="FORM.s048.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5292e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6725
    reference variance = 0.369728
====================================================
  Execution time = 2.6308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4919e-01
  Total weights = 1.955116665e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439706245579
                                         uncertainty =       0.002001400510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439706245579
                                         uncertainty =       0.002001400510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468882208
  error estimate for blocks of size 2^( 2) =       0.000493270143
  error estimate for blocks of size 2^( 3) =       0.000515304968
  error estimate for blocks of size 2^( 4) =       0.000530659959
  error estimate for blocks of size 2^( 5) =       0.000540626223
  error estimate for blocks of size 2^( 6) =       0.000546585190
  error estimate for blocks of size 2^( 7) =       0.000550976147

      target function =      -0.745964453776
              le_mean =     -22.661274436297
             les_mean =     513.982545476578
             stat err =       0.000542211880
             autocorr =       1.337243666891
   target nu stat err =       0.000542211880
   target dn stat err =       0.003009164767
      target stat err =       0.002538305502
              std dev =       0.663099577998
             le_variance =       0.439701050341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266127443630e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745972113944       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745972113944       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745972113944       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745972113944       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745972113944       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745968615543       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745972113944       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745972113944       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745959353766       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745972113944       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745947444121       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745942372815       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+09 is 2.271302e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745972113944       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745972113944       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745972113944       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745972149399       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745972113944       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745972113944       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745940883526       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745936577666       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745952928470       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746131869161       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746010750440       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745929248984       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745917070115       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745897400088       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745891599001       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745911190978       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745787366984       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745951773069       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745831748936       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745875579440       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745998536992       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745782844492       residual = 7.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745186770198       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746017421606       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746593244227       residual = 8.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740894295320       residual = 2.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.738989124856       residual = 7.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740939455201       residual = 1.38e+04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.762211696392       residual = 6.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749657068453       residual = 3.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.902556631415       residual = 4.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.640921823826       residual = 1.10e+05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.715370467333       residual = 1.60e+05           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+10 is 5.690467e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745972113944       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745972113944       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745972113944       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745972113944       residual = 6.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745972113944       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746090951807       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745929592064       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745971598944       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745939856673       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745788160121       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745526514483       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746083612498       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745896250479       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745506812129       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744370676047       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.718064388192       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.738082267649       residual = 4.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.810428374994       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.804751964284       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745434530647       residual = 4.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.781289421862       residual = 3.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.562309370118       residual = 6.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941114888945       residual = 4.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.490536292297       residual = 1.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.863675499471       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.869372948362       residual = 2.10e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.020016188996       residual = 1.45e+05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.180516470754       residual = 4.42e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.770269622827       residual = 1.89e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -3.451189485103       residual = 1.22e+08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.809073171493       residual = 1.73e+08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       7.323258294699       residual = 1.37e+09           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+11 is 1.421939e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.754254 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1039e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6298
    reference variance = 0.290214
====================================================
  Execution time = 2.5904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4078e-01
  Total weights = 1.9552e+06
  Execution time = 4.1132e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142340868
                                         uncertainty =       0.001741221374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142340868
                                         uncertainty =       0.001741221374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465374225
  error estimate for blocks of size 2^( 2) =       0.000488993919
  error estimate for blocks of size 2^( 3) =       0.000511304627
  error estimate for blocks of size 2^( 4) =       0.000527263583
  error estimate for blocks of size 2^( 5) =       0.000536128281
  error estimate for blocks of size 2^( 6) =       0.000542851320
  error estimate for blocks of size 2^( 7) =       0.000547060618

      target function =      -0.752967367829
              le_mean =     -22.662948073167
             les_mean =     514.049991510711
             stat err =       0.000538325951
             autocorr =       1.338092018851
   target nu stat err =       0.000538325951
   target dn stat err =       0.002113930352
      target stat err =       0.001868864673
              std dev =       0.658138540199
             le_variance =       0.433146338095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142340868
                                         uncertainty =       0.001741221374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142340868
                                         uncertainty =       0.001741221374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465374225
  error estimate for blocks of size 2^( 2) =       0.000488993919
  error estimate for blocks of size 2^( 3) =       0.000511304627
  error estimate for blocks of size 2^( 4) =       0.000527263583
  error estimate for blocks of size 2^( 5) =       0.000536128281
  error estimate for blocks of size 2^( 6) =       0.000542851320
  error estimate for blocks of size 2^( 7) =       0.000547060618

      target function =      -0.752967367829
              le_mean =     -22.662948073167
             les_mean =     514.049991510711
             stat err =       0.000538325951
             autocorr =       1.338092018860
   target nu stat err =       0.000538325951
   target dn stat err =       0.002113930352
      target stat err =       0.001868864673
              std dev =       0.658138540199
             le_variance =       0.433146338095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142340868
                                         uncertainty =       0.001741221374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142340868
                                         uncertainty =       0.001741221374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465374225
  error estimate for blocks of size 2^( 2) =       0.000488993919
  error estimate for blocks of size 2^( 3) =       0.000511304627
  error estimate for blocks of size 2^( 4) =       0.000527263583
  error estimate for blocks of size 2^( 5) =       0.000536128281
  error estimate for blocks of size 2^( 6) =       0.000542851320
  error estimate for blocks of size 2^( 7) =       0.000547060618

      target function =      -0.752967367829
              le_mean =     -22.662948073167
             les_mean =     514.049991510711
             stat err =       0.000538325951
             autocorr =       1.338092018859
   target nu stat err =       0.000538325951
   target dn stat err =       0.002113930352
      target stat err =       0.001868864673
              std dev =       0.658138540199
             le_variance =       0.433146338095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142340868
                                         uncertainty =       0.001741221374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433142340868
                                         uncertainty =       0.001741221374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465374225
  error estimate for blocks of size 2^( 2) =       0.000488993919
  error estimate for blocks of size 2^( 3) =       0.000511304627
  error estimate for blocks of size 2^( 4) =       0.000527263583
  error estimate for blocks of size 2^( 5) =       0.000536128281
  error estimate for blocks of size 2^( 6) =       0.000542851320
  error estimate for blocks of size 2^( 7) =       0.000547060618

      target function =      -0.752967367829
              le_mean =     -22.662948073167
             les_mean =     514.049991510711
             stat err =       0.000538325951
             autocorr =       1.338092018857
   target nu stat err =       0.000538325951
   target dn stat err =       0.002113930352
      target stat err =       0.001868864673
              std dev =       0.658138540199
             le_variance =       0.433146338095


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.752967367829        initial
     9.3132e+09     9.3132e+10             2.2713e-14        -0.752967367829  <--
     3.7253e+10     3.7253e+11             5.6905e-15        -0.752967367829
     1.4901e+11     1.4901e+12             1.4219e-15        -0.752967367829

*****************************************************************************
Applying the update for shift_i =   9.3132e+09     and shift_s =   9.3132e+10
*****************************************************************************

  Execution time = 4.4494e+01
  </log>
  <optVariables href="FORM.s049.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.6841
    reference variance = 0.380067
====================================================
  Execution time = 2.6352e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5203e-01
  Total weights = 1.955397638e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443097505573
                                         uncertainty =       0.002871708200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443097505573
                                         uncertainty =       0.002871708200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470690778
  error estimate for blocks of size 2^( 2) =       0.000495092106
  error estimate for blocks of size 2^( 3) =       0.000517303149
  error estimate for blocks of size 2^( 4) =       0.000533867530
  error estimate for blocks of size 2^( 5) =       0.000543686082
  error estimate for blocks of size 2^( 6) =       0.000550581854
  error estimate for blocks of size 2^( 7) =       0.000554498061

      target function =      -0.743650996467
              le_mean =     -22.662379785121
             les_mean =     514.035484421873
             stat err =       0.000545658382
             autocorr =       1.343910301734
   target nu stat err =       0.000545658382
   target dn stat err =       0.003370267621
      target stat err =       0.002815242865
              std dev =       0.665657281376
             le_variance =       0.443099616248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266237978512e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743660673350       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743660673350       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743660673350       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743661728988       residual = 8.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743660673346       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743661263471       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743658999086       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743658650604       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743660026898       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743655383850       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743652625433       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743659696518       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+09 is 8.432269e-14

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743660673350       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743660673350       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743660673350       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743661829949       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743660673350       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743661993390       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743660723449       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743655132108       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743650560684       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743650619879       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743638437767       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743668772685       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+09 is 2.107370e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743660673350       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743660673350       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743660673350       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743660673350       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743660673350       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743637050471       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743656619756       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743663594240       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743592932140       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743761951987       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743693926573       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743680123454       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743730210306       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743750766027       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743732183356       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743644896564       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743686320770       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743586636690       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743680241747       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743616916547       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743755856091       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743576712199       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743644845469       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743626206228       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744622898334       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743790680701       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742229335777       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749639032307       residual = 8.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.710467090838       residual = 3.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.740451584547       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.744136682385       residual = 4.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746801926043       residual = 4.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.865150205563       residual = 5.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.836200728972       residual = 2.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.351734632425       residual = 1.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -3.664820132907       residual = 2.54e+04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -7.407523119910       residual = 3.96e+04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       2.011483701656       residual = 1.56e+04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -3.882625136198       residual = 1.47e+04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       7.160647574854       residual = 1.76e+05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =     -10.626678117388       residual = 7.81e+05           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -7.212472069935       residual = 9.62e+04           smallest_sin_value = 9.96e-01
davidson iteration   42 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+10 is 5.220037e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.788678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1067e+01
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.6226
    reference variance = 0.305708
====================================================
  Execution time = 2.5492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5004e-01
  Total weights = 1.9550e+06
  Execution time = 3.6007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441141931099
                                         uncertainty =       0.002564663212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441141931099
                                         uncertainty =       0.002564663212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469698527
  error estimate for blocks of size 2^( 2) =       0.000493912221
  error estimate for blocks of size 2^( 3) =       0.000516367687
  error estimate for blocks of size 2^( 4) =       0.000532842733
  error estimate for blocks of size 2^( 5) =       0.000541770816
  error estimate for blocks of size 2^( 6) =       0.000545962372
  error estimate for blocks of size 2^( 7) =       0.000548458738

      target function =      -0.745280094776
              le_mean =     -22.662699400679
             les_mean =     514.047986600177
             stat err =       0.000542258665
             autocorr =       1.332829527399
   target nu stat err =       0.000542258665
   target dn stat err =       0.002926819653
      target stat err =       0.002473526775
              std dev =       0.664254026428
             le_variance =       0.441233411626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441141931099
                                         uncertainty =       0.002564663212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441141931099
                                         uncertainty =       0.002564663212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469698527
  error estimate for blocks of size 2^( 2) =       0.000493912221
  error estimate for blocks of size 2^( 3) =       0.000516367687
  error estimate for blocks of size 2^( 4) =       0.000532842733
  error estimate for blocks of size 2^( 5) =       0.000541770816
  error estimate for blocks of size 2^( 6) =       0.000545962372
  error estimate for blocks of size 2^( 7) =       0.000548458738

      target function =      -0.745280094775
              le_mean =     -22.662699400679
             les_mean =     514.047986600177
             stat err =       0.000542258665
             autocorr =       1.332829527397
   target nu stat err =       0.000542258665
   target dn stat err =       0.002926819653
      target stat err =       0.002473526775
              std dev =       0.664254026429
             le_variance =       0.441233411627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441141931099
                                         uncertainty =       0.002564663212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441141931099
                                         uncertainty =       0.002564663212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469698527
  error estimate for blocks of size 2^( 2) =       0.000493912221
  error estimate for blocks of size 2^( 3) =       0.000516367687
  error estimate for blocks of size 2^( 4) =       0.000532842733
  error estimate for blocks of size 2^( 5) =       0.000541770816
  error estimate for blocks of size 2^( 6) =       0.000545962372
  error estimate for blocks of size 2^( 7) =       0.000548458738

      target function =      -0.745280094775
              le_mean =     -22.662699400679
             les_mean =     514.047986600177
             stat err =       0.000542258665
             autocorr =       1.332829527399
   target nu stat err =       0.000542258665
   target dn stat err =       0.002926819653
      target stat err =       0.002473526775
              std dev =       0.664254026428
             le_variance =       0.441233411626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441141931099
                                         uncertainty =       0.002564663212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441141931099
                                         uncertainty =       0.002564663212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469698527
  error estimate for blocks of size 2^( 2) =       0.000493912221
  error estimate for blocks of size 2^( 3) =       0.000516367687
  error estimate for blocks of size 2^( 4) =       0.000532842733
  error estimate for blocks of size 2^( 5) =       0.000541770816
  error estimate for blocks of size 2^( 6) =       0.000545962372
  error estimate for blocks of size 2^( 7) =       0.000548458738

      target function =      -0.745280094776
              le_mean =     -22.662699400679
             les_mean =     514.047986600177
             stat err =       0.000542258665
             autocorr =       1.332829527400
   target nu stat err =       0.000542258665
   target dn stat err =       0.002926819653
      target stat err =       0.002473526775
              std dev =       0.664254026428
             le_variance =       0.441233411626


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745280094776        initial  <--
     2.3283e+09     2.3283e+10             8.4323e-14        -0.745280094775
     9.3132e+09     9.3132e+10             2.1074e-14        -0.745280094775
     3.7253e+10     3.7253e+11             5.2200e-15        -0.745280094776

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6144
  </log>
  <optVariables href="FORM.s050.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7191
    reference variance = 1.09037
====================================================
  Execution time = 2.6255e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4703e-01
  Total weights = 1.955208228e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437460998900
                                         uncertainty =       0.001955264580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437460998900
                                         uncertainty =       0.001955264580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467712559
  error estimate for blocks of size 2^( 2) =       0.000491522814
  error estimate for blocks of size 2^( 3) =       0.000513656659
  error estimate for blocks of size 2^( 4) =       0.000531323999
  error estimate for blocks of size 2^( 5) =       0.000540514322
  error estimate for blocks of size 2^( 6) =       0.000546755722
  error estimate for blocks of size 2^( 7) =       0.000550958342

      target function =      -0.747737805635
              le_mean =     -22.661449988015
             les_mean =     513.988350418003
             stat err =       0.000542388096
             autocorr =       1.344814043904
   target nu stat err =       0.000542388096
   target dn stat err =       0.002583426537
      target stat err =       0.002211218449
              std dev =       0.661445444164
             le_variance =       0.437510075605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266144998802e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747743321290       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747743321290       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747743321290       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747743321290       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747745900779       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747743321993       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747733963181       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747725843603       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747757683070       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747725239070       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747732210727       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747814347479       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747728549890       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747760815214       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747788232769       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747810173229       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747791944238       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747374278053       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748032911221       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748732564054       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748260108342       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.750486513846       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746444027029       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747066827878       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746120414828       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.756667839345       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740650574755       residual = 4.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744855745748       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746425317157       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.755851039160       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.757536399530       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.757063474545       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.592448792281       residual = 2.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.962017621881       residual = 2.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+10 is 8.795349e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747743321290       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747743321290       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747743321290       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747743321290       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747743321290       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747743326974       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747743318299       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747564567479       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747918809452       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747707260590       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747896942854       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747729281435       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747571109641       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747704911256       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747756037739       residual = 7.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747783211756       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749092668657       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.753659773753       residual = 7.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.781676397004       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.732277101771       residual = 6.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.717499048279       residual = 2.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748503894031       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742986507723       residual = 5.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.716433610900       residual = 7.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.855175048350       residual = 2.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.922583114047       residual = 3.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       4.149884609598       residual = 4.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -2.758958625126       residual = 3.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.210953558740       residual = 3.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.241585523952       residual = 3.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.832797942507       residual = 4.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+10 is 2.462371e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747743321290       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747743321290       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747743321290       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747743321290       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747743321290       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747743321290       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747743320938       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747753331003       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747411259822       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747439846582       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747301261650       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747466372972       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746623129998       residual = 9.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746638639260       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747412479212       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747517761957       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747321450570       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748458057077       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747695025133       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746764537488       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748507469975       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746140827977       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746645071536       residual = 8.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747960085891       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749915810769       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.752197889737       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.738143513887       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.718302604729       residual = 1.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943226225661       residual = 4.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.732964704306       residual = 3.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.715559906299       residual = 1.46e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.385268506854       residual = 1.80e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.959972556801       residual = 1.55e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.376378294054       residual = 4.23e+05           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+11 is 5.498859e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.832979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1020e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6543
    reference variance = 1.07971
====================================================
  Execution time = 2.7813e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5445e-01
  Total weights = 1.9550e+06
  Execution time = 3.6170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442667547222
                                         uncertainty =       0.002459631218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442667547222
                                         uncertainty =       0.002459631218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470485406
  error estimate for blocks of size 2^( 2) =       0.000494507729
  error estimate for blocks of size 2^( 3) =       0.000516284313
  error estimate for blocks of size 2^( 4) =       0.000532838115
  error estimate for blocks of size 2^( 5) =       0.000541637099
  error estimate for blocks of size 2^( 6) =       0.000547470501
  error estimate for blocks of size 2^( 7) =       0.000549277967

      target function =      -0.741670034209
              le_mean =     -22.662067679808
             les_mean =     514.023766133139
             stat err =       0.000542805920
             autocorr =       1.331057566735
   target nu stat err =       0.000542805920
   target dn stat err =       0.003834978794
      target stat err =       0.003168188494
              std dev =       0.665366842152
             le_variance =       0.442713034636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442667547222
                                         uncertainty =       0.002459631218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442667547222
                                         uncertainty =       0.002459631218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470485406
  error estimate for blocks of size 2^( 2) =       0.000494507729
  error estimate for blocks of size 2^( 3) =       0.000516284313
  error estimate for blocks of size 2^( 4) =       0.000532838115
  error estimate for blocks of size 2^( 5) =       0.000541637099
  error estimate for blocks of size 2^( 6) =       0.000547470501
  error estimate for blocks of size 2^( 7) =       0.000549277967

      target function =      -0.741670034209
              le_mean =     -22.662067679808
             les_mean =     514.023766133139
             stat err =       0.000542805920
             autocorr =       1.331057566735
   target nu stat err =       0.000542805920
   target dn stat err =       0.003834978794
      target stat err =       0.003168188494
              std dev =       0.665366842152
             le_variance =       0.442713034636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442667547222
                                         uncertainty =       0.002459631218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442667547222
                                         uncertainty =       0.002459631218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470485406
  error estimate for blocks of size 2^( 2) =       0.000494507729
  error estimate for blocks of size 2^( 3) =       0.000516284313
  error estimate for blocks of size 2^( 4) =       0.000532838115
  error estimate for blocks of size 2^( 5) =       0.000541637099
  error estimate for blocks of size 2^( 6) =       0.000547470501
  error estimate for blocks of size 2^( 7) =       0.000549277967

      target function =      -0.741670034209
              le_mean =     -22.662067679808
             les_mean =     514.023766133139
             stat err =       0.000542805920
             autocorr =       1.331057566735
   target nu stat err =       0.000542805920
   target dn stat err =       0.003834978794
      target stat err =       0.003168188494
              std dev =       0.665366842152
             le_variance =       0.442713034636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442667547222
                                         uncertainty =       0.002459631218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442667547222
                                         uncertainty =       0.002459631218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470485406
  error estimate for blocks of size 2^( 2) =       0.000494507729
  error estimate for blocks of size 2^( 3) =       0.000516284313
  error estimate for blocks of size 2^( 4) =       0.000532838115
  error estimate for blocks of size 2^( 5) =       0.000541637099
  error estimate for blocks of size 2^( 6) =       0.000547470501
  error estimate for blocks of size 2^( 7) =       0.000549277967

      target function =      -0.741670034209
              le_mean =     -22.662067679808
             les_mean =     514.023766133139
             stat err =       0.000542805920
             autocorr =       1.331057566735
   target nu stat err =       0.000542805920
   target dn stat err =       0.003834978794
      target stat err =       0.003168188494
              std dev =       0.665366842152
             le_variance =       0.442713034636


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741670034209        initial
     2.3283e+10     2.3283e+11             8.7953e-15        -0.741670034209
     9.3132e+10     9.3132e+11             2.4624e-15        -0.741670034209  <--
     3.7253e+11     3.7253e+12             5.4989e-16        -0.741670034209

*****************************************************************************
Applying the update for shift_i =   9.3132e+10     and shift_s =   9.3132e+11
*****************************************************************************

  Execution time = 4.5931e+01
  </log>
  <optVariables href="FORM.s051.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6978e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.5659
    reference variance = 0.349026
====================================================
  Execution time = 2.6412e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.4933e-01
  Total weights = 1.955364797e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438930503553
                                         uncertainty =       0.002254002871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438930503553
                                         uncertainty =       0.002254002871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468454413
  error estimate for blocks of size 2^( 2) =       0.000492556773
  error estimate for blocks of size 2^( 3) =       0.000515029270
  error estimate for blocks of size 2^( 4) =       0.000531934009
  error estimate for blocks of size 2^( 5) =       0.000541680006
  error estimate for blocks of size 2^( 6) =       0.000545587180
  error estimate for blocks of size 2^( 7) =       0.000548077701

      target function =      -0.745835663884
              le_mean =     -22.660467825467
             les_mean =     513.946130779820
             stat err =       0.000541819724
             autocorr =       1.337749978064
   target nu stat err =       0.000541819724
   target dn stat err =       0.003128582543
      target stat err =       0.002629477957
              std dev =       0.662494584120
             le_variance =       0.438899073988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266046782547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745843954527       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745843954527       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745843954527       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745844118244       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745843954529       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745836823672       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745838450801       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745784478454       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745817930757       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745857877799       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745875923960       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745874737610       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745819047066       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745792152662       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745687248471       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745892301976       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745822348739       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745820553459       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745829442825       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745863441901       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745833129252       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746242381918       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745638919753       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745701170608       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745940112359       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745898600458       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745780915587       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745568763017       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745777667175       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745863603746       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.745700090680       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745836056006       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745722958682       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.739269057416       residual = 4.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.755262665078       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744727317699       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.736668437448       residual = 1.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.626041322247       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.344339382413       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.161069497173       residual = 3.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =       0.060191546228       residual = 1.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -2.480453737233       residual = 1.02e+04           smallest_sin_value = 9.99e-01
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.833776925460       residual = 1.33e+04           smallest_sin_value = 9.94e-01
davidson iteration   43 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         43 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+10 is 1.002355e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745843954527       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745843954527       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745843954527       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745818024977       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745880163824       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745788631654       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745920236382       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745716621580       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745951796928       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745843954527       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745699141746       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745864674642       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745653882827       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745368585079       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745576039711       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745728833642       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745882642263       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746017697789       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745879867819       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745865110853       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745810485743       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746148601249       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745813914832       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746110847758       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746130272547       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745775336382       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746117157459       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745855992195       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748832177301       residual = 3.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.765129759052       residual = 2.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.683851673239       residual = 2.48e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.610392404030       residual = 7.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.666737258030       residual = 5.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.592177754893       residual = 4.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.102278776300       residual = 4.68e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.884743445212       residual = 4.89e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -4.182387027071       residual = 3.17e+05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -4.758473066584       residual = 1.41e+05           smallest_sin_value = 1.00e+00
davidson iteration   38 stopping due to too large eigenvalue change
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+10 is 2.533664e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745843954527       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745843954527       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745843954527       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745843954528       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745843954527       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745715619750       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745717838752       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745843954527       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745595858872       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745753702394       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745420043010       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746773346220       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745197938935       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746439198360       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745057229144       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745423758289       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746407243375       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743152805646       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742985158534       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.732839490705       residual = 7.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.778175771122       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.724908341431       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.723285918421       residual = 1.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.883539355551       residual = 4.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.030640298846       residual = 1.58e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.776749075678       residual = 6.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.511130379384       residual = 3.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.309886801572       residual = 6.08e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.784728682142       residual = 3.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       1.145447495182       residual = 1.73e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       1.800520081532       residual = 1.19e+05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -4.476105824605       residual = 2.75e+04           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+11 is 6.358888e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.900218 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1195e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.743
    reference variance = 0.47934
====================================================
  Execution time = 2.5800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4906e-01
  Total weights = 1.9553e+06
  Execution time = 3.6064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592725965
                                         uncertainty =       0.002049448429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592725965
                                         uncertainty =       0.002049448429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468819363
  error estimate for blocks of size 2^( 2) =       0.000492603535
  error estimate for blocks of size 2^( 3) =       0.000514535639
  error estimate for blocks of size 2^( 4) =       0.000529945640
  error estimate for blocks of size 2^( 5) =       0.000539385053
  error estimate for blocks of size 2^( 6) =       0.000543087292
  error estimate for blocks of size 2^( 7) =       0.000544725766

      target function =      -0.746084590069
              le_mean =     -22.662252710990
             les_mean =     514.026756178937
             stat err =       0.000539285938
             autocorr =       1.323204932479
   target nu stat err =       0.000539285938
   target dn stat err =       0.002552154505
      target stat err =       0.002178768043
              std dev =       0.663010701557
             le_variance =       0.439583190380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592725965
                                         uncertainty =       0.002049448429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592725965
                                         uncertainty =       0.002049448429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468819363
  error estimate for blocks of size 2^( 2) =       0.000492603535
  error estimate for blocks of size 2^( 3) =       0.000514535639
  error estimate for blocks of size 2^( 4) =       0.000529945640
  error estimate for blocks of size 2^( 5) =       0.000539385053
  error estimate for blocks of size 2^( 6) =       0.000543087292
  error estimate for blocks of size 2^( 7) =       0.000544725766

      target function =      -0.746084590069
              le_mean =     -22.662252710990
             les_mean =     514.026756178937
             stat err =       0.000539285938
             autocorr =       1.323204932479
   target nu stat err =       0.000539285938
   target dn stat err =       0.002552154505
      target stat err =       0.002178768043
              std dev =       0.663010701557
             le_variance =       0.439583190379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592725965
                                         uncertainty =       0.002049448429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592725965
                                         uncertainty =       0.002049448429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468819363
  error estimate for blocks of size 2^( 2) =       0.000492603535
  error estimate for blocks of size 2^( 3) =       0.000514535639
  error estimate for blocks of size 2^( 4) =       0.000529945640
  error estimate for blocks of size 2^( 5) =       0.000539385053
  error estimate for blocks of size 2^( 6) =       0.000543087292
  error estimate for blocks of size 2^( 7) =       0.000544725766

      target function =      -0.746084590069
              le_mean =     -22.662252710990
             les_mean =     514.026756178937
             stat err =       0.000539285938
             autocorr =       1.323204932478
   target nu stat err =       0.000539285938
   target dn stat err =       0.002552154505
      target stat err =       0.002178768043
              std dev =       0.663010701557
             le_variance =       0.439583190379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592725965
                                         uncertainty =       0.002049448429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592725965
                                         uncertainty =       0.002049448429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468819363
  error estimate for blocks of size 2^( 2) =       0.000492603535
  error estimate for blocks of size 2^( 3) =       0.000514535639
  error estimate for blocks of size 2^( 4) =       0.000529945640
  error estimate for blocks of size 2^( 5) =       0.000539385053
  error estimate for blocks of size 2^( 6) =       0.000543087292
  error estimate for blocks of size 2^( 7) =       0.000544725766

      target function =      -0.746084590069
              le_mean =     -22.662252710990
             les_mean =     514.026756178937
             stat err =       0.000539285938
             autocorr =       1.323204932477
   target nu stat err =       0.000539285938
   target dn stat err =       0.002552154505
      target stat err =       0.002178768043
              std dev =       0.663010701557
             le_variance =       0.439583190379


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746084590069        initial
     2.3283e+10     2.3283e+11             1.0024e-14        -0.746084590069  <--
     9.3132e+10     9.3132e+11             2.5337e-15        -0.746084590069
     3.7253e+11     3.7253e+12             6.3589e-16        -0.746084590069

*****************************************************************************
Applying the update for shift_i =   2.3283e+10     and shift_s =   2.3283e+11
*****************************************************************************

  Execution time = 4.3946e+01
  </log>
  <optVariables href="FORM.s052.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5147e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7358
    reference variance = 0.610963
====================================================
  Execution time = 2.6533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5659e-01
  Total weights = 1.955132498e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443628593071
                                         uncertainty =       0.002944409970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443628593071
                                         uncertainty =       0.002944409970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470988227
  error estimate for blocks of size 2^( 2) =       0.000495023581
  error estimate for blocks of size 2^( 3) =       0.000516660780
  error estimate for blocks of size 2^( 4) =       0.000532288286
  error estimate for blocks of size 2^( 5) =       0.000541304906
  error estimate for blocks of size 2^( 6) =       0.000546259551
  error estimate for blocks of size 2^( 7) =       0.000548991090

      target function =      -0.739945050133
              le_mean =     -22.662521558505
             les_mean =     514.046469521172
             stat err =       0.000542210958
             autocorr =       1.325306960748
   target nu stat err =       0.000542210958
   target dn stat err =       0.003949215639
      target stat err =       0.003246459259
              std dev =       0.666077938024
             le_variance =       0.443659819522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266252155850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739958320691       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739958320691       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739958320691       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739959776841       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739958287946       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739960396527       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739960296591       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739946740312       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739966948540       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739971879421       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739960078372       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739955122710       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+09 is 6.786120e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739958320691       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739958320691       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739958320691       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739958320691       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739969523769       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739970049837       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739971805518       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739954471401       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739969235564       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739973266822       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739962392794       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739911243219       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739934903397       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740027493121       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739964008563       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739974430925       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739979795734       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739975581294       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739966146364       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739924679797       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739991491007       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739777445751       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741656490859       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.753508136586       residual = 5.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740717107432       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.692369135999       residual = 2.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740714454340       residual = 1.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.823265621657       residual = 4.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.555723092602       residual = 2.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.502777010394       residual = 3.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       1.512271569774       residual = 8.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -6.900308761923       residual = 2.38e+04           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+10 is 1.663765e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739958320691       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739958320691       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739958320691       residual = 5.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739964412861       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739961472618       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739830370340       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739893440408       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739817557363       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739803128989       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739779455900       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739688782516       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740089251525       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739851005155       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740003396627       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739751846091       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740029351154       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739923945007       residual = 6.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739951530418       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739677723995       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739685933110       residual = 1.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739692032723       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736626763790       residual = 6.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.737182260420       residual = 6.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743489921677       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745604786724       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.733766799359       residual = 5.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749902717759       residual = 5.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.723494375569       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748585276017       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741099408136       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.753549094460       residual = 2.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.443280342814       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.619987305089       residual = 1.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -6.243896876296       residual = 3.99e+04           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+10 is 4.361587e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.931407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1264e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6417
    reference variance = 0.529982
====================================================
  Execution time = 2.7860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5418e-01
  Total weights = 1.9551e+06
  Execution time = 3.5999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441789914909
                                         uncertainty =       0.002964257746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441789914909
                                         uncertainty =       0.002964257746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470012368
  error estimate for blocks of size 2^( 2) =       0.000494350266
  error estimate for blocks of size 2^( 3) =       0.000515942756
  error estimate for blocks of size 2^( 4) =       0.000532460172
  error estimate for blocks of size 2^( 5) =       0.000541066199
  error estimate for blocks of size 2^( 6) =       0.000544562448
  error estimate for blocks of size 2^( 7) =       0.000546307301

      target function =      -0.741876438628
              le_mean =     -22.661192672784
             les_mean =     513.983834360662
             stat err =       0.000541099030
             autocorr =       1.325363292549
   target nu stat err =       0.000541099030
   target dn stat err =       0.005072167997
      target stat err =       0.004155325821
              std dev =       0.664697865271
             le_variance =       0.441823252096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441789914909
                                         uncertainty =       0.002964257746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441789914909
                                         uncertainty =       0.002964257746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470012368
  error estimate for blocks of size 2^( 2) =       0.000494350266
  error estimate for blocks of size 2^( 3) =       0.000515942756
  error estimate for blocks of size 2^( 4) =       0.000532460172
  error estimate for blocks of size 2^( 5) =       0.000541066199
  error estimate for blocks of size 2^( 6) =       0.000544562448
  error estimate for blocks of size 2^( 7) =       0.000546307301

      target function =      -0.741876438628
              le_mean =     -22.661192672784
             les_mean =     513.983834360662
             stat err =       0.000541099030
             autocorr =       1.325363292548
   target nu stat err =       0.000541099030
   target dn stat err =       0.005072167997
      target stat err =       0.004155325821
              std dev =       0.664697865271
             le_variance =       0.441823252096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441789914909
                                         uncertainty =       0.002964257746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441789914909
                                         uncertainty =       0.002964257746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470012368
  error estimate for blocks of size 2^( 2) =       0.000494350266
  error estimate for blocks of size 2^( 3) =       0.000515942756
  error estimate for blocks of size 2^( 4) =       0.000532460172
  error estimate for blocks of size 2^( 5) =       0.000541066199
  error estimate for blocks of size 2^( 6) =       0.000544562448
  error estimate for blocks of size 2^( 7) =       0.000546307301

      target function =      -0.741876438628
              le_mean =     -22.661192672784
             les_mean =     513.983834360662
             stat err =       0.000541099030
             autocorr =       1.325363292545
   target nu stat err =       0.000541099030
   target dn stat err =       0.005072167997
      target stat err =       0.004155325821
              std dev =       0.664697865271
             le_variance =       0.441823252095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441789914909
                                         uncertainty =       0.002964257746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441789914909
                                         uncertainty =       0.002964257746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470012368
  error estimate for blocks of size 2^( 2) =       0.000494350266
  error estimate for blocks of size 2^( 3) =       0.000515942756
  error estimate for blocks of size 2^( 4) =       0.000532460172
  error estimate for blocks of size 2^( 5) =       0.000541066199
  error estimate for blocks of size 2^( 6) =       0.000544562448
  error estimate for blocks of size 2^( 7) =       0.000546307301

      target function =      -0.741876438628
              le_mean =     -22.661192672784
             les_mean =     513.983834360662
             stat err =       0.000541099030
             autocorr =       1.325363292545
   target nu stat err =       0.000541099030
   target dn stat err =       0.005072167997
      target stat err =       0.004155325821
              std dev =       0.664697865271
             le_variance =       0.441823252096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741876438628        initial
     5.8208e+09     5.8208e+10             6.7861e-14        -0.741876438628  <--
     2.3283e+10     2.3283e+11             1.6638e-14        -0.741876438628
     9.3132e+10     9.3132e+11             4.3616e-15        -0.741876438628

*****************************************************************************
Applying the update for shift_i =   5.8208e+09     and shift_s =   5.8208e+10
*****************************************************************************

  Execution time = 4.5971e+01
  </log>
  <optVariables href="FORM.s053.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7299e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.676
    reference variance = 0.503475
====================================================
  Execution time = 2.6547e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4872e-01
  Total weights = 1.954989101e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439760081930
                                         uncertainty =       0.001944061084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439760081930
                                         uncertainty =       0.001944061084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468933198
  error estimate for blocks of size 2^( 2) =       0.000492614979
  error estimate for blocks of size 2^( 3) =       0.000514950023
  error estimate for blocks of size 2^( 4) =       0.000530346003
  error estimate for blocks of size 2^( 5) =       0.000539356774
  error estimate for blocks of size 2^( 6) =       0.000544313090
  error estimate for blocks of size 2^( 7) =       0.000547346474

      target function =      -0.746355649272
              le_mean =     -22.661659100847
             les_mean =     513.999512305257
             stat err =       0.000540340585
             autocorr =       1.327740548118
   target nu stat err =       0.000540340585
   target dn stat err =       0.002503037957
      target stat err =       0.002139921898
              std dev =       0.663171688383
             le_variance =       0.439796688272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266165910085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746360876044       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746360876044       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746360876044       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746360876044       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746360876044       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746360314640       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746361703166       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746362931218       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746363469855       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746362474036       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746356242066       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746357707158       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+09 is 1.055624e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746360876044       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746360876044       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746360876044       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746360814216       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746360876044       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746360876044       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746360876044       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746370724126       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746354413575       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746360876044       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746362992274       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746360876044       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+09 is 2.639078e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746360876044       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746360876044       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746360876044       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746357558989       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746356533981       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746353513878       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746367926275       residual = 9.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746365789631       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746339373022       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746276322983       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746375875063       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746329145335       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746417214825       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746307470552       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746404290558       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746365763202       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+10 is 6.600841e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.937343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1262e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7005
    reference variance = 0.328164
====================================================
  Execution time = 2.5776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5286e-01
  Total weights = 1.9552e+06
  Execution time = 3.6047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441438409707
                                         uncertainty =       0.002331620257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441438409707
                                         uncertainty =       0.002331620257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469857412
  error estimate for blocks of size 2^( 2) =       0.000493626204
  error estimate for blocks of size 2^( 3) =       0.000516466815
  error estimate for blocks of size 2^( 4) =       0.000532774263
  error estimate for blocks of size 2^( 5) =       0.000541546231
  error estimate for blocks of size 2^( 6) =       0.000546471618
  error estimate for blocks of size 2^( 7) =       0.000546098608

      target function =      -0.742962405618
              le_mean =     -22.661849250496
             les_mean =     514.012274943851
             stat err =       0.000541722680
             autocorr =       1.329296534023
   target nu stat err =       0.000541722680
   target dn stat err =       0.003721845723
      target stat err =       0.003087368628
              std dev =       0.664478724495
             le_variance =       0.441531975306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441438409707
                                         uncertainty =       0.002331620257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441438409707
                                         uncertainty =       0.002331620257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469857412
  error estimate for blocks of size 2^( 2) =       0.000493626204
  error estimate for blocks of size 2^( 3) =       0.000516466815
  error estimate for blocks of size 2^( 4) =       0.000532774263
  error estimate for blocks of size 2^( 5) =       0.000541546231
  error estimate for blocks of size 2^( 6) =       0.000546471618
  error estimate for blocks of size 2^( 7) =       0.000546098608

      target function =      -0.742962405618
              le_mean =     -22.661849250496
             les_mean =     514.012274943851
             stat err =       0.000541722680
             autocorr =       1.329296534033
   target nu stat err =       0.000541722680
   target dn stat err =       0.003721845723
      target stat err =       0.003087368628
              std dev =       0.664478724495
             le_variance =       0.441531975306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441438409707
                                         uncertainty =       0.002331620257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441438409707
                                         uncertainty =       0.002331620257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469857412
  error estimate for blocks of size 2^( 2) =       0.000493626204
  error estimate for blocks of size 2^( 3) =       0.000516466815
  error estimate for blocks of size 2^( 4) =       0.000532774263
  error estimate for blocks of size 2^( 5) =       0.000541546231
  error estimate for blocks of size 2^( 6) =       0.000546471618
  error estimate for blocks of size 2^( 7) =       0.000546098608

      target function =      -0.742962405618
              le_mean =     -22.661849250496
             les_mean =     514.012274943851
             stat err =       0.000541722680
             autocorr =       1.329296534024
   target nu stat err =       0.000541722680
   target dn stat err =       0.003721845723
      target stat err =       0.003087368628
              std dev =       0.664478724495
             le_variance =       0.441531975306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441438409707
                                         uncertainty =       0.002331620257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441438409707
                                         uncertainty =       0.002331620257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469857412
  error estimate for blocks of size 2^( 2) =       0.000493626204
  error estimate for blocks of size 2^( 3) =       0.000516466815
  error estimate for blocks of size 2^( 4) =       0.000532774263
  error estimate for blocks of size 2^( 5) =       0.000541546231
  error estimate for blocks of size 2^( 6) =       0.000546471618
  error estimate for blocks of size 2^( 7) =       0.000546098608

      target function =      -0.742962405618
              le_mean =     -22.661849250496
             les_mean =     514.012274943851
             stat err =       0.000541722680
             autocorr =       1.329296534037
   target nu stat err =       0.000541722680
   target dn stat err =       0.003721845723
      target stat err =       0.003087368628
              std dev =       0.664478724495
             le_variance =       0.441531975306


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742962405618        initial
     1.4552e+09     1.4552e+10             1.0556e-13        -0.742962405618
     5.8208e+09     5.8208e+10             2.6391e-14        -0.742962405618
     2.3283e+10     2.3283e+11             6.6008e-15        -0.742962405618  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+10     and shift_s =   2.3283e+11
*****************************************************************************

  Execution time = 4.3946e+01
  </log>
  <optVariables href="FORM.s054.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5239e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.5771
    reference variance = 0.243179
====================================================
  Execution time = 2.6261e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5177e-01
  Total weights = 1.954972003e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441096024670
                                         uncertainty =       0.002102483461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441096024670
                                         uncertainty =       0.002102483461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469674448
  error estimate for blocks of size 2^( 2) =       0.000493844748
  error estimate for blocks of size 2^( 3) =       0.000516324841
  error estimate for blocks of size 2^( 4) =       0.000531666018
  error estimate for blocks of size 2^( 5) =       0.000541845920
  error estimate for blocks of size 2^( 6) =       0.000546850756
  error estimate for blocks of size 2^( 7) =       0.000549709936

      target function =      -0.743861863445
              le_mean =     -22.661972470195
             les_mean =     514.016763802742
             stat err =       0.000542518158
             autocorr =       1.334242249555
   target nu stat err =       0.000542518158
   target dn stat err =       0.002865399802
      target stat err =       0.002413209584
              std dev =       0.664219974551
             le_variance =       0.441188174593


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266197247019e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743868675862       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743868675862       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743868675862       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743868675862       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743866594772       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743874823897       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743865505811       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743870965625       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743868675862       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+09 is 4.050698e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743868675862       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743868675862       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743868675862       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743858501203       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743866245991       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743869186548       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743859335642       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743856129163       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743817395145       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743807688391       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743880035501       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743827590995       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743896036008       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743923875892       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743868699984       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743811438266       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743867072272       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743881696081       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743874156464       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743864661031       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743807364780       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742852573268       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746370551739       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744894113993       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744115553982       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741930206539       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741522661146       residual = 5.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742183388765       residual = 5.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747710167549       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741008594726       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.746114388037       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.746264986962       residual = 8.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743752263477       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.725881322599       residual = 5.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.750965417156       residual = 5.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.200321217169       residual = 9.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.645007378161       residual = 1.63e+04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -8.519388601323       residual = 1.83e+05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       3.435209544668       residual = 4.99e+04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       2.367817456700       residual = 2.57e+04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -8.884692490713       residual = 1.33e+06           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       7.817477998049       residual = 1.07e+06           smallest_sin_value = 1.00e+00
davidson iteration   42 stopping due to too large eigenvalue change
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+10 is 1.013520e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743868675862       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743868675862       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743868675862       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743868675862       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743868675857       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743868675571       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743868733797       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744032479851       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743682291316       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743670784998       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743959389746       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743928499657       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743693945081       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744128041131       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743743667327       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743899776548       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743910970200       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743894754114       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743830821178       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743876859560       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743871922671       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743913623036       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744528891099       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743809255179       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739943375360       residual = 3.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742883800913       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745970904308       residual = 3.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741334436250       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743802341382       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748544813588       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747432772168       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.778298346304       residual = 2.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.770376362031       residual = 9.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -5.187863819211       residual = 3.45e+04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.128110761343       residual = 6.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   35 stopping due to too large eigenvalue change
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+10 is 2.533424e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.984666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1025e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6397
    reference variance = 0.493686
====================================================
  Execution time = 2.7476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5958e-01
  Total weights = 1.9552e+06
  Execution time = 3.5950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447496387211
                                         uncertainty =       0.003696654503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447496387211
                                         uncertainty =       0.003696654503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473026529
  error estimate for blocks of size 2^( 2) =       0.000496571371
  error estimate for blocks of size 2^( 3) =       0.000519176743
  error estimate for blocks of size 2^( 4) =       0.000535608242
  error estimate for blocks of size 2^( 5) =       0.000544571970
  error estimate for blocks of size 2^( 6) =       0.000549293143
  error estimate for blocks of size 2^( 7) =       0.000550898694

      target function =      -0.737522270789
              le_mean =     -22.662005904206
             les_mean =     514.026095565591
             stat err =       0.000545093012
             autocorr =       1.327914868603
   target nu stat err =       0.000545093012
   target dn stat err =       0.004971572982
      target stat err =       0.004032877651
              std dev =       0.668960532220
             le_variance =       0.447508193669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447496387211
                                         uncertainty =       0.003696654503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447496387211
                                         uncertainty =       0.003696654503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473026529
  error estimate for blocks of size 2^( 2) =       0.000496571371
  error estimate for blocks of size 2^( 3) =       0.000519176743
  error estimate for blocks of size 2^( 4) =       0.000535608242
  error estimate for blocks of size 2^( 5) =       0.000544571970
  error estimate for blocks of size 2^( 6) =       0.000549293143
  error estimate for blocks of size 2^( 7) =       0.000550898694

      target function =      -0.737522270789
              le_mean =     -22.662005904206
             les_mean =     514.026095565591
             stat err =       0.000545093012
             autocorr =       1.327914868607
   target nu stat err =       0.000545093012
   target dn stat err =       0.004971572982
      target stat err =       0.004032877651
              std dev =       0.668960532220
             le_variance =       0.447508193669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447496387211
                                         uncertainty =       0.003696654503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447496387211
                                         uncertainty =       0.003696654503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473026529
  error estimate for blocks of size 2^( 2) =       0.000496571371
  error estimate for blocks of size 2^( 3) =       0.000519176743
  error estimate for blocks of size 2^( 4) =       0.000535608242
  error estimate for blocks of size 2^( 5) =       0.000544571970
  error estimate for blocks of size 2^( 6) =       0.000549293143
  error estimate for blocks of size 2^( 7) =       0.000550898694

      target function =      -0.737522270789
              le_mean =     -22.662005904206
             les_mean =     514.026095565591
             stat err =       0.000545093012
             autocorr =       1.327914868604
   target nu stat err =       0.000545093012
   target dn stat err =       0.004971572982
      target stat err =       0.004032877651
              std dev =       0.668960532220
             le_variance =       0.447508193669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447496387211
                                         uncertainty =       0.003696654503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447496387211
                                         uncertainty =       0.003696654503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473026529
  error estimate for blocks of size 2^( 2) =       0.000496571371
  error estimate for blocks of size 2^( 3) =       0.000519176743
  error estimate for blocks of size 2^( 4) =       0.000535608242
  error estimate for blocks of size 2^( 5) =       0.000544571970
  error estimate for blocks of size 2^( 6) =       0.000549293143
  error estimate for blocks of size 2^( 7) =       0.000550898694

      target function =      -0.737522270789
              le_mean =     -22.662005904206
             les_mean =     514.026095565592
             stat err =       0.000545093012
             autocorr =       1.327914868605
   target nu stat err =       0.000545093012
   target dn stat err =       0.004971572982
      target stat err =       0.004032877651
              std dev =       0.668960532220
             le_variance =       0.447508193668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737522270789        initial
     5.8208e+09     5.8208e+10             4.0507e-14        -0.737522270789  <--
     2.3283e+10     2.3283e+11             1.0135e-14        -0.737522270789
     9.3132e+10     9.3132e+11             2.5334e-15        -0.737522270789

*****************************************************************************
Applying the update for shift_i =   5.8208e+09     and shift_s =   5.8208e+10
*****************************************************************************

  Execution time = 4.5606e+01
  </log>
  <optVariables href="FORM.s055.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6638e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.5986
    reference variance = 0.35817
====================================================
  Execution time = 2.6480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5150e-01
  Total weights = 1.955313155e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7497e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442599239329
                                         uncertainty =       0.002555801492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442599239329
                                         uncertainty =       0.002555801492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470397707
  error estimate for blocks of size 2^( 2) =       0.000494473670
  error estimate for blocks of size 2^( 3) =       0.000516974732
  error estimate for blocks of size 2^( 4) =       0.000533260947
  error estimate for blocks of size 2^( 5) =       0.000543408154
  error estimate for blocks of size 2^( 6) =       0.000547489966
  error estimate for blocks of size 2^( 7) =       0.000550131324

      target function =      -0.744076575439
              le_mean =     -22.661802478656
             les_mean =     514.008792068056
             stat err =       0.000543572598
             autocorr =       1.335318049241
   target nu stat err =       0.000543572598
   target dn stat err =       0.003181651909
      target stat err =       0.002665205558
              std dev =       0.665242816423
             le_variance =       0.442548004803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266180247866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744085031381       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744085031381       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744085031381       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744085031381       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744085509186       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744085219706       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744085204519       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744083774910       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744088277461       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744084245413       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744084370518       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+09 is 1.172618e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744085031381       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744085031381       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744085031381       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744085031381       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744084906289       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744090504781       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744078467688       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744093644331       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744082887807       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744088484609       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744085429277       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744081836195       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+09 is 2.928639e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744085031381       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744085031381       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744085031381       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744077557123       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744082287787       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744076798081       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744085031381       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744085031381       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744100106010       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744024756735       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744115363105       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744090523945       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744084694553       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744067737142       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744023398571       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744057416493       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744115317944       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744098762518       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744069299612       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744103087736       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744132851502       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744074340369       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745068764217       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743291315486       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744427616555       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743628292566       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744375534912       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744049116421       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744140295682       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.744209281773       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743207706841       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741824755066       residual = 8.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744233577758       residual = 7.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.700326717576       residual = 1.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.784359041849       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.710406072451       residual = 2.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.695702085893       residual = 3.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.666473785095       residual = 4.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.811168870769       residual = 9.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       3.193206316058       residual = 1.52e+06           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =       0.448986026965       residual = 2.08e+06           smallest_sin_value = 1.00e+00
davidson iteration   41 stopping due to too large eigenvalue change
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+10 is 7.334484e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.014674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1265e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.6028
    reference variance = 0.368729
====================================================
  Execution time = 2.5623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5708e-01
  Total weights = 1.9553e+06
  Execution time = 3.5898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445194390246
                                         uncertainty =       0.004848352749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445194390246
                                         uncertainty =       0.004848352749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471783650
  error estimate for blocks of size 2^( 2) =       0.000496160718
  error estimate for blocks of size 2^( 3) =       0.000517848287
  error estimate for blocks of size 2^( 4) =       0.000534468995
  error estimate for blocks of size 2^( 5) =       0.000544001712
  error estimate for blocks of size 2^( 6) =       0.000548975437
  error estimate for blocks of size 2^( 7) =       0.000551249563

      target function =      -0.739519877720
              le_mean =     -22.661606041897
             les_mean =     514.005473285289
             stat err =       0.000544673927
             autocorr =       1.332868794836
   target nu stat err =       0.000544673927
   target dn stat err =       0.006135443724
      target stat err =       0.004982272736
              std dev =       0.667202836498
             le_variance =       0.445159625031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445194390246
                                         uncertainty =       0.004848352749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445194390246
                                         uncertainty =       0.004848352749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471783650
  error estimate for blocks of size 2^( 2) =       0.000496160718
  error estimate for blocks of size 2^( 3) =       0.000517848287
  error estimate for blocks of size 2^( 4) =       0.000534468995
  error estimate for blocks of size 2^( 5) =       0.000544001712
  error estimate for blocks of size 2^( 6) =       0.000548975437
  error estimate for blocks of size 2^( 7) =       0.000551249563

      target function =      -0.739519877724
              le_mean =     -22.661606041897
             les_mean =     514.005473285284
             stat err =       0.000544673927
             autocorr =       1.332868794830
   target nu stat err =       0.000544673927
   target dn stat err =       0.006135443724
      target stat err =       0.004982272736
              std dev =       0.667202836498
             le_variance =       0.445159625031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445194390246
                                         uncertainty =       0.004848352749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445194390246
                                         uncertainty =       0.004848352749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471783650
  error estimate for blocks of size 2^( 2) =       0.000496160718
  error estimate for blocks of size 2^( 3) =       0.000517848287
  error estimate for blocks of size 2^( 4) =       0.000534468995
  error estimate for blocks of size 2^( 5) =       0.000544001712
  error estimate for blocks of size 2^( 6) =       0.000548975437
  error estimate for blocks of size 2^( 7) =       0.000551249563

      target function =      -0.739519877722
              le_mean =     -22.661606041897
             les_mean =     514.005473285287
             stat err =       0.000544673927
             autocorr =       1.332868794837
   target nu stat err =       0.000544673927
   target dn stat err =       0.006135443724
      target stat err =       0.004982272736
              std dev =       0.667202836498
             le_variance =       0.445159625031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445194390246
                                         uncertainty =       0.004848352749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445194390246
                                         uncertainty =       0.004848352749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471783650
  error estimate for blocks of size 2^( 2) =       0.000496160718
  error estimate for blocks of size 2^( 3) =       0.000517848287
  error estimate for blocks of size 2^( 4) =       0.000534468995
  error estimate for blocks of size 2^( 5) =       0.000544001712
  error estimate for blocks of size 2^( 6) =       0.000548975437
  error estimate for blocks of size 2^( 7) =       0.000551249563

      target function =      -0.739519877721
              le_mean =     -22.661606041897
             les_mean =     514.005473285289
             stat err =       0.000544673927
             autocorr =       1.332868794835
   target nu stat err =       0.000544673927
   target dn stat err =       0.006135443724
      target stat err =       0.004982272736
              std dev =       0.667202836498
             le_variance =       0.445159625031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739519877720        initial
     1.4552e+09     1.4552e+10             1.1726e-13        -0.739519877724  <--
     5.8208e+09     5.8208e+10             2.9286e-14        -0.739519877722
     2.3283e+10     2.3283e+11             7.3345e-15        -0.739519877721

*****************************************************************************
Applying the update for shift_i =   1.4552e+09     and shift_s =   1.4552e+10
*****************************************************************************

  Execution time = 4.3697e+01
  </log>
  <optVariables href="FORM.s056.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4978e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.565
    reference variance = 0.46679
====================================================
  Execution time = 2.6212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5370e-01
  Total weights = 1.955274231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445179072266
                                         uncertainty =       0.002702131662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445179072266
                                         uncertainty =       0.002702131662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471758493
  error estimate for blocks of size 2^( 2) =       0.000495669738
  error estimate for blocks of size 2^( 3) =       0.000517127793
  error estimate for blocks of size 2^( 4) =       0.000532809887
  error estimate for blocks of size 2^( 5) =       0.000543651807
  error estimate for blocks of size 2^( 6) =       0.000548559784
  error estimate for blocks of size 2^( 7) =       0.000549480594

      target function =      -0.742287238862
              le_mean =     -22.661957007468
             les_mean =     514.017993016323
             stat err =       0.000543625518
             autocorr =       1.327884230251
   target nu stat err =       0.000543625518
   target dn stat err =       0.003331893207
      target stat err =       0.002772468802
              std dev =       0.667167259430
             le_variance =       0.445112152055


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266195700747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742296641246       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742296641246       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742296641246       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742296641246       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742296568702       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742296675740       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742296174968       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742296457594       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742296396124       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742296974577       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+08 is 7.026695e-13

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742296641246       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742296641246       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742296641246       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742296641246       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742296356818       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742296184349       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742297021784       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742296641246       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742299466237       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742297613261       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+09 is 1.756262e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742296641246       residual = 1.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742296641246       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742296641246       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742295918946       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742294095026       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742295223606       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742295571649       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742297535371       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742301569963       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742288223315       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742283928762       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+09 is 4.384269e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.018434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0968e+01
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.7054
    reference variance = 1.65037
====================================================
  Execution time = 2.7794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5633e-01
  Total weights = 1.9552e+06
  Execution time = 3.5882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443243160316
                                         uncertainty =       0.003761498315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443243160316
                                         uncertainty =       0.003761498315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470793172
  error estimate for blocks of size 2^( 2) =       0.000494592844
  error estimate for blocks of size 2^( 3) =       0.000517436718
  error estimate for blocks of size 2^( 4) =       0.000533291797
  error estimate for blocks of size 2^( 5) =       0.000542441190
  error estimate for blocks of size 2^( 6) =       0.000546428671
  error estimate for blocks of size 2^( 7) =       0.000549193283

      target function =      -0.740129073067
              le_mean =     -22.661531346475
             les_mean =     514.001332014181
             stat err =       0.000542838735
             autocorr =       1.329478594424
   target nu stat err =       0.000542838735
   target dn stat err =       0.006207591719
      target stat err =       0.005047493667
              std dev =       0.665802088427
             le_variance =       0.443292420954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443243160316
                                         uncertainty =       0.003761498315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443243160316
                                         uncertainty =       0.003761498315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470793172
  error estimate for blocks of size 2^( 2) =       0.000494592844
  error estimate for blocks of size 2^( 3) =       0.000517436718
  error estimate for blocks of size 2^( 4) =       0.000533291797
  error estimate for blocks of size 2^( 5) =       0.000542441190
  error estimate for blocks of size 2^( 6) =       0.000546428671
  error estimate for blocks of size 2^( 7) =       0.000549193283

      target function =      -0.740129073064
              le_mean =     -22.661531346475
             les_mean =     514.001332014184
             stat err =       0.000542838735
             autocorr =       1.329478594429
   target nu stat err =       0.000542838735
   target dn stat err =       0.006207591719
      target stat err =       0.005047493667
              std dev =       0.665802088427
             le_variance =       0.443292420953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443243160316
                                         uncertainty =       0.003761498315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443243160316
                                         uncertainty =       0.003761498315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470793172
  error estimate for blocks of size 2^( 2) =       0.000494592844
  error estimate for blocks of size 2^( 3) =       0.000517436718
  error estimate for blocks of size 2^( 4) =       0.000533291797
  error estimate for blocks of size 2^( 5) =       0.000542441190
  error estimate for blocks of size 2^( 6) =       0.000546428671
  error estimate for blocks of size 2^( 7) =       0.000549193283

      target function =      -0.740129073065
              le_mean =     -22.661531346475
             les_mean =     514.001332014182
             stat err =       0.000542838735
             autocorr =       1.329478594428
   target nu stat err =       0.000542838735
   target dn stat err =       0.006207591719
      target stat err =       0.005047493667
              std dev =       0.665802088427
             le_variance =       0.443292420953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443243160316
                                         uncertainty =       0.003761498315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443243160316
                                         uncertainty =       0.003761498315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470793172
  error estimate for blocks of size 2^( 2) =       0.000494592844
  error estimate for blocks of size 2^( 3) =       0.000517436718
  error estimate for blocks of size 2^( 4) =       0.000533291797
  error estimate for blocks of size 2^( 5) =       0.000542441190
  error estimate for blocks of size 2^( 6) =       0.000546428671
  error estimate for blocks of size 2^( 7) =       0.000549193283

      target function =      -0.740129073066
              le_mean =     -22.661531346475
             les_mean =     514.001332014181
             stat err =       0.000542838735
             autocorr =       1.329478594430
   target nu stat err =       0.000542838735
   target dn stat err =       0.006207591719
      target stat err =       0.005047493667
              std dev =       0.665802088427
             le_variance =       0.443292420954


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740129073067        initial  <--
     3.6380e+08     3.6380e+09             7.0267e-13        -0.740129073064
     1.4552e+09     1.4552e+10             1.7563e-13        -0.740129073065
     5.8208e+09     5.8208e+10             4.3843e-14        -0.740129073066

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.8395
  </log>
  <optVariables href="FORM.s057.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6814e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6863
    reference variance = 0.370339
====================================================
  Execution time = 2.6441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5071e-01
  Total weights = 1.955208228e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439801170997
                                         uncertainty =       0.002396727692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439801170997
                                         uncertainty =       0.002396727692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468967061
  error estimate for blocks of size 2^( 2) =       0.000492931682
  error estimate for blocks of size 2^( 3) =       0.000515708931
  error estimate for blocks of size 2^( 4) =       0.000532013004
  error estimate for blocks of size 2^( 5) =       0.000542293293
  error estimate for blocks of size 2^( 6) =       0.000546771732
  error estimate for blocks of size 2^( 7) =       0.000550817102

      target function =      -0.744720027943
              le_mean =     -22.661648127269
             les_mean =     514.001005380999
             stat err =       0.000542973783
             autocorr =       1.340519207510
   target nu stat err =       0.000542973783
   target dn stat err =       0.003350964683
      target stat err =       0.002804064732
              std dev =       0.663219577527
             le_variance =       0.439860208015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266164812727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+09, overlap shift 3.6380e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744729633538       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744729633538       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744729633538       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744729633538       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744729633533       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744728304415       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744729530989       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744726284883       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744728558769       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744729851088       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744739203329       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744728500075       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+09 is 5.843107e-14

solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744729633538       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744729633538       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744729633538       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744722024696       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744726266929       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744729633421       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744732842605       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744712532187       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744705158763       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744715177770       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744724787535       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744709462553       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744729281825       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744730554923       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744747382582       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+10 is 1.458713e-14

solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744729633538       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744729633538       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744729633538       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744729633538       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744729633538       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744729631879       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744729639980       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744697279248       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744884001321       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744611101762       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744735918992       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744629376872       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744670353351       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744483458381       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744716537181       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744767799166       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744769053290       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744892961685       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744711279311       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744604814067       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744286566387       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743212897166       residual = 9.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.728181717094       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.758429714783       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.767072960149       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.787599605766       residual = 2.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.403388790428       residual = 1.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.194432851881       residual = 1.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.835808317448       residual = 5.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.063401882602       residual = 1.14e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       2.446044857685       residual = 3.04e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941386174569       residual = 2.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.042069900928       residual = 3.42e+04           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+10 is 3.645243e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.037310 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1190e+01
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6014
    reference variance = 0.309923
====================================================
  Execution time = 2.5780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4855e-01
  Total weights = 1.9553e+06
  Execution time = 3.6061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438070218991
                                         uncertainty =       0.001929128076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438070218991
                                         uncertainty =       0.001929128076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467968037
  error estimate for blocks of size 2^( 2) =       0.000491789782
  error estimate for blocks of size 2^( 3) =       0.000514596264
  error estimate for blocks of size 2^( 4) =       0.000530724910
  error estimate for blocks of size 2^( 5) =       0.000539130151
  error estimate for blocks of size 2^( 6) =       0.000543297822
  error estimate for blocks of size 2^( 7) =       0.000546665927

      target function =      -0.746494257313
              le_mean =     -22.661513091916
             les_mean =     513.992721900327
             stat err =       0.000539954702
             autocorr =       1.331319438692
   target nu stat err =       0.000539954702
   target dn stat err =       0.002761948159
      target stat err =       0.002345162761
              std dev =       0.661806744801
             le_variance =       0.437988167464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438070218991
                                         uncertainty =       0.001929128076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438070218991
                                         uncertainty =       0.001929128076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467968037
  error estimate for blocks of size 2^( 2) =       0.000491789782
  error estimate for blocks of size 2^( 3) =       0.000514596264
  error estimate for blocks of size 2^( 4) =       0.000530724910
  error estimate for blocks of size 2^( 5) =       0.000539130151
  error estimate for blocks of size 2^( 6) =       0.000543297822
  error estimate for blocks of size 2^( 7) =       0.000546665927

      target function =      -0.746494257313
              le_mean =     -22.661513091916
             les_mean =     513.992721900327
             stat err =       0.000539954702
             autocorr =       1.331319438692
   target nu stat err =       0.000539954702
   target dn stat err =       0.002761948159
      target stat err =       0.002345162761
              std dev =       0.661806744801
             le_variance =       0.437988167464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438070218991
                                         uncertainty =       0.001929128076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438070218991
                                         uncertainty =       0.001929128076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467968037
  error estimate for blocks of size 2^( 2) =       0.000491789782
  error estimate for blocks of size 2^( 3) =       0.000514596264
  error estimate for blocks of size 2^( 4) =       0.000530724910
  error estimate for blocks of size 2^( 5) =       0.000539130151
  error estimate for blocks of size 2^( 6) =       0.000543297822
  error estimate for blocks of size 2^( 7) =       0.000546665927

      target function =      -0.746494257313
              le_mean =     -22.661513091916
             les_mean =     513.992721900327
             stat err =       0.000539954702
             autocorr =       1.331319438700
   target nu stat err =       0.000539954702
   target dn stat err =       0.002761948159
      target stat err =       0.002345162761
              std dev =       0.661806744801
             le_variance =       0.437988167464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438070218991
                                         uncertainty =       0.001929128076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438070218991
                                         uncertainty =       0.001929128076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467968037
  error estimate for blocks of size 2^( 2) =       0.000491789782
  error estimate for blocks of size 2^( 3) =       0.000514596264
  error estimate for blocks of size 2^( 4) =       0.000530724910
  error estimate for blocks of size 2^( 5) =       0.000539130151
  error estimate for blocks of size 2^( 6) =       0.000543297822
  error estimate for blocks of size 2^( 7) =       0.000546665927

      target function =      -0.746494257313
              le_mean =     -22.661513091916
             les_mean =     513.992721900327
             stat err =       0.000539954702
             autocorr =       1.331319438695
   target nu stat err =       0.000539954702
   target dn stat err =       0.002761948159
      target stat err =       0.002345162761
              std dev =       0.661806744801
             le_variance =       0.437988167464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746494257313        initial  <--
     3.6380e+09     3.6380e+10             5.8431e-14        -0.746494257313
     1.4552e+10     1.4552e+11             1.4587e-14        -0.746494257313
     5.8208e+10     5.8208e+11             3.6452e-15        -0.746494257313

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9020
  </log>
  <optVariables href="FORM.s058.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5144e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.683
    reference variance = 0.436059
====================================================
  Execution time = 2.6346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4777e-01
  Total weights = 1.954934098e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439783562793
                                         uncertainty =       0.002126362771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439783562793
                                         uncertainty =       0.002126362771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468930617
  error estimate for blocks of size 2^( 2) =       0.000492753024
  error estimate for blocks of size 2^( 3) =       0.000514707489
  error estimate for blocks of size 2^( 4) =       0.000530652447
  error estimate for blocks of size 2^( 5) =       0.000540732139
  error estimate for blocks of size 2^( 6) =       0.000547128321
  error estimate for blocks of size 2^( 7) =       0.000549155303

      target function =      -0.747142188252
              le_mean =     -22.662037372923
             les_mean =     514.015705878366
             stat err =       0.000541917052
             autocorr =       1.335514033916
   target nu stat err =       0.000541917052
   target dn stat err =       0.002720460698
      target stat err =       0.002318442341
              std dev =       0.663168038158
             le_variance =       0.439791846834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266203737292e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+10, overlap shift 3.6380e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747148350452       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747148350452       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747148350452       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747167474537       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747148350452       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747150615051       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747165871470       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747103223655       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747232007327       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747204033828       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747228095513       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747192486129       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747167357246       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747227954314       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747090878884       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746471609226       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747367898365       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745391140623       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749677760453       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.755032551124       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747690108509       residual = 6.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709630343840       residual = 3.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.754125281131       residual = 2.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.651191791548       residual = 1.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925211742023       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.653986859362       residual = 2.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.443449026676       residual = 7.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751908919054       residual = 2.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.210486044197       residual = 1.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.293809133483       residual = 1.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.648891866029       residual = 1.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.172281476267       residual = 2.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.733220817002       residual = 2.43e+03           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+10 is 6.367257e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+11, overlap shift 1.4552e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747148350452       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747148350452       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747148350452       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747150376622       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747148350452       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747080250774       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747346219749       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746925820171       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747228422113       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747146991891       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747101676138       residual = 7.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747006886773       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747191977373       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747073977224       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746917758569       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746604227700       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747247793374       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746891554486       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746728997293       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746814716032       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.750396830921       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746804362584       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747203742340       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749784386549       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749164070784       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749317594126       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.748853030298       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746619425181       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742372605789       residual = 5.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.762818943877       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.592316069673       residual = 2.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.028293453825       residual = 1.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       5.365079320155       residual = 1.57e+03           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+11 is 1.649313e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747148350452       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747148350452       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747148350452       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747148350452       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747320684714       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747608876136       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747261438426       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747149628447       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746534176001       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747518553287       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747745603026       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746930973244       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746098908424       residual = 9.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746681226771       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746879998274       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748551036994       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746891706122       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746105193551       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748216969065       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745630262932       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744791732771       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742660066172       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749383214921       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.738717029701       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740230796840       residual = 3.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743227922227       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.738338820100       residual = 8.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747094999718       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.763379797051       residual = 4.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.586199622853       residual = 1.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747839849968       residual = 2.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       2.761571084350       residual = 2.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.946585513400       residual = 2.79e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       0.382701435923       residual = 4.67e+02           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+11 is 4.383715e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.082365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1068e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.7183
    reference variance = 0.385813
====================================================
  Execution time = 2.7569e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5398e-01
  Total weights = 1.9555e+06
  Execution time = 3.5883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442715249056
                                         uncertainty =       0.001663434474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442715249056
                                         uncertainty =       0.001663434474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470469098
  error estimate for blocks of size 2^( 2) =       0.000494363715
  error estimate for blocks of size 2^( 3) =       0.000516043497
  error estimate for blocks of size 2^( 4) =       0.000530824332
  error estimate for blocks of size 2^( 5) =       0.000540817102
  error estimate for blocks of size 2^( 6) =       0.000544208955
  error estimate for blocks of size 2^( 7) =       0.000547360780

      target function =      -0.742061939922
              le_mean =     -22.662340844755
             les_mean =     514.035673369310
             stat err =       0.000540802792
             autocorr =       1.321343235462
   target nu stat err =       0.000540802792
   target dn stat err =       0.002905005718
      target stat err =       0.002433949180
              std dev =       0.665343778692
             le_variance =       0.442682343844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442715249056
                                         uncertainty =       0.001663434474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442715249056
                                         uncertainty =       0.001663434474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470469098
  error estimate for blocks of size 2^( 2) =       0.000494363715
  error estimate for blocks of size 2^( 3) =       0.000516043497
  error estimate for blocks of size 2^( 4) =       0.000530824332
  error estimate for blocks of size 2^( 5) =       0.000540817102
  error estimate for blocks of size 2^( 6) =       0.000544208955
  error estimate for blocks of size 2^( 7) =       0.000547360780

      target function =      -0.742061939922
              le_mean =     -22.662340844755
             les_mean =     514.035673369310
             stat err =       0.000540802792
             autocorr =       1.321343235457
   target nu stat err =       0.000540802792
   target dn stat err =       0.002905005718
      target stat err =       0.002433949180
              std dev =       0.665343778692
             le_variance =       0.442682343844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442715249056
                                         uncertainty =       0.001663434474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442715249056
                                         uncertainty =       0.001663434474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470469098
  error estimate for blocks of size 2^( 2) =       0.000494363715
  error estimate for blocks of size 2^( 3) =       0.000516043497
  error estimate for blocks of size 2^( 4) =       0.000530824332
  error estimate for blocks of size 2^( 5) =       0.000540817102
  error estimate for blocks of size 2^( 6) =       0.000544208955
  error estimate for blocks of size 2^( 7) =       0.000547360780

      target function =      -0.742061939922
              le_mean =     -22.662340844755
             les_mean =     514.035673369310
             stat err =       0.000540802792
             autocorr =       1.321343235457
   target nu stat err =       0.000540802792
   target dn stat err =       0.002905005718
      target stat err =       0.002433949180
              std dev =       0.665343778692
             le_variance =       0.442682343844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442715249056
                                         uncertainty =       0.001663434474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442715249056
                                         uncertainty =       0.001663434474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470469098
  error estimate for blocks of size 2^( 2) =       0.000494363715
  error estimate for blocks of size 2^( 3) =       0.000516043497
  error estimate for blocks of size 2^( 4) =       0.000530824332
  error estimate for blocks of size 2^( 5) =       0.000540817102
  error estimate for blocks of size 2^( 6) =       0.000544208955
  error estimate for blocks of size 2^( 7) =       0.000547360780

      target function =      -0.742061939922
              le_mean =     -22.662340844755
             les_mean =     514.035673369310
             stat err =       0.000540802792
             autocorr =       1.321343235456
   target nu stat err =       0.000540802792
   target dn stat err =       0.002905005718
      target stat err =       0.002433949180
              std dev =       0.665343778692
             le_variance =       0.442682343844


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742061939922        initial
     3.6380e+10     3.6380e+11             6.3673e-15        -0.742061939922  <--
     1.4552e+11     1.4552e+12             1.6493e-15        -0.742061939922
     5.8208e+11     5.8208e+12             4.3837e-16        -0.742061939922

*****************************************************************************
Applying the update for shift_i =   3.6380e+10     and shift_s =   3.6380e+11
*****************************************************************************

  Execution time = 4.5647e+01
  </log>
  <optVariables href="FORM.s059.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.7602
    reference variance = 0.352588
====================================================
  Execution time = 2.6284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5518e-01
  Total weights = 1.955003995e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441964900725
                                         uncertainty =       0.003910199978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441964900725
                                         uncertainty =       0.003910199978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470050344
  error estimate for blocks of size 2^( 2) =       0.000493855438
  error estimate for blocks of size 2^( 3) =       0.000515700689
  error estimate for blocks of size 2^( 4) =       0.000531503663
  error estimate for blocks of size 2^( 5) =       0.000539774365
  error estimate for blocks of size 2^( 6) =       0.000544745050
  error estimate for blocks of size 2^( 7) =       0.000547515240

      target function =      -0.741051399727
              le_mean =     -22.660900207388
             les_mean =     513.971582301729
             stat err =       0.000540884579
             autocorr =       1.324098978802
   target nu stat err =       0.000540884579
   target dn stat err =       0.006142953364
      target stat err =       0.005003121797
              std dev =       0.664751571128
             le_variance =       0.441894651317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266090020739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+09, overlap shift 9.0949e+10 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741083972532       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741083972532       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741083972532       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741083972532       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741083972536       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741083972532       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741083978060       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741089685664       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741078914875       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741074875363       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741084759330       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741062466044       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+09 is 3.871671e-14

solving harmonic davidson linear method for identity shift 3.6380e+10, overlap shift 3.6380e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741083972532       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741083972532       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741083972532       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741083972532       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741084774908       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741083988363       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741069055961       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741099021934       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741183264302       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741083163127       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741060243603       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741191631456       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741074082762       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741066587040       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741050382774       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741151139169       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741201412204       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741129165147       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741055164240       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741116793713       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740996684969       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741302222167       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740838172829       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742181333765       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739568945498       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740670422231       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.738924660213       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.756515592086       residual = 5.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.718376553565       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.755931852457       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.782640748113       residual = 2.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.892914325993       residual = 1.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.969823773165       residual = 2.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       0.095002802756       residual = 7.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       2.382104042396       residual = 8.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       1.361884827519       residual = 1.86e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.557619343669       residual = 1.44e+04           smallest_sin_value = 1.00e+00
davidson iteration   37 stopping due to too large eigenvalue change
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+10 is 9.399858e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+11, overlap shift 1.4552e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741083972532       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741083972532       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741083972532       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741083972532       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741083972535       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741083972532       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741084037941       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741093878616       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741766545078       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741427150464       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740989141660       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741081817136       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741060413207       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741097820829       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741413649438       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740854110360       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741073507304       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744674207497       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741358186876       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739900102882       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.806475288742       residual = 2.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.709744692824       residual = 8.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744303690076       residual = 4.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.765277762130       residual = 6.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.669506508381       residual = 3.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.631382947442       residual = 7.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.874407671820       residual = 4.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.405019750332       residual = 4.45e+04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.197411548234       residual = 8.27e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.877946153694       residual = 3.25e+05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.542227124478       residual = 5.64e+05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.148446208580       residual = 3.46e+05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -3.440965776532       residual = 6.54e+05           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+11 is 2.420973e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.118451 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1068e+01
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.7637
    reference variance = 1.49641
====================================================
  Execution time = 2.5591e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5207e-01
  Total weights = 1.9554e+06
  Execution time = 3.5853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441331464199
                                         uncertainty =       0.002239965717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441331464199
                                         uncertainty =       0.002239965717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469767853
  error estimate for blocks of size 2^( 2) =       0.000493692422
  error estimate for blocks of size 2^( 3) =       0.000516126383
  error estimate for blocks of size 2^( 4) =       0.000531151472
  error estimate for blocks of size 2^( 5) =       0.000539938259
  error estimate for blocks of size 2^( 6) =       0.000545160290
  error estimate for blocks of size 2^( 7) =       0.000548031277

      target function =      -0.743611222090
              le_mean =     -22.661635762335
             les_mean =     514.001804667447
             stat err =       0.000541070325
             autocorr =       1.326602595917
   target nu stat err =       0.000541070325
   target dn stat err =       0.003095032830
      target stat err =       0.002591900028
              std dev =       0.664352069028
             le_variance =       0.441363671621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441331464199
                                         uncertainty =       0.002239965717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441331464199
                                         uncertainty =       0.002239965717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469767853
  error estimate for blocks of size 2^( 2) =       0.000493692422
  error estimate for blocks of size 2^( 3) =       0.000516126383
  error estimate for blocks of size 2^( 4) =       0.000531151472
  error estimate for blocks of size 2^( 5) =       0.000539938259
  error estimate for blocks of size 2^( 6) =       0.000545160290
  error estimate for blocks of size 2^( 7) =       0.000548031277

      target function =      -0.743611222090
              le_mean =     -22.661635762335
             les_mean =     514.001804667447
             stat err =       0.000541070325
             autocorr =       1.326602595916
   target nu stat err =       0.000541070325
   target dn stat err =       0.003095032830
      target stat err =       0.002591900028
              std dev =       0.664352069028
             le_variance =       0.441363671621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441331464199
                                         uncertainty =       0.002239965717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441331464199
                                         uncertainty =       0.002239965717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469767853
  error estimate for blocks of size 2^( 2) =       0.000493692422
  error estimate for blocks of size 2^( 3) =       0.000516126383
  error estimate for blocks of size 2^( 4) =       0.000531151472
  error estimate for blocks of size 2^( 5) =       0.000539938259
  error estimate for blocks of size 2^( 6) =       0.000545160290
  error estimate for blocks of size 2^( 7) =       0.000548031277

      target function =      -0.743611222090
              le_mean =     -22.661635762335
             les_mean =     514.001804667447
             stat err =       0.000541070325
             autocorr =       1.326602595917
   target nu stat err =       0.000541070325
   target dn stat err =       0.003095032830
      target stat err =       0.002591900028
              std dev =       0.664352069028
             le_variance =       0.441363671621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441331464199
                                         uncertainty =       0.002239965717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441331464199
                                         uncertainty =       0.002239965717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469767853
  error estimate for blocks of size 2^( 2) =       0.000493692422
  error estimate for blocks of size 2^( 3) =       0.000516126383
  error estimate for blocks of size 2^( 4) =       0.000531151472
  error estimate for blocks of size 2^( 5) =       0.000539938259
  error estimate for blocks of size 2^( 6) =       0.000545160290
  error estimate for blocks of size 2^( 7) =       0.000548031277

      target function =      -0.743611222090
              le_mean =     -22.661635762335
             les_mean =     514.001804667447
             stat err =       0.000541070325
             autocorr =       1.326602595916
   target nu stat err =       0.000541070325
   target dn stat err =       0.003095032830
      target stat err =       0.002591900028
              std dev =       0.664352069028
             le_variance =       0.441363671621


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743611222090        initial  <--
     9.0949e+09     9.0949e+10             3.8717e-14        -0.743611222090
     3.6380e+10     3.6380e+11             9.3999e-15        -0.743611222090
     1.4552e+11     1.4552e+12             2.4210e-15        -0.743611222090

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6382
  </log>
  <optVariables href="FORM.s060.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2663e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.6113
    reference variance = 0.359667
====================================================
  Execution time = 2.6191e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.6195e-01
  Total weights = 1.955307522e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446487537642
                                         uncertainty =       0.007761255632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446487537642
                                         uncertainty =       0.007761255632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472503920
  error estimate for blocks of size 2^( 2) =       0.000496333226
  error estimate for blocks of size 2^( 3) =       0.000518234078
  error estimate for blocks of size 2^( 4) =       0.000534691569
  error estimate for blocks of size 2^( 5) =       0.000541655871
  error estimate for blocks of size 2^( 6) =       0.000546929424
  error estimate for blocks of size 2^( 7) =       0.000550457811

      target function =      -0.735536693745
              le_mean =     -22.662874088904
             les_mean =     514.067815397610
             stat err =       0.000543433669
             autocorr =       1.322763650895
   target nu stat err =       0.000543433669
   target dn stat err =       0.011104604825
      target stat err =       0.008894110029
              std dev =       0.668221451759
             le_variance =       0.446519908590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266287408890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735644005184       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735644005184       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735644005184       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735644005183       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735597674450       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735695962546       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735752275930       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735682491632       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735806414517       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735670904060       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735682318303       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735621583696       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.735450012500       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.735555173343       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.735265117623       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.735393702548       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.735616122341       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.735722092220       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.735595171756       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736143854784       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736168136844       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.735290309381       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.735209016007       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736100459135       residual = 9.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.737049190317       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.733719027236       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736968535824       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739320114164       residual = 9.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.763994594705       residual = 2.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.771099714182       residual = 6.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.791461437298       residual = 1.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.589984243082       residual = 9.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.903312934797       residual = 2.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -2.934468220851       residual = 9.47e+05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -4.998173690904       residual = 7.73e+06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.140228730194       residual = 2.63e+06           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+10 is 7.184039e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735644005184       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735644005184       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735644005184       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735644005184       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735486225504       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735719220956       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735493631582       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735612165677       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735914758188       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735835894274       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734532194018       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735552088995       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736477877431       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736198286606       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.735557744862       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.735929655781       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.735404198409       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.734453759493       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736501879363       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.733320689845       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.735711822101       residual = 5.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736696093706       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739335898946       residual = 7.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.732113121124       residual = 6.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734858804495       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.738739340194       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.738875309823       residual = 4.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.740548938172       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.756091731812       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.717497322742       residual = 3.85e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.725965303171       residual = 4.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.733042939056       residual = 8.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.856350235520       residual = 2.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.383835367281       residual = 8.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.348270795879       residual = 6.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.342136507499       residual = 1.55e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.259116991070       residual = 6.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.821367825709       residual = 2.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.716966391109       residual = 2.90e+01           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.516037308338       residual = 1.16e+02           smallest_sin_value = 9.96e-01
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+11 is 1.805694e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735644005184       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735644005184       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735644005184       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735644005184       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735644005137       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735644005184       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735282126433       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735488713715       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736947148421       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738883648011       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.733420934659       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735859029414       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.734843625631       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.732924734270       residual = 4.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.735684225453       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.734104397654       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.737398615149       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.717485687463       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.731634107378       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736448991626       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.709750743239       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.777535117998       residual = 2.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745222954856       residual = 5.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.820424179721       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.723289309682       residual = 5.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.592187911417       residual = 7.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.698550766168       residual = 2.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       0.059179575727       residual = 2.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.663874613567       residual = 8.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       3.161689823170       residual = 1.68e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.342307112173       residual = 6.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       1.888693580020       residual = 2.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.945131305104       residual = 4.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       7.515214144217       residual = 1.08e+04           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+12 is 4.533303e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.178435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0932e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.5714
    reference variance = 0.26371
====================================================
  Execution time = 2.7482e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4767e-01
  Total weights = 1.9552e+06
  Execution time = 3.6985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855232417
                                         uncertainty =       0.002461119777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855232417
                                         uncertainty =       0.002461119777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468443387
  error estimate for blocks of size 2^( 2) =       0.000492179524
  error estimate for blocks of size 2^( 3) =       0.000514061461
  error estimate for blocks of size 2^( 4) =       0.000529347501
  error estimate for blocks of size 2^( 5) =       0.000538665092
  error estimate for blocks of size 2^( 6) =       0.000544984010
  error estimate for blocks of size 2^( 7) =       0.000548674341

      target function =      -0.747215626726
              le_mean =     -22.661417203113
             les_mean =     513.987496377163
             stat err =       0.000540417736
             autocorr =       1.330898582575
   target nu stat err =       0.000540417736
   target dn stat err =       0.002831850697
      target stat err =       0.002405038604
              std dev =       0.662478991384
             le_variance =       0.438878414025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855232417
                                         uncertainty =       0.002461119777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855232417
                                         uncertainty =       0.002461119777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468443387
  error estimate for blocks of size 2^( 2) =       0.000492179524
  error estimate for blocks of size 2^( 3) =       0.000514061461
  error estimate for blocks of size 2^( 4) =       0.000529347501
  error estimate for blocks of size 2^( 5) =       0.000538665092
  error estimate for blocks of size 2^( 6) =       0.000544984010
  error estimate for blocks of size 2^( 7) =       0.000548674341

      target function =      -0.747215626726
              le_mean =     -22.661417203113
             les_mean =     513.987496377163
             stat err =       0.000540417736
             autocorr =       1.330898582571
   target nu stat err =       0.000540417736
   target dn stat err =       0.002831850697
      target stat err =       0.002405038604
              std dev =       0.662478991384
             le_variance =       0.438878414025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855232417
                                         uncertainty =       0.002461119777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855232417
                                         uncertainty =       0.002461119777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468443387
  error estimate for blocks of size 2^( 2) =       0.000492179524
  error estimate for blocks of size 2^( 3) =       0.000514061461
  error estimate for blocks of size 2^( 4) =       0.000529347501
  error estimate for blocks of size 2^( 5) =       0.000538665092
  error estimate for blocks of size 2^( 6) =       0.000544984010
  error estimate for blocks of size 2^( 7) =       0.000548674341

      target function =      -0.747215626726
              le_mean =     -22.661417203113
             les_mean =     513.987496377163
             stat err =       0.000540417736
             autocorr =       1.330898582573
   target nu stat err =       0.000540417736
   target dn stat err =       0.002831850697
      target stat err =       0.002405038604
              std dev =       0.662478991384
             le_variance =       0.438878414025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855232417
                                         uncertainty =       0.002461119777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438855232417
                                         uncertainty =       0.002461119777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468443387
  error estimate for blocks of size 2^( 2) =       0.000492179524
  error estimate for blocks of size 2^( 3) =       0.000514061461
  error estimate for blocks of size 2^( 4) =       0.000529347501
  error estimate for blocks of size 2^( 5) =       0.000538665092
  error estimate for blocks of size 2^( 6) =       0.000544984010
  error estimate for blocks of size 2^( 7) =       0.000548674341

      target function =      -0.747215626726
              le_mean =     -22.661417203113
             les_mean =     513.987496377163
             stat err =       0.000540417736
             autocorr =       1.330898582574
   target nu stat err =       0.000540417736
   target dn stat err =       0.002831850697
      target stat err =       0.002405038604
              std dev =       0.662478991384
             le_variance =       0.438878414025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747215626726        initial
     9.0949e+10     9.0949e+11             7.1840e-15        -0.747215626726  <--
     3.6380e+11     3.6380e+12             1.8057e-15        -0.747215626726
     1.4552e+12     1.4552e+13             4.5333e-16        -0.747215626726

*****************************************************************************
Applying the update for shift_i =   9.0949e+10     and shift_s =   9.0949e+11
*****************************************************************************

  Execution time = 4.5659e+01
  </log>
  <optVariables href="FORM.s061.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6635e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.7154
    reference variance = 0.487978
====================================================
  Execution time = 2.6290e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.4648e-01
  Total weights = 1.954938400e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437993652838
                                         uncertainty =       0.002085794406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437993652838
                                         uncertainty =       0.002085794406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467933918
  error estimate for blocks of size 2^( 2) =       0.000492198754
  error estimate for blocks of size 2^( 3) =       0.000515033293
  error estimate for blocks of size 2^( 4) =       0.000531518335
  error estimate for blocks of size 2^( 5) =       0.000539594520
  error estimate for blocks of size 2^( 6) =       0.000547549279
  error estimate for blocks of size 2^( 7) =       0.000549477637

      target function =      -0.748177849476
              le_mean =     -22.660310969336
             les_mean =     513.936170080084
             stat err =       0.000542034943
             autocorr =       1.341792986197
   target nu stat err =       0.000542034943
   target dn stat err =       0.002556140689
      target stat err =       0.002188280421
              std dev =       0.661758492995
             le_variance =       0.437924303051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266031096934e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+10, overlap shift 2.2737e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748183185673       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748183185673       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748183185673       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748183185673       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748183185417       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748183185660       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748183186241       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748244284530       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748140216541       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748155342981       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748170158744       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748228094364       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748132430707       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748152331181       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748192712028       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748187316100       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748152371364       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748186210806       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748132785478       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748221369698       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748180755410       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748023360725       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748386558038       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747730775931       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746306551004       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748915577675       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.762683323015       residual = 4.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744821872150       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.753246454485       residual = 6.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751075559855       residual = 5.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.870925683981       residual = 1.89e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.515435749419       residual = 2.45e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.668943683476       residual = 4.15e+04           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+10 is 9.267545e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748183185673       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748183185673       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748183185673       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748183185673       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748183185678       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748196701596       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748183207967       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748180867201       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748303766943       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747980899234       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748389179821       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748238610118       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748072946563       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748214863555       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748142056567       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747879521483       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747825906978       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747819107008       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747779836696       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747594762430       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748037064655       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746442743349       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747172786659       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744345848637       residual = 5.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747998217096       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749498405824       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743541592298       residual = 3.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.760533378643       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.657141799601       residual = 2.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.766447455099       residual = 9.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.292924390456       residual = 1.31e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745975544873       residual = 1.22e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.763122034363       residual = 3.63e+06           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+10 is 2.292923e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748183185673       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748183185673       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748183185673       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748183185673       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748183185673       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748183185673       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748182490383       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748184728046       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747703930621       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747746300908       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748538054655       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747034147275       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747629193398       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748857333484       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748034091754       residual = 6.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748876426502       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747861327097       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747389328627       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745376529254       residual = 5.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747431173018       residual = 9.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.758925630888       residual = 7.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.735536958562       residual = 3.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.689017739806       residual = 3.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.798774308139       residual = 3.79e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.992289187070       residual = 5.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       1.497565278057       residual = 3.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.606258784673       residual = 2.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.219256181268       residual = 5.11e+04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.881166730586       residual = 1.18e+05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.483453165394       residual = 1.45e+05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -2.285290394896       residual = 9.18e+05           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+11 is 5.808804e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.219871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1062e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.6059
    reference variance = 0.285141
====================================================
  Execution time = 2.5640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5299e-01
  Total weights = 1.9550e+06
  Execution time = 3.6060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443256298142
                                         uncertainty =       0.003341654161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443256298142
                                         uncertainty =       0.003341654161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470770449
  error estimate for blocks of size 2^( 2) =       0.000494884738
  error estimate for blocks of size 2^( 3) =       0.000517227701
  error estimate for blocks of size 2^( 4) =       0.000532903187
  error estimate for blocks of size 2^( 5) =       0.000542122781
  error estimate for blocks of size 2^( 6) =       0.000547188974
  error estimate for blocks of size 2^( 7) =       0.000549876154

      target function =      -0.742869918869
              le_mean =     -22.662849451774
             les_mean =     514.057731502106
             stat err =       0.000543022774
             autocorr =       1.330508643849
   target nu stat err =       0.000543022774
   target dn stat err =       0.003706073935
      target stat err =       0.003078835391
              std dev =       0.665769954141
             le_variance =       0.443249631837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443256298142
                                         uncertainty =       0.003341654161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443256298142
                                         uncertainty =       0.003341654161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470770449
  error estimate for blocks of size 2^( 2) =       0.000494884738
  error estimate for blocks of size 2^( 3) =       0.000517227701
  error estimate for blocks of size 2^( 4) =       0.000532903187
  error estimate for blocks of size 2^( 5) =       0.000542122781
  error estimate for blocks of size 2^( 6) =       0.000547188974
  error estimate for blocks of size 2^( 7) =       0.000549876154

      target function =      -0.742869918869
              le_mean =     -22.662849451774
             les_mean =     514.057731502106
             stat err =       0.000543022774
             autocorr =       1.330508643843
   target nu stat err =       0.000543022774
   target dn stat err =       0.003706073935
      target stat err =       0.003078835391
              std dev =       0.665769954141
             le_variance =       0.443249631837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443256298142
                                         uncertainty =       0.003341654161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443256298142
                                         uncertainty =       0.003341654161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470770449
  error estimate for blocks of size 2^( 2) =       0.000494884738
  error estimate for blocks of size 2^( 3) =       0.000517227701
  error estimate for blocks of size 2^( 4) =       0.000532903187
  error estimate for blocks of size 2^( 5) =       0.000542122781
  error estimate for blocks of size 2^( 6) =       0.000547188974
  error estimate for blocks of size 2^( 7) =       0.000549876154

      target function =      -0.742869918869
              le_mean =     -22.662849451774
             les_mean =     514.057731502106
             stat err =       0.000543022774
             autocorr =       1.330508643852
   target nu stat err =       0.000543022774
   target dn stat err =       0.003706073935
      target stat err =       0.003078835391
              std dev =       0.665769954141
             le_variance =       0.443249631837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443256298142
                                         uncertainty =       0.003341654161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443256298142
                                         uncertainty =       0.003341654161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470770449
  error estimate for blocks of size 2^( 2) =       0.000494884738
  error estimate for blocks of size 2^( 3) =       0.000517227701
  error estimate for blocks of size 2^( 4) =       0.000532903187
  error estimate for blocks of size 2^( 5) =       0.000542122781
  error estimate for blocks of size 2^( 6) =       0.000547188974
  error estimate for blocks of size 2^( 7) =       0.000549876154

      target function =      -0.742869918869
              le_mean =     -22.662849451774
             les_mean =     514.057731502106
             stat err =       0.000543022774
             autocorr =       1.330508643843
   target nu stat err =       0.000543022774
   target dn stat err =       0.003706073935
      target stat err =       0.003078835391
              std dev =       0.665769954141
             le_variance =       0.443249631837


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742869918869        initial
     2.2737e+10     2.2737e+11             9.2675e-15        -0.742869918869
     9.0949e+10     9.0949e+11             2.2929e-15        -0.742869918869
     3.6380e+11     3.6380e+12             5.8088e-16        -0.742869918869  <--

*****************************************************************************
Applying the update for shift_i =   3.6380e+11     and shift_s =   3.6380e+12
*****************************************************************************

  Execution time = 4.3734e+01
  </log>
  <optVariables href="FORM.s062.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4835e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.6424
    reference variance = 0.378137
====================================================
  Execution time = 2.6278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5230e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4668e-01
  Total weights = 1.954843312e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438498482637
                                         uncertainty =       0.002493284082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438498482637
                                         uncertainty =       0.002493284082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468213294
  error estimate for blocks of size 2^( 2) =       0.000492382927
  error estimate for blocks of size 2^( 3) =       0.000515222091
  error estimate for blocks of size 2^( 4) =       0.000531138463
  error estimate for blocks of size 2^( 5) =       0.000540352438
  error estimate for blocks of size 2^( 6) =       0.000544977676
  error estimate for blocks of size 2^( 7) =       0.000546693519

      target function =      -0.748041964783
              le_mean =     -22.662062137271
             les_mean =     514.015737455654
             stat err =       0.000540790524
             autocorr =       1.334045572794
   target nu stat err =       0.000540790524
   target dn stat err =       0.002696768038
      target stat err =       0.002304713448
              std dev =       0.662153589921
             le_variance =       0.438447376645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266206213727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748048093031       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748048093031       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748048093031       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748048093031       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748048092983       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748048093254       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748021300258       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748106407357       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748119565976       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748136820321       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748121614384       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747778433877       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748229086632       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748075508512       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747867492046       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747939029503       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748230073222       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748061597838       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747986031022       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746775285380       residual = 5.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746580473805       residual = 4.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.781229286217       residual = 7.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.790272935791       residual = 6.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.873266040950       residual = 3.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.757553755674       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.734662854974       residual = 3.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.766194271743       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.528405220576       residual = 5.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.914988745929       residual = 8.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.993563526111       residual = 5.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.064596908198       residual = 9.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.675460557920       residual = 2.51e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -7.503446503803       residual = 4.78e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       7.963859580242       residual = 1.47e+04           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+10 is 3.216764e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748048093031       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748048093031       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748048093031       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748048093031       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748048093031       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748048091650       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748048313420       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747772492843       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747426523937       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747828856612       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747494729830       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748543706501       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747904063594       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747349145890       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748045869229       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747186351881       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747812475479       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747017141281       residual = 5.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747956698478       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747732531013       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745058026185       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.754291418247       residual = 1.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.766893624532       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746339135005       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747168200710       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.729881727490       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.756817597862       residual = 7.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.753186693591       residual = 8.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.704645488273       residual = 5.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751536898670       residual = 2.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.755447928812       residual = 3.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.834499493177       residual = 3.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -3.254788866799       residual = 5.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.487913821481       residual = 3.29e+05           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+11 is 7.988803e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748048093031       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748048093031       residual = 5.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748048093031       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748048093031       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748048093028       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748048090114       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747452807932       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748834156984       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745038509368       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748887469328       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.750836761909       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749399862076       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750586940966       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748114072508       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749778919516       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749458589388       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747832736331       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746455558125       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752134097065       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.733729296093       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748544787784       residual = 8.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.771119347791       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.614086504611       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.805813532909       residual = 3.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.467629618130       residual = 1.79e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.935667430545       residual = 9.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708021222511       residual = 2.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.773773561283       residual = 5.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -3.558326012502       residual = 3.10e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.903736308129       residual = 2.12e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -7.378542948924       residual = 2.74e+04           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+12 is 2.032660e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.263935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1061e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.6394
    reference variance = 0.686685
====================================================
  Execution time = 2.7499e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4903e-01
  Total weights = 1.9554e+06
  Execution time = 3.6014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438743321240
                                         uncertainty =       0.002776983126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438743321240
                                         uncertainty =       0.002776983126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468393199
  error estimate for blocks of size 2^( 2) =       0.000492472997
  error estimate for blocks of size 2^( 3) =       0.000514070121
  error estimate for blocks of size 2^( 4) =       0.000530047764
  error estimate for blocks of size 2^( 5) =       0.000538384449
  error estimate for blocks of size 2^( 6) =       0.000545080701
  error estimate for blocks of size 2^( 7) =       0.000549141727

      target function =      -0.746101425068
              le_mean =     -22.661899047865
             les_mean =     514.010694297737
             stat err =       0.000540663660
             autocorr =       1.332395627791
   target nu stat err =       0.000540663660
   target dn stat err =       0.003547235205
      target stat err =       0.002972442532
              std dev =       0.662408014757
             le_variance =       0.438784378014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438743321240
                                         uncertainty =       0.002776983126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438743321240
                                         uncertainty =       0.002776983126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468393199
  error estimate for blocks of size 2^( 2) =       0.000492472997
  error estimate for blocks of size 2^( 3) =       0.000514070121
  error estimate for blocks of size 2^( 4) =       0.000530047764
  error estimate for blocks of size 2^( 5) =       0.000538384449
  error estimate for blocks of size 2^( 6) =       0.000545080701
  error estimate for blocks of size 2^( 7) =       0.000549141727

      target function =      -0.746101425068
              le_mean =     -22.661899047865
             les_mean =     514.010694297737
             stat err =       0.000540663660
             autocorr =       1.332395627786
   target nu stat err =       0.000540663660
   target dn stat err =       0.003547235205
      target stat err =       0.002972442532
              std dev =       0.662408014757
             le_variance =       0.438784378014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438743321240
                                         uncertainty =       0.002776983126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438743321240
                                         uncertainty =       0.002776983126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468393199
  error estimate for blocks of size 2^( 2) =       0.000492472997
  error estimate for blocks of size 2^( 3) =       0.000514070121
  error estimate for blocks of size 2^( 4) =       0.000530047764
  error estimate for blocks of size 2^( 5) =       0.000538384449
  error estimate for blocks of size 2^( 6) =       0.000545080701
  error estimate for blocks of size 2^( 7) =       0.000549141727

      target function =      -0.746101425068
              le_mean =     -22.661899047865
             les_mean =     514.010694297737
             stat err =       0.000540663660
             autocorr =       1.332395627786
   target nu stat err =       0.000540663660
   target dn stat err =       0.003547235205
      target stat err =       0.002972442532
              std dev =       0.662408014757
             le_variance =       0.438784378014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438743321240
                                         uncertainty =       0.002776983126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438743321240
                                         uncertainty =       0.002776983126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468393199
  error estimate for blocks of size 2^( 2) =       0.000492472997
  error estimate for blocks of size 2^( 3) =       0.000514070121
  error estimate for blocks of size 2^( 4) =       0.000530047764
  error estimate for blocks of size 2^( 5) =       0.000538384449
  error estimate for blocks of size 2^( 6) =       0.000545080701
  error estimate for blocks of size 2^( 7) =       0.000549141727

      target function =      -0.746101425068
              le_mean =     -22.661899047865
             les_mean =     514.010694297737
             stat err =       0.000540663660
             autocorr =       1.332395627786
   target nu stat err =       0.000540663660
   target dn stat err =       0.003547235205
      target stat err =       0.002972442532
              std dev =       0.662408014757
             le_variance =       0.438784378014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746101425068        initial
     9.0949e+10     9.0949e+11             3.2168e-15        -0.746101425068
     3.6380e+11     3.6380e+12             7.9888e-16        -0.746101425068  <--
     1.4552e+12     1.4552e+13             2.0327e-16        -0.746101425068

*****************************************************************************
Applying the update for shift_i =   3.6380e+11     and shift_s =   3.6380e+12
*****************************************************************************

  Execution time = 4.5627e+01
  </log>
  <optVariables href="FORM.s063.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.6037
    reference variance = 0.42557
====================================================
  Execution time = 2.6387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4496e-01
  Total weights = 1.955487683e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434061362218
                                         uncertainty =       0.001954808469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434061362218
                                         uncertainty =       0.001954808469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465868137
  error estimate for blocks of size 2^( 2) =       0.000490250846
  error estimate for blocks of size 2^( 3) =       0.000512896893
  error estimate for blocks of size 2^( 4) =       0.000528989409
  error estimate for blocks of size 2^( 5) =       0.000538668766
  error estimate for blocks of size 2^( 6) =       0.000545105707
  error estimate for blocks of size 2^( 7) =       0.000549946851

      target function =      -0.749457689247
              le_mean =     -22.662005606296
             les_mean =     514.011457158924
             stat err =       0.000540677683
             autocorr =       1.346948130112
   target nu stat err =       0.000540677683
   target dn stat err =       0.003430973551
      target stat err =       0.002904849477
              std dev =       0.658837038216
             le_variance =       0.434066242925


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266200560630e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749468021977       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749468021977       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749468021977       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749468021977       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749468021977       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749395144258       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749556045824       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749468021977       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749468021977       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749613034210       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749468021977       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749515988875       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749237100225       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749461912929       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749667170601       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749421101163       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749470495756       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749318473893       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749402916160       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749448317870       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749490791492       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749444355437       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750360740066       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749528428076       residual = 1.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749352251322       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750657356327       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749414672313       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749026451202       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.792048921651       residual = 4.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748251660979       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.748978887342       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.749372853567       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.765766649284       residual = 1.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.743148512588       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741277281495       residual = 1.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.598769770493       residual = 1.79e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.642448591312       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.049822660505       residual = 7.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -7.885161824710       residual = 1.08e+05           smallest_sin_value = 9.98e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -2.051913197253       residual = 2.04e+04           smallest_sin_value = 9.96e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+10 is 4.377434e-15

solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749468021977       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749468021977       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749468021977       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749459651205       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749548526282       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749468021977       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749468021977       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749277461227       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748615519533       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748961882510       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748398460580       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749546153326       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748906310977       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749283325708       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749495755910       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750161730625       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.752378221169       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.759338469524       residual = 1.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -2.393726521742       residual = 1.19e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       0.621394651691       residual = 1.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -5.449952003519       residual = 1.27e+04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       0.668088909914       residual = 4.77e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       3.421062824150       residual = 6.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.667721503784       residual = 4.15e+04           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+11 is 1.158412e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749468021977       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749468021977       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749468021977       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749468021977       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749468021977       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749468021977       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749468021977       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749468021977       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743933153879       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752223135147       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748243001334       residual = 6.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.750635421586       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.753107656776       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741150856867       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.763464507006       residual = 4.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.709740332055       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745324208825       residual = 4.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.707545083300       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746678770703       residual = 8.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.125008394160       residual = 2.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.099288454108       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.056943661420       residual = 9.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.120772018922       residual = 2.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.832302239463       residual = 7.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929961232550       residual = 6.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       3.065482660277       residual = 5.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.261348868459       residual = 5.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -5.822039284920       residual = 4.62e+04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       2.031875383396       residual = 3.62e+04           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to too large eigenvalue change
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+12 is 2.902136e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.307365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1138e+01
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.6235
    reference variance = 0.371753
====================================================
  Execution time = 2.5957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5612e-01
  Total weights = 1.9551e+06
  Execution time = 3.6176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442561829060
                                         uncertainty =       0.002800541225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442561829060
                                         uncertainty =       0.002800541225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470433055
  error estimate for blocks of size 2^( 2) =       0.000494604660
  error estimate for blocks of size 2^( 3) =       0.000516784695
  error estimate for blocks of size 2^( 4) =       0.000532900306
  error estimate for blocks of size 2^( 5) =       0.000542315688
  error estimate for blocks of size 2^( 6) =       0.000545594726
  error estimate for blocks of size 2^( 7) =       0.000547006929

      target function =      -0.740308378990
              le_mean =     -22.661197038429
             les_mean =     513.985976118725
             stat err =       0.000541954412
             autocorr =       1.327180073085
   target nu stat err =       0.000541954412
   target dn stat err =       0.004454512999
      target stat err =       0.003645158954
              std dev =       0.665292806919
             le_variance =       0.442614518938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442561829060
                                         uncertainty =       0.002800541225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442561829060
                                         uncertainty =       0.002800541225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470433055
  error estimate for blocks of size 2^( 2) =       0.000494604660
  error estimate for blocks of size 2^( 3) =       0.000516784695
  error estimate for blocks of size 2^( 4) =       0.000532900306
  error estimate for blocks of size 2^( 5) =       0.000542315688
  error estimate for blocks of size 2^( 6) =       0.000545594726
  error estimate for blocks of size 2^( 7) =       0.000547006929

      target function =      -0.740308378989
              le_mean =     -22.661197038429
             les_mean =     513.985976118725
             stat err =       0.000541954412
             autocorr =       1.327180073077
   target nu stat err =       0.000541954412
   target dn stat err =       0.004454512999
      target stat err =       0.003645158954
              std dev =       0.665292806919
             le_variance =       0.442614518938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442561829060
                                         uncertainty =       0.002800541225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442561829060
                                         uncertainty =       0.002800541225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470433055
  error estimate for blocks of size 2^( 2) =       0.000494604660
  error estimate for blocks of size 2^( 3) =       0.000516784695
  error estimate for blocks of size 2^( 4) =       0.000532900306
  error estimate for blocks of size 2^( 5) =       0.000542315688
  error estimate for blocks of size 2^( 6) =       0.000545594726
  error estimate for blocks of size 2^( 7) =       0.000547006929

      target function =      -0.740308378990
              le_mean =     -22.661197038429
             les_mean =     513.985976118725
             stat err =       0.000541954412
             autocorr =       1.327180073077
   target nu stat err =       0.000541954412
   target dn stat err =       0.004454512999
      target stat err =       0.003645158954
              std dev =       0.665292806919
             le_variance =       0.442614518938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442561829060
                                         uncertainty =       0.002800541225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442561829060
                                         uncertainty =       0.002800541225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470433055
  error estimate for blocks of size 2^( 2) =       0.000494604660
  error estimate for blocks of size 2^( 3) =       0.000516784695
  error estimate for blocks of size 2^( 4) =       0.000532900306
  error estimate for blocks of size 2^( 5) =       0.000542315688
  error estimate for blocks of size 2^( 6) =       0.000545594726
  error estimate for blocks of size 2^( 7) =       0.000547006929

      target function =      -0.740308378990
              le_mean =     -22.661197038429
             les_mean =     513.985976118725
             stat err =       0.000541954412
             autocorr =       1.327180073077
   target nu stat err =       0.000541954412
   target dn stat err =       0.004454512999
      target stat err =       0.003645158954
              std dev =       0.665292806919
             le_variance =       0.442614518938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740308378990        initial  <--
     9.0949e+10     9.0949e+11             4.3774e-15        -0.740308378989
     3.6380e+11     3.6380e+12             1.1584e-15        -0.740308378990
     1.4552e+12     1.4552e+13             2.9021e-16        -0.740308378990

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2337
  </log>
  <optVariables href="FORM.s064.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5377e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.5941
    reference variance = 0.405327
====================================================
  Execution time = 2.6599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4719e-01
  Total weights = 1.955218162e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438052817292
                                         uncertainty =       0.002399646800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438052817292
                                         uncertainty =       0.002399646800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467976962
  error estimate for blocks of size 2^( 2) =       0.000492279388
  error estimate for blocks of size 2^( 3) =       0.000514470337
  error estimate for blocks of size 2^( 4) =       0.000530793864
  error estimate for blocks of size 2^( 5) =       0.000539796699
  error estimate for blocks of size 2^( 6) =       0.000545923515
  error estimate for blocks of size 2^( 7) =       0.000549078937

      target function =      -0.747617223841
              le_mean =     -22.662151914384
             les_mean =     514.020317691804
             stat err =       0.000541398254
             autocorr =       1.338396383468
   target nu stat err =       0.000541398254
   target dn stat err =       0.003471150458
      target stat err =       0.002924116077
              std dev =       0.661819366068
             le_variance =       0.438004873303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266215191438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+11, overlap shift 9.0949e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747627718625       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747627718625       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747627718625       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747627718625       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747627718658       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747593105465       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747652660646       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748093460376       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747298790056       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745360965204       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747750700003       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748206582946       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747113051779       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748242405686       residual = 9.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747605707404       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748376977264       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749086946061       residual = 7.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746496820145       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752736086027       residual = 7.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737908046707       residual = 4.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.734817322838       residual = 7.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.735839479304       residual = 4.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750655327589       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.776176492806       residual = 4.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.693212713453       residual = 3.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.003238359958       residual = 2.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.759850268465       residual = 2.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.145485954102       residual = 1.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.685595327642       residual = 3.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.070718713510       residual = 3.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.270312690187       residual = 2.35e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       1.061865397841       residual = 6.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.283734347449       residual = 1.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       5.516583053448       residual = 1.76e+04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.870951667277       residual = 3.92e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       3.827655513701       residual = 1.98e+04           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+11 is 2.270232e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+12, overlap shift 3.6380e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747627718625       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747627718625       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747627718625       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747627718625       residual = 8.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747606513295       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747261016852       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.750583697224       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748751127314       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744192118257       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746964365537       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747872007043       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735731177239       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745381012479       residual = 4.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.732130931830       residual = 6.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.737427778677       residual = 7.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740605378404       residual = 4.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.780725458804       residual = 7.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.735815673347       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.759783176265       residual = 9.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.763688927870       residual = 4.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738152604784       residual = 5.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.496415682873       residual = 1.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -3.933780263753       residual = 8.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.980003811447       residual = 1.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       1.144523198181       residual = 2.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       1.787960665823       residual = 1.46e+04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.474380265850       residual = 2.47e+04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -3.924580067549       residual = 4.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       8.078283956492       residual = 5.10e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.597729133235       residual = 5.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.271554481677       residual = 1.57e+06           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+12 is 5.210460e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+13, overlap shift 1.4552e+14 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747627718625       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747627718625       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.98e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.339428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1315e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.6648
    reference variance = 0.410323
====================================================
  Execution time = 2.7871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5394e-01
  Total weights = 1.9549e+06
  Execution time = 3.6121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442843585701
                                         uncertainty =       0.002610410077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442843585701
                                         uncertainty =       0.002610410077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470587391
  error estimate for blocks of size 2^( 2) =       0.000494723949
  error estimate for blocks of size 2^( 3) =       0.000516618313
  error estimate for blocks of size 2^( 4) =       0.000531560205
  error estimate for blocks of size 2^( 5) =       0.000540839841
  error estimate for blocks of size 2^( 6) =       0.000546306983
  error estimate for blocks of size 2^( 7) =       0.000550547167

      target function =      -0.742090107515
              le_mean =     -22.662119707846
             les_mean =     514.025606790510
             stat err =       0.000542313549
             autocorr =       1.328068072407
   target nu stat err =       0.000542313549
   target dn stat err =       0.003880352144
      target stat err =       0.003208079731
              std dev =       0.665511071277
             le_variance =       0.442904985992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442843585701
                                         uncertainty =       0.002610410077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442843585701
                                         uncertainty =       0.002610410077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470587391
  error estimate for blocks of size 2^( 2) =       0.000494723949
  error estimate for blocks of size 2^( 3) =       0.000516618313
  error estimate for blocks of size 2^( 4) =       0.000531560205
  error estimate for blocks of size 2^( 5) =       0.000540839841
  error estimate for blocks of size 2^( 6) =       0.000546306983
  error estimate for blocks of size 2^( 7) =       0.000550547167

      target function =      -0.742090107515
              le_mean =     -22.662119707846
             les_mean =     514.025606790510
             stat err =       0.000542313549
             autocorr =       1.328068072407
   target nu stat err =       0.000542313549
   target dn stat err =       0.003880352144
      target stat err =       0.003208079731
              std dev =       0.665511071277
             le_variance =       0.442904985992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442843585701
                                         uncertainty =       0.002610410077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442843585701
                                         uncertainty =       0.002610410077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470587391
  error estimate for blocks of size 2^( 2) =       0.000494723949
  error estimate for blocks of size 2^( 3) =       0.000516618313
  error estimate for blocks of size 2^( 4) =       0.000531560205
  error estimate for blocks of size 2^( 5) =       0.000540839841
  error estimate for blocks of size 2^( 6) =       0.000546306983
  error estimate for blocks of size 2^( 7) =       0.000550547167

      target function =      -0.742090107515
              le_mean =     -22.662119707846
             les_mean =     514.025606790510
             stat err =       0.000542313549
             autocorr =       1.328068072407
   target nu stat err =       0.000542313549
   target dn stat err =       0.003880352144
      target stat err =       0.003208079731
              std dev =       0.665511071277
             le_variance =       0.442904985992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442843585701
                                         uncertainty =       0.002610410077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442843585701
                                         uncertainty =       0.002610410077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470587391
  error estimate for blocks of size 2^( 2) =       0.000494723949
  error estimate for blocks of size 2^( 3) =       0.000516618313
  error estimate for blocks of size 2^( 4) =       0.000531560205
  error estimate for blocks of size 2^( 5) =       0.000540839841
  error estimate for blocks of size 2^( 6) =       0.000546306983
  error estimate for blocks of size 2^( 7) =       0.000550547167

      target function =      -0.742090107515
              le_mean =     -22.662119707846
             les_mean =     514.025606790510
             stat err =       0.000542313549
             autocorr =       1.328068072407
   target nu stat err =       0.000542313549
   target dn stat err =       0.003880352144
      target stat err =       0.003208079731
              std dev =       0.665511071277
             le_variance =       0.442904985992


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742090107515        initial
     9.0949e+11     9.0949e+12             2.2702e-16        -0.742090107515
     3.6380e+12     3.6380e+13             5.2105e-17        -0.742090107515  <--
     1.4552e+13     1.4552e+14             0.0000e+00        -0.742090107515

*****************************************************************************
Applying the update for shift_i =   3.6380e+12     and shift_s =   3.6380e+13
*****************************************************************************

  Execution time = 4.6071e+01
  </log>
  <optVariables href="FORM.s065.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7410e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7323
    reference variance = 0.489391
====================================================
  Execution time = 2.6526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4773e-01
  Total weights = 1.954851053e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437938922101
                                         uncertainty =       0.001894868339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437938922101
                                         uncertainty =       0.001894868339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467956352
  error estimate for blocks of size 2^( 2) =       0.000492516235
  error estimate for blocks of size 2^( 3) =       0.000514886427
  error estimate for blocks of size 2^( 4) =       0.000530884092
  error estimate for blocks of size 2^( 5) =       0.000540686825
  error estimate for blocks of size 2^( 6) =       0.000545143462
  error estimate for blocks of size 2^( 7) =       0.000547017050

      target function =      -0.747158563955
              le_mean =     -22.661119805361
             les_mean =     513.974080366664
             stat err =       0.000540932857
             autocorr =       1.336214041770
   target nu stat err =       0.000540932857
   target dn stat err =       0.002972905894
      target stat err =       0.002516322553
              std dev =       0.661790219007
             le_variance =       0.437966293973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266111980536e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+11, overlap shift 9.0949e+12 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747166161719       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747166161719       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747166161719       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747166161719       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747166161719       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746440619936       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747166161719       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747166161719       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747398666058       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745623057293       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746498053556       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747732733377       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748879992664       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747253293643       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748341501071       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746435237863       residual = 6.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745084278762       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747730337638       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746516980992       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746920951934       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747394789123       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747281989175       residual = 4.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747030155455       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740341028945       residual = 9.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.759631930665       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.737172550343       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.685076619738       residual = 1.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739483522737       residual = 9.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.824622865962       residual = 3.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.120646045335       residual = 3.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.774206800593       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.252534953434       residual = 9.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.152684379831       residual = 1.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.262955644949       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       2.422540522970       residual = 1.05e+04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914084678302       residual = 3.58e+04           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+11 is 1.993606e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+12, overlap shift 3.6380e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747166161719       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747166161719       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747166161719       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748239928507       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747166161698       residual = 8.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747166161895       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747141606561       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.750398023223       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749209291115       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741875451095       residual = 3.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743641513347       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746707880597       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749658077189       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740638169605       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.799981758746       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.757374644369       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.654088339299       residual = 9.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.849182051221       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.658697579582       residual = 3.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.712135007642       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.734745900091       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.703150494729       residual = 9.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.722377505571       residual = 7.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.757353198587       residual = 2.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.882258860617       residual = 8.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.158675661736       residual = 2.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.380146994906       residual = 1.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   27 stopping due to too large eigenvalue change
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+12 is 3.970839e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+13, overlap shift 1.4552e+14 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747166161719       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747166161719       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747166161719       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747166161719       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747071195649       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749768376832       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739172884484       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.755217701201       residual = 4.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.698173669637       residual = 7.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.775730016119       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.758459293179       residual = 4.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.786416006089       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.777507666825       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745099792679       residual = 7.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.754323530446       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.750260457893       residual = 3.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.789514298116       residual = 9.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.754361865182       residual = 6.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.727857538473       residual = 4.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.733245067520       residual = 3.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.751904027323       residual = 2.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.788569107480       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.767197499914       residual = 2.10e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736866900464       residual = 9.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.001796473749       residual = 5.83e+04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.242744720775       residual = 4.61e+04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -3.236872333981       residual = 6.93e+04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.197615599895       residual = 8.42e+04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -5.547423785833       residual = 3.18e+05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.755990856809       residual = 3.30e+05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -4.954731928756       residual = 3.97e+06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       5.220469723117       residual = 1.53e+06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       6.719608062972       residual = 4.87e+05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       9.221378509769       residual = 1.50e+08           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+13 is 1.094423e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.382847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1258e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.5733
    reference variance = 0.45165
====================================================
  Execution time = 2.5986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4791e-01
  Total weights = 1.9554e+06
  Execution time = 3.6140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439486081329
                                         uncertainty =       0.001879085460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439486081329
                                         uncertainty =       0.001879085460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468757149
  error estimate for blocks of size 2^( 2) =       0.000492989488
  error estimate for blocks of size 2^( 3) =       0.000514800070
  error estimate for blocks of size 2^( 4) =       0.000530189191
  error estimate for blocks of size 2^( 5) =       0.000538452223
  error estimate for blocks of size 2^( 6) =       0.000542533741
  error estimate for blocks of size 2^( 7) =       0.000543284650

      target function =      -0.747026899089
              le_mean =     -22.661900899933
             les_mean =     514.009659537106
             stat err =       0.000538614951
             autocorr =       1.320264667214
   target nu stat err =       0.000538614951
   target dn stat err =       0.002444510677
      target stat err =       0.002097615062
              std dev =       0.662922717783
             le_variance =       0.439466529753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439486081329
                                         uncertainty =       0.001879085460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439486081329
                                         uncertainty =       0.001879085460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468757149
  error estimate for blocks of size 2^( 2) =       0.000492989488
  error estimate for blocks of size 2^( 3) =       0.000514800070
  error estimate for blocks of size 2^( 4) =       0.000530189191
  error estimate for blocks of size 2^( 5) =       0.000538452223
  error estimate for blocks of size 2^( 6) =       0.000542533741
  error estimate for blocks of size 2^( 7) =       0.000543284650

      target function =      -0.747026899089
              le_mean =     -22.661900899933
             les_mean =     514.009659537106
             stat err =       0.000538614951
             autocorr =       1.320264667208
   target nu stat err =       0.000538614951
   target dn stat err =       0.002444510677
      target stat err =       0.002097615062
              std dev =       0.662922717783
             le_variance =       0.439466529753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439486081329
                                         uncertainty =       0.001879085460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439486081329
                                         uncertainty =       0.001879085460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468757149
  error estimate for blocks of size 2^( 2) =       0.000492989488
  error estimate for blocks of size 2^( 3) =       0.000514800070
  error estimate for blocks of size 2^( 4) =       0.000530189191
  error estimate for blocks of size 2^( 5) =       0.000538452223
  error estimate for blocks of size 2^( 6) =       0.000542533741
  error estimate for blocks of size 2^( 7) =       0.000543284650

      target function =      -0.747026899089
              le_mean =     -22.661900899933
             les_mean =     514.009659537106
             stat err =       0.000538614951
             autocorr =       1.320264667211
   target nu stat err =       0.000538614951
   target dn stat err =       0.002444510677
      target stat err =       0.002097615062
              std dev =       0.662922717783
             le_variance =       0.439466529753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439486081329
                                         uncertainty =       0.001879085460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439486081329
                                         uncertainty =       0.001879085460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468757149
  error estimate for blocks of size 2^( 2) =       0.000492989488
  error estimate for blocks of size 2^( 3) =       0.000514800070
  error estimate for blocks of size 2^( 4) =       0.000530189191
  error estimate for blocks of size 2^( 5) =       0.000538452223
  error estimate for blocks of size 2^( 6) =       0.000542533741
  error estimate for blocks of size 2^( 7) =       0.000543284650

      target function =      -0.747026899089
              le_mean =     -22.661900899933
             les_mean =     514.009659537106
             stat err =       0.000538614951
             autocorr =       1.320264667211
   target nu stat err =       0.000538614951
   target dn stat err =       0.002444510677
      target stat err =       0.002097615062
              std dev =       0.662922717783
             le_variance =       0.439466529753


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747026899089        initial
     9.0949e+11     9.0949e+12             1.9936e-16        -0.747026899089
     3.6380e+12     3.6380e+13             3.9708e-17        -0.747026899089
     1.4552e+13     1.4552e+14             1.0944e-17        -0.747026899089  <--

*****************************************************************************
Applying the update for shift_i =   1.4552e+13     and shift_s =   1.4552e+14
*****************************************************************************

  Execution time = 4.4187e+01
  </log>
  <optVariables href="FORM.s066.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.5996
    reference variance = 0.319464
====================================================
  Execution time = 2.6396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5436e-01
  Total weights = 1.954955798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442742260270
                                         uncertainty =       0.002665844158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442742260270
                                         uncertainty =       0.002665844158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470486315
  error estimate for blocks of size 2^( 2) =       0.000494715027
  error estimate for blocks of size 2^( 3) =       0.000517196669
  error estimate for blocks of size 2^( 4) =       0.000533078499
  error estimate for blocks of size 2^( 5) =       0.000543370607
  error estimate for blocks of size 2^( 6) =       0.000549069342
  error estimate for blocks of size 2^( 7) =       0.000553357613

      target function =      -0.741744941814
              le_mean =     -22.661172378000
             les_mean =     513.983092949045
             stat err =       0.000544719015
             autocorr =       1.340451423460
   target nu stat err =       0.000544719015
   target dn stat err =       0.003241814550
      target stat err =       0.002694308828
              std dev =       0.665368127953
             le_variance =       0.442714745696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266117237800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+12, overlap shift 3.6380e+13 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741753707959       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741753707959       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741753707959       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742091487382       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741753707959       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739604767820       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742827109761       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741940171700       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.729964389372       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741847169946       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740338002057       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737431071748       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.735085673536       residual = 2.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.751940250508       residual = 3.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749724599037       residual = 1.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.732795723217       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.727287584362       residual = 2.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750324419093       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752994942666       residual = 8.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.724807615561       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.805842060673       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.775546903150       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.438542357065       residual = 3.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.312879750643       residual = 4.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       1.728527342178       residual = 1.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.329598333619       residual = 5.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.235574735621       residual = 7.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -2.042078046058       residual = 1.70e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -2.249508466123       residual = 4.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.723096127919       residual = 6.49e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       3.082342393547       residual = 1.04e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       4.237760733428       residual = 3.44e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       4.172804163398       residual = 1.06e+05           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+12 is 6.305928e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+13, overlap shift 1.4552e+14 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741753707959       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741753707959       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+13, overlap shift 5.8208e+14 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741753707959       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741753707959       residual = 5.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.47e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.398078 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1202e+01
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.6863
    reference variance = 0.400531
====================================================
  Execution time = 2.7615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5166e-01
  Total weights = 1.9553e+06
  Execution time = 3.6085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441249003021
                                         uncertainty =       0.002404628359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441249003021
                                         uncertainty =       0.002404628359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469698753
  error estimate for blocks of size 2^( 2) =       0.000493601831
  error estimate for blocks of size 2^( 3) =       0.000516183978
  error estimate for blocks of size 2^( 4) =       0.000532137696
  error estimate for blocks of size 2^( 5) =       0.000542579870
  error estimate for blocks of size 2^( 6) =       0.000547566940
  error estimate for blocks of size 2^( 7) =       0.000549775530

      target function =      -0.743957069258
              le_mean =     -22.662588870667
             les_mean =     514.044590285180
             stat err =       0.000543015009
             autocorr =       1.336548904348
   target nu stat err =       0.000543015009
   target dn stat err =       0.003111055102
      target stat err =       0.002611133062
              std dev =       0.664254346025
             le_variance =       0.441233836213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441249003021
                                         uncertainty =       0.002404628359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441249003021
                                         uncertainty =       0.002404628359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469698753
  error estimate for blocks of size 2^( 2) =       0.000493601831
  error estimate for blocks of size 2^( 3) =       0.000516183978
  error estimate for blocks of size 2^( 4) =       0.000532137696
  error estimate for blocks of size 2^( 5) =       0.000542579870
  error estimate for blocks of size 2^( 6) =       0.000547566940
  error estimate for blocks of size 2^( 7) =       0.000549775530

      target function =      -0.743957069258
              le_mean =     -22.662588870667
             les_mean =     514.044590285180
             stat err =       0.000543015009
             autocorr =       1.336548904343
   target nu stat err =       0.000543015009
   target dn stat err =       0.003111055102
      target stat err =       0.002611133062
              std dev =       0.664254346025
             le_variance =       0.441233836213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441249003021
                                         uncertainty =       0.002404628359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441249003021
                                         uncertainty =       0.002404628359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469698753
  error estimate for blocks of size 2^( 2) =       0.000493601831
  error estimate for blocks of size 2^( 3) =       0.000516183978
  error estimate for blocks of size 2^( 4) =       0.000532137696
  error estimate for blocks of size 2^( 5) =       0.000542579870
  error estimate for blocks of size 2^( 6) =       0.000547566940
  error estimate for blocks of size 2^( 7) =       0.000549775530

      target function =      -0.743957069258
              le_mean =     -22.662588870667
             les_mean =     514.044590285180
             stat err =       0.000543015009
             autocorr =       1.336548904348
   target nu stat err =       0.000543015009
   target dn stat err =       0.003111055102
      target stat err =       0.002611133062
              std dev =       0.664254346025
             le_variance =       0.441233836213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441249003021
                                         uncertainty =       0.002404628359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441249003021
                                         uncertainty =       0.002404628359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469698753
  error estimate for blocks of size 2^( 2) =       0.000493601831
  error estimate for blocks of size 2^( 3) =       0.000516183978
  error estimate for blocks of size 2^( 4) =       0.000532137696
  error estimate for blocks of size 2^( 5) =       0.000542579870
  error estimate for blocks of size 2^( 6) =       0.000547566940
  error estimate for blocks of size 2^( 7) =       0.000549775530

      target function =      -0.743957069258
              le_mean =     -22.662588870667
             les_mean =     514.044590285180
             stat err =       0.000543015009
             autocorr =       1.336548904348
   target nu stat err =       0.000543015009
   target dn stat err =       0.003111055102
      target stat err =       0.002611133062
              std dev =       0.664254346025
             le_variance =       0.441233836213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743957069258        initial  <--
     3.6380e+12     3.6380e+13             6.3059e-17        -0.743957069258
     1.4552e+13     1.4552e+14             0.0000e+00        -0.743957069258
     5.8208e+13     5.8208e+14             0.0000e+00        -0.743957069258

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.7845
  </log>
  <optVariables href="FORM.s067.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7024e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.5906
    reference variance = 0.338035
====================================================
  Execution time = 2.6512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5068e-01
  Total weights = 1.955328191e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442945133088
                                         uncertainty =       0.002860513543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442945133088
                                         uncertainty =       0.002860513543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470603498
  error estimate for blocks of size 2^( 2) =       0.000495040356
  error estimate for blocks of size 2^( 3) =       0.000517979148
  error estimate for blocks of size 2^( 4) =       0.000534450280
  error estimate for blocks of size 2^( 5) =       0.000542992400
  error estimate for blocks of size 2^( 6) =       0.000548243757
  error estimate for blocks of size 2^( 7) =       0.000551543824

      target function =      -0.744754531387
              le_mean =     -22.662577317809
             les_mean =     514.043091018835
             stat err =       0.000544307565
             autocorr =       1.337760717135
   target nu stat err =       0.000544307565
   target dn stat err =       0.003209964845
      target stat err =       0.002695779866
              std dev =       0.665533849674
             le_variance =       0.442935305062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266257731781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+13, overlap shift 3.6380e+14 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744763352892       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744763352892       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+14, overlap shift 1.4552e+15 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744763352892       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744763352892       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+14, overlap shift 5.8208e+15 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744763352892       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744763352892       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.399155 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1274e+01
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.6744
    reference variance = 0.639372
====================================================
  Execution time = 2.5879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5007e-01
  Total weights = 1.9550e+06
  Execution time = 3.6057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440698108979
                                         uncertainty =       0.002498075863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440698108979
                                         uncertainty =       0.002498075863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469409607
  error estimate for blocks of size 2^( 2) =       0.000493266789
  error estimate for blocks of size 2^( 3) =       0.000515737984
  error estimate for blocks of size 2^( 4) =       0.000531099057
  error estimate for blocks of size 2^( 5) =       0.000540007757
  error estimate for blocks of size 2^( 6) =       0.000546396130
  error estimate for blocks of size 2^( 7) =       0.000547320603

      target function =      -0.745246322171
              le_mean =     -22.661895354827
             les_mean =     514.011572484975
             stat err =       0.000541205887
             autocorr =       1.329294099001
   target nu stat err =       0.000541205887
   target dn stat err =       0.003139396662
      target stat err =       0.002639434939
              std dev =       0.663845432289
             le_variance =       0.440690757972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440698108979
                                         uncertainty =       0.002498075863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440698108979
                                         uncertainty =       0.002498075863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469409607
  error estimate for blocks of size 2^( 2) =       0.000493266789
  error estimate for blocks of size 2^( 3) =       0.000515737984
  error estimate for blocks of size 2^( 4) =       0.000531099057
  error estimate for blocks of size 2^( 5) =       0.000540007757
  error estimate for blocks of size 2^( 6) =       0.000546396130
  error estimate for blocks of size 2^( 7) =       0.000547320603

      target function =      -0.745246322171
              le_mean =     -22.661895354827
             les_mean =     514.011572484975
             stat err =       0.000541205887
             autocorr =       1.329294099001
   target nu stat err =       0.000541205887
   target dn stat err =       0.003139396662
      target stat err =       0.002639434939
              std dev =       0.663845432289
             le_variance =       0.440690757972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440698108979
                                         uncertainty =       0.002498075863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440698108979
                                         uncertainty =       0.002498075863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469409607
  error estimate for blocks of size 2^( 2) =       0.000493266789
  error estimate for blocks of size 2^( 3) =       0.000515737984
  error estimate for blocks of size 2^( 4) =       0.000531099057
  error estimate for blocks of size 2^( 5) =       0.000540007757
  error estimate for blocks of size 2^( 6) =       0.000546396130
  error estimate for blocks of size 2^( 7) =       0.000547320603

      target function =      -0.745246322171
              le_mean =     -22.661895354827
             les_mean =     514.011572484975
             stat err =       0.000541205887
             autocorr =       1.329294099001
   target nu stat err =       0.000541205887
   target dn stat err =       0.003139396662
      target stat err =       0.002639434939
              std dev =       0.663845432289
             le_variance =       0.440690757972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440698108979
                                         uncertainty =       0.002498075863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440698108979
                                         uncertainty =       0.002498075863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469409607
  error estimate for blocks of size 2^( 2) =       0.000493266789
  error estimate for blocks of size 2^( 3) =       0.000515737984
  error estimate for blocks of size 2^( 4) =       0.000531099057
  error estimate for blocks of size 2^( 5) =       0.000540007757
  error estimate for blocks of size 2^( 6) =       0.000546396130
  error estimate for blocks of size 2^( 7) =       0.000547320603

      target function =      -0.745246322171
              le_mean =     -22.661895354827
             les_mean =     514.011572484975
             stat err =       0.000541205887
             autocorr =       1.329294099001
   target nu stat err =       0.000541205887
   target dn stat err =       0.003139396662
      target stat err =       0.002639434939
              std dev =       0.663845432289
             le_variance =       0.440690757972


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745246322171        initial  <--
     3.6380e+13     3.6380e+14             0.0000e+00        -0.745246322171
     1.4552e+14     1.4552e+15             0.0000e+00        -0.745246322171
     5.8208e+14     5.8208e+15             0.0000e+00        -0.745246322171

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0400
  </log>
  <optVariables href="FORM.s068.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5335e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.6526
    reference variance = 0.256185
====================================================
  Execution time = 2.6523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5376e-01
  Total weights = 1.955059078e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442364871488
                                         uncertainty =       0.001936501785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442364871488
                                         uncertainty =       0.001936501785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470287417
  error estimate for blocks of size 2^( 2) =       0.000494370908
  error estimate for blocks of size 2^( 3) =       0.000516154660
  error estimate for blocks of size 2^( 4) =       0.000531332612
  error estimate for blocks of size 2^( 5) =       0.000542441707
  error estimate for blocks of size 2^( 6) =       0.000548716427
  error estimate for blocks of size 2^( 7) =       0.000547876490

      target function =      -0.742246251327
              le_mean =     -22.662540288908
             les_mean =     514.044488275945
             stat err =       0.000542591809
             autocorr =       1.331127783030
   target nu stat err =       0.000542591809
   target dn stat err =       0.002868967449
      target stat err =       0.002407902945
              std dev =       0.665086843721
             le_variance =       0.442340509691


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266254028891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+14, overlap shift 3.6380e+15 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742253100449       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742253100449       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742253100449       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.726761017325       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890739845682       residual = 3.36e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.833538739756       residual = 2.34e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746802591128       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.463749576754       residual = 1.63e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.843452132607       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.053385251012       residual = 8.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       0.806120155861       residual = 2.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.104079206995       residual = 4.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =       0.801166253490       residual = 5.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -6.405559718270       residual = 2.13e+03           smallest_sin_value = 1.00e+00
davidson iteration   14 stopping due to too large eigenvalue change
davidson solver did not converge after         14 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+14 is 5.118379e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+15, overlap shift 1.4552e+16 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742253100449       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742253100449       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742253100449       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742253100430       residual = 7.94e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742253100496       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.498343204380       residual = 8.59e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.542233549977       residual = 8.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.824030750935       residual = 3.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.755405457305       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.379624250358       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.511999731526       residual = 2.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.883483636436       residual = 2.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =       7.105057994869       residual = 1.32e+04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -4.737711066225       residual = 4.54e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.247736977185       residual = 1.13e+04           smallest_sin_value = 1.00e+00
davidson iteration   15 stopping due to too large eigenvalue change
davidson solver did not converge after         15 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+15 is 1.279595e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+15, overlap shift 5.8208e+16 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742253100449       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742253100449       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742253100449       residual = 9.26e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -2.319449292745       residual = 1.44e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =       2.443202811037       residual = 1.88e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       6.218520881465       residual = 3.02e+03           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+15 is 3.198987e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.405176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1275e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.5396
    reference variance = 0.325228
====================================================
  Execution time = 2.8023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4446e-01
  Total weights = 1.9551e+06
  Execution time = 3.6020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386606663
                                         uncertainty =       0.002124455538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386606663
                                         uncertainty =       0.002124455538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467085808
  error estimate for blocks of size 2^( 2) =       0.000491563161
  error estimate for blocks of size 2^( 3) =       0.000514437802
  error estimate for blocks of size 2^( 4) =       0.000530103077
  error estimate for blocks of size 2^( 5) =       0.000540825704
  error estimate for blocks of size 2^( 6) =       0.000543000148
  error estimate for blocks of size 2^( 7) =       0.000544863168

      target function =      -0.749852885479
              le_mean =     -22.660697236453
             les_mean =     513.951656960681
             stat err =       0.000539698025
             autocorr =       1.335083146382
   target nu stat err =       0.000539698025
   target dn stat err =       0.002493816332
      target stat err =       0.002148657622
              std dev =       0.660559084223
             le_variance =       0.436338303750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386606663
                                         uncertainty =       0.002124455538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386606663
                                         uncertainty =       0.002124455538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467085808
  error estimate for blocks of size 2^( 2) =       0.000491563161
  error estimate for blocks of size 2^( 3) =       0.000514437802
  error estimate for blocks of size 2^( 4) =       0.000530103077
  error estimate for blocks of size 2^( 5) =       0.000540825704
  error estimate for blocks of size 2^( 6) =       0.000543000148
  error estimate for blocks of size 2^( 7) =       0.000544863168

      target function =      -0.749852885479
              le_mean =     -22.660697236453
             les_mean =     513.951656960681
             stat err =       0.000539698025
             autocorr =       1.335083146382
   target nu stat err =       0.000539698025
   target dn stat err =       0.002493816332
      target stat err =       0.002148657622
              std dev =       0.660559084223
             le_variance =       0.436338303750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386606663
                                         uncertainty =       0.002124455538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386606663
                                         uncertainty =       0.002124455538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467085808
  error estimate for blocks of size 2^( 2) =       0.000491563161
  error estimate for blocks of size 2^( 3) =       0.000514437802
  error estimate for blocks of size 2^( 4) =       0.000530103077
  error estimate for blocks of size 2^( 5) =       0.000540825704
  error estimate for blocks of size 2^( 6) =       0.000543000148
  error estimate for blocks of size 2^( 7) =       0.000544863168

      target function =      -0.749852885479
              le_mean =     -22.660697236453
             les_mean =     513.951656960681
             stat err =       0.000539698025
             autocorr =       1.335083146382
   target nu stat err =       0.000539698025
   target dn stat err =       0.002493816332
      target stat err =       0.002148657622
              std dev =       0.660559084223
             le_variance =       0.436338303750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386606663
                                         uncertainty =       0.002124455538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436386606663
                                         uncertainty =       0.002124455538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467085808
  error estimate for blocks of size 2^( 2) =       0.000491563161
  error estimate for blocks of size 2^( 3) =       0.000514437802
  error estimate for blocks of size 2^( 4) =       0.000530103077
  error estimate for blocks of size 2^( 5) =       0.000540825704
  error estimate for blocks of size 2^( 6) =       0.000543000148
  error estimate for blocks of size 2^( 7) =       0.000544863168

      target function =      -0.749852885479
              le_mean =     -22.660697236453
             les_mean =     513.951656960681
             stat err =       0.000539698025
             autocorr =       1.335083146382
   target nu stat err =       0.000539698025
   target dn stat err =       0.002493816332
      target stat err =       0.002148657622
              std dev =       0.660559084223
             le_variance =       0.436338303750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749852885479        initial
     3.6380e+14     3.6380e+15             5.1184e-19        -0.749852885479  <--
     1.4552e+15     1.4552e+16             1.2796e-19        -0.749852885479
     5.8208e+15     5.8208e+16             3.1990e-20        -0.749852885479

*****************************************************************************
Applying the update for shift_i =   3.6380e+14     and shift_s =   3.6380e+15
*****************************************************************************

  Execution time = 4.6142e+01
  </log>
  <optVariables href="FORM.s069.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7618
    reference variance = 0.410947
====================================================
  Execution time = 2.6454e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4979e-01
  Total weights = 1.955328544e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439111128723
                                         uncertainty =       0.002464572009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439111128723
                                         uncertainty =       0.002464572009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468550756
  error estimate for blocks of size 2^( 2) =       0.000492724298
  error estimate for blocks of size 2^( 3) =       0.000515157570
  error estimate for blocks of size 2^( 4) =       0.000531992266
  error estimate for blocks of size 2^( 5) =       0.000542723916
  error estimate for blocks of size 2^( 6) =       0.000547606484
  error estimate for blocks of size 2^( 7) =       0.000548444222

      target function =      -0.745461839267
              le_mean =     -22.660887333752
             les_mean =     513.965604205483
             stat err =       0.000542691722
             autocorr =       1.341507509307
   target nu stat err =       0.000542691722
   target dn stat err =       0.003578452585
      target stat err =       0.002988507334
              std dev =       0.662630833705
             le_variance =       0.439079621777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266088733375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+13, overlap shift 9.0949e+14 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745472802561       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745472802561       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.54e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.6380e+14, overlap shift 3.6380e+15 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745472802561       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745472802561       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.51e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4552e+15, overlap shift 1.4552e+16 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745472802561       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745472802561       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.54e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.406238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1148e+01
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.6591
    reference variance = 0.493873
====================================================
  Execution time = 2.6118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5522e-01
  Total weights = 1.9554e+06
  Execution time = 3.5979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442421989793
                                         uncertainty =       0.002670609742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442421989793
                                         uncertainty =       0.002670609742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470332949
  error estimate for blocks of size 2^( 2) =       0.000494577592
  error estimate for blocks of size 2^( 3) =       0.000516972792
  error estimate for blocks of size 2^( 4) =       0.000532344114
  error estimate for blocks of size 2^( 5) =       0.000541841056
  error estimate for blocks of size 2^( 6) =       0.000545068979
  error estimate for blocks of size 2^( 7) =       0.000550399414

      target function =      -0.741044004061
              le_mean =     -22.661999494150
             les_mean =     514.021444947228
             stat err =       0.000542413391
             autocorr =       1.329994962632
   target nu stat err =       0.000542413391
   target dn stat err =       0.004104922135
      target stat err =       0.003377581272
              std dev =       0.665151235835
             le_variance =       0.442426166533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442421989793
                                         uncertainty =       0.002670609742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442421989793
                                         uncertainty =       0.002670609742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470332949
  error estimate for blocks of size 2^( 2) =       0.000494577592
  error estimate for blocks of size 2^( 3) =       0.000516972792
  error estimate for blocks of size 2^( 4) =       0.000532344114
  error estimate for blocks of size 2^( 5) =       0.000541841056
  error estimate for blocks of size 2^( 6) =       0.000545068979
  error estimate for blocks of size 2^( 7) =       0.000550399414

      target function =      -0.741044004061
              le_mean =     -22.661999494150
             les_mean =     514.021444947228
             stat err =       0.000542413391
             autocorr =       1.329994962632
   target nu stat err =       0.000542413391
   target dn stat err =       0.004104922135
      target stat err =       0.003377581272
              std dev =       0.665151235835
             le_variance =       0.442426166533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442421989793
                                         uncertainty =       0.002670609742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442421989793
                                         uncertainty =       0.002670609742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470332949
  error estimate for blocks of size 2^( 2) =       0.000494577592
  error estimate for blocks of size 2^( 3) =       0.000516972792
  error estimate for blocks of size 2^( 4) =       0.000532344114
  error estimate for blocks of size 2^( 5) =       0.000541841056
  error estimate for blocks of size 2^( 6) =       0.000545068979
  error estimate for blocks of size 2^( 7) =       0.000550399414

      target function =      -0.741044004061
              le_mean =     -22.661999494150
             les_mean =     514.021444947228
             stat err =       0.000542413391
             autocorr =       1.329994962632
   target nu stat err =       0.000542413391
   target dn stat err =       0.004104922135
      target stat err =       0.003377581272
              std dev =       0.665151235835
             le_variance =       0.442426166533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442421989793
                                         uncertainty =       0.002670609742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442421989793
                                         uncertainty =       0.002670609742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470332949
  error estimate for blocks of size 2^( 2) =       0.000494577592
  error estimate for blocks of size 2^( 3) =       0.000516972792
  error estimate for blocks of size 2^( 4) =       0.000532344114
  error estimate for blocks of size 2^( 5) =       0.000541841056
  error estimate for blocks of size 2^( 6) =       0.000545068979
  error estimate for blocks of size 2^( 7) =       0.000550399414

      target function =      -0.741044004061
              le_mean =     -22.661999494150
             les_mean =     514.021444947228
             stat err =       0.000542413391
             autocorr =       1.329994962632
   target nu stat err =       0.000542413391
   target dn stat err =       0.004104922135
      target stat err =       0.003377581272
              std dev =       0.665151235835
             le_variance =       0.442426166533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741044004061        initial  <--
     9.0949e+13     9.0949e+14             0.0000e+00        -0.741044004061
     3.6380e+14     3.6380e+15             0.0000e+00        -0.741044004061
     1.4552e+15     1.4552e+16             0.0000e+00        -0.741044004061

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2237
  </log>
  <optVariables href="FORM.s070.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5388e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.6155
    reference variance = 0.359665
====================================================
  Execution time = 2.6257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5078e-01
  Total weights = 1.955045420e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442564312139
                                         uncertainty =       0.002427942738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442564312139
                                         uncertainty =       0.002427942738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470380191
  error estimate for blocks of size 2^( 2) =       0.000494402396
  error estimate for blocks of size 2^( 3) =       0.000517110455
  error estimate for blocks of size 2^( 4) =       0.000533181913
  error estimate for blocks of size 2^( 5) =       0.000543792153
  error estimate for blocks of size 2^( 6) =       0.000547702502
  error estimate for blocks of size 2^( 7) =       0.000552056199

      target function =      -0.744668596910
              le_mean =     -22.661792138906
             les_mean =     514.007599555989
             stat err =       0.000544183192
             autocorr =       1.338419329090
   target nu stat err =       0.000544183192
   target dn stat err =       0.003008704231
      target stat err =       0.002531812863
              std dev =       0.665218044901
             le_variance =       0.442515047261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266179213891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+14, overlap shift 9.0949e+15 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744676393878       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744676393878       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744676393878       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744676393878       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744676393878       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744676393878       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744676037384       residual = 2.78e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744676393991       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937617799192       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -2.112736580501       residual = 3.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       0.257477393297       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.462500119506       residual = 1.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.184214536263       residual = 4.57e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -2.014816065220       residual = 4.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.051724697706       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.944623110451       residual = 1.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -4.845601003383       residual = 2.31e+04           smallest_sin_value = 1.00e+00
davidson iteration   17 stopping due to too large eigenvalue change
davidson solver did not converge after         17 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+14 is 4.091181e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+15, overlap shift 3.6380e+16 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744676393878       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744676393878       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744676393878       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744676393878       residual = 2.98e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744676393869       residual = 3.94e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744676401773       residual = 8.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.221110225581       residual = 2.95e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745766316560       residual = 2.85e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.823158453510       residual = 1.34e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =       0.738083046181       residual = 4.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -3.164185914634       residual = 2.58e+03           smallest_sin_value = 1.00e+00
davidson iteration   11 stopping due to too large eigenvalue change
davidson solver did not converge after         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+15 is 6.183669e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+16, overlap shift 1.4552e+17 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744676393878       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744676393878       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744676393878       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744676393878       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744676393878       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744676395057       residual = 2.90e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744653118197       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -5.378133093339       residual = 3.94e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.232940791864       residual = 4.60e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -5.507455932898       residual = 5.69e+03           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+16 is 1.673493e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.412816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1663e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.6623
    reference variance = 0.257849
====================================================
  Execution time = 2.5727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4734e-01
  Total weights = 1.9548e+06
  Execution time = 3.5867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437951581719
                                         uncertainty =       0.001980334942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437951581719
                                         uncertainty =       0.001980334942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467897061
  error estimate for blocks of size 2^( 2) =       0.000491999023
  error estimate for blocks of size 2^( 3) =       0.000514119283
  error estimate for blocks of size 2^( 4) =       0.000529959342
  error estimate for blocks of size 2^( 5) =       0.000539364101
  error estimate for blocks of size 2^( 6) =       0.000543580114
  error estimate for blocks of size 2^( 7) =       0.000544607707

      target function =      -0.747487208664
              le_mean =     -22.661512230056
             les_mean =     513.991476659970
             stat err =       0.000539377816
             autocorr =       1.328879266060
   target nu stat err =       0.000539377816
   target dn stat err =       0.002595911914
      target stat err =       0.002219004600
              std dev =       0.661706369899
             le_variance =       0.437855319965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437951581719
                                         uncertainty =       0.001980334942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437951581719
                                         uncertainty =       0.001980334942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467897061
  error estimate for blocks of size 2^( 2) =       0.000491999023
  error estimate for blocks of size 2^( 3) =       0.000514119283
  error estimate for blocks of size 2^( 4) =       0.000529959342
  error estimate for blocks of size 2^( 5) =       0.000539364101
  error estimate for blocks of size 2^( 6) =       0.000543580114
  error estimate for blocks of size 2^( 7) =       0.000544607707

      target function =      -0.747487208664
              le_mean =     -22.661512230056
             les_mean =     513.991476659970
             stat err =       0.000539377816
             autocorr =       1.328879266060
   target nu stat err =       0.000539377816
   target dn stat err =       0.002595911914
      target stat err =       0.002219004600
              std dev =       0.661706369899
             le_variance =       0.437855319965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437951581719
                                         uncertainty =       0.001980334942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437951581719
                                         uncertainty =       0.001980334942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467897061
  error estimate for blocks of size 2^( 2) =       0.000491999023
  error estimate for blocks of size 2^( 3) =       0.000514119283
  error estimate for blocks of size 2^( 4) =       0.000529959342
  error estimate for blocks of size 2^( 5) =       0.000539364101
  error estimate for blocks of size 2^( 6) =       0.000543580114
  error estimate for blocks of size 2^( 7) =       0.000544607707

      target function =      -0.747487208664
              le_mean =     -22.661512230056
             les_mean =     513.991476659970
             stat err =       0.000539377816
             autocorr =       1.328879266060
   target nu stat err =       0.000539377816
   target dn stat err =       0.002595911914
      target stat err =       0.002219004600
              std dev =       0.661706369899
             le_variance =       0.437855319965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437951581719
                                         uncertainty =       0.001980334942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437951581719
                                         uncertainty =       0.001980334942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467897061
  error estimate for blocks of size 2^( 2) =       0.000491999023
  error estimate for blocks of size 2^( 3) =       0.000514119283
  error estimate for blocks of size 2^( 4) =       0.000529959342
  error estimate for blocks of size 2^( 5) =       0.000539364101
  error estimate for blocks of size 2^( 6) =       0.000543580114
  error estimate for blocks of size 2^( 7) =       0.000544607707

      target function =      -0.747487208664
              le_mean =     -22.661512230056
             les_mean =     513.991476659970
             stat err =       0.000539377816
             autocorr =       1.328879266060
   target nu stat err =       0.000539377816
   target dn stat err =       0.002595911914
      target stat err =       0.002219004600
              std dev =       0.661706369899
             le_variance =       0.437855319965


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747487208664        initial
     9.0949e+14     9.0949e+15             4.0912e-19        -0.747487208664  <--
     3.6380e+15     3.6380e+16             6.1837e-20        -0.747487208664
     1.4552e+16     1.4552e+17             1.6735e-20        -0.747487208664

*****************************************************************************
Applying the update for shift_i =   9.0949e+14     and shift_s =   9.0949e+15
*****************************************************************************

  Execution time = 4.3785e+01
  </log>
  <optVariables href="FORM.s071.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5454e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.6715
    reference variance = 0.368703
====================================================
  Execution time = 2.6491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4128e-01
  Total weights = 1.955318031e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433725706092
                                         uncertainty =       0.001772822148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.433725706092
                                         uncertainty =       0.001772822148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000465648948
  error estimate for blocks of size 2^( 2) =       0.000489505473
  error estimate for blocks of size 2^( 3) =       0.000512198915
  error estimate for blocks of size 2^( 4) =       0.000528395128
  error estimate for blocks of size 2^( 5) =       0.000538107223
  error estimate for blocks of size 2^( 6) =       0.000542837950
  error estimate for blocks of size 2^( 7) =       0.000545376650

      target function =      -0.752522316220
              le_mean =     -22.661977350470
             les_mean =     514.006499877968
             stat err =       0.000538679238
             autocorr =       1.338268396095
   target nu stat err =       0.000538679238
   target dn stat err =       0.002135385827
      target stat err =       0.001881205887
              std dev =       0.658527057334
             le_variance =       0.433657885241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266197735047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+14, overlap shift 2.2737e+15 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752526071076       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752526071076       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752526071076       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752526071076       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752526071076       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752526126636       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752526071066       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752404242390       residual = 2.09e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.771111720197       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.714719320075       residual = 1.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.168913449520       residual = 5.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.983094833873       residual = 8.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.131534692989       residual = 2.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.726968835264       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.864821891852       residual = 6.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.614529720431       residual = 4.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.650786305585       residual = 9.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.515968038551       residual = 9.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.991550220630       residual = 4.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.717448565963       residual = 6.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.341957700500       residual = 4.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.697328681600       residual = 2.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       0.212197873437       residual = 5.31e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       2.649669953704       residual = 2.04e+05           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+14 is 1.275671e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+14, overlap shift 9.0949e+15 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752526071076       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752526071076       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752526071076       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752526071076       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752526071076       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752526071076       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.752526071077       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752527227295       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750366740184       residual = 3.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -2.152147628020       residual = 4.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       0.970568180853       residual = 5.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.397742034597       residual = 7.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.921343246778       residual = 2.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.019542603174       residual = 2.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       5.068545200017       residual = 1.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   15 stopping due to too large eigenvalue change
davidson solver did not converge after         15 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+14 is 3.188888e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+15, overlap shift 3.6380e+16 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.752526071076       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.752526071076       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.752526071076       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.752526071076       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.752526071076       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.752526071076       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.469185598547       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.752588532356       residual = 1.27e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.767470406846       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =       2.268953994918       residual = 1.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       2.860385231131       residual = 2.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.348130507886       residual = 1.12e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -4.032144848310       residual = 6.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       6.668075327769       residual = 3.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =       5.889854841052       residual = 3.94e+03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -2.741327349413       residual = 6.27e+03           smallest_sin_value = 1.00e+00
davidson iteration   16 stopping due to too large eigenvalue change
davidson solver did not converge after         16 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+15 is 7.965752e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.425682 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1179e+01
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7395
    reference variance = 0.288197
====================================================
  Execution time = 2.5968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5244e-01
  Total weights = 1.9551e+06
  Execution time = 3.5905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442757012944
                                         uncertainty =       0.002629707912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442757012944
                                         uncertainty =       0.002629707912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470585964
  error estimate for blocks of size 2^( 2) =       0.000494671457
  error estimate for blocks of size 2^( 3) =       0.000516820343
  error estimate for blocks of size 2^( 4) =       0.000532398572
  error estimate for blocks of size 2^( 5) =       0.000541409992
  error estimate for blocks of size 2^( 6) =       0.000546739417
  error estimate for blocks of size 2^( 7) =       0.000550916424

      target function =      -0.743311959635
              le_mean =     -22.662507103443
             les_mean =     514.041673015790
             stat err =       0.000542866101
             autocorr =       1.330783805788
   target nu stat err =       0.000542866101
   target dn stat err =       0.003227132412
      target stat err =       0.002698628811
              std dev =       0.665509053162
             le_variance =       0.442902299840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442757012944
                                         uncertainty =       0.002629707912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442757012944
                                         uncertainty =       0.002629707912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470585964
  error estimate for blocks of size 2^( 2) =       0.000494671457
  error estimate for blocks of size 2^( 3) =       0.000516820343
  error estimate for blocks of size 2^( 4) =       0.000532398572
  error estimate for blocks of size 2^( 5) =       0.000541409992
  error estimate for blocks of size 2^( 6) =       0.000546739417
  error estimate for blocks of size 2^( 7) =       0.000550916424

      target function =      -0.743311959635
              le_mean =     -22.662507103443
             les_mean =     514.041673015790
             stat err =       0.000542866101
             autocorr =       1.330783805792
   target nu stat err =       0.000542866101
   target dn stat err =       0.003227132412
      target stat err =       0.002698628811
              std dev =       0.665509053162
             le_variance =       0.442902299840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442757012944
                                         uncertainty =       0.002629707912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442757012944
                                         uncertainty =       0.002629707912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470585964
  error estimate for blocks of size 2^( 2) =       0.000494671457
  error estimate for blocks of size 2^( 3) =       0.000516820343
  error estimate for blocks of size 2^( 4) =       0.000532398572
  error estimate for blocks of size 2^( 5) =       0.000541409992
  error estimate for blocks of size 2^( 6) =       0.000546739417
  error estimate for blocks of size 2^( 7) =       0.000550916424

      target function =      -0.743311959635
              le_mean =     -22.662507103443
             les_mean =     514.041673015790
             stat err =       0.000542866101
             autocorr =       1.330783805792
   target nu stat err =       0.000542866101
   target dn stat err =       0.003227132412
      target stat err =       0.002698628811
              std dev =       0.665509053162
             le_variance =       0.442902299840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442757012944
                                         uncertainty =       0.002629707912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442757012944
                                         uncertainty =       0.002629707912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470585964
  error estimate for blocks of size 2^( 2) =       0.000494671457
  error estimate for blocks of size 2^( 3) =       0.000516820343
  error estimate for blocks of size 2^( 4) =       0.000532398572
  error estimate for blocks of size 2^( 5) =       0.000541409992
  error estimate for blocks of size 2^( 6) =       0.000546739417
  error estimate for blocks of size 2^( 7) =       0.000550916424

      target function =      -0.743311959635
              le_mean =     -22.662507103443
             les_mean =     514.041673015790
             stat err =       0.000542866101
             autocorr =       1.330783805790
   target nu stat err =       0.000542866101
   target dn stat err =       0.003227132412
      target stat err =       0.002698628811
              std dev =       0.665509053162
             le_variance =       0.442902299840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743311959635        initial  <--
     2.2737e+14     2.2737e+15             1.2757e-18        -0.743311959635
     9.0949e+14     9.0949e+15             3.1889e-19        -0.743311959635
     3.6380e+15     3.6380e+16             7.9658e-20        -0.743311959635

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0283
  </log>
  <optVariables href="FORM.s072.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5213e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.5892
    reference variance = 0.393753
====================================================
  Execution time = 2.6361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5227e-01
  Total weights = 1.955351000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439420776697
                                         uncertainty =       0.002510421348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439420776697
                                         uncertainty =       0.002510421348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468749287
  error estimate for blocks of size 2^( 2) =       0.000493333443
  error estimate for blocks of size 2^( 3) =       0.000515682699
  error estimate for blocks of size 2^( 4) =       0.000531634700
  error estimate for blocks of size 2^( 5) =       0.000542385614
  error estimate for blocks of size 2^( 6) =       0.000547965280
  error estimate for blocks of size 2^( 7) =       0.000551036550

      target function =      -0.743445604456
              le_mean =     -22.662036653894
             les_mean =     514.020178659425
             stat err =       0.000543255536
             autocorr =       1.343157932574
   target nu stat err =       0.000543255536
   target dn stat err =       0.003583381707
      target stat err =       0.002981785795
              std dev =       0.662911598763
             le_variance =       0.439451787774


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266203665389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+15, overlap shift 2.2737e+16 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743456652987       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743456652987       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.0949e+15, overlap shift 9.0949e+16 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743456652987       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743456652987       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.6380e+16, overlap shift 3.6380e+17 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743456652987       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743456652987       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.426755 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1065e+01
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.5819
    reference variance = 0.393651
====================================================
  Execution time = 2.7478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5114e-01
  Total weights = 1.9547e+06
  Execution time = 3.6417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441714528236
                                         uncertainty =       0.002484096697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441714528236
                                         uncertainty =       0.002484096697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470026092
  error estimate for blocks of size 2^( 2) =       0.000494255795
  error estimate for blocks of size 2^( 3) =       0.000516729879
  error estimate for blocks of size 2^( 4) =       0.000532683799
  error estimate for blocks of size 2^( 5) =       0.000542328131
  error estimate for blocks of size 2^( 6) =       0.000546087399
  error estimate for blocks of size 2^( 7) =       0.000547358769

      target function =      -0.744382779950
              le_mean =     -22.662586815727
             les_mean =     514.043976888967
             stat err =       0.000542114524
             autocorr =       1.330264960677
   target nu stat err =       0.000542114524
   target dn stat err =       0.003042618066
      target stat err =       0.002559329655
              std dev =       0.664717273951
             le_variance =       0.441849054289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441714528236
                                         uncertainty =       0.002484096697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441714528236
                                         uncertainty =       0.002484096697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470026092
  error estimate for blocks of size 2^( 2) =       0.000494255795
  error estimate for blocks of size 2^( 3) =       0.000516729879
  error estimate for blocks of size 2^( 4) =       0.000532683799
  error estimate for blocks of size 2^( 5) =       0.000542328131
  error estimate for blocks of size 2^( 6) =       0.000546087399
  error estimate for blocks of size 2^( 7) =       0.000547358769

      target function =      -0.744382779950
              le_mean =     -22.662586815727
             les_mean =     514.043976888967
             stat err =       0.000542114524
             autocorr =       1.330264960677
   target nu stat err =       0.000542114524
   target dn stat err =       0.003042618066
      target stat err =       0.002559329655
              std dev =       0.664717273951
             le_variance =       0.441849054289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441714528236
                                         uncertainty =       0.002484096697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441714528236
                                         uncertainty =       0.002484096697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470026092
  error estimate for blocks of size 2^( 2) =       0.000494255795
  error estimate for blocks of size 2^( 3) =       0.000516729879
  error estimate for blocks of size 2^( 4) =       0.000532683799
  error estimate for blocks of size 2^( 5) =       0.000542328131
  error estimate for blocks of size 2^( 6) =       0.000546087399
  error estimate for blocks of size 2^( 7) =       0.000547358769

      target function =      -0.744382779950
              le_mean =     -22.662586815727
             les_mean =     514.043976888967
             stat err =       0.000542114524
             autocorr =       1.330264960677
   target nu stat err =       0.000542114524
   target dn stat err =       0.003042618066
      target stat err =       0.002559329655
              std dev =       0.664717273951
             le_variance =       0.441849054289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441714528236
                                         uncertainty =       0.002484096697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441714528236
                                         uncertainty =       0.002484096697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470026092
  error estimate for blocks of size 2^( 2) =       0.000494255795
  error estimate for blocks of size 2^( 3) =       0.000516729879
  error estimate for blocks of size 2^( 4) =       0.000532683799
  error estimate for blocks of size 2^( 5) =       0.000542328131
  error estimate for blocks of size 2^( 6) =       0.000546087399
  error estimate for blocks of size 2^( 7) =       0.000547358769

      target function =      -0.744382779950
              le_mean =     -22.662586815727
             les_mean =     514.043976888967
             stat err =       0.000542114524
             autocorr =       1.330264960677
   target nu stat err =       0.000542114524
   target dn stat err =       0.003042618066
      target stat err =       0.002559329655
              std dev =       0.664717273951
             le_variance =       0.441849054289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744382779950        initial  <--
     2.2737e+15     2.2737e+16             0.0000e+00        -0.744382779950
     9.0949e+15     9.0949e+16             0.0000e+00        -0.744382779950
     3.6380e+16     3.6380e+17             0.0000e+00        -0.744382779950

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6986
  </log>
  <optVariables href="FORM.s073.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6335
    reference variance = 0.317511
====================================================
  Execution time = 2.6374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4754e-01
  Total weights = 1.955135393e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438605998065
                                         uncertainty =       0.002062778948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438605998065
                                         uncertainty =       0.002062778948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468273063
  error estimate for blocks of size 2^( 2) =       0.000492011605
  error estimate for blocks of size 2^( 3) =       0.000513755892
  error estimate for blocks of size 2^( 4) =       0.000529130307
  error estimate for blocks of size 2^( 5) =       0.000539082138
  error estimate for blocks of size 2^( 6) =       0.000544118101
  error estimate for blocks of size 2^( 7) =       0.000544634046

      target function =      -0.747329219857
              le_mean =     -22.661721285835
             les_mean =     514.001148406733
             stat err =       0.000539241148
             autocorr =       1.326073806353
   target nu stat err =       0.000539241148
   target dn stat err =       0.002420631048
      target stat err =       0.002080031750
              std dev =       0.662238117231
             le_variance =       0.438559323914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266172128583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+16, overlap shift 2.2737e+17 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747334101526       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747334101526       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747334101526       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+16 is 5.909428e-21

solving harmonic davidson linear method for identity shift 9.0949e+16, overlap shift 9.0949e+17 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747334101526       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747334101526       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747334101526       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+16 is 1.477357e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+17, overlap shift 3.6380e+18 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747334101526       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747334101526       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747334101526       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+17 is 3.693392e-22

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.428096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1058e+01
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6606
    reference variance = 0.295006
====================================================
  Execution time = 2.5557e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5118e-01
  Total weights = 1.9550e+06
  Execution time = 3.6102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440002788847
                                         uncertainty =       0.001958792800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440002788847
                                         uncertainty =       0.001958792800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469090755
  error estimate for blocks of size 2^( 2) =       0.000493212553
  error estimate for blocks of size 2^( 3) =       0.000515933855
  error estimate for blocks of size 2^( 4) =       0.000531879744
  error estimate for blocks of size 2^( 5) =       0.000541552198
  error estimate for blocks of size 2^( 6) =       0.000547790664
  error estimate for blocks of size 2^( 7) =       0.000553319975

      target function =      -0.744336095771
              le_mean =     -22.661585050883
             les_mean =     513.998619613599
             stat err =       0.000543635645
             autocorr =       1.343080678138
   target nu stat err =       0.000543635645
   target dn stat err =       0.002736562557
      target stat err =       0.002313294351
              std dev =       0.663394508335
             le_variance =       0.440092273689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440002788847
                                         uncertainty =       0.001958792800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440002788847
                                         uncertainty =       0.001958792800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469090755
  error estimate for blocks of size 2^( 2) =       0.000493212553
  error estimate for blocks of size 2^( 3) =       0.000515933855
  error estimate for blocks of size 2^( 4) =       0.000531879744
  error estimate for blocks of size 2^( 5) =       0.000541552198
  error estimate for blocks of size 2^( 6) =       0.000547790664
  error estimate for blocks of size 2^( 7) =       0.000553319975

      target function =      -0.744336095771
              le_mean =     -22.661585050883
             les_mean =     513.998619613599
             stat err =       0.000543635645
             autocorr =       1.343080678138
   target nu stat err =       0.000543635645
   target dn stat err =       0.002736562557
      target stat err =       0.002313294351
              std dev =       0.663394508335
             le_variance =       0.440092273689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440002788847
                                         uncertainty =       0.001958792800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440002788847
                                         uncertainty =       0.001958792800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469090755
  error estimate for blocks of size 2^( 2) =       0.000493212553
  error estimate for blocks of size 2^( 3) =       0.000515933855
  error estimate for blocks of size 2^( 4) =       0.000531879744
  error estimate for blocks of size 2^( 5) =       0.000541552198
  error estimate for blocks of size 2^( 6) =       0.000547790664
  error estimate for blocks of size 2^( 7) =       0.000553319975

      target function =      -0.744336095771
              le_mean =     -22.661585050883
             les_mean =     513.998619613599
             stat err =       0.000543635645
             autocorr =       1.343080678138
   target nu stat err =       0.000543635645
   target dn stat err =       0.002736562557
      target stat err =       0.002313294351
              std dev =       0.663394508335
             le_variance =       0.440092273689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440002788847
                                         uncertainty =       0.001958792800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440002788847
                                         uncertainty =       0.001958792800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469090755
  error estimate for blocks of size 2^( 2) =       0.000493212553
  error estimate for blocks of size 2^( 3) =       0.000515933855
  error estimate for blocks of size 2^( 4) =       0.000531879744
  error estimate for blocks of size 2^( 5) =       0.000541552198
  error estimate for blocks of size 2^( 6) =       0.000547790664
  error estimate for blocks of size 2^( 7) =       0.000553319975

      target function =      -0.744336095771
              le_mean =     -22.661585050883
             les_mean =     513.998619613599
             stat err =       0.000543635645
             autocorr =       1.343080678138
   target nu stat err =       0.000543635645
   target dn stat err =       0.002736562557
      target stat err =       0.002313294351
              std dev =       0.663394508335
             le_variance =       0.440092273689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744336095771        initial  <--
     2.2737e+16     2.2737e+17             5.9094e-21        -0.744336095771
     9.0949e+16     9.0949e+17             1.4774e-21        -0.744336095771
     3.6380e+17     3.6380e+18             3.6934e-22        -0.744336095771

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7389
  </log>
  <optVariables href="FORM.s074.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6412
    reference variance = 0.328031
====================================================
  Execution time = 2.7559e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5092e-01
  Total weights = 1.954794731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.9172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443106479272
                                         uncertainty =       0.005590626464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443106479272
                                         uncertainty =       0.005590626464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470690894
  error estimate for blocks of size 2^( 2) =       0.000494480908
  error estimate for blocks of size 2^( 3) =       0.000516482553
  error estimate for blocks of size 2^( 4) =       0.000532534761
  error estimate for blocks of size 2^( 5) =       0.000542682140
  error estimate for blocks of size 2^( 6) =       0.000548583342
  error estimate for blocks of size 2^( 7) =       0.000550940984

      target function =      -0.744528572803
              le_mean =     -22.661375447776
             les_mean =     513.988853113944
             stat err =       0.000543685307
             autocorr =       1.334208179274
   target nu stat err =       0.000543685307
   target dn stat err =       0.005722664952
      target stat err =       0.004712957062
              std dev =       0.665657446392
             le_variance =       0.443099835937


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266137544778e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+17, overlap shift 2.2737e+18 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744557840769       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744557840769       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744557840769       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+17 is 8.602548e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+17, overlap shift 9.0949e+18 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744557840769       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744557840769       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744557840769       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+17 is 2.150637e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+18, overlap shift 3.6380e+19 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744557840769       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744557840769       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744557840769       residual = 9.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744557840769       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+18 is 4.651180e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.429603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2483e+01
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6339
    reference variance = 0.305882
====================================================
  Execution time = 2.5735e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5025e-01
  Total weights = 1.9550e+06
  Execution time = 3.6151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441564142796
                                         uncertainty =       0.002258557143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441564142796
                                         uncertainty =       0.002258557143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469861511
  error estimate for blocks of size 2^( 2) =       0.000494408254
  error estimate for blocks of size 2^( 3) =       0.000516780589
  error estimate for blocks of size 2^( 4) =       0.000533362435
  error estimate for blocks of size 2^( 5) =       0.000542453404
  error estimate for blocks of size 2^( 6) =       0.000547185352
  error estimate for blocks of size 2^( 7) =       0.000551289436

      target function =      -0.745096329288
              le_mean =     -22.661367858090
             les_mean =     513.987842998203
             stat err =       0.000543572657
             autocorr =       1.338367749168
   target nu stat err =       0.000543572657
   target dn stat err =       0.002693126078
      target stat err =       0.002282784713
              std dev =       0.664484521371
             le_variance =       0.441539679142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441564142796
                                         uncertainty =       0.002258557143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441564142796
                                         uncertainty =       0.002258557143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469861511
  error estimate for blocks of size 2^( 2) =       0.000494408254
  error estimate for blocks of size 2^( 3) =       0.000516780589
  error estimate for blocks of size 2^( 4) =       0.000533362435
  error estimate for blocks of size 2^( 5) =       0.000542453404
  error estimate for blocks of size 2^( 6) =       0.000547185352
  error estimate for blocks of size 2^( 7) =       0.000551289436

      target function =      -0.745096329288
              le_mean =     -22.661367858090
             les_mean =     513.987842998203
             stat err =       0.000543572657
             autocorr =       1.338367749169
   target nu stat err =       0.000543572657
   target dn stat err =       0.002693126078
      target stat err =       0.002282784713
              std dev =       0.664484521371
             le_variance =       0.441539679142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441564142796
                                         uncertainty =       0.002258557143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441564142796
                                         uncertainty =       0.002258557143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469861511
  error estimate for blocks of size 2^( 2) =       0.000494408254
  error estimate for blocks of size 2^( 3) =       0.000516780589
  error estimate for blocks of size 2^( 4) =       0.000533362435
  error estimate for blocks of size 2^( 5) =       0.000542453404
  error estimate for blocks of size 2^( 6) =       0.000547185352
  error estimate for blocks of size 2^( 7) =       0.000551289436

      target function =      -0.745096329288
              le_mean =     -22.661367858090
             les_mean =     513.987842998203
             stat err =       0.000543572657
             autocorr =       1.338367749169
   target nu stat err =       0.000543572657
   target dn stat err =       0.002693126078
      target stat err =       0.002282784713
              std dev =       0.664484521371
             le_variance =       0.441539679142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441564142796
                                         uncertainty =       0.002258557143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441564142796
                                         uncertainty =       0.002258557143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469861511
  error estimate for blocks of size 2^( 2) =       0.000494408254
  error estimate for blocks of size 2^( 3) =       0.000516780589
  error estimate for blocks of size 2^( 4) =       0.000533362435
  error estimate for blocks of size 2^( 5) =       0.000542453404
  error estimate for blocks of size 2^( 6) =       0.000547185352
  error estimate for blocks of size 2^( 7) =       0.000551289436

      target function =      -0.745096329288
              le_mean =     -22.661367858090
             les_mean =     513.987842998203
             stat err =       0.000543572657
             autocorr =       1.338367749169
   target nu stat err =       0.000543572657
   target dn stat err =       0.002693126078
      target stat err =       0.002282784713
              std dev =       0.664484521371
             le_variance =       0.441539679142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745096329288        initial  <--
     2.2737e+17     2.2737e+18             8.6025e-22        -0.745096329288
     9.0949e+17     9.0949e+18             2.1506e-22        -0.745096329288
     3.6380e+18     3.6380e+19             4.6512e-23        -0.745096329288

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9266
  </log>
  <optVariables href="FORM.s075.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6428e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.628
    reference variance = 0.603699
====================================================
  Execution time = 2.6539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5003e-01
  Total weights = 1.954864449e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6688e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438971220375
                                         uncertainty =       0.002295585959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438971220375
                                         uncertainty =       0.002295585959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468488043
  error estimate for blocks of size 2^( 2) =       0.000493269014
  error estimate for blocks of size 2^( 3) =       0.000516103628
  error estimate for blocks of size 2^( 4) =       0.000532500465
  error estimate for blocks of size 2^( 5) =       0.000541793935
  error estimate for blocks of size 2^( 6) =       0.000547133084
  error estimate for blocks of size 2^( 7) =       0.000547386469

      target function =      -0.745283089845
              le_mean =     -22.661869733559
             les_mean =     514.010365385032
             stat err =       0.000542203488
             autocorr =       1.339453349955
   target nu stat err =       0.000542203488
   target dn stat err =       0.003229621933
      target stat err =       0.002711890896
              std dev =       0.662542144044
             le_variance =       0.438962092634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266186973356e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+18, overlap shift 2.2737e+19 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745291971209       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745291971209       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745291971209       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745291971244       residual = 1.34e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+18 is 8.955859e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+18, overlap shift 9.0949e+19 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745291971209       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745291971209       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745291971209       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745291971209       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+18 is 2.238965e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+19, overlap shift 3.6380e+20 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745291971209       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745291971209       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745291971209       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745291971369       residual = 6.68e+03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+19 is 5.597412e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.431259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1215e+01
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.6359
    reference variance = 0.39641
====================================================
  Execution time = 2.5608e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5948e-01
  Total weights = 1.9550e+06
  Execution time = 3.5897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591624081
                                         uncertainty =       0.004246115898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591624081
                                         uncertainty =       0.004246115898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470907176
  error estimate for blocks of size 2^( 2) =       0.000494736713
  error estimate for blocks of size 2^( 3) =       0.000517357186
  error estimate for blocks of size 2^( 4) =       0.000533328070
  error estimate for blocks of size 2^( 5) =       0.000543181874
  error estimate for blocks of size 2^( 6) =       0.000547304791
  error estimate for blocks of size 2^( 7) =       0.000551372697

      target function =      -0.737569647936
              le_mean =     -22.661988257933
             les_mean =     514.025190988786
             stat err =       0.000543796858
             autocorr =       1.333529940477
   target nu stat err =       0.000543796858
   target dn stat err =       0.008188326522
      target stat err =       0.006597646522
              std dev =       0.665963314903
             le_variance =       0.443507136796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591624081
                                         uncertainty =       0.004246115898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591624081
                                         uncertainty =       0.004246115898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470907176
  error estimate for blocks of size 2^( 2) =       0.000494736713
  error estimate for blocks of size 2^( 3) =       0.000517357186
  error estimate for blocks of size 2^( 4) =       0.000533328070
  error estimate for blocks of size 2^( 5) =       0.000543181874
  error estimate for blocks of size 2^( 6) =       0.000547304791
  error estimate for blocks of size 2^( 7) =       0.000551372697

      target function =      -0.737569647936
              le_mean =     -22.661988257933
             les_mean =     514.025190988786
             stat err =       0.000543796858
             autocorr =       1.333529940477
   target nu stat err =       0.000543796858
   target dn stat err =       0.008188326522
      target stat err =       0.006597646522
              std dev =       0.665963314903
             le_variance =       0.443507136796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591624081
                                         uncertainty =       0.004246115898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591624081
                                         uncertainty =       0.004246115898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470907176
  error estimate for blocks of size 2^( 2) =       0.000494736713
  error estimate for blocks of size 2^( 3) =       0.000517357186
  error estimate for blocks of size 2^( 4) =       0.000533328070
  error estimate for blocks of size 2^( 5) =       0.000543181874
  error estimate for blocks of size 2^( 6) =       0.000547304791
  error estimate for blocks of size 2^( 7) =       0.000551372697

      target function =      -0.737569647936
              le_mean =     -22.661988257933
             les_mean =     514.025190988786
             stat err =       0.000543796858
             autocorr =       1.333529940477
   target nu stat err =       0.000543796858
   target dn stat err =       0.008188326522
      target stat err =       0.006597646522
              std dev =       0.665963314903
             le_variance =       0.443507136796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591624081
                                         uncertainty =       0.004246115898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443591624081
                                         uncertainty =       0.004246115898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470907176
  error estimate for blocks of size 2^( 2) =       0.000494736713
  error estimate for blocks of size 2^( 3) =       0.000517357186
  error estimate for blocks of size 2^( 4) =       0.000533328070
  error estimate for blocks of size 2^( 5) =       0.000543181874
  error estimate for blocks of size 2^( 6) =       0.000547304791
  error estimate for blocks of size 2^( 7) =       0.000551372697

      target function =      -0.737569647936
              le_mean =     -22.661988257933
             les_mean =     514.025190988786
             stat err =       0.000543796858
             autocorr =       1.333529940477
   target nu stat err =       0.000543796858
   target dn stat err =       0.008188326522
      target stat err =       0.006597646522
              std dev =       0.665963314903
             le_variance =       0.443507136796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737569647936        initial  <--
     2.2737e+18     2.2737e+19             8.9559e-23        -0.737569647936
     9.0949e+18     9.0949e+19             2.2390e-23        -0.737569647936
     3.6380e+19     3.6380e+20             5.5974e-24        -0.737569647936

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6656
  </log>
  <optVariables href="FORM.s076.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4887e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.7001
    reference variance = 0.46798
====================================================
  Execution time = 2.6287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4867e-01
  Total weights = 1.955068334e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7545e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438946629173
                                         uncertainty =       0.002494915905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438946629173
                                         uncertainty =       0.002494915905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468652729
  error estimate for blocks of size 2^( 2) =       0.000492436870
  error estimate for blocks of size 2^( 3) =       0.000514495929
  error estimate for blocks of size 2^( 4) =       0.000530067627
  error estimate for blocks of size 2^( 5) =       0.000538841002
  error estimate for blocks of size 2^( 6) =       0.000543904895
  error estimate for blocks of size 2^( 7) =       0.000544656365

      target function =      -0.746394215555
              le_mean =     -22.661748161934
             les_mean =     514.003501018502
             stat err =       0.000539367472
             autocorr =       1.324546483156
   target nu stat err =       0.000539367472
   target dn stat err =       0.002902073154
      target stat err =       0.002456737109
              std dev =       0.662775044882
             le_variance =       0.439270760118


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266174816193e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+19, overlap shift 2.2737e+20 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746401389116       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746401389116       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746401389116       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746401389116       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+19 is 7.310204e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+19, overlap shift 9.0949e+20 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746401389116       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746401389116       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746401389116       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746401389116       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+19 is 1.835240e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+20, overlap shift 3.6380e+21 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746401389116       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746401389116       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746401389116       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746401389116       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+20 is 4.568877e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.433624 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.5045e+01
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.6965
    reference variance = 0.385239
====================================================
  Execution time = 2.5664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5050e-01
  Total weights = 1.9554e+06
  Execution time = 3.5851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891268949
                                         uncertainty =       0.002520656594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891268949
                                         uncertainty =       0.002520656594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468470516
  error estimate for blocks of size 2^( 2) =       0.000492730242
  error estimate for blocks of size 2^( 3) =       0.000515140676
  error estimate for blocks of size 2^( 4) =       0.000531615462
  error estimate for blocks of size 2^( 5) =       0.000541251039
  error estimate for blocks of size 2^( 6) =       0.000547229849
  error estimate for blocks of size 2^( 7) =       0.000548389641

      target function =      -0.744900981564
              le_mean =     -22.663072394109
             les_mean =     514.065346914569
             stat err =       0.000542121498
             autocorr =       1.339148478820
   target nu stat err =       0.000542121498
   target dn stat err =       0.004494464035
      target stat err =       0.003732510987
              std dev =       0.662517357786
             le_variance =       0.438929249368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891268949
                                         uncertainty =       0.002520656594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891268949
                                         uncertainty =       0.002520656594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468470516
  error estimate for blocks of size 2^( 2) =       0.000492730242
  error estimate for blocks of size 2^( 3) =       0.000515140676
  error estimate for blocks of size 2^( 4) =       0.000531615462
  error estimate for blocks of size 2^( 5) =       0.000541251039
  error estimate for blocks of size 2^( 6) =       0.000547229849
  error estimate for blocks of size 2^( 7) =       0.000548389641

      target function =      -0.744900981564
              le_mean =     -22.663072394109
             les_mean =     514.065346914569
             stat err =       0.000542121498
             autocorr =       1.339148478820
   target nu stat err =       0.000542121498
   target dn stat err =       0.004494464035
      target stat err =       0.003732510987
              std dev =       0.662517357786
             le_variance =       0.438929249368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891268949
                                         uncertainty =       0.002520656594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891268949
                                         uncertainty =       0.002520656594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468470516
  error estimate for blocks of size 2^( 2) =       0.000492730242
  error estimate for blocks of size 2^( 3) =       0.000515140676
  error estimate for blocks of size 2^( 4) =       0.000531615462
  error estimate for blocks of size 2^( 5) =       0.000541251039
  error estimate for blocks of size 2^( 6) =       0.000547229849
  error estimate for blocks of size 2^( 7) =       0.000548389641

      target function =      -0.744900981564
              le_mean =     -22.663072394109
             les_mean =     514.065346914569
             stat err =       0.000542121498
             autocorr =       1.339148478820
   target nu stat err =       0.000542121498
   target dn stat err =       0.004494464035
      target stat err =       0.003732510987
              std dev =       0.662517357786
             le_variance =       0.438929249368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891268949
                                         uncertainty =       0.002520656594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438891268949
                                         uncertainty =       0.002520656594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468470516
  error estimate for blocks of size 2^( 2) =       0.000492730242
  error estimate for blocks of size 2^( 3) =       0.000515140676
  error estimate for blocks of size 2^( 4) =       0.000531615462
  error estimate for blocks of size 2^( 5) =       0.000541251039
  error estimate for blocks of size 2^( 6) =       0.000547229849
  error estimate for blocks of size 2^( 7) =       0.000548389641

      target function =      -0.744900981564
              le_mean =     -22.663072394109
             les_mean =     514.065346914569
             stat err =       0.000542121498
             autocorr =       1.339148478820
   target nu stat err =       0.000542121498
   target dn stat err =       0.004494464035
      target stat err =       0.003732510987
              std dev =       0.662517357786
             le_variance =       0.438929249368


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744900981564        initial  <--
     2.2737e+19     2.2737e+20             7.3102e-24        -0.744900981564
     9.0949e+19     9.0949e+20             1.8352e-24        -0.744900981564
     3.6380e+20     3.6380e+21             4.5689e-25        -0.744900981564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6894
  </log>
  <optVariables href="FORM.s077.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6582
    reference variance = 0.396469
====================================================
  Execution time = 2.6238e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5259e-01
  Total weights = 1.954982704e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442309835132
                                         uncertainty =       0.002431397358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442309835132
                                         uncertainty =       0.002431397358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471007491
  error estimate for blocks of size 2^( 2) =       0.000495057267
  error estimate for blocks of size 2^( 3) =       0.000517421118
  error estimate for blocks of size 2^( 4) =       0.000533952483
  error estimate for blocks of size 2^( 5) =       0.000542816583
  error estimate for blocks of size 2^( 6) =       0.000550145876
  error estimate for blocks of size 2^( 7) =       0.000553130758

      target function =      -0.743176689415
              le_mean =     -22.660849434139
             les_mean =     513.966687790515
             stat err =       0.000545011425
             autocorr =       1.338922943526
   target nu stat err =       0.000545011425
   target dn stat err =       0.002790919520
      target stat err =       0.002346966126
              std dev =       0.666105182336
             le_variance =       0.443696113935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266084943414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+20, overlap shift 2.2737e+21 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743186923195       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743186923195       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+20, overlap shift 9.0949e+21 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743186923195       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743186923195       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+21, overlap shift 3.6380e+22 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743186923195       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743186923195       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.434742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0893e+01
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.607
    reference variance = 0.396579
====================================================
  Execution time = 2.5723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4998e-01
  Total weights = 1.9553e+06
  Execution time = 3.6006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117121434
                                         uncertainty =       0.003058660878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117121434
                                         uncertainty =       0.003058660878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469110443
  error estimate for blocks of size 2^( 2) =       0.000493401379
  error estimate for blocks of size 2^( 3) =       0.000516104599
  error estimate for blocks of size 2^( 4) =       0.000531695000
  error estimate for blocks of size 2^( 5) =       0.000540598552
  error estimate for blocks of size 2^( 6) =       0.000546365958
  error estimate for blocks of size 2^( 7) =       0.000548562643

      target function =      -0.745317251371
              le_mean =     -22.662082007989
             les_mean =     514.019944968136
             stat err =       0.000541805539
             autocorr =       1.333941177517
   target nu stat err =       0.000541805539
   target dn stat err =       0.003587423394
      target stat err =       0.002999647876
              std dev =       0.663422350320
             le_variance =       0.440129214904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117121434
                                         uncertainty =       0.003058660878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117121434
                                         uncertainty =       0.003058660878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469110443
  error estimate for blocks of size 2^( 2) =       0.000493401379
  error estimate for blocks of size 2^( 3) =       0.000516104599
  error estimate for blocks of size 2^( 4) =       0.000531695000
  error estimate for blocks of size 2^( 5) =       0.000540598552
  error estimate for blocks of size 2^( 6) =       0.000546365958
  error estimate for blocks of size 2^( 7) =       0.000548562643

      target function =      -0.745317251371
              le_mean =     -22.662082007989
             les_mean =     514.019944968136
             stat err =       0.000541805539
             autocorr =       1.333941177517
   target nu stat err =       0.000541805539
   target dn stat err =       0.003587423394
      target stat err =       0.002999647876
              std dev =       0.663422350320
             le_variance =       0.440129214904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117121434
                                         uncertainty =       0.003058660878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117121434
                                         uncertainty =       0.003058660878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469110443
  error estimate for blocks of size 2^( 2) =       0.000493401379
  error estimate for blocks of size 2^( 3) =       0.000516104599
  error estimate for blocks of size 2^( 4) =       0.000531695000
  error estimate for blocks of size 2^( 5) =       0.000540598552
  error estimate for blocks of size 2^( 6) =       0.000546365958
  error estimate for blocks of size 2^( 7) =       0.000548562643

      target function =      -0.745317251371
              le_mean =     -22.662082007989
             les_mean =     514.019944968136
             stat err =       0.000541805539
             autocorr =       1.333941177517
   target nu stat err =       0.000541805539
   target dn stat err =       0.003587423394
      target stat err =       0.002999647876
              std dev =       0.663422350320
             le_variance =       0.440129214904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117121434
                                         uncertainty =       0.003058660878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117121434
                                         uncertainty =       0.003058660878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469110443
  error estimate for blocks of size 2^( 2) =       0.000493401379
  error estimate for blocks of size 2^( 3) =       0.000516104599
  error estimate for blocks of size 2^( 4) =       0.000531695000
  error estimate for blocks of size 2^( 5) =       0.000540598552
  error estimate for blocks of size 2^( 6) =       0.000546365958
  error estimate for blocks of size 2^( 7) =       0.000548562643

      target function =      -0.745317251371
              le_mean =     -22.662082007989
             les_mean =     514.019944968136
             stat err =       0.000541805539
             autocorr =       1.333941177517
   target nu stat err =       0.000541805539
   target dn stat err =       0.003587423394
      target stat err =       0.002999647876
              std dev =       0.663422350320
             le_variance =       0.440129214904


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745317251371        initial  <--
     2.2737e+20     2.2737e+21             0.0000e+00        -0.745317251371
     9.0949e+20     9.0949e+21             0.0000e+00        -0.745317251371
     3.6380e+21     3.6380e+22             0.0000e+00        -0.745317251371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7941
  </log>
  <optVariables href="FORM.s078.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.6404
    reference variance = 0.749413
====================================================
  Execution time = 2.8230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5185e-01
  Total weights = 1.955152525e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7483e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442630426962
                                         uncertainty =       0.002156250143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442630426962
                                         uncertainty =       0.002156250143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470430512
  error estimate for blocks of size 2^( 2) =       0.000494486893
  error estimate for blocks of size 2^( 3) =       0.000516589161
  error estimate for blocks of size 2^( 4) =       0.000533091352
  error estimate for blocks of size 2^( 5) =       0.000541452766
  error estimate for blocks of size 2^( 6) =       0.000547333345
  error estimate for blocks of size 2^( 7) =       0.000552608415

      target function =      -0.743784244465
              le_mean =     -22.660781604817
             les_mean =     513.962870519253
             stat err =       0.000543621469
             autocorr =       1.335371905575
   target nu stat err =       0.000543621469
   target dn stat err =       0.002855246018
      target stat err =       0.002400775686
              std dev =       0.665289210784
             le_variance =       0.442609733986


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266078160482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+21, overlap shift 2.2737e+22 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743791069287       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743791069287       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+21, overlap shift 9.0949e+22 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743791069287       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743791069287       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+22, overlap shift 3.6380e+23 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743791069287       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743791069287       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.435863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2986e+01
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.5862
    reference variance = 0.599957
====================================================
  Execution time = 2.5595e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4921e-01
  Total weights = 1.9553e+06
  Execution time = 3.6292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440080144530
                                         uncertainty =       0.002138289569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440080144530
                                         uncertainty =       0.002138289569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469104221
  error estimate for blocks of size 2^( 2) =       0.000493297505
  error estimate for blocks of size 2^( 3) =       0.000515697023
  error estimate for blocks of size 2^( 4) =       0.000532022950
  error estimate for blocks of size 2^( 5) =       0.000541840551
  error estimate for blocks of size 2^( 6) =       0.000546820084
  error estimate for blocks of size 2^( 7) =       0.000549683001

      target function =      -0.745956682104
              le_mean =     -22.662033127813
             les_mean =     514.016954331775
             stat err =       0.000542591647
             autocorr =       1.337850316934
   target nu stat err =       0.000542591647
   target dn stat err =       0.002879710125
      target stat err =       0.002438031160
              std dev =       0.663413550952
             le_variance =       0.440117539587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440080144530
                                         uncertainty =       0.002138289569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440080144530
                                         uncertainty =       0.002138289569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469104221
  error estimate for blocks of size 2^( 2) =       0.000493297505
  error estimate for blocks of size 2^( 3) =       0.000515697023
  error estimate for blocks of size 2^( 4) =       0.000532022950
  error estimate for blocks of size 2^( 5) =       0.000541840551
  error estimate for blocks of size 2^( 6) =       0.000546820084
  error estimate for blocks of size 2^( 7) =       0.000549683001

      target function =      -0.745956682104
              le_mean =     -22.662033127813
             les_mean =     514.016954331775
             stat err =       0.000542591647
             autocorr =       1.337850316934
   target nu stat err =       0.000542591647
   target dn stat err =       0.002879710125
      target stat err =       0.002438031160
              std dev =       0.663413550952
             le_variance =       0.440117539587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440080144530
                                         uncertainty =       0.002138289569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440080144530
                                         uncertainty =       0.002138289569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469104221
  error estimate for blocks of size 2^( 2) =       0.000493297505
  error estimate for blocks of size 2^( 3) =       0.000515697023
  error estimate for blocks of size 2^( 4) =       0.000532022950
  error estimate for blocks of size 2^( 5) =       0.000541840551
  error estimate for blocks of size 2^( 6) =       0.000546820084
  error estimate for blocks of size 2^( 7) =       0.000549683001

      target function =      -0.745956682104
              le_mean =     -22.662033127813
             les_mean =     514.016954331775
             stat err =       0.000542591647
             autocorr =       1.337850316934
   target nu stat err =       0.000542591647
   target dn stat err =       0.002879710125
      target stat err =       0.002438031160
              std dev =       0.663413550952
             le_variance =       0.440117539587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440080144530
                                         uncertainty =       0.002138289569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440080144530
                                         uncertainty =       0.002138289569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469104221
  error estimate for blocks of size 2^( 2) =       0.000493297505
  error estimate for blocks of size 2^( 3) =       0.000515697023
  error estimate for blocks of size 2^( 4) =       0.000532022950
  error estimate for blocks of size 2^( 5) =       0.000541840551
  error estimate for blocks of size 2^( 6) =       0.000546820084
  error estimate for blocks of size 2^( 7) =       0.000549683001

      target function =      -0.745956682104
              le_mean =     -22.662033127813
             les_mean =     514.016954331775
             stat err =       0.000542591647
             autocorr =       1.337850316934
   target nu stat err =       0.000542591647
   target dn stat err =       0.002879710125
      target stat err =       0.002438031160
              std dev =       0.663413550952
             le_variance =       0.440117539587


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745956682104        initial  <--
     2.2737e+21     2.2737e+22             0.0000e+00        -0.745956682104
     9.0949e+21     9.0949e+22             0.0000e+00        -0.745956682104
     3.6380e+22     3.6380e+23             0.0000e+00        -0.745956682104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8363
  </log>
  <optVariables href="FORM.s079.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6665
    reference variance = 0.334006
====================================================
  Execution time = 2.6337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5193e-01
  Total weights = 1.955191092e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443532203820
                                         uncertainty =       0.002645064456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443532203820
                                         uncertainty =       0.002645064456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470921481
  error estimate for blocks of size 2^( 2) =       0.000494903086
  error estimate for blocks of size 2^( 3) =       0.000516360556
  error estimate for blocks of size 2^( 4) =       0.000532226977
  error estimate for blocks of size 2^( 5) =       0.000541638461
  error estimate for blocks of size 2^( 6) =       0.000548843960
  error estimate for blocks of size 2^( 7) =       0.000551670712

      target function =      -0.743729155381
              le_mean =     -22.662279346324
             les_mean =     514.030836875030
             stat err =       0.000543595028
             autocorr =       1.332459290094
   target nu stat err =       0.000543595028
   target dn stat err =       0.003142859102
      target stat err =       0.002633807394
              std dev =       0.665983544779
             le_variance =       0.443534081917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266227934632e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+22, overlap shift 2.2737e+23 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743737504435       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743737504435       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+22, overlap shift 9.0949e+23 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743737504435       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743737504435       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+23, overlap shift 3.6380e+24 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743737504435       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743737504435       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.436978 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1096e+01
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6543
    reference variance = 0.524037
====================================================
  Execution time = 2.5556e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5751e-01
  Total weights = 1.9553e+06
  Execution time = 3.6023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448810806437
                                         uncertainty =       0.002541779867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448810806437
                                         uncertainty =       0.002541779867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473731515
  error estimate for blocks of size 2^( 2) =       0.000497710083
  error estimate for blocks of size 2^( 3) =       0.000519961256
  error estimate for blocks of size 2^( 4) =       0.000535907721
  error estimate for blocks of size 2^( 5) =       0.000545753448
  error estimate for blocks of size 2^( 6) =       0.000550290568
  error estimate for blocks of size 2^( 7) =       0.000553461252

      target function =      -0.739201332932
              le_mean =     -22.661394282335
             les_mean =     513.996301493976
             stat err =       0.000546353247
             autocorr =       1.330094519126
   target nu stat err =       0.000546353247
   target dn stat err =       0.003025099763
      target stat err =       0.002507727185
              std dev =       0.669957532779
             le_variance =       0.448843095727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448810806437
                                         uncertainty =       0.002541779867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448810806437
                                         uncertainty =       0.002541779867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473731515
  error estimate for blocks of size 2^( 2) =       0.000497710083
  error estimate for blocks of size 2^( 3) =       0.000519961256
  error estimate for blocks of size 2^( 4) =       0.000535907721
  error estimate for blocks of size 2^( 5) =       0.000545753448
  error estimate for blocks of size 2^( 6) =       0.000550290568
  error estimate for blocks of size 2^( 7) =       0.000553461252

      target function =      -0.739201332932
              le_mean =     -22.661394282335
             les_mean =     513.996301493976
             stat err =       0.000546353247
             autocorr =       1.330094519126
   target nu stat err =       0.000546353247
   target dn stat err =       0.003025099763
      target stat err =       0.002507727185
              std dev =       0.669957532779
             le_variance =       0.448843095727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448810806437
                                         uncertainty =       0.002541779867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448810806437
                                         uncertainty =       0.002541779867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473731515
  error estimate for blocks of size 2^( 2) =       0.000497710083
  error estimate for blocks of size 2^( 3) =       0.000519961256
  error estimate for blocks of size 2^( 4) =       0.000535907721
  error estimate for blocks of size 2^( 5) =       0.000545753448
  error estimate for blocks of size 2^( 6) =       0.000550290568
  error estimate for blocks of size 2^( 7) =       0.000553461252

      target function =      -0.739201332932
              le_mean =     -22.661394282335
             les_mean =     513.996301493976
             stat err =       0.000546353247
             autocorr =       1.330094519126
   target nu stat err =       0.000546353247
   target dn stat err =       0.003025099763
      target stat err =       0.002507727185
              std dev =       0.669957532779
             le_variance =       0.448843095727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448810806437
                                         uncertainty =       0.002541779867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448810806437
                                         uncertainty =       0.002541779867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473731515
  error estimate for blocks of size 2^( 2) =       0.000497710083
  error estimate for blocks of size 2^( 3) =       0.000519961256
  error estimate for blocks of size 2^( 4) =       0.000535907721
  error estimate for blocks of size 2^( 5) =       0.000545753448
  error estimate for blocks of size 2^( 6) =       0.000550290568
  error estimate for blocks of size 2^( 7) =       0.000553461252

      target function =      -0.739201332932
              le_mean =     -22.661394282335
             les_mean =     513.996301493976
             stat err =       0.000546353247
             autocorr =       1.330094519126
   target nu stat err =       0.000546353247
   target dn stat err =       0.003025099763
      target stat err =       0.002507727185
              std dev =       0.669957532779
             le_variance =       0.448843095727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739201332932        initial  <--
     2.2737e+22     2.2737e+23             0.0000e+00        -0.739201332932
     9.0949e+22     9.0949e+23             0.0000e+00        -0.739201332932
     3.6380e+23     3.6380e+24             0.0000e+00        -0.739201332932

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6559
  </log>
  <optVariables href="FORM.s080.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4774e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.5662
    reference variance = 0.190497
====================================================
  Execution time = 2.7081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5385e-01
  Total weights = 1.954953125e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.1396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444819681988
                                         uncertainty =       0.006928564620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444819681988
                                         uncertainty =       0.006928564620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471582260
  error estimate for blocks of size 2^( 2) =       0.000495580536
  error estimate for blocks of size 2^( 3) =       0.000517459505
  error estimate for blocks of size 2^( 4) =       0.000534183344
  error estimate for blocks of size 2^( 5) =       0.000542482031
  error estimate for blocks of size 2^( 6) =       0.000546997587
  error estimate for blocks of size 2^( 7) =       0.000551554860

      target function =      -0.742133668763
              le_mean =     -22.662088472303
             les_mean =     514.024100536320
             stat err =       0.000543804456
             autocorr =       1.329751851314
   target nu stat err =       0.000543804456
   target dn stat err =       0.007011176977
      target stat err =       0.005728011389
              std dev =       0.666918028548
             le_variance =       0.444779656803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266208847230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+23, overlap shift 2.2737e+24 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742176467742       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742176467742       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+23, overlap shift 9.0949e+24 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742176467742       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742176467742       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+24, overlap shift 3.6380e+25 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742176467742       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742176467742       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.438083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2227e+01
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.5761
    reference variance = 0.393025
====================================================
  Execution time = 2.5903e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5286e-01
  Total weights = 1.9551e+06
  Execution time = 3.6212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443645788972
                                         uncertainty =       0.002874263318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443645788972
                                         uncertainty =       0.002874263318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471009153
  error estimate for blocks of size 2^( 2) =       0.000495041789
  error estimate for blocks of size 2^( 3) =       0.000516857359
  error estimate for blocks of size 2^( 4) =       0.000533464322
  error estimate for blocks of size 2^( 5) =       0.000543567638
  error estimate for blocks of size 2^( 6) =       0.000547424313
  error estimate for blocks of size 2^( 7) =       0.000549819797

      target function =      -0.742970835141
              le_mean =     -22.662049738677
             les_mean =     514.021356683392
             stat err =       0.000543569018
             autocorr =       1.331835834114
   target nu stat err =       0.000543569018
   target dn stat err =       0.003304290904
      target stat err =       0.002755876554
              std dev =       0.666107532482
             le_variance =       0.443699244830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443645788972
                                         uncertainty =       0.002874263318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443645788972
                                         uncertainty =       0.002874263318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471009153
  error estimate for blocks of size 2^( 2) =       0.000495041789
  error estimate for blocks of size 2^( 3) =       0.000516857359
  error estimate for blocks of size 2^( 4) =       0.000533464322
  error estimate for blocks of size 2^( 5) =       0.000543567638
  error estimate for blocks of size 2^( 6) =       0.000547424313
  error estimate for blocks of size 2^( 7) =       0.000549819797

      target function =      -0.742970835141
              le_mean =     -22.662049738677
             les_mean =     514.021356683392
             stat err =       0.000543569018
             autocorr =       1.331835834114
   target nu stat err =       0.000543569018
   target dn stat err =       0.003304290904
      target stat err =       0.002755876554
              std dev =       0.666107532482
             le_variance =       0.443699244830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443645788972
                                         uncertainty =       0.002874263318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443645788972
                                         uncertainty =       0.002874263318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471009153
  error estimate for blocks of size 2^( 2) =       0.000495041789
  error estimate for blocks of size 2^( 3) =       0.000516857359
  error estimate for blocks of size 2^( 4) =       0.000533464322
  error estimate for blocks of size 2^( 5) =       0.000543567638
  error estimate for blocks of size 2^( 6) =       0.000547424313
  error estimate for blocks of size 2^( 7) =       0.000549819797

      target function =      -0.742970835141
              le_mean =     -22.662049738677
             les_mean =     514.021356683392
             stat err =       0.000543569018
             autocorr =       1.331835834114
   target nu stat err =       0.000543569018
   target dn stat err =       0.003304290904
      target stat err =       0.002755876554
              std dev =       0.666107532482
             le_variance =       0.443699244830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443645788972
                                         uncertainty =       0.002874263318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443645788972
                                         uncertainty =       0.002874263318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471009153
  error estimate for blocks of size 2^( 2) =       0.000495041789
  error estimate for blocks of size 2^( 3) =       0.000516857359
  error estimate for blocks of size 2^( 4) =       0.000533464322
  error estimate for blocks of size 2^( 5) =       0.000543567638
  error estimate for blocks of size 2^( 6) =       0.000547424313
  error estimate for blocks of size 2^( 7) =       0.000549819797

      target function =      -0.742970835141
              le_mean =     -22.662049738677
             les_mean =     514.021356683392
             stat err =       0.000543569018
             autocorr =       1.331835834114
   target nu stat err =       0.000543569018
   target dn stat err =       0.003304290904
      target stat err =       0.002755876554
              std dev =       0.666107532482
             le_variance =       0.443699244830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742970835141        initial  <--
     2.2737e+23     2.2737e+24             0.0000e+00        -0.742970835141
     9.0949e+23     9.0949e+24             0.0000e+00        -0.742970835141
     3.6380e+24     3.6380e+25             0.0000e+00        -0.742970835141

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0276
  </log>
  <optVariables href="FORM.s081.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6260e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.6772
    reference variance = 0.30797
====================================================
  Execution time = 2.6377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4840e-01
  Total weights = 1.955190732e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439419682709
                                         uncertainty =       0.002419426307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439419682709
                                         uncertainty =       0.002419426307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468718839
  error estimate for blocks of size 2^( 2) =       0.000492820362
  error estimate for blocks of size 2^( 3) =       0.000514947431
  error estimate for blocks of size 2^( 4) =       0.000530653392
  error estimate for blocks of size 2^( 5) =       0.000541060590
  error estimate for blocks of size 2^( 6) =       0.000545802782
  error estimate for blocks of size 2^( 7) =       0.000546924882

      target function =      -0.746611630548
              le_mean =     -22.661153679523
             les_mean =     513.976284544669
             stat err =       0.000541110412
             autocorr =       1.332744691894
   target nu stat err =       0.000541110412
   target dn stat err =       0.002529579023
      target stat err =       0.002160919108
              std dev =       0.662868539458
             le_variance =       0.439394700603


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266115367952e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+24, overlap shift 2.2737e+25 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746616956003       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746616956003       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746616956003       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+24 is 6.497446e-29

solving harmonic davidson linear method for identity shift 9.0949e+24, overlap shift 9.0949e+25 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746616956003       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746616956003       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746616956003       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+24 is 1.624362e-29

solving harmonic davidson linear method for identity shift 3.6380e+25, overlap shift 3.6380e+26 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746616956003       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746616956003       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746616956003       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+25 is 4.060904e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.439416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1100e+01
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.7456
    reference variance = 0.306549
====================================================
  Execution time = 2.5701e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4554e-01
  Total weights = 1.9554e+06
  Execution time = 3.6051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708520965
                                         uncertainty =       0.002153245556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708520965
                                         uncertainty =       0.002153245556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467786236
  error estimate for blocks of size 2^( 2) =       0.000491296861
  error estimate for blocks of size 2^( 3) =       0.000513844945
  error estimate for blocks of size 2^( 4) =       0.000529680987
  error estimate for blocks of size 2^( 5) =       0.000539810086
  error estimate for blocks of size 2^( 6) =       0.000543041622
  error estimate for blocks of size 2^( 7) =       0.000543381171

      target function =      -0.748955003134
              le_mean =     -22.660681617382
             les_mean =     513.952035518551
             stat err =       0.000538978467
             autocorr =       1.327541023940
   target nu stat err =       0.000538978467
   target dn stat err =       0.002318617855
      target stat err =       0.002004834733
              std dev =       0.661549639379
             le_variance =       0.437647925362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708520965
                                         uncertainty =       0.002153245556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708520965
                                         uncertainty =       0.002153245556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467786236
  error estimate for blocks of size 2^( 2) =       0.000491296861
  error estimate for blocks of size 2^( 3) =       0.000513844945
  error estimate for blocks of size 2^( 4) =       0.000529680987
  error estimate for blocks of size 2^( 5) =       0.000539810086
  error estimate for blocks of size 2^( 6) =       0.000543041622
  error estimate for blocks of size 2^( 7) =       0.000543381171

      target function =      -0.748955003134
              le_mean =     -22.660681617382
             les_mean =     513.952035518551
             stat err =       0.000538978467
             autocorr =       1.327541023940
   target nu stat err =       0.000538978467
   target dn stat err =       0.002318617855
      target stat err =       0.002004834733
              std dev =       0.661549639379
             le_variance =       0.437647925362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708520965
                                         uncertainty =       0.002153245556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708520965
                                         uncertainty =       0.002153245556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467786236
  error estimate for blocks of size 2^( 2) =       0.000491296861
  error estimate for blocks of size 2^( 3) =       0.000513844945
  error estimate for blocks of size 2^( 4) =       0.000529680987
  error estimate for blocks of size 2^( 5) =       0.000539810086
  error estimate for blocks of size 2^( 6) =       0.000543041622
  error estimate for blocks of size 2^( 7) =       0.000543381171

      target function =      -0.748955003134
              le_mean =     -22.660681617382
             les_mean =     513.952035518551
             stat err =       0.000538978467
             autocorr =       1.327541023940
   target nu stat err =       0.000538978467
   target dn stat err =       0.002318617855
      target stat err =       0.002004834733
              std dev =       0.661549639379
             le_variance =       0.437647925362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708520965
                                         uncertainty =       0.002153245556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437708520965
                                         uncertainty =       0.002153245556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467786236
  error estimate for blocks of size 2^( 2) =       0.000491296861
  error estimate for blocks of size 2^( 3) =       0.000513844945
  error estimate for blocks of size 2^( 4) =       0.000529680987
  error estimate for blocks of size 2^( 5) =       0.000539810086
  error estimate for blocks of size 2^( 6) =       0.000543041622
  error estimate for blocks of size 2^( 7) =       0.000543381171

      target function =      -0.748955003134
              le_mean =     -22.660681617382
             les_mean =     513.952035518551
             stat err =       0.000538978467
             autocorr =       1.327541023940
   target nu stat err =       0.000538978467
   target dn stat err =       0.002318617855
      target stat err =       0.002004834733
              std dev =       0.661549639379
             le_variance =       0.437647925362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748955003134        initial  <--
     2.2737e+24     2.2737e+25             6.4974e-29        -0.748955003134
     9.0949e+24     9.0949e+25             1.6244e-29        -0.748955003134
     3.6380e+25     3.6380e+26             4.0609e-30        -0.748955003134

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8339
  </log>
  <optVariables href="FORM.s082.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7074
    reference variance = 0.443436
====================================================
  Execution time = 2.8276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5017e-01
  Total weights = 1.955370573e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440651207457
                                         uncertainty =       0.001984510814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440651207457
                                         uncertainty =       0.001984510814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469375711
  error estimate for blocks of size 2^( 2) =       0.000493479999
  error estimate for blocks of size 2^( 3) =       0.000515696805
  error estimate for blocks of size 2^( 4) =       0.000531512705
  error estimate for blocks of size 2^( 5) =       0.000541619321
  error estimate for blocks of size 2^( 6) =       0.000546690060
  error estimate for blocks of size 2^( 7) =       0.000551808620

      target function =      -0.745175692739
              le_mean =     -22.662767827073
             les_mean =     514.051218812338
             stat err =       0.000542907676
             autocorr =       1.337860216910
   target nu stat err =       0.000542907676
   target dn stat err =       0.002493473177
      target stat err =       0.002130172839
              std dev =       0.663797496960
             le_variance =       0.440627116971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266276782707e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+25, overlap shift 2.2737e+26 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745180801184       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745180801184       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+25, overlap shift 9.0949e+26 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745180801184       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745180801184       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+26, overlap shift 3.6380e+27 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745180801184       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745180801184       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.440519 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3002e+01
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7292
    reference variance = 0.489947
====================================================
  Execution time = 2.5558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4777e-01
  Total weights = 1.9550e+06
  Execution time = 3.6078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439108720304
                                         uncertainty =       0.002009404984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439108720304
                                         uncertainty =       0.002009404984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468555592
  error estimate for blocks of size 2^( 2) =       0.000493037762
  error estimate for blocks of size 2^( 3) =       0.000516086889
  error estimate for blocks of size 2^( 4) =       0.000532402720
  error estimate for blocks of size 2^( 5) =       0.000542111817
  error estimate for blocks of size 2^( 6) =       0.000547773171
  error estimate for blocks of size 2^( 7) =       0.000552936003

      target function =      -0.747117488663
              le_mean =     -22.660719194276
             les_mean =     513.955968460386
             stat err =       0.000543805928
             autocorr =       1.346993884610
   target nu stat err =       0.000543805928
   target dn stat err =       0.002603496897
      target stat err =       0.002221612895
              std dev =       0.662637673037
             le_variance =       0.439088685727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439108720304
                                         uncertainty =       0.002009404984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439108720304
                                         uncertainty =       0.002009404984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468555592
  error estimate for blocks of size 2^( 2) =       0.000493037762
  error estimate for blocks of size 2^( 3) =       0.000516086889
  error estimate for blocks of size 2^( 4) =       0.000532402720
  error estimate for blocks of size 2^( 5) =       0.000542111817
  error estimate for blocks of size 2^( 6) =       0.000547773171
  error estimate for blocks of size 2^( 7) =       0.000552936003

      target function =      -0.747117488663
              le_mean =     -22.660719194276
             les_mean =     513.955968460386
             stat err =       0.000543805928
             autocorr =       1.346993884610
   target nu stat err =       0.000543805928
   target dn stat err =       0.002603496897
      target stat err =       0.002221612895
              std dev =       0.662637673037
             le_variance =       0.439088685727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439108720304
                                         uncertainty =       0.002009404984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439108720304
                                         uncertainty =       0.002009404984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468555592
  error estimate for blocks of size 2^( 2) =       0.000493037762
  error estimate for blocks of size 2^( 3) =       0.000516086889
  error estimate for blocks of size 2^( 4) =       0.000532402720
  error estimate for blocks of size 2^( 5) =       0.000542111817
  error estimate for blocks of size 2^( 6) =       0.000547773171
  error estimate for blocks of size 2^( 7) =       0.000552936003

      target function =      -0.747117488663
              le_mean =     -22.660719194276
             les_mean =     513.955968460386
             stat err =       0.000543805928
             autocorr =       1.346993884610
   target nu stat err =       0.000543805928
   target dn stat err =       0.002603496897
      target stat err =       0.002221612895
              std dev =       0.662637673037
             le_variance =       0.439088685727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439108720304
                                         uncertainty =       0.002009404984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439108720304
                                         uncertainty =       0.002009404984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468555592
  error estimate for blocks of size 2^( 2) =       0.000493037762
  error estimate for blocks of size 2^( 3) =       0.000516086889
  error estimate for blocks of size 2^( 4) =       0.000532402720
  error estimate for blocks of size 2^( 5) =       0.000542111817
  error estimate for blocks of size 2^( 6) =       0.000547773171
  error estimate for blocks of size 2^( 7) =       0.000552936003

      target function =      -0.747117488663
              le_mean =     -22.660719194276
             les_mean =     513.955968460386
             stat err =       0.000543805928
             autocorr =       1.346993884610
   target nu stat err =       0.000543805928
   target dn stat err =       0.002603496897
      target stat err =       0.002221612895
              std dev =       0.662637673037
             le_variance =       0.439088685727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747117488663        initial  <--
     2.2737e+25     2.2737e+26             0.0000e+00        -0.747117488663
     9.0949e+25     9.0949e+26             0.0000e+00        -0.747117488663
     3.6380e+26     3.6380e+27             0.0000e+00        -0.747117488663

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6994
  </log>
  <optVariables href="FORM.s083.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6425
    reference variance = 0.311514
====================================================
  Execution time = 2.6296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5266e-01
  Total weights = 1.954789300e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441332356471
                                         uncertainty =       0.003173546511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441332356471
                                         uncertainty =       0.003173546511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469704766
  error estimate for blocks of size 2^( 2) =       0.000493447077
  error estimate for blocks of size 2^( 3) =       0.000515224206
  error estimate for blocks of size 2^( 4) =       0.000530572476
  error estimate for blocks of size 2^( 5) =       0.000539953777
  error estimate for blocks of size 2^( 6) =       0.000544070646
  error estimate for blocks of size 2^( 7) =       0.000544697162

      target function =      -0.743120034602
              le_mean =     -22.662045070435
             les_mean =     514.020947259001
             stat err =       0.000539823515
             autocorr =       1.320850499570
   target nu stat err =       0.000539823515
   target dn stat err =       0.004925293687
      target stat err =       0.004055759911
              std dev =       0.664262849714
             le_variance =       0.441245133510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266204507044e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+26, overlap shift 2.2737e+27 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743141213450       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743141213450       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743141213450       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+26 is 9.470871e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+26, overlap shift 9.0949e+27 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743141213450       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743141213450       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743141213450       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+26 is 2.367718e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+27, overlap shift 3.6380e+28 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743141213450       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743141213450       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743141213450       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+27 is 5.919295e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.441890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1059e+01
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6663
    reference variance = 0.499888
====================================================
  Execution time = 2.5617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5062e-01
  Total weights = 1.9553e+06
  Execution time = 3.6038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441545981267
                                         uncertainty =       0.002428717514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441545981267
                                         uncertainty =       0.002428717514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469855789
  error estimate for blocks of size 2^( 2) =       0.000494211007
  error estimate for blocks of size 2^( 3) =       0.000516589037
  error estimate for blocks of size 2^( 4) =       0.000532406058
  error estimate for blocks of size 2^( 5) =       0.000542779218
  error estimate for blocks of size 2^( 6) =       0.000547542366
  error estimate for blocks of size 2^( 7) =       0.000550803321

      target function =      -0.744790331846
              le_mean =     -22.661535575551
             les_mean =     513.995819119929
             stat err =       0.000543382741
             autocorr =       1.337465275342
   target nu stat err =       0.000543382741
   target dn stat err =       0.002981759911
      target stat err =       0.002510045915
              std dev =       0.664476429745
             le_variance =       0.441528925686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441545981267
                                         uncertainty =       0.002428717514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441545981267
                                         uncertainty =       0.002428717514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469855789
  error estimate for blocks of size 2^( 2) =       0.000494211007
  error estimate for blocks of size 2^( 3) =       0.000516589037
  error estimate for blocks of size 2^( 4) =       0.000532406058
  error estimate for blocks of size 2^( 5) =       0.000542779218
  error estimate for blocks of size 2^( 6) =       0.000547542366
  error estimate for blocks of size 2^( 7) =       0.000550803321

      target function =      -0.744790331846
              le_mean =     -22.661535575551
             les_mean =     513.995819119929
             stat err =       0.000543382741
             autocorr =       1.337465275342
   target nu stat err =       0.000543382741
   target dn stat err =       0.002981759911
      target stat err =       0.002510045915
              std dev =       0.664476429745
             le_variance =       0.441528925686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441545981267
                                         uncertainty =       0.002428717514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441545981267
                                         uncertainty =       0.002428717514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469855789
  error estimate for blocks of size 2^( 2) =       0.000494211007
  error estimate for blocks of size 2^( 3) =       0.000516589037
  error estimate for blocks of size 2^( 4) =       0.000532406058
  error estimate for blocks of size 2^( 5) =       0.000542779218
  error estimate for blocks of size 2^( 6) =       0.000547542366
  error estimate for blocks of size 2^( 7) =       0.000550803321

      target function =      -0.744790331846
              le_mean =     -22.661535575551
             les_mean =     513.995819119929
             stat err =       0.000543382741
             autocorr =       1.337465275342
   target nu stat err =       0.000543382741
   target dn stat err =       0.002981759911
      target stat err =       0.002510045915
              std dev =       0.664476429745
             le_variance =       0.441528925686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441545981267
                                         uncertainty =       0.002428717514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441545981267
                                         uncertainty =       0.002428717514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469855789
  error estimate for blocks of size 2^( 2) =       0.000494211007
  error estimate for blocks of size 2^( 3) =       0.000516589037
  error estimate for blocks of size 2^( 4) =       0.000532406058
  error estimate for blocks of size 2^( 5) =       0.000542779218
  error estimate for blocks of size 2^( 6) =       0.000547542366
  error estimate for blocks of size 2^( 7) =       0.000550803321

      target function =      -0.744790331846
              le_mean =     -22.661535575551
             les_mean =     513.995819119929
             stat err =       0.000543382741
             autocorr =       1.337465275342
   target nu stat err =       0.000543382741
   target dn stat err =       0.002981759911
      target stat err =       0.002510045915
              std dev =       0.664476429745
             le_variance =       0.441528925686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744790331846        initial  <--
     2.2737e+26     2.2737e+27             9.4709e-31        -0.744790331846
     9.0949e+26     9.0949e+27             2.3677e-31        -0.744790331846
     3.6380e+27     3.6380e+28             5.9193e-32        -0.744790331846

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7791
  </log>
  <optVariables href="FORM.s084.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4844e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.6089
    reference variance = 0.399783
====================================================
  Execution time = 2.8172e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4697e-01
  Total weights = 1.955618763e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437601352576
                                         uncertainty =       0.002375616901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437601352576
                                         uncertainty =       0.002375616901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467758841
  error estimate for blocks of size 2^( 2) =       0.000492002649
  error estimate for blocks of size 2^( 3) =       0.000513374677
  error estimate for blocks of size 2^( 4) =       0.000529373835
  error estimate for blocks of size 2^( 5) =       0.000539239863
  error estimate for blocks of size 2^( 6) =       0.000544826758
  error estimate for blocks of size 2^( 7) =       0.000546732968

      target function =      -0.747805028599
              le_mean =     -22.662713136393
             les_mean =     514.045540151528
             stat err =       0.000540043356
             autocorr =       1.332948117057
   target nu stat err =       0.000540043356
   target dn stat err =       0.003075547337
      target stat err =       0.002608694178
              std dev =       0.661510896564
             le_variance =       0.437596666273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266271313639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+27, overlap shift 2.2737e+28 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747813175942       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747813175942       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+27, overlap shift 9.0949e+28 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747813175942       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747813175942       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+28, overlap shift 3.6380e+29 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747813175942       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747813175942       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.443013 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2853e+01
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.6771
    reference variance = 0.601689
====================================================
  Execution time = 2.5507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4903e-01
  Total weights = 1.9548e+06
  Execution time = 3.5959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440851903064
                                         uncertainty =       0.002520248771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440851903064
                                         uncertainty =       0.002520248771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469521202
  error estimate for blocks of size 2^( 2) =       0.000493517606
  error estimate for blocks of size 2^( 3) =       0.000516536313
  error estimate for blocks of size 2^( 4) =       0.000532245003
  error estimate for blocks of size 2^( 5) =       0.000540413716
  error estimate for blocks of size 2^( 6) =       0.000546202804
  error estimate for blocks of size 2^( 7) =       0.000548909719

      target function =      -0.746104749623
              le_mean =     -22.661839187192
             les_mean =     514.007982574716
             stat err =       0.000541942810
             autocorr =       1.332283047572
   target nu stat err =       0.000541942810
   target dn stat err =       0.002593651098
      target stat err =       0.002211135674
              std dev =       0.664003251671
             le_variance =       0.440900318229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440851903064
                                         uncertainty =       0.002520248771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440851903064
                                         uncertainty =       0.002520248771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469521202
  error estimate for blocks of size 2^( 2) =       0.000493517606
  error estimate for blocks of size 2^( 3) =       0.000516536313
  error estimate for blocks of size 2^( 4) =       0.000532245003
  error estimate for blocks of size 2^( 5) =       0.000540413716
  error estimate for blocks of size 2^( 6) =       0.000546202804
  error estimate for blocks of size 2^( 7) =       0.000548909719

      target function =      -0.746104749623
              le_mean =     -22.661839187192
             les_mean =     514.007982574716
             stat err =       0.000541942810
             autocorr =       1.332283047572
   target nu stat err =       0.000541942810
   target dn stat err =       0.002593651098
      target stat err =       0.002211135674
              std dev =       0.664003251671
             le_variance =       0.440900318229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440851903064
                                         uncertainty =       0.002520248771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440851903064
                                         uncertainty =       0.002520248771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469521202
  error estimate for blocks of size 2^( 2) =       0.000493517606
  error estimate for blocks of size 2^( 3) =       0.000516536313
  error estimate for blocks of size 2^( 4) =       0.000532245003
  error estimate for blocks of size 2^( 5) =       0.000540413716
  error estimate for blocks of size 2^( 6) =       0.000546202804
  error estimate for blocks of size 2^( 7) =       0.000548909719

      target function =      -0.746104749623
              le_mean =     -22.661839187192
             les_mean =     514.007982574716
             stat err =       0.000541942810
             autocorr =       1.332283047572
   target nu stat err =       0.000541942810
   target dn stat err =       0.002593651098
      target stat err =       0.002211135674
              std dev =       0.664003251671
             le_variance =       0.440900318229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440851903064
                                         uncertainty =       0.002520248771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440851903064
                                         uncertainty =       0.002520248771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469521202
  error estimate for blocks of size 2^( 2) =       0.000493517606
  error estimate for blocks of size 2^( 3) =       0.000516536313
  error estimate for blocks of size 2^( 4) =       0.000532245003
  error estimate for blocks of size 2^( 5) =       0.000540413716
  error estimate for blocks of size 2^( 6) =       0.000546202804
  error estimate for blocks of size 2^( 7) =       0.000548909719

      target function =      -0.746104749623
              le_mean =     -22.661839187192
             les_mean =     514.007982574716
             stat err =       0.000541942810
             autocorr =       1.332283047572
   target nu stat err =       0.000541942810
   target dn stat err =       0.002593651098
      target stat err =       0.002211135674
              std dev =       0.664003251671
             le_variance =       0.440900318229


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746104749623        initial  <--
     2.2737e+27     2.2737e+28             0.0000e+00        -0.746104749623
     9.0949e+27     9.0949e+28             0.0000e+00        -0.746104749623
     3.6380e+28     3.6380e+29             0.0000e+00        -0.746104749623

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6219
  </log>
  <optVariables href="FORM.s085.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6481e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.6672
    reference variance = 0.51993
====================================================
  Execution time = 2.6512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5402e-01
  Total weights = 1.955218286e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443375084349
                                         uncertainty =       0.002579366299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443375084349
                                         uncertainty =       0.002579366299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470856835
  error estimate for blocks of size 2^( 2) =       0.000494655393
  error estimate for blocks of size 2^( 3) =       0.000517633576
  error estimate for blocks of size 2^( 4) =       0.000532985062
  error estimate for blocks of size 2^( 5) =       0.000542353360
  error estimate for blocks of size 2^( 6) =       0.000546547603
  error estimate for blocks of size 2^( 7) =       0.000550234941

      target function =      -0.742029315583
              le_mean =     -22.662699973376
             les_mean =     514.051992893349
             stat err =       0.000543030242
             autocorr =       1.330057065385
   target nu stat err =       0.000543030242
   target dn stat err =       0.003023997635
      target stat err =       0.002529551730
              std dev =       0.665892121931
             le_variance =       0.443412318050


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266269997338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+28, overlap shift 2.2737e+29 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742037015016       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742037015016       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+28, overlap shift 9.0949e+29 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742037015016       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742037015016       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+29, overlap shift 3.6380e+30 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742037015016       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742037015016       residual = 2.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.444130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1237e+01
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.7062
    reference variance = 0.592207
====================================================
  Execution time = 2.5804e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4995e-01
  Total weights = 1.9550e+06
  Execution time = 3.6019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439837188836
                                         uncertainty =       0.002108560122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439837188836
                                         uncertainty =       0.002108560122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468914361
  error estimate for blocks of size 2^( 2) =       0.000492671828
  error estimate for blocks of size 2^( 3) =       0.000515481775
  error estimate for blocks of size 2^( 4) =       0.000531672502
  error estimate for blocks of size 2^( 5) =       0.000540477934
  error estimate for blocks of size 2^( 6) =       0.000544699003
  error estimate for blocks of size 2^( 7) =       0.000549572661

      target function =      -0.745345970908
              le_mean =     -22.661936584495
             les_mean =     514.013322040592
             stat err =       0.000541605525
             autocorr =       1.334071496871
   target nu stat err =       0.000541605525
   target dn stat err =       0.002836284183
      target stat err =       0.002399062575
              std dev =       0.663145048516
             le_variance =       0.439761355371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439837188836
                                         uncertainty =       0.002108560122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439837188836
                                         uncertainty =       0.002108560122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468914361
  error estimate for blocks of size 2^( 2) =       0.000492671828
  error estimate for blocks of size 2^( 3) =       0.000515481775
  error estimate for blocks of size 2^( 4) =       0.000531672502
  error estimate for blocks of size 2^( 5) =       0.000540477934
  error estimate for blocks of size 2^( 6) =       0.000544699003
  error estimate for blocks of size 2^( 7) =       0.000549572661

      target function =      -0.745345970908
              le_mean =     -22.661936584495
             les_mean =     514.013322040592
             stat err =       0.000541605525
             autocorr =       1.334071496870
   target nu stat err =       0.000541605525
   target dn stat err =       0.002836284183
      target stat err =       0.002399062575
              std dev =       0.663145048516
             le_variance =       0.439761355371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439837188836
                                         uncertainty =       0.002108560122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439837188836
                                         uncertainty =       0.002108560122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468914361
  error estimate for blocks of size 2^( 2) =       0.000492671828
  error estimate for blocks of size 2^( 3) =       0.000515481775
  error estimate for blocks of size 2^( 4) =       0.000531672502
  error estimate for blocks of size 2^( 5) =       0.000540477934
  error estimate for blocks of size 2^( 6) =       0.000544699003
  error estimate for blocks of size 2^( 7) =       0.000549572661

      target function =      -0.745345970908
              le_mean =     -22.661936584495
             les_mean =     514.013322040592
             stat err =       0.000541605525
             autocorr =       1.334071496870
   target nu stat err =       0.000541605525
   target dn stat err =       0.002836284183
      target stat err =       0.002399062575
              std dev =       0.663145048516
             le_variance =       0.439761355371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439837188836
                                         uncertainty =       0.002108560122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439837188836
                                         uncertainty =       0.002108560122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468914361
  error estimate for blocks of size 2^( 2) =       0.000492671828
  error estimate for blocks of size 2^( 3) =       0.000515481775
  error estimate for blocks of size 2^( 4) =       0.000531672502
  error estimate for blocks of size 2^( 5) =       0.000540477934
  error estimate for blocks of size 2^( 6) =       0.000544699003
  error estimate for blocks of size 2^( 7) =       0.000549572661

      target function =      -0.745345970908
              le_mean =     -22.661936584495
             les_mean =     514.013322040592
             stat err =       0.000541605525
             autocorr =       1.334071496870
   target nu stat err =       0.000541605525
   target dn stat err =       0.002836284183
      target stat err =       0.002399062575
              std dev =       0.663145048516
             le_variance =       0.439761355371


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745345970908        initial  <--
     2.2737e+28     2.2737e+29             0.0000e+00        -0.745345970908
     9.0949e+28     9.0949e+29             0.0000e+00        -0.745345970908
     3.6380e+29     3.6380e+30             0.0000e+00        -0.745345970908

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9177
  </log>
  <optVariables href="FORM.s086.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.6694
    reference variance = 0.190496
====================================================
  Execution time = 2.8685e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5454e-01
  Total weights = 1.955273633e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442631003492
                                         uncertainty =       0.002459377715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442631003492
                                         uncertainty =       0.002459377715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470433238
  error estimate for blocks of size 2^( 2) =       0.000494534713
  error estimate for blocks of size 2^( 3) =       0.000516317612
  error estimate for blocks of size 2^( 4) =       0.000532041770
  error estimate for blocks of size 2^( 5) =       0.000541368751
  error estimate for blocks of size 2^( 6) =       0.000545280355
  error estimate for blocks of size 2^( 7) =       0.000550268057

      target function =      -0.741605346572
              le_mean =     -22.662162556784
             les_mean =     514.028151271697
             stat err =       0.000542239733
             autocorr =       1.328576843816
   target nu stat err =       0.000542239733
   target dn stat err =       0.003248980252
      target stat err =       0.002702329102
              std dev =       0.665293064716
             le_variance =       0.442614861959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266216255678e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+29, overlap shift 2.2737e+30 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741614264287       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741614264287       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+29, overlap shift 9.0949e+30 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741614264287       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741614264287       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+30, overlap shift 3.6380e+31 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741614264287       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741614264287       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.445254 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3420e+01
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.682
    reference variance = 0.456875
====================================================
  Execution time = 2.5899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5531e-01
  Total weights = 1.9555e+06
  Execution time = 3.5984e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442434977568
                                         uncertainty =       0.003535956053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442434977568
                                         uncertainty =       0.003535956053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470739903
  error estimate for blocks of size 2^( 2) =       0.000494628053
  error estimate for blocks of size 2^( 3) =       0.000517025202
  error estimate for blocks of size 2^( 4) =       0.000533365694
  error estimate for blocks of size 2^( 5) =       0.000542333878
  error estimate for blocks of size 2^( 6) =       0.000546416118
  error estimate for blocks of size 2^( 7) =       0.000549353604

      target function =      -0.740955580434
              le_mean =     -22.661163323995
             les_mean =     513.983630675100
             stat err =       0.000542867323
             autocorr =       1.329919566507
   target nu stat err =       0.000542867323
   target dn stat err =       0.005855124453
      target stat err =       0.004772921056
              std dev =       0.665726754825
             le_variance =       0.443192112090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442434977568
                                         uncertainty =       0.003535956053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442434977568
                                         uncertainty =       0.003535956053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470739903
  error estimate for blocks of size 2^( 2) =       0.000494628053
  error estimate for blocks of size 2^( 3) =       0.000517025202
  error estimate for blocks of size 2^( 4) =       0.000533365694
  error estimate for blocks of size 2^( 5) =       0.000542333878
  error estimate for blocks of size 2^( 6) =       0.000546416118
  error estimate for blocks of size 2^( 7) =       0.000549353604

      target function =      -0.740955580434
              le_mean =     -22.661163323995
             les_mean =     513.983630675100
             stat err =       0.000542867323
             autocorr =       1.329919566509
   target nu stat err =       0.000542867323
   target dn stat err =       0.005855124453
      target stat err =       0.004772921056
              std dev =       0.665726754825
             le_variance =       0.443192112090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442434977568
                                         uncertainty =       0.003535956053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442434977568
                                         uncertainty =       0.003535956053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470739903
  error estimate for blocks of size 2^( 2) =       0.000494628053
  error estimate for blocks of size 2^( 3) =       0.000517025202
  error estimate for blocks of size 2^( 4) =       0.000533365694
  error estimate for blocks of size 2^( 5) =       0.000542333878
  error estimate for blocks of size 2^( 6) =       0.000546416118
  error estimate for blocks of size 2^( 7) =       0.000549353604

      target function =      -0.740955580434
              le_mean =     -22.661163323995
             les_mean =     513.983630675100
             stat err =       0.000542867323
             autocorr =       1.329919566509
   target nu stat err =       0.000542867323
   target dn stat err =       0.005855124453
      target stat err =       0.004772921056
              std dev =       0.665726754825
             le_variance =       0.443192112090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442434977568
                                         uncertainty =       0.003535956053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442434977568
                                         uncertainty =       0.003535956053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470739903
  error estimate for blocks of size 2^( 2) =       0.000494628053
  error estimate for blocks of size 2^( 3) =       0.000517025202
  error estimate for blocks of size 2^( 4) =       0.000533365694
  error estimate for blocks of size 2^( 5) =       0.000542333878
  error estimate for blocks of size 2^( 6) =       0.000546416118
  error estimate for blocks of size 2^( 7) =       0.000549353604

      target function =      -0.740955580434
              le_mean =     -22.661163323995
             les_mean =     513.983630675100
             stat err =       0.000542867323
             autocorr =       1.329919566509
   target nu stat err =       0.000542867323
   target dn stat err =       0.005855124453
      target stat err =       0.004772921056
              std dev =       0.665726754825
             le_variance =       0.443192112090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740955580434        initial  <--
     2.2737e+29     2.2737e+30             0.0000e+00        -0.740955580434
     9.0949e+29     9.0949e+30             0.0000e+00        -0.740955580434
     3.6380e+30     3.6380e+31             0.0000e+00        -0.740955580434

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0035
  </log>
  <optVariables href="FORM.s087.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.6021
    reference variance = 0.425796
====================================================
  Execution time = 2.6282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4893e-01
  Total weights = 1.955181805e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439701967247
                                         uncertainty =       0.002860441000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439701967247
                                         uncertainty =       0.002860441000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468872851
  error estimate for blocks of size 2^( 2) =       0.000492477418
  error estimate for blocks of size 2^( 3) =       0.000515053711
  error estimate for blocks of size 2^( 4) =       0.000530441894
  error estimate for blocks of size 2^( 5) =       0.000540708066
  error estimate for blocks of size 2^( 6) =       0.000545605017
  error estimate for blocks of size 2^( 7) =       0.000546346313

      target function =      -0.746179981469
              le_mean =     -22.662225523644
             les_mean =     514.025400086003
             stat err =       0.000540775322
             autocorr =       1.330220256993
   target nu stat err =       0.000540775322
   target dn stat err =       0.003662248208
      target stat err =       0.003067153105
              std dev =       0.663086344389
             le_variance =       0.439683500115


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266222552364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+30, overlap shift 2.2737e+31 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746191472112       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746191472112       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746191472113       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+30 is 6.248806e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+30, overlap shift 9.0949e+31 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746191472112       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746191472112       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746191472281       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+30 is 1.562201e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+31, overlap shift 3.6380e+32 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746191472112       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746191472112       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746191471815       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+31 is 3.905503e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.446634 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0957e+01
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.692
    reference variance = 0.427438
====================================================
  Execution time = 2.5508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5150e-01
  Total weights = 1.9554e+06
  Execution time = 3.6076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482670612
                                         uncertainty =       0.002656173206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482670612
                                         uncertainty =       0.002656173206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469787458
  error estimate for blocks of size 2^( 2) =       0.000493712972
  error estimate for blocks of size 2^( 3) =       0.000516086033
  error estimate for blocks of size 2^( 4) =       0.000531796083
  error estimate for blocks of size 2^( 5) =       0.000540748090
  error estimate for blocks of size 2^( 6) =       0.000545373992
  error estimate for blocks of size 2^( 7) =       0.000550106687

      target function =      -0.744080465822
              le_mean =     -22.662559054623
             les_mean =     514.043086126190
             stat err =       0.000542006213
             autocorr =       1.331084705338
   target nu stat err =       0.000542006213
   target dn stat err =       0.003347699893
      target stat err =       0.002800290005
              std dev =       0.664379794681
             le_variance =       0.441400511580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482670612
                                         uncertainty =       0.002656173206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482670612
                                         uncertainty =       0.002656173206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469787458
  error estimate for blocks of size 2^( 2) =       0.000493712972
  error estimate for blocks of size 2^( 3) =       0.000516086033
  error estimate for blocks of size 2^( 4) =       0.000531796083
  error estimate for blocks of size 2^( 5) =       0.000540748090
  error estimate for blocks of size 2^( 6) =       0.000545373992
  error estimate for blocks of size 2^( 7) =       0.000550106687

      target function =      -0.744080465822
              le_mean =     -22.662559054623
             les_mean =     514.043086126190
             stat err =       0.000542006213
             autocorr =       1.331084705344
   target nu stat err =       0.000542006213
   target dn stat err =       0.003347699893
      target stat err =       0.002800290005
              std dev =       0.664379794681
             le_variance =       0.441400511580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482670612
                                         uncertainty =       0.002656173206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482670612
                                         uncertainty =       0.002656173206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469787458
  error estimate for blocks of size 2^( 2) =       0.000493712972
  error estimate for blocks of size 2^( 3) =       0.000516086033
  error estimate for blocks of size 2^( 4) =       0.000531796083
  error estimate for blocks of size 2^( 5) =       0.000540748090
  error estimate for blocks of size 2^( 6) =       0.000545373992
  error estimate for blocks of size 2^( 7) =       0.000550106687

      target function =      -0.744080465822
              le_mean =     -22.662559054623
             les_mean =     514.043086126190
             stat err =       0.000542006213
             autocorr =       1.331084705344
   target nu stat err =       0.000542006213
   target dn stat err =       0.003347699893
      target stat err =       0.002800290005
              std dev =       0.664379794681
             le_variance =       0.441400511580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482670612
                                         uncertainty =       0.002656173206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441482670612
                                         uncertainty =       0.002656173206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469787458
  error estimate for blocks of size 2^( 2) =       0.000493712972
  error estimate for blocks of size 2^( 3) =       0.000516086033
  error estimate for blocks of size 2^( 4) =       0.000531796083
  error estimate for blocks of size 2^( 5) =       0.000540748090
  error estimate for blocks of size 2^( 6) =       0.000545373992
  error estimate for blocks of size 2^( 7) =       0.000550106687

      target function =      -0.744080465822
              le_mean =     -22.662559054623
             les_mean =     514.043086126190
             stat err =       0.000542006213
             autocorr =       1.331084705344
   target nu stat err =       0.000542006213
   target dn stat err =       0.003347699893
      target stat err =       0.002800290005
              std dev =       0.664379794681
             le_variance =       0.441400511580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744080465822        initial  <--
     2.2737e+30     2.2737e+31             6.2488e-35        -0.744080465822
     9.0949e+30     9.0949e+31             1.5622e-35        -0.744080465822
     3.6380e+31     3.6380e+32             3.9055e-36        -0.744080465822

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6825
  </log>
  <optVariables href="FORM.s088.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4646e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7072
    reference variance = 0.327689
====================================================
  Execution time = 2.8435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5209e-01
  Total weights = 1.954970082e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443414924589
                                         uncertainty =       0.002421187296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443414924589
                                         uncertainty =       0.002421187296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470868650
  error estimate for blocks of size 2^( 2) =       0.000494859314
  error estimate for blocks of size 2^( 3) =       0.000516984014
  error estimate for blocks of size 2^( 4) =       0.000532817694
  error estimate for blocks of size 2^( 5) =       0.000542852697
  error estimate for blocks of size 2^( 6) =       0.000544512106
  error estimate for blocks of size 2^( 7) =       0.000550576646

      target function =      -0.743608369095
              le_mean =     -22.662958489136
             les_mean =     514.061775503911
             stat err =       0.000542689786
             autocorr =       1.328323148796
   target nu stat err =       0.000542689786
   target dn stat err =       0.002891770804
      target stat err =       0.002436054043
              std dev =       0.665908831592
             le_variance =       0.443434571992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266295848914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+31, overlap shift 2.2737e+32 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743615395081       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743615395081       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743615395081       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+31 is 6.567613e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+31, overlap shift 9.0949e+32 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743615395081       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743615395081       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -6.651115327957       residual = 7.96e+16           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743615395389       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+31 is 1.641903e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+32, overlap shift 3.6380e+33 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743615395081       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743615395081       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+32 is 4.104758e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.448015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3211e+01
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.6065
    reference variance = 0.332698
====================================================
  Execution time = 2.5456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5188e-01
  Total weights = 1.9552e+06
  Execution time = 3.6568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959180996
                                         uncertainty =       0.002378487732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959180996
                                         uncertainty =       0.002378487732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468456598
  error estimate for blocks of size 2^( 2) =       0.000492963266
  error estimate for blocks of size 2^( 3) =       0.000515743521
  error estimate for blocks of size 2^( 4) =       0.000531984057
  error estimate for blocks of size 2^( 5) =       0.000542166393
  error estimate for blocks of size 2^( 6) =       0.000546955313
  error estimate for blocks of size 2^( 7) =       0.000550800501

      target function =      -0.743759640052
              le_mean =     -22.661554288640
             les_mean =     513.997922718147
             stat err =       0.000542976566
             autocorr =       1.343456019363
   target nu stat err =       0.000542976566
   target dn stat err =       0.003920202166
      target stat err =       0.003251673855
              std dev =       0.662497673797
             le_variance =       0.438903167786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959180996
                                         uncertainty =       0.002378487732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959180996
                                         uncertainty =       0.002378487732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468456598
  error estimate for blocks of size 2^( 2) =       0.000492963266
  error estimate for blocks of size 2^( 3) =       0.000515743521
  error estimate for blocks of size 2^( 4) =       0.000531984057
  error estimate for blocks of size 2^( 5) =       0.000542166393
  error estimate for blocks of size 2^( 6) =       0.000546955313
  error estimate for blocks of size 2^( 7) =       0.000550800501

      target function =      -0.743759640052
              le_mean =     -22.661554288640
             les_mean =     513.997922718147
             stat err =       0.000542976566
             autocorr =       1.343456019362
   target nu stat err =       0.000542976566
   target dn stat err =       0.003920202166
      target stat err =       0.003251673855
              std dev =       0.662497673797
             le_variance =       0.438903167786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959180996
                                         uncertainty =       0.002378487732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959180996
                                         uncertainty =       0.002378487732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468456598
  error estimate for blocks of size 2^( 2) =       0.000492963266
  error estimate for blocks of size 2^( 3) =       0.000515743521
  error estimate for blocks of size 2^( 4) =       0.000531984057
  error estimate for blocks of size 2^( 5) =       0.000542166393
  error estimate for blocks of size 2^( 6) =       0.000546955313
  error estimate for blocks of size 2^( 7) =       0.000550800501

      target function =      -0.743759640052
              le_mean =     -22.661554288640
             les_mean =     513.997922718147
             stat err =       0.000542976566
             autocorr =       1.343456019362
   target nu stat err =       0.000542976566
   target dn stat err =       0.003920202166
      target stat err =       0.003251673855
              std dev =       0.662497673797
             le_variance =       0.438903167786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959180996
                                         uncertainty =       0.002378487732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438959180996
                                         uncertainty =       0.002378487732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468456598
  error estimate for blocks of size 2^( 2) =       0.000492963266
  error estimate for blocks of size 2^( 3) =       0.000515743521
  error estimate for blocks of size 2^( 4) =       0.000531984057
  error estimate for blocks of size 2^( 5) =       0.000542166393
  error estimate for blocks of size 2^( 6) =       0.000546955313
  error estimate for blocks of size 2^( 7) =       0.000550800501

      target function =      -0.743759640052
              le_mean =     -22.661554288640
             les_mean =     513.997922718147
             stat err =       0.000542976566
             autocorr =       1.343456019362
   target nu stat err =       0.000542976566
   target dn stat err =       0.003920202166
      target stat err =       0.003251673855
              std dev =       0.662497673797
             le_variance =       0.438903167786


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743759640052        initial  <--
     2.2737e+31     2.2737e+32             6.5676e-36        -0.743759640052
     9.0949e+31     9.0949e+32             1.6419e-36        -0.743759640052
     3.6380e+32     3.6380e+33             4.1048e-37        -0.743759640052

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8261
  </log>
  <optVariables href="FORM.s089.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7043e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.7013
    reference variance = 0.545182
====================================================
  Execution time = 2.6335e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4667e-01
  Total weights = 1.955306265e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437834816746
                                         uncertainty =       0.002325346280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437834816746
                                         uncertainty =       0.002325346280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467864200
  error estimate for blocks of size 2^( 2) =       0.000491982367
  error estimate for blocks of size 2^( 3) =       0.000514603338
  error estimate for blocks of size 2^( 4) =       0.000530967538
  error estimate for blocks of size 2^( 5) =       0.000541355303
  error estimate for blocks of size 2^( 6) =       0.000547906821
  error estimate for blocks of size 2^( 7) =       0.000549816499

      target function =      -0.748044241498
              le_mean =     -22.661893633370
             les_mean =     514.008095380458
             stat err =       0.000542511540
             autocorr =       1.344554257757
   target nu stat err =       0.000542511540
   target dn stat err =       0.002477602890
      target stat err =       0.002130496463
              std dev =       0.661659896398
             le_variance =       0.437793818501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266189363337e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+32, overlap shift 2.2737e+33 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748049405907       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748049405907       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+32, overlap shift 9.0949e+33 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748049405907       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748049405907       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+33, overlap shift 3.6380e+34 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748049405907       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748049405907       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.449113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1155e+01
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.7226
    reference variance = 0.40476
====================================================
  Execution time = 2.6023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5091e-01
  Total weights = 1.9554e+06
  Execution time = 3.6439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438745839983
                                         uncertainty =       0.002076648441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438745839983
                                         uncertainty =       0.002076648441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468335571
  error estimate for blocks of size 2^( 2) =       0.000492517914
  error estimate for blocks of size 2^( 3) =       0.000515291815
  error estimate for blocks of size 2^( 4) =       0.000530152646
  error estimate for blocks of size 2^( 5) =       0.000540161325
  error estimate for blocks of size 2^( 6) =       0.000543667974
  error estimate for blocks of size 2^( 7) =       0.000543305994

      target function =      -0.744548207349
              le_mean =     -22.661655072889
             les_mean =     514.001522518383
             stat err =       0.000539321985
             autocorr =       1.326117358936
   target nu stat err =       0.000539321985
   target dn stat err =       0.004293749350
      target stat err =       0.003558872935
              std dev =       0.662326515623
             le_variance =       0.438676413298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438745839983
                                         uncertainty =       0.002076648441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438745839983
                                         uncertainty =       0.002076648441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468335571
  error estimate for blocks of size 2^( 2) =       0.000492517914
  error estimate for blocks of size 2^( 3) =       0.000515291815
  error estimate for blocks of size 2^( 4) =       0.000530152646
  error estimate for blocks of size 2^( 5) =       0.000540161325
  error estimate for blocks of size 2^( 6) =       0.000543667974
  error estimate for blocks of size 2^( 7) =       0.000543305994

      target function =      -0.744548207349
              le_mean =     -22.661655072889
             les_mean =     514.001522518383
             stat err =       0.000539321985
             autocorr =       1.326117358936
   target nu stat err =       0.000539321985
   target dn stat err =       0.004293749350
      target stat err =       0.003558872935
              std dev =       0.662326515623
             le_variance =       0.438676413298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438745839983
                                         uncertainty =       0.002076648441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438745839983
                                         uncertainty =       0.002076648441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468335571
  error estimate for blocks of size 2^( 2) =       0.000492517914
  error estimate for blocks of size 2^( 3) =       0.000515291815
  error estimate for blocks of size 2^( 4) =       0.000530152646
  error estimate for blocks of size 2^( 5) =       0.000540161325
  error estimate for blocks of size 2^( 6) =       0.000543667974
  error estimate for blocks of size 2^( 7) =       0.000543305994

      target function =      -0.744548207349
              le_mean =     -22.661655072889
             les_mean =     514.001522518383
             stat err =       0.000539321985
             autocorr =       1.326117358936
   target nu stat err =       0.000539321985
   target dn stat err =       0.004293749350
      target stat err =       0.003558872935
              std dev =       0.662326515623
             le_variance =       0.438676413298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438745839983
                                         uncertainty =       0.002076648441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438745839983
                                         uncertainty =       0.002076648441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468335571
  error estimate for blocks of size 2^( 2) =       0.000492517914
  error estimate for blocks of size 2^( 3) =       0.000515291815
  error estimate for blocks of size 2^( 4) =       0.000530152646
  error estimate for blocks of size 2^( 5) =       0.000540161325
  error estimate for blocks of size 2^( 6) =       0.000543667974
  error estimate for blocks of size 2^( 7) =       0.000543305994

      target function =      -0.744548207349
              le_mean =     -22.661655072889
             les_mean =     514.001522518383
             stat err =       0.000539321985
             autocorr =       1.326117358936
   target nu stat err =       0.000539321985
   target dn stat err =       0.004293749350
      target stat err =       0.003558872935
              std dev =       0.662326515623
             le_variance =       0.438676413298


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744548207349        initial  <--
     2.2737e+32     2.2737e+33             0.0000e+00        -0.744548207349
     9.0949e+32     9.0949e+33             0.0000e+00        -0.744548207349
     3.6380e+33     3.6380e+34             0.0000e+00        -0.744548207349

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3468
  </log>
  <optVariables href="FORM.s090.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.6818
    reference variance = 0.389288
====================================================
  Execution time = 2.8260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4469e-01
  Total weights = 1.955441096e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436603605879
                                         uncertainty =       0.001975811916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436603605879
                                         uncertainty =       0.001975811916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467190210
  error estimate for blocks of size 2^( 2) =       0.000491366888
  error estimate for blocks of size 2^( 3) =       0.000513539256
  error estimate for blocks of size 2^( 4) =       0.000529749031
  error estimate for blocks of size 2^( 5) =       0.000539603216
  error estimate for blocks of size 2^( 6) =       0.000544274216
  error estimate for blocks of size 2^( 7) =       0.000546025245

      target function =      -0.749671324156
              le_mean =     -22.661055214534
             les_mean =     513.968109257590
             stat err =       0.000539912927
             autocorr =       1.335549484120
   target nu stat err =       0.000539912927
   target dn stat err =       0.002462924192
      target stat err =       0.002124297477
              std dev =       0.660706731603
             le_variance =       0.436533385185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266105521453e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+33, overlap shift 2.2737e+34 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749676429743       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749676429743       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749676429743       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749676429743       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749676465988       residual = 4.94e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.000000000000       residual = 5.32e+16           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+33 is 7.162421e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+33, overlap shift 9.0949e+34 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749676429743       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749676429743       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749676429743       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749676436186       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749511718750       residual = 3.19e+06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+33 is 1.628962e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+34, overlap shift 3.6380e+35 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749676429743       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749676429743       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749676436186       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+34 is 2.697169e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.451018 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3021e+01
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.6848
    reference variance = 0.339184
====================================================
  Execution time = 2.5622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4659e-01
  Total weights = 1.9551e+06
  Execution time = 3.6539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437772137676
                                         uncertainty =       0.002031315000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437772137676
                                         uncertainty =       0.002031315000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467825130
  error estimate for blocks of size 2^( 2) =       0.000491905453
  error estimate for blocks of size 2^( 3) =       0.000514082085
  error estimate for blocks of size 2^( 4) =       0.000529821524
  error estimate for blocks of size 2^( 5) =       0.000537900163
  error estimate for blocks of size 2^( 6) =       0.000541756413
  error estimate for blocks of size 2^( 7) =       0.000543704851

      target function =      -0.748109259856
              le_mean =     -22.661499329394
             les_mean =     513.990137824696
             stat err =       0.000538295738
             autocorr =       1.323959770335
   target nu stat err =       0.000538295738
   target dn stat err =       0.002450594996
      target stat err =       0.002106925517
              std dev =       0.661604643532
             le_variance =       0.437720704343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437772137676
                                         uncertainty =       0.002031315000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437772137676
                                         uncertainty =       0.002031315000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467825130
  error estimate for blocks of size 2^( 2) =       0.000491905453
  error estimate for blocks of size 2^( 3) =       0.000514082085
  error estimate for blocks of size 2^( 4) =       0.000529821524
  error estimate for blocks of size 2^( 5) =       0.000537900163
  error estimate for blocks of size 2^( 6) =       0.000541756413
  error estimate for blocks of size 2^( 7) =       0.000543704851

      target function =      -0.748109259856
              le_mean =     -22.661499329394
             les_mean =     513.990137824696
             stat err =       0.000538295738
             autocorr =       1.323959770334
   target nu stat err =       0.000538295738
   target dn stat err =       0.002450594996
      target stat err =       0.002106925517
              std dev =       0.661604643532
             le_variance =       0.437720704343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437772137676
                                         uncertainty =       0.002031315000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437772137676
                                         uncertainty =       0.002031315000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467825130
  error estimate for blocks of size 2^( 2) =       0.000491905453
  error estimate for blocks of size 2^( 3) =       0.000514082085
  error estimate for blocks of size 2^( 4) =       0.000529821524
  error estimate for blocks of size 2^( 5) =       0.000537900163
  error estimate for blocks of size 2^( 6) =       0.000541756413
  error estimate for blocks of size 2^( 7) =       0.000543704851

      target function =      -0.748109259856
              le_mean =     -22.661499329394
             les_mean =     513.990137824696
             stat err =       0.000538295738
             autocorr =       1.323959770334
   target nu stat err =       0.000538295738
   target dn stat err =       0.002450594996
      target stat err =       0.002106925517
              std dev =       0.661604643532
             le_variance =       0.437720704343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437772137676
                                         uncertainty =       0.002031315000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437772137676
                                         uncertainty =       0.002031315000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467825130
  error estimate for blocks of size 2^( 2) =       0.000491905453
  error estimate for blocks of size 2^( 3) =       0.000514082085
  error estimate for blocks of size 2^( 4) =       0.000529821524
  error estimate for blocks of size 2^( 5) =       0.000537900163
  error estimate for blocks of size 2^( 6) =       0.000541756413
  error estimate for blocks of size 2^( 7) =       0.000543704851

      target function =      -0.748109259856
              le_mean =     -22.661499329394
             les_mean =     513.990137824696
             stat err =       0.000538295738
             autocorr =       1.323959770334
   target nu stat err =       0.000538295738
   target dn stat err =       0.002450594996
      target stat err =       0.002106925517
              std dev =       0.661604643532
             le_variance =       0.437720704343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748109259856        initial  <--
     2.2737e+33     2.2737e+34             7.1624e-38        -0.748109259856
     9.0949e+33     9.0949e+34             1.6290e-38        -0.748109259856
     3.6380e+34     3.6380e+35             2.6972e-39        -0.748109259856

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0123
  </log>
  <optVariables href="FORM.s091.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7045e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.617
    reference variance = 0.323137
====================================================
  Execution time = 2.6131e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5244e-01
  Total weights = 1.954988644e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442641158879
                                         uncertainty =       0.002790222587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442641158879
                                         uncertainty =       0.002790222587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470423454
  error estimate for blocks of size 2^( 2) =       0.000494399857
  error estimate for blocks of size 2^( 3) =       0.000516758295
  error estimate for blocks of size 2^( 4) =       0.000532549227
  error estimate for blocks of size 2^( 5) =       0.000542900887
  error estimate for blocks of size 2^( 6) =       0.000548465481
  error estimate for blocks of size 2^( 7) =       0.000551731972

      target function =      -0.743304877195
              le_mean =     -22.661851296548
             les_mean =     514.011947761053
             stat err =       0.000543911892
             autocorr =       1.336839209034
   target nu stat err =       0.000543911892
   target dn stat err =       0.003630829021
      target stat err =       0.003017898578
              std dev =       0.665279229352
             le_variance =       0.442596453007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266185129655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+34, overlap shift 2.2737e+35 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743316281630       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743316281630       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+34, overlap shift 9.0949e+35 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743316281630       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743316281630       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+35, overlap shift 3.6380e+36 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743316281630       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743316281630       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.452130 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0897e+01
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6504
    reference variance = 0.351678
====================================================
  Execution time = 2.5797e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5073e-01
  Total weights = 1.9553e+06
  Execution time = 3.6633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440884760270
                                         uncertainty =       0.002067698526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440884760270
                                         uncertainty =       0.002067698526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469491367
  error estimate for blocks of size 2^( 2) =       0.000493384607
  error estimate for blocks of size 2^( 3) =       0.000515781489
  error estimate for blocks of size 2^( 4) =       0.000531182716
  error estimate for blocks of size 2^( 5) =       0.000539850617
  error estimate for blocks of size 2^( 6) =       0.000545268393
  error estimate for blocks of size 2^( 7) =       0.000548342357

      target function =      -0.744709841408
              le_mean =     -22.661734829077
             les_mean =     514.004952921484
             stat err =       0.000541161021
             autocorr =       1.328610844629
   target nu stat err =       0.000541161021
   target dn stat err =       0.002713390927
      target stat err =       0.002297044274
              std dev =       0.663961058476
             le_variance =       0.440844287172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440884760270
                                         uncertainty =       0.002067698526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440884760270
                                         uncertainty =       0.002067698526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469491367
  error estimate for blocks of size 2^( 2) =       0.000493384607
  error estimate for blocks of size 2^( 3) =       0.000515781489
  error estimate for blocks of size 2^( 4) =       0.000531182716
  error estimate for blocks of size 2^( 5) =       0.000539850617
  error estimate for blocks of size 2^( 6) =       0.000545268393
  error estimate for blocks of size 2^( 7) =       0.000548342357

      target function =      -0.744709841408
              le_mean =     -22.661734829077
             les_mean =     514.004952921484
             stat err =       0.000541161021
             autocorr =       1.328610844629
   target nu stat err =       0.000541161021
   target dn stat err =       0.002713390927
      target stat err =       0.002297044274
              std dev =       0.663961058476
             le_variance =       0.440844287172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440884760270
                                         uncertainty =       0.002067698526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440884760270
                                         uncertainty =       0.002067698526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469491367
  error estimate for blocks of size 2^( 2) =       0.000493384607
  error estimate for blocks of size 2^( 3) =       0.000515781489
  error estimate for blocks of size 2^( 4) =       0.000531182716
  error estimate for blocks of size 2^( 5) =       0.000539850617
  error estimate for blocks of size 2^( 6) =       0.000545268393
  error estimate for blocks of size 2^( 7) =       0.000548342357

      target function =      -0.744709841408
              le_mean =     -22.661734829077
             les_mean =     514.004952921484
             stat err =       0.000541161021
             autocorr =       1.328610844629
   target nu stat err =       0.000541161021
   target dn stat err =       0.002713390927
      target stat err =       0.002297044274
              std dev =       0.663961058476
             le_variance =       0.440844287172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440884760270
                                         uncertainty =       0.002067698526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440884760270
                                         uncertainty =       0.002067698526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469491367
  error estimate for blocks of size 2^( 2) =       0.000493384607
  error estimate for blocks of size 2^( 3) =       0.000515781489
  error estimate for blocks of size 2^( 4) =       0.000531182716
  error estimate for blocks of size 2^( 5) =       0.000539850617
  error estimate for blocks of size 2^( 6) =       0.000545268393
  error estimate for blocks of size 2^( 7) =       0.000548342357

      target function =      -0.744709841408
              le_mean =     -22.661734829077
             les_mean =     514.004952921484
             stat err =       0.000541161021
             autocorr =       1.328610844629
   target nu stat err =       0.000541161021
   target dn stat err =       0.002713390927
      target stat err =       0.002297044274
              std dev =       0.663961058476
             le_variance =       0.440844287172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744709841408        initial  <--
     2.2737e+34     2.2737e+35             0.0000e+00        -0.744709841408
     9.0949e+34     9.0949e+35             0.0000e+00        -0.744709841408
     3.6380e+35     3.6380e+36             0.0000e+00        -0.744709841408

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2154
  </log>
  <optVariables href="FORM.s092.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5119e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.7137
    reference variance = 0.387149
====================================================
  Execution time = 2.8087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6354e-01
  Total weights = 1.955032017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447879590106
                                         uncertainty =       0.003099336757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447879590106
                                         uncertainty =       0.003099336757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473253431
  error estimate for blocks of size 2^( 2) =       0.000496946304
  error estimate for blocks of size 2^( 3) =       0.000519489093
  error estimate for blocks of size 2^( 4) =       0.000533840551
  error estimate for blocks of size 2^( 5) =       0.000543856592
  error estimate for blocks of size 2^( 6) =       0.000547927770
  error estimate for blocks of size 2^( 7) =       0.000548117247

      target function =      -0.734355729808
              le_mean =     -22.662291644134
             les_mean =     514.043002633028
             stat err =       0.000543435540
             autocorr =       1.318586219942
   target nu stat err =       0.000543435540
   target dn stat err =       0.005478091509
      target stat err =       0.004399253664
              std dev =       0.669281420219
             le_variance =       0.447937619450


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266229164413e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+35, overlap shift 2.2737e+36 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734381238342       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734381238342       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734381238342       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734381243587       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+35 is 1.093757e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+35, overlap shift 9.0949e+36 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734381238342       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734381238342       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734381238342       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+35 is 2.734391e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+36, overlap shift 3.6380e+37 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734381238342       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734381238342       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734381238342       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734381258488       residual = 5.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+36 is 6.835979e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.453680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2894e+01
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.695
    reference variance = 0.303922
====================================================
  Execution time = 2.5579e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5334e-01
  Total weights = 1.9550e+06
  Execution time = 3.7097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443137179582
                                         uncertainty =       0.002265638124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443137179582
                                         uncertainty =       0.002265638124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470844010
  error estimate for blocks of size 2^( 2) =       0.000494430944
  error estimate for blocks of size 2^( 3) =       0.000516967861
  error estimate for blocks of size 2^( 4) =       0.000532945093
  error estimate for blocks of size 2^( 5) =       0.000542749219
  error estimate for blocks of size 2^( 6) =       0.000549133715
  error estimate for blocks of size 2^( 7) =       0.000550020775

      target function =      -0.742575768547
              le_mean =     -22.661563863392
             les_mean =     513.999816444581
             stat err =       0.000543712200
             autocorr =       1.333472477396
   target nu stat err =       0.000543712200
   target dn stat err =       0.003213780445
      target stat err =       0.002679292542
              std dev =       0.665873985222
             le_variance =       0.443388164195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443137179582
                                         uncertainty =       0.002265638124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443137179582
                                         uncertainty =       0.002265638124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470844010
  error estimate for blocks of size 2^( 2) =       0.000494430944
  error estimate for blocks of size 2^( 3) =       0.000516967861
  error estimate for blocks of size 2^( 4) =       0.000532945093
  error estimate for blocks of size 2^( 5) =       0.000542749219
  error estimate for blocks of size 2^( 6) =       0.000549133715
  error estimate for blocks of size 2^( 7) =       0.000550020775

      target function =      -0.742575768547
              le_mean =     -22.661563863392
             les_mean =     513.999816444581
             stat err =       0.000543712200
             autocorr =       1.333472477396
   target nu stat err =       0.000543712200
   target dn stat err =       0.003213780445
      target stat err =       0.002679292542
              std dev =       0.665873985222
             le_variance =       0.443388164195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443137179582
                                         uncertainty =       0.002265638124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443137179582
                                         uncertainty =       0.002265638124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470844010
  error estimate for blocks of size 2^( 2) =       0.000494430944
  error estimate for blocks of size 2^( 3) =       0.000516967861
  error estimate for blocks of size 2^( 4) =       0.000532945093
  error estimate for blocks of size 2^( 5) =       0.000542749219
  error estimate for blocks of size 2^( 6) =       0.000549133715
  error estimate for blocks of size 2^( 7) =       0.000550020775

      target function =      -0.742575768547
              le_mean =     -22.661563863392
             les_mean =     513.999816444581
             stat err =       0.000543712200
             autocorr =       1.333472477396
   target nu stat err =       0.000543712200
   target dn stat err =       0.003213780445
      target stat err =       0.002679292542
              std dev =       0.665873985222
             le_variance =       0.443388164195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443137179582
                                         uncertainty =       0.002265638124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443137179582
                                         uncertainty =       0.002265638124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470844010
  error estimate for blocks of size 2^( 2) =       0.000494430944
  error estimate for blocks of size 2^( 3) =       0.000516967861
  error estimate for blocks of size 2^( 4) =       0.000532945093
  error estimate for blocks of size 2^( 5) =       0.000542749219
  error estimate for blocks of size 2^( 6) =       0.000549133715
  error estimate for blocks of size 2^( 7) =       0.000550020775

      target function =      -0.742575768547
              le_mean =     -22.661563863392
             les_mean =     513.999816444581
             stat err =       0.000543712200
             autocorr =       1.333472477396
   target nu stat err =       0.000543712200
   target dn stat err =       0.003213780445
      target stat err =       0.002679292542
              std dev =       0.665873985222
             le_variance =       0.443388164195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742575768547        initial  <--
     2.2737e+35     2.2737e+36             1.0938e-39        -0.742575768547
     9.0949e+35     9.0949e+36             2.7344e-40        -0.742575768547
     3.6380e+36     3.6380e+37             6.8360e-41        -0.742575768547

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0866
  </log>
  <optVariables href="FORM.s093.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7023e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.6702
    reference variance = 0.456015
====================================================
  Execution time = 2.6455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4727e-01
  Total weights = 1.955271824e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438388290435
                                         uncertainty =       0.001846283199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438388290435
                                         uncertainty =       0.001846283199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468196663
  error estimate for blocks of size 2^( 2) =       0.000492207007
  error estimate for blocks of size 2^( 3) =       0.000514890793
  error estimate for blocks of size 2^( 4) =       0.000531003988
  error estimate for blocks of size 2^( 5) =       0.000540254508
  error estimate for blocks of size 2^( 6) =       0.000545924946
  error estimate for blocks of size 2^( 7) =       0.000547442459

      target function =      -0.747550487288
              le_mean =     -22.662088899681
             les_mean =     514.017547639995
             stat err =       0.000541156475
             autocorr =       1.335946575045
   target nu stat err =       0.000541156475
   target dn stat err =       0.002527812738
      target stat err =       0.002167753610
              std dev =       0.662130070438
             le_variance =       0.438416230179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266208889968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+36, overlap shift 2.2737e+37 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747555837552       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747555837552       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+36, overlap shift 9.0949e+37 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747555837552       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747555837552       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+37, overlap shift 3.6380e+38 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747555837552       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747555837552       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.454799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1262e+01
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.6697
    reference variance = 0.399701
====================================================
  Execution time = 2.5492e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4898e-01
  Total weights = 1.9551e+06
  Execution time = 3.6449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498547376
                                         uncertainty =       0.002151610620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498547376
                                         uncertainty =       0.002151610620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468736599
  error estimate for blocks of size 2^( 2) =       0.000492798129
  error estimate for blocks of size 2^( 3) =       0.000515263202
  error estimate for blocks of size 2^( 4) =       0.000531393180
  error estimate for blocks of size 2^( 5) =       0.000540278318
  error estimate for blocks of size 2^( 6) =       0.000543497470
  error estimate for blocks of size 2^( 7) =       0.000544981856

      target function =      -0.746145949182
              le_mean =     -22.662161415866
             les_mean =     514.022539806389
             stat err =       0.000540037706
             autocorr =       1.327365232424
   target nu stat err =       0.000540037706
   target dn stat err =       0.002951643056
      target stat err =       0.002496353884
              std dev =       0.662893655754
             le_variance =       0.439427998838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498547376
                                         uncertainty =       0.002151610620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498547376
                                         uncertainty =       0.002151610620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468736599
  error estimate for blocks of size 2^( 2) =       0.000492798129
  error estimate for blocks of size 2^( 3) =       0.000515263202
  error estimate for blocks of size 2^( 4) =       0.000531393180
  error estimate for blocks of size 2^( 5) =       0.000540278318
  error estimate for blocks of size 2^( 6) =       0.000543497470
  error estimate for blocks of size 2^( 7) =       0.000544981856

      target function =      -0.746145949182
              le_mean =     -22.662161415866
             les_mean =     514.022539806389
             stat err =       0.000540037706
             autocorr =       1.327365232427
   target nu stat err =       0.000540037706
   target dn stat err =       0.002951643056
      target stat err =       0.002496353884
              std dev =       0.662893655754
             le_variance =       0.439427998838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498547376
                                         uncertainty =       0.002151610620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498547376
                                         uncertainty =       0.002151610620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468736599
  error estimate for blocks of size 2^( 2) =       0.000492798129
  error estimate for blocks of size 2^( 3) =       0.000515263202
  error estimate for blocks of size 2^( 4) =       0.000531393180
  error estimate for blocks of size 2^( 5) =       0.000540278318
  error estimate for blocks of size 2^( 6) =       0.000543497470
  error estimate for blocks of size 2^( 7) =       0.000544981856

      target function =      -0.746145949182
              le_mean =     -22.662161415866
             les_mean =     514.022539806389
             stat err =       0.000540037706
             autocorr =       1.327365232427
   target nu stat err =       0.000540037706
   target dn stat err =       0.002951643056
      target stat err =       0.002496353884
              std dev =       0.662893655754
             le_variance =       0.439427998838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498547376
                                         uncertainty =       0.002151610620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439498547376
                                         uncertainty =       0.002151610620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468736599
  error estimate for blocks of size 2^( 2) =       0.000492798129
  error estimate for blocks of size 2^( 3) =       0.000515263202
  error estimate for blocks of size 2^( 4) =       0.000531393180
  error estimate for blocks of size 2^( 5) =       0.000540278318
  error estimate for blocks of size 2^( 6) =       0.000543497470
  error estimate for blocks of size 2^( 7) =       0.000544981856

      target function =      -0.746145949182
              le_mean =     -22.662161415866
             les_mean =     514.022539806389
             stat err =       0.000540037706
             autocorr =       1.327365232427
   target nu stat err =       0.000540037706
   target dn stat err =       0.002951643056
      target stat err =       0.002496353884
              std dev =       0.662893655754
             le_variance =       0.439427998838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746145949182        initial  <--
     2.2737e+36     2.2737e+37             0.0000e+00        -0.746145949182
     9.0949e+36     9.0949e+37             0.0000e+00        -0.746145949182
     3.6380e+37     3.6380e+38             0.0000e+00        -0.746145949182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8676
  </log>
  <optVariables href="FORM.s094.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.6527
    reference variance = 0.823018
====================================================
  Execution time = 2.8354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5153e-01
  Total weights = 1.955225684e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441937183857
                                         uncertainty =       0.002018348005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441937183857
                                         uncertainty =       0.002018348005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470080430
  error estimate for blocks of size 2^( 2) =       0.000494221492
  error estimate for blocks of size 2^( 3) =       0.000516376963
  error estimate for blocks of size 2^( 4) =       0.000532649026
  error estimate for blocks of size 2^( 5) =       0.000542903163
  error estimate for blocks of size 2^( 6) =       0.000549455363
  error estimate for blocks of size 2^( 7) =       0.000552771591

      target function =      -0.744059646183
              le_mean =     -22.661935039439
             les_mean =     514.014826056704
             stat err =       0.000544444786
             autocorr =       1.341415572292
   target nu stat err =       0.000544444786
   target dn stat err =       0.002587293567
      target stat err =       0.002195530108
              std dev =       0.664794118876
             le_variance =       0.441951220492


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266193503944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+37, overlap shift 2.2737e+38 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744065253743       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744065253743       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+37, overlap shift 9.0949e+38 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744065253743       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744065253743       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+38, overlap shift 3.6380e+39 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744065253743       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744065253743       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.455927 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3166e+01
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.7068
    reference variance = 0.353846
====================================================
  Execution time = 2.5461e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5707e-01
  Total weights = 1.9552e+06
  Execution time = 3.6533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445846113733
                                         uncertainty =       0.003340798855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445846113733
                                         uncertainty =       0.003340798855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472140850
  error estimate for blocks of size 2^( 2) =       0.000495883397
  error estimate for blocks of size 2^( 3) =       0.000518235934
  error estimate for blocks of size 2^( 4) =       0.000534894470
  error estimate for blocks of size 2^( 5) =       0.000544298193
  error estimate for blocks of size 2^( 6) =       0.000550765834
  error estimate for blocks of size 2^( 7) =       0.000552016419

      target function =      -0.739555345396
              le_mean =     -22.662694573351
             les_mean =     514.054793918999
             stat err =       0.000545493729
             autocorr =       1.334862002769
   target nu stat err =       0.000545493729
   target dn stat err =       0.003959994654
      target stat err =       0.003253141176
              std dev =       0.667707992739
             le_variance =       0.445833963568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445846113733
                                         uncertainty =       0.003340798855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445846113733
                                         uncertainty =       0.003340798855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472140850
  error estimate for blocks of size 2^( 2) =       0.000495883397
  error estimate for blocks of size 2^( 3) =       0.000518235934
  error estimate for blocks of size 2^( 4) =       0.000534894470
  error estimate for blocks of size 2^( 5) =       0.000544298193
  error estimate for blocks of size 2^( 6) =       0.000550765834
  error estimate for blocks of size 2^( 7) =       0.000552016419

      target function =      -0.739555345396
              le_mean =     -22.662694573351
             les_mean =     514.054793918999
             stat err =       0.000545493729
             autocorr =       1.334862002769
   target nu stat err =       0.000545493729
   target dn stat err =       0.003959994654
      target stat err =       0.003253141176
              std dev =       0.667707992739
             le_variance =       0.445833963568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445846113733
                                         uncertainty =       0.003340798855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445846113733
                                         uncertainty =       0.003340798855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472140850
  error estimate for blocks of size 2^( 2) =       0.000495883397
  error estimate for blocks of size 2^( 3) =       0.000518235934
  error estimate for blocks of size 2^( 4) =       0.000534894470
  error estimate for blocks of size 2^( 5) =       0.000544298193
  error estimate for blocks of size 2^( 6) =       0.000550765834
  error estimate for blocks of size 2^( 7) =       0.000552016419

      target function =      -0.739555345396
              le_mean =     -22.662694573351
             les_mean =     514.054793918999
             stat err =       0.000545493729
             autocorr =       1.334862002769
   target nu stat err =       0.000545493729
   target dn stat err =       0.003959994654
      target stat err =       0.003253141176
              std dev =       0.667707992739
             le_variance =       0.445833963568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445846113733
                                         uncertainty =       0.003340798855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445846113733
                                         uncertainty =       0.003340798855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472140850
  error estimate for blocks of size 2^( 2) =       0.000495883397
  error estimate for blocks of size 2^( 3) =       0.000518235934
  error estimate for blocks of size 2^( 4) =       0.000534894470
  error estimate for blocks of size 2^( 5) =       0.000544298193
  error estimate for blocks of size 2^( 6) =       0.000550765834
  error estimate for blocks of size 2^( 7) =       0.000552016419

      target function =      -0.739555345396
              le_mean =     -22.662694573351
             les_mean =     514.054793918999
             stat err =       0.000545493729
             autocorr =       1.334862002769
   target nu stat err =       0.000545493729
   target dn stat err =       0.003959994654
      target stat err =       0.003253141176
              std dev =       0.667707992739
             le_variance =       0.445833963568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739555345396        initial  <--
     2.2737e+37     2.2737e+38             0.0000e+00        -0.739555345396
     9.0949e+37     9.0949e+38             0.0000e+00        -0.739555345396
     3.6380e+38     3.6380e+39             0.0000e+00        -0.739555345396

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8279
  </log>
  <optVariables href="FORM.s095.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7030e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.6829
    reference variance = 0.289746
====================================================
  Execution time = 2.6414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4803e-01
  Total weights = 1.954904412e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7709e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670975717
                                         uncertainty =       0.001954933752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439670975717
                                         uncertainty =       0.001954933752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468851829
  error estimate for blocks of size 2^( 2) =       0.000492712663
  error estimate for blocks of size 2^( 3) =       0.000514567318
  error estimate for blocks of size 2^( 4) =       0.000531715186
  error estimate for blocks of size 2^( 5) =       0.000540911325
  error estimate for blocks of size 2^( 6) =       0.000546187748
  error estimate for blocks of size 2^( 7) =       0.000547285104

      target function =      -0.746922618060
              le_mean =     -22.661563463426
             les_mean =     513.994485729924
             stat err =       0.000541524841
             autocorr =       1.334029818885
   target nu stat err =       0.000541524841
   target dn stat err =       0.002587860874
      target stat err =       0.002210199466
              std dev =       0.663056615510
             le_variance =       0.439644075372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266156346343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+38, overlap shift 2.2737e+39 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928209675       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928209675       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+38, overlap shift 9.0949e+39 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928209675       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928209675       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+39, overlap shift 3.6380e+40 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746928209675       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746928209675       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.457005 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1192e+01
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.5783
    reference variance = 0.334474
====================================================
  Execution time = 2.5401e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4964e-01
  Total weights = 1.9553e+06
  Execution time = 3.6532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439778700731
                                         uncertainty =       0.002700744550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439778700731
                                         uncertainty =       0.002700744550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468937069
  error estimate for blocks of size 2^( 2) =       0.000492852641
  error estimate for blocks of size 2^( 3) =       0.000515521094
  error estimate for blocks of size 2^( 4) =       0.000531440936
  error estimate for blocks of size 2^( 5) =       0.000541605612
  error estimate for blocks of size 2^( 6) =       0.000547021014
  error estimate for blocks of size 2^( 7) =       0.000550730611

      target function =      -0.745597510483
              le_mean =     -22.661870872749
             les_mean =     514.010030482078
             stat err =       0.000542699543
             autocorr =       1.339336743801
   target nu stat err =       0.000542699543
   target dn stat err =       0.003591701380
      target stat err =       0.003004557805
              std dev =       0.663177162389
             le_variance =       0.439803948715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439778700731
                                         uncertainty =       0.002700744550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439778700731
                                         uncertainty =       0.002700744550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468937069
  error estimate for blocks of size 2^( 2) =       0.000492852641
  error estimate for blocks of size 2^( 3) =       0.000515521094
  error estimate for blocks of size 2^( 4) =       0.000531440936
  error estimate for blocks of size 2^( 5) =       0.000541605612
  error estimate for blocks of size 2^( 6) =       0.000547021014
  error estimate for blocks of size 2^( 7) =       0.000550730611

      target function =      -0.745597510483
              le_mean =     -22.661870872749
             les_mean =     514.010030482078
             stat err =       0.000542699543
             autocorr =       1.339336743799
   target nu stat err =       0.000542699543
   target dn stat err =       0.003591701380
      target stat err =       0.003004557805
              std dev =       0.663177162389
             le_variance =       0.439803948715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439778700731
                                         uncertainty =       0.002700744550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439778700731
                                         uncertainty =       0.002700744550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468937069
  error estimate for blocks of size 2^( 2) =       0.000492852641
  error estimate for blocks of size 2^( 3) =       0.000515521094
  error estimate for blocks of size 2^( 4) =       0.000531440936
  error estimate for blocks of size 2^( 5) =       0.000541605612
  error estimate for blocks of size 2^( 6) =       0.000547021014
  error estimate for blocks of size 2^( 7) =       0.000550730611

      target function =      -0.745597510483
              le_mean =     -22.661870872749
             les_mean =     514.010030482078
             stat err =       0.000542699543
             autocorr =       1.339336743799
   target nu stat err =       0.000542699543
   target dn stat err =       0.003591701380
      target stat err =       0.003004557805
              std dev =       0.663177162389
             le_variance =       0.439803948715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439778700731
                                         uncertainty =       0.002700744550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439778700731
                                         uncertainty =       0.002700744550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468937069
  error estimate for blocks of size 2^( 2) =       0.000492852641
  error estimate for blocks of size 2^( 3) =       0.000515521094
  error estimate for blocks of size 2^( 4) =       0.000531440936
  error estimate for blocks of size 2^( 5) =       0.000541605612
  error estimate for blocks of size 2^( 6) =       0.000547021014
  error estimate for blocks of size 2^( 7) =       0.000550730611

      target function =      -0.745597510483
              le_mean =     -22.661870872749
             les_mean =     514.010030482078
             stat err =       0.000542699543
             autocorr =       1.339336743799
   target nu stat err =       0.000542699543
   target dn stat err =       0.003591701380
      target stat err =       0.003004557805
              std dev =       0.663177162389
             le_variance =       0.439803948715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745597510483        initial  <--
     2.2737e+38     2.2737e+39             0.0000e+00        -0.745597510483
     9.0949e+38     9.0949e+39             0.0000e+00        -0.745597510483
     3.6380e+39     3.6380e+40             0.0000e+00        -0.745597510483

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7732
  </log>
  <optVariables href="FORM.s096.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.635
    reference variance = 0.390596
====================================================
  Execution time = 2.7984e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5598e-01
  Total weights = 1.954973364e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442211676851
                                         uncertainty =       0.002852042964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442211676851
                                         uncertainty =       0.002852042964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470244874
  error estimate for blocks of size 2^( 2) =       0.000493963836
  error estimate for blocks of size 2^( 3) =       0.000516455245
  error estimate for blocks of size 2^( 4) =       0.000532351778
  error estimate for blocks of size 2^( 5) =       0.000541376864
  error estimate for blocks of size 2^( 6) =       0.000547307541
  error estimate for blocks of size 2^( 7) =       0.000548962178

      target function =      -0.740427071293
              le_mean =     -22.661683059376
             les_mean =     514.007859892288
             stat err =       0.000542499590
             autocorr =       1.330916131527
   target nu stat err =       0.000542499590
   target dn stat err =       0.004487463369
      target stat err =       0.003675306612
              std dev =       0.665026678304
             le_variance =       0.442260482856


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266168305938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+39, overlap shift 2.2737e+40 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740444422873       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740444422873       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+39, overlap shift 9.0949e+40 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740444422873       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740444422873       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+40, overlap shift 3.6380e+41 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740444422873       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740444422873       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.458111 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2794e+01
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.6522
    reference variance = 0.332267
====================================================
  Execution time = 2.5815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5045e-01
  Total weights = 1.9552e+06
  Execution time = 3.6622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441073070454
                                         uncertainty =       0.002777910518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441073070454
                                         uncertainty =       0.002777910518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469576861
  error estimate for blocks of size 2^( 2) =       0.000493597137
  error estimate for blocks of size 2^( 3) =       0.000515830171
  error estimate for blocks of size 2^( 4) =       0.000532315512
  error estimate for blocks of size 2^( 5) =       0.000542858214
  error estimate for blocks of size 2^( 6) =       0.000548895006
  error estimate for blocks of size 2^( 7) =       0.000552555248

      target function =      -0.744935622894
              le_mean =     -22.662308027042
             les_mean =     514.030659398768
             stat err =       0.000544155995
             autocorr =       1.342868416078
   target nu stat err =       0.000544155995
   target dn stat err =       0.003424573130
      target stat err =       0.002867588409
              std dev =       0.664081965381
             le_variance =       0.441004856744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441073070454
                                         uncertainty =       0.002777910518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441073070454
                                         uncertainty =       0.002777910518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469576861
  error estimate for blocks of size 2^( 2) =       0.000493597137
  error estimate for blocks of size 2^( 3) =       0.000515830171
  error estimate for blocks of size 2^( 4) =       0.000532315512
  error estimate for blocks of size 2^( 5) =       0.000542858214
  error estimate for blocks of size 2^( 6) =       0.000548895006
  error estimate for blocks of size 2^( 7) =       0.000552555248

      target function =      -0.744935622894
              le_mean =     -22.662308027042
             les_mean =     514.030659398768
             stat err =       0.000544155995
             autocorr =       1.342868416078
   target nu stat err =       0.000544155995
   target dn stat err =       0.003424573130
      target stat err =       0.002867588409
              std dev =       0.664081965381
             le_variance =       0.441004856744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441073070454
                                         uncertainty =       0.002777910518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441073070454
                                         uncertainty =       0.002777910518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469576861
  error estimate for blocks of size 2^( 2) =       0.000493597137
  error estimate for blocks of size 2^( 3) =       0.000515830171
  error estimate for blocks of size 2^( 4) =       0.000532315512
  error estimate for blocks of size 2^( 5) =       0.000542858214
  error estimate for blocks of size 2^( 6) =       0.000548895006
  error estimate for blocks of size 2^( 7) =       0.000552555248

      target function =      -0.744935622894
              le_mean =     -22.662308027042
             les_mean =     514.030659398768
             stat err =       0.000544155995
             autocorr =       1.342868416078
   target nu stat err =       0.000544155995
   target dn stat err =       0.003424573130
      target stat err =       0.002867588409
              std dev =       0.664081965381
             le_variance =       0.441004856744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441073070454
                                         uncertainty =       0.002777910518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441073070454
                                         uncertainty =       0.002777910518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469576861
  error estimate for blocks of size 2^( 2) =       0.000493597137
  error estimate for blocks of size 2^( 3) =       0.000515830171
  error estimate for blocks of size 2^( 4) =       0.000532315512
  error estimate for blocks of size 2^( 5) =       0.000542858214
  error estimate for blocks of size 2^( 6) =       0.000548895006
  error estimate for blocks of size 2^( 7) =       0.000552555248

      target function =      -0.744935622894
              le_mean =     -22.662308027042
             les_mean =     514.030659398768
             stat err =       0.000544155995
             autocorr =       1.342868416078
   target nu stat err =       0.000544155995
   target dn stat err =       0.003424573130
      target stat err =       0.002867588409
              std dev =       0.664081965381
             le_variance =       0.441004856744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744935622894        initial  <--
     2.2737e+39     2.2737e+40             0.0000e+00        -0.744935622894
     9.0949e+39     9.0949e+40             0.0000e+00        -0.744935622894
     3.6380e+40     3.6380e+41             0.0000e+00        -0.744935622894

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2448
  </log>
  <optVariables href="FORM.s097.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7121e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.6756
    reference variance = 0.384979
====================================================
  Execution time = 2.6318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4737e-01
  Total weights = 1.955165884e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439433155218
                                         uncertainty =       0.002084367800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439433155218
                                         uncertainty =       0.002084367800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468789922
  error estimate for blocks of size 2^( 2) =       0.000492625896
  error estimate for blocks of size 2^( 3) =       0.000515006045
  error estimate for blocks of size 2^( 4) =       0.000531774159
  error estimate for blocks of size 2^( 5) =       0.000541081590
  error estimate for blocks of size 2^( 6) =       0.000546445088
  error estimate for blocks of size 2^( 7) =       0.000549561636

      target function =      -0.747453167621
              le_mean =     -22.660814255588
             les_mean =     513.959871076069
             stat err =       0.000542215618
             autocorr =       1.337788668457
   target nu stat err =       0.000542215618
   target dn stat err =       0.002485487157
      target stat err =       0.002130016562
              std dev =       0.662969065696
             le_variance =       0.439527982070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266081425559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+40, overlap shift 2.2737e+41 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747458265811       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747458265811       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+40, overlap shift 9.0949e+41 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747458265811       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747458265811       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+41, overlap shift 3.6380e+42 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747458265811       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747458265811       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.459215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1139e+01
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.7353
    reference variance = 0.573375
====================================================
  Execution time = 2.5647e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5570e-01
  Total weights = 1.9553e+06
  Execution time = 3.6776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444198494819
                                         uncertainty =       0.002540187620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444198494819
                                         uncertainty =       0.002540187620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471363414
  error estimate for blocks of size 2^( 2) =       0.000495376544
  error estimate for blocks of size 2^( 3) =       0.000518330048
  error estimate for blocks of size 2^( 4) =       0.000534739220
  error estimate for blocks of size 2^( 5) =       0.000544926007
  error estimate for blocks of size 2^( 6) =       0.000547928638
  error estimate for blocks of size 2^( 7) =       0.000551051285

      target function =      -0.740667812158
              le_mean =     -22.662661261249
             les_mean =     514.051910795728
             stat err =       0.000544661287
             autocorr =       1.335184477411
   target nu stat err =       0.000544661287
   target dn stat err =       0.003697932021
      target stat err =       0.003053979167
              std dev =       0.666608533177
             le_variance =       0.444366936505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444198494819
                                         uncertainty =       0.002540187620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444198494819
                                         uncertainty =       0.002540187620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471363414
  error estimate for blocks of size 2^( 2) =       0.000495376544
  error estimate for blocks of size 2^( 3) =       0.000518330048
  error estimate for blocks of size 2^( 4) =       0.000534739220
  error estimate for blocks of size 2^( 5) =       0.000544926007
  error estimate for blocks of size 2^( 6) =       0.000547928638
  error estimate for blocks of size 2^( 7) =       0.000551051285

      target function =      -0.740667812158
              le_mean =     -22.662661261249
             les_mean =     514.051910795728
             stat err =       0.000544661287
             autocorr =       1.335184477411
   target nu stat err =       0.000544661287
   target dn stat err =       0.003697932021
      target stat err =       0.003053979167
              std dev =       0.666608533177
             le_variance =       0.444366936505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444198494819
                                         uncertainty =       0.002540187620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444198494819
                                         uncertainty =       0.002540187620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471363414
  error estimate for blocks of size 2^( 2) =       0.000495376544
  error estimate for blocks of size 2^( 3) =       0.000518330048
  error estimate for blocks of size 2^( 4) =       0.000534739220
  error estimate for blocks of size 2^( 5) =       0.000544926007
  error estimate for blocks of size 2^( 6) =       0.000547928638
  error estimate for blocks of size 2^( 7) =       0.000551051285

      target function =      -0.740667812158
              le_mean =     -22.662661261249
             les_mean =     514.051910795728
             stat err =       0.000544661287
             autocorr =       1.335184477411
   target nu stat err =       0.000544661287
   target dn stat err =       0.003697932021
      target stat err =       0.003053979167
              std dev =       0.666608533177
             le_variance =       0.444366936505

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444198494819
                                         uncertainty =       0.002540187620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444198494819
                                         uncertainty =       0.002540187620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471363414
  error estimate for blocks of size 2^( 2) =       0.000495376544
  error estimate for blocks of size 2^( 3) =       0.000518330048
  error estimate for blocks of size 2^( 4) =       0.000534739220
  error estimate for blocks of size 2^( 5) =       0.000544926007
  error estimate for blocks of size 2^( 6) =       0.000547928638
  error estimate for blocks of size 2^( 7) =       0.000551051285

      target function =      -0.740667812158
              le_mean =     -22.662661261249
             les_mean =     514.051910795728
             stat err =       0.000544661287
             autocorr =       1.335184477411
   target nu stat err =       0.000544661287
   target dn stat err =       0.003697932021
      target stat err =       0.003053979167
              std dev =       0.666608533177
             le_variance =       0.444366936505


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740667812158        initial  <--
     2.2737e+40     2.2737e+41             0.0000e+00        -0.740667812158
     9.0949e+40     9.0949e+41             0.0000e+00        -0.740667812158
     3.6380e+41     3.6380e+42             0.0000e+00        -0.740667812158

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.6251
  </log>
  <optVariables href="FORM.s098.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6503
    reference variance = 0.373517
====================================================
  Execution time = 2.6426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4940e-01
  Total weights = 1.954941143e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441412104825
                                         uncertainty =       0.002221074641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441412104825
                                         uncertainty =       0.002221074641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469784935
  error estimate for blocks of size 2^( 2) =       0.000493889124
  error estimate for blocks of size 2^( 3) =       0.000516394406
  error estimate for blocks of size 2^( 4) =       0.000532617246
  error estimate for blocks of size 2^( 5) =       0.000541505014
  error estimate for blocks of size 2^( 6) =       0.000546445348
  error estimate for blocks of size 2^( 7) =       0.000549091194

      target function =      -0.745795554127
              le_mean =     -22.661872439760
             les_mean =     514.009867112505
             stat err =       0.000542414701
             autocorr =       1.333106145833
   target nu stat err =       0.000542414701
   target dn stat err =       0.002564906636
      target stat err =       0.002186924298
              std dev =       0.664376226824
             le_variance =       0.441395770769


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266187243976e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+41, overlap shift 2.2737e+42 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745801003353       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745801003353       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+41, overlap shift 9.0949e+42 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745801003353       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745801003353       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+42, overlap shift 3.6380e+43 and omega -2.3340e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745801003353       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745801003353       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.460326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1206e+01
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6154
    reference variance = 0.514398
====================================================
  Execution time = 2.5776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4989e-01
  Total weights = 1.9547e+06
  Execution time = 3.6618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439968734480
                                         uncertainty =       0.001881603121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439968734480
                                         uncertainty =       0.001881603121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469019508
  error estimate for blocks of size 2^( 2) =       0.000493419127
  error estimate for blocks of size 2^( 3) =       0.000515791254
  error estimate for blocks of size 2^( 4) =       0.000531890901
  error estimate for blocks of size 2^( 5) =       0.000541150092
  error estimate for blocks of size 2^( 6) =       0.000545369703
  error estimate for blocks of size 2^( 7) =       0.000548732684

      target function =      -0.745390395875
              le_mean =     -22.661181228855
             les_mean =     513.979023215201
             stat err =       0.000541785845
             autocorr =       1.334361477179
   target nu stat err =       0.000541785845
   target dn stat err =       0.002536860138
      target stat err =       0.002160144427
              std dev =       0.663293748859
             le_variance =       0.439958597276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439968734480
                                         uncertainty =       0.001881603121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439968734480
                                         uncertainty =       0.001881603121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469019508
  error estimate for blocks of size 2^( 2) =       0.000493419127
  error estimate for blocks of size 2^( 3) =       0.000515791254
  error estimate for blocks of size 2^( 4) =       0.000531890901
  error estimate for blocks of size 2^( 5) =       0.000541150092
  error estimate for blocks of size 2^( 6) =       0.000545369703
  error estimate for blocks of size 2^( 7) =       0.000548732684

      target function =      -0.745390395875
              le_mean =     -22.661181228855
             les_mean =     513.979023215201
             stat err =       0.000541785845
             autocorr =       1.334361477179
   target nu stat err =       0.000541785845
   target dn stat err =       0.002536860138
      target stat err =       0.002160144427
              std dev =       0.663293748859
             le_variance =       0.439958597276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439968734480
                                         uncertainty =       0.001881603121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439968734480
                                         uncertainty =       0.001881603121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469019508
  error estimate for blocks of size 2^( 2) =       0.000493419127
  error estimate for blocks of size 2^( 3) =       0.000515791254
  error estimate for blocks of size 2^( 4) =       0.000531890901
  error estimate for blocks of size 2^( 5) =       0.000541150092
  error estimate for blocks of size 2^( 6) =       0.000545369703
  error estimate for blocks of size 2^( 7) =       0.000548732684

      target function =      -0.745390395875
              le_mean =     -22.661181228855
             les_mean =     513.979023215201
             stat err =       0.000541785845
             autocorr =       1.334361477179
   target nu stat err =       0.000541785845
   target dn stat err =       0.002536860138
      target stat err =       0.002160144427
              std dev =       0.663293748859
             le_variance =       0.439958597276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439968734480
                                         uncertainty =       0.001881603121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439968734480
                                         uncertainty =       0.001881603121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469019508
  error estimate for blocks of size 2^( 2) =       0.000493419127
  error estimate for blocks of size 2^( 3) =       0.000515791254
  error estimate for blocks of size 2^( 4) =       0.000531890901
  error estimate for blocks of size 2^( 5) =       0.000541150092
  error estimate for blocks of size 2^( 6) =       0.000545369703
  error estimate for blocks of size 2^( 7) =       0.000548732684

      target function =      -0.745390395875
              le_mean =     -22.661181228855
             les_mean =     513.979023215201
             stat err =       0.000541785845
             autocorr =       1.334361477179
   target nu stat err =       0.000541785845
   target dn stat err =       0.002536860138
      target stat err =       0.002160144427
              std dev =       0.663293748859
             le_variance =       0.439958597276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745390395875        initial  <--
     2.2737e+41     2.2737e+42             0.0000e+00        -0.745390395875
     9.0949e+41     9.0949e+42             0.0000e+00        -0.745390395875
     3.6380e+42     3.6380e+43             0.0000e+00        -0.745390395875

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1795
  </log>
  <optVariables href="FORM.s099.opt.xml">
ci_001                -7.018627e-01 3 1  ON 0
ci_002                -7.061395e-01 3 1  ON 1
ci_003                -5.325481e-02 3 1  ON 2
ci_004                -5.421851e-02 3 1  ON 3
ci_005                 1.955256e-02 3 1  ON 4
ci_006                 1.970571e-02 3 1  ON 5
ci_007                 1.593180e-02 3 1  ON 6
ci_008                 1.581084e-02 3 1  ON 7
ci_009                -1.221655e-02 3 1  ON 8
ci_010                -1.256715e-02 3 1  ON 9
ci_011                -9.621570e-03 3 1  ON 10
ci_012                -9.759763e-03 3 1  ON 11
ci_013                 8.740028e-03 3 1  ON 12
ci_014                 8.759270e-03 3 1  ON 13
ci_015                 9.197331e-03 3 1  ON 14
ci_016                 9.488808e-03 3 1  ON 15
ci_017                 8.602871e-03 3 1  ON 16
ci_018                 8.230099e-03 3 1  ON 17
ci_019                -1.508140e-03 3 1  ON 18
ci_020                -1.393409e-03 3 1  ON 19
ci_021                -1.057121e-02 3 1  ON 20
ci_022                -1.123472e-02 3 1  ON 21
ci_023                 5.430269e-03 3 1  ON 22
ci_024                 5.203712e-03 3 1  ON 23
ci_025                 1.297670e-02 3 1  ON 24
ci_026                 1.262156e-02 3 1  ON 25
ci_027                 6.266929e-03 3 1  ON 26
ci_028                 6.259870e-03 3 1  ON 27
ci_029                -3.717492e-03 3 1  ON 28
ci_030                -4.409121e-03 3 1  ON 29
ci_031                 4.192241e-03 3 1  ON 30
ci_032                 3.805329e-03 3 1  ON 31
ci_033                 3.404661e-03 3 1  ON 32
ci_034                 3.333170e-03 3 1  ON 33
ci_035                 2.193346e-03 3 1  ON 34
ci_036                 2.081892e-03 3 1  ON 35
ci_037                 3.356355e-03 3 1  ON 36
ci_038                 3.297843e-03 3 1  ON 37
ci_039                 4.293576e-03 3 1  ON 38
ci_040                 4.421585e-03 3 1  ON 39
ci_041                 2.805346e-03 3 1  ON 40
ci_042                 2.870065e-03 3 1  ON 41
ci_043                 3.458508e-03 3 1  ON 42
ci_044                 3.118353e-03 3 1  ON 43
ci_045                 2.543988e-03 3 1  ON 44
ci_046                 2.917010e-03 3 1  ON 45
ci_047                -1.004253e-03 3 1  ON 46
ci_048                -1.145532e-03 3 1  ON 47
ci_049                 7.164642e-04 3 1  ON 48
ci_050                 7.516445e-04 3 1  ON 49
ci_051                -1.454688e-03 3 1  ON 50
ci_052                -1.326451e-03 3 1  ON 51
ci_053                -2.557682e-03 3 1  ON 52
ci_054                -2.687495e-03 3 1  ON 53
ci_055                -1.570171e-03 3 1  ON 54
ci_056                -1.305680e-03 3 1  ON 55
ci_057                -1.020396e-03 3 1  ON 56
ci_058                -9.825192e-04 3 1  ON 57
ci_059                -3.385718e-04 3 1  ON 58
ci_060                -2.459366e-04 3 1  ON 59
ci_061                -6.580397e-04 3 1  ON 60
ci_062                -4.331882e-04 3 1  ON 61
ci_063                -6.509781e-04 3 1  ON 62
ci_064                -7.824587e-04 3 1  ON 63
ci_065                -1.801405e-03 3 1  ON 64
ci_066                -1.700258e-03 3 1  ON 65
ci_067                -1.660003e-03 3 1  ON 66
ci_068                -1.554945e-03 3 1  ON 67
ci_069                -1.960802e-05 3 1  ON 68
ci_070                 1.068905e-04 3 1  ON 69
ci_071                -1.494404e-03 3 1  ON 70
ci_072                -1.910953e-03 3 1  ON 71
ci_073                 8.942082e-05 3 1  ON 72
ci_074                 1.594138e-04 3 1  ON 73
ci_075                 1.356605e-04 3 1  ON 74
ci_076                 2.461745e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5422e+01 secs
  Total Execution time = 7.5751e+03 secs

=========================================================
  A new xml input file : FORM.s099.cont.xml
