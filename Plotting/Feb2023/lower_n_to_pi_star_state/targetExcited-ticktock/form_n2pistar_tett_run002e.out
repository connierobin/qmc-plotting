Rank =    0  Free Memory = 73245 MB
Rank =    1  Free Memory = 73245 MB
Rank =    2  Free Memory = 73244 MB
Rank =    3  Free Memory = 73244 MB
Rank =    4  Free Memory = 73244 MB
Rank =    5  Free Memory = 73244 MB
Rank =    6  Free Memory = 73243 MB
Rank =    7  Free Memory = 73243 MB
Rank =    8  Free Memory = 73243 MB
Rank =    9  Free Memory = 73243 MB
Rank =   10  Free Memory = 73242 MB
Rank =   11  Free Memory = 73242 MB
Rank =   12  Free Memory = 73242 MB
Rank =   13  Free Memory = 73242 MB
Rank =   14  Free Memory = 73242 MB
Rank =   15  Free Memory = 73229 MB
Rank =   16  Free Memory = 73229 MB
Rank =   17  Free Memory = 73229 MB
Rank =   18  Free Memory = 73229 MB
Rank =   19  Free Memory = 73229 MB
Rank =   20  Free Memory = 73229 MB
Rank =   21  Free Memory = 73229 MB
Rank =   22  Free Memory = 73229 MB
Rank =   23  Free Memory = 73229 MB
Rank =   24  Free Memory = 73229 MB
Rank =   25  Free Memory = 73228 MB
Rank =   26  Free Memory = 73228 MB
Rank =   27  Free Memory = 73228 MB
Rank =   28  Free Memory = 73228 MB
Rank =   29  Free Memory = 73228 MB
Rank =   30  Free Memory = 73228 MB
Rank =   31  Free Memory = 73228 MB
Rank =   32  Free Memory = 85024 MB
Rank =   33  Free Memory = 85024 MB
Rank =   34  Free Memory = 85023 MB
Rank =   35  Free Memory = 85023 MB
Rank =   36  Free Memory = 85023 MB
Rank =   37  Free Memory = 85023 MB
Rank =   38  Free Memory = 85023 MB
Rank =   39  Free Memory = 85023 MB
Rank =   40  Free Memory = 85023 MB
Rank =   41  Free Memory = 85023 MB
Rank =   42  Free Memory = 85023 MB
Rank =   43  Free Memory = 85023 MB
Rank =   44  Free Memory = 85023 MB
Rank =   45  Free Memory = 85023 MB
Rank =   46  Free Memory = 85023 MB
Rank =   47  Free Memory = 85023 MB
Rank =   48  Free Memory = 85023 MB
Rank =   49  Free Memory = 85023 MB
Rank =   50  Free Memory = 85023 MB
Rank =   51  Free Memory = 85023 MB
Rank =   52  Free Memory = 85023 MB
Rank =   53  Free Memory = 85023 MB
Rank =   54  Free Memory = 85023 MB
Rank =   55  Free Memory = 85023 MB
Rank =   56  Free Memory = 85023 MB
Rank =   57  Free Memory = 85023 MB
Rank =   58  Free Memory = 85023 MB
Rank =   59  Free Memory = 85023 MB
Rank =   60  Free Memory = 85023 MB
Rank =   61  Free Memory = 85023 MB
Rank =   62  Free Memory = 85023 MB
Rank =   63  Free Memory = 85023 MB
Rank =   64  Free Memory = 89896 MB
Rank =   65  Free Memory = 89896 MB
Rank =   66  Free Memory = 89896 MB
Rank =   67  Free Memory = 89896 MB
Rank =   68  Free Memory = 89896 MB
Rank =   69  Free Memory = 89896 MB
Rank =   70  Free Memory = 89896 MB
Rank =   71  Free Memory = 89896 MB
Rank =   72  Free Memory = 89896 MB
Rank =   73  Free Memory = 89896 MB
Rank =   74  Free Memory = 89896 MB
Rank =   75  Free Memory = 89896 MB
Rank =   76  Free Memory = 89896 MB
Rank =   77  Free Memory = 89896 MB
Rank =   78  Free Memory = 89896 MB
Rank =   79  Free Memory = 89896 MB
Rank =   80  Free Memory = 89896 MB
Rank =   81  Free Memory = 89896 MB
Rank =   82  Free Memory = 89896 MB
Rank =   83  Free Memory = 89896 MB
Rank =   84  Free Memory = 89896 MB
Rank =   85  Free Memory = 89896 MB
Rank =   86  Free Memory = 89896 MB
Rank =   87  Free Memory = 89896 MB
Rank =   88  Free Memory = 89896 MB
Rank =   89  Free Memory = 89896 MB
Rank =   90  Free Memory = 89895 MB
Rank =   91  Free Memory = 89895 MB
Rank =   92  Free Memory = 89895 MB
Rank =   93  Free Memory = 89895 MB
Rank =   94  Free Memory = 89895 MB
Rank =   95  Free Memory = 89895 MB
Rank =   96  Free Memory = 90168 MB
Rank =   97  Free Memory = 90168 MB
Rank =   98  Free Memory = 90168 MB
Rank =   99  Free Memory = 90168 MB
Rank =  100  Free Memory = 90168 MB
Rank =  101  Free Memory = 90168 MB
Rank =  102  Free Memory = 90168 MB
Rank =  103  Free Memory = 90168 MB
Rank =  104  Free Memory = 90168 MB
Rank =  105  Free Memory = 90168 MB
Rank =  106  Free Memory = 90168 MB
Rank =  107  Free Memory = 90168 MB
Rank =  108  Free Memory = 90168 MB
Rank =  109  Free Memory = 90168 MB
Rank =  110  Free Memory = 90168 MB
Rank =  111  Free Memory = 90168 MB
Rank =  112  Free Memory = 90168 MB
Rank =  113  Free Memory = 90168 MB
Rank =  114  Free Memory = 90168 MB
Rank =  115  Free Memory = 90168 MB
Rank =  116  Free Memory = 90168 MB
Rank =  117  Free Memory = 90168 MB
Rank =  118  Free Memory = 90168 MB
Rank =  119  Free Memory = 90168 MB
Rank =  120  Free Memory = 90168 MB
Rank =  121  Free Memory = 90168 MB
Rank =  122  Free Memory = 90168 MB
Rank =  123  Free Memory = 90168 MB
Rank =  124  Free Memory = 90168 MB
Rank =  125  Free Memory = 90168 MB
Rank =  126  Free Memory = 90168 MB
Rank =  127  Free Memory = 90168 MB
  Input file(s): opt_form_n2pistar_tett_run002e.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_tett_run002e.xml

  Project = FORM2
  date    = 2023-03-13 00:28:41 PDT
  host    = n0082.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 169

  Range of prime numbers to use as seeds over processors and threads = 1019-1979


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.833579e-01    1         1 OFF
     uu_1                 1.228244e-01    1         1 OFF
     uu_2                 2.219413e-02    1         1 OFF
     uu_3                -3.896382e-02    1         1 OFF
     uu_4                -7.713109e-02    1         1 OFF
     uu_5                -1.034439e-01    1         1 OFF
     uu_6                -1.222077e-01    1         1 OFF
     uu_7                -1.322284e-01    1         1 OFF
     uu_8                -1.319272e-01    1         1 OFF
     uu_9                -1.067384e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.458110e-01    1         1 OFF
     ud_1                 1.052929e-01    1         1 OFF
     ud_2                -1.436508e-02    1         1 OFF
     ud_3                -7.758601e-02    1         1 OFF
     ud_4                -1.132437e-01    1         1 OFF
     ud_5                -1.345247e-01    1         1 OFF
     ud_6                -1.462770e-01    1         1 OFF
     ud_7                -1.471093e-01    1         1 OFF
     ud_8                -1.359779e-01    1         1 OFF
     ud_9                -1.006530e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.040900e-01    1         1 OFF
     eC_1                -3.826772e-01    1         1 OFF
     eC_2                -1.705972e-01    1         1 OFF
     eC_3                -4.731043e-02    1         1 OFF
     eC_4                 9.363800e-04    1         1 OFF
     eC_5                 1.123156e-01    1         1 OFF
     eC_6                 2.480182e-01    1         1 OFF
     eC_7                 3.629280e-01    1         1 OFF
     eC_8                 2.917384e-01    1         1 OFF
     eC_9                 8.322409e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.036146e+00    1         1 OFF
     eO_1                -7.318125e-01    1         1 OFF
     eO_2                -3.266696e-01    1         1 OFF
     eO_3                -2.665472e-02    1         1 OFF
     eO_4                 1.670258e-01    1         1 OFF
     eO_5                 3.252036e-01    1         1 OFF
     eO_6                 3.821360e-01    1         1 OFF
     eO_7                 4.026774e-01    1         1 OFF
     eO_8                 3.889800e-01    1         1 OFF
     eO_9                 3.144324e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.168100e-01    1         1 OFF
     eH1_1                -1.160357e-01    1         1 OFF
     eH1_2                -7.327931e-02    1         1 OFF
     eH1_3                -5.245108e-02    1         1 OFF
     eH1_4                 1.475920e-02    1         1 OFF
     eH1_5                 6.681762e-02    1         1 OFF
     eH1_6                 9.461657e-02    1         1 OFF
     eH1_7                 5.347127e-02    1         1 OFF
     eH1_8                 7.422875e-03    1         1 OFF
     eH1_9                 4.301386e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.152090e-01    1         1 OFF
     eH2_1                -1.128185e-01    1         1 OFF
     eH2_2                -7.197254e-02    1         1 OFF
     eH2_3                -5.233494e-02    1         1 OFF
     eH2_4                 1.367858e-02    1         1 OFF
     eH2_5                 6.592106e-02    1         1 OFF
     eH2_6                 9.573015e-02    1         1 OFF
     eH2_7                 6.194381e-02    1         1 OFF
     eH2_8                 2.583937e-02    1         1 OFF
     eH2_9                 5.355459e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.000196e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.6567e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM2.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6841
    reference variance = 0.428089
====================================================
  Execution time = 2.6788e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6171e-01
  Total weights = 1.955204765e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447463915397
                                         uncertainty =       0.003581139603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447463915397
                                         uncertainty =       0.003581139603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473025312
  error estimate for blocks of size 2^( 2) =       0.000496501669
  error estimate for blocks of size 2^( 3) =       0.000519211023
  error estimate for blocks of size 2^( 4) =       0.000534839693
  error estimate for blocks of size 2^( 5) =       0.000542987370
  error estimate for blocks of size 2^( 6) =       0.000546993862
  error estimate for blocks of size 2^( 7) =       0.000550218877

      target function =      -0.735791927187
              le_mean =     -22.662105686540
             les_mean =     514.032746418471
             stat err =       0.000543759951
             autocorr =       1.321434596829
   target nu stat err =       0.000543759951
   target dn stat err =       0.007286858792
      target stat err =       0.005855740807
              std dev =       0.668958811745
             le_variance =       0.447505891811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266210568654e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735837315614       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735949522002       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735973552712       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735975354309       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735975611874       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735975573288       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735975828381       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735976039496       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735975976479       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735975978828       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735975995901       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735976000097       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.246839e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735837315614       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735869016847       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735875446760       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735875900771       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735875960511       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735875950591       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735876010684       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735876055096       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735876039563       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735876040064       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735876044008       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735876044612       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.471788e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735837315614       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735845507309       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735847142254       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735847255661       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735847270196       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735847267735       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735847282462       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735847293002       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735847289155       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735847289282       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735847290243       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735847290369       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 8.933137e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008244 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1633e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_001 -7.053198e-01                3 1 ON  0
ci_002 -7.031723e-01                3 1 ON  1
ci_003 -4.987786e-02                3 1 ON  2
ci_004 -5.099403e-02                3 1 ON  3
ci_005 1.945542e-02                 3 1 ON  4
ci_006 1.985091e-02                 3 1 ON  5
ci_007 1.476525e-02                 3 1 ON  6
ci_008 1.561655e-02                 3 1 ON  7
ci_009 -1.326537e-02                3 1 ON  8
ci_010 -1.208129e-02                3 1 ON  9
ci_011 -9.950362e-03                3 1 ON  10
ci_012 -9.019966e-03                3 1 ON  11
ci_013 8.294332e-03                 3 1 ON  12
ci_014 9.362694e-03                 3 1 ON  13
ci_015 9.499511e-03                 3 1 ON  14
ci_016 9.391703e-03                 3 1 ON  15
ci_017 8.592797e-03                 3 1 ON  16
ci_018 8.285882e-03                 3 1 ON  17
ci_019 -1.154951e-03                3 1 ON  18
ci_020 -1.481383e-03                3 1 ON  19
ci_021 -1.201455e-02                3 1 ON  20
ci_022 -1.184138e-02                3 1 ON  21
ci_023 4.858631e-03                 3 1 ON  22
ci_024 4.995435e-03                 3 1 ON  23
ci_025 1.166780e-02                 3 1 ON  24
ci_026 1.160021e-02                 3 1 ON  25
ci_027 6.491173e-03                 3 1 ON  26
ci_028 6.198893e-03                 3 1 ON  27
ci_029 -5.062282e-03                3 1 ON  28
ci_030 -4.115467e-03                3 1 ON  29
ci_031 3.445187e-03                 3 1 ON  30
ci_032 4.640280e-03                 3 1 ON  31
ci_033 2.332132e-03                 3 1 ON  32
ci_034 4.187021e-03                 3 1 ON  33
ci_035 1.723270e-03                 3 1 ON  34
ci_036 2.130080e-03                 3 1 ON  35
ci_037 3.571074e-03                 3 1 ON  36
ci_038 3.775080e-03                 3 1 ON  37
ci_039 4.610156e-03                 3 1 ON  38
ci_040 4.988137e-03                 3 1 ON  39
ci_041 3.054366e-03                 3 1 ON  40
ci_042 2.719491e-03                 3 1 ON  41
ci_043 3.041720e-03                 3 1 ON  42
ci_044 3.106447e-03                 3 1 ON  43
ci_045 2.495227e-03                 3 1 ON  44
ci_046 2.636145e-03                 3 1 ON  45
ci_047 -1.039783e-03                3 1 ON  46
ci_048 -8.629817e-04                3 1 ON  47
ci_049 8.720631e-04                 3 1 ON  48
ci_050 1.038938e-03                 3 1 ON  49
ci_051 -2.963300e-04                3 1 ON  50
ci_052 -1.166459e-03                3 1 ON  51
ci_053 -2.406437e-03                3 1 ON  52
ci_054 -2.652524e-03                3 1 ON  53
ci_055 -1.806626e-03                3 1 ON  54
ci_056 -1.909967e-03                3 1 ON  55
ci_057 -1.305229e-03                3 1 ON  56
ci_058 -9.555012e-04                3 1 ON  57
ci_059 -4.805901e-04                3 1 ON  58
ci_060 -7.413153e-04                3 1 ON  59
ci_061 -6.955090e-05                3 1 ON  60
ci_062 -9.213763e-04                3 1 ON  61
ci_063 -1.063278e-03                3 1 ON  62
ci_064 -4.890415e-04                3 1 ON  63
ci_065 -1.305234e-03                3 1 ON  64
ci_066 -1.843955e-03                3 1 ON  65
ci_067 -1.742496e-03                3 1 ON  66
ci_068 -1.535713e-03                3 1 ON  67
ci_069 -5.813527e-04                3 1 ON  68
ci_070 -4.314829e-04                3 1 ON  69
ci_071 -2.040551e-03                3 1 ON  70
ci_072 -2.025541e-03                3 1 ON  71
ci_073 1.294934e-04                 3 1 ON  72
ci_074 1.982827e-04                 3 1 ON  73
ci_075 1.143059e-04                 3 1 ON  74
ci_076 7.853071e-04                 3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6405
    reference variance = 0.345667
====================================================
  Execution time = 2.5930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4443e-01
  Total weights = 1.9552e+06
  Execution time = 3.6393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436937039176
                                         uncertainty =       0.001937376760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436937039176
                                         uncertainty =       0.001937376760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467414865
  error estimate for blocks of size 2^( 2) =       0.000491402845
  error estimate for blocks of size 2^( 3) =       0.000513396030
  error estimate for blocks of size 2^( 4) =       0.000529278251
  error estimate for blocks of size 2^( 5) =       0.000538930119
  error estimate for blocks of size 2^( 6) =       0.000546319944
  error estimate for blocks of size 2^( 7) =       0.000548217879

      target function =      -0.749800748901
              le_mean =     -22.660877987527
             les_mean =     513.959931420870
             stat err =       0.000540686548
             autocorr =       1.338092353407
   target nu stat err =       0.000540686548
   target dn stat err =       0.002511442329
      target stat err =       0.002165291964
              std dev =       0.661024441773
             le_variance =       0.436953312621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436790016324
                                         uncertainty =       0.001941078172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436790016324
                                         uncertainty =       0.001941078172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467336148
  error estimate for blocks of size 2^( 2) =       0.000491340574
  error estimate for blocks of size 2^( 3) =       0.000513334826
  error estimate for blocks of size 2^( 4) =       0.000529219762
  error estimate for blocks of size 2^( 5) =       0.000538841190
  error estimate for blocks of size 2^( 6) =       0.000546208968
  error estimate for blocks of size 2^( 7) =       0.000548088970

      target function =      -0.745573521492
              le_mean =     -22.660879564792
             les_mean =     513.965112760693
             stat err =       0.000540589722
             autocorr =       1.338063795973
   target nu stat err =       0.000540589722
   target dn stat err =       0.004974425379
      target stat err =       0.004119064695
              std dev =       0.660913118583
             le_variance =       0.436806150315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436830824364
                                         uncertainty =       0.001937725490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436830824364
                                         uncertainty =       0.001937725490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467358034
  error estimate for blocks of size 2^( 2) =       0.000491354762
  error estimate for blocks of size 2^( 3) =       0.000513350474
  error estimate for blocks of size 2^( 4) =       0.000529234258
  error estimate for blocks of size 2^( 5) =       0.000538869864
  error estimate for blocks of size 2^( 6) =       0.000546248194
  error estimate for blocks of size 2^( 7) =       0.000548138364

      target function =      -0.749491110236
              le_mean =     -22.660878005318
             les_mean =     513.960305959756
             stat err =       0.000540622670
             autocorr =       1.338101569664
   target nu stat err =       0.000540622670
   target dn stat err =       0.002524934556
      target stat err =       0.002174292496
              std dev =       0.660944070463
             le_variance =       0.436847064280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436920856926
                                         uncertainty =       0.001937380905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436920856926
                                         uncertainty =       0.001937380905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467406208
  error estimate for blocks of size 2^( 2) =       0.000491395321
  error estimate for blocks of size 2^( 3) =       0.000513388811
  error estimate for blocks of size 2^( 4) =       0.000529271290
  error estimate for blocks of size 2^( 5) =       0.000538920895
  error estimate for blocks of size 2^( 6) =       0.000546309402
  error estimate for blocks of size 2^( 7) =       0.000548206475

      target function =      -0.749767122942
              le_mean =     -22.660877534230
             les_mean =     513.959951418056
             stat err =       0.000540677015
             autocorr =       1.338094736746
   target nu stat err =       0.000540677015
   target dn stat err =       0.002516151123
      target stat err =       0.002168851359
              std dev =       0.661012198901
             le_variance =       0.436937127096


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749800748901        initial  <--
     2.5000e-01     2.5000e+00             1.2468e-03        -0.745573521492
     1.0000e+00     1.0000e+01             3.4718e-04        -0.749491110236
     4.0000e+00     4.0000e+01             8.9331e-05        -0.749767122942

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0501
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6745
    reference variance = 0.297655
====================================================
  Execution time = 2.5881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5030e-01
  Total weights = 1.955162745e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7443e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440193724974
                                         uncertainty =       0.002172254842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440193724974
                                         uncertainty =       0.002172254842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469165078
  error estimate for blocks of size 2^( 2) =       0.000493175722
  error estimate for blocks of size 2^( 3) =       0.000515120429
  error estimate for blocks of size 2^( 4) =       0.000531262753
  error estimate for blocks of size 2^( 5) =       0.000541417115
  error estimate for blocks of size 2^( 6) =       0.000546910704
  error estimate for blocks of size 2^( 7) =       0.000548884551

      target function =      -0.745069781726
              le_mean =     -22.662210860158
             les_mean =     514.026102943007
             stat err =       0.000542118781
             autocorr =       1.335173025156
   target nu stat err =       0.000542118781
   target dn stat err =       0.002752423247
      target stat err =       0.002334161032
              std dev =       0.663499616543
             le_variance =       0.440231741153


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266221086016e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745076099875       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745093535122       residual = 7.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745097489377       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745097895559       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745098037381       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745098045353       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745098065752       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745098070292       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745098069386       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745098069855       residual = 1.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.083872e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745076099875       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745080532389       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745081528581       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745081629916       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745081665211       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745081667165       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745081672203       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745081673279       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745081673055       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745081673169       residual = 1.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.740524e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745076099875       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745077212708       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745077462234       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745077487553       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745077496366       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745077496852       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745077498108       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745077498373       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745077498317       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745077498345       residual = 1.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 6.870863e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0634e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_001                -7.054734e-01 3 1  ON 0
ci_002                -7.030173e-01 3 1  ON 1
ci_003                -4.997449e-02 3 1  ON 2
ci_004                -5.097061e-02 3 1  ON 3
ci_005                 1.953767e-02 3 1  ON 4
ci_006                 1.990475e-02 3 1  ON 5
ci_007                 1.473185e-02 3 1  ON 6
ci_008                 1.563593e-02 3 1  ON 7
ci_009                -1.330426e-02 3 1  ON 8
ci_010                -1.213522e-02 3 1  ON 9
ci_011                -9.959412e-03 3 1  ON 10
ci_012                -9.110860e-03 3 1  ON 11
ci_013                 8.430951e-03 3 1  ON 12
ci_014                 9.427986e-03 3 1  ON 13
ci_015                 9.568152e-03 3 1  ON 14
ci_016                 9.508241e-03 3 1  ON 15
ci_017                 8.521805e-03 3 1  ON 16
ci_018                 8.349950e-03 3 1  ON 17
ci_019                -1.067465e-03 3 1  ON 18
ci_020                -1.352492e-03 3 1  ON 19
ci_021                -1.173974e-02 3 1  ON 20
ci_022                -1.170559e-02 3 1  ON 21
ci_023                 4.847076e-03 3 1  ON 22
ci_024                 4.932970e-03 3 1  ON 23
ci_025                 1.134177e-02 3 1  ON 24
ci_026                 1.142280e-02 3 1  ON 25
ci_027                 6.496940e-03 3 1  ON 26
ci_028                 6.234106e-03 3 1  ON 27
ci_029                -5.167939e-03 3 1  ON 28
ci_030                -4.214625e-03 3 1  ON 29
ci_031                 3.249526e-03 3 1  ON 30
ci_032                 4.405513e-03 3 1  ON 31
ci_033                 2.349567e-03 3 1  ON 32
ci_034                 4.173583e-03 3 1  ON 33
ci_035                 1.734543e-03 3 1  ON 34
ci_036                 2.189586e-03 3 1  ON 35
ci_037                 3.583654e-03 3 1  ON 36
ci_038                 3.695856e-03 3 1  ON 37
ci_039                 4.646521e-03 3 1  ON 38
ci_040                 4.983691e-03 3 1  ON 39
ci_041                 2.962864e-03 3 1  ON 40
ci_042                 2.748083e-03 3 1  ON 41
ci_043                 3.006690e-03 3 1  ON 42
ci_044                 3.212352e-03 3 1  ON 43
ci_045                 2.436500e-03 3 1  ON 44
ci_046                 2.689184e-03 3 1  ON 45
ci_047                -9.964849e-04 3 1  ON 46
ci_048                -8.331013e-04 3 1  ON 47
ci_049                 7.387306e-04 3 1  ON 48
ci_050                 1.066288e-03 3 1  ON 49
ci_051                -2.790936e-04 3 1  ON 50
ci_052                -1.202975e-03 3 1  ON 51
ci_053                -2.420362e-03 3 1  ON 52
ci_054                -2.659998e-03 3 1  ON 53
ci_055                -1.815293e-03 3 1  ON 54
ci_056                -1.958568e-03 3 1  ON 55
ci_057                -1.328221e-03 3 1  ON 56
ci_058                -9.741625e-04 3 1  ON 57
ci_059                -5.646770e-04 3 1  ON 58
ci_060                -7.789563e-04 3 1  ON 59
ci_061                -6.236654e-05 3 1  ON 60
ci_062                -9.460787e-04 3 1  ON 61
ci_063                -8.818807e-04 3 1  ON 62
ci_064                -5.180959e-04 3 1  ON 63
ci_065                -1.339018e-03 3 1  ON 64
ci_066                -1.927605e-03 3 1  ON 65
ci_067                -1.805374e-03 3 1  ON 66
ci_068                -1.578758e-03 3 1  ON 67
ci_069                -5.668050e-04 3 1  ON 68
ci_070                -4.351609e-04 3 1  ON 69
ci_071                -2.075876e-03 3 1  ON 70
ci_072                -1.992864e-03 3 1  ON 71
ci_073                 1.592334e-04 3 1  ON 72
ci_074                 2.085438e-04 3 1  ON 73
ci_075                 1.480377e-04 3 1  ON 74
ci_076                 8.188626e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6861
    reference variance = 0.369144
====================================================
  Execution time = 2.5408e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5772e-01
  Total weights = 1.9552e+06
  Execution time = 3.6416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444849000667
                                         uncertainty =       0.003015264160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444849000667
                                         uncertainty =       0.003015264160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471632379
  error estimate for blocks of size 2^( 2) =       0.000495546311
  error estimate for blocks of size 2^( 3) =       0.000517205290
  error estimate for blocks of size 2^( 4) =       0.000532066279
  error estimate for blocks of size 2^( 5) =       0.000541388083
  error estimate for blocks of size 2^( 6) =       0.000547761627
  error estimate for blocks of size 2^( 7) =       0.000548825095

      target function =      -0.739002591684
              le_mean =     -22.662551624395
             les_mean =     514.048994693386
             stat err =       0.000542510271
             autocorr =       1.323148848485
   target nu stat err =       0.000542510271
   target dn stat err =       0.004544233979
      target stat err =       0.003714720931
              std dev =       0.666988907257
             le_variance =       0.444874202404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444831588575
                                         uncertainty =       0.003014627801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444831588575
                                         uncertainty =       0.003014627801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471623170
  error estimate for blocks of size 2^( 2) =       0.000495540107
  error estimate for blocks of size 2^( 3) =       0.000517199683
  error estimate for blocks of size 2^( 4) =       0.000532061833
  error estimate for blocks of size 2^( 5) =       0.000541377260
  error estimate for blocks of size 2^( 6) =       0.000547751737
  error estimate for blocks of size 2^( 7) =       0.000548808469

      target function =      -0.342102921180
              le_mean =     -22.662549945640
             les_mean =     514.784282912314
             stat err =       0.000542499825
             autocorr =       1.323149563062
   target nu stat err =       0.000542499825
   target dn stat err =       0.735242010665
      target stat err =       0.152339098575
              std dev =       0.666975883872
             le_variance =       0.444856829666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444837666605
                                         uncertainty =       0.003014706720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444837666605
                                         uncertainty =       0.003014706720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471626385
  error estimate for blocks of size 2^( 2) =       0.000495541614
  error estimate for blocks of size 2^( 3) =       0.000517201227
  error estimate for blocks of size 2^( 4) =       0.000532062277
  error estimate for blocks of size 2^( 5) =       0.000541383731
  error estimate for blocks of size 2^( 6) =       0.000547758737
  error estimate for blocks of size 2^( 7) =       0.000548821382

      target function =      -0.739024774176
              le_mean =     -22.662551517642
             les_mean =     514.048962470453
             stat err =       0.000542506532
             autocorr =       1.323164244739
   target nu stat err =       0.000542506532
   target dn stat err =       0.004533759411
      target stat err =       0.003706594451
              std dev =       0.666980429751
             le_variance =       0.444862893671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444847548165
                                         uncertainty =       0.003015192788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444847548165
                                         uncertainty =       0.003015192788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471631611
  error estimate for blocks of size 2^( 2) =       0.000495545706
  error estimate for blocks of size 2^( 3) =       0.000517204763
  error estimate for blocks of size 2^( 4) =       0.000532065761
  error estimate for blocks of size 2^( 5) =       0.000541387519
  error estimate for blocks of size 2^( 6) =       0.000547761242
  error estimate for blocks of size 2^( 7) =       0.000548824604

      target function =      -0.739010837461
              le_mean =     -22.662551606664
             les_mean =     514.048983688034
             stat err =       0.000542509781
             autocorr =       1.323150770437
   target nu stat err =       0.000542509781
   target dn stat err =       0.004542568221
      target stat err =       0.003713475449
              std dev =       0.666987820795
             le_variance =       0.444872753089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739002591684        initial
     2.5000e+00     2.5000e+01             1.0839e-04        -0.342102921180
     1.0000e+01     1.0000e+02             2.7405e-05        -0.739024774176  <--
     4.0000e+01     4.0000e+02             6.8709e-06        -0.739010837461

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.3605e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_001                -7.054734e-01 3 1  ON 0
ci_002                -7.030173e-01 3 1  ON 1
ci_003                -4.997449e-02 3 1  ON 2
ci_004                -5.097061e-02 3 1  ON 3
ci_005                 1.953767e-02 3 1  ON 4
ci_006                 1.990475e-02 3 1  ON 5
ci_007                 1.473185e-02 3 1  ON 6
ci_008                 1.563593e-02 3 1  ON 7
ci_009                -1.330426e-02 3 1  ON 8
ci_010                -1.213522e-02 3 1  ON 9
ci_011                -9.959412e-03 3 1  ON 10
ci_012                -9.110860e-03 3 1  ON 11
ci_013                 8.430951e-03 3 1  ON 12
ci_014                 9.427986e-03 3 1  ON 13
ci_015                 9.568152e-03 3 1  ON 14
ci_016                 9.508241e-03 3 1  ON 15
ci_017                 8.521805e-03 3 1  ON 16
ci_018                 8.349950e-03 3 1  ON 17
ci_019                -1.067465e-03 3 1  ON 18
ci_020                -1.352492e-03 3 1  ON 19
ci_021                -1.173974e-02 3 1  ON 20
ci_022                -1.170559e-02 3 1  ON 21
ci_023                 4.847076e-03 3 1  ON 22
ci_024                 4.932970e-03 3 1  ON 23
ci_025                 1.134177e-02 3 1  ON 24
ci_026                 1.142280e-02 3 1  ON 25
ci_027                 6.496940e-03 3 1  ON 26
ci_028                 6.234106e-03 3 1  ON 27
ci_029                -5.167939e-03 3 1  ON 28
ci_030                -4.214625e-03 3 1  ON 29
ci_031                 3.249526e-03 3 1  ON 30
ci_032                 4.405513e-03 3 1  ON 31
ci_033                 2.349567e-03 3 1  ON 32
ci_034                 4.173583e-03 3 1  ON 33
ci_035                 1.734543e-03 3 1  ON 34
ci_036                 2.189586e-03 3 1  ON 35
ci_037                 3.583654e-03 3 1  ON 36
ci_038                 3.695856e-03 3 1  ON 37
ci_039                 4.646521e-03 3 1  ON 38
ci_040                 4.983691e-03 3 1  ON 39
ci_041                 2.962864e-03 3 1  ON 40
ci_042                 2.748083e-03 3 1  ON 41
ci_043                 3.006690e-03 3 1  ON 42
ci_044                 3.212352e-03 3 1  ON 43
ci_045                 2.436500e-03 3 1  ON 44
ci_046                 2.689184e-03 3 1  ON 45
ci_047                -9.964849e-04 3 1  ON 46
ci_048                -8.331013e-04 3 1  ON 47
ci_049                 7.387306e-04 3 1  ON 48
ci_050                 1.066288e-03 3 1  ON 49
ci_051                -2.790936e-04 3 1  ON 50
ci_052                -1.202975e-03 3 1  ON 51
ci_053                -2.420362e-03 3 1  ON 52
ci_054                -2.659998e-03 3 1  ON 53
ci_055                -1.815293e-03 3 1  ON 54
ci_056                -1.958568e-03 3 1  ON 55
ci_057                -1.328221e-03 3 1  ON 56
ci_058                -9.741625e-04 3 1  ON 57
ci_059                -5.646770e-04 3 1  ON 58
ci_060                -7.789563e-04 3 1  ON 59
ci_061                -6.236654e-05 3 1  ON 60
ci_062                -9.460787e-04 3 1  ON 61
ci_063                -8.818807e-04 3 1  ON 62
ci_064                -5.180959e-04 3 1  ON 63
ci_065                -1.339018e-03 3 1  ON 64
ci_066                -1.927605e-03 3 1  ON 65
ci_067                -1.805374e-03 3 1  ON 66
ci_068                -1.578758e-03 3 1  ON 67
ci_069                -5.668050e-04 3 1  ON 68
ci_070                -4.351609e-04 3 1  ON 69
ci_071                -2.075876e-03 3 1  ON 70
ci_072                -1.992864e-03 3 1  ON 71
ci_073                 1.592334e-04 3 1  ON 72
ci_074                 2.085438e-04 3 1  ON 73
ci_075                 1.480377e-04 3 1  ON 74
ci_076                 8.188626e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2671e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.546
    reference variance = 0.533029
====================================================
  Execution time = 2.8449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6402e-01
  Total weights = 1.955286747e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443802681176
                                         uncertainty =       0.003720262408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443802681176
                                         uncertainty =       0.003720262408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471034203
  error estimate for blocks of size 2^( 2) =       0.000495398053
  error estimate for blocks of size 2^( 3) =       0.000517419702
  error estimate for blocks of size 2^( 4) =       0.000533154034
  error estimate for blocks of size 2^( 5) =       0.000541333860
  error estimate for blocks of size 2^( 6) =       0.000547484015
  error estimate for blocks of size 2^( 7) =       0.000549952576

      target function =      -0.733889357933
              le_mean =     -22.662011882865
             les_mean =     514.030800421713
             stat err =       0.000542981121
             autocorr =       1.328815158470
   target nu stat err =       0.000542981121
   target dn stat err =       0.011305523643
      target stat err =       0.009010881128
              std dev =       0.666142957598
             le_variance =       0.443746439957


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266201188287e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733999085935       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734007813847       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734009379511       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734010139115       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734010617368       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734010760631       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734010787733       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734010793032       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734010791337       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734010807952       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734010810899       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734010812981       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.639667e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733999085935       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734001297067       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734001691074       residual = 9.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734001881255       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734001999552       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734002034464       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734002041063       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734002042257       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734002041840       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734002045867       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734002046568       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734002047070       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 4.100974e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.733999085935       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.733999640571       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.733999739235       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.733999786796       residual = 6.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.733999816289       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.733999824961       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.733999826600       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.733999826890       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.733999826786       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.733999827785       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.733999827958       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.733999828082       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 1.025357e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3190e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_001                -7.055118e-01 3 1  ON 0
ci_002                -7.029763e-01 3 1  ON 1
ci_003                -5.001535e-02 3 1  ON 2
ci_004                -5.098130e-02 3 1  ON 3
ci_005                 1.953268e-02 3 1  ON 4
ci_006                 1.989981e-02 3 1  ON 5
ci_007                 1.473201e-02 3 1  ON 6
ci_008                 1.562577e-02 3 1  ON 7
ci_009                -1.329370e-02 3 1  ON 8
ci_010                -1.213546e-02 3 1  ON 9
ci_011                -9.952812e-03 3 1  ON 10
ci_012                -9.116046e-03 3 1  ON 11
ci_013                 8.420164e-03 3 1  ON 12
ci_014                 9.424863e-03 3 1  ON 13
ci_015                 9.562612e-03 3 1  ON 14
ci_016                 9.500433e-03 3 1  ON 15
ci_017                 8.520956e-03 3 1  ON 16
ci_018                 8.349259e-03 3 1  ON 17
ci_019                -1.083654e-03 3 1  ON 18
ci_020                -1.375575e-03 3 1  ON 19
ci_021                -1.174151e-02 3 1  ON 20
ci_022                -1.170804e-02 3 1  ON 21
ci_023                 4.848553e-03 3 1  ON 22
ci_024                 4.938892e-03 3 1  ON 23
ci_025                 1.134199e-02 3 1  ON 24
ci_026                 1.141178e-02 3 1  ON 25
ci_027                 6.497833e-03 3 1  ON 26
ci_028                 6.228288e-03 3 1  ON 27
ci_029                -5.161640e-03 3 1  ON 28
ci_030                -4.204682e-03 3 1  ON 29
ci_031                 3.251821e-03 3 1  ON 30
ci_032                 4.424919e-03 3 1  ON 31
ci_033                 2.348364e-03 3 1  ON 32
ci_034                 4.174778e-03 3 1  ON 33
ci_035                 1.733148e-03 3 1  ON 34
ci_036                 2.185249e-03 3 1  ON 35
ci_037                 3.573005e-03 3 1  ON 36
ci_038                 3.700157e-03 3 1  ON 37
ci_039                 4.643941e-03 3 1  ON 38
ci_040                 4.974420e-03 3 1  ON 39
ci_041                 2.967326e-03 3 1  ON 40
ci_042                 2.747412e-03 3 1  ON 41
ci_043                 2.999241e-03 3 1  ON 42
ci_044                 3.207333e-03 3 1  ON 43
ci_045                 2.436799e-03 3 1  ON 44
ci_046                 2.696577e-03 3 1  ON 45
ci_047                -9.941106e-04 3 1  ON 46
ci_048                -8.334448e-04 3 1  ON 47
ci_049                 7.451332e-04 3 1  ON 48
ci_050                 1.052775e-03 3 1  ON 49
ci_051                -2.869529e-04 3 1  ON 50
ci_052                -1.206679e-03 3 1  ON 51
ci_053                -2.423409e-03 3 1  ON 52
ci_054                -2.672253e-03 3 1  ON 53
ci_055                -1.814858e-03 3 1  ON 54
ci_056                -1.951867e-03 3 1  ON 55
ci_057                -1.325945e-03 3 1  ON 56
ci_058                -9.748837e-04 3 1  ON 57
ci_059                -5.633791e-04 3 1  ON 58
ci_060                -7.782210e-04 3 1  ON 59
ci_061                -6.372678e-05 3 1  ON 60
ci_062                -9.435504e-04 3 1  ON 61
ci_063                -8.847056e-04 3 1  ON 62
ci_064                -5.188246e-04 3 1  ON 63
ci_065                -1.343948e-03 3 1  ON 64
ci_066                -1.924193e-03 3 1  ON 65
ci_067                -1.806982e-03 3 1  ON 66
ci_068                -1.577144e-03 3 1  ON 67
ci_069                -5.651874e-04 3 1  ON 68
ci_070                -4.341710e-04 3 1  ON 69
ci_071                -2.076219e-03 3 1  ON 70
ci_072                -1.996013e-03 3 1  ON 71
ci_073                 1.554459e-04 3 1  ON 72
ci_074                 2.088176e-04 3 1  ON 73
ci_075                 1.580184e-04 3 1  ON 74
ci_076                 8.134741e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.637
    reference variance = 0.247338
====================================================
  Execution time = 2.5316e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5159e-01
  Total weights = 1.9556e+06
  Execution time = 3.6123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441851292202
                                         uncertainty =       0.002673965256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441851292202
                                         uncertainty =       0.002673965256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470063262
  error estimate for blocks of size 2^( 2) =       0.000494228192
  error estimate for blocks of size 2^( 3) =       0.000516099811
  error estimate for blocks of size 2^( 4) =       0.000532840025
  error estimate for blocks of size 2^( 5) =       0.000541956233
  error estimate for blocks of size 2^( 6) =       0.000547155624
  error estimate for blocks of size 2^( 7) =       0.000551591748

      target function =      -0.743943871145
              le_mean =     -22.661606212205
             les_mean =     514.000064727616
             stat err =       0.000543385908
             autocorr =       1.336300474345
   target nu stat err =       0.000543385908
   target dn stat err =       0.003092911729
      target stat err =       0.002595372548
              std dev =       0.664769839896
             le_variance =       0.441918940035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441850476128
                                         uncertainty =       0.002674797630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441850476128
                                         uncertainty =       0.002674797630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470062799
  error estimate for blocks of size 2^( 2) =       0.000494229395
  error estimate for blocks of size 2^( 3) =       0.000516101999
  error estimate for blocks of size 2^( 4) =       0.000532841971
  error estimate for blocks of size 2^( 5) =       0.000541958697
  error estimate for blocks of size 2^( 6) =       0.000547157816
  error estimate for blocks of size 2^( 7) =       0.000551597387

      target function =      -0.744124998879
              le_mean =     -22.661606428633
             les_mean =     513.999853143598
             stat err =       0.000543388968
             autocorr =       1.336318154217
   target nu stat err =       0.000543388968
   target dn stat err =       0.003042354039
      target stat err =       0.002556417590
              std dev =       0.664769186120
             le_variance =       0.441918070815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441850626500
                                         uncertainty =       0.002674378048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441850626500
                                         uncertainty =       0.002674378048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470062894
  error estimate for blocks of size 2^( 2) =       0.000494228668
  error estimate for blocks of size 2^( 3) =       0.000516100792
  error estimate for blocks of size 2^( 4) =       0.000532840881
  error estimate for blocks of size 2^( 5) =       0.000541957348
  error estimate for blocks of size 2^( 6) =       0.000547156601
  error estimate for blocks of size 2^( 7) =       0.000551594459

      target function =      -0.744054936839
              le_mean =     -22.661606299674
             les_mean =     513.999932931406
             stat err =       0.000543387322
             autocorr =       1.336309524666
   target nu stat err =       0.000543387322
   target dn stat err =       0.003060677712
      target stat err =       0.002570506547
              std dev =       0.664769319316
             le_variance =       0.441918247904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441851183233
                                         uncertainty =       0.002674016151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441851183233
                                         uncertainty =       0.002674016151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470063202
  error estimate for blocks of size 2^( 2) =       0.000494228238
  error estimate for blocks of size 2^( 3) =       0.000516099921
  error estimate for blocks of size 2^( 4) =       0.000532840119
  error estimate for blocks of size 2^( 5) =       0.000541956359
  error estimate for blocks of size 2^( 6) =       0.000547155733
  error estimate for blocks of size 2^( 7) =       0.000551592074

      target function =      -0.743960273726
              le_mean =     -22.661606220567
             les_mean =     514.000045056886
             stat err =       0.000543386071
             autocorr =       1.336301618893
   target nu stat err =       0.000543386071
   target dn stat err =       0.003087807035
      target stat err =       0.002591426686
              std dev =       0.664769755475
             le_variance =       0.441918827794


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743943871145        initial
     2.5000e+00     2.5000e+01             1.6397e-04        -0.744124998879  <--
     1.0000e+01     1.0000e+02             4.1010e-05        -0.744054936839
     4.0000e+01     4.0000e+02             1.0254e-05        -0.743960273726

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.7377e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_001                -7.056269e-01 3 1  ON 0
ci_002                -7.028533e-01 3 1  ON 1
ci_003                -5.013736e-02 3 1  ON 2
ci_004                -5.101318e-02 3 1  ON 3
ci_005                 1.951806e-02 3 1  ON 4
ci_006                 1.988518e-02 3 1  ON 5
ci_007                 1.473255e-02 3 1  ON 6
ci_008                 1.559573e-02 3 1  ON 7
ci_009                -1.326254e-02 3 1  ON 8
ci_010                -1.213610e-02 3 1  ON 9
ci_011                -9.933308e-03 3 1  ON 10
ci_012                -9.131296e-03 3 1  ON 11
ci_013                 8.388264e-03 3 1  ON 12
ci_014                 9.415602e-03 3 1  ON 13
ci_015                 9.546238e-03 3 1  ON 14
ci_016                 9.477351e-03 3 1  ON 15
ci_017                 8.518473e-03 3 1  ON 16
ci_018                 8.347245e-03 3 1  ON 17
ci_019                -1.131514e-03 3 1  ON 18
ci_020                -1.443745e-03 3 1  ON 19
ci_021                -1.174673e-02 3 1  ON 20
ci_022                -1.171523e-02 3 1  ON 21
ci_023                 4.852919e-03 3 1  ON 22
ci_024                 4.956305e-03 3 1  ON 23
ci_025                 1.134271e-02 3 1  ON 24
ci_026                 1.137924e-02 3 1  ON 25
ci_027                 6.500477e-03 3 1  ON 26
ci_028                 6.211160e-03 3 1  ON 27
ci_029                -5.143011e-03 3 1  ON 28
ci_030                -4.175347e-03 3 1  ON 29
ci_031                 3.258623e-03 3 1  ON 30
ci_032                 4.482221e-03 3 1  ON 31
ci_033                 2.344817e-03 3 1  ON 32
ci_034                 4.178296e-03 3 1  ON 33
ci_035                 1.729106e-03 3 1  ON 34
ci_036                 2.172513e-03 3 1  ON 35
ci_037                 3.541577e-03 3 1  ON 36
ci_038                 3.712826e-03 3 1  ON 37
ci_039                 4.636361e-03 3 1  ON 38
ci_040                 4.947162e-03 3 1  ON 39
ci_041                 2.980477e-03 3 1  ON 40
ci_042                 2.745437e-03 3 1  ON 41
ci_043                 2.977223e-03 3 1  ON 42
ci_044                 3.192543e-03 3 1  ON 43
ci_045                 2.437699e-03 3 1  ON 44
ci_046                 2.718400e-03 3 1  ON 45
ci_047                -9.871218e-04 3 1  ON 46
ci_048                -8.344574e-04 3 1  ON 47
ci_049                 7.640034e-04 3 1  ON 48
ci_050                 1.012973e-03 3 1  ON 49
ci_051                -3.101370e-04 3 1  ON 50
ci_052                -1.217565e-03 3 1  ON 51
ci_053                -2.432423e-03 3 1  ON 52
ci_054                -2.708422e-03 3 1  ON 53
ci_055                -1.813564e-03 3 1  ON 54
ci_056                -1.932098e-03 3 1  ON 55
ci_057                -1.319244e-03 3 1  ON 56
ci_058                -9.770016e-04 3 1  ON 57
ci_059                -5.595377e-04 3 1  ON 58
ci_060                -7.760533e-04 3 1  ON 59
ci_061                -6.776212e-05 3 1  ON 60
ci_062                -9.360871e-04 3 1  ON 61
ci_063                -8.930720e-04 3 1  ON 62
ci_064                -5.209720e-04 3 1  ON 63
ci_065                -1.358515e-03 3 1  ON 64
ci_066                -1.914145e-03 3 1  ON 65
ci_067                -1.811738e-03 3 1  ON 66
ci_068                -1.572398e-03 3 1  ON 67
ci_069                -5.604234e-04 3 1  ON 68
ci_070                -4.312380e-04 3 1  ON 69
ci_071                -2.077235e-03 3 1  ON 70
ci_072                -2.005285e-03 3 1  ON 71
ci_073                 1.443012e-04 3 1  ON 72
ci_074                 2.096188e-04 3 1  ON 73
ci_075                 1.874706e-04 3 1  ON 74
ci_076                 7.975860e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.0575e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2645e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7123
    reference variance = 0.371054
====================================================
  Execution time = 2.5958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5275e-01
  Total weights = 1.955250225e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443301310878
                                         uncertainty =       0.002593492795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443301310878
                                         uncertainty =       0.002593492795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470727903
  error estimate for blocks of size 2^( 2) =       0.000495123181
  error estimate for blocks of size 2^( 3) =       0.000517993965
  error estimate for blocks of size 2^( 4) =       0.000534014121
  error estimate for blocks of size 2^( 5) =       0.000543184579
  error estimate for blocks of size 2^( 6) =       0.000548712113
  error estimate for blocks of size 2^( 7) =       0.000553051281

      target function =      -0.743061982877
              le_mean =     -22.662154982940
             les_mean =     514.026023048210
             stat err =       0.000544740523
             autocorr =       1.339181629398
   target nu stat err =       0.000544740523
   target dn stat err =       0.003123935551
      target stat err =       0.002616447959
              std dev =       0.665709784290
             le_variance =       0.443169516900


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266215498294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743070196986       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743098201478       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743103473495       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743104059222       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743104568788       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743104990624       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743105211479       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743105335097       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743105364571       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743105385528       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743105381617       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743105388570       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 3.685560e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743070196986       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743077592984       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743078949296       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743079094655       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743079222512       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743079323219       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743079374207       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743079403240       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743079409855       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743079414390       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743079413299       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743079414755       residual = 9.84e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 9.216230e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743070196986       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743072072429       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743072413937       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743072450183       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743072482163       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743072507021       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743072519501       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743072526641       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743072528247       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743072529337       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743072529059       residual = 9.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.302992e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0722e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_001                -7.057191e-01 3 1  ON 0
ci_002                -7.027641e-01 3 1  ON 1
ci_003                -5.009923e-02 3 1  ON 2
ci_004                -5.102517e-02 3 1  ON 3
ci_005                 1.951752e-02 3 1  ON 4
ci_006                 1.984505e-02 3 1  ON 5
ci_007                 1.470835e-02 3 1  ON 6
ci_008                 1.559322e-02 3 1  ON 7
ci_009                -1.323805e-02 3 1  ON 8
ci_010                -1.207601e-02 3 1  ON 9
ci_011                -9.937552e-03 3 1  ON 10
ci_012                -9.138081e-03 3 1  ON 11
ci_013                 8.388596e-03 3 1  ON 12
ci_014                 9.394377e-03 3 1  ON 13
ci_015                 9.506480e-03 3 1  ON 14
ci_016                 9.491259e-03 3 1  ON 15
ci_017                 8.489883e-03 3 1  ON 16
ci_018                 8.340537e-03 3 1  ON 17
ci_019                -1.165069e-03 3 1  ON 18
ci_020                -1.477214e-03 3 1  ON 19
ci_021                -1.176860e-02 3 1  ON 20
ci_022                -1.177671e-02 3 1  ON 21
ci_023                 4.842197e-03 3 1  ON 22
ci_024                 4.930791e-03 3 1  ON 23
ci_025                 1.139863e-02 3 1  ON 24
ci_026                 1.142480e-02 3 1  ON 25
ci_027                 6.491224e-03 3 1  ON 26
ci_028                 6.211268e-03 3 1  ON 27
ci_029                -5.118923e-03 3 1  ON 28
ci_030                -4.147934e-03 3 1  ON 29
ci_031                 3.294393e-03 3 1  ON 30
ci_032                 4.522191e-03 3 1  ON 31
ci_033                 2.375734e-03 3 1  ON 32
ci_034                 4.128688e-03 3 1  ON 33
ci_035                 1.733159e-03 3 1  ON 34
ci_036                 2.155302e-03 3 1  ON 35
ci_037                 3.592915e-03 3 1  ON 36
ci_038                 3.724418e-03 3 1  ON 37
ci_039                 4.628665e-03 3 1  ON 38
ci_040                 4.927331e-03 3 1  ON 39
ci_041                 2.954568e-03 3 1  ON 40
ci_042                 2.763047e-03 3 1  ON 41
ci_043                 2.994143e-03 3 1  ON 42
ci_044                 3.184095e-03 3 1  ON 43
ci_045                 2.445863e-03 3 1  ON 44
ci_046                 2.713672e-03 3 1  ON 45
ci_047                -1.000200e-03 3 1  ON 46
ci_048                -8.368288e-04 3 1  ON 47
ci_049                 7.616780e-04 3 1  ON 48
ci_050                 1.024768e-03 3 1  ON 49
ci_051                -3.206455e-04 3 1  ON 50
ci_052                -1.219761e-03 3 1  ON 51
ci_053                -2.437252e-03 3 1  ON 52
ci_054                -2.699768e-03 3 1  ON 53
ci_055                -1.794768e-03 3 1  ON 54
ci_056                -1.888218e-03 3 1  ON 55
ci_057                -1.316151e-03 3 1  ON 56
ci_058                -9.685835e-04 3 1  ON 57
ci_059                -5.502113e-04 3 1  ON 58
ci_060                -7.519876e-04 3 1  ON 59
ci_061                -7.863627e-05 3 1  ON 60
ci_062                -9.229344e-04 3 1  ON 61
ci_063                -8.747234e-04 3 1  ON 62
ci_064                -5.087821e-04 3 1  ON 63
ci_065                -1.339583e-03 3 1  ON 64
ci_066                -1.905364e-03 3 1  ON 65
ci_067                -1.822815e-03 3 1  ON 66
ci_068                -1.570761e-03 3 1  ON 67
ci_069                -5.628291e-04 3 1  ON 68
ci_070                -4.245424e-04 3 1  ON 69
ci_071                -2.088347e-03 3 1  ON 70
ci_072                -2.048607e-03 3 1  ON 71
ci_073                 1.354807e-04 3 1  ON 72
ci_074                 1.953905e-04 3 1  ON 73
ci_075                 1.965381e-04 3 1  ON 74
ci_076                 7.839253e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6577
    reference variance = 0.429971
====================================================
  Execution time = 2.5456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5066e-01
  Total weights = 1.9553e+06
  Execution time = 3.6224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440795946123
                                         uncertainty =       0.002184002665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440795946123
                                         uncertainty =       0.002184002665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469482585
  error estimate for blocks of size 2^( 2) =       0.000493282265
  error estimate for blocks of size 2^( 3) =       0.000515748565
  error estimate for blocks of size 2^( 4) =       0.000531745599
  error estimate for blocks of size 2^( 5) =       0.000541245164
  error estimate for blocks of size 2^( 6) =       0.000544853892
  error estimate for blocks of size 2^( 7) =       0.000547188147

      target function =      -0.744736550465
              le_mean =     -22.662430424717
             les_mean =     514.036461519648
             stat err =       0.000541258201
             autocorr =       1.329137788147
   target nu stat err =       0.000541258201
   target dn stat err =       0.003081082535
      target stat err =       0.002593955517
              std dev =       0.663948638427
             le_variance =       0.440827794469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440744607689
                                         uncertainty =       0.002186755553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440744607689
                                         uncertainty =       0.002186755553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469455270
  error estimate for blocks of size 2^( 2) =       0.000493260079
  error estimate for blocks of size 2^( 3) =       0.000515729142
  error estimate for blocks of size 2^( 4) =       0.000531729292
  error estimate for blocks of size 2^( 5) =       0.000541230193
  error estimate for blocks of size 2^( 6) =       0.000544840777
  error estimate for blocks of size 2^( 7) =       0.000547171600

      target function =      -0.742367973648
              le_mean =     -22.662433308900
             les_mean =     514.039486528945
             stat err =       0.000541242966
             autocorr =       1.329217632608
   target nu stat err =       0.000541242966
   target dn stat err =       0.003819745573
      target stat err =       0.003166236526
              std dev =       0.663910009111
             le_variance =       0.440776500198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440766864206
                                         uncertainty =       0.002185384057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440766864206
                                         uncertainty =       0.002185384057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469467111
  error estimate for blocks of size 2^( 2) =       0.000493269505
  error estimate for blocks of size 2^( 3) =       0.000515737174
  error estimate for blocks of size 2^( 4) =       0.000531735906
  error estimate for blocks of size 2^( 5) =       0.000541236242
  error estimate for blocks of size 2^( 6) =       0.000544845435
  error estimate for blocks of size 2^( 7) =       0.000547178225

      target function =      -0.744662697978
              le_mean =     -22.662431566979
             les_mean =     514.036603651980
             stat err =       0.000541248952
             autocorr =       1.329179982193
   target nu stat err =       0.000541248952
   target dn stat err =       0.003049846317
      target stat err =       0.002568556234
              std dev =       0.663926754955
             le_variance =       0.440798735946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440792022162
                                         uncertainty =       0.002184172581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440792022162
                                         uncertainty =       0.002184172581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469480497
  error estimate for blocks of size 2^( 2) =       0.000493280524
  error estimate for blocks of size 2^( 3) =       0.000515746994
  error estimate for blocks of size 2^( 4) =       0.000531744244
  error estimate for blocks of size 2^( 5) =       0.000541243919
  error estimate for blocks of size 2^( 6) =       0.000544852697
  error estimate for blocks of size 2^( 7) =       0.000547186762

      target function =      -0.744757606016
              le_mean =     -22.662430541377
             les_mean =     514.036441152332
             stat err =       0.000541256906
             autocorr =       1.329143249813
   target nu stat err =       0.000541256906
   target dn stat err =       0.003075193315
      target stat err =       0.002589401517
              std dev =       0.663945685669
             le_variance =       0.440823873518


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744736550465        initial
     6.2500e-01     6.2500e+00             3.6856e-04        -0.742367973648
     2.5000e+00     2.5000e+01             9.2162e-05        -0.744662697978
     1.0000e+01     1.0000e+02             2.3030e-05        -0.744757606016  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.3642e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_001                -7.056499e-01 3 1  ON 0
ci_002                -7.028310e-01 3 1  ON 1
ci_003                -5.012774e-02 3 1  ON 2
ci_004                -5.101621e-02 3 1  ON 3
ci_005                 1.951791e-02 3 1  ON 4
ci_006                 1.987499e-02 3 1  ON 5
ci_007                 1.472641e-02 3 1  ON 6
ci_008                 1.559508e-02 3 1  ON 7
ci_009                -1.325634e-02 3 1  ON 8
ci_010                -1.212088e-02 3 1  ON 9
ci_011                -9.934377e-03 3 1  ON 10
ci_012                -9.133033e-03 3 1  ON 11
ci_013                 8.388361e-03 3 1  ON 12
ci_014                 9.410256e-03 3 1  ON 13
ci_015                 9.536195e-03 3 1  ON 14
ci_016                 9.480867e-03 3 1  ON 15
ci_017                 8.511251e-03 3 1  ON 16
ci_018                 8.345548e-03 3 1  ON 17
ci_019                -1.139987e-03 3 1  ON 18
ci_020                -1.452201e-03 3 1  ON 19
ci_021                -1.175226e-02 3 1  ON 20
ci_022                -1.173076e-02 3 1  ON 21
ci_023                 4.850194e-03 3 1  ON 22
ci_024                 4.949841e-03 3 1  ON 23
ci_025                 1.135684e-02 3 1  ON 24
ci_026                 1.139076e-02 3 1  ON 25
ci_027                 6.498127e-03 3 1  ON 26
ci_028                 6.211181e-03 3 1  ON 27
ci_029                -5.136903e-03 3 1  ON 28
ci_030                -4.168408e-03 3 1  ON 29
ci_031                 3.267670e-03 3 1  ON 30
ci_032                 4.492310e-03 3 1  ON 31
ci_033                 2.352642e-03 3 1  ON 32
ci_034                 4.165735e-03 3 1  ON 33
ci_035                 1.730171e-03 3 1  ON 34
ci_036                 2.168157e-03 3 1  ON 35
ci_037                 3.554576e-03 3 1  ON 36
ci_038                 3.715764e-03 3 1  ON 37
ci_039                 4.634412e-03 3 1  ON 38
ci_040                 4.942160e-03 3 1  ON 39
ci_041                 2.973893e-03 3 1  ON 40
ci_042                 2.749904e-03 3 1  ON 41
ci_043                 2.981523e-03 3 1  ON 42
ci_044                 3.190417e-03 3 1  ON 43
ci_045                 2.439757e-03 3 1  ON 44
ci_046                 2.717215e-03 3 1  ON 45
ci_047                -9.904575e-04 3 1  ON 46
ci_048                -8.350705e-04 3 1  ON 47
ci_049                 7.634214e-04 3 1  ON 48
ci_050                 1.015961e-03 3 1  ON 49
ci_051                -3.128056e-04 3 1  ON 50
ci_052                -1.218143e-03 3 1  ON 51
ci_053                -2.433647e-03 3 1  ON 52
ci_054                -2.706224e-03 3 1  ON 53
ci_055                -1.808821e-03 3 1  ON 54
ci_056                -1.920942e-03 3 1  ON 55
ci_057                -1.318453e-03 3 1  ON 56
ci_058                -9.748740e-04 3 1  ON 57
ci_059                -5.571819e-04 3 1  ON 58
ci_060                -7.699638e-04 3 1  ON 59
ci_061                -7.051275e-05 3 1  ON 60
ci_062                -9.327646e-04 3 1  ON 61
ci_063                -8.884342e-04 3 1  ON 62
ci_064                -5.178866e-04 3 1  ON 63
ci_065                -1.353709e-03 3 1  ON 64
ci_066                -1.911931e-03 3 1  ON 65
ci_067                -1.814551e-03 3 1  ON 66
ci_068                -1.571971e-03 3 1  ON 67
ci_069                -5.610205e-04 3 1  ON 68
ci_070                -4.295423e-04 3 1  ON 69
ci_071                -2.080064e-03 3 1  ON 70
ci_072                -2.016280e-03 3 1  ON 71
ci_073                 1.420689e-04 3 1  ON 72
ci_074                 2.060032e-04 3 1  ON 73
ci_075                 1.897636e-04 3 1  ON 74
ci_076                 7.941249e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4371e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.702
    reference variance = 0.351991
====================================================
  Execution time = 2.6071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4797e-01
  Total weights = 1.955394145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438800912484
                                         uncertainty =       0.001894648924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438800912484
                                         uncertainty =       0.001894648924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468522194
  error estimate for blocks of size 2^( 2) =       0.000491949983
  error estimate for blocks of size 2^( 3) =       0.000514174053
  error estimate for blocks of size 2^( 4) =       0.000530385436
  error estimate for blocks of size 2^( 5) =       0.000538704822
  error estimate for blocks of size 2^( 6) =       0.000544546136
  error estimate for blocks of size 2^( 7) =       0.000543819967

      target function =      -0.746975614369
              le_mean =     -22.661396925016
             les_mean =     513.986880722953
             stat err =       0.000539364090
             autocorr =       1.325268027201
   target nu stat err =       0.000539364090
   target dn stat err =       0.002701782802
      target stat err =       0.002301845362
              std dev =       0.662590441382
             le_variance =       0.439026093011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266139692502e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746981851109       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746990183851       residual = 3.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746991819009       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746991910148       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746991949216       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746991991836       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746991994532       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746991993272       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746991999840       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746992000465       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746991999141       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 6.615774e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746981851109       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746983964480       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746984375987       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746984398708       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746984408506       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746984419105       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746984419686       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746984419356       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746984420959       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746984421108       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746984420779       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.672952e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746981851109       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746982381373       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746982484419       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746982490095       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746982492547       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746982495193       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746982495332       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746982495249       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746982495647       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746982495684       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746982495602       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 4.194431e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025814 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0846e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_001                -7.056370e-01 3 1  ON 0
ci_002                -7.028455e-01 3 1  ON 1
ci_003                -5.012862e-02 3 1  ON 2
ci_004                -5.101198e-02 3 1  ON 3
ci_005                 1.951315e-02 3 1  ON 4
ci_006                 1.986168e-02 3 1  ON 5
ci_007                 1.473320e-02 3 1  ON 6
ci_008                 1.558388e-02 3 1  ON 7
ci_009                -1.324481e-02 3 1  ON 8
ci_010                -1.211182e-02 3 1  ON 9
ci_011                -9.929923e-03 3 1  ON 10
ci_012                -9.125599e-03 3 1  ON 11
ci_013                 8.380767e-03 3 1  ON 12
ci_014                 9.403162e-03 3 1  ON 13
ci_015                 9.533277e-03 3 1  ON 14
ci_016                 9.467671e-03 3 1  ON 15
ci_017                 8.506758e-03 3 1  ON 16
ci_018                 8.330847e-03 3 1  ON 17
ci_019                -1.155753e-03 3 1  ON 18
ci_020                -1.468931e-03 3 1  ON 19
ci_021                -1.175657e-02 3 1  ON 20
ci_022                -1.174474e-02 3 1  ON 21
ci_023                 4.852331e-03 3 1  ON 22
ci_024                 4.943122e-03 3 1  ON 23
ci_025                 1.137057e-02 3 1  ON 24
ci_026                 1.140703e-02 3 1  ON 25
ci_027                 6.490709e-03 3 1  ON 26
ci_028                 6.208620e-03 3 1  ON 27
ci_029                -5.123502e-03 3 1  ON 28
ci_030                -4.168051e-03 3 1  ON 29
ci_031                 3.280729e-03 3 1  ON 30
ci_032                 4.502257e-03 3 1  ON 31
ci_033                 2.356972e-03 3 1  ON 32
ci_034                 4.160415e-03 3 1  ON 33
ci_035                 1.728301e-03 3 1  ON 34
ci_036                 2.164917e-03 3 1  ON 35
ci_037                 3.550999e-03 3 1  ON 36
ci_038                 3.711335e-03 3 1  ON 37
ci_039                 4.633174e-03 3 1  ON 38
ci_040                 4.940313e-03 3 1  ON 39
ci_041                 2.974869e-03 3 1  ON 40
ci_042                 2.745698e-03 3 1  ON 41
ci_043                 2.974074e-03 3 1  ON 42
ci_044                 3.190588e-03 3 1  ON 43
ci_045                 2.441703e-03 3 1  ON 44
ci_046                 2.717092e-03 3 1  ON 45
ci_047                -9.930739e-04 3 1  ON 46
ci_048                -8.348260e-04 3 1  ON 47
ci_049                 7.664657e-04 3 1  ON 48
ci_050                 1.012473e-03 3 1  ON 49
ci_051                -3.121711e-04 3 1  ON 50
ci_052                -1.216713e-03 3 1  ON 51
ci_053                -2.433152e-03 3 1  ON 52
ci_054                -2.701533e-03 3 1  ON 53
ci_055                -1.808408e-03 3 1  ON 54
ci_056                -1.923107e-03 3 1  ON 55
ci_057                -1.315792e-03 3 1  ON 56
ci_058                -9.786876e-04 3 1  ON 57
ci_059                -5.563072e-04 3 1  ON 58
ci_060                -7.673612e-04 3 1  ON 59
ci_061                -6.774693e-05 3 1  ON 60
ci_062                -9.308939e-04 3 1  ON 61
ci_063                -8.884812e-04 3 1  ON 62
ci_064                -5.206307e-04 3 1  ON 63
ci_065                -1.354999e-03 3 1  ON 64
ci_066                -1.901770e-03 3 1  ON 65
ci_067                -1.813754e-03 3 1  ON 66
ci_068                -1.568458e-03 3 1  ON 67
ci_069                -5.584888e-04 3 1  ON 68
ci_070                -4.287567e-04 3 1  ON 69
ci_071                -2.083330e-03 3 1  ON 70
ci_072                -2.014559e-03 3 1  ON 71
ci_073                 1.476290e-04 3 1  ON 72
ci_074                 2.044057e-04 3 1  ON 73
ci_075                 1.827131e-04 3 1  ON 74
ci_076                 7.921047e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.5841
    reference variance = 0.346773
====================================================
  Execution time = 2.5558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4867e-01
  Total weights = 1.9554e+06
  Execution time = 3.6050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439884556448
                                         uncertainty =       0.002376078338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439884556448
                                         uncertainty =       0.002376078338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469011666
  error estimate for blocks of size 2^( 2) =       0.000493023280
  error estimate for blocks of size 2^( 3) =       0.000515192357
  error estimate for blocks of size 2^( 4) =       0.000531141195
  error estimate for blocks of size 2^( 5) =       0.000540471055
  error estimate for blocks of size 2^( 6) =       0.000545131808
  error estimate for blocks of size 2^( 7) =       0.000547890228

      target function =      -0.746472001354
              le_mean =     -22.661552863956
             les_mean =     513.994562601297
             stat err =       0.000541158572
             autocorr =       1.331317966709
   target nu stat err =       0.000541158572
   target dn stat err =       0.002797507419
      target stat err =       0.002375987806
              std dev =       0.663282659011
             le_variance =       0.439943885745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439872830166
                                         uncertainty =       0.002375247598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439872830166
                                         uncertainty =       0.002375247598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469005427
  error estimate for blocks of size 2^( 2) =       0.000493019082
  error estimate for blocks of size 2^( 3) =       0.000515189408
  error estimate for blocks of size 2^( 4) =       0.000531139785
  error estimate for blocks of size 2^( 5) =       0.000540468965
  error estimate for blocks of size 2^( 6) =       0.000545127935
  error estimate for blocks of size 2^( 7) =       0.000547884475

      target function =      -0.746490040789
              le_mean =     -22.661553114433
             les_mean =     513.994552006815
             stat err =       0.000541155290
             autocorr =       1.331337240788
   target nu stat err =       0.000541155290
   target dn stat err =       0.002799145590
      target stat err =       0.002377402899
              std dev =       0.663273835355
             le_variance =       0.439932180667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439878500687
                                         uncertainty =       0.002375653652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439878500687
                                         uncertainty =       0.002375653652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469008444
  error estimate for blocks of size 2^( 2) =       0.000493021091
  error estimate for blocks of size 2^( 3) =       0.000515190803
  error estimate for blocks of size 2^( 4) =       0.000531140418
  error estimate for blocks of size 2^( 5) =       0.000540469932
  error estimate for blocks of size 2^( 6) =       0.000545129776
  error estimate for blocks of size 2^( 7) =       0.000547887242

      target function =      -0.746422978777
              le_mean =     -22.661552974792
             les_mean =     513.994627244850
             stat err =       0.000541156842
             autocorr =       1.331327748467
   target nu stat err =       0.000541156842
   target dn stat err =       0.002799643720
      target stat err =       0.002377385544
              std dev =       0.663278102276
             le_variance =       0.439937840959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439883784074
                                         uncertainty =       0.002376024695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439883784074
                                         uncertainty =       0.002376024695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469011255
  error estimate for blocks of size 2^( 2) =       0.000493022999
  error estimate for blocks of size 2^( 3) =       0.000515192155
  error estimate for blocks of size 2^( 4) =       0.000531141091
  error estimate for blocks of size 2^( 5) =       0.000540470908
  error estimate for blocks of size 2^( 6) =       0.000545131545
  error estimate for blocks of size 2^( 7) =       0.000547889845

      target function =      -0.746471897242
              le_mean =     -22.661552875800
             les_mean =     513.994563264433
             stat err =       0.000541158347
             autocorr =       1.331319194898
   target nu stat err =       0.000541158347
   target dn stat err =       0.002797591962
      target stat err =       0.002376054430
              std dev =       0.663282077823
             le_variance =       0.439943114761


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746472001354        initial
     2.5000e+00     2.5000e+01             6.6158e-05        -0.746490040789  <--
     1.0000e+01     1.0000e+02             1.6730e-05        -0.746422978777
     4.0000e+01     4.0000e+02             4.1944e-06        -0.746471897242

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.3676e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_001                -7.055982e-01 3 1  ON 0
ci_002                -7.028888e-01 3 1  ON 1
ci_003                -5.013129e-02 3 1  ON 2
ci_004                -5.099937e-02 3 1  ON 3
ci_005                 1.949914e-02 3 1  ON 4
ci_006                 1.982256e-02 3 1  ON 5
ci_007                 1.475326e-02 3 1  ON 6
ci_008                 1.555086e-02 3 1  ON 7
ci_009                -1.321078e-02 3 1  ON 8
ci_010                -1.208511e-02 3 1  ON 9
ci_011                -9.916768e-03 3 1  ON 10
ci_012                -9.103697e-03 3 1  ON 11
ci_013                 8.358330e-03 3 1  ON 12
ci_014                 9.382242e-03 3 1  ON 13
ci_015                 9.524666e-03 3 1  ON 14
ci_016                 9.428669e-03 3 1  ON 15
ci_017                 8.493524e-03 3 1  ON 16
ci_018                 8.287439e-03 3 1  ON 17
ci_019                -1.202348e-03 3 1  ON 18
ci_020                -1.518359e-03 3 1  ON 19
ci_021                -1.176930e-02 3 1  ON 20
ci_022                -1.178604e-02 3 1  ON 21
ci_023                 4.858619e-03 3 1  ON 22
ci_024                 4.923346e-03 3 1  ON 23
ci_025                 1.141115e-02 3 1  ON 24
ci_026                 1.145513e-02 3 1  ON 25
ci_027                 6.468900e-03 3 1  ON 26
ci_028                 6.201112e-03 3 1  ON 27
ci_029                -5.083970e-03 3 1  ON 28
ci_030                -4.167007e-03 3 1  ON 29
ci_031                 3.319244e-03 3 1  ON 30
ci_032                 4.531664e-03 3 1  ON 31
ci_033                 2.369744e-03 3 1  ON 32
ci_034                 4.144706e-03 3 1  ON 33
ci_035                 1.722812e-03 3 1  ON 34
ci_036                 2.155384e-03 3 1  ON 35
ci_037                 3.540444e-03 3 1  ON 36
ci_038                 3.698259e-03 3 1  ON 37
ci_039                 4.629572e-03 3 1  ON 38
ci_040                 4.934912e-03 3 1  ON 39
ci_041                 2.977746e-03 3 1  ON 40
ci_042                 2.733347e-03 3 1  ON 41
ci_043                 2.952146e-03 3 1  ON 42
ci_044                 3.191087e-03 3 1  ON 43
ci_045                 2.447441e-03 3 1  ON 44
ci_046                 2.716780e-03 3 1  ON 45
ci_047                -1.000752e-03 3 1  ON 46
ci_048                -8.341036e-04 3 1  ON 47
ci_049                 7.754290e-04 3 1  ON 48
ci_050                 1.002200e-03 3 1  ON 49
ci_051                -3.103223e-04 3 1  ON 50
ci_052                -1.212485e-03 3 1  ON 51
ci_053                -2.431725e-03 3 1  ON 52
ci_054                -2.687711e-03 3 1  ON 53
ci_055                -1.807214e-03 3 1  ON 54
ci_056                -1.929517e-03 3 1  ON 55
ci_057                -1.307952e-03 3 1  ON 56
ci_058                -9.899074e-04 3 1  ON 57
ci_059                -5.537275e-04 3 1  ON 58
ci_060                -7.597100e-04 3 1  ON 59
ci_061                -5.958805e-05 3 1  ON 60
ci_062                -9.253596e-04 3 1  ON 61
ci_063                -8.886421e-04 3 1  ON 62
ci_064                -5.287495e-04 3 1  ON 63
ci_065                -1.358796e-03 3 1  ON 64
ci_066                -1.871784e-03 3 1  ON 65
ci_067                -1.811434e-03 3 1  ON 66
ci_068                -1.558105e-03 3 1  ON 67
ci_069                -5.510324e-04 3 1  ON 68
ci_070                -4.264538e-04 3 1  ON 69
ci_071                -2.092961e-03 3 1  ON 70
ci_072                -2.009482e-03 3 1  ON 71
ci_073                 1.639257e-04 3 1  ON 72
ci_074                 1.997097e-04 3 1  ON 73
ci_075                 1.619718e-04 3 1  ON 74
ci_076                 7.861472e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7429
    reference variance = 0.371787
====================================================
  Execution time = 2.6051e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4848e-01
  Total weights = 1.955094604e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7510e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439549673303
                                         uncertainty =       0.001700565971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439549673303
                                         uncertainty =       0.001700565971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468815622
  error estimate for blocks of size 2^( 2) =       0.000492716037
  error estimate for blocks of size 2^( 3) =       0.000514673385
  error estimate for blocks of size 2^( 4) =       0.000530589602
  error estimate for blocks of size 2^( 5) =       0.000539574550
  error estimate for blocks of size 2^( 6) =       0.000543298447
  error estimate for blocks of size 2^( 7) =       0.000546839696

      target function =      -0.746564405798
              le_mean =     -22.661865313624
             les_mean =     514.008618140470
             stat err =       0.000540075574
             autocorr =       1.327103886453
   target nu stat err =       0.000540075574
   target dn stat err =       0.002504385419
      target stat err =       0.002144715308
              std dev =       0.663005411404
             le_variance =       0.439576175550


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266186531362e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746569647439       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746596552304       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746602239234       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746603013036       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746603102078       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746603251021       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746603301329       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746603340226       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746603326045       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746603327387       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 3.571451e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746569647439       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746576753840       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746578214126       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746578409534       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746578431677       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746578468633       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746578479396       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746578488048       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746578484622       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746578484970       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 9.334494e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746569647439       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746571449502       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746571817003       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746571865961       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746571871487       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746571880702       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746571883276       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746571885372       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746571884525       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746571884613       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.360426e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0812e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_001                -7.055502e-01 3 1  ON 0
ci_002                -7.029386e-01 3 1  ON 1
ci_003                -5.012908e-02 3 1  ON 2
ci_004                -5.101203e-02 3 1  ON 3
ci_005                 1.948784e-02 3 1  ON 4
ci_006                 1.980380e-02 3 1  ON 5
ci_007                 1.472611e-02 3 1  ON 6
ci_008                 1.551498e-02 3 1  ON 7
ci_009                -1.317872e-02 3 1  ON 8
ci_010                -1.206723e-02 3 1  ON 9
ci_011                -9.895322e-03 3 1  ON 10
ci_012                -9.088542e-03 3 1  ON 11
ci_013                 8.325427e-03 3 1  ON 12
ci_014                 9.336643e-03 3 1  ON 13
ci_015                 9.510082e-03 3 1  ON 14
ci_016                 9.368976e-03 3 1  ON 15
ci_017                 8.494592e-03 3 1  ON 16
ci_018                 8.286200e-03 3 1  ON 17
ci_019                -1.277041e-03 3 1  ON 18
ci_020                -1.581306e-03 3 1  ON 19
ci_021                -1.179883e-02 3 1  ON 20
ci_022                -1.183242e-02 3 1  ON 21
ci_023                 4.840731e-03 3 1  ON 22
ci_024                 4.909175e-03 3 1  ON 23
ci_025                 1.150450e-02 3 1  ON 24
ci_026                 1.152026e-02 3 1  ON 25
ci_027                 6.462576e-03 3 1  ON 26
ci_028                 6.149953e-03 3 1  ON 27
ci_029                -5.080466e-03 3 1  ON 28
ci_030                -4.180330e-03 3 1  ON 29
ci_031                 3.353413e-03 3 1  ON 30
ci_032                 4.574081e-03 3 1  ON 31
ci_033                 2.342792e-03 3 1  ON 32
ci_034                 4.112475e-03 3 1  ON 33
ci_035                 1.725078e-03 3 1  ON 34
ci_036                 2.149420e-03 3 1  ON 35
ci_037                 3.536098e-03 3 1  ON 36
ci_038                 3.705144e-03 3 1  ON 37
ci_039                 4.602488e-03 3 1  ON 38
ci_040                 4.936619e-03 3 1  ON 39
ci_041                 2.951226e-03 3 1  ON 40
ci_042                 2.734877e-03 3 1  ON 41
ci_043                 2.923427e-03 3 1  ON 42
ci_044                 3.182596e-03 3 1  ON 43
ci_045                 2.463918e-03 3 1  ON 44
ci_046                 2.733596e-03 3 1  ON 45
ci_047                -1.006619e-03 3 1  ON 46
ci_048                -8.324236e-04 3 1  ON 47
ci_049                 7.888152e-04 3 1  ON 48
ci_050                 9.762630e-04 3 1  ON 49
ci_051                -3.261237e-04 3 1  ON 50
ci_052                -1.207691e-03 3 1  ON 51
ci_053                -2.440680e-03 3 1  ON 52
ci_054                -2.694913e-03 3 1  ON 53
ci_055                -1.773884e-03 3 1  ON 54
ci_056                -1.927481e-03 3 1  ON 55
ci_057                -1.305863e-03 3 1  ON 56
ci_058                -9.843297e-04 3 1  ON 57
ci_059                -5.437160e-04 3 1  ON 58
ci_060                -7.609225e-04 3 1  ON 59
ci_061                -2.626885e-05 3 1  ON 60
ci_062                -9.087431e-04 3 1  ON 61
ci_063                -8.785541e-04 3 1  ON 62
ci_064                -5.104492e-04 3 1  ON 63
ci_065                -1.361757e-03 3 1  ON 64
ci_066                -1.919621e-03 3 1  ON 65
ci_067                -1.816840e-03 3 1  ON 66
ci_068                -1.554658e-03 3 1  ON 67
ci_069                -5.634784e-04 3 1  ON 68
ci_070                -4.261203e-04 3 1  ON 69
ci_071                -2.075130e-03 3 1  ON 70
ci_072                -1.975940e-03 3 1  ON 71
ci_073                 1.533978e-04 3 1  ON 72
ci_074                 1.914975e-04 3 1  ON 73
ci_075                 1.606259e-04 3 1  ON 74
ci_076                 7.814212e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6532
    reference variance = 0.520903
====================================================
  Execution time = 2.5482e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5190e-01
  Total weights = 1.9550e+06
  Execution time = 3.6205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443051112401
                                         uncertainty =       0.001684428534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443051112401
                                         uncertainty =       0.001684428534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470629089
  error estimate for blocks of size 2^( 2) =       0.000495264855
  error estimate for blocks of size 2^( 3) =       0.000517511461
  error estimate for blocks of size 2^( 4) =       0.000534118870
  error estimate for blocks of size 2^( 5) =       0.000542774314
  error estimate for blocks of size 2^( 6) =       0.000545544227
  error estimate for blocks of size 2^( 7) =       0.000549249542

      target function =      -0.743755453308
              le_mean =     -22.662454945144
             les_mean =     514.038774436460
             stat err =       0.000542921738
             autocorr =       1.330812673913
   target nu stat err =       0.000542921738
   target dn stat err =       0.002711476510
      target stat err =       0.002294935636
              std dev =       0.665570040515
             le_variance =       0.442983478832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442999837592
                                         uncertainty =       0.001683201232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442999837592
                                         uncertainty =       0.001683201232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470601746
  error estimate for blocks of size 2^( 2) =       0.000495242360
  error estimate for blocks of size 2^( 3) =       0.000517494718
  error estimate for blocks of size 2^( 4) =       0.000534104977
  error estimate for blocks of size 2^( 5) =       0.000542763998
  error estimate for blocks of size 2^( 6) =       0.000545536005
  error estimate for blocks of size 2^( 7) =       0.000549234466

      target function =      -0.743619905234
              le_mean =     -22.662457289656
             les_mean =     514.039046582387
             stat err =       0.000542909862
             autocorr =       1.330909093474
   target nu stat err =       0.000542909862
   target dn stat err =       0.002715659011
      target stat err =       0.002297431784
              std dev =       0.665531371739
             le_variance =       0.442932006768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443022198015
                                         uncertainty =       0.001683741812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443022198015
                                         uncertainty =       0.001683741812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470613676
  error estimate for blocks of size 2^( 2) =       0.000495252059
  error estimate for blocks of size 2^( 3) =       0.000517501766
  error estimate for blocks of size 2^( 4) =       0.000534110702
  error estimate for blocks of size 2^( 5) =       0.000542768112
  error estimate for blocks of size 2^( 6) =       0.000545539085
  error estimate for blocks of size 2^( 7) =       0.000549240902

      target function =      -0.743728858915
              le_mean =     -22.662455894617
             les_mean =     514.038850025502
             stat err =       0.000542914700
             autocorr =       1.330865341116
   target nu stat err =       0.000542914700
   target dn stat err =       0.002710877470
      target stat err =       0.002294305549
              std dev =       0.665548242798
             le_variance =       0.442954463492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443047202786
                                         uncertainty =       0.001684335582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443047202786
                                         uncertainty =       0.001684335582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470627006
  error estimate for blocks of size 2^( 2) =       0.000495263108
  error estimate for blocks of size 2^( 3) =       0.000517510109
  error estimate for blocks of size 2^( 4) =       0.000534117714
  error estimate for blocks of size 2^( 5) =       0.000542773423
  error estimate for blocks of size 2^( 6) =       0.000545543478
  error estimate for blocks of size 2^( 7) =       0.000549248366

      target function =      -0.743763448805
              le_mean =     -22.662455029994
             les_mean =     514.038768502199
             stat err =       0.000542920745
             autocorr =       1.330819588275
   target nu stat err =       0.000542920745
   target dn stat err =       0.002711090250
      target stat err =       0.002294678476
              std dev =       0.665567094000
             le_variance =       0.442979556616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743755453308        initial
     6.2500e-01     6.2500e+00             3.5715e-04        -0.743619905234
     2.5000e+00     2.5000e+01             9.3345e-05        -0.743728858915
     1.0000e+01     1.0000e+02             2.3604e-05        -0.743763448805  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.3661e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_001                -7.055862e-01 3 1  ON 0
ci_002                -7.029012e-01 3 1  ON 1
ci_003                -5.013073e-02 3 1  ON 2
ci_004                -5.100252e-02 3 1  ON 3
ci_005                 1.949628e-02 3 1  ON 4
ci_006                 1.981780e-02 3 1  ON 5
ci_007                 1.474639e-02 3 1  ON 6
ci_008                 1.554177e-02 3 1  ON 7
ci_009                -1.320266e-02 3 1  ON 8
ci_010                -1.208057e-02 3 1  ON 9
ci_011                -9.911344e-03 3 1  ON 10
ci_012                -9.099853e-03 3 1  ON 11
ci_013                 8.350004e-03 3 1  ON 12
ci_014                 9.370702e-03 3 1  ON 13
ci_015                 9.520981e-03 3 1  ON 14
ci_016                 9.413580e-03 3 1  ON 15
ci_017                 8.493789e-03 3 1  ON 16
ci_018                 8.287124e-03 3 1  ON 17
ci_019                -1.221232e-03 3 1  ON 18
ci_020                -1.534275e-03 3 1  ON 19
ci_021                -1.177677e-02 3 1  ON 20
ci_022                -1.179777e-02 3 1  ON 21
ci_023                 4.854081e-03 3 1  ON 22
ci_024                 4.919749e-03 3 1  ON 23
ci_025                 1.143476e-02 3 1  ON 24
ci_026                 1.147160e-02 3 1  ON 25
ci_027                 6.467295e-03 3 1  ON 26
ci_028                 6.188116e-03 3 1  ON 27
ci_029                -5.083087e-03 3 1  ON 28
ci_030                -4.170392e-03 3 1  ON 29
ci_031                 3.327885e-03 3 1  ON 30
ci_032                 4.542392e-03 3 1  ON 31
ci_033                 2.362928e-03 3 1  ON 32
ci_034                 4.136555e-03 3 1  ON 33
ci_035                 1.723390e-03 3 1  ON 34
ci_036                 2.153868e-03 3 1  ON 35
ci_037                 3.539345e-03 3 1  ON 36
ci_038                 3.700009e-03 3 1  ON 37
ci_039                 4.622695e-03 3 1  ON 38
ci_040                 4.935343e-03 3 1  ON 39
ci_041                 2.971017e-03 3 1  ON 40
ci_042                 2.733733e-03 3 1  ON 41
ci_043                 2.944881e-03 3 1  ON 42
ci_044                 3.188943e-03 3 1  ON 43
ci_045                 2.451610e-03 3 1  ON 44
ci_046                 2.721029e-03 3 1  ON 45
ci_047                -1.002242e-03 3 1  ON 46
ci_048                -8.336791e-04 3 1  ON 47
ci_049                 7.788243e-04 3 1  ON 48
ci_050                 9.956270e-04 3 1  ON 49
ci_051                -3.143239e-04 3 1  ON 50
ci_052                -1.211265e-03 3 1  ON 51
ci_053                -2.433985e-03 3 1  ON 52
ci_054                -2.689530e-03 3 1  ON 53
ci_055                -1.798776e-03 3 1  ON 54
ci_056                -1.928996e-03 3 1  ON 55
ci_057                -1.307423e-03 3 1  ON 56
ci_058                -9.884940e-04 3 1  ON 57
ci_059                -5.511908e-04 3 1  ON 58
ci_060                -7.600184e-04 3 1  ON 59
ci_061                -5.115325e-05 3 1  ON 60
ci_062                -9.211528e-04 3 1  ON 61
ci_063                -8.860797e-04 3 1  ON 62
ci_064                -5.241028e-04 3 1  ON 63
ci_065                -1.359548e-03 3 1  ON 64
ci_066                -1.883911e-03 3 1  ON 65
ci_067                -1.812803e-03 3 1  ON 66
ci_068                -1.557233e-03 3 1  ON 67
ci_069                -5.541928e-04 3 1  ON 68
ci_070                -4.263716e-04 3 1  ON 69
ci_071                -2.088455e-03 3 1  ON 70
ci_072                -2.000985e-03 3 1  ON 71
ci_073                 1.612568e-04 3 1  ON 72
ci_074                 1.976243e-04 3 1  ON 73
ci_075                 1.616243e-04 3 1  ON 74
ci_076                 7.849485e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7124
    reference variance = 0.502521
====================================================
  Execution time = 2.8063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4712e-01
  Total weights = 1.955299251e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438874156899
                                         uncertainty =       0.001816002401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438874156899
                                         uncertainty =       0.001816002401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468433413
  error estimate for blocks of size 2^( 2) =       0.000493027794
  error estimate for blocks of size 2^( 3) =       0.000515287240
  error estimate for blocks of size 2^( 4) =       0.000531634672
  error estimate for blocks of size 2^( 5) =       0.000542256447
  error estimate for blocks of size 2^( 6) =       0.000548049442
  error estimate for blocks of size 2^( 7) =       0.000549167308

      target function =      -0.747683458503
              le_mean =     -22.661576801219
             les_mean =     513.994179554113
             stat err =       0.000542776967
             autocorr =       1.342601379451
   target nu stat err =       0.000542776967
   target dn stat err =       0.002309292490
      target stat err =       0.001996752079
              std dev =       0.662464886133
             le_variance =       0.438859725359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266157680122e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747687878573       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747695674901       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747696897812       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747697084500       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747697053849       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747697079203       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747697073777       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747697087288       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747697082449       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747697080263       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747697077275       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747697078283       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.191555e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747687878573       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747689855179       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747690162559       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747690210220       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747690202470       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747690208805       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747690207439       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747690210767       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747690209557       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747690209011       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747690208283       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747690208530       residual = 2.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 3.013801e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747687878573       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747688374475       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747688451423       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747688463401       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747688461458       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747688463042       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747688462700       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747688463529       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747688463226       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747688463089       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747688462909       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747688462970       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 7.556643e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2778e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_001                -7.055804e-01 3 1  ON 0
ci_002                -7.029080e-01 3 1  ON 1
ci_003                -5.013352e-02 3 1  ON 2
ci_004                -5.099887e-02 3 1  ON 3
ci_005                 1.948390e-02 3 1  ON 4
ci_006                 1.981176e-02 3 1  ON 5
ci_007                 1.474269e-02 3 1  ON 6
ci_008                 1.553745e-02 3 1  ON 7
ci_009                -1.320123e-02 3 1  ON 8
ci_010                -1.207727e-02 3 1  ON 9
ci_011                -9.906697e-03 3 1  ON 10
ci_012                -9.102112e-03 3 1  ON 11
ci_013                 8.344323e-03 3 1  ON 12
ci_014                 9.363381e-03 3 1  ON 13
ci_015                 9.519483e-03 3 1  ON 14
ci_016                 9.404550e-03 3 1  ON 15
ci_017                 8.487679e-03 3 1  ON 16
ci_018                 8.283245e-03 3 1  ON 17
ci_019                -1.251370e-03 3 1  ON 18
ci_020                -1.541094e-03 3 1  ON 19
ci_021                -1.177632e-02 3 1  ON 20
ci_022                -1.180628e-02 3 1  ON 21
ci_023                 4.851740e-03 3 1  ON 22
ci_024                 4.918672e-03 3 1  ON 23
ci_025                 1.143889e-02 3 1  ON 24
ci_026                 1.147878e-02 3 1  ON 25
ci_027                 6.466167e-03 3 1  ON 26
ci_028                 6.189386e-03 3 1  ON 27
ci_029                -5.075365e-03 3 1  ON 28
ci_030                -4.168227e-03 3 1  ON 29
ci_031                 3.339293e-03 3 1  ON 30
ci_032                 4.551406e-03 3 1  ON 31
ci_033                 2.369022e-03 3 1  ON 32
ci_034                 4.125804e-03 3 1  ON 33
ci_035                 1.727179e-03 3 1  ON 34
ci_036                 2.155362e-03 3 1  ON 35
ci_037                 3.542337e-03 3 1  ON 36
ci_038                 3.697159e-03 3 1  ON 37
ci_039                 4.618986e-03 3 1  ON 38
ci_040                 4.933804e-03 3 1  ON 39
ci_041                 2.971350e-03 3 1  ON 40
ci_042                 2.740769e-03 3 1  ON 41
ci_043                 2.936715e-03 3 1  ON 42
ci_044                 3.184641e-03 3 1  ON 43
ci_045                 2.457036e-03 3 1  ON 44
ci_046                 2.728291e-03 3 1  ON 45
ci_047                -1.000789e-03 3 1  ON 46
ci_048                -8.338913e-04 3 1  ON 47
ci_049                 7.745618e-04 3 1  ON 48
ci_050                 9.941491e-04 3 1  ON 49
ci_051                -3.201817e-04 3 1  ON 50
ci_052                -1.213185e-03 3 1  ON 51
ci_053                -2.432706e-03 3 1  ON 52
ci_054                -2.682490e-03 3 1  ON 53
ci_055                -1.794414e-03 3 1  ON 54
ci_056                -1.927335e-03 3 1  ON 55
ci_057                -1.303414e-03 3 1  ON 56
ci_058                -9.876104e-04 3 1  ON 57
ci_059                -5.495259e-04 3 1  ON 58
ci_060                -7.594409e-04 3 1  ON 59
ci_061                -5.238421e-05 3 1  ON 60
ci_062                -9.264161e-04 3 1  ON 61
ci_063                -8.820877e-04 3 1  ON 62
ci_064                -5.271949e-04 3 1  ON 63
ci_065                -1.367559e-03 3 1  ON 64
ci_066                -1.890464e-03 3 1  ON 65
ci_067                -1.804287e-03 3 1  ON 66
ci_068                -1.556025e-03 3 1  ON 67
ci_069                -5.568615e-04 3 1  ON 68
ci_070                -4.210855e-04 3 1  ON 69
ci_071                -2.081719e-03 3 1  ON 70
ci_072                -2.003981e-03 3 1  ON 71
ci_073                 1.612905e-04 3 1  ON 72
ci_074                 2.038247e-04 3 1  ON 73
ci_075                 1.646666e-04 3 1  ON 74
ci_076                 7.709093e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6044
    reference variance = 0.452319
====================================================
  Execution time = 2.5338e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6418e-01
  Total weights = 1.9553e+06
  Execution time = 3.6208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442922768726
                                         uncertainty =       0.002260154955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442922768726
                                         uncertainty =       0.002260154955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470606409
  error estimate for blocks of size 2^( 2) =       0.000494751716
  error estimate for blocks of size 2^( 3) =       0.000517466065
  error estimate for blocks of size 2^( 4) =       0.000533834263
  error estimate for blocks of size 2^( 5) =       0.000543963962
  error estimate for blocks of size 2^( 6) =       0.000549003404
  error estimate for blocks of size 2^( 7) =       0.000549012187

      target function =      -0.733890383368
              le_mean =     -22.661971898496
             les_mean =     514.029054393896
             stat err =       0.000543953454
             autocorr =       1.336004137716
   target nu stat err =       0.000543953454
   target dn stat err =       0.008109042350
      target stat err =       0.006475431494
              std dev =       0.665537965708
             le_variance =       0.442940783799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442905083281
                                         uncertainty =       0.002260581826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442905083281
                                         uncertainty =       0.002260581826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470597028
  error estimate for blocks of size 2^( 2) =       0.000494744086
  error estimate for blocks of size 2^( 3) =       0.000517459925
  error estimate for blocks of size 2^( 4) =       0.000533829231
  error estimate for blocks of size 2^( 5) =       0.000543959203
  error estimate for blocks of size 2^( 6) =       0.000548996996
  error estimate for blocks of size 2^( 7) =       0.000549004649

      target function =      -0.733502185092
              le_mean =     -22.661972347196
             les_mean =     514.029560625390
             stat err =       0.000543947519
             autocorr =       1.336028249248
   target nu stat err =       0.000543947519
   target dn stat err =       0.008255165224
      target stat err =       0.006584237376
              std dev =       0.665524699399
             le_variance =       0.442923125510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442913691646
                                         uncertainty =       0.002260368107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442913691646
                                         uncertainty =       0.002260368107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470601594
  error estimate for blocks of size 2^( 2) =       0.000494747796
  error estimate for blocks of size 2^( 3) =       0.000517462908
  error estimate for blocks of size 2^( 4) =       0.000533831667
  error estimate for blocks of size 2^( 5) =       0.000543961493
  error estimate for blocks of size 2^( 6) =       0.000549000113
  error estimate for blocks of size 2^( 7) =       0.000549008331

      target function =      -0.733722972722
              le_mean =     -22.661972108464
             les_mean =     514.029273284075
             stat err =       0.000543950401
             autocorr =       1.336016478835
   target nu stat err =       0.000543950401
   target dn stat err =       0.008178286470
      target stat err =       0.006527313130
              std dev =       0.665531156665
             le_variance =       0.442931720492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442921616932
                                         uncertainty =       0.002260181244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442921616932
                                         uncertainty =       0.002260181244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470605798
  error estimate for blocks of size 2^( 2) =       0.000494751218
  error estimate for blocks of size 2^( 3) =       0.000517465663
  error estimate for blocks of size 2^( 4) =       0.000533833932
  error estimate for blocks of size 2^( 5) =       0.000543963645
  error estimate for blocks of size 2^( 6) =       0.000549002986
  error estimate for blocks of size 2^( 7) =       0.000549011699

      target function =      -0.733872286398
              le_mean =     -22.661971922865
             les_mean =     514.029078113366
             stat err =       0.000543953065
             autocorr =       1.336005697723
   target nu stat err =       0.000543953065
   target dn stat err =       0.008117322955
      target stat err =       0.006481672010
              std dev =       0.665537101697
             le_variance =       0.442939633736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.733890383368        initial  <--
     2.5000e+00     2.5000e+01             1.1916e-04        -0.733502185092
     1.0000e+01     1.0000e+02             3.0138e-05        -0.733722972722
     4.0000e+01     4.0000e+02             7.5566e-06        -0.733872286398

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.9224
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_001                -7.055862e-01 3 1  ON 0
ci_002                -7.029012e-01 3 1  ON 1
ci_003                -5.013073e-02 3 1  ON 2
ci_004                -5.100252e-02 3 1  ON 3
ci_005                 1.949628e-02 3 1  ON 4
ci_006                 1.981780e-02 3 1  ON 5
ci_007                 1.474639e-02 3 1  ON 6
ci_008                 1.554177e-02 3 1  ON 7
ci_009                -1.320266e-02 3 1  ON 8
ci_010                -1.208057e-02 3 1  ON 9
ci_011                -9.911344e-03 3 1  ON 10
ci_012                -9.099853e-03 3 1  ON 11
ci_013                 8.350004e-03 3 1  ON 12
ci_014                 9.370702e-03 3 1  ON 13
ci_015                 9.520981e-03 3 1  ON 14
ci_016                 9.413580e-03 3 1  ON 15
ci_017                 8.493789e-03 3 1  ON 16
ci_018                 8.287124e-03 3 1  ON 17
ci_019                -1.221232e-03 3 1  ON 18
ci_020                -1.534275e-03 3 1  ON 19
ci_021                -1.177677e-02 3 1  ON 20
ci_022                -1.179777e-02 3 1  ON 21
ci_023                 4.854081e-03 3 1  ON 22
ci_024                 4.919749e-03 3 1  ON 23
ci_025                 1.143476e-02 3 1  ON 24
ci_026                 1.147160e-02 3 1  ON 25
ci_027                 6.467295e-03 3 1  ON 26
ci_028                 6.188116e-03 3 1  ON 27
ci_029                -5.083087e-03 3 1  ON 28
ci_030                -4.170392e-03 3 1  ON 29
ci_031                 3.327885e-03 3 1  ON 30
ci_032                 4.542392e-03 3 1  ON 31
ci_033                 2.362928e-03 3 1  ON 32
ci_034                 4.136555e-03 3 1  ON 33
ci_035                 1.723390e-03 3 1  ON 34
ci_036                 2.153868e-03 3 1  ON 35
ci_037                 3.539345e-03 3 1  ON 36
ci_038                 3.700009e-03 3 1  ON 37
ci_039                 4.622695e-03 3 1  ON 38
ci_040                 4.935343e-03 3 1  ON 39
ci_041                 2.971017e-03 3 1  ON 40
ci_042                 2.733733e-03 3 1  ON 41
ci_043                 2.944881e-03 3 1  ON 42
ci_044                 3.188943e-03 3 1  ON 43
ci_045                 2.451610e-03 3 1  ON 44
ci_046                 2.721029e-03 3 1  ON 45
ci_047                -1.002242e-03 3 1  ON 46
ci_048                -8.336791e-04 3 1  ON 47
ci_049                 7.788243e-04 3 1  ON 48
ci_050                 9.956270e-04 3 1  ON 49
ci_051                -3.143239e-04 3 1  ON 50
ci_052                -1.211265e-03 3 1  ON 51
ci_053                -2.433985e-03 3 1  ON 52
ci_054                -2.689530e-03 3 1  ON 53
ci_055                -1.798776e-03 3 1  ON 54
ci_056                -1.928996e-03 3 1  ON 55
ci_057                -1.307423e-03 3 1  ON 56
ci_058                -9.884940e-04 3 1  ON 57
ci_059                -5.511908e-04 3 1  ON 58
ci_060                -7.600184e-04 3 1  ON 59
ci_061                -5.115325e-05 3 1  ON 60
ci_062                -9.211528e-04 3 1  ON 61
ci_063                -8.860797e-04 3 1  ON 62
ci_064                -5.241028e-04 3 1  ON 63
ci_065                -1.359548e-03 3 1  ON 64
ci_066                -1.883911e-03 3 1  ON 65
ci_067                -1.812803e-03 3 1  ON 66
ci_068                -1.557233e-03 3 1  ON 67
ci_069                -5.541928e-04 3 1  ON 68
ci_070                -4.263716e-04 3 1  ON 69
ci_071                -2.088455e-03 3 1  ON 70
ci_072                -2.000985e-03 3 1  ON 71
ci_073                 1.612568e-04 3 1  ON 72
ci_074                 1.976243e-04 3 1  ON 73
ci_075                 1.616243e-04 3 1  ON 74
ci_076                 7.849485e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7295
    reference variance = 0.276888
====================================================
  Execution time = 2.6061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4819e-01
  Total weights = 1.955133115e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437941839426
                                         uncertainty =       0.002160695614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437941839426
                                         uncertainty =       0.002160695614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467947513
  error estimate for blocks of size 2^( 2) =       0.000492103437
  error estimate for blocks of size 2^( 3) =       0.000513890476
  error estimate for blocks of size 2^( 4) =       0.000529121554
  error estimate for blocks of size 2^( 5) =       0.000537754423
  error estimate for blocks of size 2^( 6) =       0.000540668457
  error estimate for blocks of size 2^( 7) =       0.000544654108

      target function =      -0.746796688283
              le_mean =     -22.661558134625
             les_mean =     513.994404441062
             stat err =       0.000538049636
             autocorr =       1.322057660727
   target nu stat err =       0.000538049636
   target dn stat err =       0.003161242125
      target stat err =       0.002668057633
              std dev =       0.661777718807
             le_variance =       0.437949749109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266155813463e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746805303577       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746806142966       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746806265031       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746806289602       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746806297107       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746806298924       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746806297825       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746806298620       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746806299206       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746806299043       residual = 7.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746806299155       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746806299062       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 8.351629e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746805303577       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746805513730       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746805544269       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746805550414       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746805552290       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746805552743       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746805552468       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746805552666       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746805552813       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746805552772       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746805552799       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746805552776       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+02 is 2.090653e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746805303577       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746805356135       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746805363771       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746805365307       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746805365776       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746805365890       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746805365820       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746805365869       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746805365907       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746805365897       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746805365903       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746805365898       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+02 is 5.228352e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0820e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_001                -7.055852e-01 3 1  ON 0
ci_002                -7.029025e-01 3 1  ON 1
ci_003                -5.013023e-02 3 1  ON 2
ci_004                -5.100141e-02 3 1  ON 3
ci_005                 1.949582e-02 3 1  ON 4
ci_006                 1.981703e-02 3 1  ON 5
ci_007                 1.474636e-02 3 1  ON 6
ci_008                 1.554082e-02 3 1  ON 7
ci_009                -1.320139e-02 3 1  ON 8
ci_010                -1.208054e-02 3 1  ON 9
ci_011                -9.910446e-03 3 1  ON 10
ci_012                -9.100186e-03 3 1  ON 11
ci_013                 8.347913e-03 3 1  ON 12
ci_014                 9.369539e-03 3 1  ON 13
ci_015                 9.519995e-03 3 1  ON 14
ci_016                 9.413292e-03 3 1  ON 15
ci_017                 8.493061e-03 3 1  ON 16
ci_018                 8.287766e-03 3 1  ON 17
ci_019                -1.222711e-03 3 1  ON 18
ci_020                -1.535086e-03 3 1  ON 19
ci_021                -1.177676e-02 3 1  ON 20
ci_022                -1.179894e-02 3 1  ON 21
ci_023                 4.853454e-03 3 1  ON 22
ci_024                 4.920240e-03 3 1  ON 23
ci_025                 1.143451e-02 3 1  ON 24
ci_026                 1.147240e-02 3 1  ON 25
ci_027                 6.466486e-03 3 1  ON 26
ci_028                 6.187553e-03 3 1  ON 27
ci_029                -5.081985e-03 3 1  ON 28
ci_030                -4.169223e-03 3 1  ON 29
ci_031                 3.327904e-03 3 1  ON 30
ci_032                 4.542876e-03 3 1  ON 31
ci_033                 2.363580e-03 3 1  ON 32
ci_034                 4.135756e-03 3 1  ON 33
ci_035                 1.722878e-03 3 1  ON 34
ci_036                 2.153506e-03 3 1  ON 35
ci_037                 3.539070e-03 3 1  ON 36
ci_038                 3.699575e-03 3 1  ON 37
ci_039                 4.622373e-03 3 1  ON 38
ci_040                 4.935280e-03 3 1  ON 39
ci_041                 2.971039e-03 3 1  ON 40
ci_042                 2.733910e-03 3 1  ON 41
ci_043                 2.944411e-03 3 1  ON 42
ci_044                 3.188851e-03 3 1  ON 43
ci_045                 2.451902e-03 3 1  ON 44
ci_046                 2.720035e-03 3 1  ON 45
ci_047                -1.002011e-03 3 1  ON 46
ci_048                -8.337266e-04 3 1  ON 47
ci_049                 7.790850e-04 3 1  ON 48
ci_050                 9.948649e-04 3 1  ON 49
ci_051                -3.140457e-04 3 1  ON 50
ci_052                -1.210990e-03 3 1  ON 51
ci_053                -2.434319e-03 3 1  ON 52
ci_054                -2.688938e-03 3 1  ON 53
ci_055                -1.798493e-03 3 1  ON 54
ci_056                -1.929280e-03 3 1  ON 55
ci_057                -1.307194e-03 3 1  ON 56
ci_058                -9.876864e-04 3 1  ON 57
ci_059                -5.506010e-04 3 1  ON 58
ci_060                -7.599699e-04 3 1  ON 59
ci_061                -5.110587e-05 3 1  ON 60
ci_062                -9.208284e-04 3 1  ON 61
ci_063                -8.853604e-04 3 1  ON 62
ci_064                -5.248651e-04 3 1  ON 63
ci_065                -1.359540e-03 3 1  ON 64
ci_066                -1.884045e-03 3 1  ON 65
ci_067                -1.812409e-03 3 1  ON 66
ci_068                -1.557381e-03 3 1  ON 67
ci_069                -5.541144e-04 3 1  ON 68
ci_070                -4.262615e-04 3 1  ON 69
ci_071                -2.088538e-03 3 1  ON 70
ci_072                -2.001694e-03 3 1  ON 71
ci_073                 1.602904e-04 3 1  ON 72
ci_074                 1.977608e-04 3 1  ON 73
ci_075                 1.615524e-04 3 1  ON 74
ci_076                 7.840031e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6256
    reference variance = 0.304029
====================================================
  Execution time = 2.5427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5200e-01
  Total weights = 1.9555e+06
  Execution time = 3.6096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442594444213
                                         uncertainty =       0.002149563159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442594444213
                                         uncertainty =       0.002149563159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470426038
  error estimate for blocks of size 2^( 2) =       0.000494496746
  error estimate for blocks of size 2^( 3) =       0.000516767228
  error estimate for blocks of size 2^( 4) =       0.000533792974
  error estimate for blocks of size 2^( 5) =       0.000544213843
  error estimate for blocks of size 2^( 6) =       0.000549210722
  error estimate for blocks of size 2^( 7) =       0.000550411121

      target function =      -0.743685848731
              le_mean =     -22.662297024962
             les_mean =     514.031700378264
             stat err =       0.000544407165
             autocorr =       1.339260196604
   target nu stat err =       0.000544407165
   target dn stat err =       0.002727927505
      target stat err =       0.002307387899
              std dev =       0.665282882500
             le_variance =       0.442601313747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442592488517
                                         uncertainty =       0.002149409039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442592488517
                                         uncertainty =       0.002149409039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470425003
  error estimate for blocks of size 2^( 2) =       0.000494495824
  error estimate for blocks of size 2^( 3) =       0.000516766460
  error estimate for blocks of size 2^( 4) =       0.000533792301
  error estimate for blocks of size 2^( 5) =       0.000544213069
  error estimate for blocks of size 2^( 6) =       0.000549210034
  error estimate for blocks of size 2^( 7) =       0.000550410459

      target function =      -0.743635307999
              le_mean =     -22.662297025931
             les_mean =     514.031762278370
             stat err =       0.000544406466
             autocorr =       1.339262648863
   target nu stat err =       0.000544406466
   target dn stat err =       0.002730363376
      target stat err =       0.002309006403
              std dev =       0.665281419091
             le_variance =       0.442599366588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442593463758
                                         uncertainty =       0.002149485963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442593463758
                                         uncertainty =       0.002149485963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470425519
  error estimate for blocks of size 2^( 2) =       0.000494496284
  error estimate for blocks of size 2^( 3) =       0.000516766843
  error estimate for blocks of size 2^( 4) =       0.000533792636
  error estimate for blocks of size 2^( 5) =       0.000544213454
  error estimate for blocks of size 2^( 6) =       0.000549210376
  error estimate for blocks of size 2^( 7) =       0.000550410788

      target function =      -0.743667854253
              le_mean =     -22.662297025025
             les_mean =     514.031722404372
             stat err =       0.000544406814
             autocorr =       1.339261421919
   target nu stat err =       0.000544406814
   target dn stat err =       0.002728626339
      target stat err =       0.002307831272
              std dev =       0.665282148841
             le_variance =       0.442600337567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442594321465
                                         uncertainty =       0.002149553502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442594321465
                                         uncertainty =       0.002149553502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470425973
  error estimate for blocks of size 2^( 2) =       0.000494496688
  error estimate for blocks of size 2^( 3) =       0.000516767180
  error estimate for blocks of size 2^( 4) =       0.000533792931
  error estimate for blocks of size 2^( 5) =       0.000544213795
  error estimate for blocks of size 2^( 6) =       0.000549210678
  error estimate for blocks of size 2^( 7) =       0.000550411079

      target function =      -0.743684116784
              le_mean =     -22.662297024930
             les_mean =     514.031702496529
             stat err =       0.000544407121
             autocorr =       1.339260349647
   target nu stat err =       0.000544407121
   target dn stat err =       0.002727986477
      target stat err =       0.002307424031
              std dev =       0.665282790649
             le_variance =       0.442601191534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743685848731        initial  <--
     2.5000e+01     2.5000e+02             8.3516e-06        -0.743635307999
     1.0000e+02     1.0000e+03             2.0907e-06        -0.743667854253
     4.0000e+02     4.0000e+03             5.2284e-07        -0.743684116784

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5385
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_001                -7.055862e-01 3 1  ON 0
ci_002                -7.029012e-01 3 1  ON 1
ci_003                -5.013073e-02 3 1  ON 2
ci_004                -5.100252e-02 3 1  ON 3
ci_005                 1.949628e-02 3 1  ON 4
ci_006                 1.981780e-02 3 1  ON 5
ci_007                 1.474639e-02 3 1  ON 6
ci_008                 1.554177e-02 3 1  ON 7
ci_009                -1.320266e-02 3 1  ON 8
ci_010                -1.208057e-02 3 1  ON 9
ci_011                -9.911344e-03 3 1  ON 10
ci_012                -9.099853e-03 3 1  ON 11
ci_013                 8.350004e-03 3 1  ON 12
ci_014                 9.370702e-03 3 1  ON 13
ci_015                 9.520981e-03 3 1  ON 14
ci_016                 9.413580e-03 3 1  ON 15
ci_017                 8.493789e-03 3 1  ON 16
ci_018                 8.287124e-03 3 1  ON 17
ci_019                -1.221232e-03 3 1  ON 18
ci_020                -1.534275e-03 3 1  ON 19
ci_021                -1.177677e-02 3 1  ON 20
ci_022                -1.179777e-02 3 1  ON 21
ci_023                 4.854081e-03 3 1  ON 22
ci_024                 4.919749e-03 3 1  ON 23
ci_025                 1.143476e-02 3 1  ON 24
ci_026                 1.147160e-02 3 1  ON 25
ci_027                 6.467295e-03 3 1  ON 26
ci_028                 6.188116e-03 3 1  ON 27
ci_029                -5.083087e-03 3 1  ON 28
ci_030                -4.170392e-03 3 1  ON 29
ci_031                 3.327885e-03 3 1  ON 30
ci_032                 4.542392e-03 3 1  ON 31
ci_033                 2.362928e-03 3 1  ON 32
ci_034                 4.136555e-03 3 1  ON 33
ci_035                 1.723390e-03 3 1  ON 34
ci_036                 2.153868e-03 3 1  ON 35
ci_037                 3.539345e-03 3 1  ON 36
ci_038                 3.700009e-03 3 1  ON 37
ci_039                 4.622695e-03 3 1  ON 38
ci_040                 4.935343e-03 3 1  ON 39
ci_041                 2.971017e-03 3 1  ON 40
ci_042                 2.733733e-03 3 1  ON 41
ci_043                 2.944881e-03 3 1  ON 42
ci_044                 3.188943e-03 3 1  ON 43
ci_045                 2.451610e-03 3 1  ON 44
ci_046                 2.721029e-03 3 1  ON 45
ci_047                -1.002242e-03 3 1  ON 46
ci_048                -8.336791e-04 3 1  ON 47
ci_049                 7.788243e-04 3 1  ON 48
ci_050                 9.956270e-04 3 1  ON 49
ci_051                -3.143239e-04 3 1  ON 50
ci_052                -1.211265e-03 3 1  ON 51
ci_053                -2.433985e-03 3 1  ON 52
ci_054                -2.689530e-03 3 1  ON 53
ci_055                -1.798776e-03 3 1  ON 54
ci_056                -1.928996e-03 3 1  ON 55
ci_057                -1.307423e-03 3 1  ON 56
ci_058                -9.884940e-04 3 1  ON 57
ci_059                -5.511908e-04 3 1  ON 58
ci_060                -7.600184e-04 3 1  ON 59
ci_061                -5.115325e-05 3 1  ON 60
ci_062                -9.211528e-04 3 1  ON 61
ci_063                -8.860797e-04 3 1  ON 62
ci_064                -5.241028e-04 3 1  ON 63
ci_065                -1.359548e-03 3 1  ON 64
ci_066                -1.883911e-03 3 1  ON 65
ci_067                -1.812803e-03 3 1  ON 66
ci_068                -1.557233e-03 3 1  ON 67
ci_069                -5.541928e-04 3 1  ON 68
ci_070                -4.263716e-04 3 1  ON 69
ci_071                -2.088455e-03 3 1  ON 70
ci_072                -2.000985e-03 3 1  ON 71
ci_073                 1.612568e-04 3 1  ON 72
ci_074                 1.976243e-04 3 1  ON 73
ci_075                 1.616243e-04 3 1  ON 74
ci_076                 7.849485e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6294
    reference variance = 0.450734
====================================================
  Execution time = 2.5990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4879e-01
  Total weights = 1.955289447e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440349922860
                                         uncertainty =       0.002488737978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440349922860
                                         uncertainty =       0.002488737978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469265880
  error estimate for blocks of size 2^( 2) =       0.000493644102
  error estimate for blocks of size 2^( 3) =       0.000515819055
  error estimate for blocks of size 2^( 4) =       0.000532003336
  error estimate for blocks of size 2^( 5) =       0.000540406384
  error estimate for blocks of size 2^( 6) =       0.000543055888
  error estimate for blocks of size 2^( 7) =       0.000547251858

      target function =      -0.746313466800
              le_mean =     -22.662500401875
             les_mean =     514.037714352661
             stat err =       0.000540679367
             autocorr =       1.327521722086
   target nu stat err =       0.000540679367
   target dn stat err =       0.002983511238
      target stat err =       0.002526684416
              std dev =       0.663642172186
             le_variance =       0.440420932704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266250040187e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746321149950       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746321277765       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746321307244       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746321308688       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746321309179       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746321309313       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746321309434       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746321309431       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746321309286       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746321309351       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746321309388       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+02 is 9.333453e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746321149950       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746321181909       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746321189279       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746321189642       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746321189762       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746321189796       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746321189826       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746321189826       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746321189787       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746321189805       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746321189816       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+03 is 2.333636e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746321149950       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746321157940       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746321159782       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746321159873       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746321159906       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746321159910       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746321159916       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746321159916       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746321159907       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746321159907       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746321159922       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+03 is 5.834260e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043319 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0794e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029014e-01 3 1  ON 1
ci_003                -5.013069e-02 3 1  ON 2
ci_004                -5.100259e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981770e-02 3 1  ON 5
ci_007                 1.474643e-02 3 1  ON 6
ci_008                 1.554169e-02 3 1  ON 7
ci_009                -1.320261e-02 3 1  ON 8
ci_010                -1.208055e-02 3 1  ON 9
ci_011                -9.911317e-03 3 1  ON 10
ci_012                -9.099741e-03 3 1  ON 11
ci_013                 8.349900e-03 3 1  ON 12
ci_014                 9.370554e-03 3 1  ON 13
ci_015                 9.520964e-03 3 1  ON 14
ci_016                 9.413347e-03 3 1  ON 15
ci_017                 8.493662e-03 3 1  ON 16
ci_018                 8.287105e-03 3 1  ON 17
ci_019                -1.221426e-03 3 1  ON 18
ci_020                -1.534471e-03 3 1  ON 19
ci_021                -1.177686e-02 3 1  ON 20
ci_022                -1.179793e-02 3 1  ON 21
ci_023                 4.854042e-03 3 1  ON 22
ci_024                 4.919724e-03 3 1  ON 23
ci_025                 1.143479e-02 3 1  ON 24
ci_026                 1.147178e-02 3 1  ON 25
ci_027                 6.467191e-03 3 1  ON 26
ci_028                 6.188117e-03 3 1  ON 27
ci_029                -5.083081e-03 3 1  ON 28
ci_030                -4.170471e-03 3 1  ON 29
ci_031                 3.328071e-03 3 1  ON 30
ci_032                 4.542600e-03 3 1  ON 31
ci_033                 2.362921e-03 3 1  ON 32
ci_034                 4.136525e-03 3 1  ON 33
ci_035                 1.723370e-03 3 1  ON 34
ci_036                 2.153843e-03 3 1  ON 35
ci_037                 3.539277e-03 3 1  ON 36
ci_038                 3.700042e-03 3 1  ON 37
ci_039                 4.622716e-03 3 1  ON 38
ci_040                 4.935288e-03 3 1  ON 39
ci_041                 2.970972e-03 3 1  ON 40
ci_042                 2.733767e-03 3 1  ON 41
ci_043                 2.944866e-03 3 1  ON 42
ci_044                 3.188895e-03 3 1  ON 43
ci_045                 2.451603e-03 3 1  ON 44
ci_046                 2.721010e-03 3 1  ON 45
ci_047                -1.002308e-03 3 1  ON 46
ci_048                -8.337108e-04 3 1  ON 47
ci_049                 7.789040e-04 3 1  ON 48
ci_050                 9.956428e-04 3 1  ON 49
ci_051                -3.144485e-04 3 1  ON 50
ci_052                -1.211278e-03 3 1  ON 51
ci_053                -2.434016e-03 3 1  ON 52
ci_054                -2.689531e-03 3 1  ON 53
ci_055                -1.798762e-03 3 1  ON 54
ci_056                -1.928893e-03 3 1  ON 55
ci_057                -1.307401e-03 3 1  ON 56
ci_058                -9.884657e-04 3 1  ON 57
ci_059                -5.511534e-04 3 1  ON 58
ci_060                -7.599952e-04 3 1  ON 59
ci_061                -5.112842e-05 3 1  ON 60
ci_062                -9.210775e-04 3 1  ON 61
ci_063                -8.860445e-04 3 1  ON 62
ci_064                -5.241072e-04 3 1  ON 63
ci_065                -1.359606e-03 3 1  ON 64
ci_066                -1.883960e-03 3 1  ON 65
ci_067                -1.812775e-03 3 1  ON 66
ci_068                -1.557299e-03 3 1  ON 67
ci_069                -5.541837e-04 3 1  ON 68
ci_070                -4.262213e-04 3 1  ON 69
ci_071                -2.088471e-03 3 1  ON 70
ci_072                -2.000956e-03 3 1  ON 71
ci_073                 1.612586e-04 3 1  ON 72
ci_074                 1.976439e-04 3 1  ON 73
ci_075                 1.616528e-04 3 1  ON 74
ci_076                 7.850949e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6638
    reference variance = 0.20367
====================================================
  Execution time = 2.5467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4680e-01
  Total weights = 1.9554e+06
  Execution time = 3.6143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436688057720
                                         uncertainty =       0.001906019622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436688057720
                                         uncertainty =       0.001906019622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467212762
  error estimate for blocks of size 2^( 2) =       0.000491214518
  error estimate for blocks of size 2^( 3) =       0.000513792963
  error estimate for blocks of size 2^( 4) =       0.000529490059
  error estimate for blocks of size 2^( 5) =       0.000538846033
  error estimate for blocks of size 2^( 6) =       0.000543304176
  error estimate for blocks of size 2^( 7) =       0.000546328314

      target function =      -0.747952137091
              le_mean =     -22.662131871720
             les_mean =     514.019019869636
             stat err =       0.000539492146
             autocorr =       1.333339846408
   target nu stat err =       0.000539492146
   target dn stat err =       0.002654817341
      target stat err =       0.002272742340
              std dev =       0.660738624780
             le_variance =       0.436575530277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436687953701
                                         uncertainty =       0.001906026737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436687953701
                                         uncertainty =       0.001906026737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467212706
  error estimate for blocks of size 2^( 2) =       0.000491214486
  error estimate for blocks of size 2^( 3) =       0.000513792938
  error estimate for blocks of size 2^( 4) =       0.000529490042
  error estimate for blocks of size 2^( 5) =       0.000538846031
  error estimate for blocks of size 2^( 6) =       0.000543304173
  error estimate for blocks of size 2^( 7) =       0.000546328321

      target function =      -0.747951439414
              le_mean =     -22.662131873118
             les_mean =     514.019020777030
             stat err =       0.000539492142
             autocorr =       1.333340147830
   target nu stat err =       0.000539492142
   target dn stat err =       0.002654900339
      target stat err =       0.002272804420
              std dev =       0.660738545435
             le_variance =       0.436575425424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436688005671
                                         uncertainty =       0.001906023178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436688005671
                                         uncertainty =       0.001906023178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467212734
  error estimate for blocks of size 2^( 2) =       0.000491214502
  error estimate for blocks of size 2^( 3) =       0.000513792950
  error estimate for blocks of size 2^( 4) =       0.000529490050
  error estimate for blocks of size 2^( 5) =       0.000538846032
  error estimate for blocks of size 2^( 6) =       0.000543304175
  error estimate for blocks of size 2^( 7) =       0.000546328318

      target function =      -0.747951791866
              le_mean =     -22.662131872416
             les_mean =     514.019020318825
             stat err =       0.000539492144
             autocorr =       1.333339997144
   target nu stat err =       0.000539492144
   target dn stat err =       0.002654858674
      target stat err =       0.002272773269
              std dev =       0.660738585078
             le_variance =       0.436575477810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436688051210
                                         uncertainty =       0.001906020066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436688051210
                                         uncertainty =       0.001906020066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467212759
  error estimate for blocks of size 2^( 2) =       0.000491214516
  error estimate for blocks of size 2^( 3) =       0.000513792961
  error estimate for blocks of size 2^( 4) =       0.000529490058
  error estimate for blocks of size 2^( 5) =       0.000538846033
  error estimate for blocks of size 2^( 6) =       0.000543304176
  error estimate for blocks of size 2^( 7) =       0.000546328315

      target function =      -0.747952094339
              le_mean =     -22.662131871807
             les_mean =     514.019019925285
             stat err =       0.000539492145
             autocorr =       1.333339865252
   target nu stat err =       0.000539492145
   target dn stat err =       0.002654822489
      target stat err =       0.002272746194
              std dev =       0.660738619815
             le_variance =       0.436575523715


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747952137091        initial  <--
     2.5000e+02     2.5000e+03             9.3335e-07        -0.747951439414
     1.0000e+03     1.0000e+04             2.3336e-07        -0.747951791866
     4.0000e+03     4.0000e+04             5.8343e-08        -0.747952094339

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5873
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_001                -7.055862e-01 3 1  ON 0
ci_002                -7.029012e-01 3 1  ON 1
ci_003                -5.013073e-02 3 1  ON 2
ci_004                -5.100252e-02 3 1  ON 3
ci_005                 1.949628e-02 3 1  ON 4
ci_006                 1.981780e-02 3 1  ON 5
ci_007                 1.474639e-02 3 1  ON 6
ci_008                 1.554177e-02 3 1  ON 7
ci_009                -1.320266e-02 3 1  ON 8
ci_010                -1.208057e-02 3 1  ON 9
ci_011                -9.911344e-03 3 1  ON 10
ci_012                -9.099853e-03 3 1  ON 11
ci_013                 8.350004e-03 3 1  ON 12
ci_014                 9.370702e-03 3 1  ON 13
ci_015                 9.520981e-03 3 1  ON 14
ci_016                 9.413580e-03 3 1  ON 15
ci_017                 8.493789e-03 3 1  ON 16
ci_018                 8.287124e-03 3 1  ON 17
ci_019                -1.221232e-03 3 1  ON 18
ci_020                -1.534275e-03 3 1  ON 19
ci_021                -1.177677e-02 3 1  ON 20
ci_022                -1.179777e-02 3 1  ON 21
ci_023                 4.854081e-03 3 1  ON 22
ci_024                 4.919749e-03 3 1  ON 23
ci_025                 1.143476e-02 3 1  ON 24
ci_026                 1.147160e-02 3 1  ON 25
ci_027                 6.467295e-03 3 1  ON 26
ci_028                 6.188116e-03 3 1  ON 27
ci_029                -5.083087e-03 3 1  ON 28
ci_030                -4.170392e-03 3 1  ON 29
ci_031                 3.327885e-03 3 1  ON 30
ci_032                 4.542392e-03 3 1  ON 31
ci_033                 2.362928e-03 3 1  ON 32
ci_034                 4.136555e-03 3 1  ON 33
ci_035                 1.723390e-03 3 1  ON 34
ci_036                 2.153868e-03 3 1  ON 35
ci_037                 3.539345e-03 3 1  ON 36
ci_038                 3.700009e-03 3 1  ON 37
ci_039                 4.622695e-03 3 1  ON 38
ci_040                 4.935343e-03 3 1  ON 39
ci_041                 2.971017e-03 3 1  ON 40
ci_042                 2.733733e-03 3 1  ON 41
ci_043                 2.944881e-03 3 1  ON 42
ci_044                 3.188943e-03 3 1  ON 43
ci_045                 2.451610e-03 3 1  ON 44
ci_046                 2.721029e-03 3 1  ON 45
ci_047                -1.002242e-03 3 1  ON 46
ci_048                -8.336791e-04 3 1  ON 47
ci_049                 7.788243e-04 3 1  ON 48
ci_050                 9.956270e-04 3 1  ON 49
ci_051                -3.143239e-04 3 1  ON 50
ci_052                -1.211265e-03 3 1  ON 51
ci_053                -2.433985e-03 3 1  ON 52
ci_054                -2.689530e-03 3 1  ON 53
ci_055                -1.798776e-03 3 1  ON 54
ci_056                -1.928996e-03 3 1  ON 55
ci_057                -1.307423e-03 3 1  ON 56
ci_058                -9.884940e-04 3 1  ON 57
ci_059                -5.511908e-04 3 1  ON 58
ci_060                -7.600184e-04 3 1  ON 59
ci_061                -5.115325e-05 3 1  ON 60
ci_062                -9.211528e-04 3 1  ON 61
ci_063                -8.860797e-04 3 1  ON 62
ci_064                -5.241028e-04 3 1  ON 63
ci_065                -1.359548e-03 3 1  ON 64
ci_066                -1.883911e-03 3 1  ON 65
ci_067                -1.812803e-03 3 1  ON 66
ci_068                -1.557233e-03 3 1  ON 67
ci_069                -5.541928e-04 3 1  ON 68
ci_070                -4.263716e-04 3 1  ON 69
ci_071                -2.088455e-03 3 1  ON 70
ci_072                -2.000985e-03 3 1  ON 71
ci_073                 1.612568e-04 3 1  ON 72
ci_074                 1.976243e-04 3 1  ON 73
ci_075                 1.616243e-04 3 1  ON 74
ci_076                 7.849485e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.5819
    reference variance = 0.352891
====================================================
  Execution time = 2.5868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4902e-01
  Total weights = 1.955091759e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440293083838
                                         uncertainty =       0.002289758338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440293083838
                                         uncertainty =       0.002289758338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469185353
  error estimate for blocks of size 2^( 2) =       0.000493147340
  error estimate for blocks of size 2^( 3) =       0.000515635526
  error estimate for blocks of size 2^( 4) =       0.000531578676
  error estimate for blocks of size 2^( 5) =       0.000541122885
  error estimate for blocks of size 2^( 6) =       0.000547886750
  error estimate for blocks of size 2^( 7) =       0.000547656372

      target function =      -0.746130051446
              le_mean =     -22.662900878563
             les_mean =     514.056093877567
             stat err =       0.000542061171
             autocorr =       1.334773898508
   target nu stat err =       0.000542061171
   target dn stat err =       0.003039235633
      target stat err =       0.002571918444
              std dev =       0.663528289708
             le_variance =       0.440269791243


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266290087856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746138031607       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746138037859       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746138038706       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746138038875       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746138038874       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746138038921       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746138038936       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746138038934       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746138038939       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746138038940       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746138038936       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+03 is 6.618315e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746138031607       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746138033170       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746138033381       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746138033424       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746138033436       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746138033422       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746138033442       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746138033434       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746138033435       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746138033431       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746138033431       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+04 is 1.654598e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746138031607       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746138031997       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746138032050       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746138032063       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746138032066       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746138032064       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746138032044       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746138032030       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746138032049       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746138032095       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746138032043       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+04 is 4.136507e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0609e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_001                -7.055862e-01 3 1  ON 0
ci_002                -7.029013e-01 3 1  ON 1
ci_003                -5.013072e-02 3 1  ON 2
ci_004                -5.100253e-02 3 1  ON 3
ci_005                 1.949627e-02 3 1  ON 4
ci_006                 1.981779e-02 3 1  ON 5
ci_007                 1.474638e-02 3 1  ON 6
ci_008                 1.554177e-02 3 1  ON 7
ci_009                -1.320265e-02 3 1  ON 8
ci_010                -1.208057e-02 3 1  ON 9
ci_011                -9.911336e-03 3 1  ON 10
ci_012                -9.099850e-03 3 1  ON 11
ci_013                 8.350003e-03 3 1  ON 12
ci_014                 9.370691e-03 3 1  ON 13
ci_015                 9.520976e-03 3 1  ON 14
ci_016                 9.413578e-03 3 1  ON 15
ci_017                 8.493787e-03 3 1  ON 16
ci_018                 8.287117e-03 3 1  ON 17
ci_019                -1.221240e-03 3 1  ON 18
ci_020                -1.534292e-03 3 1  ON 19
ci_021                -1.177677e-02 3 1  ON 20
ci_022                -1.179778e-02 3 1  ON 21
ci_023                 4.854083e-03 3 1  ON 22
ci_024                 4.919750e-03 3 1  ON 23
ci_025                 1.143476e-02 3 1  ON 24
ci_026                 1.147161e-02 3 1  ON 25
ci_027                 6.467295e-03 3 1  ON 26
ci_028                 6.188124e-03 3 1  ON 27
ci_029                -5.083076e-03 3 1  ON 28
ci_030                -4.170392e-03 3 1  ON 29
ci_031                 3.327898e-03 3 1  ON 30
ci_032                 4.542396e-03 3 1  ON 31
ci_033                 2.362932e-03 3 1  ON 32
ci_034                 4.136554e-03 3 1  ON 33
ci_035                 1.723388e-03 3 1  ON 34
ci_036                 2.153865e-03 3 1  ON 35
ci_037                 3.539341e-03 3 1  ON 36
ci_038                 3.700012e-03 3 1  ON 37
ci_039                 4.622689e-03 3 1  ON 38
ci_040                 4.935338e-03 3 1  ON 39
ci_041                 2.971018e-03 3 1  ON 40
ci_042                 2.733735e-03 3 1  ON 41
ci_043                 2.944878e-03 3 1  ON 42
ci_044                 3.188946e-03 3 1  ON 43
ci_045                 2.451611e-03 3 1  ON 44
ci_046                 2.721028e-03 3 1  ON 45
ci_047                -1.002241e-03 3 1  ON 46
ci_048                -8.336781e-04 3 1  ON 47
ci_049                 7.788263e-04 3 1  ON 48
ci_050                 9.956222e-04 3 1  ON 49
ci_051                -3.143296e-04 3 1  ON 50
ci_052                -1.211263e-03 3 1  ON 51
ci_053                -2.433978e-03 3 1  ON 52
ci_054                -2.689531e-03 3 1  ON 53
ci_055                -1.798762e-03 3 1  ON 54
ci_056                -1.928993e-03 3 1  ON 55
ci_057                -1.307421e-03 3 1  ON 56
ci_058                -9.884811e-04 3 1  ON 57
ci_059                -5.511847e-04 3 1  ON 58
ci_060                -7.600170e-04 3 1  ON 59
ci_061                -5.114934e-05 3 1  ON 60
ci_062                -9.211532e-04 3 1  ON 61
ci_063                -8.860801e-04 3 1  ON 62
ci_064                -5.241046e-04 3 1  ON 63
ci_065                -1.359550e-03 3 1  ON 64
ci_066                -1.883912e-03 3 1  ON 65
ci_067                -1.812807e-03 3 1  ON 66
ci_068                -1.557234e-03 3 1  ON 67
ci_069                -5.541869e-04 3 1  ON 68
ci_070                -4.263688e-04 3 1  ON 69
ci_071                -2.088450e-03 3 1  ON 70
ci_072                -2.000979e-03 3 1  ON 71
ci_073                 1.612525e-04 3 1  ON 72
ci_074                 1.976251e-04 3 1  ON 73
ci_075                 1.616240e-04 3 1  ON 74
ci_076                 7.849413e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6308
    reference variance = 0.263436
====================================================
  Execution time = 2.5400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5236e-01
  Total weights = 1.9552e+06
  Execution time = 3.6108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442028792790
                                         uncertainty =       0.002530511574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442028792790
                                         uncertainty =       0.002530511574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470153515
  error estimate for blocks of size 2^( 2) =       0.000494376254
  error estimate for blocks of size 2^( 3) =       0.000516560773
  error estimate for blocks of size 2^( 4) =       0.000532568027
  error estimate for blocks of size 2^( 5) =       0.000541659198
  error estimate for blocks of size 2^( 6) =       0.000546161149
  error estimate for blocks of size 2^( 7) =       0.000548855321

      target function =      -0.743382730569
              le_mean =     -22.662096313386
             les_mean =     514.022968416096
             stat err =       0.000542310924
             autocorr =       1.330507512074
   target nu stat err =       0.000542310924
   target dn stat err =       0.003360026363
      target stat err =       0.002805770715
              std dev =       0.664897476792
             le_variance =       0.442088654644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442028776901
                                         uncertainty =       0.002530510577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442028776901
                                         uncertainty =       0.002530510577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470153506
  error estimate for blocks of size 2^( 2) =       0.000494376248
  error estimate for blocks of size 2^( 3) =       0.000516560767
  error estimate for blocks of size 2^( 4) =       0.000532568023
  error estimate for blocks of size 2^( 5) =       0.000541659194
  error estimate for blocks of size 2^( 6) =       0.000546161144
  error estimate for blocks of size 2^( 7) =       0.000548855317

      target function =      -0.743382732127
              le_mean =     -22.662096312651
             les_mean =     514.022968380880
             stat err =       0.000542310919
             autocorr =       1.330507539205
   target nu stat err =       0.000542310919
   target dn stat err =       0.003360024618
      target stat err =       0.002805769332
              std dev =       0.664897464762
             le_variance =       0.442088638647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442028784845
                                         uncertainty =       0.002530511076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442028784845
                                         uncertainty =       0.002530511076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470153510
  error estimate for blocks of size 2^( 2) =       0.000494376251
  error estimate for blocks of size 2^( 3) =       0.000516560770
  error estimate for blocks of size 2^( 4) =       0.000532568025
  error estimate for blocks of size 2^( 5) =       0.000541659196
  error estimate for blocks of size 2^( 6) =       0.000546161146
  error estimate for blocks of size 2^( 7) =       0.000548855319

      target function =      -0.743382731359
              le_mean =     -22.662096313018
             les_mean =     514.022968398474
             stat err =       0.000542310922
             autocorr =       1.330507525646
   target nu stat err =       0.000542310922
   target dn stat err =       0.003360025490
      target stat err =       0.002805770023
              std dev =       0.664897470777
             le_variance =       0.442088646645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442028791797
                                         uncertainty =       0.002530511512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442028791797
                                         uncertainty =       0.002530511512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470153514
  error estimate for blocks of size 2^( 2) =       0.000494376254
  error estimate for blocks of size 2^( 3) =       0.000516560772
  error estimate for blocks of size 2^( 4) =       0.000532568027
  error estimate for blocks of size 2^( 5) =       0.000541659198
  error estimate for blocks of size 2^( 6) =       0.000546161148
  error estimate for blocks of size 2^( 7) =       0.000548855321

      target function =      -0.743382730669
              le_mean =     -22.662096313340
             les_mean =     514.022968413892
             stat err =       0.000542310923
             autocorr =       1.330507513770
   target nu stat err =       0.000542310923
   target dn stat err =       0.003360026254
      target stat err =       0.002805770629
              std dev =       0.664897476040
             le_variance =       0.442088653644


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743382730569        initial
     2.5000e+03     2.5000e+04             6.6183e-08        -0.743382732127  <--
     1.0000e+04     1.0000e+05             1.6546e-08        -0.743382731359
     4.0000e+04     4.0000e+05             4.1365e-09        -0.743382730669

*****************************************************************************
Applying the update for shift_i =   2.5000e+03     and shift_s =   2.5000e+04
*****************************************************************************

  Execution time = 4.3500e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_001                -7.055862e-01 3 1  ON 0
ci_002                -7.029013e-01 3 1  ON 1
ci_003                -5.013068e-02 3 1  ON 2
ci_004                -5.100254e-02 3 1  ON 3
ci_005                 1.949625e-02 3 1  ON 4
ci_006                 1.981776e-02 3 1  ON 5
ci_007                 1.474638e-02 3 1  ON 6
ci_008                 1.554175e-02 3 1  ON 7
ci_009                -1.320263e-02 3 1  ON 8
ci_010                -1.208056e-02 3 1  ON 9
ci_011                -9.911313e-03 3 1  ON 10
ci_012                -9.099840e-03 3 1  ON 11
ci_013                 8.350000e-03 3 1  ON 12
ci_014                 9.370658e-03 3 1  ON 13
ci_015                 9.520961e-03 3 1  ON 14
ci_016                 9.413573e-03 3 1  ON 15
ci_017                 8.493780e-03 3 1  ON 16
ci_018                 8.287096e-03 3 1  ON 17
ci_019                -1.221266e-03 3 1  ON 18
ci_020                -1.534342e-03 3 1  ON 19
ci_021                -1.177679e-02 3 1  ON 20
ci_022                -1.179780e-02 3 1  ON 21
ci_023                 4.854088e-03 3 1  ON 22
ci_024                 4.919755e-03 3 1  ON 23
ci_025                 1.143479e-02 3 1  ON 24
ci_026                 1.147164e-02 3 1  ON 25
ci_027                 6.467296e-03 3 1  ON 26
ci_028                 6.188147e-03 3 1  ON 27
ci_029                -5.083044e-03 3 1  ON 28
ci_030                -4.170393e-03 3 1  ON 29
ci_031                 3.327940e-03 3 1  ON 30
ci_032                 4.542409e-03 3 1  ON 31
ci_033                 2.362944e-03 3 1  ON 32
ci_034                 4.136551e-03 3 1  ON 33
ci_035                 1.723383e-03 3 1  ON 34
ci_036                 2.153855e-03 3 1  ON 35
ci_037                 3.539328e-03 3 1  ON 36
ci_038                 3.700019e-03 3 1  ON 37
ci_039                 4.622672e-03 3 1  ON 38
ci_040                 4.935325e-03 3 1  ON 39
ci_041                 2.971019e-03 3 1  ON 40
ci_042                 2.733740e-03 3 1  ON 41
ci_043                 2.944871e-03 3 1  ON 42
ci_044                 3.188956e-03 3 1  ON 43
ci_045                 2.451614e-03 3 1  ON 44
ci_046                 2.721024e-03 3 1  ON 45
ci_047                -1.002239e-03 3 1  ON 46
ci_048                -8.336752e-04 3 1  ON 47
ci_049                 7.788324e-04 3 1  ON 48
ci_050                 9.956078e-04 3 1  ON 49
ci_051                -3.143469e-04 3 1  ON 50
ci_052                -1.211258e-03 3 1  ON 51
ci_053                -2.433958e-03 3 1  ON 52
ci_054                -2.689535e-03 3 1  ON 53
ci_055                -1.798720e-03 3 1  ON 54
ci_056                -1.928985e-03 3 1  ON 55
ci_057                -1.307414e-03 3 1  ON 56
ci_058                -9.884426e-04 3 1  ON 57
ci_059                -5.511664e-04 3 1  ON 58
ci_060                -7.600128e-04 3 1  ON 59
ci_061                -5.113762e-05 3 1  ON 60
ci_062                -9.211546e-04 3 1  ON 61
ci_063                -8.860813e-04 3 1  ON 62
ci_064                -5.241103e-04 3 1  ON 63
ci_065                -1.359556e-03 3 1  ON 64
ci_066                -1.883915e-03 3 1  ON 65
ci_067                -1.812820e-03 3 1  ON 66
ci_068                -1.557237e-03 3 1  ON 67
ci_069                -5.541693e-04 3 1  ON 68
ci_070                -4.263602e-04 3 1  ON 69
ci_071                -2.088434e-03 3 1  ON 70
ci_072                -2.000960e-03 3 1  ON 71
ci_073                 1.612399e-04 3 1  ON 72
ci_074                 1.976274e-04 3 1  ON 73
ci_075                 1.616230e-04 3 1  ON 74
ci_076                 7.849199e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4116e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7172
    reference variance = 0.451553
====================================================
  Execution time = 2.8087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5549e-01
  Total weights = 1.955055974e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444757298665
                                         uncertainty =       0.004105485334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444757298665
                                         uncertainty =       0.004105485334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471545389
  error estimate for blocks of size 2^( 2) =       0.000495706957
  error estimate for blocks of size 2^( 3) =       0.000518199771
  error estimate for blocks of size 2^( 4) =       0.000534287822
  error estimate for blocks of size 2^( 5) =       0.000544306739
  error estimate for blocks of size 2^( 6) =       0.000548788409
  error estimate for blocks of size 2^( 7) =       0.000550876095

      target function =      -0.740823426373
              le_mean =     -22.662201686650
             les_mean =     514.030878818158
             stat err =       0.000544564766
             autocorr =       1.333681332506
   target nu stat err =       0.000544564766
   target dn stat err =       0.004807521244
      target stat err =       0.003942075690
              std dev =       0.666865884587
             le_variance =       0.444710108026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266220168665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740843695875       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740843739159       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740843745252       residual = 5.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740843745840       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740843746017       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740843746170       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740843746387       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740843746393       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740843746430       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740843746449       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740843746461       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740843746469       residual = 1.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+02 is 3.852060e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740843695875       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740843706696       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740843708220       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740843708368       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740843708411       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740843708449       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740843708498       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740843708504       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740843708508       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740843708515       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740843708524       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740843708524       residual = 1.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+03 is 9.630650e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740843695875       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740843698580       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740843698961       residual = 5.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740843698998       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740843699009       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740843699034       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740843699027       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740843699017       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740843699045       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740843699024       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740843699058       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740843699057       residual = 1.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+04 is 2.407694e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2881e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_001                -7.055861e-01 3 1  ON 0
ci_002                -7.029013e-01 3 1  ON 1
ci_003                -5.013065e-02 3 1  ON 2
ci_004                -5.100250e-02 3 1  ON 3
ci_005                 1.949623e-02 3 1  ON 4
ci_006                 1.981775e-02 3 1  ON 5
ci_007                 1.474640e-02 3 1  ON 6
ci_008                 1.554165e-02 3 1  ON 7
ci_009                -1.320264e-02 3 1  ON 8
ci_010                -1.208055e-02 3 1  ON 9
ci_011                -9.911274e-03 3 1  ON 10
ci_012                -9.099804e-03 3 1  ON 11
ci_013                 8.350006e-03 3 1  ON 12
ci_014                 9.370610e-03 3 1  ON 13
ci_015                 9.520896e-03 3 1  ON 14
ci_016                 9.413564e-03 3 1  ON 15
ci_017                 8.493789e-03 3 1  ON 16
ci_018                 8.287055e-03 3 1  ON 17
ci_019                -1.221316e-03 3 1  ON 18
ci_020                -1.534337e-03 3 1  ON 19
ci_021                -1.177676e-02 3 1  ON 20
ci_022                -1.179783e-02 3 1  ON 21
ci_023                 4.854112e-03 3 1  ON 22
ci_024                 4.919718e-03 3 1  ON 23
ci_025                 1.143485e-02 3 1  ON 24
ci_026                 1.147162e-02 3 1  ON 25
ci_027                 6.467288e-03 3 1  ON 26
ci_028                 6.188151e-03 3 1  ON 27
ci_029                -5.083001e-03 3 1  ON 28
ci_030                -4.170400e-03 3 1  ON 29
ci_031                 3.327951e-03 3 1  ON 30
ci_032                 4.542438e-03 3 1  ON 31
ci_033                 2.362955e-03 3 1  ON 32
ci_034                 4.136496e-03 3 1  ON 33
ci_035                 1.723371e-03 3 1  ON 34
ci_036                 2.153842e-03 3 1  ON 35
ci_037                 3.539289e-03 3 1  ON 36
ci_038                 3.699979e-03 3 1  ON 37
ci_039                 4.622654e-03 3 1  ON 38
ci_040                 4.935329e-03 3 1  ON 39
ci_041                 2.971001e-03 3 1  ON 40
ci_042                 2.733733e-03 3 1  ON 41
ci_043                 2.944860e-03 3 1  ON 42
ci_044                 3.188922e-03 3 1  ON 43
ci_045                 2.451582e-03 3 1  ON 44
ci_046                 2.721015e-03 3 1  ON 45
ci_047                -1.002241e-03 3 1  ON 46
ci_048                -8.336430e-04 3 1  ON 47
ci_049                 7.788040e-04 3 1  ON 48
ci_050                 9.956326e-04 3 1  ON 49
ci_051                -3.143578e-04 3 1  ON 50
ci_052                -1.211190e-03 3 1  ON 51
ci_053                -2.433997e-03 3 1  ON 52
ci_054                -2.689544e-03 3 1  ON 53
ci_055                -1.798698e-03 3 1  ON 54
ci_056                -1.928981e-03 3 1  ON 55
ci_057                -1.307373e-03 3 1  ON 56
ci_058                -9.884321e-04 3 1  ON 57
ci_059                -5.511639e-04 3 1  ON 58
ci_060                -7.600079e-04 3 1  ON 59
ci_061                -5.114326e-05 3 1  ON 60
ci_062                -9.211211e-04 3 1  ON 61
ci_063                -8.860603e-04 3 1  ON 62
ci_064                -5.241015e-04 3 1  ON 63
ci_065                -1.359618e-03 3 1  ON 64
ci_066                -1.883902e-03 3 1  ON 65
ci_067                -1.812793e-03 3 1  ON 66
ci_068                -1.557208e-03 3 1  ON 67
ci_069                -5.541618e-04 3 1  ON 68
ci_070                -4.263403e-04 3 1  ON 69
ci_071                -2.088412e-03 3 1  ON 70
ci_072                -2.000989e-03 3 1  ON 71
ci_073                 1.612186e-04 3 1  ON 72
ci_074                 1.976416e-04 3 1  ON 73
ci_075                 1.616189e-04 3 1  ON 74
ci_076                 7.849617e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6877
    reference variance = 0.562127
====================================================
  Execution time = 2.5039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4796e-01
  Total weights = 1.9551e+06
  Execution time = 3.6181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437747383991
                                         uncertainty =       0.001857441332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437747383991
                                         uncertainty =       0.001857441332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467864149
  error estimate for blocks of size 2^( 2) =       0.000492079434
  error estimate for blocks of size 2^( 3) =       0.000513796157
  error estimate for blocks of size 2^( 4) =       0.000529268480
  error estimate for blocks of size 2^( 5) =       0.000538255112
  error estimate for blocks of size 2^( 6) =       0.000542974030
  error estimate for blocks of size 2^( 7) =       0.000546769900

      target function =      -0.746976019767
              le_mean =     -22.661520532963
             les_mean =     513.992476408126
             stat err =       0.000539316881
             autocorr =       1.328765952334
   target nu stat err =       0.000539316881
   target dn stat err =       0.003836922293
      target stat err =       0.003214158425
              std dev =       0.661659825335
             le_variance =       0.437793724463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437747310872
                                         uncertainty =       0.001857434645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437747310872
                                         uncertainty =       0.001857434645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467864110
  error estimate for blocks of size 2^( 2) =       0.000492079404
  error estimate for blocks of size 2^( 3) =       0.000513796130
  error estimate for blocks of size 2^( 4) =       0.000529268451
  error estimate for blocks of size 2^( 5) =       0.000538255089
  error estimate for blocks of size 2^( 6) =       0.000542974011
  error estimate for blocks of size 2^( 7) =       0.000546769880

      target function =      -0.746976178010
              le_mean =     -22.661520534045
             les_mean =     513.992476265641
             stat err =       0.000539316858
             autocorr =       1.328766061488
   target nu stat err =       0.000539316858
   target dn stat err =       0.003836844797
      target stat err =       0.003214097064
              std dev =       0.661659770081
             le_variance =       0.437793651344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437747347427
                                         uncertainty =       0.001857437988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437747347427
                                         uncertainty =       0.001857437988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467864130
  error estimate for blocks of size 2^( 2) =       0.000492079419
  error estimate for blocks of size 2^( 3) =       0.000513796144
  error estimate for blocks of size 2^( 4) =       0.000529268465
  error estimate for blocks of size 2^( 5) =       0.000538255100
  error estimate for blocks of size 2^( 6) =       0.000542974021
  error estimate for blocks of size 2^( 7) =       0.000546769890

      target function =      -0.746976099700
              le_mean =     -22.661520533504
             les_mean =     513.992476335884
             stat err =       0.000539316869
             autocorr =       1.328766006913
   target nu stat err =       0.000539316869
   target dn stat err =       0.003836883539
      target stat err =       0.003214127747
              std dev =       0.661659797705
             le_variance =       0.437793687899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437747379420
                                         uncertainty =       0.001857440914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437747379420
                                         uncertainty =       0.001857440914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467864147
  error estimate for blocks of size 2^( 2) =       0.000492079432
  error estimate for blocks of size 2^( 3) =       0.000513796155
  error estimate for blocks of size 2^( 4) =       0.000529268478
  error estimate for blocks of size 2^( 5) =       0.000538255110
  error estimate for blocks of size 2^( 6) =       0.000542974029
  error estimate for blocks of size 2^( 7) =       0.000546769899

      target function =      -0.746976029845
              le_mean =     -22.661520533031
             les_mean =     513.992476398989
             stat err =       0.000539316879
             autocorr =       1.328765959154
   target nu stat err =       0.000539316879
   target dn stat err =       0.003836917448
      target stat err =       0.003214154590
              std dev =       0.661659821881
             le_variance =       0.437793719892


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746976019767        initial
     6.2500e+02     6.2500e+03             3.8521e-07        -0.746976178010  <--
     2.5000e+03     2.5000e+04             9.6307e-08        -0.746976099700
     1.0000e+04     1.0000e+05             2.4077e-08        -0.746976029845

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 4.4601e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981769e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554136e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911157e-03 3 1  ON 10
ci_012                -9.099694e-03 3 1  ON 11
ci_013                 8.350026e-03 3 1  ON 12
ci_014                 9.370464e-03 3 1  ON 13
ci_015                 9.520699e-03 3 1  ON 14
ci_016                 9.413536e-03 3 1  ON 15
ci_017                 8.493815e-03 3 1  ON 16
ci_018                 8.286931e-03 3 1  ON 17
ci_019                -1.221468e-03 3 1  ON 18
ci_020                -1.534324e-03 3 1  ON 19
ci_021                -1.177666e-02 3 1  ON 20
ci_022                -1.179794e-02 3 1  ON 21
ci_023                 4.854183e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143504e-02 3 1  ON 24
ci_026                 1.147156e-02 3 1  ON 25
ci_027                 6.467265e-03 3 1  ON 26
ci_028                 6.188162e-03 3 1  ON 27
ci_029                -5.082874e-03 3 1  ON 28
ci_030                -4.170418e-03 3 1  ON 29
ci_031                 3.327987e-03 3 1  ON 30
ci_032                 4.542527e-03 3 1  ON 31
ci_033                 2.362989e-03 3 1  ON 32
ci_034                 4.136331e-03 3 1  ON 33
ci_035                 1.723337e-03 3 1  ON 34
ci_036                 2.153803e-03 3 1  ON 35
ci_037                 3.539171e-03 3 1  ON 36
ci_038                 3.699860e-03 3 1  ON 37
ci_039                 4.622601e-03 3 1  ON 38
ci_040                 4.935343e-03 3 1  ON 39
ci_041                 2.970947e-03 3 1  ON 40
ci_042                 2.733709e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188821e-03 3 1  ON 43
ci_045                 2.451485e-03 3 1  ON 44
ci_046                 2.720987e-03 3 1  ON 45
ci_047                -1.002245e-03 3 1  ON 46
ci_048                -8.335463e-04 3 1  ON 47
ci_049                 7.787187e-04 3 1  ON 48
ci_050                 9.957069e-04 3 1  ON 49
ci_051                -3.143907e-04 3 1  ON 50
ci_052                -1.210983e-03 3 1  ON 51
ci_053                -2.434116e-03 3 1  ON 52
ci_054                -2.689571e-03 3 1  ON 53
ci_055                -1.798633e-03 3 1  ON 54
ci_056                -1.928969e-03 3 1  ON 55
ci_057                -1.307250e-03 3 1  ON 56
ci_058                -9.884008e-04 3 1  ON 57
ci_059                -5.511566e-04 3 1  ON 58
ci_060                -7.599932e-04 3 1  ON 59
ci_061                -5.116019e-05 3 1  ON 60
ci_062                -9.210206e-04 3 1  ON 61
ci_063                -8.859975e-04 3 1  ON 62
ci_064                -5.240753e-04 3 1  ON 63
ci_065                -1.359803e-03 3 1  ON 64
ci_066                -1.883860e-03 3 1  ON 65
ci_067                -1.812710e-03 3 1  ON 66
ci_068                -1.557118e-03 3 1  ON 67
ci_069                -5.541394e-04 3 1  ON 68
ci_070                -4.262806e-04 3 1  ON 69
ci_071                -2.088347e-03 3 1  ON 70
ci_072                -2.001075e-03 3 1  ON 71
ci_073                 1.611548e-04 3 1  ON 72
ci_074                 1.976845e-04 3 1  ON 73
ci_075                 1.616066e-04 3 1  ON 74
ci_076                 7.850871e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7488e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5893
    reference variance = 0.655412
====================================================
  Execution time = 2.5730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4781e-01
  Total weights = 1.955326419e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438999598431
                                         uncertainty =       0.001810223569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438999598431
                                         uncertainty =       0.001810223569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468502628
  error estimate for blocks of size 2^( 2) =       0.000492252102
  error estimate for blocks of size 2^( 3) =       0.000515031306
  error estimate for blocks of size 2^( 4) =       0.000530805408
  error estimate for blocks of size 2^( 5) =       0.000540721448
  error estimate for blocks of size 2^( 6) =       0.000546092916
  error estimate for blocks of size 2^( 7) =       0.000549129825

      target function =      -0.747108739459
              le_mean =     -22.661354180022
             les_mean =     513.984781403647
             stat err =       0.000541687399
             autocorr =       1.336821442043
   target nu stat err =       0.000541687399
   target dn stat err =       0.002634904867
      target stat err =       0.002250019039
              std dev =       0.662562771034
             le_variance =       0.438989425560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266135418002e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747114603163       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747114705994       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747114740883       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747114744702       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747114745225       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747114745703       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747114745732       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747114745799       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747114745765       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747114745763       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747114745789       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+02 is 1.201648e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747114603163       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747114628878       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747114637601       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747114638556       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747114638687       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747114638807       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747114638813       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747114638829       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747114638821       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747114638821       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747114638828       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+02 is 3.004698e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747114603163       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747114609592       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747114611773       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747114612012       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747114612040       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747114612073       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747114612074       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747114612080       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747114612077       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747114612083       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747114612082       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+03 is 7.512105e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.056570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0452e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_001                -7.055862e-01 3 1  ON 0
ci_002                -7.029012e-01 3 1  ON 1
ci_003                -5.013063e-02 3 1  ON 2
ci_004                -5.100234e-02 3 1  ON 3
ci_005                 1.949608e-02 3 1  ON 4
ci_006                 1.981753e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554125e-02 3 1  ON 7
ci_009                -1.320253e-02 3 1  ON 8
ci_010                -1.208045e-02 3 1  ON 9
ci_011                -9.911142e-03 3 1  ON 10
ci_012                -9.099678e-03 3 1  ON 11
ci_013                 8.349852e-03 3 1  ON 12
ci_014                 9.370459e-03 3 1  ON 13
ci_015                 9.520669e-03 3 1  ON 14
ci_016                 9.413478e-03 3 1  ON 15
ci_017                 8.493817e-03 3 1  ON 16
ci_018                 8.286832e-03 3 1  ON 17
ci_019                -1.221639e-03 3 1  ON 18
ci_020                -1.534625e-03 3 1  ON 19
ci_021                -1.177686e-02 3 1  ON 20
ci_022                -1.179809e-02 3 1  ON 21
ci_023                 4.854178e-03 3 1  ON 22
ci_024                 4.919410e-03 3 1  ON 23
ci_025                 1.143520e-02 3 1  ON 24
ci_026                 1.147169e-02 3 1  ON 25
ci_027                 6.467283e-03 3 1  ON 26
ci_028                 6.188045e-03 3 1  ON 27
ci_029                -5.082758e-03 3 1  ON 28
ci_030                -4.170433e-03 3 1  ON 29
ci_031                 3.328132e-03 3 1  ON 30
ci_032                 4.542666e-03 3 1  ON 31
ci_033                 2.362950e-03 3 1  ON 32
ci_034                 4.136324e-03 3 1  ON 33
ci_035                 1.723347e-03 3 1  ON 34
ci_036                 2.153774e-03 3 1  ON 35
ci_037                 3.539155e-03 3 1  ON 36
ci_038                 3.699878e-03 3 1  ON 37
ci_039                 4.622540e-03 3 1  ON 38
ci_040                 4.935322e-03 3 1  ON 39
ci_041                 2.970888e-03 3 1  ON 40
ci_042                 2.733738e-03 3 1  ON 41
ci_043                 2.944895e-03 3 1  ON 42
ci_044                 3.188886e-03 3 1  ON 43
ci_045                 2.451542e-03 3 1  ON 44
ci_046                 2.721025e-03 3 1  ON 45
ci_047                -1.002276e-03 3 1  ON 46
ci_048                -8.336039e-04 3 1  ON 47
ci_049                 7.786694e-04 3 1  ON 48
ci_050                 9.957300e-04 3 1  ON 49
ci_051                -3.143701e-04 3 1  ON 50
ci_052                -1.210915e-03 3 1  ON 51
ci_053                -2.434095e-03 3 1  ON 52
ci_054                -2.689508e-03 3 1  ON 53
ci_055                -1.798538e-03 3 1  ON 54
ci_056                -1.928924e-03 3 1  ON 55
ci_057                -1.307429e-03 3 1  ON 56
ci_058                -9.884416e-04 3 1  ON 57
ci_059                -5.511310e-04 3 1  ON 58
ci_060                -7.599280e-04 3 1  ON 59
ci_061                -5.118682e-05 3 1  ON 60
ci_062                -9.210337e-04 3 1  ON 61
ci_063                -8.860505e-04 3 1  ON 62
ci_064                -5.240374e-04 3 1  ON 63
ci_065                -1.359791e-03 3 1  ON 64
ci_066                -1.883860e-03 3 1  ON 65
ci_067                -1.812666e-03 3 1  ON 66
ci_068                -1.557077e-03 3 1  ON 67
ci_069                -5.541371e-04 3 1  ON 68
ci_070                -4.262662e-04 3 1  ON 69
ci_071                -2.088358e-03 3 1  ON 70
ci_072                -2.001096e-03 3 1  ON 71
ci_073                 1.610616e-04 3 1  ON 72
ci_074                 1.977714e-04 3 1  ON 73
ci_075                 1.617030e-04 3 1  ON 74
ci_076                 7.850633e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6134
    reference variance = 0.285914
====================================================
  Execution time = 2.5627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5421e-01
  Total weights = 1.9557e+06
  Execution time = 3.6214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444882886006
                                         uncertainty =       0.002511177623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444882886006
                                         uncertainty =       0.002511177623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471614573
  error estimate for blocks of size 2^( 2) =       0.000495588050
  error estimate for blocks of size 2^( 3) =       0.000517315921
  error estimate for blocks of size 2^( 4) =       0.000533256895
  error estimate for blocks of size 2^( 5) =       0.000542114544
  error estimate for blocks of size 2^( 6) =       0.000546027897
  error estimate for blocks of size 2^( 7) =       0.000547857955

      target function =      -0.741871150799
              le_mean =     -22.661058680857
             les_mean =     513.977790193990
             stat err =       0.000542314323
             autocorr =       1.322293054619
   target nu stat err =       0.000542314323
   target dn stat err =       0.003054087212
      target stat err =       0.002548307464
              std dev =       0.666963724912
             le_variance =       0.444840610349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444882627611
                                         uncertainty =       0.002511182753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444882627611
                                         uncertainty =       0.002511182753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471614436
  error estimate for blocks of size 2^( 2) =       0.000495587939
  error estimate for blocks of size 2^( 3) =       0.000517315833
  error estimate for blocks of size 2^( 4) =       0.000533256813
  error estimate for blocks of size 2^( 5) =       0.000542114468
  error estimate for blocks of size 2^( 6) =       0.000546027821
  error estimate for blocks of size 2^( 7) =       0.000547857880

      target function =      -0.741861001018
              le_mean =     -22.661058676997
             les_mean =     513.977802526124
             stat err =       0.000542314245
             autocorr =       1.322293445725
   target nu stat err =       0.000542314245
   target dn stat err =       0.003054253369
      target stat err =       0.002548370719
              std dev =       0.666963531101
             le_variance =       0.444840351818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444882756744
                                         uncertainty =       0.002511180186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444882756744
                                         uncertainty =       0.002511180186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471614504
  error estimate for blocks of size 2^( 2) =       0.000495587994
  error estimate for blocks of size 2^( 3) =       0.000517315877
  error estimate for blocks of size 2^( 4) =       0.000533256854
  error estimate for blocks of size 2^( 5) =       0.000542114506
  error estimate for blocks of size 2^( 6) =       0.000546027859
  error estimate for blocks of size 2^( 7) =       0.000547857917

      target function =      -0.741866314142
              le_mean =     -22.661058678929
             les_mean =     513.977796066640
             stat err =       0.000542314284
             autocorr =       1.322293250276
   target nu stat err =       0.000542314284
   target dn stat err =       0.003054150021
      target stat err =       0.002548324689
              std dev =       0.666963627959
             le_variance =       0.444840481020

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444882869843
                                         uncertainty =       0.002511177943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444882869843
                                         uncertainty =       0.002511177943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471614564
  error estimate for blocks of size 2^( 2) =       0.000495588043
  error estimate for blocks of size 2^( 3) =       0.000517315915
  error estimate for blocks of size 2^( 4) =       0.000533256890
  error estimate for blocks of size 2^( 5) =       0.000542114540
  error estimate for blocks of size 2^( 6) =       0.000546027892
  error estimate for blocks of size 2^( 7) =       0.000547857950

      target function =      -0.741870570583
              le_mean =     -22.661058680616
             les_mean =     513.977790898062
             stat err =       0.000542314318
             autocorr =       1.322293079077
   target nu stat err =       0.000542314318
   target dn stat err =       0.003054093063
      target stat err =       0.002548308202
              std dev =       0.666963712790
             le_variance =       0.444840594178


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741871150799        initial  <--
     1.5625e+02     1.5625e+03             1.2016e-06        -0.741861001018
     6.2500e+02     6.2500e+03             3.0047e-07        -0.741866314142
     2.5000e+03     2.5000e+04             7.5121e-08        -0.741870570583

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8013
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981769e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554136e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911157e-03 3 1  ON 10
ci_012                -9.099694e-03 3 1  ON 11
ci_013                 8.350026e-03 3 1  ON 12
ci_014                 9.370464e-03 3 1  ON 13
ci_015                 9.520699e-03 3 1  ON 14
ci_016                 9.413536e-03 3 1  ON 15
ci_017                 8.493815e-03 3 1  ON 16
ci_018                 8.286931e-03 3 1  ON 17
ci_019                -1.221468e-03 3 1  ON 18
ci_020                -1.534324e-03 3 1  ON 19
ci_021                -1.177666e-02 3 1  ON 20
ci_022                -1.179794e-02 3 1  ON 21
ci_023                 4.854183e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143504e-02 3 1  ON 24
ci_026                 1.147156e-02 3 1  ON 25
ci_027                 6.467265e-03 3 1  ON 26
ci_028                 6.188162e-03 3 1  ON 27
ci_029                -5.082874e-03 3 1  ON 28
ci_030                -4.170418e-03 3 1  ON 29
ci_031                 3.327987e-03 3 1  ON 30
ci_032                 4.542527e-03 3 1  ON 31
ci_033                 2.362989e-03 3 1  ON 32
ci_034                 4.136331e-03 3 1  ON 33
ci_035                 1.723337e-03 3 1  ON 34
ci_036                 2.153803e-03 3 1  ON 35
ci_037                 3.539171e-03 3 1  ON 36
ci_038                 3.699860e-03 3 1  ON 37
ci_039                 4.622601e-03 3 1  ON 38
ci_040                 4.935343e-03 3 1  ON 39
ci_041                 2.970947e-03 3 1  ON 40
ci_042                 2.733709e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188821e-03 3 1  ON 43
ci_045                 2.451485e-03 3 1  ON 44
ci_046                 2.720987e-03 3 1  ON 45
ci_047                -1.002245e-03 3 1  ON 46
ci_048                -8.335463e-04 3 1  ON 47
ci_049                 7.787187e-04 3 1  ON 48
ci_050                 9.957069e-04 3 1  ON 49
ci_051                -3.143907e-04 3 1  ON 50
ci_052                -1.210983e-03 3 1  ON 51
ci_053                -2.434116e-03 3 1  ON 52
ci_054                -2.689571e-03 3 1  ON 53
ci_055                -1.798633e-03 3 1  ON 54
ci_056                -1.928969e-03 3 1  ON 55
ci_057                -1.307250e-03 3 1  ON 56
ci_058                -9.884008e-04 3 1  ON 57
ci_059                -5.511566e-04 3 1  ON 58
ci_060                -7.599932e-04 3 1  ON 59
ci_061                -5.116019e-05 3 1  ON 60
ci_062                -9.210206e-04 3 1  ON 61
ci_063                -8.859975e-04 3 1  ON 62
ci_064                -5.240753e-04 3 1  ON 63
ci_065                -1.359803e-03 3 1  ON 64
ci_066                -1.883860e-03 3 1  ON 65
ci_067                -1.812710e-03 3 1  ON 66
ci_068                -1.557118e-03 3 1  ON 67
ci_069                -5.541394e-04 3 1  ON 68
ci_070                -4.262806e-04 3 1  ON 69
ci_071                -2.088347e-03 3 1  ON 70
ci_072                -2.001075e-03 3 1  ON 71
ci_073                 1.611548e-04 3 1  ON 72
ci_074                 1.976845e-04 3 1  ON 73
ci_075                 1.616066e-04 3 1  ON 74
ci_076                 7.850871e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4260e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6246
    reference variance = 0.377863
====================================================
  Execution time = 2.5746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4656e-01
  Total weights = 1.954991617e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439017544712
                                         uncertainty =       0.001950638449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439017544712
                                         uncertainty =       0.001950638449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468547003
  error estimate for blocks of size 2^( 2) =       0.000492611912
  error estimate for blocks of size 2^( 3) =       0.000514811750
  error estimate for blocks of size 2^( 4) =       0.000531323773
  error estimate for blocks of size 2^( 5) =       0.000541803822
  error estimate for blocks of size 2^( 6) =       0.000547059160
  error estimate for blocks of size 2^( 7) =       0.000548564705

      target function =      -0.748157144959
              le_mean =     -22.662317847199
             les_mean =     514.027206358897
             stat err =       0.000542187865
             autocorr =       1.339039096874
   target nu stat err =       0.000542187865
   target dn stat err =       0.002270087404
      target stat err =       0.001970257833
              std dev =       0.662625526362
             le_variance =       0.439072588186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266231784720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748161408269       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748161417256       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748161418956       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748161419237       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748161419207       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748161419326       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748161419353       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748161419361       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748161419361       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748161419376       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748161419374       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+03 is 1.420758e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748161408269       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748161410515       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748161410941       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748161411011       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748161411010       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748161411025       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748161411037       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748161411035       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748161411041       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748161411045       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748161411035       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+03 is 3.551897e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748161408269       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748161408830       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748161408937       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748161408954       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748161408954       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748161408938       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748161408965       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748161408962       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748161408991       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748161408961       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748161408963       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+04 is 8.879743e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060769 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0516e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013056e-02 3 1  ON 2
ci_004                -5.100238e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981768e-02 3 1  ON 5
ci_007                 1.474644e-02 3 1  ON 6
ci_008                 1.554136e-02 3 1  ON 7
ci_009                -1.320266e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911152e-03 3 1  ON 10
ci_012                -9.099680e-03 3 1  ON 11
ci_013                 8.350011e-03 3 1  ON 12
ci_014                 9.370455e-03 3 1  ON 13
ci_015                 9.520687e-03 3 1  ON 14
ci_016                 9.413520e-03 3 1  ON 15
ci_017                 8.493818e-03 3 1  ON 16
ci_018                 8.286934e-03 3 1  ON 17
ci_019                -1.221497e-03 3 1  ON 18
ci_020                -1.534347e-03 3 1  ON 19
ci_021                -1.177665e-02 3 1  ON 20
ci_022                -1.179796e-02 3 1  ON 21
ci_023                 4.854175e-03 3 1  ON 22
ci_024                 4.919612e-03 3 1  ON 23
ci_025                 1.143506e-02 3 1  ON 24
ci_026                 1.147156e-02 3 1  ON 25
ci_027                 6.467263e-03 3 1  ON 26
ci_028                 6.188158e-03 3 1  ON 27
ci_029                -5.082868e-03 3 1  ON 28
ci_030                -4.170417e-03 3 1  ON 29
ci_031                 3.328012e-03 3 1  ON 30
ci_032                 4.542545e-03 3 1  ON 31
ci_033                 2.362995e-03 3 1  ON 32
ci_034                 4.136326e-03 3 1  ON 33
ci_035                 1.723336e-03 3 1  ON 34
ci_036                 2.153795e-03 3 1  ON 35
ci_037                 3.539171e-03 3 1  ON 36
ci_038                 3.699857e-03 3 1  ON 37
ci_039                 4.622602e-03 3 1  ON 38
ci_040                 4.935334e-03 3 1  ON 39
ci_041                 2.970940e-03 3 1  ON 40
ci_042                 2.733709e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188818e-03 3 1  ON 43
ci_045                 2.451492e-03 3 1  ON 44
ci_046                 2.720994e-03 3 1  ON 45
ci_047                -1.002245e-03 3 1  ON 46
ci_048                -8.335567e-04 3 1  ON 47
ci_049                 7.787227e-04 3 1  ON 48
ci_050                 9.956986e-04 3 1  ON 49
ci_051                -3.143914e-04 3 1  ON 50
ci_052                -1.210987e-03 3 1  ON 51
ci_053                -2.434125e-03 3 1  ON 52
ci_054                -2.689571e-03 3 1  ON 53
ci_055                -1.798620e-03 3 1  ON 54
ci_056                -1.928983e-03 3 1  ON 55
ci_057                -1.307256e-03 3 1  ON 56
ci_058                -9.883954e-04 3 1  ON 57
ci_059                -5.511545e-04 3 1  ON 58
ci_060                -7.599894e-04 3 1  ON 59
ci_061                -5.116313e-05 3 1  ON 60
ci_062                -9.210186e-04 3 1  ON 61
ci_063                -8.859958e-04 3 1  ON 62
ci_064                -5.240760e-04 3 1  ON 63
ci_065                -1.359801e-03 3 1  ON 64
ci_066                -1.883856e-03 3 1  ON 65
ci_067                -1.812705e-03 3 1  ON 66
ci_068                -1.557112e-03 3 1  ON 67
ci_069                -5.541374e-04 3 1  ON 68
ci_070                -4.262724e-04 3 1  ON 69
ci_071                -2.088338e-03 3 1  ON 70
ci_072                -2.001073e-03 3 1  ON 71
ci_073                 1.611520e-04 3 1  ON 72
ci_074                 1.976844e-04 3 1  ON 73
ci_075                 1.616123e-04 3 1  ON 74
ci_076                 7.850890e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6457
    reference variance = 0.327281
====================================================
  Execution time = 2.5222e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4605e-01
  Total weights = 1.9553e+06
  Execution time = 3.6371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583887069
                                         uncertainty =       0.001712569237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583887069
                                         uncertainty =       0.001712569237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467180668
  error estimate for blocks of size 2^( 2) =       0.000491363542
  error estimate for blocks of size 2^( 3) =       0.000513307454
  error estimate for blocks of size 2^( 4) =       0.000528842333
  error estimate for blocks of size 2^( 5) =       0.000537716151
  error estimate for blocks of size 2^( 6) =       0.000543582057
  error estimate for blocks of size 2^( 7) =       0.000545754406

      target function =      -0.748572189255
              le_mean =     -22.662461317979
             les_mean =     514.033207583370
             stat err =       0.000538973737
             autocorr =       1.330961458420
   target nu stat err =       0.000538973737
   target dn stat err =       0.002713628110
      target stat err =       0.002324368564
              std dev =       0.660693237006
             le_variance =       0.436515553426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583847946
                                         uncertainty =       0.001712565735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583847946
                                         uncertainty =       0.001712565735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467180647
  error estimate for blocks of size 2^( 2) =       0.000491363523
  error estimate for blocks of size 2^( 3) =       0.000513307437
  error estimate for blocks of size 2^( 4) =       0.000528842318
  error estimate for blocks of size 2^( 5) =       0.000537716139
  error estimate for blocks of size 2^( 6) =       0.000543582046
  error estimate for blocks of size 2^( 7) =       0.000545754394

      target function =      -0.748571853000
              le_mean =     -22.662461318065
             les_mean =     514.033207993434
             stat err =       0.000538973724
             autocorr =       1.330961516035
   target nu stat err =       0.000538973724
   target dn stat err =       0.002713628908
      target stat err =       0.002324367180
              std dev =       0.660693207478
             le_variance =       0.436515514408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583867507
                                         uncertainty =       0.001712567486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583867507
                                         uncertainty =       0.001712567486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467180658
  error estimate for blocks of size 2^( 2) =       0.000491363533
  error estimate for blocks of size 2^( 3) =       0.000513307445
  error estimate for blocks of size 2^( 4) =       0.000528842325
  error estimate for blocks of size 2^( 5) =       0.000537716145
  error estimate for blocks of size 2^( 6) =       0.000543582051
  error estimate for blocks of size 2^( 7) =       0.000545754400

      target function =      -0.748572021349
              le_mean =     -22.662461318022
             les_mean =     514.033207788133
             stat err =       0.000538973730
             autocorr =       1.330961487227
   target nu stat err =       0.000538973730
   target dn stat err =       0.002713628495
      target stat err =       0.002324367862
              std dev =       0.660693222242
             le_variance =       0.436515533916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583884624
                                         uncertainty =       0.001712569019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436583884624
                                         uncertainty =       0.001712569019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467180667
  error estimate for blocks of size 2^( 2) =       0.000491363541
  error estimate for blocks of size 2^( 3) =       0.000513307453
  error estimate for blocks of size 2^( 4) =       0.000528842332
  error estimate for blocks of size 2^( 5) =       0.000537716150
  error estimate for blocks of size 2^( 6) =       0.000543582056
  error estimate for blocks of size 2^( 7) =       0.000545754405

      target function =      -0.748572168291
              le_mean =     -22.662461317984
             les_mean =     514.033207608936
             stat err =       0.000538973736
             autocorr =       1.330961462018
   target nu stat err =       0.000538973736
   target dn stat err =       0.002713628157
      target stat err =       0.002324368475
              std dev =       0.660693235160
             le_variance =       0.436515550987


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748572189255        initial  <--
     1.5625e+03     1.5625e+04             1.4208e-07        -0.748571853000
     6.2500e+03     6.2500e+04             3.5519e-08        -0.748572021349
     2.5000e+04     2.5000e+05             8.8797e-09        -0.748572168291

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4250
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981769e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554136e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911157e-03 3 1  ON 10
ci_012                -9.099694e-03 3 1  ON 11
ci_013                 8.350026e-03 3 1  ON 12
ci_014                 9.370464e-03 3 1  ON 13
ci_015                 9.520699e-03 3 1  ON 14
ci_016                 9.413536e-03 3 1  ON 15
ci_017                 8.493815e-03 3 1  ON 16
ci_018                 8.286931e-03 3 1  ON 17
ci_019                -1.221468e-03 3 1  ON 18
ci_020                -1.534324e-03 3 1  ON 19
ci_021                -1.177666e-02 3 1  ON 20
ci_022                -1.179794e-02 3 1  ON 21
ci_023                 4.854183e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143504e-02 3 1  ON 24
ci_026                 1.147156e-02 3 1  ON 25
ci_027                 6.467265e-03 3 1  ON 26
ci_028                 6.188162e-03 3 1  ON 27
ci_029                -5.082874e-03 3 1  ON 28
ci_030                -4.170418e-03 3 1  ON 29
ci_031                 3.327987e-03 3 1  ON 30
ci_032                 4.542527e-03 3 1  ON 31
ci_033                 2.362989e-03 3 1  ON 32
ci_034                 4.136331e-03 3 1  ON 33
ci_035                 1.723337e-03 3 1  ON 34
ci_036                 2.153803e-03 3 1  ON 35
ci_037                 3.539171e-03 3 1  ON 36
ci_038                 3.699860e-03 3 1  ON 37
ci_039                 4.622601e-03 3 1  ON 38
ci_040                 4.935343e-03 3 1  ON 39
ci_041                 2.970947e-03 3 1  ON 40
ci_042                 2.733709e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188821e-03 3 1  ON 43
ci_045                 2.451485e-03 3 1  ON 44
ci_046                 2.720987e-03 3 1  ON 45
ci_047                -1.002245e-03 3 1  ON 46
ci_048                -8.335463e-04 3 1  ON 47
ci_049                 7.787187e-04 3 1  ON 48
ci_050                 9.957069e-04 3 1  ON 49
ci_051                -3.143907e-04 3 1  ON 50
ci_052                -1.210983e-03 3 1  ON 51
ci_053                -2.434116e-03 3 1  ON 52
ci_054                -2.689571e-03 3 1  ON 53
ci_055                -1.798633e-03 3 1  ON 54
ci_056                -1.928969e-03 3 1  ON 55
ci_057                -1.307250e-03 3 1  ON 56
ci_058                -9.884008e-04 3 1  ON 57
ci_059                -5.511566e-04 3 1  ON 58
ci_060                -7.599932e-04 3 1  ON 59
ci_061                -5.116019e-05 3 1  ON 60
ci_062                -9.210206e-04 3 1  ON 61
ci_063                -8.859975e-04 3 1  ON 62
ci_064                -5.240753e-04 3 1  ON 63
ci_065                -1.359803e-03 3 1  ON 64
ci_066                -1.883860e-03 3 1  ON 65
ci_067                -1.812710e-03 3 1  ON 66
ci_068                -1.557118e-03 3 1  ON 67
ci_069                -5.541394e-04 3 1  ON 68
ci_070                -4.262806e-04 3 1  ON 69
ci_071                -2.088347e-03 3 1  ON 70
ci_072                -2.001075e-03 3 1  ON 71
ci_073                 1.611548e-04 3 1  ON 72
ci_074                 1.976845e-04 3 1  ON 73
ci_075                 1.616066e-04 3 1  ON 74
ci_076                 7.850871e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6513
    reference variance = 0.832185
====================================================
  Execution time = 2.5896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5351e-01
  Total weights = 1.955208807e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442468890688
                                         uncertainty =       0.002367440174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442468890688
                                         uncertainty =       0.002367440174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470346442
  error estimate for blocks of size 2^( 2) =       0.000494635617
  error estimate for blocks of size 2^( 3) =       0.000517505326
  error estimate for blocks of size 2^( 4) =       0.000533616120
  error estimate for blocks of size 2^( 5) =       0.000543294877
  error estimate for blocks of size 2^( 6) =       0.000547048375
  error estimate for blocks of size 2^( 7) =       0.000551803715

      target function =      -0.742450712683
              le_mean =     -22.661976202033
             les_mean =     514.018670943883
             stat err =       0.000543940772
             autocorr =       1.337419034479
   target nu stat err =       0.000543940772
   target dn stat err =       0.002788454315
      target stat err =       0.002346374112
              std dev =       0.665170317716
             le_variance =       0.442451551571


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266197620203e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742457236242       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742457237670       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742457237945       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742457237963       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742457237969       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742457237947       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742457237976       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742457237974       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742457237950       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742457237973       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742457237973       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+04 is 1.713343e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742457236242       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742457236599       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742457236668       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742457236667       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742457236682       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742457236627       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742457236796       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742457236917       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742457236670       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742457236662       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742457236640       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+04 is 4.283366e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742457236242       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742457236331       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742457236349       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742457236350       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742457236358       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742457236459       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742457237066       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742457235673       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742457236183       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742457236483       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742457236180       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+05 is 1.070842e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0628e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981769e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554136e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911156e-03 3 1  ON 10
ci_012                -9.099694e-03 3 1  ON 11
ci_013                 8.350025e-03 3 1  ON 12
ci_014                 9.370463e-03 3 1  ON 13
ci_015                 9.520697e-03 3 1  ON 14
ci_016                 9.413535e-03 3 1  ON 15
ci_017                 8.493815e-03 3 1  ON 16
ci_018                 8.286930e-03 3 1  ON 17
ci_019                -1.221472e-03 3 1  ON 18
ci_020                -1.534326e-03 3 1  ON 19
ci_021                -1.177666e-02 3 1  ON 20
ci_022                -1.179794e-02 3 1  ON 21
ci_023                 4.854183e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143504e-02 3 1  ON 24
ci_026                 1.147156e-02 3 1  ON 25
ci_027                 6.467264e-03 3 1  ON 26
ci_028                 6.188162e-03 3 1  ON 27
ci_029                -5.082872e-03 3 1  ON 28
ci_030                -4.170418e-03 3 1  ON 29
ci_031                 3.327987e-03 3 1  ON 30
ci_032                 4.542529e-03 3 1  ON 31
ci_033                 2.362989e-03 3 1  ON 32
ci_034                 4.136330e-03 3 1  ON 33
ci_035                 1.723337e-03 3 1  ON 34
ci_036                 2.153802e-03 3 1  ON 35
ci_037                 3.539170e-03 3 1  ON 36
ci_038                 3.699859e-03 3 1  ON 37
ci_039                 4.622601e-03 3 1  ON 38
ci_040                 4.935344e-03 3 1  ON 39
ci_041                 2.970946e-03 3 1  ON 40
ci_042                 2.733710e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188821e-03 3 1  ON 43
ci_045                 2.451486e-03 3 1  ON 44
ci_046                 2.720988e-03 3 1  ON 45
ci_047                -1.002245e-03 3 1  ON 46
ci_048                -8.335464e-04 3 1  ON 47
ci_049                 7.787189e-04 3 1  ON 48
ci_050                 9.957056e-04 3 1  ON 49
ci_051                -3.143912e-04 3 1  ON 50
ci_052                -1.210984e-03 3 1  ON 51
ci_053                -2.434116e-03 3 1  ON 52
ci_054                -2.689570e-03 3 1  ON 53
ci_055                -1.798633e-03 3 1  ON 54
ci_056                -1.928969e-03 3 1  ON 55
ci_057                -1.307251e-03 3 1  ON 56
ci_058                -9.883991e-04 3 1  ON 57
ci_059                -5.511571e-04 3 1  ON 58
ci_060                -7.599924e-04 3 1  ON 59
ci_061                -5.115915e-05 3 1  ON 60
ci_062                -9.210211e-04 3 1  ON 61
ci_063                -8.859983e-04 3 1  ON 62
ci_064                -5.240755e-04 3 1  ON 63
ci_065                -1.359804e-03 3 1  ON 64
ci_066                -1.883859e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.557120e-03 3 1  ON 67
ci_069                -5.541401e-04 3 1  ON 68
ci_070                -4.262801e-04 3 1  ON 69
ci_071                -2.088346e-03 3 1  ON 70
ci_072                -2.001073e-03 3 1  ON 71
ci_073                 1.611543e-04 3 1  ON 72
ci_074                 1.976839e-04 3 1  ON 73
ci_075                 1.616066e-04 3 1  ON 74
ci_076                 7.850869e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6572
    reference variance = 0.266786
====================================================
  Execution time = 2.5489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4543e-01
  Total weights = 1.9550e+06
  Execution time = 3.6090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437058931908
                                         uncertainty =       0.001967645495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437058931908
                                         uncertainty =       0.001967645495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467480365
  error estimate for blocks of size 2^( 2) =       0.000491310533
  error estimate for blocks of size 2^( 3) =       0.000513599196
  error estimate for blocks of size 2^( 4) =       0.000529824322
  error estimate for blocks of size 2^( 5) =       0.000538775686
  error estimate for blocks of size 2^( 6) =       0.000543255971
  error estimate for blocks of size 2^( 7) =       0.000545220322

      target function =      -0.749099795484
              le_mean =     -22.662741288831
             les_mean =     514.045267842719
             stat err =       0.000539269075
             autocorr =       1.330712646243
   target nu stat err =       0.000539269075
   target dn stat err =       0.002324472792
      target stat err =       0.002018297380
              std dev =       0.661117071676
             le_variance =       0.437075782461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437058928920
                                         uncertainty =       0.001967645333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437058928920
                                         uncertainty =       0.001967645333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467480363
  error estimate for blocks of size 2^( 2) =       0.000491310532
  error estimate for blocks of size 2^( 3) =       0.000513599195
  error estimate for blocks of size 2^( 4) =       0.000529824321
  error estimate for blocks of size 2^( 5) =       0.000538775685
  error estimate for blocks of size 2^( 6) =       0.000543255970
  error estimate for blocks of size 2^( 7) =       0.000545220321

      target function =      -0.749099796333
              le_mean =     -22.662741288959
             les_mean =     514.045267847522
             stat err =       0.000539269074
             autocorr =       1.330712650704
   target nu stat err =       0.000539269074
   target dn stat err =       0.002324472261
      target stat err =       0.002018296964
              std dev =       0.661117069421
             le_variance =       0.437075779480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437058930414
                                         uncertainty =       0.001967645414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437058930414
                                         uncertainty =       0.001967645414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467480364
  error estimate for blocks of size 2^( 2) =       0.000491310532
  error estimate for blocks of size 2^( 3) =       0.000513599196
  error estimate for blocks of size 2^( 4) =       0.000529824322
  error estimate for blocks of size 2^( 5) =       0.000538775686
  error estimate for blocks of size 2^( 6) =       0.000543255970
  error estimate for blocks of size 2^( 7) =       0.000545220322

      target function =      -0.749099795909
              le_mean =     -22.662741288895
             les_mean =     514.045267845120
             stat err =       0.000539269075
             autocorr =       1.330712648467
   target nu stat err =       0.000539269075
   target dn stat err =       0.002324472526
      target stat err =       0.002018297172
              std dev =       0.661117070548
             le_variance =       0.437075780970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437058931721
                                         uncertainty =       0.001967645485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437058931721
                                         uncertainty =       0.001967645485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467480364
  error estimate for blocks of size 2^( 2) =       0.000491310533
  error estimate for blocks of size 2^( 3) =       0.000513599196
  error estimate for blocks of size 2^( 4) =       0.000529824322
  error estimate for blocks of size 2^( 5) =       0.000538775686
  error estimate for blocks of size 2^( 6) =       0.000543255970
  error estimate for blocks of size 2^( 7) =       0.000545220322

      target function =      -0.749099795537
              le_mean =     -22.662741288839
             les_mean =     514.045267843019
             stat err =       0.000539269075
             autocorr =       1.330712646513
   target nu stat err =       0.000539269075
   target dn stat err =       0.002324472759
      target stat err =       0.002018297354
              std dev =       0.661117071535
             le_variance =       0.437075782274


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749099795484        initial
     1.5625e+04     1.5625e+05             1.7133e-08        -0.749099796333  <--
     6.2500e+04     6.2500e+05             4.2834e-09        -0.749099795909
     2.5000e+05     2.5000e+06             1.0708e-09        -0.749099795537

*****************************************************************************
Applying the update for shift_i =   1.5625e+04     and shift_s =   1.5625e+05
*****************************************************************************

  Execution time = 4.3590e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981768e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554135e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911150e-03 3 1  ON 10
ci_012                -9.099694e-03 3 1  ON 11
ci_013                 8.350021e-03 3 1  ON 12
ci_014                 9.370458e-03 3 1  ON 13
ci_015                 9.520693e-03 3 1  ON 14
ci_016                 9.413534e-03 3 1  ON 15
ci_017                 8.493815e-03 3 1  ON 16
ci_018                 8.286927e-03 3 1  ON 17
ci_019                -1.221485e-03 3 1  ON 18
ci_020                -1.534331e-03 3 1  ON 19
ci_021                -1.177667e-02 3 1  ON 20
ci_022                -1.179795e-02 3 1  ON 21
ci_023                 4.854183e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143505e-02 3 1  ON 24
ci_026                 1.147156e-02 3 1  ON 25
ci_027                 6.467263e-03 3 1  ON 26
ci_028                 6.188164e-03 3 1  ON 27
ci_029                -5.082866e-03 3 1  ON 28
ci_030                -4.170418e-03 3 1  ON 29
ci_031                 3.327987e-03 3 1  ON 30
ci_032                 4.542536e-03 3 1  ON 31
ci_033                 2.362988e-03 3 1  ON 32
ci_034                 4.136328e-03 3 1  ON 33
ci_035                 1.723337e-03 3 1  ON 34
ci_036                 2.153800e-03 3 1  ON 35
ci_037                 3.539168e-03 3 1  ON 36
ci_038                 3.699857e-03 3 1  ON 37
ci_039                 4.622601e-03 3 1  ON 38
ci_040                 4.935344e-03 3 1  ON 39
ci_041                 2.970944e-03 3 1  ON 40
ci_042                 2.733711e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188821e-03 3 1  ON 43
ci_045                 2.451487e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002247e-03 3 1  ON 46
ci_048                -8.335468e-04 3 1  ON 47
ci_049                 7.787194e-04 3 1  ON 48
ci_050                 9.957016e-04 3 1  ON 49
ci_051                -3.143930e-04 3 1  ON 50
ci_052                -1.210986e-03 3 1  ON 51
ci_053                -2.434116e-03 3 1  ON 52
ci_054                -2.689569e-03 3 1  ON 53
ci_055                -1.798634e-03 3 1  ON 54
ci_056                -1.928968e-03 3 1  ON 55
ci_057                -1.307253e-03 3 1  ON 56
ci_058                -9.883942e-04 3 1  ON 57
ci_059                -5.511584e-04 3 1  ON 58
ci_060                -7.599899e-04 3 1  ON 59
ci_061                -5.115603e-05 3 1  ON 60
ci_062                -9.210225e-04 3 1  ON 61
ci_063                -8.860007e-04 3 1  ON 62
ci_064                -5.240760e-04 3 1  ON 63
ci_065                -1.359807e-03 3 1  ON 64
ci_066                -1.883854e-03 3 1  ON 65
ci_067                -1.812714e-03 3 1  ON 66
ci_068                -1.557123e-03 3 1  ON 67
ci_069                -5.541422e-04 3 1  ON 68
ci_070                -4.262789e-04 3 1  ON 69
ci_071                -2.088343e-03 3 1  ON 70
ci_072                -2.001070e-03 3 1  ON 71
ci_073                 1.611527e-04 3 1  ON 72
ci_074                 1.976822e-04 3 1  ON 73
ci_075                 1.616065e-04 3 1  ON 74
ci_076                 7.850864e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4225e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6709
    reference variance = 0.343082
====================================================
  Execution time = 2.7735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5851e-01
  Total weights = 1.955366252e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448266895811
                                         uncertainty =       0.007419524400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448266895811
                                         uncertainty =       0.007419524400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473385232
  error estimate for blocks of size 2^( 2) =       0.000497387263
  error estimate for blocks of size 2^( 3) =       0.000519348662
  error estimate for blocks of size 2^( 4) =       0.000534950824
  error estimate for blocks of size 2^( 5) =       0.000544247436
  error estimate for blocks of size 2^( 6) =       0.000548124145
  error estimate for blocks of size 2^( 7) =       0.000550102947

      target function =      -0.738354368259
              le_mean =     -22.662348177642
             les_mean =     514.040537187054
             stat err =       0.000544356338
             autocorr =       1.322321797301
   target nu stat err =       0.000544356338
   target dn stat err =       0.007655189078
      target stat err =       0.006193815150
              std dev =       0.669467815180
             le_variance =       0.448187155561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266234817764e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738404794291       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738404801824       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738404803320       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738404803874       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738404804156       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738404804260       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738404804290       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738404804272       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738404804295       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738404804284       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738404804287       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738404804278       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+03 is 1.295790e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738404794291       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738404796174       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738404796548       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738404796687       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738404796757       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738404796783       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738404796790       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738404796787       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738404796791       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738404796790       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738404796777       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738404796790       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+04 is 3.239484e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738404794291       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738404794762       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738404794855       residual = 8.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738404794890       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738404794908       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738404794914       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738404794916       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738404795088       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738404794835       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738404794916       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738404794831       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738404794897       residual = 1.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+04 is 8.098715e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2512e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013060e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949616e-02 3 1  ON 4
ci_006                 1.981767e-02 3 1  ON 5
ci_007                 1.474644e-02 3 1  ON 6
ci_008                 1.554135e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911149e-03 3 1  ON 10
ci_012                -9.099695e-03 3 1  ON 11
ci_013                 8.350020e-03 3 1  ON 12
ci_014                 9.370446e-03 3 1  ON 13
ci_015                 9.520686e-03 3 1  ON 14
ci_016                 9.413528e-03 3 1  ON 15
ci_017                 8.493813e-03 3 1  ON 16
ci_018                 8.286933e-03 3 1  ON 17
ci_019                -1.221493e-03 3 1  ON 18
ci_020                -1.534349e-03 3 1  ON 19
ci_021                -1.177666e-02 3 1  ON 20
ci_022                -1.179797e-02 3 1  ON 21
ci_023                 4.854181e-03 3 1  ON 22
ci_024                 4.919611e-03 3 1  ON 23
ci_025                 1.143505e-02 3 1  ON 24
ci_026                 1.147157e-02 3 1  ON 25
ci_027                 6.467263e-03 3 1  ON 26
ci_028                 6.188159e-03 3 1  ON 27
ci_029                -5.082860e-03 3 1  ON 28
ci_030                -4.170416e-03 3 1  ON 29
ci_031                 3.328000e-03 3 1  ON 30
ci_032                 4.542533e-03 3 1  ON 31
ci_033                 2.362992e-03 3 1  ON 32
ci_034                 4.136322e-03 3 1  ON 33
ci_035                 1.723335e-03 3 1  ON 34
ci_036                 2.153803e-03 3 1  ON 35
ci_037                 3.539156e-03 3 1  ON 36
ci_038                 3.699856e-03 3 1  ON 37
ci_039                 4.622599e-03 3 1  ON 38
ci_040                 4.935342e-03 3 1  ON 39
ci_041                 2.970941e-03 3 1  ON 40
ci_042                 2.733709e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188821e-03 3 1  ON 43
ci_045                 2.451487e-03 3 1  ON 44
ci_046                 2.720995e-03 3 1  ON 45
ci_047                -1.002245e-03 3 1  ON 46
ci_048                -8.335467e-04 3 1  ON 47
ci_049                 7.787184e-04 3 1  ON 48
ci_050                 9.957014e-04 3 1  ON 49
ci_051                -3.143970e-04 3 1  ON 50
ci_052                -1.210985e-03 3 1  ON 51
ci_053                -2.434117e-03 3 1  ON 52
ci_054                -2.689564e-03 3 1  ON 53
ci_055                -1.798631e-03 3 1  ON 54
ci_056                -1.928968e-03 3 1  ON 55
ci_057                -1.307252e-03 3 1  ON 56
ci_058                -9.883939e-04 3 1  ON 57
ci_059                -5.511565e-04 3 1  ON 58
ci_060                -7.599870e-04 3 1  ON 59
ci_061                -5.116012e-05 3 1  ON 60
ci_062                -9.210231e-04 3 1  ON 61
ci_063                -8.859870e-04 3 1  ON 62
ci_064                -5.240689e-04 3 1  ON 63
ci_065                -1.359811e-03 3 1  ON 64
ci_066                -1.883854e-03 3 1  ON 65
ci_067                -1.812709e-03 3 1  ON 66
ci_068                -1.557125e-03 3 1  ON 67
ci_069                -5.541392e-04 3 1  ON 68
ci_070                -4.262801e-04 3 1  ON 69
ci_071                -2.088337e-03 3 1  ON 70
ci_072                -2.001068e-03 3 1  ON 71
ci_073                 1.611534e-04 3 1  ON 72
ci_074                 1.976787e-04 3 1  ON 73
ci_075                 1.616055e-04 3 1  ON 74
ci_076                 7.850894e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6653
    reference variance = 0.818991
====================================================
  Execution time = 2.5297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5498e-01
  Total weights = 1.9554e+06
  Execution time = 3.6335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445473608092
                                         uncertainty =       0.005448601738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445473608092
                                         uncertainty =       0.005448601738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471924996
  error estimate for blocks of size 2^( 2) =       0.000496037898
  error estimate for blocks of size 2^( 3) =       0.000518370733
  error estimate for blocks of size 2^( 4) =       0.000534834211
  error estimate for blocks of size 2^( 5) =       0.000543317509
  error estimate for blocks of size 2^( 6) =       0.000547968318
  error estimate for blocks of size 2^( 7) =       0.000550908431

      target function =      -0.741235938631
              le_mean =     -22.662504590701
             les_mean =     514.044091145117
             stat err =       0.000544257117
             autocorr =       1.330032560243
   target nu stat err =       0.000544257117
   target dn stat err =       0.005696302746
      target stat err =       0.004662719188
              std dev =       0.667402729214
             le_variance =       0.445426402962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445473613893
                                         uncertainty =       0.005448609450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445473613893
                                         uncertainty =       0.005448609450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471924999
  error estimate for blocks of size 2^( 2) =       0.000496037902
  error estimate for blocks of size 2^( 3) =       0.000518370739
  error estimate for blocks of size 2^( 4) =       0.000534834218
  error estimate for blocks of size 2^( 5) =       0.000543317516
  error estimate for blocks of size 2^( 6) =       0.000547968326
  error estimate for blocks of size 2^( 7) =       0.000550908438

      target function =      -0.741235694707
              le_mean =     -22.662504591388
             les_mean =     514.044091476831
             stat err =       0.000544257124
             autocorr =       1.330032578375
   target nu stat err =       0.000544257124
   target dn stat err =       0.005696295416
      target stat err =       0.004662710247
              std dev =       0.667402733531
             le_variance =       0.445426408724

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445473610993
                                         uncertainty =       0.005448605594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445473610993
                                         uncertainty =       0.005448605594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471924997
  error estimate for blocks of size 2^( 2) =       0.000496037900
  error estimate for blocks of size 2^( 3) =       0.000518370736
  error estimate for blocks of size 2^( 4) =       0.000534834215
  error estimate for blocks of size 2^( 5) =       0.000543317512
  error estimate for blocks of size 2^( 6) =       0.000547968322
  error estimate for blocks of size 2^( 7) =       0.000550908435

      target function =      -0.741235820828
              le_mean =     -22.662504591045
             les_mean =     514.044091305852
             stat err =       0.000544257121
             autocorr =       1.330032569312
   target nu stat err =       0.000544257121
   target dn stat err =       0.005696299065
      target stat err =       0.004662714756
              std dev =       0.667402731372
             le_variance =       0.445426405843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445473608455
                                         uncertainty =       0.005448602220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445473608455
                                         uncertainty =       0.005448602220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471924996
  error estimate for blocks of size 2^( 2) =       0.000496037898
  error estimate for blocks of size 2^( 3) =       0.000518370734
  error estimate for blocks of size 2^( 4) =       0.000534834212
  error estimate for blocks of size 2^( 5) =       0.000543317509
  error estimate for blocks of size 2^( 6) =       0.000547968318
  error estimate for blocks of size 2^( 7) =       0.000550908431

      target function =      -0.741235924343
              le_mean =     -22.662504590744
             les_mean =     514.044091164670
             stat err =       0.000544257118
             autocorr =       1.330032561374
   target nu stat err =       0.000544257118
   target dn stat err =       0.005696302284
      target stat err =       0.004662718638
              std dev =       0.667402729484
             le_variance =       0.445426403322


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741235938631        initial  <--
     3.9062e+03     3.9062e+04             1.2958e-07        -0.741235694707
     1.5625e+04     1.5625e+05             3.2395e-08        -0.741235820828
     6.2500e+04     6.2500e+05             8.0987e-09        -0.741235924343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.2216
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981768e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554135e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911150e-03 3 1  ON 10
ci_012                -9.099694e-03 3 1  ON 11
ci_013                 8.350021e-03 3 1  ON 12
ci_014                 9.370458e-03 3 1  ON 13
ci_015                 9.520693e-03 3 1  ON 14
ci_016                 9.413534e-03 3 1  ON 15
ci_017                 8.493815e-03 3 1  ON 16
ci_018                 8.286927e-03 3 1  ON 17
ci_019                -1.221485e-03 3 1  ON 18
ci_020                -1.534331e-03 3 1  ON 19
ci_021                -1.177667e-02 3 1  ON 20
ci_022                -1.179795e-02 3 1  ON 21
ci_023                 4.854183e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143505e-02 3 1  ON 24
ci_026                 1.147156e-02 3 1  ON 25
ci_027                 6.467263e-03 3 1  ON 26
ci_028                 6.188164e-03 3 1  ON 27
ci_029                -5.082866e-03 3 1  ON 28
ci_030                -4.170418e-03 3 1  ON 29
ci_031                 3.327987e-03 3 1  ON 30
ci_032                 4.542536e-03 3 1  ON 31
ci_033                 2.362988e-03 3 1  ON 32
ci_034                 4.136328e-03 3 1  ON 33
ci_035                 1.723337e-03 3 1  ON 34
ci_036                 2.153800e-03 3 1  ON 35
ci_037                 3.539168e-03 3 1  ON 36
ci_038                 3.699857e-03 3 1  ON 37
ci_039                 4.622601e-03 3 1  ON 38
ci_040                 4.935344e-03 3 1  ON 39
ci_041                 2.970944e-03 3 1  ON 40
ci_042                 2.733711e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188821e-03 3 1  ON 43
ci_045                 2.451487e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002247e-03 3 1  ON 46
ci_048                -8.335468e-04 3 1  ON 47
ci_049                 7.787194e-04 3 1  ON 48
ci_050                 9.957016e-04 3 1  ON 49
ci_051                -3.143930e-04 3 1  ON 50
ci_052                -1.210986e-03 3 1  ON 51
ci_053                -2.434116e-03 3 1  ON 52
ci_054                -2.689569e-03 3 1  ON 53
ci_055                -1.798634e-03 3 1  ON 54
ci_056                -1.928968e-03 3 1  ON 55
ci_057                -1.307253e-03 3 1  ON 56
ci_058                -9.883942e-04 3 1  ON 57
ci_059                -5.511584e-04 3 1  ON 58
ci_060                -7.599899e-04 3 1  ON 59
ci_061                -5.115603e-05 3 1  ON 60
ci_062                -9.210225e-04 3 1  ON 61
ci_063                -8.860007e-04 3 1  ON 62
ci_064                -5.240760e-04 3 1  ON 63
ci_065                -1.359807e-03 3 1  ON 64
ci_066                -1.883854e-03 3 1  ON 65
ci_067                -1.812714e-03 3 1  ON 66
ci_068                -1.557123e-03 3 1  ON 67
ci_069                -5.541422e-04 3 1  ON 68
ci_070                -4.262789e-04 3 1  ON 69
ci_071                -2.088343e-03 3 1  ON 70
ci_072                -2.001070e-03 3 1  ON 71
ci_073                 1.611527e-04 3 1  ON 72
ci_074                 1.976822e-04 3 1  ON 73
ci_075                 1.616065e-04 3 1  ON 74
ci_076                 7.850864e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.663
    reference variance = 0.256225
====================================================
  Execution time = 2.5774e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5240e-01
  Total weights = 1.955407911e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441100516489
                                         uncertainty =       0.002893727576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441100516489
                                         uncertainty =       0.002893727576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469581948
  error estimate for blocks of size 2^( 2) =       0.000493522801
  error estimate for blocks of size 2^( 3) =       0.000515858868
  error estimate for blocks of size 2^( 4) =       0.000532043856
  error estimate for blocks of size 2^( 5) =       0.000542363813
  error estimate for blocks of size 2^( 6) =       0.000546767656
  error estimate for blocks of size 2^( 7) =       0.000548151694

      target function =      -0.743348384005
              le_mean =     -22.661777023237
             les_mean =     514.008533667082
             stat err =       0.000542331755
             autocorr =       1.333850887572
   target nu stat err =       0.000542331755
   target dn stat err =       0.003671509382
      target stat err =       0.003052935770
              std dev =       0.664089159153
             le_variance =       0.441014411305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266177702324e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743359937200       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743359937835       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743359937913       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743359937939       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743359937939       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743359937963       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743359937967       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743359938000       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743359937969       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743359938035       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743359937988       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743359937939       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+04 is 6.331743e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743359937200       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743359937358       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743359937378       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743359937384       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743359937388       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743359937390       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743359937391       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743359937537       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743359937158       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743359937340       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743359937448       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743359937519       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+05 is 1.582937e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743359937200       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743359937239       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743359937244       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743359937246       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743359937247       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743359937240       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743359937248       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743359936620       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743359937248       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743359938747       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743359936393       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743359936133       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+05 is 3.957344e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0515e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981768e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554135e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911150e-03 3 1  ON 10
ci_012                -9.099693e-03 3 1  ON 11
ci_013                 8.350021e-03 3 1  ON 12
ci_014                 9.370458e-03 3 1  ON 13
ci_015                 9.520693e-03 3 1  ON 14
ci_016                 9.413534e-03 3 1  ON 15
ci_017                 8.493815e-03 3 1  ON 16
ci_018                 8.286926e-03 3 1  ON 17
ci_019                -1.221486e-03 3 1  ON 18
ci_020                -1.534331e-03 3 1  ON 19
ci_021                -1.177667e-02 3 1  ON 20
ci_022                -1.179795e-02 3 1  ON 21
ci_023                 4.854183e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143505e-02 3 1  ON 24
ci_026                 1.147156e-02 3 1  ON 25
ci_027                 6.467263e-03 3 1  ON 26
ci_028                 6.188165e-03 3 1  ON 27
ci_029                -5.082864e-03 3 1  ON 28
ci_030                -4.170418e-03 3 1  ON 29
ci_031                 3.327987e-03 3 1  ON 30
ci_032                 4.542537e-03 3 1  ON 31
ci_033                 2.362989e-03 3 1  ON 32
ci_034                 4.136327e-03 3 1  ON 33
ci_035                 1.723337e-03 3 1  ON 34
ci_036                 2.153800e-03 3 1  ON 35
ci_037                 3.539168e-03 3 1  ON 36
ci_038                 3.699857e-03 3 1  ON 37
ci_039                 4.622601e-03 3 1  ON 38
ci_040                 4.935344e-03 3 1  ON 39
ci_041                 2.970944e-03 3 1  ON 40
ci_042                 2.733711e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188821e-03 3 1  ON 43
ci_045                 2.451487e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002247e-03 3 1  ON 46
ci_048                -8.335466e-04 3 1  ON 47
ci_049                 7.787196e-04 3 1  ON 48
ci_050                 9.957014e-04 3 1  ON 49
ci_051                -3.143926e-04 3 1  ON 50
ci_052                -1.210987e-03 3 1  ON 51
ci_053                -2.434116e-03 3 1  ON 52
ci_054                -2.689568e-03 3 1  ON 53
ci_055                -1.798634e-03 3 1  ON 54
ci_056                -1.928968e-03 3 1  ON 55
ci_057                -1.307253e-03 3 1  ON 56
ci_058                -9.883941e-04 3 1  ON 57
ci_059                -5.511582e-04 3 1  ON 58
ci_060                -7.599896e-04 3 1  ON 59
ci_061                -5.115602e-05 3 1  ON 60
ci_062                -9.210221e-04 3 1  ON 61
ci_063                -8.860006e-04 3 1  ON 62
ci_064                -5.240763e-04 3 1  ON 63
ci_065                -1.359807e-03 3 1  ON 64
ci_066                -1.883854e-03 3 1  ON 65
ci_067                -1.812713e-03 3 1  ON 66
ci_068                -1.557123e-03 3 1  ON 67
ci_069                -5.541419e-04 3 1  ON 68
ci_070                -4.262790e-04 3 1  ON 69
ci_071                -2.088343e-03 3 1  ON 70
ci_072                -2.001070e-03 3 1  ON 71
ci_073                 1.611527e-04 3 1  ON 72
ci_074                 1.976819e-04 3 1  ON 73
ci_075                 1.616068e-04 3 1  ON 74
ci_076                 7.850866e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6991
    reference variance = 0.249499
====================================================
  Execution time = 2.5117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4608e-01
  Total weights = 1.9553e+06
  Execution time = 3.6281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048269007
                                         uncertainty =       0.001564266153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048269007
                                         uncertainty =       0.001564266153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466992049
  error estimate for blocks of size 2^( 2) =       0.000490939406
  error estimate for blocks of size 2^( 3) =       0.000512946477
  error estimate for blocks of size 2^( 4) =       0.000529368437
  error estimate for blocks of size 2^( 5) =       0.000539287262
  error estimate for blocks of size 2^( 6) =       0.000543969912
  error estimate for blocks of size 2^( 7) =       0.000549299662

      target function =      -0.748542214739
              le_mean =     -22.661892325669
             les_mean =     514.007446832199
             stat err =       0.000540481318
             autocorr =       1.339499024003
   target nu stat err =       0.000540481318
   target dn stat err =       0.002236020312
      target stat err =       0.001943546923
              std dev =       0.660426489407
             le_variance =       0.436163147910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048267355
                                         uncertainty =       0.001564266083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048267355
                                         uncertainty =       0.001564266083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466992048
  error estimate for blocks of size 2^( 2) =       0.000490939406
  error estimate for blocks of size 2^( 3) =       0.000512946477
  error estimate for blocks of size 2^( 4) =       0.000529368436
  error estimate for blocks of size 2^( 5) =       0.000539287262
  error estimate for blocks of size 2^( 6) =       0.000543969911
  error estimate for blocks of size 2^( 7) =       0.000549299662

      target function =      -0.748542220394
              le_mean =     -22.661892325712
             les_mean =     514.007446827335
             stat err =       0.000540481318
             autocorr =       1.339499025637
   target nu stat err =       0.000540481318
   target dn stat err =       0.002236020061
      target stat err =       0.001943546754
              std dev =       0.660426488141
             le_variance =       0.436163146238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048268181
                                         uncertainty =       0.001564266118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048268181
                                         uncertainty =       0.001564266118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466992049
  error estimate for blocks of size 2^( 2) =       0.000490939406
  error estimate for blocks of size 2^( 3) =       0.000512946477
  error estimate for blocks of size 2^( 4) =       0.000529368437
  error estimate for blocks of size 2^( 5) =       0.000539287262
  error estimate for blocks of size 2^( 6) =       0.000543969911
  error estimate for blocks of size 2^( 7) =       0.000549299662

      target function =      -0.748542217567
              le_mean =     -22.661892325691
             les_mean =     514.007446829767
             stat err =       0.000540481318
             autocorr =       1.339499024829
   target nu stat err =       0.000540481318
   target dn stat err =       0.002236020186
      target stat err =       0.001943546838
              std dev =       0.660426488774
             le_variance =       0.436163147074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048268904
                                         uncertainty =       0.001564266148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436048268904
                                         uncertainty =       0.001564266148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466992049
  error estimate for blocks of size 2^( 2) =       0.000490939406
  error estimate for blocks of size 2^( 3) =       0.000512946477
  error estimate for blocks of size 2^( 4) =       0.000529368437
  error estimate for blocks of size 2^( 5) =       0.000539287262
  error estimate for blocks of size 2^( 6) =       0.000543969912
  error estimate for blocks of size 2^( 7) =       0.000549299662

      target function =      -0.748542215093
              le_mean =     -22.661892325672
             les_mean =     514.007446831895
             stat err =       0.000540481318
             autocorr =       1.339499024115
   target nu stat err =       0.000540481318
   target dn stat err =       0.002236020296
      target stat err =       0.001943546913
              std dev =       0.660426489328
             le_variance =       0.436163147806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748542214739        initial
     3.9062e+04     3.9062e+05             6.3317e-09        -0.748542220394  <--
     1.5625e+05     1.5625e+06             1.5829e-09        -0.748542217567
     6.2500e+05     6.2500e+06             3.9573e-10        -0.748542215093

*****************************************************************************
Applying the update for shift_i =   3.9062e+04     and shift_s =   3.9062e+05
*****************************************************************************

  Execution time = 4.3325e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981768e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554135e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911149e-03 3 1  ON 10
ci_012                -9.099692e-03 3 1  ON 11
ci_013                 8.350019e-03 3 1  ON 12
ci_014                 9.370459e-03 3 1  ON 13
ci_015                 9.520694e-03 3 1  ON 14
ci_016                 9.413533e-03 3 1  ON 15
ci_017                 8.493816e-03 3 1  ON 16
ci_018                 8.286923e-03 3 1  ON 17
ci_019                -1.221490e-03 3 1  ON 18
ci_020                -1.534332e-03 3 1  ON 19
ci_021                -1.177667e-02 3 1  ON 20
ci_022                -1.179796e-02 3 1  ON 21
ci_023                 4.854183e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143505e-02 3 1  ON 24
ci_026                 1.147156e-02 3 1  ON 25
ci_027                 6.467261e-03 3 1  ON 26
ci_028                 6.188166e-03 3 1  ON 27
ci_029                -5.082859e-03 3 1  ON 28
ci_030                -4.170418e-03 3 1  ON 29
ci_031                 3.327987e-03 3 1  ON 30
ci_032                 4.542538e-03 3 1  ON 31
ci_033                 2.362990e-03 3 1  ON 32
ci_034                 4.136327e-03 3 1  ON 33
ci_035                 1.723338e-03 3 1  ON 34
ci_036                 2.153798e-03 3 1  ON 35
ci_037                 3.539168e-03 3 1  ON 36
ci_038                 3.699856e-03 3 1  ON 37
ci_039                 4.622602e-03 3 1  ON 38
ci_040                 4.935344e-03 3 1  ON 39
ci_041                 2.970943e-03 3 1  ON 40
ci_042                 2.733710e-03 3 1  ON 41
ci_043                 2.944827e-03 3 1  ON 42
ci_044                 3.188821e-03 3 1  ON 43
ci_045                 2.451488e-03 3 1  ON 44
ci_046                 2.720989e-03 3 1  ON 45
ci_047                -1.002247e-03 3 1  ON 46
ci_048                -8.335460e-04 3 1  ON 47
ci_049                 7.787203e-04 3 1  ON 48
ci_050                 9.957009e-04 3 1  ON 49
ci_051                -3.143916e-04 3 1  ON 50
ci_052                -1.210991e-03 3 1  ON 51
ci_053                -2.434115e-03 3 1  ON 52
ci_054                -2.689567e-03 3 1  ON 53
ci_055                -1.798634e-03 3 1  ON 54
ci_056                -1.928968e-03 3 1  ON 55
ci_057                -1.307252e-03 3 1  ON 56
ci_058                -9.883936e-04 3 1  ON 57
ci_059                -5.511576e-04 3 1  ON 58
ci_060                -7.599888e-04 3 1  ON 59
ci_061                -5.115601e-05 3 1  ON 60
ci_062                -9.210208e-04 3 1  ON 61
ci_063                -8.860003e-04 3 1  ON 62
ci_064                -5.240773e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883854e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.557122e-03 3 1  ON 67
ci_069                -5.541412e-04 3 1  ON 68
ci_070                -4.262795e-04 3 1  ON 69
ci_071                -2.088343e-03 3 1  ON 70
ci_072                -2.001070e-03 3 1  ON 71
ci_073                 1.611527e-04 3 1  ON 72
ci_074                 1.976812e-04 3 1  ON 73
ci_075                 1.616077e-04 3 1  ON 74
ci_076                 7.850872e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6588
    reference variance = 0.453911
====================================================
  Execution time = 2.5842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4854e-01
  Total weights = 1.955027580e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439474680603
                                         uncertainty =       0.002054720844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439474680603
                                         uncertainty =       0.002054720844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468740254
  error estimate for blocks of size 2^( 2) =       0.000492935975
  error estimate for blocks of size 2^( 3) =       0.000514560659
  error estimate for blocks of size 2^( 4) =       0.000531379567
  error estimate for blocks of size 2^( 5) =       0.000541060385
  error estimate for blocks of size 2^( 6) =       0.000546743045
  error estimate for blocks of size 2^( 7) =       0.000548819762

      target function =      -0.746511261340
              le_mean =     -22.661699090031
             les_mean =     514.001147133913
             stat err =       0.000542000690
             autocorr =       1.337011602733
   target nu stat err =       0.000542000690
   target dn stat err =       0.002356948558
      target stat err =       0.002028303716
              std dev =       0.662898824639
             le_variance =       0.439434851708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266169909003e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746515831561       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746515833295       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746515833601       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746515833641       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746515833660       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746515833638       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746515833654       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746515833661       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746515833681       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+03 is 2.002563e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746515831561       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746515831994       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746515832071       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746515832078       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746515832109       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746515832031       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746515832120       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746515832084       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746515832154       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+04 is 5.006422e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746515831561       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746515831669       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746515831688       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746515831618       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746515831738       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746515831816       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746515831903       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746515831776       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746515831856       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+05 is 1.251606e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0545e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100239e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981768e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911146e-03 3 1  ON 10
ci_012                -9.099692e-03 3 1  ON 11
ci_013                 8.350016e-03 3 1  ON 12
ci_014                 9.370458e-03 3 1  ON 13
ci_015                 9.520692e-03 3 1  ON 14
ci_016                 9.413532e-03 3 1  ON 15
ci_017                 8.493814e-03 3 1  ON 16
ci_018                 8.286921e-03 3 1  ON 17
ci_019                -1.221495e-03 3 1  ON 18
ci_020                -1.534337e-03 3 1  ON 19
ci_021                -1.177666e-02 3 1  ON 20
ci_022                -1.179796e-02 3 1  ON 21
ci_023                 4.854182e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143506e-02 3 1  ON 24
ci_026                 1.147157e-02 3 1  ON 25
ci_027                 6.467261e-03 3 1  ON 26
ci_028                 6.188166e-03 3 1  ON 27
ci_029                -5.082860e-03 3 1  ON 28
ci_030                -4.170416e-03 3 1  ON 29
ci_031                 3.327985e-03 3 1  ON 30
ci_032                 4.542539e-03 3 1  ON 31
ci_033                 2.362990e-03 3 1  ON 32
ci_034                 4.136325e-03 3 1  ON 33
ci_035                 1.723338e-03 3 1  ON 34
ci_036                 2.153798e-03 3 1  ON 35
ci_037                 3.539166e-03 3 1  ON 36
ci_038                 3.699854e-03 3 1  ON 37
ci_039                 4.622599e-03 3 1  ON 38
ci_040                 4.935344e-03 3 1  ON 39
ci_041                 2.970942e-03 3 1  ON 40
ci_042                 2.733711e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188820e-03 3 1  ON 43
ci_045                 2.451487e-03 3 1  ON 44
ci_046                 2.720989e-03 3 1  ON 45
ci_047                -1.002247e-03 3 1  ON 46
ci_048                -8.335458e-04 3 1  ON 47
ci_049                 7.787197e-04 3 1  ON 48
ci_050                 9.957016e-04 3 1  ON 49
ci_051                -3.143902e-04 3 1  ON 50
ci_052                -1.210988e-03 3 1  ON 51
ci_053                -2.434116e-03 3 1  ON 52
ci_054                -2.689565e-03 3 1  ON 53
ci_055                -1.798633e-03 3 1  ON 54
ci_056                -1.928966e-03 3 1  ON 55
ci_057                -1.307251e-03 3 1  ON 56
ci_058                -9.883928e-04 3 1  ON 57
ci_059                -5.511570e-04 3 1  ON 58
ci_060                -7.599866e-04 3 1  ON 59
ci_061                -5.115596e-05 3 1  ON 60
ci_062                -9.210196e-04 3 1  ON 61
ci_063                -8.860004e-04 3 1  ON 62
ci_064                -5.240777e-04 3 1  ON 63
ci_065                -1.359807e-03 3 1  ON 64
ci_066                -1.883853e-03 3 1  ON 65
ci_067                -1.812712e-03 3 1  ON 66
ci_068                -1.557123e-03 3 1  ON 67
ci_069                -5.541392e-04 3 1  ON 68
ci_070                -4.262786e-04 3 1  ON 69
ci_071                -2.088343e-03 3 1  ON 70
ci_072                -2.001069e-03 3 1  ON 71
ci_073                 1.611533e-04 3 1  ON 72
ci_074                 1.976812e-04 3 1  ON 73
ci_075                 1.616074e-04 3 1  ON 74
ci_076                 7.850870e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6509
    reference variance = 0.250149
====================================================
  Execution time = 2.5022e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4801e-01
  Total weights = 1.9553e+06
  Execution time = 3.6110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438273928838
                                         uncertainty =       0.002014276884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438273928838
                                         uncertainty =       0.002014276884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468046551
  error estimate for blocks of size 2^( 2) =       0.000492203044
  error estimate for blocks of size 2^( 3) =       0.000514691805
  error estimate for blocks of size 2^( 4) =       0.000531642786
  error estimate for blocks of size 2^( 5) =       0.000540637699
  error estimate for blocks of size 2^( 6) =       0.000544248869
  error estimate for blocks of size 2^( 7) =       0.000547708669

      target function =      -0.746949980615
              le_mean =     -22.662024024871
             les_mean =     514.015345441931
             stat err =       0.000541059506
             autocorr =       1.336324601075
   target nu stat err =       0.000541059506
   target dn stat err =       0.002564362963
      target stat err =       0.002195157165
              std dev =       0.661917780556
             le_variance =       0.438135148216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438273921964
                                         uncertainty =       0.002014276443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438273921964
                                         uncertainty =       0.002014276443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468046548
  error estimate for blocks of size 2^( 2) =       0.000492203041
  error estimate for blocks of size 2^( 3) =       0.000514691802
  error estimate for blocks of size 2^( 4) =       0.000531642784
  error estimate for blocks of size 2^( 5) =       0.000540637696
  error estimate for blocks of size 2^( 6) =       0.000544248866
  error estimate for blocks of size 2^( 7) =       0.000547708665

      target function =      -0.746949988352
              le_mean =     -22.662024024898
             les_mean =     514.015345433760
             stat err =       0.000541059503
             autocorr =       1.336324606985
   target nu stat err =       0.000541059503
   target dn stat err =       0.002564361007
      target stat err =       0.002195155657
              std dev =       0.661917775375
             le_variance =       0.438135141358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438273925401
                                         uncertainty =       0.002014276663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438273925401
                                         uncertainty =       0.002014276663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468046549
  error estimate for blocks of size 2^( 2) =       0.000492203043
  error estimate for blocks of size 2^( 3) =       0.000514691804
  error estimate for blocks of size 2^( 4) =       0.000531642785
  error estimate for blocks of size 2^( 5) =       0.000540637697
  error estimate for blocks of size 2^( 6) =       0.000544248867
  error estimate for blocks of size 2^( 7) =       0.000547708667

      target function =      -0.746949984485
              le_mean =     -22.662024024884
             les_mean =     514.015345437844
             stat err =       0.000541059504
             autocorr =       1.336324604019
   target nu stat err =       0.000541059504
   target dn stat err =       0.002564361985
      target stat err =       0.002195156411
              std dev =       0.661917777966
             le_variance =       0.438135144788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438273928408
                                         uncertainty =       0.002014276856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438273928408
                                         uncertainty =       0.002014276856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468046551
  error estimate for blocks of size 2^( 2) =       0.000492203044
  error estimate for blocks of size 2^( 3) =       0.000514691805
  error estimate for blocks of size 2^( 4) =       0.000531642786
  error estimate for blocks of size 2^( 5) =       0.000540637699
  error estimate for blocks of size 2^( 6) =       0.000544248869
  error estimate for blocks of size 2^( 7) =       0.000547708668

      target function =      -0.746949981099
              le_mean =     -22.662024024873
             les_mean =     514.015345441420
             stat err =       0.000541059505
             autocorr =       1.336324601433
   target nu stat err =       0.000541059505
   target dn stat err =       0.002564362841
      target stat err =       0.002195157070
              std dev =       0.661917780232
             le_variance =       0.438135147788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746949980615        initial
     9.7656e+03     9.7656e+04             2.0026e-08        -0.746949988352  <--
     3.9062e+04     3.9062e+05             5.0064e-09        -0.746949984485
     1.5625e+05     1.5625e+06             1.2516e-09        -0.746949981099

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 4.3195e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013056e-02 3 1  ON 2
ci_004                -5.100238e-02 3 1  ON 3
ci_005                 1.949617e-02 3 1  ON 4
ci_006                 1.981767e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554133e-02 3 1  ON 7
ci_009                -1.320267e-02 3 1  ON 8
ci_010                -1.208052e-02 3 1  ON 9
ci_011                -9.911137e-03 3 1  ON 10
ci_012                -9.099692e-03 3 1  ON 11
ci_013                 8.350008e-03 3 1  ON 12
ci_014                 9.370456e-03 3 1  ON 13
ci_015                 9.520687e-03 3 1  ON 14
ci_016                 9.413531e-03 3 1  ON 15
ci_017                 8.493807e-03 3 1  ON 16
ci_018                 8.286915e-03 3 1  ON 17
ci_019                -1.221509e-03 3 1  ON 18
ci_020                -1.534352e-03 3 1  ON 19
ci_021                -1.177666e-02 3 1  ON 20
ci_022                -1.179797e-02 3 1  ON 21
ci_023                 4.854179e-03 3 1  ON 22
ci_024                 4.919610e-03 3 1  ON 23
ci_025                 1.143506e-02 3 1  ON 24
ci_026                 1.147157e-02 3 1  ON 25
ci_027                 6.467261e-03 3 1  ON 26
ci_028                 6.188163e-03 3 1  ON 27
ci_029                -5.082863e-03 3 1  ON 28
ci_030                -4.170413e-03 3 1  ON 29
ci_031                 3.327979e-03 3 1  ON 30
ci_032                 4.542541e-03 3 1  ON 31
ci_033                 2.362993e-03 3 1  ON 32
ci_034                 4.136318e-03 3 1  ON 33
ci_035                 1.723338e-03 3 1  ON 34
ci_036                 2.153796e-03 3 1  ON 35
ci_037                 3.539161e-03 3 1  ON 36
ci_038                 3.699849e-03 3 1  ON 37
ci_039                 4.622591e-03 3 1  ON 38
ci_040                 4.935345e-03 3 1  ON 39
ci_041                 2.970940e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944823e-03 3 1  ON 42
ci_044                 3.188819e-03 3 1  ON 43
ci_045                 2.451486e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002249e-03 3 1  ON 46
ci_048                -8.335454e-04 3 1  ON 47
ci_049                 7.787179e-04 3 1  ON 48
ci_050                 9.957037e-04 3 1  ON 49
ci_051                -3.143861e-04 3 1  ON 50
ci_052                -1.210982e-03 3 1  ON 51
ci_053                -2.434118e-03 3 1  ON 52
ci_054                -2.689559e-03 3 1  ON 53
ci_055                -1.798629e-03 3 1  ON 54
ci_056                -1.928962e-03 3 1  ON 55
ci_057                -1.307248e-03 3 1  ON 56
ci_058                -9.883906e-04 3 1  ON 57
ci_059                -5.511553e-04 3 1  ON 58
ci_060                -7.599799e-04 3 1  ON 59
ci_061                -5.115581e-05 3 1  ON 60
ci_062                -9.210159e-04 3 1  ON 61
ci_063                -8.860009e-04 3 1  ON 62
ci_064                -5.240789e-04 3 1  ON 63
ci_065                -1.359805e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812717e-03 3 1  ON 66
ci_068                -1.557125e-03 3 1  ON 67
ci_069                -5.541333e-04 3 1  ON 68
ci_070                -4.262758e-04 3 1  ON 69
ci_071                -2.088343e-03 3 1  ON 70
ci_072                -2.001067e-03 3 1  ON 71
ci_073                 1.611551e-04 3 1  ON 72
ci_074                 1.976811e-04 3 1  ON 73
ci_075                 1.616064e-04 3 1  ON 74
ci_076                 7.850863e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6278
    reference variance = 0.234933
====================================================
  Execution time = 2.5776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4769e-01
  Total weights = 1.955321331e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440188408232
                                         uncertainty =       0.002485813200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440188408232
                                         uncertainty =       0.002485813200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469159314
  error estimate for blocks of size 2^( 2) =       0.000493144354
  error estimate for blocks of size 2^( 3) =       0.000515154551
  error estimate for blocks of size 2^( 4) =       0.000531280360
  error estimate for blocks of size 2^( 5) =       0.000541204746
  error estimate for blocks of size 2^( 6) =       0.000546697720
  error estimate for blocks of size 2^( 7) =       0.000549851513

      target function =      -0.747215080148
              le_mean =     -22.662111398569
             les_mean =     514.018985917787
             stat err =       0.000542258585
             autocorr =       1.335894578873
   target nu stat err =       0.000542258585
   target dn stat err =       0.002431803293
      target stat err =       0.002092348641
              std dev =       0.663491464801
             le_variance =       0.440220923864


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266211139857e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747220018089       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747220024390       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747220025569       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747220025691       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747220025697       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747220025712       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747220025730       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747220025737       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747220025735       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747220025741       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747220025734       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+03 is 8.586677e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747220018089       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747220019664       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747220019959       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747220019989       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747220019991       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747220019999       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747220019995       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747220020004       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747220020012       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747220020001       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747220020003       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+03 is 2.146695e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747220018089       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747220018483       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747220018556       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747220018564       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747220018564       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747220018565       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747220018566       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747220018567       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747220018567       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747220018567       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747220018567       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+04 is 5.366753e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0478e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013056e-02 3 1  ON 2
ci_004                -5.100238e-02 3 1  ON 3
ci_005                 1.949616e-02 3 1  ON 4
ci_006                 1.981766e-02 3 1  ON 5
ci_007                 1.474644e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320265e-02 3 1  ON 8
ci_010                -1.208051e-02 3 1  ON 9
ci_011                -9.911125e-03 3 1  ON 10
ci_012                -9.099680e-03 3 1  ON 11
ci_013                 8.350009e-03 3 1  ON 12
ci_014                 9.370442e-03 3 1  ON 13
ci_015                 9.520684e-03 3 1  ON 14
ci_016                 9.413521e-03 3 1  ON 15
ci_017                 8.493803e-03 3 1  ON 16
ci_018                 8.286910e-03 3 1  ON 17
ci_019                -1.221530e-03 3 1  ON 18
ci_020                -1.534361e-03 3 1  ON 19
ci_021                -1.177666e-02 3 1  ON 20
ci_022                -1.179798e-02 3 1  ON 21
ci_023                 4.854178e-03 3 1  ON 22
ci_024                 4.919606e-03 3 1  ON 23
ci_025                 1.143507e-02 3 1  ON 24
ci_026                 1.147157e-02 3 1  ON 25
ci_027                 6.467260e-03 3 1  ON 26
ci_028                 6.188161e-03 3 1  ON 27
ci_029                -5.082853e-03 3 1  ON 28
ci_030                -4.170420e-03 3 1  ON 29
ci_031                 3.327994e-03 3 1  ON 30
ci_032                 4.542547e-03 3 1  ON 31
ci_033                 2.362993e-03 3 1  ON 32
ci_034                 4.136309e-03 3 1  ON 33
ci_035                 1.723335e-03 3 1  ON 34
ci_036                 2.153795e-03 3 1  ON 35
ci_037                 3.539159e-03 3 1  ON 36
ci_038                 3.699858e-03 3 1  ON 37
ci_039                 4.622589e-03 3 1  ON 38
ci_040                 4.935345e-03 3 1  ON 39
ci_041                 2.970935e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944824e-03 3 1  ON 42
ci_044                 3.188816e-03 3 1  ON 43
ci_045                 2.451489e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002254e-03 3 1  ON 46
ci_048                -8.335486e-04 3 1  ON 47
ci_049                 7.787150e-04 3 1  ON 48
ci_050                 9.957009e-04 3 1  ON 49
ci_051                -3.143847e-04 3 1  ON 50
ci_052                -1.210985e-03 3 1  ON 51
ci_053                -2.434121e-03 3 1  ON 52
ci_054                -2.689557e-03 3 1  ON 53
ci_055                -1.798626e-03 3 1  ON 54
ci_056                -1.928961e-03 3 1  ON 55
ci_057                -1.307244e-03 3 1  ON 56
ci_058                -9.883934e-04 3 1  ON 57
ci_059                -5.511579e-04 3 1  ON 58
ci_060                -7.599794e-04 3 1  ON 59
ci_061                -5.116269e-05 3 1  ON 60
ci_062                -9.210149e-04 3 1  ON 61
ci_063                -8.860046e-04 3 1  ON 62
ci_064                -5.240883e-04 3 1  ON 63
ci_065                -1.359806e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812724e-03 3 1  ON 66
ci_068                -1.557121e-03 3 1  ON 67
ci_069                -5.541330e-04 3 1  ON 68
ci_070                -4.262745e-04 3 1  ON 69
ci_071                -2.088340e-03 3 1  ON 70
ci_072                -2.001064e-03 3 1  ON 71
ci_073                 1.611529e-04 3 1  ON 72
ci_074                 1.976804e-04 3 1  ON 73
ci_075                 1.616080e-04 3 1  ON 74
ci_076                 7.850812e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.634
    reference variance = 0.376519
====================================================
  Execution time = 2.5098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5127e-01
  Total weights = 1.9553e+06
  Execution time = 3.6287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442512454608
                                         uncertainty =       0.002350487515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442512454608
                                         uncertainty =       0.002350487515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470369743
  error estimate for blocks of size 2^( 2) =       0.000494797716
  error estimate for blocks of size 2^( 3) =       0.000516957126
  error estimate for blocks of size 2^( 4) =       0.000532180074
  error estimate for blocks of size 2^( 5) =       0.000540977603
  error estimate for blocks of size 2^( 6) =       0.000545926747
  error estimate for blocks of size 2^( 7) =       0.000547912916

      target function =      -0.744274932692
              le_mean =     -22.661972801956
             les_mean =     514.016279721701
             stat err =       0.000541749335
             autocorr =       1.326532878393
   target nu stat err =       0.000541749335
   target dn stat err =       0.002958185092
      target stat err =       0.002491486074
              std dev =       0.665203269919
             le_variance =       0.442495390311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442512437264
                                         uncertainty =       0.002350487860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442512437264
                                         uncertainty =       0.002350487860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470369734
  error estimate for blocks of size 2^( 2) =       0.000494797709
  error estimate for blocks of size 2^( 3) =       0.000516957121
  error estimate for blocks of size 2^( 4) =       0.000532180071
  error estimate for blocks of size 2^( 5) =       0.000540977599
  error estimate for blocks of size 2^( 6) =       0.000545926742
  error estimate for blocks of size 2^( 7) =       0.000547912913

      target function =      -0.744275108446
              le_mean =     -22.661972802705
             les_mean =     514.016279540773
             stat err =       0.000541749332
             autocorr =       1.326532914056
   target nu stat err =       0.000541749332
   target dn stat err =       0.002958181370
      target stat err =       0.002491484263
              std dev =       0.665203256910
             le_variance =       0.442495373004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442512445936
                                         uncertainty =       0.002350487687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442512445936
                                         uncertainty =       0.002350487687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470369738
  error estimate for blocks of size 2^( 2) =       0.000494797713
  error estimate for blocks of size 2^( 3) =       0.000516957124
  error estimate for blocks of size 2^( 4) =       0.000532180073
  error estimate for blocks of size 2^( 5) =       0.000540977601
  error estimate for blocks of size 2^( 6) =       0.000545926745
  error estimate for blocks of size 2^( 7) =       0.000547912915

      target function =      -0.744275020689
              le_mean =     -22.661972802330
             les_mean =     514.016279631091
             stat err =       0.000541749333
             autocorr =       1.326532896234
   target nu stat err =       0.000541749333
   target dn stat err =       0.002958183229
      target stat err =       0.002491485167
              std dev =       0.665203263415
             le_variance =       0.442495381658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442512453524
                                         uncertainty =       0.002350487536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442512453524
                                         uncertainty =       0.002350487536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470369742
  error estimate for blocks of size 2^( 2) =       0.000494797716
  error estimate for blocks of size 2^( 3) =       0.000516957126
  error estimate for blocks of size 2^( 4) =       0.000532180074
  error estimate for blocks of size 2^( 5) =       0.000540977603
  error estimate for blocks of size 2^( 6) =       0.000545926746
  error estimate for blocks of size 2^( 7) =       0.000547912916

      target function =      -0.744274943704
              le_mean =     -22.661972802003
             les_mean =     514.016279710359
             stat err =       0.000541749335
             autocorr =       1.326532880624
   target nu stat err =       0.000541749335
   target dn stat err =       0.002958184859
      target stat err =       0.002491485960
              std dev =       0.665203269106
             le_variance =       0.442495389230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744274932692        initial
     2.4414e+03     2.4414e+04             8.5867e-08        -0.744275108446  <--
     9.7656e+03     9.7656e+04             2.1467e-08        -0.744275020689
     3.9062e+04     3.9062e+05             5.3668e-09        -0.744274943704

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 4.3258e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554135e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911089e-03 3 1  ON 10
ci_012                -9.099644e-03 3 1  ON 11
ci_013                 8.350011e-03 3 1  ON 12
ci_014                 9.370400e-03 3 1  ON 13
ci_015                 9.520675e-03 3 1  ON 14
ci_016                 9.413489e-03 3 1  ON 15
ci_017                 8.493790e-03 3 1  ON 16
ci_018                 8.286894e-03 3 1  ON 17
ci_019                -1.221595e-03 3 1  ON 18
ci_020                -1.534390e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188155e-03 3 1  ON 27
ci_029                -5.082821e-03 3 1  ON 28
ci_030                -4.170442e-03 3 1  ON 29
ci_031                 3.328038e-03 3 1  ON 30
ci_032                 4.542564e-03 3 1  ON 31
ci_033                 2.362992e-03 3 1  ON 32
ci_034                 4.136285e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153792e-03 3 1  ON 35
ci_037                 3.539156e-03 3 1  ON 36
ci_038                 3.699888e-03 3 1  ON 37
ci_039                 4.622584e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944827e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451498e-03 3 1  ON 44
ci_046                 2.720991e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335582e-04 3 1  ON 47
ci_049                 7.787062e-04 3 1  ON 48
ci_050                 9.956927e-04 3 1  ON 49
ci_051                -3.143803e-04 3 1  ON 50
ci_052                -1.210996e-03 3 1  ON 51
ci_053                -2.434130e-03 3 1  ON 52
ci_054                -2.689549e-03 3 1  ON 53
ci_055                -1.798615e-03 3 1  ON 54
ci_056                -1.928956e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884019e-04 3 1  ON 57
ci_059                -5.511658e-04 3 1  ON 58
ci_060                -7.599777e-04 3 1  ON 59
ci_061                -5.118331e-05 3 1  ON 60
ci_062                -9.210116e-04 3 1  ON 61
ci_063                -8.860160e-04 3 1  ON 62
ci_064                -5.241166e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812746e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541319e-04 3 1  ON 68
ci_070                -4.262707e-04 3 1  ON 69
ci_071                -2.088332e-03 3 1  ON 70
ci_072                -2.001055e-03 3 1  ON 71
ci_073                 1.611462e-04 3 1  ON 72
ci_074                 1.976782e-04 3 1  ON 73
ci_075                 1.616128e-04 3 1  ON 74
ci_076                 7.850658e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.7429
    reference variance = 0.37079
====================================================
  Execution time = 2.7842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5378e-01
  Total weights = 1.955017570e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442240048698
                                         uncertainty =       0.002131692064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442240048698
                                         uncertainty =       0.002131692064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470243822
  error estimate for blocks of size 2^( 2) =       0.000494319822
  error estimate for blocks of size 2^( 3) =       0.000516110717
  error estimate for blocks of size 2^( 4) =       0.000532815088
  error estimate for blocks of size 2^( 5) =       0.000542454561
  error estimate for blocks of size 2^( 6) =       0.000545527138
  error estimate for blocks of size 2^( 7) =       0.000548360872

      target function =      -0.742229824052
              le_mean =     -22.662697850429
             les_mean =     514.051652016543
             stat err =       0.000542289415
             autocorr =       1.329891029199
   target nu stat err =       0.000542289415
   target dn stat err =       0.003335191977
      target stat err =       0.002779996103
              std dev =       0.665025191257
             le_variance =       0.442258505006


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266269785043e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742239363513       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742239389465       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742239395853       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742239396670       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742239396863       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742239396999       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742239397071       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742239397056       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742239397067       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742239397048       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742239397050       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+02 is 3.393949e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742239363513       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742239370001       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742239371598       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742239371802       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742239371852       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742239371880       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742239371901       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742239371891       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742239371905       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742239371899       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742239371896       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+03 is 8.485007e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742239363513       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742239365135       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742239365534       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742239365585       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742239365613       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742239365606       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742239365629       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742239365609       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742239365577       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742239365595       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742239365609       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+03 is 2.121260e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086252 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2580e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_001                -7.055859e-01 3 1  ON 0
ci_002                -7.029016e-01 3 1  ON 1
ci_003                -5.013045e-02 3 1  ON 2
ci_004                -5.100235e-02 3 1  ON 3
ci_005                 1.949609e-02 3 1  ON 4
ci_006                 1.981758e-02 3 1  ON 5
ci_007                 1.474643e-02 3 1  ON 6
ci_008                 1.554132e-02 3 1  ON 7
ci_009                -1.320258e-02 3 1  ON 8
ci_010                -1.208048e-02 3 1  ON 9
ci_011                -9.911073e-03 3 1  ON 10
ci_012                -9.099653e-03 3 1  ON 11
ci_013                 8.350019e-03 3 1  ON 12
ci_014                 9.370342e-03 3 1  ON 13
ci_015                 9.520655e-03 3 1  ON 14
ci_016                 9.413437e-03 3 1  ON 15
ci_017                 8.493806e-03 3 1  ON 16
ci_018                 8.286891e-03 3 1  ON 17
ci_019                -1.221653e-03 3 1  ON 18
ci_020                -1.534457e-03 3 1  ON 19
ci_021                -1.177671e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854153e-03 3 1  ON 22
ci_024                 4.919605e-03 3 1  ON 23
ci_025                 1.143512e-02 3 1  ON 24
ci_026                 1.147162e-02 3 1  ON 25
ci_027                 6.467255e-03 3 1  ON 26
ci_028                 6.188140e-03 3 1  ON 27
ci_029                -5.082802e-03 3 1  ON 28
ci_030                -4.170409e-03 3 1  ON 29
ci_031                 3.328066e-03 3 1  ON 30
ci_032                 4.542574e-03 3 1  ON 31
ci_033                 2.362994e-03 3 1  ON 32
ci_034                 4.136251e-03 3 1  ON 33
ci_035                 1.723328e-03 3 1  ON 34
ci_036                 2.153777e-03 3 1  ON 35
ci_037                 3.539140e-03 3 1  ON 36
ci_038                 3.699880e-03 3 1  ON 37
ci_039                 4.622586e-03 3 1  ON 38
ci_040                 4.935344e-03 3 1  ON 39
ci_041                 2.970906e-03 3 1  ON 40
ci_042                 2.733720e-03 3 1  ON 41
ci_043                 2.944837e-03 3 1  ON 42
ci_044                 3.188777e-03 3 1  ON 43
ci_045                 2.451500e-03 3 1  ON 44
ci_046                 2.721001e-03 3 1  ON 45
ci_047                -1.002272e-03 3 1  ON 46
ci_048                -8.335551e-04 3 1  ON 47
ci_049                 7.787283e-04 3 1  ON 48
ci_050                 9.957044e-04 3 1  ON 49
ci_051                -3.143764e-04 3 1  ON 50
ci_052                -1.210999e-03 3 1  ON 51
ci_053                -2.434159e-03 3 1  ON 52
ci_054                -2.689521e-03 3 1  ON 53
ci_055                -1.798580e-03 3 1  ON 54
ci_056                -1.928912e-03 3 1  ON 55
ci_057                -1.307222e-03 3 1  ON 56
ci_058                -9.883939e-04 3 1  ON 57
ci_059                -5.511511e-04 3 1  ON 58
ci_060                -7.599485e-04 3 1  ON 59
ci_061                -5.115657e-05 3 1  ON 60
ci_062                -9.210136e-04 3 1  ON 61
ci_063                -8.860043e-04 3 1  ON 62
ci_064                -5.241278e-04 3 1  ON 63
ci_065                -1.359827e-03 3 1  ON 64
ci_066                -1.883887e-03 3 1  ON 65
ci_067                -1.812719e-03 3 1  ON 66
ci_068                -1.557114e-03 3 1  ON 67
ci_069                -5.541350e-04 3 1  ON 68
ci_070                -4.262691e-04 3 1  ON 69
ci_071                -2.088344e-03 3 1  ON 70
ci_072                -2.001061e-03 3 1  ON 71
ci_073                 1.611514e-04 3 1  ON 72
ci_074                 1.976874e-04 3 1  ON 73
ci_075                 1.616187e-04 3 1  ON 74
ci_076                 7.850901e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6807
    reference variance = 0.361953
====================================================
  Execution time = 2.5028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4982e-01
  Total weights = 1.9552e+06
  Execution time = 3.6135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088979741
                                         uncertainty =       0.001914796916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088979741
                                         uncertainty =       0.001914796916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469093063
  error estimate for blocks of size 2^( 2) =       0.000493157244
  error estimate for blocks of size 2^( 3) =       0.000515218842
  error estimate for blocks of size 2^( 4) =       0.000530938291
  error estimate for blocks of size 2^( 5) =       0.000539944915
  error estimate for blocks of size 2^( 6) =       0.000544298020
  error estimate for blocks of size 2^( 7) =       0.000546749186

      target function =      -0.745472043068
              le_mean =     -22.663256471920
             les_mean =     514.073017955871
             stat err =       0.000540482603
             autocorr =       1.327533282671
   target nu stat err =       0.000540482603
   target dn stat err =       0.002697045113
      target stat err =       0.002295761151
              std dev =       0.663397771384
             le_variance =       0.440096603077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088952026
                                         uncertainty =       0.001914800459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088952026
                                         uncertainty =       0.001914800459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469093048
  error estimate for blocks of size 2^( 2) =       0.000493157235
  error estimate for blocks of size 2^( 3) =       0.000515218836
  error estimate for blocks of size 2^( 4) =       0.000530938285
  error estimate for blocks of size 2^( 5) =       0.000539944903
  error estimate for blocks of size 2^( 6) =       0.000544298013
  error estimate for blocks of size 2^( 7) =       0.000546749188

      target function =      -0.745471155100
              le_mean =     -22.663256470449
             les_mean =     514.073018968151
             stat err =       0.000540482597
             autocorr =       1.327533338483
   target nu stat err =       0.000540482597
   target dn stat err =       0.002697268209
      target stat err =       0.002295932967
              std dev =       0.663397750508
             le_variance =       0.440096575379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088965881
                                         uncertainty =       0.001914798688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088965881
                                         uncertainty =       0.001914798688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469093055
  error estimate for blocks of size 2^( 2) =       0.000493157239
  error estimate for blocks of size 2^( 3) =       0.000515218839
  error estimate for blocks of size 2^( 4) =       0.000530938288
  error estimate for blocks of size 2^( 5) =       0.000539944909
  error estimate for blocks of size 2^( 6) =       0.000544298016
  error estimate for blocks of size 2^( 7) =       0.000546749187

      target function =      -0.745471599388
              le_mean =     -22.663256471184
             les_mean =     514.073018461626
             stat err =       0.000540482600
             autocorr =       1.327533310575
   target nu stat err =       0.000540482600
   target dn stat err =       0.002697156552
      target stat err =       0.002295846975
              std dev =       0.663397760944
             le_variance =       0.440096589225

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088978008
                                         uncertainty =       0.001914797137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088978008
                                         uncertainty =       0.001914797137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469093062
  error estimate for blocks of size 2^( 2) =       0.000493157243
  error estimate for blocks of size 2^( 3) =       0.000515218841
  error estimate for blocks of size 2^( 4) =       0.000530938291
  error estimate for blocks of size 2^( 5) =       0.000539944914
  error estimate for blocks of size 2^( 6) =       0.000544298019
  error estimate for blocks of size 2^( 7) =       0.000546749186

      target function =      -0.745471987643
              le_mean =     -22.663256471828
             les_mean =     514.073018019047
             stat err =       0.000540482603
             autocorr =       1.327533286146
   target nu stat err =       0.000540482603
   target dn stat err =       0.002697059030
      target stat err =       0.002295771869
              std dev =       0.663397770079
             le_variance =       0.440096601345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745472043068        initial  <--
     6.1035e+02     6.1035e+03             3.3939e-07        -0.745471155100
     2.4414e+03     2.4414e+04             8.4850e-08        -0.745471599388
     9.7656e+03     9.7656e+04             2.1213e-08        -0.745471987643

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5676
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554135e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911089e-03 3 1  ON 10
ci_012                -9.099644e-03 3 1  ON 11
ci_013                 8.350011e-03 3 1  ON 12
ci_014                 9.370400e-03 3 1  ON 13
ci_015                 9.520675e-03 3 1  ON 14
ci_016                 9.413489e-03 3 1  ON 15
ci_017                 8.493790e-03 3 1  ON 16
ci_018                 8.286894e-03 3 1  ON 17
ci_019                -1.221595e-03 3 1  ON 18
ci_020                -1.534390e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188155e-03 3 1  ON 27
ci_029                -5.082821e-03 3 1  ON 28
ci_030                -4.170442e-03 3 1  ON 29
ci_031                 3.328038e-03 3 1  ON 30
ci_032                 4.542564e-03 3 1  ON 31
ci_033                 2.362992e-03 3 1  ON 32
ci_034                 4.136285e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153792e-03 3 1  ON 35
ci_037                 3.539156e-03 3 1  ON 36
ci_038                 3.699888e-03 3 1  ON 37
ci_039                 4.622584e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944827e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451498e-03 3 1  ON 44
ci_046                 2.720991e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335582e-04 3 1  ON 47
ci_049                 7.787062e-04 3 1  ON 48
ci_050                 9.956927e-04 3 1  ON 49
ci_051                -3.143803e-04 3 1  ON 50
ci_052                -1.210996e-03 3 1  ON 51
ci_053                -2.434130e-03 3 1  ON 52
ci_054                -2.689549e-03 3 1  ON 53
ci_055                -1.798615e-03 3 1  ON 54
ci_056                -1.928956e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884019e-04 3 1  ON 57
ci_059                -5.511658e-04 3 1  ON 58
ci_060                -7.599777e-04 3 1  ON 59
ci_061                -5.118331e-05 3 1  ON 60
ci_062                -9.210116e-04 3 1  ON 61
ci_063                -8.860160e-04 3 1  ON 62
ci_064                -5.241166e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812746e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541319e-04 3 1  ON 68
ci_070                -4.262707e-04 3 1  ON 69
ci_071                -2.088332e-03 3 1  ON 70
ci_072                -2.001055e-03 3 1  ON 71
ci_073                 1.611462e-04 3 1  ON 72
ci_074                 1.976782e-04 3 1  ON 73
ci_075                 1.616128e-04 3 1  ON 74
ci_076                 7.850658e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8154e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6207
    reference variance = 0.349454
====================================================
  Execution time = 2.5753e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5661e-01
  Total weights = 1.954822080e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444210432178
                                         uncertainty =       0.002585132940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444210432178
                                         uncertainty =       0.002585132940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471354785
  error estimate for blocks of size 2^( 2) =       0.000495698517
  error estimate for blocks of size 2^( 3) =       0.000517194012
  error estimate for blocks of size 2^( 4) =       0.000533647424
  error estimate for blocks of size 2^( 5) =       0.000542863008
  error estimate for blocks of size 2^( 6) =       0.000547787150
  error estimate for blocks of size 2^( 7) =       0.000554045372

      target function =      -0.739923623219
              le_mean =     -22.661938459541
             les_mean =     514.020069392714
             stat err =       0.000544585739
             autocorr =       1.334862975591
   target nu stat err =       0.000544585739
   target dn stat err =       0.003748132401
      target stat err =       0.003087355725
              std dev =       0.666596329696
             le_variance =       0.444350666765


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266193845954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739935410928       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739935415605       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739935417318       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739935417845       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739935418053       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739935418251       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739935418371       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739935418403       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739935418415       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739935418428       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739935418417       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739935418418       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+03 is 7.678611e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739935410928       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739935412097       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739935412525       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739935412657       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739935412709       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739935412756       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739935412788       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739935412703       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739935412800       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739935412800       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739935412800       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739935412763       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+04 is 1.919653e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739935410928       residual = 3.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739935411220       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739935411327       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739935411360       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739935411373       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739935411326       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739935411393       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739935411395       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739935411396       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739935411396       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739935411257       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739935411396       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+04 is 4.799132e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0450e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_001                -7.055859e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013053e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949613e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911096e-03 3 1  ON 10
ci_012                -9.099643e-03 3 1  ON 11
ci_013                 8.350008e-03 3 1  ON 12
ci_014                 9.370400e-03 3 1  ON 13
ci_015                 9.520675e-03 3 1  ON 14
ci_016                 9.413489e-03 3 1  ON 15
ci_017                 8.493787e-03 3 1  ON 16
ci_018                 8.286895e-03 3 1  ON 17
ci_019                -1.221604e-03 3 1  ON 18
ci_020                -1.534392e-03 3 1  ON 19
ci_021                -1.177667e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854176e-03 3 1  ON 22
ci_024                 4.919597e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188157e-03 3 1  ON 27
ci_029                -5.082819e-03 3 1  ON 28
ci_030                -4.170445e-03 3 1  ON 29
ci_031                 3.328047e-03 3 1  ON 30
ci_032                 4.542569e-03 3 1  ON 31
ci_033                 2.362994e-03 3 1  ON 32
ci_034                 4.136282e-03 3 1  ON 33
ci_035                 1.723325e-03 3 1  ON 34
ci_036                 2.153791e-03 3 1  ON 35
ci_037                 3.539157e-03 3 1  ON 36
ci_038                 3.699884e-03 3 1  ON 37
ci_039                 4.622585e-03 3 1  ON 38
ci_040                 4.935344e-03 3 1  ON 39
ci_041                 2.970921e-03 3 1  ON 40
ci_042                 2.733711e-03 3 1  ON 41
ci_043                 2.944823e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451500e-03 3 1  ON 44
ci_046                 2.720989e-03 3 1  ON 45
ci_047                -1.002267e-03 3 1  ON 46
ci_048                -8.335592e-04 3 1  ON 47
ci_049                 7.787115e-04 3 1  ON 48
ci_050                 9.956935e-04 3 1  ON 49
ci_051                -3.143846e-04 3 1  ON 50
ci_052                -1.210994e-03 3 1  ON 51
ci_053                -2.434134e-03 3 1  ON 52
ci_054                -2.689551e-03 3 1  ON 53
ci_055                -1.798617e-03 3 1  ON 54
ci_056                -1.928956e-03 3 1  ON 55
ci_057                -1.307227e-03 3 1  ON 56
ci_058                -9.884015e-04 3 1  ON 57
ci_059                -5.511684e-04 3 1  ON 58
ci_060                -7.599770e-04 3 1  ON 59
ci_061                -5.118577e-05 3 1  ON 60
ci_062                -9.210097e-04 3 1  ON 61
ci_063                -8.860100e-04 3 1  ON 62
ci_064                -5.241164e-04 3 1  ON 63
ci_065                -1.359812e-03 3 1  ON 64
ci_066                -1.883849e-03 3 1  ON 65
ci_067                -1.812745e-03 3 1  ON 66
ci_068                -1.557107e-03 3 1  ON 67
ci_069                -5.541302e-04 3 1  ON 68
ci_070                -4.262686e-04 3 1  ON 69
ci_071                -2.088330e-03 3 1  ON 70
ci_072                -2.001056e-03 3 1  ON 71
ci_073                 1.611449e-04 3 1  ON 72
ci_074                 1.976793e-04 3 1  ON 73
ci_075                 1.616243e-04 3 1  ON 74
ci_076                 7.850643e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6269
    reference variance = 0.432855
====================================================
  Execution time = 2.5050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5971e-01
  Total weights = 1.9551e+06
  Execution time = 3.6170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021993076
                                         uncertainty =       0.002258569631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021993076
                                         uncertainty =       0.002258569631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471692116
  error estimate for blocks of size 2^( 2) =       0.000495729636
  error estimate for blocks of size 2^( 3) =       0.000517893499
  error estimate for blocks of size 2^( 4) =       0.000534246742
  error estimate for blocks of size 2^( 5) =       0.000543018158
  error estimate for blocks of size 2^( 6) =       0.000549685452
  error estimate for blocks of size 2^( 7) =       0.000554007444

      target function =      -0.737414892949
              le_mean =     -22.661110821315
             les_mean =     513.985651234393
             stat err =       0.000545239449
             autocorr =       1.336156429992
   target nu stat err =       0.000545239449
   target dn stat err =       0.005840172533
      target stat err =       0.004720247792
              std dev =       0.667073387485
             le_variance =       0.444986904290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021985196
                                         uncertainty =       0.002258569496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021985196
                                         uncertainty =       0.002258569496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471692112
  error estimate for blocks of size 2^( 2) =       0.000495729633
  error estimate for blocks of size 2^( 3) =       0.000517893497
  error estimate for blocks of size 2^( 4) =       0.000534246741
  error estimate for blocks of size 2^( 5) =       0.000543018158
  error estimate for blocks of size 2^( 6) =       0.000549685452
  error estimate for blocks of size 2^( 7) =       0.000554007444

      target function =      -0.737414533125
              le_mean =     -22.661110821599
             les_mean =     513.985651693304
             stat err =       0.000545239449
             autocorr =       1.336156452560
   target nu stat err =       0.000545239449
   target dn stat err =       0.005840387763
      target stat err =       0.004720414451
              std dev =       0.667073381574
             le_variance =       0.444986896405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021989136
                                         uncertainty =       0.002258569564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021989136
                                         uncertainty =       0.002258569564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471692114
  error estimate for blocks of size 2^( 2) =       0.000495729634
  error estimate for blocks of size 2^( 3) =       0.000517893498
  error estimate for blocks of size 2^( 4) =       0.000534246741
  error estimate for blocks of size 2^( 5) =       0.000543018158
  error estimate for blocks of size 2^( 6) =       0.000549685452
  error estimate for blocks of size 2^( 7) =       0.000554007444

      target function =      -0.737414713087
              le_mean =     -22.661110821457
             les_mean =     513.985651463785
             stat err =       0.000545239449
             autocorr =       1.336156441271
   target nu stat err =       0.000545239449
   target dn stat err =       0.005840280143
      target stat err =       0.004720331118
              std dev =       0.667073384530
             le_variance =       0.444986900348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021992583
                                         uncertainty =       0.002258569623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445021992583
                                         uncertainty =       0.002258569623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471692116
  error estimate for blocks of size 2^( 2) =       0.000495729636
  error estimate for blocks of size 2^( 3) =       0.000517893499
  error estimate for blocks of size 2^( 4) =       0.000534246742
  error estimate for blocks of size 2^( 5) =       0.000543018158
  error estimate for blocks of size 2^( 6) =       0.000549685452
  error estimate for blocks of size 2^( 7) =       0.000554007444

      target function =      -0.737414870472
              le_mean =     -22.661110821333
             les_mean =     513.985651263060
             stat err =       0.000545239449
             autocorr =       1.336156431395
   target nu stat err =       0.000545239449
   target dn stat err =       0.005840185984
      target stat err =       0.004720258208
              std dev =       0.667073387116
             le_variance =       0.444986903798


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737414892949        initial  <--
     6.1035e+03     6.1035e+04             7.6786e-08        -0.737414533125
     2.4414e+04     2.4414e+05             1.9197e-08        -0.737414713087
     9.7656e+04     9.7656e+05             4.7991e-09        -0.737414870472

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2183
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554135e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911089e-03 3 1  ON 10
ci_012                -9.099644e-03 3 1  ON 11
ci_013                 8.350011e-03 3 1  ON 12
ci_014                 9.370400e-03 3 1  ON 13
ci_015                 9.520675e-03 3 1  ON 14
ci_016                 9.413489e-03 3 1  ON 15
ci_017                 8.493790e-03 3 1  ON 16
ci_018                 8.286894e-03 3 1  ON 17
ci_019                -1.221595e-03 3 1  ON 18
ci_020                -1.534390e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188155e-03 3 1  ON 27
ci_029                -5.082821e-03 3 1  ON 28
ci_030                -4.170442e-03 3 1  ON 29
ci_031                 3.328038e-03 3 1  ON 30
ci_032                 4.542564e-03 3 1  ON 31
ci_033                 2.362992e-03 3 1  ON 32
ci_034                 4.136285e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153792e-03 3 1  ON 35
ci_037                 3.539156e-03 3 1  ON 36
ci_038                 3.699888e-03 3 1  ON 37
ci_039                 4.622584e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944827e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451498e-03 3 1  ON 44
ci_046                 2.720991e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335582e-04 3 1  ON 47
ci_049                 7.787062e-04 3 1  ON 48
ci_050                 9.956927e-04 3 1  ON 49
ci_051                -3.143803e-04 3 1  ON 50
ci_052                -1.210996e-03 3 1  ON 51
ci_053                -2.434130e-03 3 1  ON 52
ci_054                -2.689549e-03 3 1  ON 53
ci_055                -1.798615e-03 3 1  ON 54
ci_056                -1.928956e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884019e-04 3 1  ON 57
ci_059                -5.511658e-04 3 1  ON 58
ci_060                -7.599777e-04 3 1  ON 59
ci_061                -5.118331e-05 3 1  ON 60
ci_062                -9.210116e-04 3 1  ON 61
ci_063                -8.860160e-04 3 1  ON 62
ci_064                -5.241166e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812746e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541319e-04 3 1  ON 68
ci_070                -4.262707e-04 3 1  ON 69
ci_071                -2.088332e-03 3 1  ON 70
ci_072                -2.001055e-03 3 1  ON 71
ci_073                 1.611462e-04 3 1  ON 72
ci_074                 1.976782e-04 3 1  ON 73
ci_075                 1.616128e-04 3 1  ON 74
ci_076                 7.850658e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3675e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.636
    reference variance = 0.262037
====================================================
  Execution time = 2.5630e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5041e-01
  Total weights = 1.955285236e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441556393021
                                         uncertainty =       0.002367690771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441556393021
                                         uncertainty =       0.002367690771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469835039
  error estimate for blocks of size 2^( 2) =       0.000493285532
  error estimate for blocks of size 2^( 3) =       0.000515617499
  error estimate for blocks of size 2^( 4) =       0.000530760162
  error estimate for blocks of size 2^( 5) =       0.000538600298
  error estimate for blocks of size 2^( 6) =       0.000541270639
  error estimate for blocks of size 2^( 7) =       0.000541707434

      target function =      -0.744987269202
              le_mean =     -22.662478776168
             les_mean =     514.038350159743
             stat err =       0.000538084633
             autocorr =       1.311627082446
   target nu stat err =       0.000538084633
   target dn stat err =       0.002716910242
      target stat err =       0.002305297333
              std dev =       0.664447084019
             le_variance =       0.441489927462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266247877617e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744993390559       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744993390802       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744993390857       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744993390856       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744993390850       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744993390868       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744993391019       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744993391000       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744993390971       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744993390792       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744993391001       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744993390881       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+04 is 4.644734e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744993390559       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744993390620       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744993390633       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744993390640       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744993390606       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744993390369       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744993390640       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744993390261       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744993390510       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744993390639       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744993390384       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744993391186       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+05 is 1.161184e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744993390559       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744993390574       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744993390578       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744993390710       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744993390579       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744993390525       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744993389334       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744993389830       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744993391241       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744993388887       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744993390511       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744993391166       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+05 is 2.902961e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0377e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554135e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911089e-03 3 1  ON 10
ci_012                -9.099644e-03 3 1  ON 11
ci_013                 8.350011e-03 3 1  ON 12
ci_014                 9.370400e-03 3 1  ON 13
ci_015                 9.520674e-03 3 1  ON 14
ci_016                 9.413489e-03 3 1  ON 15
ci_017                 8.493790e-03 3 1  ON 16
ci_018                 8.286894e-03 3 1  ON 17
ci_019                -1.221596e-03 3 1  ON 18
ci_020                -1.534390e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188155e-03 3 1  ON 27
ci_029                -5.082821e-03 3 1  ON 28
ci_030                -4.170442e-03 3 1  ON 29
ci_031                 3.328038e-03 3 1  ON 30
ci_032                 4.542564e-03 3 1  ON 31
ci_033                 2.362992e-03 3 1  ON 32
ci_034                 4.136285e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153792e-03 3 1  ON 35
ci_037                 3.539156e-03 3 1  ON 36
ci_038                 3.699887e-03 3 1  ON 37
ci_039                 4.622584e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944827e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451498e-03 3 1  ON 44
ci_046                 2.720991e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335581e-04 3 1  ON 47
ci_049                 7.787062e-04 3 1  ON 48
ci_050                 9.956925e-04 3 1  ON 49
ci_051                -3.143805e-04 3 1  ON 50
ci_052                -1.210996e-03 3 1  ON 51
ci_053                -2.434131e-03 3 1  ON 52
ci_054                -2.689549e-03 3 1  ON 53
ci_055                -1.798615e-03 3 1  ON 54
ci_056                -1.928955e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884016e-04 3 1  ON 57
ci_059                -5.511658e-04 3 1  ON 58
ci_060                -7.599778e-04 3 1  ON 59
ci_061                -5.118341e-05 3 1  ON 60
ci_062                -9.210113e-04 3 1  ON 61
ci_063                -8.860157e-04 3 1  ON 62
ci_064                -5.241168e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812747e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541317e-04 3 1  ON 68
ci_070                -4.262706e-04 3 1  ON 69
ci_071                -2.088332e-03 3 1  ON 70
ci_072                -2.001055e-03 3 1  ON 71
ci_073                 1.611463e-04 3 1  ON 72
ci_074                 1.976781e-04 3 1  ON 73
ci_075                 1.616129e-04 3 1  ON 74
ci_076                 7.850658e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6
    reference variance = 0.480549
====================================================
  Execution time = 2.5055e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4976e-01
  Total weights = 1.9553e+06
  Execution time = 3.6313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710848735
                                         uncertainty =       0.002144225979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710848735
                                         uncertainty =       0.002144225979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469920309
  error estimate for blocks of size 2^( 2) =       0.000493823223
  error estimate for blocks of size 2^( 3) =       0.000516027350
  error estimate for blocks of size 2^( 4) =       0.000532028874
  error estimate for blocks of size 2^( 5) =       0.000541016296
  error estimate for blocks of size 2^( 6) =       0.000546038534
  error estimate for blocks of size 2^( 7) =       0.000549894210

      target function =      -0.745517048778
              le_mean =     -22.662536390270
             les_mean =     514.040316274244
             stat err =       0.000542244478
             autocorr =       1.331502072499
   target nu stat err =       0.000542244478
   target dn stat err =       0.002772150216
      target stat err =       0.002353699285
              std dev =       0.664567674582
             le_variance =       0.441650194099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710847596
                                         uncertainty =       0.002144225900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710847596
                                         uncertainty =       0.002144225900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469920309
  error estimate for blocks of size 2^( 2) =       0.000493823222
  error estimate for blocks of size 2^( 3) =       0.000516027349
  error estimate for blocks of size 2^( 4) =       0.000532028874
  error estimate for blocks of size 2^( 5) =       0.000541016295
  error estimate for blocks of size 2^( 6) =       0.000546038534
  error estimate for blocks of size 2^( 7) =       0.000549894210

      target function =      -0.745517053029
              le_mean =     -22.662536390280
             les_mean =     514.040316269528
             stat err =       0.000542244478
             autocorr =       1.331502074036
   target nu stat err =       0.000542244478
   target dn stat err =       0.002772149895
      target stat err =       0.002353699056
              std dev =       0.664567673724
             le_variance =       0.441650192959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710848166
                                         uncertainty =       0.002144225939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710848166
                                         uncertainty =       0.002144225939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469920309
  error estimate for blocks of size 2^( 2) =       0.000493823222
  error estimate for blocks of size 2^( 3) =       0.000516027349
  error estimate for blocks of size 2^( 4) =       0.000532028874
  error estimate for blocks of size 2^( 5) =       0.000541016296
  error estimate for blocks of size 2^( 6) =       0.000546038534
  error estimate for blocks of size 2^( 7) =       0.000549894210

      target function =      -0.745517050904
              le_mean =     -22.662536390275
             les_mean =     514.040316271886
             stat err =       0.000542244478
             autocorr =       1.331502073278
   target nu stat err =       0.000542244478
   target dn stat err =       0.002772150055
      target stat err =       0.002353699170
              std dev =       0.664567674153
             le_variance =       0.441650193529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710848664
                                         uncertainty =       0.002144225974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710848664
                                         uncertainty =       0.002144225974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469920309
  error estimate for blocks of size 2^( 2) =       0.000493823223
  error estimate for blocks of size 2^( 3) =       0.000516027350
  error estimate for blocks of size 2^( 4) =       0.000532028874
  error estimate for blocks of size 2^( 5) =       0.000541016296
  error estimate for blocks of size 2^( 6) =       0.000546038534
  error estimate for blocks of size 2^( 7) =       0.000549894210

      target function =      -0.745517049044
              le_mean =     -22.662536390270
             les_mean =     514.040316273949
             stat err =       0.000542244478
             autocorr =       1.331502072591
   target nu stat err =       0.000542244478
   target dn stat err =       0.002772150196
      target stat err =       0.002353699271
              std dev =       0.664567674528
             le_variance =       0.441650194028


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745517048778        initial
     6.1035e+04     6.1035e+05             4.6447e-09        -0.745517053029  <--
     2.4414e+05     2.4414e+06             1.1612e-09        -0.745517050904
     9.7656e+05     9.7656e+06             2.9030e-10        -0.745517049044

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 4.3288e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911087e-03 3 1  ON 10
ci_012                -9.099643e-03 3 1  ON 11
ci_013                 8.350011e-03 3 1  ON 12
ci_014                 9.370398e-03 3 1  ON 13
ci_015                 9.520673e-03 3 1  ON 14
ci_016                 9.413488e-03 3 1  ON 15
ci_017                 8.493790e-03 3 1  ON 16
ci_018                 8.286894e-03 3 1  ON 17
ci_019                -1.221599e-03 3 1  ON 18
ci_020                -1.534391e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188156e-03 3 1  ON 27
ci_029                -5.082820e-03 3 1  ON 28
ci_030                -4.170441e-03 3 1  ON 29
ci_031                 3.328039e-03 3 1  ON 30
ci_032                 4.542565e-03 3 1  ON 31
ci_033                 2.362993e-03 3 1  ON 32
ci_034                 4.136284e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153791e-03 3 1  ON 35
ci_037                 3.539155e-03 3 1  ON 36
ci_038                 3.699887e-03 3 1  ON 37
ci_039                 4.622585e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944827e-03 3 1  ON 42
ci_044                 3.188805e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335580e-04 3 1  ON 47
ci_049                 7.787060e-04 3 1  ON 48
ci_050                 9.956918e-04 3 1  ON 49
ci_051                -3.143810e-04 3 1  ON 50
ci_052                -1.210995e-03 3 1  ON 51
ci_053                -2.434131e-03 3 1  ON 52
ci_054                -2.689549e-03 3 1  ON 53
ci_055                -1.798614e-03 3 1  ON 54
ci_056                -1.928955e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884009e-04 3 1  ON 57
ci_059                -5.511660e-04 3 1  ON 58
ci_060                -7.599778e-04 3 1  ON 59
ci_061                -5.118370e-05 3 1  ON 60
ci_062                -9.210103e-04 3 1  ON 61
ci_063                -8.860149e-04 3 1  ON 62
ci_064                -5.241175e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812747e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541311e-04 3 1  ON 68
ci_070                -4.262701e-04 3 1  ON 69
ci_071                -2.088332e-03 3 1  ON 70
ci_072                -2.001054e-03 3 1  ON 71
ci_073                 1.611468e-04 3 1  ON 72
ci_074                 1.976776e-04 3 1  ON 73
ci_075                 1.616134e-04 3 1  ON 74
ci_076                 7.850657e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3672e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6732
    reference variance = 0.422612
====================================================
  Execution time = 2.5682e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4889e-01
  Total weights = 1.955481834e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438853053953
                                         uncertainty =       0.002524355964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438853053953
                                         uncertainty =       0.002524355964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468469077
  error estimate for blocks of size 2^( 2) =       0.000493147694
  error estimate for blocks of size 2^( 3) =       0.000515197989
  error estimate for blocks of size 2^( 4) =       0.000531558966
  error estimate for blocks of size 2^( 5) =       0.000541431250
  error estimate for blocks of size 2^( 6) =       0.000544667628
  error estimate for blocks of size 2^( 7) =       0.000546515608

      target function =      -0.746227517268
              le_mean =     -22.661911592326
             les_mean =     514.011123691858
             stat err =       0.000541043363
             autocorr =       1.333835559216
   target nu stat err =       0.000541043363
   target dn stat err =       0.002900524361
      target stat err =       0.002457777524
              std dev =       0.662515321554
             le_variance =       0.438926551294


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266191159233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746234655545       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746234656717       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746234656829       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746234656836       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746234656821       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746234656820       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746234656836       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746234656850       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746234656825       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746234656849       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746234656825       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+04 is 1.039237e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746234655545       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746234655838       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746234655866       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746234655868       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746234655910       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746234655800       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746234655802       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746234655837       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746234655723       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746234655865       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746234655770       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+04 is 2.598096e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746234655545       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746234655618       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746234655625       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746234655612       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746234655787       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746234655344       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746234656052       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746234655114       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746234656323       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746234655372       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746234655328       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+05 is 6.495243e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100160 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0411e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911087e-03 3 1  ON 10
ci_012                -9.099643e-03 3 1  ON 11
ci_013                 8.350012e-03 3 1  ON 12
ci_014                 9.370396e-03 3 1  ON 13
ci_015                 9.520672e-03 3 1  ON 14
ci_016                 9.413486e-03 3 1  ON 15
ci_017                 8.493791e-03 3 1  ON 16
ci_018                 8.286893e-03 3 1  ON 17
ci_019                -1.221601e-03 3 1  ON 18
ci_020                -1.534393e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467257e-03 3 1  ON 26
ci_028                 6.188156e-03 3 1  ON 27
ci_029                -5.082820e-03 3 1  ON 28
ci_030                -4.170441e-03 3 1  ON 29
ci_031                 3.328041e-03 3 1  ON 30
ci_032                 4.542567e-03 3 1  ON 31
ci_033                 2.362994e-03 3 1  ON 32
ci_034                 4.136283e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153791e-03 3 1  ON 35
ci_037                 3.539155e-03 3 1  ON 36
ci_038                 3.699886e-03 3 1  ON 37
ci_039                 4.622584e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944827e-03 3 1  ON 42
ci_044                 3.188804e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720992e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335580e-04 3 1  ON 47
ci_049                 7.787045e-04 3 1  ON 48
ci_050                 9.956914e-04 3 1  ON 49
ci_051                -3.143818e-04 3 1  ON 50
ci_052                -1.210996e-03 3 1  ON 51
ci_053                -2.434131e-03 3 1  ON 52
ci_054                -2.689549e-03 3 1  ON 53
ci_055                -1.798613e-03 3 1  ON 54
ci_056                -1.928955e-03 3 1  ON 55
ci_057                -1.307234e-03 3 1  ON 56
ci_058                -9.884016e-04 3 1  ON 57
ci_059                -5.511663e-04 3 1  ON 58
ci_060                -7.599777e-04 3 1  ON 59
ci_061                -5.118315e-05 3 1  ON 60
ci_062                -9.210098e-04 3 1  ON 61
ci_063                -8.860148e-04 3 1  ON 62
ci_064                -5.241171e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812748e-03 3 1  ON 66
ci_068                -1.557108e-03 3 1  ON 67
ci_069                -5.541307e-04 3 1  ON 68
ci_070                -4.262696e-04 3 1  ON 69
ci_071                -2.088331e-03 3 1  ON 70
ci_072                -2.001052e-03 3 1  ON 71
ci_073                 1.611471e-04 3 1  ON 72
ci_074                 1.976777e-04 3 1  ON 73
ci_075                 1.616150e-04 3 1  ON 74
ci_076                 7.850649e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6561
    reference variance = 0.35198
====================================================
  Execution time = 2.4983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5641e-01
  Total weights = 1.9552e+06
  Execution time = 3.6095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443061642557
                                         uncertainty =       0.003677199844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443061642557
                                         uncertainty =       0.003677199844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470669703
  error estimate for blocks of size 2^( 2) =       0.000494753558
  error estimate for blocks of size 2^( 3) =       0.000516057419
  error estimate for blocks of size 2^( 4) =       0.000531870585
  error estimate for blocks of size 2^( 5) =       0.000540791982
  error estimate for blocks of size 2^( 6) =       0.000546443450
  error estimate for blocks of size 2^( 7) =       0.000550051366

      target function =      -0.740076659986
              le_mean =     -22.662416159908
             les_mean =     514.041512812477
             stat err =       0.000542289346
             autocorr =       1.327485103731
   target nu stat err =       0.000542289346
   target dn stat err =       0.005710383240
      target stat err =       0.004658684583
              std dev =       0.665627477515
             le_variance =       0.443059938823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443061640394
                                         uncertainty =       0.003677199884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443061640394
                                         uncertainty =       0.003677199884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470669702
  error estimate for blocks of size 2^( 2) =       0.000494753557
  error estimate for blocks of size 2^( 3) =       0.000516057418
  error estimate for blocks of size 2^( 4) =       0.000531870584
  error estimate for blocks of size 2^( 5) =       0.000540791981
  error estimate for blocks of size 2^( 6) =       0.000546443449
  error estimate for blocks of size 2^( 7) =       0.000550051365

      target function =      -0.740076625431
              le_mean =     -22.662416159827
             les_mean =     514.041512851328
             stat err =       0.000542289345
             autocorr =       1.327485105650
   target nu stat err =       0.000542289345
   target dn stat err =       0.005710397894
      target stat err =       0.004658695912
              std dev =       0.665627475888
             le_variance =       0.443059936657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443061641475
                                         uncertainty =       0.003677199864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443061641475
                                         uncertainty =       0.003677199864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470669703
  error estimate for blocks of size 2^( 2) =       0.000494753557
  error estimate for blocks of size 2^( 3) =       0.000516057418
  error estimate for blocks of size 2^( 4) =       0.000531870584
  error estimate for blocks of size 2^( 5) =       0.000540791982
  error estimate for blocks of size 2^( 6) =       0.000546443450
  error estimate for blocks of size 2^( 7) =       0.000550051365

      target function =      -0.740076642709
              le_mean =     -22.662416159867
             les_mean =     514.041512831902
             stat err =       0.000542289345
             autocorr =       1.327485104702
   target nu stat err =       0.000542289345
   target dn stat err =       0.005710390567
      target stat err =       0.004658690247
              std dev =       0.665627476702
             le_variance =       0.443059937740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443061642421
                                         uncertainty =       0.003677199847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443061642421
                                         uncertainty =       0.003677199847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470669703
  error estimate for blocks of size 2^( 2) =       0.000494753558
  error estimate for blocks of size 2^( 3) =       0.000516057419
  error estimate for blocks of size 2^( 4) =       0.000531870585
  error estimate for blocks of size 2^( 5) =       0.000540791982
  error estimate for blocks of size 2^( 6) =       0.000546443450
  error estimate for blocks of size 2^( 7) =       0.000550051366

      target function =      -0.740076657826
              le_mean =     -22.662416159903
             les_mean =     514.041512814905
             stat err =       0.000542289346
             autocorr =       1.327485103857
   target nu stat err =       0.000542289346
   target dn stat err =       0.005710384156
      target stat err =       0.004658685291
              std dev =       0.665627477414
             le_variance =       0.443059938688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740076659986        initial  <--
     1.5259e+04     1.5259e+05             1.0392e-08        -0.740076625431
     6.1035e+04     6.1035e+05             2.5981e-09        -0.740076642709
     2.4414e+05     2.4414e+06             6.4952e-10        -0.740076657826

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0961
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911087e-03 3 1  ON 10
ci_012                -9.099643e-03 3 1  ON 11
ci_013                 8.350011e-03 3 1  ON 12
ci_014                 9.370398e-03 3 1  ON 13
ci_015                 9.520673e-03 3 1  ON 14
ci_016                 9.413488e-03 3 1  ON 15
ci_017                 8.493790e-03 3 1  ON 16
ci_018                 8.286894e-03 3 1  ON 17
ci_019                -1.221599e-03 3 1  ON 18
ci_020                -1.534391e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188156e-03 3 1  ON 27
ci_029                -5.082820e-03 3 1  ON 28
ci_030                -4.170441e-03 3 1  ON 29
ci_031                 3.328039e-03 3 1  ON 30
ci_032                 4.542565e-03 3 1  ON 31
ci_033                 2.362993e-03 3 1  ON 32
ci_034                 4.136284e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153791e-03 3 1  ON 35
ci_037                 3.539155e-03 3 1  ON 36
ci_038                 3.699887e-03 3 1  ON 37
ci_039                 4.622585e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944827e-03 3 1  ON 42
ci_044                 3.188805e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335580e-04 3 1  ON 47
ci_049                 7.787060e-04 3 1  ON 48
ci_050                 9.956918e-04 3 1  ON 49
ci_051                -3.143810e-04 3 1  ON 50
ci_052                -1.210995e-03 3 1  ON 51
ci_053                -2.434131e-03 3 1  ON 52
ci_054                -2.689549e-03 3 1  ON 53
ci_055                -1.798614e-03 3 1  ON 54
ci_056                -1.928955e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884009e-04 3 1  ON 57
ci_059                -5.511660e-04 3 1  ON 58
ci_060                -7.599778e-04 3 1  ON 59
ci_061                -5.118370e-05 3 1  ON 60
ci_062                -9.210103e-04 3 1  ON 61
ci_063                -8.860149e-04 3 1  ON 62
ci_064                -5.241175e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812747e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541311e-04 3 1  ON 68
ci_070                -4.262701e-04 3 1  ON 69
ci_071                -2.088332e-03 3 1  ON 70
ci_072                -2.001054e-03 3 1  ON 71
ci_073                 1.611468e-04 3 1  ON 72
ci_074                 1.976776e-04 3 1  ON 73
ci_075                 1.616134e-04 3 1  ON 74
ci_076                 7.850657e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3513e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6152
    reference variance = 0.341618
====================================================
  Execution time = 2.7940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5299e-01
  Total weights = 1.954961646e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441755197569
                                         uncertainty =       0.002292988452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441755197569
                                         uncertainty =       0.002292988452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469941334
  error estimate for blocks of size 2^( 2) =       0.000493980698
  error estimate for blocks of size 2^( 3) =       0.000516086460
  error estimate for blocks of size 2^( 4) =       0.000531735857
  error estimate for blocks of size 2^( 5) =       0.000540844844
  error estimate for blocks of size 2^( 6) =       0.000546119834
  error estimate for blocks of size 2^( 7) =       0.000547026728

      target function =      -0.742862639859
              le_mean =     -22.661281343127
             les_mean =     513.986662937715
             stat err =       0.000541431816
             autocorr =       1.327395234812
   target nu stat err =       0.000541431816
   target dn stat err =       0.003183643091
      target stat err =       0.002658234967
              std dev =       0.664597407767
             le_variance =       0.441689714410


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266128134313e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742871166549       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742871166683       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742871166701       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742871166581       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742871166785       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742871167094       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742871167117       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742871166597       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742871166371       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742871166784       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742871166944       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 1.268375e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742871166549       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742871166582       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742871166587       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742871166587       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742871166588       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742871166588       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742871166588       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742871166588       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742871166588       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742871165570       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742871167853       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+05 is 3.170938e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742871166549       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742871166557       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742871166558       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742871166558       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742871166558       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742871168219       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742871164865       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742871166559       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742871161307       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742871166934       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742871158915       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+06 is 7.927348e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104355 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2647e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911087e-03 3 1  ON 10
ci_012                -9.099643e-03 3 1  ON 11
ci_013                 8.350011e-03 3 1  ON 12
ci_014                 9.370398e-03 3 1  ON 13
ci_015                 9.520673e-03 3 1  ON 14
ci_016                 9.413488e-03 3 1  ON 15
ci_017                 8.493790e-03 3 1  ON 16
ci_018                 8.286894e-03 3 1  ON 17
ci_019                -1.221600e-03 3 1  ON 18
ci_020                -1.534391e-03 3 1  ON 19
ci_021                -1.177667e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188156e-03 3 1  ON 27
ci_029                -5.082819e-03 3 1  ON 28
ci_030                -4.170441e-03 3 1  ON 29
ci_031                 3.328039e-03 3 1  ON 30
ci_032                 4.542565e-03 3 1  ON 31
ci_033                 2.362993e-03 3 1  ON 32
ci_034                 4.136284e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153791e-03 3 1  ON 35
ci_037                 3.539155e-03 3 1  ON 36
ci_038                 3.699887e-03 3 1  ON 37
ci_039                 4.622585e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944827e-03 3 1  ON 42
ci_044                 3.188805e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335581e-04 3 1  ON 47
ci_049                 7.787060e-04 3 1  ON 48
ci_050                 9.956916e-04 3 1  ON 49
ci_051                -3.143810e-04 3 1  ON 50
ci_052                -1.210995e-03 3 1  ON 51
ci_053                -2.434131e-03 3 1  ON 52
ci_054                -2.689548e-03 3 1  ON 53
ci_055                -1.798615e-03 3 1  ON 54
ci_056                -1.928955e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884009e-04 3 1  ON 57
ci_059                -5.511659e-04 3 1  ON 58
ci_060                -7.599778e-04 3 1  ON 59
ci_061                -5.118362e-05 3 1  ON 60
ci_062                -9.210102e-04 3 1  ON 61
ci_063                -8.860149e-04 3 1  ON 62
ci_064                -5.241175e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812747e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541310e-04 3 1  ON 68
ci_070                -4.262701e-04 3 1  ON 69
ci_071                -2.088332e-03 3 1  ON 70
ci_072                -2.001054e-03 3 1  ON 71
ci_073                 1.611467e-04 3 1  ON 72
ci_074                 1.976777e-04 3 1  ON 73
ci_075                 1.616133e-04 3 1  ON 74
ci_076                 7.850658e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6319
    reference variance = 0.496826
====================================================
  Execution time = 2.5244e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5075e-01
  Total weights = 1.9552e+06
  Execution time = 3.6068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441748571133
                                         uncertainty =       0.002472869526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441748571133
                                         uncertainty =       0.002472869526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469947738
  error estimate for blocks of size 2^( 2) =       0.000493599076
  error estimate for blocks of size 2^( 3) =       0.000515630657
  error estimate for blocks of size 2^( 4) =       0.000531118231
  error estimate for blocks of size 2^( 5) =       0.000540553958
  error estimate for blocks of size 2^( 6) =       0.000546393676
  error estimate for blocks of size 2^( 7) =       0.000550119519

      target function =      -0.744707194348
              le_mean =     -22.662776181451
             les_mean =     514.052173504419
             stat err =       0.000542046346
             autocorr =       1.330373901180
   target nu stat err =       0.000542046346
   target dn stat err =       0.002935582081
      target stat err =       0.002479349451
              std dev =       0.664606464109
             le_variance =       0.441701752135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441748570933
                                         uncertainty =       0.002472869517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441748570933
                                         uncertainty =       0.002472869517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469947737
  error estimate for blocks of size 2^( 2) =       0.000493599076
  error estimate for blocks of size 2^( 3) =       0.000515630657
  error estimate for blocks of size 2^( 4) =       0.000531118231
  error estimate for blocks of size 2^( 5) =       0.000540553958
  error estimate for blocks of size 2^( 6) =       0.000546393676
  error estimate for blocks of size 2^( 7) =       0.000550119519

      target function =      -0.744707209925
              le_mean =     -22.662776181449
             les_mean =     514.052173485346
             stat err =       0.000542046346
             autocorr =       1.330373901454
   target nu stat err =       0.000542046346
   target dn stat err =       0.002935581858
      target stat err =       0.002479349374
              std dev =       0.664606463961
             le_variance =       0.441701751938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441748571033
                                         uncertainty =       0.002472869521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441748571033
                                         uncertainty =       0.002472869521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469947738
  error estimate for blocks of size 2^( 2) =       0.000493599076
  error estimate for blocks of size 2^( 3) =       0.000515630657
  error estimate for blocks of size 2^( 4) =       0.000531118231
  error estimate for blocks of size 2^( 5) =       0.000540553958
  error estimate for blocks of size 2^( 6) =       0.000546393676
  error estimate for blocks of size 2^( 7) =       0.000550119519

      target function =      -0.744707202138
              le_mean =     -22.662776181450
             les_mean =     514.052173494880
             stat err =       0.000542046346
             autocorr =       1.330373901328
   target nu stat err =       0.000542046346
   target dn stat err =       0.002935581969
      target stat err =       0.002479349412
              std dev =       0.664606464035
             le_variance =       0.441701752037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441748571120
                                         uncertainty =       0.002472869525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441748571120
                                         uncertainty =       0.002472869525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469947738
  error estimate for blocks of size 2^( 2) =       0.000493599076
  error estimate for blocks of size 2^( 3) =       0.000515630657
  error estimate for blocks of size 2^( 4) =       0.000531118231
  error estimate for blocks of size 2^( 5) =       0.000540553958
  error estimate for blocks of size 2^( 6) =       0.000546393676
  error estimate for blocks of size 2^( 7) =       0.000550119519

      target function =      -0.744707195322
              le_mean =     -22.662776181451
             les_mean =     514.052173503226
             stat err =       0.000542046346
             autocorr =       1.330373901203
   target nu stat err =       0.000542046346
   target dn stat err =       0.002935582067
      target stat err =       0.002479349446
              std dev =       0.664606464099
             le_variance =       0.441701752123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744707194348        initial
     1.5259e+05     1.5259e+06             1.2684e-09        -0.744707209925  <--
     6.1035e+05     6.1035e+06             3.1709e-10        -0.744707202138
     2.4414e+06     2.4414e+07             7.9273e-11        -0.744707195322

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 4.6585e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911088e-03 3 1  ON 10
ci_012                -9.099642e-03 3 1  ON 11
ci_013                 8.350011e-03 3 1  ON 12
ci_014                 9.370398e-03 3 1  ON 13
ci_015                 9.520673e-03 3 1  ON 14
ci_016                 9.413488e-03 3 1  ON 15
ci_017                 8.493790e-03 3 1  ON 16
ci_018                 8.286894e-03 3 1  ON 17
ci_019                -1.221600e-03 3 1  ON 18
ci_020                -1.534392e-03 3 1  ON 19
ci_021                -1.177667e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188156e-03 3 1  ON 27
ci_029                -5.082819e-03 3 1  ON 28
ci_030                -4.170441e-03 3 1  ON 29
ci_031                 3.328039e-03 3 1  ON 30
ci_032                 4.542565e-03 3 1  ON 31
ci_033                 2.362993e-03 3 1  ON 32
ci_034                 4.136284e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153791e-03 3 1  ON 35
ci_037                 3.539155e-03 3 1  ON 36
ci_038                 3.699887e-03 3 1  ON 37
ci_039                 4.622585e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733713e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188805e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335583e-04 3 1  ON 47
ci_049                 7.787061e-04 3 1  ON 48
ci_050                 9.956910e-04 3 1  ON 49
ci_051                -3.143809e-04 3 1  ON 50
ci_052                -1.210996e-03 3 1  ON 51
ci_053                -2.434131e-03 3 1  ON 52
ci_054                -2.689548e-03 3 1  ON 53
ci_055                -1.798615e-03 3 1  ON 54
ci_056                -1.928954e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884009e-04 3 1  ON 57
ci_059                -5.511658e-04 3 1  ON 58
ci_060                -7.599776e-04 3 1  ON 59
ci_061                -5.118340e-05 3 1  ON 60
ci_062                -9.210099e-04 3 1  ON 61
ci_063                -8.860150e-04 3 1  ON 62
ci_064                -5.241177e-04 3 1  ON 63
ci_065                -1.359808e-03 3 1  ON 64
ci_066                -1.883851e-03 3 1  ON 65
ci_067                -1.812747e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541308e-04 3 1  ON 68
ci_070                -4.262701e-04 3 1  ON 69
ci_071                -2.088332e-03 3 1  ON 70
ci_072                -2.001054e-03 3 1  ON 71
ci_073                 1.611466e-04 3 1  ON 72
ci_074                 1.976778e-04 3 1  ON 73
ci_075                 1.616130e-04 3 1  ON 74
ci_076                 7.850660e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.6362
    reference variance = 0.338656
====================================================
  Execution time = 2.5759e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5176e-01
  Total weights = 1.955160256e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441507411625
                                         uncertainty =       0.002187354152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441507411625
                                         uncertainty =       0.002187354152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469840533
  error estimate for blocks of size 2^( 2) =       0.000493843957
  error estimate for blocks of size 2^( 3) =       0.000515535256
  error estimate for blocks of size 2^( 4) =       0.000532404760
  error estimate for blocks of size 2^( 5) =       0.000540276148
  error estimate for blocks of size 2^( 6) =       0.000544455775
  error estimate for blocks of size 2^( 7) =       0.000547785185

      target function =      -0.743879472132
              le_mean =     -22.662382993118
             les_mean =     514.035361297655
             stat err =       0.000541230467
             autocorr =       1.326977355919
   target nu stat err =       0.000541230467
   target dn stat err =       0.002624653167
      target stat err =       0.002226473558
              std dev =       0.664454853269
             le_variance =       0.441500252033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266238299312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743885221420       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743885221953       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743885222037       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743885222059       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743885222059       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743885222047       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743885222032       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743885222021       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743885222092       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 4.973380e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743885221420       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743885221553       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743885221574       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743885221579       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743885221580       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743885221629       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743885221395       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743885221233       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743885221626       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 1.243345e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743885221420       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743885221453       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743885221458       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743885221460       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743885221461       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743885220453       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743885222280       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743885222952       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743885221621       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+05 is 3.108364e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0504e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911086e-03 3 1  ON 10
ci_012                -9.099642e-03 3 1  ON 11
ci_013                 8.350010e-03 3 1  ON 12
ci_014                 9.370397e-03 3 1  ON 13
ci_015                 9.520672e-03 3 1  ON 14
ci_016                 9.413488e-03 3 1  ON 15
ci_017                 8.493790e-03 3 1  ON 16
ci_018                 8.286893e-03 3 1  ON 17
ci_019                -1.221602e-03 3 1  ON 18
ci_020                -1.534392e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467258e-03 3 1  ON 26
ci_028                 6.188156e-03 3 1  ON 27
ci_029                -5.082818e-03 3 1  ON 28
ci_030                -4.170441e-03 3 1  ON 29
ci_031                 3.328040e-03 3 1  ON 30
ci_032                 4.542566e-03 3 1  ON 31
ci_033                 2.362993e-03 3 1  ON 32
ci_034                 4.136283e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153791e-03 3 1  ON 35
ci_037                 3.539155e-03 3 1  ON 36
ci_038                 3.699887e-03 3 1  ON 37
ci_039                 4.622585e-03 3 1  ON 38
ci_040                 4.935346e-03 3 1  ON 39
ci_041                 2.970920e-03 3 1  ON 40
ci_042                 2.733714e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188805e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.335582e-04 3 1  ON 47
ci_049                 7.787062e-04 3 1  ON 48
ci_050                 9.956909e-04 3 1  ON 49
ci_051                -3.143809e-04 3 1  ON 50
ci_052                -1.210996e-03 3 1  ON 51
ci_053                -2.434130e-03 3 1  ON 52
ci_054                -2.689548e-03 3 1  ON 53
ci_055                -1.798614e-03 3 1  ON 54
ci_056                -1.928954e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884008e-04 3 1  ON 57
ci_059                -5.511656e-04 3 1  ON 58
ci_060                -7.599775e-04 3 1  ON 59
ci_061                -5.118326e-05 3 1  ON 60
ci_062                -9.210097e-04 3 1  ON 61
ci_063                -8.860149e-04 3 1  ON 62
ci_064                -5.241173e-04 3 1  ON 63
ci_065                -1.359807e-03 3 1  ON 64
ci_066                -1.883850e-03 3 1  ON 65
ci_067                -1.812746e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541307e-04 3 1  ON 68
ci_070                -4.262700e-04 3 1  ON 69
ci_071                -2.088331e-03 3 1  ON 70
ci_072                -2.001054e-03 3 1  ON 71
ci_073                 1.611465e-04 3 1  ON 72
ci_074                 1.976777e-04 3 1  ON 73
ci_075                 1.616127e-04 3 1  ON 74
ci_076                 7.850656e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.6334
    reference variance = 0.350108
====================================================
  Execution time = 2.5238e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5247e-01
  Total weights = 1.9554e+06
  Execution time = 3.6155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440192209861
                                         uncertainty =       0.002290426996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440192209861
                                         uncertainty =       0.002290426996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469188090
  error estimate for blocks of size 2^( 2) =       0.000492909468
  error estimate for blocks of size 2^( 3) =       0.000515077759
  error estimate for blocks of size 2^( 4) =       0.000531879124
  error estimate for blocks of size 2^( 5) =       0.000540267164
  error estimate for blocks of size 2^( 6) =       0.000545546651
  error estimate for blocks of size 2^( 7) =       0.000549069916

      target function =      -0.743300261654
              le_mean =     -22.662725805551
             les_mean =     514.051607865880
             stat err =       0.000541690714
             autocorr =       1.332934542737
   target nu stat err =       0.000541690714
   target dn stat err =       0.003148026713
      target stat err =       0.002638691389
              std dev =       0.663532159670
             le_variance =       0.440274926916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440192208292
                                         uncertainty =       0.002290426936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440192208292
                                         uncertainty =       0.002290426936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469188089
  error estimate for blocks of size 2^( 2) =       0.000492909467
  error estimate for blocks of size 2^( 3) =       0.000515077758
  error estimate for blocks of size 2^( 4) =       0.000531879124
  error estimate for blocks of size 2^( 5) =       0.000540267164
  error estimate for blocks of size 2^( 6) =       0.000545546650
  error estimate for blocks of size 2^( 7) =       0.000549069915

      target function =      -0.743300277768
              le_mean =     -22.662725805543
             les_mean =     514.051607845781
             stat err =       0.000541690713
             autocorr =       1.332934545626
   target nu stat err =       0.000541690713
   target dn stat err =       0.003148023698
      target stat err =       0.002638689101
              std dev =       0.663532158495
             le_variance =       0.440274925357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440192209076
                                         uncertainty =       0.002290426966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440192209076
                                         uncertainty =       0.002290426966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469188089
  error estimate for blocks of size 2^( 2) =       0.000492909468
  error estimate for blocks of size 2^( 3) =       0.000515077758
  error estimate for blocks of size 2^( 4) =       0.000531879124
  error estimate for blocks of size 2^( 5) =       0.000540267164
  error estimate for blocks of size 2^( 6) =       0.000545546650
  error estimate for blocks of size 2^( 7) =       0.000549069915

      target function =      -0.743300269711
              le_mean =     -22.662725805547
             les_mean =     514.051607855831
             stat err =       0.000541690713
             autocorr =       1.332934544175
   target nu stat err =       0.000541690713
   target dn stat err =       0.003148025206
      target stat err =       0.002638690245
              std dev =       0.663532159082
             le_variance =       0.440274926137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440192209763
                                         uncertainty =       0.002290426992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440192209763
                                         uncertainty =       0.002290426992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469188090
  error estimate for blocks of size 2^( 2) =       0.000492909468
  error estimate for blocks of size 2^( 3) =       0.000515077759
  error estimate for blocks of size 2^( 4) =       0.000531879124
  error estimate for blocks of size 2^( 5) =       0.000540267164
  error estimate for blocks of size 2^( 6) =       0.000545546651
  error estimate for blocks of size 2^( 7) =       0.000549069916

      target function =      -0.743300262661
              le_mean =     -22.662725805551
             les_mean =     514.051607864624
             stat err =       0.000541690714
             autocorr =       1.332934542905
   target nu stat err =       0.000541690714
   target dn stat err =       0.003148026525
      target stat err =       0.002638691246
              std dev =       0.663532159597
             le_variance =       0.440274926819


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743300261654        initial
     3.8147e+04     3.8147e+05             4.9734e-09        -0.743300277768  <--
     1.5259e+05     1.5259e+06             1.2433e-09        -0.743300269711
     6.1035e+05     6.1035e+06             3.1084e-10        -0.743300262661

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 4.3373e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949614e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911083e-03 3 1  ON 10
ci_012                -9.099641e-03 3 1  ON 11
ci_013                 8.350007e-03 3 1  ON 12
ci_014                 9.370395e-03 3 1  ON 13
ci_015                 9.520670e-03 3 1  ON 14
ci_016                 9.413487e-03 3 1  ON 15
ci_017                 8.493788e-03 3 1  ON 16
ci_018                 8.286892e-03 3 1  ON 17
ci_019                -1.221605e-03 3 1  ON 18
ci_020                -1.534394e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179799e-02 3 1  ON 21
ci_023                 4.854174e-03 3 1  ON 22
ci_024                 4.919596e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147158e-02 3 1  ON 25
ci_027                 6.467257e-03 3 1  ON 26
ci_028                 6.188156e-03 3 1  ON 27
ci_029                -5.082816e-03 3 1  ON 28
ci_030                -4.170441e-03 3 1  ON 29
ci_031                 3.328042e-03 3 1  ON 30
ci_032                 4.542568e-03 3 1  ON 31
ci_033                 2.362993e-03 3 1  ON 32
ci_034                 4.136281e-03 3 1  ON 33
ci_035                 1.723328e-03 3 1  ON 34
ci_036                 2.153790e-03 3 1  ON 35
ci_037                 3.539155e-03 3 1  ON 36
ci_038                 3.699885e-03 3 1  ON 37
ci_039                 4.622586e-03 3 1  ON 38
ci_040                 4.935345e-03 3 1  ON 39
ci_041                 2.970919e-03 3 1  ON 40
ci_042                 2.733715e-03 3 1  ON 41
ci_043                 2.944825e-03 3 1  ON 42
ci_044                 3.188804e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720990e-03 3 1  ON 45
ci_047                -1.002270e-03 3 1  ON 46
ci_048                -8.335579e-04 3 1  ON 47
ci_049                 7.787066e-04 3 1  ON 48
ci_050                 9.956903e-04 3 1  ON 49
ci_051                -3.143807e-04 3 1  ON 50
ci_052                -1.210997e-03 3 1  ON 51
ci_053                -2.434130e-03 3 1  ON 52
ci_054                -2.689549e-03 3 1  ON 53
ci_055                -1.798613e-03 3 1  ON 54
ci_056                -1.928954e-03 3 1  ON 55
ci_057                -1.307232e-03 3 1  ON 56
ci_058                -9.884004e-04 3 1  ON 57
ci_059                -5.511649e-04 3 1  ON 58
ci_060                -7.599770e-04 3 1  ON 59
ci_061                -5.118285e-05 3 1  ON 60
ci_062                -9.210092e-04 3 1  ON 61
ci_063                -8.860145e-04 3 1  ON 62
ci_064                -5.241164e-04 3 1  ON 63
ci_065                -1.359806e-03 3 1  ON 64
ci_066                -1.883850e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541304e-04 3 1  ON 68
ci_070                -4.262697e-04 3 1  ON 69
ci_071                -2.088330e-03 3 1  ON 70
ci_072                -2.001053e-03 3 1  ON 71
ci_073                 1.611463e-04 3 1  ON 72
ci_074                 1.976773e-04 3 1  ON 73
ci_075                 1.616118e-04 3 1  ON 74
ci_076                 7.850644e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2652e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7267
    reference variance = 0.340804
====================================================
  Execution time = 2.5700e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4752e-01
  Total weights = 1.955177417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439399293688
                                         uncertainty =       0.002466927568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439399293688
                                         uncertainty =       0.002466927568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468722957
  error estimate for blocks of size 2^( 2) =       0.000492136992
  error estimate for blocks of size 2^( 3) =       0.000513426958
  error estimate for blocks of size 2^( 4) =       0.000530060218
  error estimate for blocks of size 2^( 5) =       0.000539364941
  error estimate for blocks of size 2^( 6) =       0.000544877562
  error estimate for blocks of size 2^( 7) =       0.000546307623

      target function =      -0.747356512333
              le_mean =     -22.662325858100
             les_mean =     514.028534401243
             stat err =       0.000540152586
             autocorr =       1.328007324283
   target nu stat err =       0.000540152586
   target dn stat err =       0.003048751157
      target stat err =       0.002585110674
              std dev =       0.662874362100
             le_variance =       0.439402419930


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266232585810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747364524925       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747364527745       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747364528054       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747364528133       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747364528150       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747364528195       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747364528180       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747364528198       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747364528190       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747364528218       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747364528187       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747364528195       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 3.026478e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747364524925       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747364525630       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747364525707       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747364525728       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747364525731       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747364525710       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747364525676       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747364525805       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747364525785       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747364525814       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747364525726       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747364525732       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 7.566216e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747364524925       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747364525101       residual = 5.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747364525120       residual = 7.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747364525125       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747364525179       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747364525104       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747364525281       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747364525402       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747364525129       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747364525376       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747364524810       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747364525305       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+05 is 1.891555e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0446e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949613e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208050e-02 3 1  ON 9
ci_011                -9.911081e-03 3 1  ON 10
ci_012                -9.099642e-03 3 1  ON 11
ci_013                 8.350005e-03 3 1  ON 12
ci_014                 9.370395e-03 3 1  ON 13
ci_015                 9.520666e-03 3 1  ON 14
ci_016                 9.413487e-03 3 1  ON 15
ci_017                 8.493788e-03 3 1  ON 16
ci_018                 8.286892e-03 3 1  ON 17
ci_019                -1.221612e-03 3 1  ON 18
ci_020                -1.534398e-03 3 1  ON 19
ci_021                -1.177667e-02 3 1  ON 20
ci_022                -1.179800e-02 3 1  ON 21
ci_023                 4.854173e-03 3 1  ON 22
ci_024                 4.919595e-03 3 1  ON 23
ci_025                 1.143511e-02 3 1  ON 24
ci_026                 1.147159e-02 3 1  ON 25
ci_027                 6.467256e-03 3 1  ON 26
ci_028                 6.188156e-03 3 1  ON 27
ci_029                -5.082817e-03 3 1  ON 28
ci_030                -4.170441e-03 3 1  ON 29
ci_031                 3.328047e-03 3 1  ON 30
ci_032                 4.542566e-03 3 1  ON 31
ci_033                 2.362996e-03 3 1  ON 32
ci_034                 4.136280e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153791e-03 3 1  ON 35
ci_037                 3.539153e-03 3 1  ON 36
ci_038                 3.699883e-03 3 1  ON 37
ci_039                 4.622586e-03 3 1  ON 38
ci_040                 4.935343e-03 3 1  ON 39
ci_041                 2.970918e-03 3 1  ON 40
ci_042                 2.733715e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188804e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720991e-03 3 1  ON 45
ci_047                -1.002270e-03 3 1  ON 46
ci_048                -8.335584e-04 3 1  ON 47
ci_049                 7.787063e-04 3 1  ON 48
ci_050                 9.956890e-04 3 1  ON 49
ci_051                -3.143843e-04 3 1  ON 50
ci_052                -1.210996e-03 3 1  ON 51
ci_053                -2.434128e-03 3 1  ON 52
ci_054                -2.689548e-03 3 1  ON 53
ci_055                -1.798613e-03 3 1  ON 54
ci_056                -1.928955e-03 3 1  ON 55
ci_057                -1.307232e-03 3 1  ON 56
ci_058                -9.883998e-04 3 1  ON 57
ci_059                -5.511644e-04 3 1  ON 58
ci_060                -7.599807e-04 3 1  ON 59
ci_061                -5.118379e-05 3 1  ON 60
ci_062                -9.210075e-04 3 1  ON 61
ci_063                -8.860142e-04 3 1  ON 62
ci_064                -5.241189e-04 3 1  ON 63
ci_065                -1.359807e-03 3 1  ON 64
ci_066                -1.883849e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.557109e-03 3 1  ON 67
ci_069                -5.541287e-04 3 1  ON 68
ci_070                -4.262688e-04 3 1  ON 69
ci_071                -2.088328e-03 3 1  ON 70
ci_072                -2.001052e-03 3 1  ON 71
ci_073                 1.611464e-04 3 1  ON 72
ci_074                 1.976787e-04 3 1  ON 73
ci_075                 1.616130e-04 3 1  ON 74
ci_076                 7.850637e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.678
    reference variance = 0.445908
====================================================
  Execution time = 2.5111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5190e-01
  Total weights = 1.9553e+06
  Execution time = 3.6097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441617171389
                                         uncertainty =       0.002733835686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441617171389
                                         uncertainty =       0.002733835686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469918166
  error estimate for blocks of size 2^( 2) =       0.000494004308
  error estimate for blocks of size 2^( 3) =       0.000515606411
  error estimate for blocks of size 2^( 4) =       0.000531827643
  error estimate for blocks of size 2^( 5) =       0.000541729156
  error estimate for blocks of size 2^( 6) =       0.000548839244
  error estimate for blocks of size 2^( 7) =       0.000550628742

      target function =      -0.743762387730
              le_mean =     -22.662645274521
             les_mean =     514.047387402153
             stat err =       0.000543256196
             autocorr =       1.336487523476
   target nu stat err =       0.000543256196
   target dn stat err =       0.003677615731
      target stat err =       0.003065289879
              std dev =       0.664564642944
             le_variance =       0.441646164652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441617167603
                                         uncertainty =       0.002733833416

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441617167603
                                         uncertainty =       0.002733833416

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469918164
  error estimate for blocks of size 2^( 2) =       0.000494004306
  error estimate for blocks of size 2^( 3) =       0.000515606410
  error estimate for blocks of size 2^( 4) =       0.000531827641
  error estimate for blocks of size 2^( 5) =       0.000541729154
  error estimate for blocks of size 2^( 6) =       0.000548839242
  error estimate for blocks of size 2^( 7) =       0.000550628741

      target function =      -0.743762439119
              le_mean =     -22.662645274647
             les_mean =     514.047387345051
             stat err =       0.000543256195
             autocorr =       1.336487528003
   target nu stat err =       0.000543256195
   target dn stat err =       0.003677611641
      target stat err =       0.003065287015
              std dev =       0.664564640065
             le_variance =       0.441646160825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441617169496
                                         uncertainty =       0.002733834551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441617169496
                                         uncertainty =       0.002733834551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469918165
  error estimate for blocks of size 2^( 2) =       0.000494004307
  error estimate for blocks of size 2^( 3) =       0.000515606410
  error estimate for blocks of size 2^( 4) =       0.000531827642
  error estimate for blocks of size 2^( 5) =       0.000541729155
  error estimate for blocks of size 2^( 6) =       0.000548839243
  error estimate for blocks of size 2^( 7) =       0.000550628741

      target function =      -0.743762413504
              le_mean =     -22.662645274584
             les_mean =     514.047387373505
             stat err =       0.000543256195
             autocorr =       1.336487525751
   target nu stat err =       0.000543256195
   target dn stat err =       0.003677613685
      target stat err =       0.003065288447
              std dev =       0.664564641505
             le_variance =       0.441646162738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441617171153
                                         uncertainty =       0.002733835544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441617171153
                                         uncertainty =       0.002733835544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469918165
  error estimate for blocks of size 2^( 2) =       0.000494004308
  error estimate for blocks of size 2^( 3) =       0.000515606411
  error estimate for blocks of size 2^( 4) =       0.000531827643
  error estimate for blocks of size 2^( 5) =       0.000541729156
  error estimate for blocks of size 2^( 6) =       0.000548839244
  error estimate for blocks of size 2^( 7) =       0.000550628742

      target function =      -0.743762390961
              le_mean =     -22.662645274529
             les_mean =     514.047387398561
             stat err =       0.000543256196
             autocorr =       1.336487523762
   target nu stat err =       0.000543256196
   target dn stat err =       0.003677615475
      target stat err =       0.003065289700
              std dev =       0.664564642764
             le_variance =       0.441646164412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743762387730        initial
     9.5367e+03     9.5367e+04             3.0265e-08        -0.743762439119  <--
     3.8147e+04     3.8147e+05             7.5662e-09        -0.743762413504
     1.5259e+05     1.5259e+06             1.8916e-09        -0.743762390961

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 4.3239e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_001                -7.055859e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013053e-02 3 1  ON 2
ci_004                -5.100235e-02 3 1  ON 3
ci_005                 1.949613e-02 3 1  ON 4
ci_006                 1.981762e-02 3 1  ON 5
ci_007                 1.474641e-02 3 1  ON 6
ci_008                 1.554133e-02 3 1  ON 7
ci_009                -1.320260e-02 3 1  ON 8
ci_010                -1.208049e-02 3 1  ON 9
ci_011                -9.911076e-03 3 1  ON 10
ci_012                -9.099646e-03 3 1  ON 11
ci_013                 8.349999e-03 3 1  ON 12
ci_014                 9.370393e-03 3 1  ON 13
ci_015                 9.520653e-03 3 1  ON 14
ci_016                 9.413484e-03 3 1  ON 15
ci_017                 8.493785e-03 3 1  ON 16
ci_018                 8.286895e-03 3 1  ON 17
ci_019                -1.221635e-03 3 1  ON 18
ci_020                -1.534411e-03 3 1  ON 19
ci_021                -1.177667e-02 3 1  ON 20
ci_022                -1.179800e-02 3 1  ON 21
ci_023                 4.854171e-03 3 1  ON 22
ci_024                 4.919592e-03 3 1  ON 23
ci_025                 1.143512e-02 3 1  ON 24
ci_026                 1.147160e-02 3 1  ON 25
ci_027                 6.467254e-03 3 1  ON 26
ci_028                 6.188155e-03 3 1  ON 27
ci_029                -5.082817e-03 3 1  ON 28
ci_030                -4.170441e-03 3 1  ON 29
ci_031                 3.328063e-03 3 1  ON 30
ci_032                 4.542562e-03 3 1  ON 31
ci_033                 2.363005e-03 3 1  ON 32
ci_034                 4.136277e-03 3 1  ON 33
ci_035                 1.723324e-03 3 1  ON 34
ci_036                 2.153794e-03 3 1  ON 35
ci_037                 3.539148e-03 3 1  ON 36
ci_038                 3.699877e-03 3 1  ON 37
ci_039                 4.622587e-03 3 1  ON 38
ci_040                 4.935338e-03 3 1  ON 39
ci_041                 2.970915e-03 3 1  ON 40
ci_042                 2.733716e-03 3 1  ON 41
ci_043                 2.944828e-03 3 1  ON 42
ci_044                 3.188805e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720994e-03 3 1  ON 45
ci_047                -1.002270e-03 3 1  ON 46
ci_048                -8.335600e-04 3 1  ON 47
ci_049                 7.787052e-04 3 1  ON 48
ci_050                 9.956850e-04 3 1  ON 49
ci_051                -3.143950e-04 3 1  ON 50
ci_052                -1.210992e-03 3 1  ON 51
ci_053                -2.434125e-03 3 1  ON 52
ci_054                -2.689547e-03 3 1  ON 53
ci_055                -1.798613e-03 3 1  ON 54
ci_056                -1.928957e-03 3 1  ON 55
ci_057                -1.307231e-03 3 1  ON 56
ci_058                -9.883981e-04 3 1  ON 57
ci_059                -5.511628e-04 3 1  ON 58
ci_060                -7.599920e-04 3 1  ON 59
ci_061                -5.118662e-05 3 1  ON 60
ci_062                -9.210025e-04 3 1  ON 61
ci_063                -8.860134e-04 3 1  ON 62
ci_064                -5.241267e-04 3 1  ON 63
ci_065                -1.359809e-03 3 1  ON 64
ci_066                -1.883845e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.557108e-03 3 1  ON 67
ci_069                -5.541236e-04 3 1  ON 68
ci_070                -4.262662e-04 3 1  ON 69
ci_071                -2.088321e-03 3 1  ON 70
ci_072                -2.001050e-03 3 1  ON 71
ci_073                 1.611469e-04 3 1  ON 72
ci_074                 1.976831e-04 3 1  ON 73
ci_075                 1.616164e-04 3 1  ON 74
ci_076                 7.850617e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3692e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7746
    reference variance = 0.321376
====================================================
  Execution time = 2.5650e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5325e-01
  Total weights = 1.955028065e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7861e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443785713996
                                         uncertainty =       0.004342451026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443785713996
                                         uncertainty =       0.004342451026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471194585
  error estimate for blocks of size 2^( 2) =       0.000495339969
  error estimate for blocks of size 2^( 3) =       0.000517448361
  error estimate for blocks of size 2^( 4) =       0.000532862635
  error estimate for blocks of size 2^( 5) =       0.000541695659
  error estimate for blocks of size 2^( 6) =       0.000546208105
  error estimate for blocks of size 2^( 7) =       0.000549537446

      target function =      -0.742646478424
              le_mean =     -22.662024860047
             les_mean =     514.020620162365
             stat err =       0.000542575961
             autocorr =       1.325929749459
   target nu stat err =       0.000542575961
   target dn stat err =       0.004732737750
      target stat err =       0.003899715863
              std dev =       0.666369773068
             le_variance =       0.444048674459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266202486005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742666089790       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742666101198       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742666102671       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742666102954       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742666103076       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742666103083       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742666103191       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742666103200       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742666103196       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742666103206       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742666103211       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742666103212       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+03 is 1.070720e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742666089790       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742666092642       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742666093010       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742666093081       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742666093112       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742666093114       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742666093142       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742666093143       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742666093128       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742666093144       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742666093145       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742666093146       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 2.676802e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742666089790       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742666090503       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742666090595       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742666090613       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742666090621       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742666090621       residual = 8.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742666090678       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742666090628       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742666090628       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742666090629       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742666090629       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742666090563       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 6.692006e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117084 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0447e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_001                -7.055859e-01 3 1  ON 0
ci_002                -7.029016e-01 3 1  ON 1
ci_003                -5.013053e-02 3 1  ON 2
ci_004                -5.100234e-02 3 1  ON 3
ci_005                 1.949611e-02 3 1  ON 4
ci_006                 1.981761e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554133e-02 3 1  ON 7
ci_009                -1.320259e-02 3 1  ON 8
ci_010                -1.208048e-02 3 1  ON 9
ci_011                -9.911071e-03 3 1  ON 10
ci_012                -9.099644e-03 3 1  ON 11
ci_013                 8.349993e-03 3 1  ON 12
ci_014                 9.370387e-03 3 1  ON 13
ci_015                 9.520645e-03 3 1  ON 14
ci_016                 9.413472e-03 3 1  ON 15
ci_017                 8.493779e-03 3 1  ON 16
ci_018                 8.286894e-03 3 1  ON 17
ci_019                -1.221633e-03 3 1  ON 18
ci_020                -1.534423e-03 3 1  ON 19
ci_021                -1.177669e-02 3 1  ON 20
ci_022                -1.179802e-02 3 1  ON 21
ci_023                 4.854172e-03 3 1  ON 22
ci_024                 4.919590e-03 3 1  ON 23
ci_025                 1.143511e-02 3 1  ON 24
ci_026                 1.147161e-02 3 1  ON 25
ci_027                 6.467261e-03 3 1  ON 26
ci_028                 6.188153e-03 3 1  ON 27
ci_029                -5.082826e-03 3 1  ON 28
ci_030                -4.170442e-03 3 1  ON 29
ci_031                 3.328081e-03 3 1  ON 30
ci_032                 4.542572e-03 3 1  ON 31
ci_033                 2.363002e-03 3 1  ON 32
ci_034                 4.136268e-03 3 1  ON 33
ci_035                 1.723327e-03 3 1  ON 34
ci_036                 2.153789e-03 3 1  ON 35
ci_037                 3.539142e-03 3 1  ON 36
ci_038                 3.699875e-03 3 1  ON 37
ci_039                 4.622579e-03 3 1  ON 38
ci_040                 4.935329e-03 3 1  ON 39
ci_041                 2.970913e-03 3 1  ON 40
ci_042                 2.733724e-03 3 1  ON 41
ci_043                 2.944828e-03 3 1  ON 42
ci_044                 3.188801e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720992e-03 3 1  ON 45
ci_047                -1.002264e-03 3 1  ON 46
ci_048                -8.335600e-04 3 1  ON 47
ci_049                 7.787052e-04 3 1  ON 48
ci_050                 9.956819e-04 3 1  ON 49
ci_051                -3.144043e-04 3 1  ON 50
ci_052                -1.210993e-03 3 1  ON 51
ci_053                -2.434131e-03 3 1  ON 52
ci_054                -2.689535e-03 3 1  ON 53
ci_055                -1.798614e-03 3 1  ON 54
ci_056                -1.928954e-03 3 1  ON 55
ci_057                -1.307232e-03 3 1  ON 56
ci_058                -9.883988e-04 3 1  ON 57
ci_059                -5.511573e-04 3 1  ON 58
ci_060                -7.599883e-04 3 1  ON 59
ci_061                -5.118389e-05 3 1  ON 60
ci_062                -9.209992e-04 3 1  ON 61
ci_063                -8.860076e-04 3 1  ON 62
ci_064                -5.241201e-04 3 1  ON 63
ci_065                -1.359819e-03 3 1  ON 64
ci_066                -1.883850e-03 3 1  ON 65
ci_067                -1.812740e-03 3 1  ON 66
ci_068                -1.557110e-03 3 1  ON 67
ci_069                -5.541200e-04 3 1  ON 68
ci_070                -4.262567e-04 3 1  ON 69
ci_071                -2.088324e-03 3 1  ON 70
ci_072                -2.001049e-03 3 1  ON 71
ci_073                 1.611485e-04 3 1  ON 72
ci_074                 1.976859e-04 3 1  ON 73
ci_075                 1.615980e-04 3 1  ON 74
ci_076                 7.850646e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.6786
    reference variance = 0.446151
====================================================
  Execution time = 2.5121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4760e-01
  Total weights = 1.9553e+06
  Execution time = 3.6171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440034787804
                                         uncertainty =       0.002094435099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440034787804
                                         uncertainty =       0.002094435099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469029548
  error estimate for blocks of size 2^( 2) =       0.000492937664
  error estimate for blocks of size 2^( 3) =       0.000514448336
  error estimate for blocks of size 2^( 4) =       0.000530532737
  error estimate for blocks of size 2^( 5) =       0.000540674363
  error estimate for blocks of size 2^( 6) =       0.000544089911
  error estimate for blocks of size 2^( 7) =       0.000547462381

      target function =      -0.747297592156
              le_mean =     -22.662248073933
             les_mean =     514.025083013443
             stat err =       0.000540689848
             autocorr =       1.328911389521
   target nu stat err =       0.000540689848
   target dn stat err =       0.002389430866
      target stat err =       0.002059244742
              std dev =       0.663307947967
             le_variance =       0.439977433836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440034775255
                                         uncertainty =       0.002094435488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440034775255
                                         uncertainty =       0.002094435488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469029541
  error estimate for blocks of size 2^( 2) =       0.000492937659
  error estimate for blocks of size 2^( 3) =       0.000514448334
  error estimate for blocks of size 2^( 4) =       0.000530532737
  error estimate for blocks of size 2^( 5) =       0.000540674362
  error estimate for blocks of size 2^( 6) =       0.000544089912
  error estimate for blocks of size 2^( 7) =       0.000547462382

      target function =      -0.747297628968
              le_mean =     -22.662248073671
             les_mean =     514.025082956940
             stat err =       0.000540689848
             autocorr =       1.328911429876
   target nu stat err =       0.000540689848
   target dn stat err =       0.002389428373
      target stat err =       0.002059242967
              std dev =       0.663307938525
             le_variance =       0.439977421310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440034781529
                                         uncertainty =       0.002094435294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440034781529
                                         uncertainty =       0.002094435294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469029545
  error estimate for blocks of size 2^( 2) =       0.000492937662
  error estimate for blocks of size 2^( 3) =       0.000514448335
  error estimate for blocks of size 2^( 4) =       0.000530532737
  error estimate for blocks of size 2^( 5) =       0.000540674362
  error estimate for blocks of size 2^( 6) =       0.000544089911
  error estimate for blocks of size 2^( 7) =       0.000547462381

      target function =      -0.747297610651
              le_mean =     -22.662248073802
             les_mean =     514.025082985083
             stat err =       0.000540689848
             autocorr =       1.328911409697
   target nu stat err =       0.000540689848
   target dn stat err =       0.002389429618
      target stat err =       0.002059243853
              std dev =       0.663307943246
             le_variance =       0.439977427573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440034787019
                                         uncertainty =       0.002094435124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440034787019
                                         uncertainty =       0.002094435124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469029548
  error estimate for blocks of size 2^( 2) =       0.000492937664
  error estimate for blocks of size 2^( 3) =       0.000514448336
  error estimate for blocks of size 2^( 4) =       0.000530532737
  error estimate for blocks of size 2^( 5) =       0.000540674363
  error estimate for blocks of size 2^( 6) =       0.000544089911
  error estimate for blocks of size 2^( 7) =       0.000547462381

      target function =      -0.747297594477
              le_mean =     -22.662248073917
             les_mean =     514.025083009886
             stat err =       0.000540689848
             autocorr =       1.328911392038
   target nu stat err =       0.000540689848
   target dn stat err =       0.002389430710
      target stat err =       0.002059244630
              std dev =       0.663307947377
             le_variance =       0.439977433054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747297592156        initial
     2.3842e+03     2.3842e+04             1.0707e-07        -0.747297628968  <--
     9.5367e+03     9.5367e+04             2.6768e-08        -0.747297610651
     3.8147e+04     3.8147e+05             6.6920e-09        -0.747297594477

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 4.3274e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_001                -7.055858e-01 3 1  ON 0
ci_002                -7.029016e-01 3 1  ON 1
ci_003                -5.013054e-02 3 1  ON 2
ci_004                -5.100230e-02 3 1  ON 3
ci_005                 1.949607e-02 3 1  ON 4
ci_006                 1.981758e-02 3 1  ON 5
ci_007                 1.474645e-02 3 1  ON 6
ci_008                 1.554134e-02 3 1  ON 7
ci_009                -1.320254e-02 3 1  ON 8
ci_010                -1.208045e-02 3 1  ON 9
ci_011                -9.911058e-03 3 1  ON 10
ci_012                -9.099640e-03 3 1  ON 11
ci_013                 8.349975e-03 3 1  ON 12
ci_014                 9.370370e-03 3 1  ON 13
ci_015                 9.520622e-03 3 1  ON 14
ci_016                 9.413436e-03 3 1  ON 15
ci_017                 8.493762e-03 3 1  ON 16
ci_018                 8.286890e-03 3 1  ON 17
ci_019                -1.221625e-03 3 1  ON 18
ci_020                -1.534459e-03 3 1  ON 19
ci_021                -1.177675e-02 3 1  ON 20
ci_022                -1.179806e-02 3 1  ON 21
ci_023                 4.854173e-03 3 1  ON 22
ci_024                 4.919582e-03 3 1  ON 23
ci_025                 1.143508e-02 3 1  ON 24
ci_026                 1.147166e-02 3 1  ON 25
ci_027                 6.467282e-03 3 1  ON 26
ci_028                 6.188148e-03 3 1  ON 27
ci_029                -5.082854e-03 3 1  ON 28
ci_030                -4.170442e-03 3 1  ON 29
ci_031                 3.328135e-03 3 1  ON 30
ci_032                 4.542601e-03 3 1  ON 31
ci_033                 2.362990e-03 3 1  ON 32
ci_034                 4.136242e-03 3 1  ON 33
ci_035                 1.723337e-03 3 1  ON 34
ci_036                 2.153774e-03 3 1  ON 35
ci_037                 3.539124e-03 3 1  ON 36
ci_038                 3.699869e-03 3 1  ON 37
ci_039                 4.622553e-03 3 1  ON 38
ci_040                 4.935301e-03 3 1  ON 39
ci_041                 2.970906e-03 3 1  ON 40
ci_042                 2.733749e-03 3 1  ON 41
ci_043                 2.944826e-03 3 1  ON 42
ci_044                 3.188789e-03 3 1  ON 43
ci_045                 2.451497e-03 3 1  ON 44
ci_046                 2.720987e-03 3 1  ON 45
ci_047                -1.002247e-03 3 1  ON 46
ci_048                -8.335602e-04 3 1  ON 47
ci_049                 7.787054e-04 3 1  ON 48
ci_050                 9.956724e-04 3 1  ON 49
ci_051                -3.144320e-04 3 1  ON 50
ci_052                -1.210996e-03 3 1  ON 51
ci_053                -2.434151e-03 3 1  ON 52
ci_054                -2.689499e-03 3 1  ON 53
ci_055                -1.798617e-03 3 1  ON 54
ci_056                -1.928942e-03 3 1  ON 55
ci_057                -1.307236e-03 3 1  ON 56
ci_058                -9.884008e-04 3 1  ON 57
ci_059                -5.511410e-04 3 1  ON 58
ci_060                -7.599773e-04 3 1  ON 59
ci_061                -5.117571e-05 3 1  ON 60
ci_062                -9.209893e-04 3 1  ON 61
ci_063                -8.859904e-04 3 1  ON 62
ci_064                -5.241002e-04 3 1  ON 63
ci_065                -1.359852e-03 3 1  ON 64
ci_066                -1.883863e-03 3 1  ON 65
ci_067                -1.812728e-03 3 1  ON 66
ci_068                -1.557114e-03 3 1  ON 67
ci_069                -5.541091e-04 3 1  ON 68
ci_070                -4.262283e-04 3 1  ON 69
ci_071                -2.088334e-03 3 1  ON 70
ci_072                -2.001045e-03 3 1  ON 71
ci_073                 1.611532e-04 3 1  ON 72
ci_074                 1.976945e-04 3 1  ON 73
ci_075                 1.615429e-04 3 1  ON 74
ci_076                 7.850731e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6444
    reference variance = 0.325127
====================================================
  Execution time = 2.7724e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5633e-01
  Total weights = 1.955185476e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444770489916
                                         uncertainty =       0.002996342561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444770489916
                                         uncertainty =       0.002996342561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471544630
  error estimate for blocks of size 2^( 2) =       0.000495604578
  error estimate for blocks of size 2^( 3) =       0.000517837224
  error estimate for blocks of size 2^( 4) =       0.000533959155
  error estimate for blocks of size 2^( 5) =       0.000544384545
  error estimate for blocks of size 2^( 6) =       0.000547808649
  error estimate for blocks of size 2^( 7) =       0.000551863198

      target function =      -0.740152106857
              le_mean =     -22.663067473296
             les_mean =     514.070961449191
             stat err =       0.000544503886
             autocorr =       1.333387443188
   target nu stat err =       0.000544503886
   target dn stat err =       0.003796478297
      target stat err =       0.003132812052
              std dev =       0.666864811027
             le_variance =       0.444708676185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266306747330e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740164535975       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740164585412       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740164597375       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740164598948       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740164599497       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740164599549       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740164599488       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740164599510       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740164599548       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740164599577       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740164599583       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740164599572       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+02 is 3.166037e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740164535975       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740164548335       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740164551326       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740164551719       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740164551857       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740164551868       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740164551853       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740164551862       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740164551864       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740164551875       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740164551876       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740164551882       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+03 is 7.915456e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740164535975       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740164539065       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740164539813       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740164539911       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740164539939       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740164539951       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740164539948       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740164539946       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740164539951       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740164539955       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740164539949       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740164539919       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 1.978887e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2441e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_001                -7.055859e-01 3 1  ON 0
ci_002                -7.029016e-01 3 1  ON 1
ci_003                -5.013061e-02 3 1  ON 2
ci_004                -5.100232e-02 3 1  ON 3
ci_005                 1.949604e-02 3 1  ON 4
ci_006                 1.981752e-02 3 1  ON 5
ci_007                 1.474642e-02 3 1  ON 6
ci_008                 1.554128e-02 3 1  ON 7
ci_009                -1.320248e-02 3 1  ON 8
ci_010                -1.208043e-02 3 1  ON 9
ci_011                -9.911019e-03 3 1  ON 10
ci_012                -9.099599e-03 3 1  ON 11
ci_013                 8.349944e-03 3 1  ON 12
ci_014                 9.370304e-03 3 1  ON 13
ci_015                 9.520543e-03 3 1  ON 14
ci_016                 9.413385e-03 3 1  ON 15
ci_017                 8.493797e-03 3 1  ON 16
ci_018                 8.286932e-03 3 1  ON 17
ci_019                -1.221646e-03 3 1  ON 18
ci_020                -1.534528e-03 3 1  ON 19
ci_021                -1.177673e-02 3 1  ON 20
ci_022                -1.179807e-02 3 1  ON 21
ci_023                 4.854156e-03 3 1  ON 22
ci_024                 4.919558e-03 3 1  ON 23
ci_025                 1.143510e-02 3 1  ON 24
ci_026                 1.147172e-02 3 1  ON 25
ci_027                 6.467257e-03 3 1  ON 26
ci_028                 6.188146e-03 3 1  ON 27
ci_029                -5.082824e-03 3 1  ON 28
ci_030                -4.170423e-03 3 1  ON 29
ci_031                 3.328201e-03 3 1  ON 30
ci_032                 4.542623e-03 3 1  ON 31
ci_033                 2.362997e-03 3 1  ON 32
ci_034                 4.136205e-03 3 1  ON 33
ci_035                 1.723363e-03 3 1  ON 34
ci_036                 2.153779e-03 3 1  ON 35
ci_037                 3.539103e-03 3 1  ON 36
ci_038                 3.699909e-03 3 1  ON 37
ci_039                 4.622571e-03 3 1  ON 38
ci_040                 4.935248e-03 3 1  ON 39
ci_041                 2.970940e-03 3 1  ON 40
ci_042                 2.733744e-03 3 1  ON 41
ci_043                 2.944828e-03 3 1  ON 42
ci_044                 3.188793e-03 3 1  ON 43
ci_045                 2.451505e-03 3 1  ON 44
ci_046                 2.721012e-03 3 1  ON 45
ci_047                -1.002295e-03 3 1  ON 46
ci_048                -8.335631e-04 3 1  ON 47
ci_049                 7.786758e-04 3 1  ON 48
ci_050                 9.956905e-04 3 1  ON 49
ci_051                -3.144655e-04 3 1  ON 50
ci_052                -1.210944e-03 3 1  ON 51
ci_053                -2.434117e-03 3 1  ON 52
ci_054                -2.689520e-03 3 1  ON 53
ci_055                -1.798673e-03 3 1  ON 54
ci_056                -1.928941e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.884002e-04 3 1  ON 57
ci_059                -5.511234e-04 3 1  ON 58
ci_060                -7.599698e-04 3 1  ON 59
ci_061                -5.116871e-05 3 1  ON 60
ci_062                -9.209830e-04 3 1  ON 61
ci_063                -8.860178e-04 3 1  ON 62
ci_064                -5.241441e-04 3 1  ON 63
ci_065                -1.359826e-03 3 1  ON 64
ci_066                -1.883852e-03 3 1  ON 65
ci_067                -1.812724e-03 3 1  ON 66
ci_068                -1.557101e-03 3 1  ON 67
ci_069                -5.541054e-04 3 1  ON 68
ci_070                -4.262347e-04 3 1  ON 69
ci_071                -2.088299e-03 3 1  ON 70
ci_072                -2.001073e-03 3 1  ON 71
ci_073                 1.611524e-04 3 1  ON 72
ci_074                 1.977114e-04 3 1  ON 73
ci_075                 1.615683e-04 3 1  ON 74
ci_076                 7.851004e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.5854
    reference variance = 0.337949
====================================================
  Execution time = 2.5129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5368e-01
  Total weights = 1.9555e+06
  Execution time = 3.6243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441021774540
                                         uncertainty =       0.002621936998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441021774540
                                         uncertainty =       0.002621936998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469590037
  error estimate for blocks of size 2^( 2) =       0.000493522035
  error estimate for blocks of size 2^( 3) =       0.000516013783
  error estimate for blocks of size 2^( 4) =       0.000531569492
  error estimate for blocks of size 2^( 5) =       0.000540177617
  error estimate for blocks of size 2^( 6) =       0.000545286022
  error estimate for blocks of size 2^( 7) =       0.000549494000

      target function =      -0.742300331861
              le_mean =     -22.662662245387
             les_mean =     514.049942184937
             stat err =       0.000541631783
             autocorr =       1.330364151594
   target nu stat err =       0.000541631783
   target dn stat err =       0.004403869751
      target stat err =       0.003635166371
              std dev =       0.664100598636
             le_variance =       0.441029605109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441021688960
                                         uncertainty =       0.002621934620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441021688960
                                         uncertainty =       0.002621934620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469589991
  error estimate for blocks of size 2^( 2) =       0.000493522002
  error estimate for blocks of size 2^( 3) =       0.000516013756
  error estimate for blocks of size 2^( 4) =       0.000531569471
  error estimate for blocks of size 2^( 5) =       0.000540177606
  error estimate for blocks of size 2^( 6) =       0.000545286007
  error estimate for blocks of size 2^( 7) =       0.000549493972

      target function =      -0.742300444342
              le_mean =     -22.662662244957
             les_mean =     514.049942027298
             stat err =       0.000541631764
             autocorr =       1.330364317622
   target nu stat err =       0.000541631764
   target dn stat err =       0.004403871706
      target stat err =       0.003635169023
              std dev =       0.664100534154
             le_variance =       0.441029519463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441021731743
                                         uncertainty =       0.002621935809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441021731743
                                         uncertainty =       0.002621935809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469590014
  error estimate for blocks of size 2^( 2) =       0.000493522019
  error estimate for blocks of size 2^( 3) =       0.000516013769
  error estimate for blocks of size 2^( 4) =       0.000531569482
  error estimate for blocks of size 2^( 5) =       0.000540177612
  error estimate for blocks of size 2^( 6) =       0.000545286015
  error estimate for blocks of size 2^( 7) =       0.000549493986

      target function =      -0.742300388164
              le_mean =     -22.662662245172
             les_mean =     514.049942106019
             stat err =       0.000541631773
             autocorr =       1.330364234612
   target nu stat err =       0.000541631773
   target dn stat err =       0.004403870725
      target stat err =       0.003635167695
              std dev =       0.664100566389
             le_variance =       0.441029562279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441021769190
                                         uncertainty =       0.002621936849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441021769190
                                         uncertainty =       0.002621936849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469590034
  error estimate for blocks of size 2^( 2) =       0.000493522033
  error estimate for blocks of size 2^( 3) =       0.000516013781
  error estimate for blocks of size 2^( 4) =       0.000531569491
  error estimate for blocks of size 2^( 5) =       0.000540177616
  error estimate for blocks of size 2^( 6) =       0.000545286021
  error estimate for blocks of size 2^( 7) =       0.000549493998

      target function =      -0.742300338905
              le_mean =     -22.662662245360
             les_mean =     514.049942175062
             stat err =       0.000541631782
             autocorr =       1.330364161973
   target nu stat err =       0.000541631782
   target dn stat err =       0.004403869873
      target stat err =       0.003635166537
              std dev =       0.664100594605
             le_variance =       0.441029599754


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742300331861        initial
     5.9605e+02     5.9605e+03             3.1660e-07        -0.742300444342  <--
     2.3842e+03     2.3842e+04             7.9155e-08        -0.742300388164
     9.5367e+03     9.5367e+04             1.9789e-08        -0.742300338905

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 4.6228e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013084e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981737e-02 3 1  ON 5
ci_007                 1.474633e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320231e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910904e-03 3 1  ON 10
ci_012                -9.099475e-03 3 1  ON 11
ci_013                 8.349851e-03 3 1  ON 12
ci_014                 9.370108e-03 3 1  ON 13
ci_015                 9.520305e-03 3 1  ON 14
ci_016                 9.413234e-03 3 1  ON 15
ci_017                 8.493903e-03 3 1  ON 16
ci_018                 8.287059e-03 3 1  ON 17
ci_019                -1.221709e-03 3 1  ON 18
ci_020                -1.534734e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179809e-02 3 1  ON 21
ci_023                 4.854108e-03 3 1  ON 22
ci_024                 4.919486e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147187e-02 3 1  ON 25
ci_027                 6.467184e-03 3 1  ON 26
ci_028                 6.188138e-03 3 1  ON 27
ci_029                -5.082734e-03 3 1  ON 28
ci_030                -4.170365e-03 3 1  ON 29
ci_031                 3.328398e-03 3 1  ON 30
ci_032                 4.542686e-03 3 1  ON 31
ci_033                 2.363016e-03 3 1  ON 32
ci_034                 4.136092e-03 3 1  ON 33
ci_035                 1.723442e-03 3 1  ON 34
ci_036                 2.153797e-03 3 1  ON 35
ci_037                 3.539040e-03 3 1  ON 36
ci_038                 3.700030e-03 3 1  ON 37
ci_039                 4.622624e-03 3 1  ON 38
ci_040                 4.935090e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733730e-03 3 1  ON 41
ci_043                 2.944835e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451527e-03 3 1  ON 44
ci_046                 2.721085e-03 3 1  ON 45
ci_047                -1.002439e-03 3 1  ON 46
ci_048                -8.335719e-04 3 1  ON 47
ci_049                 7.785870e-04 3 1  ON 48
ci_050                 9.957449e-04 3 1  ON 49
ci_051                -3.145662e-04 3 1  ON 50
ci_052                -1.210788e-03 3 1  ON 51
ci_053                -2.434015e-03 3 1  ON 52
ci_054                -2.689581e-03 3 1  ON 53
ci_055                -1.798843e-03 3 1  ON 54
ci_056                -1.928938e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.883985e-04 3 1  ON 57
ci_059                -5.510706e-04 3 1  ON 58
ci_060                -7.599475e-04 3 1  ON 59
ci_061                -5.114773e-05 3 1  ON 60
ci_062                -9.209640e-04 3 1  ON 61
ci_063                -8.860997e-04 3 1  ON 62
ci_064                -5.242760e-04 3 1  ON 63
ci_065                -1.359749e-03 3 1  ON 64
ci_066                -1.883816e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.557063e-03 3 1  ON 67
ci_069                -5.540941e-04 3 1  ON 68
ci_070                -4.262540e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001157e-03 3 1  ON 71
ci_073                 1.611499e-04 3 1  ON 72
ci_074                 1.977620e-04 3 1  ON 73
ci_075                 1.616442e-04 3 1  ON 74
ci_076                 7.851821e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8676e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7106
    reference variance = 0.335503
====================================================
  Execution time = 2.5704e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4900e-01
  Total weights = 1.955194996e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438671377796
                                         uncertainty =       0.001884832147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438671377796
                                         uncertainty =       0.001884832147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468301676
  error estimate for blocks of size 2^( 2) =       0.000492227114
  error estimate for blocks of size 2^( 3) =       0.000514447718
  error estimate for blocks of size 2^( 4) =       0.000530707641
  error estimate for blocks of size 2^( 5) =       0.000539896287
  error estimate for blocks of size 2^( 6) =       0.000544869417
  error estimate for blocks of size 2^( 7) =       0.000546495132

      target function =      -0.746124690442
              le_mean =     -22.661015526219
             les_mean =     513.970625159884
             stat err =       0.000540492119
             autocorr =       1.332070796896
   target nu stat err =       0.000540492119
   target dn stat err =       0.002582733873
      target stat err =       0.002201574410
              std dev =       0.662278582036
             le_variance =       0.438612920224


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266101552622e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746129742672       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746129880527       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746129907762       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746129909070       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746129909830       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746129909972       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746129910082       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746129910039       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746129909964       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746129909962       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+02 is 1.266577e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746129742672       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746129777144       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746129783954       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746129784281       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746129784471       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746129784507       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746129784534       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746129784524       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746129784504       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746129784503       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+02 is 3.167046e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746129742672       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746129751291       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746129752993       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746129753075       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746129753122       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746129753131       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746129753140       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746129753137       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746129753129       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746129753131       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+03 is 7.917992e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125472 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0420e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_001                -7.055861e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013084e-02 3 1  ON 2
ci_004                -5.100235e-02 3 1  ON 3
ci_005                 1.949569e-02 3 1  ON 4
ci_006                 1.981724e-02 3 1  ON 5
ci_007                 1.474627e-02 3 1  ON 6
ci_008                 1.554091e-02 3 1  ON 7
ci_009                -1.320222e-02 3 1  ON 8
ci_010                -1.208026e-02 3 1  ON 9
ci_011                -9.910882e-03 3 1  ON 10
ci_012                -9.099440e-03 3 1  ON 11
ci_013                 8.349736e-03 3 1  ON 12
ci_014                 9.369845e-03 3 1  ON 13
ci_015                 9.520106e-03 3 1  ON 14
ci_016                 9.413034e-03 3 1  ON 15
ci_017                 8.493765e-03 3 1  ON 16
ci_018                 8.287051e-03 3 1  ON 17
ci_019                -1.222026e-03 3 1  ON 18
ci_020                -1.534921e-03 3 1  ON 19
ci_021                -1.177676e-02 3 1  ON 20
ci_022                -1.179831e-02 3 1  ON 21
ci_023                 4.854082e-03 3 1  ON 22
ci_024                 4.919497e-03 3 1  ON 23
ci_025                 1.143523e-02 3 1  ON 24
ci_026                 1.147201e-02 3 1  ON 25
ci_027                 6.467117e-03 3 1  ON 26
ci_028                 6.188098e-03 3 1  ON 27
ci_029                -5.082546e-03 3 1  ON 28
ci_030                -4.170372e-03 3 1  ON 29
ci_031                 3.328646e-03 3 1  ON 30
ci_032                 4.542928e-03 3 1  ON 31
ci_033                 2.363063e-03 3 1  ON 32
ci_034                 4.135817e-03 3 1  ON 33
ci_035                 1.723460e-03 3 1  ON 34
ci_036                 2.153699e-03 3 1  ON 35
ci_037                 3.538921e-03 3 1  ON 36
ci_038                 3.699904e-03 3 1  ON 37
ci_039                 4.622702e-03 3 1  ON 38
ci_040                 4.934963e-03 3 1  ON 39
ci_041                 2.971031e-03 3 1  ON 40
ci_042                 2.733744e-03 3 1  ON 41
ci_043                 2.944911e-03 3 1  ON 42
ci_044                 3.188785e-03 3 1  ON 43
ci_045                 2.451662e-03 3 1  ON 44
ci_046                 2.721151e-03 3 1  ON 45
ci_047                -1.002451e-03 3 1  ON 46
ci_048                -8.335516e-04 3 1  ON 47
ci_049                 7.786020e-04 3 1  ON 48
ci_050                 9.956729e-04 3 1  ON 49
ci_051                -3.147062e-04 3 1  ON 50
ci_052                -1.210765e-03 3 1  ON 51
ci_053                -2.434072e-03 3 1  ON 52
ci_054                -2.689633e-03 3 1  ON 53
ci_055                -1.798789e-03 3 1  ON 54
ci_056                -1.928883e-03 3 1  ON 55
ci_057                -1.307227e-03 3 1  ON 56
ci_058                -9.883784e-04 3 1  ON 57
ci_059                -5.510796e-04 3 1  ON 58
ci_060                -7.598825e-04 3 1  ON 59
ci_061                -5.123798e-05 3 1  ON 60
ci_062                -9.208830e-04 3 1  ON 61
ci_063                -8.860824e-04 3 1  ON 62
ci_064                -5.242088e-04 3 1  ON 63
ci_065                -1.359835e-03 3 1  ON 64
ci_066                -1.883754e-03 3 1  ON 65
ci_067                -1.812742e-03 3 1  ON 66
ci_068                -1.556919e-03 3 1  ON 67
ci_069                -5.539595e-04 3 1  ON 68
ci_070                -4.262405e-04 3 1  ON 69
ci_071                -2.088238e-03 3 1  ON 70
ci_072                -2.001182e-03 3 1  ON 71
ci_073                 1.611258e-04 3 1  ON 72
ci_074                 1.978184e-04 3 1  ON 73
ci_075                 1.615893e-04 3 1  ON 74
ci_076                 7.851283e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.6509
    reference variance = 0.355283
====================================================
  Execution time = 2.5041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5656e-01
  Total weights = 1.9552e+06
  Execution time = 3.6255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441618973956
                                         uncertainty =       0.002433345081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441618973956
                                         uncertainty =       0.002433345081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469896978
  error estimate for blocks of size 2^( 2) =       0.000493991703
  error estimate for blocks of size 2^( 3) =       0.000516511300
  error estimate for blocks of size 2^( 4) =       0.000532609305
  error estimate for blocks of size 2^( 5) =       0.000541455792
  error estimate for blocks of size 2^( 6) =       0.000546260768
  error estimate for blocks of size 2^( 7) =       0.000548275609

      target function =      -0.739925080113
              le_mean =     -22.662073854819
             les_mean =     514.026150922619
             stat err =       0.000542150368
             autocorr =       1.331172111163
   target nu stat err =       0.000542150368
   target dn stat err =       0.007951312985
      target stat err =       0.006455726123
              std dev =       0.664534679294
             le_variance =       0.441606339985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441619139483
                                         uncertainty =       0.002433366869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441619139483
                                         uncertainty =       0.002433366869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469897067
  error estimate for blocks of size 2^( 2) =       0.000493991823
  error estimate for blocks of size 2^( 3) =       0.000516511438
  error estimate for blocks of size 2^( 4) =       0.000532609473
  error estimate for blocks of size 2^( 5) =       0.000541455996
  error estimate for blocks of size 2^( 6) =       0.000546260967
  error estimate for blocks of size 2^( 7) =       0.000548275735

      target function =      -0.739923362563
              le_mean =     -22.662073849962
             les_mean =     514.026152827340
             stat err =       0.000542150543
             autocorr =       1.331172466831
   target nu stat err =       0.000542150543
   target dn stat err =       0.007951306842
      target stat err =       0.006455691301
              std dev =       0.664534804388
             le_variance =       0.441606506243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441619056554
                                         uncertainty =       0.002433355947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441619056554
                                         uncertainty =       0.002433355947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469897022
  error estimate for blocks of size 2^( 2) =       0.000493991763
  error estimate for blocks of size 2^( 3) =       0.000516511369
  error estimate for blocks of size 2^( 4) =       0.000532609389
  error estimate for blocks of size 2^( 5) =       0.000541455894
  error estimate for blocks of size 2^( 6) =       0.000546260867
  error estimate for blocks of size 2^( 7) =       0.000548275672

      target function =      -0.739924234855
              le_mean =     -22.662073852386
             les_mean =     514.026151858059
             stat err =       0.000542150456
             autocorr =       1.331172289107
   target nu stat err =       0.000542150456
   target dn stat err =       0.007951309767
      target stat err =       0.006455708829
              std dev =       0.664534741716
             le_variance =       0.441606422948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441618984261
                                         uncertainty =       0.002433346436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441618984261
                                         uncertainty =       0.002433346436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469896984
  error estimate for blocks of size 2^( 2) =       0.000493991711
  error estimate for blocks of size 2^( 3) =       0.000516511308
  error estimate for blocks of size 2^( 4) =       0.000532609316
  error estimate for blocks of size 2^( 5) =       0.000541455805
  error estimate for blocks of size 2^( 6) =       0.000546260780
  error estimate for blocks of size 2^( 7) =       0.000548275617

      target function =      -0.739924976032
              le_mean =     -22.662073854515
             les_mean =     514.026151037579
             stat err =       0.000542150379
             autocorr =       1.331172133421
   target nu stat err =       0.000542150379
   target dn stat err =       0.007951312567
      target stat err =       0.006455723976
              std dev =       0.664534687082
             le_variance =       0.441606350336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739925080113        initial  <--
     1.4901e+02     1.4901e+03             1.2666e-06        -0.739923362563
     5.9605e+02     5.9605e+03             3.1670e-07        -0.739924234855
     2.3842e+03     2.3842e+04             7.9180e-08        -0.739924976032

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1885
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013084e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981737e-02 3 1  ON 5
ci_007                 1.474633e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320231e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910904e-03 3 1  ON 10
ci_012                -9.099475e-03 3 1  ON 11
ci_013                 8.349851e-03 3 1  ON 12
ci_014                 9.370108e-03 3 1  ON 13
ci_015                 9.520305e-03 3 1  ON 14
ci_016                 9.413234e-03 3 1  ON 15
ci_017                 8.493903e-03 3 1  ON 16
ci_018                 8.287059e-03 3 1  ON 17
ci_019                -1.221709e-03 3 1  ON 18
ci_020                -1.534734e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179809e-02 3 1  ON 21
ci_023                 4.854108e-03 3 1  ON 22
ci_024                 4.919486e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147187e-02 3 1  ON 25
ci_027                 6.467184e-03 3 1  ON 26
ci_028                 6.188138e-03 3 1  ON 27
ci_029                -5.082734e-03 3 1  ON 28
ci_030                -4.170365e-03 3 1  ON 29
ci_031                 3.328398e-03 3 1  ON 30
ci_032                 4.542686e-03 3 1  ON 31
ci_033                 2.363016e-03 3 1  ON 32
ci_034                 4.136092e-03 3 1  ON 33
ci_035                 1.723442e-03 3 1  ON 34
ci_036                 2.153797e-03 3 1  ON 35
ci_037                 3.539040e-03 3 1  ON 36
ci_038                 3.700030e-03 3 1  ON 37
ci_039                 4.622624e-03 3 1  ON 38
ci_040                 4.935090e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733730e-03 3 1  ON 41
ci_043                 2.944835e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451527e-03 3 1  ON 44
ci_046                 2.721085e-03 3 1  ON 45
ci_047                -1.002439e-03 3 1  ON 46
ci_048                -8.335719e-04 3 1  ON 47
ci_049                 7.785870e-04 3 1  ON 48
ci_050                 9.957449e-04 3 1  ON 49
ci_051                -3.145662e-04 3 1  ON 50
ci_052                -1.210788e-03 3 1  ON 51
ci_053                -2.434015e-03 3 1  ON 52
ci_054                -2.689581e-03 3 1  ON 53
ci_055                -1.798843e-03 3 1  ON 54
ci_056                -1.928938e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.883985e-04 3 1  ON 57
ci_059                -5.510706e-04 3 1  ON 58
ci_060                -7.599475e-04 3 1  ON 59
ci_061                -5.114773e-05 3 1  ON 60
ci_062                -9.209640e-04 3 1  ON 61
ci_063                -8.860997e-04 3 1  ON 62
ci_064                -5.242760e-04 3 1  ON 63
ci_065                -1.359749e-03 3 1  ON 64
ci_066                -1.883816e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.557063e-03 3 1  ON 67
ci_069                -5.540941e-04 3 1  ON 68
ci_070                -4.262540e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001157e-03 3 1  ON 71
ci_073                 1.611499e-04 3 1  ON 72
ci_074                 1.977620e-04 3 1  ON 73
ci_075                 1.616442e-04 3 1  ON 74
ci_076                 7.851821e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3616e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7163
    reference variance = 0.442149
====================================================
  Execution time = 2.5700e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4897e-01
  Total weights = 1.955192055e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440311018701
                                         uncertainty =       0.001990821198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440311018701
                                         uncertainty =       0.001990821198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469208720
  error estimate for blocks of size 2^( 2) =       0.000493311726
  error estimate for blocks of size 2^( 3) =       0.000515306835
  error estimate for blocks of size 2^( 4) =       0.000530669300
  error estimate for blocks of size 2^( 5) =       0.000540629937
  error estimate for blocks of size 2^( 6) =       0.000546872411
  error estimate for blocks of size 2^( 7) =       0.000546364857

      target function =      -0.746157962055
              le_mean =     -22.662026463804
             les_mean =     514.016418374870
             stat err =       0.000541134126
             autocorr =       1.330079798652
   target nu stat err =       0.000541134126
   target dn stat err =       0.002580295237
      target stat err =       0.002203312465
              std dev =       0.663561335068
             le_variance =       0.440313645398


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266202646380e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746163478621       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746163491196       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746163492643       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746163492804       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746163492863       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746163492849       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746163492882       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746163492887       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746163492884       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746163492882       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+03 is 1.258381e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746163478621       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746163481765       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746163482127       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746163482168       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746163482181       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746163482181       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746163482183       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746163482191       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746163482180       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746163482201       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+03 is 3.146014e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746163478621       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746163479407       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746163479498       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746163479508       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746163479512       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746163479511       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746163479547       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746163479513       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746163479425       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746163479523       residual = 9.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+04 is 7.865074e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0462e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013084e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981736e-02 3 1  ON 5
ci_007                 1.474630e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320229e-02 3 1  ON 8
ci_010                -1.208036e-02 3 1  ON 9
ci_011                -9.910886e-03 3 1  ON 10
ci_012                -9.099474e-03 3 1  ON 11
ci_013                 8.349847e-03 3 1  ON 12
ci_014                 9.370090e-03 3 1  ON 13
ci_015                 9.520298e-03 3 1  ON 14
ci_016                 9.413228e-03 3 1  ON 15
ci_017                 8.493889e-03 3 1  ON 16
ci_018                 8.287060e-03 3 1  ON 17
ci_019                -1.221733e-03 3 1  ON 18
ci_020                -1.534765e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179810e-02 3 1  ON 21
ci_023                 4.854110e-03 3 1  ON 22
ci_024                 4.919480e-03 3 1  ON 23
ci_025                 1.143517e-02 3 1  ON 24
ci_026                 1.147190e-02 3 1  ON 25
ci_027                 6.467173e-03 3 1  ON 26
ci_028                 6.188143e-03 3 1  ON 27
ci_029                -5.082732e-03 3 1  ON 28
ci_030                -4.170360e-03 3 1  ON 29
ci_031                 3.328420e-03 3 1  ON 30
ci_032                 4.542703e-03 3 1  ON 31
ci_033                 2.363023e-03 3 1  ON 32
ci_034                 4.136080e-03 3 1  ON 33
ci_035                 1.723441e-03 3 1  ON 34
ci_036                 2.153797e-03 3 1  ON 35
ci_037                 3.539033e-03 3 1  ON 36
ci_038                 3.700027e-03 3 1  ON 37
ci_039                 4.622628e-03 3 1  ON 38
ci_040                 4.935092e-03 3 1  ON 39
ci_041                 2.971044e-03 3 1  ON 40
ci_042                 2.733736e-03 3 1  ON 41
ci_043                 2.944830e-03 3 1  ON 42
ci_044                 3.188811e-03 3 1  ON 43
ci_045                 2.451527e-03 3 1  ON 44
ci_046                 2.721086e-03 3 1  ON 45
ci_047                -1.002439e-03 3 1  ON 46
ci_048                -8.335717e-04 3 1  ON 47
ci_049                 7.785891e-04 3 1  ON 48
ci_050                 9.957458e-04 3 1  ON 49
ci_051                -3.145737e-04 3 1  ON 50
ci_052                -1.210788e-03 3 1  ON 51
ci_053                -2.434025e-03 3 1  ON 52
ci_054                -2.689573e-03 3 1  ON 53
ci_055                -1.798830e-03 3 1  ON 54
ci_056                -1.928942e-03 3 1  ON 55
ci_057                -1.307213e-03 3 1  ON 56
ci_058                -9.883991e-04 3 1  ON 57
ci_059                -5.510702e-04 3 1  ON 58
ci_060                -7.599442e-04 3 1  ON 59
ci_061                -5.116861e-05 3 1  ON 60
ci_062                -9.209517e-04 3 1  ON 61
ci_063                -8.860974e-04 3 1  ON 62
ci_064                -5.242733e-04 3 1  ON 63
ci_065                -1.359746e-03 3 1  ON 64
ci_066                -1.883821e-03 3 1  ON 65
ci_067                -1.812720e-03 3 1  ON 66
ci_068                -1.557049e-03 3 1  ON 67
ci_069                -5.540791e-04 3 1  ON 68
ci_070                -4.262457e-04 3 1  ON 69
ci_071                -2.088178e-03 3 1  ON 70
ci_072                -2.001154e-03 3 1  ON 71
ci_073                 1.611519e-04 3 1  ON 72
ci_074                 1.977635e-04 3 1  ON 73
ci_075                 1.616442e-04 3 1  ON 74
ci_076                 7.851836e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.6538
    reference variance = 0.412137
====================================================
  Execution time = 2.5304e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5341e-01
  Total weights = 1.9551e+06
  Execution time = 3.6115e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440820251664
                                         uncertainty =       0.001788122609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440820251664
                                         uncertainty =       0.001788122609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469520693
  error estimate for blocks of size 2^( 2) =       0.000493625834
  error estimate for blocks of size 2^( 3) =       0.000515681348
  error estimate for blocks of size 2^( 4) =       0.000532290148
  error estimate for blocks of size 2^( 5) =       0.000539438810
  error estimate for blocks of size 2^( 6) =       0.000544050875
  error estimate for blocks of size 2^( 7) =       0.000545623425

      target function =      -0.742524730070
              le_mean =     -22.661217152267
             les_mean =     513.984169294410
             stat err =       0.000540350814
             autocorr =       1.324470059349
   target nu stat err =       0.000540350814
   target dn stat err =       0.003029589226
      target stat err =       0.002533402662
              std dev =       0.664002532240
             le_variance =       0.440899362821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440820239499
                                         uncertainty =       0.001788123624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440820239499
                                         uncertainty =       0.001788123624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469520687
  error estimate for blocks of size 2^( 2) =       0.000493625829
  error estimate for blocks of size 2^( 3) =       0.000515681345
  error estimate for blocks of size 2^( 4) =       0.000532290145
  error estimate for blocks of size 2^( 5) =       0.000539438811
  error estimate for blocks of size 2^( 6) =       0.000544050877
  error estimate for blocks of size 2^( 7) =       0.000545623428

      target function =      -0.742523131692
              le_mean =     -22.661217152112
             les_mean =     513.984171251182
             stat err =       0.000540350815
             autocorr =       1.324470099912
   target nu stat err =       0.000540350815
   target dn stat err =       0.003029899480
      target stat err =       0.002533637345
              std dev =       0.664002523138
             le_variance =       0.440899350734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440820245581
                                         uncertainty =       0.001788123116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440820245581
                                         uncertainty =       0.001788123116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469520690
  error estimate for blocks of size 2^( 2) =       0.000493625832
  error estimate for blocks of size 2^( 3) =       0.000515681347
  error estimate for blocks of size 2^( 4) =       0.000532290147
  error estimate for blocks of size 2^( 5) =       0.000539438810
  error estimate for blocks of size 2^( 6) =       0.000544050876
  error estimate for blocks of size 2^( 7) =       0.000545623427

      target function =      -0.742523937441
              le_mean =     -22.661217152189
             les_mean =     513.984170264735
             stat err =       0.000540350815
             autocorr =       1.324470079629
   target nu stat err =       0.000540350815
   target dn stat err =       0.003029744035
      target stat err =       0.002533519796
              std dev =       0.664002527689
             le_variance =       0.440899356777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440820250904
                                         uncertainty =       0.001788122673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440820250904
                                         uncertainty =       0.001788122673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469520693
  error estimate for blocks of size 2^( 2) =       0.000493625833
  error estimate for blocks of size 2^( 3) =       0.000515681348
  error estimate for blocks of size 2^( 4) =       0.000532290148
  error estimate for blocks of size 2^( 5) =       0.000539438810
  error estimate for blocks of size 2^( 6) =       0.000544050875
  error estimate for blocks of size 2^( 7) =       0.000545623425

      target function =      -0.742524631649
              le_mean =     -22.661217152257
             les_mean =     513.984169414893
             stat err =       0.000540350814
             autocorr =       1.324470061890
   target nu stat err =       0.000540350814
   target dn stat err =       0.003029608543
      target stat err =       0.002533417281
              std dev =       0.664002531671
             le_variance =       0.440899362066


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742524730070        initial  <--
     1.4901e+03     1.4901e+04             1.2584e-07        -0.742523131692
     5.9605e+03     5.9605e+04             3.1460e-08        -0.742523937441
     2.3842e+04     2.3842e+05             7.8651e-09        -0.742524631649

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.3890
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013084e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981737e-02 3 1  ON 5
ci_007                 1.474633e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320231e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910904e-03 3 1  ON 10
ci_012                -9.099475e-03 3 1  ON 11
ci_013                 8.349851e-03 3 1  ON 12
ci_014                 9.370108e-03 3 1  ON 13
ci_015                 9.520305e-03 3 1  ON 14
ci_016                 9.413234e-03 3 1  ON 15
ci_017                 8.493903e-03 3 1  ON 16
ci_018                 8.287059e-03 3 1  ON 17
ci_019                -1.221709e-03 3 1  ON 18
ci_020                -1.534734e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179809e-02 3 1  ON 21
ci_023                 4.854108e-03 3 1  ON 22
ci_024                 4.919486e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147187e-02 3 1  ON 25
ci_027                 6.467184e-03 3 1  ON 26
ci_028                 6.188138e-03 3 1  ON 27
ci_029                -5.082734e-03 3 1  ON 28
ci_030                -4.170365e-03 3 1  ON 29
ci_031                 3.328398e-03 3 1  ON 30
ci_032                 4.542686e-03 3 1  ON 31
ci_033                 2.363016e-03 3 1  ON 32
ci_034                 4.136092e-03 3 1  ON 33
ci_035                 1.723442e-03 3 1  ON 34
ci_036                 2.153797e-03 3 1  ON 35
ci_037                 3.539040e-03 3 1  ON 36
ci_038                 3.700030e-03 3 1  ON 37
ci_039                 4.622624e-03 3 1  ON 38
ci_040                 4.935090e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733730e-03 3 1  ON 41
ci_043                 2.944835e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451527e-03 3 1  ON 44
ci_046                 2.721085e-03 3 1  ON 45
ci_047                -1.002439e-03 3 1  ON 46
ci_048                -8.335719e-04 3 1  ON 47
ci_049                 7.785870e-04 3 1  ON 48
ci_050                 9.957449e-04 3 1  ON 49
ci_051                -3.145662e-04 3 1  ON 50
ci_052                -1.210788e-03 3 1  ON 51
ci_053                -2.434015e-03 3 1  ON 52
ci_054                -2.689581e-03 3 1  ON 53
ci_055                -1.798843e-03 3 1  ON 54
ci_056                -1.928938e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.883985e-04 3 1  ON 57
ci_059                -5.510706e-04 3 1  ON 58
ci_060                -7.599475e-04 3 1  ON 59
ci_061                -5.114773e-05 3 1  ON 60
ci_062                -9.209640e-04 3 1  ON 61
ci_063                -8.860997e-04 3 1  ON 62
ci_064                -5.242760e-04 3 1  ON 63
ci_065                -1.359749e-03 3 1  ON 64
ci_066                -1.883816e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.557063e-03 3 1  ON 67
ci_069                -5.540941e-04 3 1  ON 68
ci_070                -4.262540e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001157e-03 3 1  ON 71
ci_073                 1.611499e-04 3 1  ON 72
ci_074                 1.977620e-04 3 1  ON 73
ci_075                 1.616442e-04 3 1  ON 74
ci_076                 7.851821e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.637
    reference variance = 0.347129
====================================================
  Execution time = 2.5707e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5313e-01
  Total weights = 1.955407870e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442565568436
                                         uncertainty =       0.003239837995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442565568436
                                         uncertainty =       0.003239837995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470422294
  error estimate for blocks of size 2^( 2) =       0.000494350103
  error estimate for blocks of size 2^( 3) =       0.000516049528
  error estimate for blocks of size 2^( 4) =       0.000532343227
  error estimate for blocks of size 2^( 5) =       0.000540782361
  error estimate for blocks of size 2^( 6) =       0.000544604808
  error estimate for blocks of size 2^( 7) =       0.000545505084

      target function =      -0.742747368139
              le_mean =     -22.661575801707
             les_mean =     514.000148095446
             stat err =       0.000540808870
             autocorr =       1.321635881119
   target nu stat err =       0.000540808870
   target dn stat err =       0.003839844421
      target stat err =       0.003181390187
              std dev =       0.665277588322
             le_variance =       0.442594269524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266157580171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742759938339       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742759939921       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742759940293       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742759940382       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742759940427       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742759940437       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742759940431       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742759940459       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742759940459       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742759940499       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742759940450       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+04 is 2.641582e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742759938339       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742759938735       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742759938828       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742759938850       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742759938849       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742759938875       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742759938824       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742759938957       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742759938872       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742759938771       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742759938875       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+04 is 6.603954e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742759938339       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742759938438       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742759938461       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742759938467       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742759938472       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742759937434       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742759938433       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742759937815       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742759938875       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742759938737       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742759938711       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+05 is 1.650989e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0448e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013083e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981737e-02 3 1  ON 5
ci_007                 1.474633e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320230e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910904e-03 3 1  ON 10
ci_012                -9.099474e-03 3 1  ON 11
ci_013                 8.349850e-03 3 1  ON 12
ci_014                 9.370105e-03 3 1  ON 13
ci_015                 9.520304e-03 3 1  ON 14
ci_016                 9.413233e-03 3 1  ON 15
ci_017                 8.493903e-03 3 1  ON 16
ci_018                 8.287061e-03 3 1  ON 17
ci_019                -1.221712e-03 3 1  ON 18
ci_020                -1.534738e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179810e-02 3 1  ON 21
ci_023                 4.854109e-03 3 1  ON 22
ci_024                 4.919485e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147188e-02 3 1  ON 25
ci_027                 6.467183e-03 3 1  ON 26
ci_028                 6.188138e-03 3 1  ON 27
ci_029                -5.082734e-03 3 1  ON 28
ci_030                -4.170364e-03 3 1  ON 29
ci_031                 3.328400e-03 3 1  ON 30
ci_032                 4.542688e-03 3 1  ON 31
ci_033                 2.363017e-03 3 1  ON 32
ci_034                 4.136091e-03 3 1  ON 33
ci_035                 1.723442e-03 3 1  ON 34
ci_036                 2.153797e-03 3 1  ON 35
ci_037                 3.539040e-03 3 1  ON 36
ci_038                 3.700030e-03 3 1  ON 37
ci_039                 4.622623e-03 3 1  ON 38
ci_040                 4.935090e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733730e-03 3 1  ON 41
ci_043                 2.944836e-03 3 1  ON 42
ci_044                 3.188805e-03 3 1  ON 43
ci_045                 2.451527e-03 3 1  ON 44
ci_046                 2.721084e-03 3 1  ON 45
ci_047                -1.002439e-03 3 1  ON 46
ci_048                -8.335722e-04 3 1  ON 47
ci_049                 7.785866e-04 3 1  ON 48
ci_050                 9.957453e-04 3 1  ON 49
ci_051                -3.145675e-04 3 1  ON 50
ci_052                -1.210787e-03 3 1  ON 51
ci_053                -2.434015e-03 3 1  ON 52
ci_054                -2.689584e-03 3 1  ON 53
ci_055                -1.798842e-03 3 1  ON 54
ci_056                -1.928937e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.884008e-04 3 1  ON 57
ci_059                -5.510711e-04 3 1  ON 58
ci_060                -7.599460e-04 3 1  ON 59
ci_061                -5.114853e-05 3 1  ON 60
ci_062                -9.209641e-04 3 1  ON 61
ci_063                -8.861003e-04 3 1  ON 62
ci_064                -5.242760e-04 3 1  ON 63
ci_065                -1.359748e-03 3 1  ON 64
ci_066                -1.883816e-03 3 1  ON 65
ci_067                -1.812712e-03 3 1  ON 66
ci_068                -1.557064e-03 3 1  ON 67
ci_069                -5.540937e-04 3 1  ON 68
ci_070                -4.262541e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001156e-03 3 1  ON 71
ci_073                 1.611501e-04 3 1  ON 72
ci_074                 1.977628e-04 3 1  ON 73
ci_075                 1.616437e-04 3 1  ON 74
ci_076                 7.851806e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.6396
    reference variance = 0.336759
====================================================
  Execution time = 2.5176e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4374e-01
  Total weights = 1.9553e+06
  Execution time = 3.6163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435926571309
                                         uncertainty =       0.001794997001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435926571309
                                         uncertainty =       0.001794997001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466935558
  error estimate for blocks of size 2^( 2) =       0.000490826005
  error estimate for blocks of size 2^( 3) =       0.000513833063
  error estimate for blocks of size 2^( 4) =       0.000529465159
  error estimate for blocks of size 2^( 5) =       0.000539672367
  error estimate for blocks of size 2^( 6) =       0.000545148469
  error estimate for blocks of size 2^( 7) =       0.000545438896

      target function =      -0.750489319943
              le_mean =     -22.662132606771
             les_mean =     514.015994191330
             stat err =       0.000539931223
             autocorr =       1.337097230789
   target nu stat err =       0.000539931223
   target dn stat err =       0.002330149998
      target stat err =       0.002028371661
              std dev =       0.660346599055
             le_variance =       0.436057630883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435926568329
                                         uncertainty =       0.001794997149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435926568329
                                         uncertainty =       0.001794997149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466935557
  error estimate for blocks of size 2^( 2) =       0.000490826004
  error estimate for blocks of size 2^( 3) =       0.000513833062
  error estimate for blocks of size 2^( 4) =       0.000529465158
  error estimate for blocks of size 2^( 5) =       0.000539672366
  error estimate for blocks of size 2^( 6) =       0.000545148468
  error estimate for blocks of size 2^( 7) =       0.000545438895

      target function =      -0.750489318217
              le_mean =     -22.662132606821
             les_mean =     514.015994195646
             stat err =       0.000539931222
             autocorr =       1.337097233590
   target nu stat err =       0.000539931222
   target dn stat err =       0.002330150767
      target stat err =       0.002028372263
              std dev =       0.660346596798
             le_variance =       0.436057627903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435926569819
                                         uncertainty =       0.001794997075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435926569819
                                         uncertainty =       0.001794997075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466935557
  error estimate for blocks of size 2^( 2) =       0.000490826004
  error estimate for blocks of size 2^( 3) =       0.000513833063
  error estimate for blocks of size 2^( 4) =       0.000529465158
  error estimate for blocks of size 2^( 5) =       0.000539672367
  error estimate for blocks of size 2^( 6) =       0.000545148469
  error estimate for blocks of size 2^( 7) =       0.000545438895

      target function =      -0.750489319080
              le_mean =     -22.662132606796
             les_mean =     514.015994193488
             stat err =       0.000539931222
             autocorr =       1.337097232197
   target nu stat err =       0.000539931222
   target dn stat err =       0.002330150383
      target stat err =       0.002028371962
              std dev =       0.660346597926
             le_variance =       0.436057629393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435926571123
                                         uncertainty =       0.001794997010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435926571123
                                         uncertainty =       0.001794997010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466935558
  error estimate for blocks of size 2^( 2) =       0.000490826005
  error estimate for blocks of size 2^( 3) =       0.000513833063
  error estimate for blocks of size 2^( 4) =       0.000529465159
  error estimate for blocks of size 2^( 5) =       0.000539672367
  error estimate for blocks of size 2^( 6) =       0.000545148469
  error estimate for blocks of size 2^( 7) =       0.000545438896

      target function =      -0.750489319835
              le_mean =     -22.662132606774
             les_mean =     514.015994191600
             stat err =       0.000539931223
             autocorr =       1.337097230970
   target nu stat err =       0.000539931223
   target dn stat err =       0.002330150046
      target stat err =       0.002028371699
              std dev =       0.660346598913
             le_variance =       0.436057630696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750489319943        initial  <--
     1.4901e+04     1.4901e+05             2.6416e-08        -0.750489318217
     5.9605e+04     5.9605e+05             6.6040e-09        -0.750489319080
     2.3842e+05     2.3842e+06             1.6510e-09        -0.750489319835

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2774
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013084e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981737e-02 3 1  ON 5
ci_007                 1.474633e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320231e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910904e-03 3 1  ON 10
ci_012                -9.099475e-03 3 1  ON 11
ci_013                 8.349851e-03 3 1  ON 12
ci_014                 9.370108e-03 3 1  ON 13
ci_015                 9.520305e-03 3 1  ON 14
ci_016                 9.413234e-03 3 1  ON 15
ci_017                 8.493903e-03 3 1  ON 16
ci_018                 8.287059e-03 3 1  ON 17
ci_019                -1.221709e-03 3 1  ON 18
ci_020                -1.534734e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179809e-02 3 1  ON 21
ci_023                 4.854108e-03 3 1  ON 22
ci_024                 4.919486e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147187e-02 3 1  ON 25
ci_027                 6.467184e-03 3 1  ON 26
ci_028                 6.188138e-03 3 1  ON 27
ci_029                -5.082734e-03 3 1  ON 28
ci_030                -4.170365e-03 3 1  ON 29
ci_031                 3.328398e-03 3 1  ON 30
ci_032                 4.542686e-03 3 1  ON 31
ci_033                 2.363016e-03 3 1  ON 32
ci_034                 4.136092e-03 3 1  ON 33
ci_035                 1.723442e-03 3 1  ON 34
ci_036                 2.153797e-03 3 1  ON 35
ci_037                 3.539040e-03 3 1  ON 36
ci_038                 3.700030e-03 3 1  ON 37
ci_039                 4.622624e-03 3 1  ON 38
ci_040                 4.935090e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733730e-03 3 1  ON 41
ci_043                 2.944835e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451527e-03 3 1  ON 44
ci_046                 2.721085e-03 3 1  ON 45
ci_047                -1.002439e-03 3 1  ON 46
ci_048                -8.335719e-04 3 1  ON 47
ci_049                 7.785870e-04 3 1  ON 48
ci_050                 9.957449e-04 3 1  ON 49
ci_051                -3.145662e-04 3 1  ON 50
ci_052                -1.210788e-03 3 1  ON 51
ci_053                -2.434015e-03 3 1  ON 52
ci_054                -2.689581e-03 3 1  ON 53
ci_055                -1.798843e-03 3 1  ON 54
ci_056                -1.928938e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.883985e-04 3 1  ON 57
ci_059                -5.510706e-04 3 1  ON 58
ci_060                -7.599475e-04 3 1  ON 59
ci_061                -5.114773e-05 3 1  ON 60
ci_062                -9.209640e-04 3 1  ON 61
ci_063                -8.860997e-04 3 1  ON 62
ci_064                -5.242760e-04 3 1  ON 63
ci_065                -1.359749e-03 3 1  ON 64
ci_066                -1.883816e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.557063e-03 3 1  ON 67
ci_069                -5.540941e-04 3 1  ON 68
ci_070                -4.262540e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001157e-03 3 1  ON 71
ci_073                 1.611499e-04 3 1  ON 72
ci_074                 1.977620e-04 3 1  ON 73
ci_075                 1.616442e-04 3 1  ON 74
ci_076                 7.851821e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3732e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.7312
    reference variance = 0.352433
====================================================
  Execution time = 2.7788e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5202e-01
  Total weights = 1.955255018e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440843855210
                                         uncertainty =       0.002048204070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440843855210
                                         uncertainty =       0.002048204070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469456895
  error estimate for blocks of size 2^( 2) =       0.000493434145
  error estimate for blocks of size 2^( 3) =       0.000515917402
  error estimate for blocks of size 2^( 4) =       0.000531262639
  error estimate for blocks of size 2^( 5) =       0.000541037769
  error estimate for blocks of size 2^( 6) =       0.000546467299
  error estimate for blocks of size 2^( 7) =       0.000548913352

      target function =      -0.743661467721
              le_mean =     -22.662104559251
             les_mean =     514.023003937500
             stat err =       0.000541920265
             autocorr =       1.332537188988
   target nu stat err =       0.000541920265
   target dn stat err =       0.002900382446
      target stat err =       0.002442217202
              std dev =       0.663912308043
             le_variance =       0.440779552771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266210455925e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743668539438       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743668539750       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743668539813       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743668539820       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743668539821       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743668539770       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743668539866       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743668540028       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743668539640       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743668539951       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743668539650       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743668539939       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+05 is 2.823539e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743668539438       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743668539516       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743668539531       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743668539533       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743668539584       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743668539778       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743668539068       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743668539746       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743668539300       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743668538813       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743668539921       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743668538915       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+05 is 7.058850e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743668539438       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743668539457       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743668539461       residual = 8.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743668539461       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743668539055       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743668541819       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743668541118       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743668536545       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743668535406       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743668541854       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743668539722       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743668541921       residual = 7.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+06 is 1.764713e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2482e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013084e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981737e-02 3 1  ON 5
ci_007                 1.474633e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320230e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910904e-03 3 1  ON 10
ci_012                -9.099475e-03 3 1  ON 11
ci_013                 8.349851e-03 3 1  ON 12
ci_014                 9.370108e-03 3 1  ON 13
ci_015                 9.520305e-03 3 1  ON 14
ci_016                 9.413234e-03 3 1  ON 15
ci_017                 8.493903e-03 3 1  ON 16
ci_018                 8.287059e-03 3 1  ON 17
ci_019                -1.221710e-03 3 1  ON 18
ci_020                -1.534735e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179809e-02 3 1  ON 21
ci_023                 4.854108e-03 3 1  ON 22
ci_024                 4.919486e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147187e-02 3 1  ON 25
ci_027                 6.467183e-03 3 1  ON 26
ci_028                 6.188138e-03 3 1  ON 27
ci_029                -5.082734e-03 3 1  ON 28
ci_030                -4.170365e-03 3 1  ON 29
ci_031                 3.328398e-03 3 1  ON 30
ci_032                 4.542686e-03 3 1  ON 31
ci_033                 2.363016e-03 3 1  ON 32
ci_034                 4.136092e-03 3 1  ON 33
ci_035                 1.723442e-03 3 1  ON 34
ci_036                 2.153797e-03 3 1  ON 35
ci_037                 3.539040e-03 3 1  ON 36
ci_038                 3.700030e-03 3 1  ON 37
ci_039                 4.622624e-03 3 1  ON 38
ci_040                 4.935090e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733730e-03 3 1  ON 41
ci_043                 2.944836e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451527e-03 3 1  ON 44
ci_046                 2.721084e-03 3 1  ON 45
ci_047                -1.002439e-03 3 1  ON 46
ci_048                -8.335720e-04 3 1  ON 47
ci_049                 7.785869e-04 3 1  ON 48
ci_050                 9.957449e-04 3 1  ON 49
ci_051                -3.145662e-04 3 1  ON 50
ci_052                -1.210788e-03 3 1  ON 51
ci_053                -2.434015e-03 3 1  ON 52
ci_054                -2.689581e-03 3 1  ON 53
ci_055                -1.798843e-03 3 1  ON 54
ci_056                -1.928938e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.883986e-04 3 1  ON 57
ci_059                -5.510706e-04 3 1  ON 58
ci_060                -7.599474e-04 3 1  ON 59
ci_061                -5.114776e-05 3 1  ON 60
ci_062                -9.209640e-04 3 1  ON 61
ci_063                -8.860997e-04 3 1  ON 62
ci_064                -5.242758e-04 3 1  ON 63
ci_065                -1.359749e-03 3 1  ON 64
ci_066                -1.883816e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.557063e-03 3 1  ON 67
ci_069                -5.540940e-04 3 1  ON 68
ci_070                -4.262540e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001157e-03 3 1  ON 71
ci_073                 1.611498e-04 3 1  ON 72
ci_074                 1.977619e-04 3 1  ON 73
ci_075                 1.616443e-04 3 1  ON 74
ci_076                 7.851821e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6973
    reference variance = 0.424098
====================================================
  Execution time = 2.5083e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6043e-01
  Total weights = 1.9553e+06
  Execution time = 3.6243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443763646744
                                         uncertainty =       0.002575428649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443763646744
                                         uncertainty =       0.002575428649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471133130
  error estimate for blocks of size 2^( 2) =       0.000495142732
  error estimate for blocks of size 2^( 3) =       0.000516998905
  error estimate for blocks of size 2^( 4) =       0.000532566755
  error estimate for blocks of size 2^( 5) =       0.000542256159
  error estimate for blocks of size 2^( 6) =       0.000546544398
  error estimate for blocks of size 2^( 7) =       0.000548199182

      target function =      -0.736839185091
              le_mean =     -22.661691705607
             les_mean =     514.012704347371
             stat err =       0.000542391624
             autocorr =       1.325374646658
   target nu stat err =       0.000542391624
   target dn stat err =       0.005171186810
      target stat err =       0.004185259230
              std dev =       0.666282861654
             le_variance =       0.443932851734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443763646327
                                         uncertainty =       0.002575428660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443763646327
                                         uncertainty =       0.002575428660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471133129
  error estimate for blocks of size 2^( 2) =       0.000495142732
  error estimate for blocks of size 2^( 3) =       0.000516998905
  error estimate for blocks of size 2^( 4) =       0.000532566755
  error estimate for blocks of size 2^( 5) =       0.000542256159
  error estimate for blocks of size 2^( 6) =       0.000546544398
  error estimate for blocks of size 2^( 7) =       0.000548199181

      target function =      -0.736839194385
              le_mean =     -22.661691705583
             les_mean =     514.012704334703
             stat err =       0.000542391623
             autocorr =       1.325374647113
   target nu stat err =       0.000542391623
   target dn stat err =       0.005171187438
      target stat err =       0.004185259833
              std dev =       0.666282861338
             le_variance =       0.443932851312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443763646535
                                         uncertainty =       0.002575428654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443763646535
                                         uncertainty =       0.002575428654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471133130
  error estimate for blocks of size 2^( 2) =       0.000495142732
  error estimate for blocks of size 2^( 3) =       0.000516998905
  error estimate for blocks of size 2^( 4) =       0.000532566755
  error estimate for blocks of size 2^( 5) =       0.000542256159
  error estimate for blocks of size 2^( 6) =       0.000546544398
  error estimate for blocks of size 2^( 7) =       0.000548199182

      target function =      -0.736839189738
              le_mean =     -22.661691705595
             les_mean =     514.012704341037
             stat err =       0.000542391623
             autocorr =       1.325374646879
   target nu stat err =       0.000542391623
   target dn stat err =       0.005171187124
      target stat err =       0.004185259531
              std dev =       0.666282861496
             le_variance =       0.443932851523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443763646718
                                         uncertainty =       0.002575428650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443763646718
                                         uncertainty =       0.002575428650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471133130
  error estimate for blocks of size 2^( 2) =       0.000495142732
  error estimate for blocks of size 2^( 3) =       0.000516998905
  error estimate for blocks of size 2^( 4) =       0.000532566755
  error estimate for blocks of size 2^( 5) =       0.000542256159
  error estimate for blocks of size 2^( 6) =       0.000546544398
  error estimate for blocks of size 2^( 7) =       0.000548199182

      target function =      -0.736839185672
              le_mean =     -22.661691705605
             les_mean =     514.012704346579
             stat err =       0.000542391623
             autocorr =       1.325374646674
   target nu stat err =       0.000542391623
   target dn stat err =       0.005171186849
      target stat err =       0.004185259268
              std dev =       0.666282861634
             le_variance =       0.443932851708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.736839185091        initial
     1.4901e+05     1.4901e+06             2.8235e-09        -0.736839194385  <--
     5.9605e+05     5.9605e+06             7.0589e-10        -0.736839189738
     2.3842e+06     2.3842e+07             1.7647e-10        -0.736839185672

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 4.6348e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013084e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981737e-02 3 1  ON 5
ci_007                 1.474633e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320230e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910905e-03 3 1  ON 10
ci_012                -9.099474e-03 3 1  ON 11
ci_013                 8.349851e-03 3 1  ON 12
ci_014                 9.370108e-03 3 1  ON 13
ci_015                 9.520305e-03 3 1  ON 14
ci_016                 9.413234e-03 3 1  ON 15
ci_017                 8.493903e-03 3 1  ON 16
ci_018                 8.287059e-03 3 1  ON 17
ci_019                -1.221711e-03 3 1  ON 18
ci_020                -1.534737e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179809e-02 3 1  ON 21
ci_023                 4.854108e-03 3 1  ON 22
ci_024                 4.919486e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147187e-02 3 1  ON 25
ci_027                 6.467183e-03 3 1  ON 26
ci_028                 6.188137e-03 3 1  ON 27
ci_029                -5.082734e-03 3 1  ON 28
ci_030                -4.170365e-03 3 1  ON 29
ci_031                 3.328399e-03 3 1  ON 30
ci_032                 4.542686e-03 3 1  ON 31
ci_033                 2.363017e-03 3 1  ON 32
ci_034                 4.136091e-03 3 1  ON 33
ci_035                 1.723442e-03 3 1  ON 34
ci_036                 2.153796e-03 3 1  ON 35
ci_037                 3.539040e-03 3 1  ON 36
ci_038                 3.700030e-03 3 1  ON 37
ci_039                 4.622623e-03 3 1  ON 38
ci_040                 4.935090e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733730e-03 3 1  ON 41
ci_043                 2.944836e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451527e-03 3 1  ON 44
ci_046                 2.721084e-03 3 1  ON 45
ci_047                -1.002438e-03 3 1  ON 46
ci_048                -8.335720e-04 3 1  ON 47
ci_049                 7.785865e-04 3 1  ON 48
ci_050                 9.957450e-04 3 1  ON 49
ci_051                -3.145665e-04 3 1  ON 50
ci_052                -1.210787e-03 3 1  ON 51
ci_053                -2.434015e-03 3 1  ON 52
ci_054                -2.689581e-03 3 1  ON 53
ci_055                -1.798843e-03 3 1  ON 54
ci_056                -1.928937e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.883987e-04 3 1  ON 57
ci_059                -5.510704e-04 3 1  ON 58
ci_060                -7.599470e-04 3 1  ON 59
ci_061                -5.114786e-05 3 1  ON 60
ci_062                -9.209640e-04 3 1  ON 61
ci_063                -8.860997e-04 3 1  ON 62
ci_064                -5.242751e-04 3 1  ON 63
ci_065                -1.359749e-03 3 1  ON 64
ci_066                -1.883816e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.557063e-03 3 1  ON 67
ci_069                -5.540936e-04 3 1  ON 68
ci_070                -4.262541e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001157e-03 3 1  ON 71
ci_073                 1.611497e-04 3 1  ON 72
ci_074                 1.977619e-04 3 1  ON 73
ci_075                 1.616446e-04 3 1  ON 74
ci_076                 7.851822e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8838e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.7943
    reference variance = 0.43448
====================================================
  Execution time = 2.5702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4737e-01
  Total weights = 1.955182019e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7547e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438269576738
                                         uncertainty =       0.001919421430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438269576738
                                         uncertainty =       0.001919421430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468076036
  error estimate for blocks of size 2^( 2) =       0.000492172199
  error estimate for blocks of size 2^( 3) =       0.000514420857
  error estimate for blocks of size 2^( 4) =       0.000529753020
  error estimate for blocks of size 2^( 5) =       0.000540091058
  error estimate for blocks of size 2^( 6) =       0.000543188463
  error estimate for blocks of size 2^( 7) =       0.000547460105

      target function =      -0.747485087334
              le_mean =     -22.662679103660
             les_mean =     514.044398415356
             stat err =       0.000540123162
             autocorr =       1.331535617548
   target nu stat err =       0.000540123162
   target dn stat err =       0.002491622476
      target stat err =       0.002142280478
              std dev =       0.661959478252
             le_variance =       0.438190350847


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266267910366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747490304656       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747490305053       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747490305135       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747490305142       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747490305149       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747490305136       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747490305215       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747490305069       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747490305139       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747490305171       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747490305128       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747490305074       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+04 is 4.120753e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747490304656       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747490304755       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747490304776       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747490304777       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747490304828       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747490304870       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747490304862       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747490304692       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747490304424       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747490304799       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747490304759       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747490305017       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+05 is 1.030189e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747490304656       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747490304681       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747490304686       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747490304685       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747490304201       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747490304730       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747490304907       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747490304919       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747490303315       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747490302945       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747490305891       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747490303101       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+05 is 2.575474e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0467e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013084e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981737e-02 3 1  ON 5
ci_007                 1.474633e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320230e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910904e-03 3 1  ON 10
ci_012                -9.099474e-03 3 1  ON 11
ci_013                 8.349851e-03 3 1  ON 12
ci_014                 9.370108e-03 3 1  ON 13
ci_015                 9.520305e-03 3 1  ON 14
ci_016                 9.413233e-03 3 1  ON 15
ci_017                 8.493903e-03 3 1  ON 16
ci_018                 8.287060e-03 3 1  ON 17
ci_019                -1.221712e-03 3 1  ON 18
ci_020                -1.534738e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179809e-02 3 1  ON 21
ci_023                 4.854108e-03 3 1  ON 22
ci_024                 4.919486e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147187e-02 3 1  ON 25
ci_027                 6.467183e-03 3 1  ON 26
ci_028                 6.188137e-03 3 1  ON 27
ci_029                -5.082733e-03 3 1  ON 28
ci_030                -4.170364e-03 3 1  ON 29
ci_031                 3.328400e-03 3 1  ON 30
ci_032                 4.542687e-03 3 1  ON 31
ci_033                 2.363016e-03 3 1  ON 32
ci_034                 4.136090e-03 3 1  ON 33
ci_035                 1.723442e-03 3 1  ON 34
ci_036                 2.153796e-03 3 1  ON 35
ci_037                 3.539039e-03 3 1  ON 36
ci_038                 3.700029e-03 3 1  ON 37
ci_039                 4.622623e-03 3 1  ON 38
ci_040                 4.935089e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733730e-03 3 1  ON 41
ci_043                 2.944836e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451527e-03 3 1  ON 44
ci_046                 2.721084e-03 3 1  ON 45
ci_047                -1.002438e-03 3 1  ON 46
ci_048                -8.335723e-04 3 1  ON 47
ci_049                 7.785867e-04 3 1  ON 48
ci_050                 9.957448e-04 3 1  ON 49
ci_051                -3.145666e-04 3 1  ON 50
ci_052                -1.210787e-03 3 1  ON 51
ci_053                -2.434015e-03 3 1  ON 52
ci_054                -2.689581e-03 3 1  ON 53
ci_055                -1.798843e-03 3 1  ON 54
ci_056                -1.928937e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.883988e-04 3 1  ON 57
ci_059                -5.510703e-04 3 1  ON 58
ci_060                -7.599471e-04 3 1  ON 59
ci_061                -5.114801e-05 3 1  ON 60
ci_062                -9.209638e-04 3 1  ON 61
ci_063                -8.860992e-04 3 1  ON 62
ci_064                -5.242752e-04 3 1  ON 63
ci_065                -1.359749e-03 3 1  ON 64
ci_066                -1.883817e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.557063e-03 3 1  ON 67
ci_069                -5.540930e-04 3 1  ON 68
ci_070                -4.262544e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001156e-03 3 1  ON 71
ci_073                 1.611494e-04 3 1  ON 72
ci_074                 1.977618e-04 3 1  ON 73
ci_075                 1.616452e-04 3 1  ON 74
ci_076                 7.851825e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.6175
    reference variance = 0.380095
====================================================
  Execution time = 2.5089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5231e-01
  Total weights = 1.9552e+06
  Execution time = 3.6294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442292784057
                                         uncertainty =       0.002090649349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442292784057
                                         uncertainty =       0.002090649349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470413566
  error estimate for blocks of size 2^( 2) =       0.000494600774
  error estimate for blocks of size 2^( 3) =       0.000516948728
  error estimate for blocks of size 2^( 4) =       0.000532433490
  error estimate for blocks of size 2^( 5) =       0.000542747622
  error estimate for blocks of size 2^( 6) =       0.000547743565
  error estimate for blocks of size 2^( 7) =       0.000549357509

      target function =      -0.743423497871
              le_mean =     -22.661352997641
             les_mean =     513.989225865993
             stat err =       0.000543070546
             autocorr =       1.332762681813
   target nu stat err =       0.000543070546
   target dn stat err =       0.002686903354
      target stat err =       0.002269934747
              std dev =       0.665265244673
             le_variance =       0.442577845770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442292782226
                                         uncertainty =       0.002090649268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442292782226
                                         uncertainty =       0.002090649268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470413565
  error estimate for blocks of size 2^( 2) =       0.000494600773
  error estimate for blocks of size 2^( 3) =       0.000516948727
  error estimate for blocks of size 2^( 4) =       0.000532433489
  error estimate for blocks of size 2^( 5) =       0.000542747621
  error estimate for blocks of size 2^( 6) =       0.000547743564
  error estimate for blocks of size 2^( 7) =       0.000549357508

      target function =      -0.743423500356
              le_mean =     -22.661352997635
             les_mean =     513.989225862684
             stat err =       0.000543070546
             autocorr =       1.332762684131
   target nu stat err =       0.000543070546
   target dn stat err =       0.002686903041
      target stat err =       0.002269934515
              std dev =       0.665265243319
             le_variance =       0.442577843968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442292783141
                                         uncertainty =       0.002090649308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442292783141
                                         uncertainty =       0.002090649308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470413565
  error estimate for blocks of size 2^( 2) =       0.000494600773
  error estimate for blocks of size 2^( 3) =       0.000516948727
  error estimate for blocks of size 2^( 4) =       0.000532433489
  error estimate for blocks of size 2^( 5) =       0.000542747622
  error estimate for blocks of size 2^( 6) =       0.000547743565
  error estimate for blocks of size 2^( 7) =       0.000549357508

      target function =      -0.743423499114
              le_mean =     -22.661352997638
             les_mean =     513.989225864338
             stat err =       0.000543070546
             autocorr =       1.332762682983
   target nu stat err =       0.000543070546
   target dn stat err =       0.002686903197
      target stat err =       0.002269934631
              std dev =       0.665265243996
             le_variance =       0.442577844869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442292783942
                                         uncertainty =       0.002090649344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442292783942
                                         uncertainty =       0.002090649344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470413566
  error estimate for blocks of size 2^( 2) =       0.000494600774
  error estimate for blocks of size 2^( 3) =       0.000516948728
  error estimate for blocks of size 2^( 4) =       0.000532433490
  error estimate for blocks of size 2^( 5) =       0.000542747622
  error estimate for blocks of size 2^( 6) =       0.000547743565
  error estimate for blocks of size 2^( 7) =       0.000549357509

      target function =      -0.743423498027
              le_mean =     -22.661352997641
             les_mean =     513.989225865786
             stat err =       0.000543070546
             autocorr =       1.332762681966
   target nu stat err =       0.000543070546
   target dn stat err =       0.002686903335
      target stat err =       0.002269934732
              std dev =       0.665265244589
             le_variance =       0.442577845658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743423497871        initial
     3.7253e+04     3.7253e+05             4.1208e-09        -0.743423500356  <--
     1.4901e+05     1.4901e+06             1.0302e-09        -0.743423499114
     5.9605e+05     5.9605e+06             2.5755e-10        -0.743423498027

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 4.3211e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013083e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981736e-02 3 1  ON 5
ci_007                 1.474632e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320230e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910902e-03 3 1  ON 10
ci_012                -9.099474e-03 3 1  ON 11
ci_013                 8.349851e-03 3 1  ON 12
ci_014                 9.370107e-03 3 1  ON 13
ci_015                 9.520303e-03 3 1  ON 14
ci_016                 9.413232e-03 3 1  ON 15
ci_017                 8.493903e-03 3 1  ON 16
ci_018                 8.287060e-03 3 1  ON 17
ci_019                -1.221714e-03 3 1  ON 18
ci_020                -1.534741e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179810e-02 3 1  ON 21
ci_023                 4.854108e-03 3 1  ON 22
ci_024                 4.919486e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147188e-02 3 1  ON 25
ci_027                 6.467184e-03 3 1  ON 26
ci_028                 6.188137e-03 3 1  ON 27
ci_029                -5.082732e-03 3 1  ON 28
ci_030                -4.170364e-03 3 1  ON 29
ci_031                 3.328402e-03 3 1  ON 30
ci_032                 4.542688e-03 3 1  ON 31
ci_033                 2.363016e-03 3 1  ON 32
ci_034                 4.136089e-03 3 1  ON 33
ci_035                 1.723442e-03 3 1  ON 34
ci_036                 2.153795e-03 3 1  ON 35
ci_037                 3.539038e-03 3 1  ON 36
ci_038                 3.700028e-03 3 1  ON 37
ci_039                 4.622623e-03 3 1  ON 38
ci_040                 4.935089e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733730e-03 3 1  ON 41
ci_043                 2.944836e-03 3 1  ON 42
ci_044                 3.188806e-03 3 1  ON 43
ci_045                 2.451528e-03 3 1  ON 44
ci_046                 2.721081e-03 3 1  ON 45
ci_047                -1.002438e-03 3 1  ON 46
ci_048                -8.335731e-04 3 1  ON 47
ci_049                 7.785872e-04 3 1  ON 48
ci_050                 9.957439e-04 3 1  ON 49
ci_051                -3.145667e-04 3 1  ON 50
ci_052                -1.210787e-03 3 1  ON 51
ci_053                -2.434016e-03 3 1  ON 52
ci_054                -2.689581e-03 3 1  ON 53
ci_055                -1.798843e-03 3 1  ON 54
ci_056                -1.928936e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.883988e-04 3 1  ON 57
ci_059                -5.510699e-04 3 1  ON 58
ci_060                -7.599475e-04 3 1  ON 59
ci_061                -5.114848e-05 3 1  ON 60
ci_062                -9.209629e-04 3 1  ON 61
ci_063                -8.860978e-04 3 1  ON 62
ci_064                -5.242755e-04 3 1  ON 63
ci_065                -1.359749e-03 3 1  ON 64
ci_066                -1.883819e-03 3 1  ON 65
ci_067                -1.812712e-03 3 1  ON 66
ci_068                -1.557065e-03 3 1  ON 67
ci_069                -5.540911e-04 3 1  ON 68
ci_070                -4.262555e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001155e-03 3 1  ON 71
ci_073                 1.611482e-04 3 1  ON 72
ci_074                 1.977616e-04 3 1  ON 73
ci_075                 1.616468e-04 3 1  ON 74
ci_076                 7.851834e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3685e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.613
    reference variance = 0.313437
====================================================
  Execution time = 2.5743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5127e-01
  Total weights = 1.955468692e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7496e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440901057688
                                         uncertainty =       0.002071517028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440901057688
                                         uncertainty =       0.002071517028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469521900
  error estimate for blocks of size 2^( 2) =       0.000493467741
  error estimate for blocks of size 2^( 3) =       0.000515818199
  error estimate for blocks of size 2^( 4) =       0.000531044748
  error estimate for blocks of size 2^( 5) =       0.000538505178
  error estimate for blocks of size 2^( 6) =       0.000543584286
  error estimate for blocks of size 2^( 7) =       0.000545887672

      target function =      -0.744266346172
              le_mean =     -22.661211858943
             les_mean =     513.981795798073
             stat err =       0.000539755471
             autocorr =       1.321546347876
   target nu stat err =       0.000539755471
   target dn stat err =       0.002484831240
      target stat err =       0.002114547887
              std dev =       0.664004238645
             le_variance =       0.440901628939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266121185894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744271360710       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744271362418       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744271362811       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744271362836       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744271362837       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744271362836       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744271362837       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744271362835       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744271362835       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744271362854       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+03 is 2.533834e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744271360710       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744271361137       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744271361235       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744271361242       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744271361242       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744271361225       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744271361242       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744271361227       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744271361233       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744271361241       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+04 is 6.334603e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744271360710       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744271360817       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744271360841       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744271360843       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744271360843       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744271360718       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744271360843       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744271360843       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744271360816       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744271360673       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+05 is 1.583652e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0502e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013083e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981736e-02 3 1  ON 5
ci_007                 1.474632e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320230e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910901e-03 3 1  ON 10
ci_012                -9.099473e-03 3 1  ON 11
ci_013                 8.349850e-03 3 1  ON 12
ci_014                 9.370103e-03 3 1  ON 13
ci_015                 9.520300e-03 3 1  ON 14
ci_016                 9.413231e-03 3 1  ON 15
ci_017                 8.493905e-03 3 1  ON 16
ci_018                 8.287060e-03 3 1  ON 17
ci_019                -1.221720e-03 3 1  ON 18
ci_020                -1.534745e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179810e-02 3 1  ON 21
ci_023                 4.854108e-03 3 1  ON 22
ci_024                 4.919487e-03 3 1  ON 23
ci_025                 1.143514e-02 3 1  ON 24
ci_026                 1.147188e-02 3 1  ON 25
ci_027                 6.467184e-03 3 1  ON 26
ci_028                 6.188137e-03 3 1  ON 27
ci_029                -5.082732e-03 3 1  ON 28
ci_030                -4.170366e-03 3 1  ON 29
ci_031                 3.328405e-03 3 1  ON 30
ci_032                 4.542690e-03 3 1  ON 31
ci_033                 2.363017e-03 3 1  ON 32
ci_034                 4.136088e-03 3 1  ON 33
ci_035                 1.723441e-03 3 1  ON 34
ci_036                 2.153794e-03 3 1  ON 35
ci_037                 3.539038e-03 3 1  ON 36
ci_038                 3.700028e-03 3 1  ON 37
ci_039                 4.622620e-03 3 1  ON 38
ci_040                 4.935089e-03 3 1  ON 39
ci_041                 2.971044e-03 3 1  ON 40
ci_042                 2.733731e-03 3 1  ON 41
ci_043                 2.944836e-03 3 1  ON 42
ci_044                 3.188804e-03 3 1  ON 43
ci_045                 2.451526e-03 3 1  ON 44
ci_046                 2.721081e-03 3 1  ON 45
ci_047                -1.002438e-03 3 1  ON 46
ci_048                -8.335730e-04 3 1  ON 47
ci_049                 7.785861e-04 3 1  ON 48
ci_050                 9.957448e-04 3 1  ON 49
ci_051                -3.145640e-04 3 1  ON 50
ci_052                -1.210786e-03 3 1  ON 51
ci_053                -2.434018e-03 3 1  ON 52
ci_054                -2.689580e-03 3 1  ON 53
ci_055                -1.798842e-03 3 1  ON 54
ci_056                -1.928936e-03 3 1  ON 55
ci_057                -1.307224e-03 3 1  ON 56
ci_058                -9.883984e-04 3 1  ON 57
ci_059                -5.510692e-04 3 1  ON 58
ci_060                -7.599459e-04 3 1  ON 59
ci_061                -5.114879e-05 3 1  ON 60
ci_062                -9.209629e-04 3 1  ON 61
ci_063                -8.860985e-04 3 1  ON 62
ci_064                -5.242766e-04 3 1  ON 63
ci_065                -1.359751e-03 3 1  ON 64
ci_066                -1.883818e-03 3 1  ON 65
ci_067                -1.812713e-03 3 1  ON 66
ci_068                -1.557064e-03 3 1  ON 67
ci_069                -5.540904e-04 3 1  ON 68
ci_070                -4.262547e-04 3 1  ON 69
ci_071                -2.088193e-03 3 1  ON 70
ci_072                -2.001155e-03 3 1  ON 71
ci_073                 1.611472e-04 3 1  ON 72
ci_074                 1.977616e-04 3 1  ON 73
ci_075                 1.616459e-04 3 1  ON 74
ci_076                 7.851834e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6226
    reference variance = 0.398706
====================================================
  Execution time = 2.5320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4854e-01
  Total weights = 1.9552e+06
  Execution time = 3.6188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226188152
                                         uncertainty =       0.002085567841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226188152
                                         uncertainty =       0.002085567841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468616011
  error estimate for blocks of size 2^( 2) =       0.000492090511
  error estimate for blocks of size 2^( 3) =       0.000513330304
  error estimate for blocks of size 2^( 4) =       0.000529296078
  error estimate for blocks of size 2^( 5) =       0.000539694359
  error estimate for blocks of size 2^( 6) =       0.000543873893
  error estimate for blocks of size 2^( 7) =       0.000548284842

      target function =      -0.746524743052
              le_mean =     -22.663342382013
             les_mean =     514.075632627655
             stat err =       0.000540287293
             autocorr =       1.329276300296
   target nu stat err =       0.000540287293
   target dn stat err =       0.002959010624
      target stat err =       0.002511495432
              std dev =       0.662723118230
             le_variance =       0.439201931436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226185677
                                         uncertainty =       0.002085568079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226185677
                                         uncertainty =       0.002085568079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468616010
  error estimate for blocks of size 2^( 2) =       0.000492090510
  error estimate for blocks of size 2^( 3) =       0.000513330303
  error estimate for blocks of size 2^( 4) =       0.000529296077
  error estimate for blocks of size 2^( 5) =       0.000539694358
  error estimate for blocks of size 2^( 6) =       0.000543873892
  error estimate for blocks of size 2^( 7) =       0.000548284841

      target function =      -0.746524773902
              le_mean =     -22.663342382010
             les_mean =     514.075632590144
             stat err =       0.000540287292
             autocorr =       1.329276302646
   target nu stat err =       0.000540287292
   target dn stat err =       0.002959005502
      target stat err =       0.002511491532
              std dev =       0.662723116345
             le_variance =       0.439201928938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226186915
                                         uncertainty =       0.002085567960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226186915
                                         uncertainty =       0.002085567960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468616010
  error estimate for blocks of size 2^( 2) =       0.000492090511
  error estimate for blocks of size 2^( 3) =       0.000513330303
  error estimate for blocks of size 2^( 4) =       0.000529296077
  error estimate for blocks of size 2^( 5) =       0.000539694359
  error estimate for blocks of size 2^( 6) =       0.000543873893
  error estimate for blocks of size 2^( 7) =       0.000548284842

      target function =      -0.746524758528
              le_mean =     -22.663342382012
             les_mean =     514.075632608838
             stat err =       0.000540287293
             autocorr =       1.329276301480
   target nu stat err =       0.000540287293
   target dn stat err =       0.002959008062
      target stat err =       0.002511493481
              std dev =       0.662723117287
             le_variance =       0.439201930187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226187997
                                         uncertainty =       0.002085567856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226187997
                                         uncertainty =       0.002085567856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468616011
  error estimate for blocks of size 2^( 2) =       0.000492090511
  error estimate for blocks of size 2^( 3) =       0.000513330304
  error estimate for blocks of size 2^( 4) =       0.000529296078
  error estimate for blocks of size 2^( 5) =       0.000539694359
  error estimate for blocks of size 2^( 6) =       0.000543873893
  error estimate for blocks of size 2^( 7) =       0.000548284842

      target function =      -0.746524744992
              le_mean =     -22.663342382013
             les_mean =     514.075632625296
             stat err =       0.000540287293
             autocorr =       1.329276300444
   target nu stat err =       0.000540287293
   target dn stat err =       0.002959010304
      target stat err =       0.002511495188
              std dev =       0.662723118112
             le_variance =       0.439201931280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746524743052        initial
     9.3132e+03     9.3132e+04             2.5338e-08        -0.746524773902  <--
     3.7253e+04     3.7253e+05             6.3346e-09        -0.746524758528
     1.4901e+05     1.4901e+06             1.5837e-09        -0.746524744992

*****************************************************************************
Applying the update for shift_i =   9.3132e+03     and shift_s =   9.3132e+04
*****************************************************************************

  Execution time = 4.3503e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013083e-02 3 1  ON 2
ci_004                -5.100237e-02 3 1  ON 3
ci_005                 1.949595e-02 3 1  ON 4
ci_006                 1.981736e-02 3 1  ON 5
ci_007                 1.474632e-02 3 1  ON 6
ci_008                 1.554109e-02 3 1  ON 7
ci_009                -1.320229e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910897e-03 3 1  ON 10
ci_012                -9.099471e-03 3 1  ON 11
ci_013                 8.349846e-03 3 1  ON 12
ci_014                 9.370090e-03 3 1  ON 13
ci_015                 9.520290e-03 3 1  ON 14
ci_016                 9.413230e-03 3 1  ON 15
ci_017                 8.493910e-03 3 1  ON 16
ci_018                 8.287058e-03 3 1  ON 17
ci_019                -1.221739e-03 3 1  ON 18
ci_020                -1.534756e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179811e-02 3 1  ON 21
ci_023                 4.854107e-03 3 1  ON 22
ci_024                 4.919492e-03 3 1  ON 23
ci_025                 1.143515e-02 3 1  ON 24
ci_026                 1.147189e-02 3 1  ON 25
ci_027                 6.467183e-03 3 1  ON 26
ci_028                 6.188137e-03 3 1  ON 27
ci_029                -5.082731e-03 3 1  ON 28
ci_030                -4.170372e-03 3 1  ON 29
ci_031                 3.328413e-03 3 1  ON 30
ci_032                 4.542696e-03 3 1  ON 31
ci_033                 2.363018e-03 3 1  ON 32
ci_034                 4.136086e-03 3 1  ON 33
ci_035                 1.723438e-03 3 1  ON 34
ci_036                 2.153791e-03 3 1  ON 35
ci_037                 3.539040e-03 3 1  ON 36
ci_038                 3.700026e-03 3 1  ON 37
ci_039                 4.622613e-03 3 1  ON 38
ci_040                 4.935090e-03 3 1  ON 39
ci_041                 2.971045e-03 3 1  ON 40
ci_042                 2.733732e-03 3 1  ON 41
ci_043                 2.944838e-03 3 1  ON 42
ci_044                 3.188798e-03 3 1  ON 43
ci_045                 2.451522e-03 3 1  ON 44
ci_046                 2.721080e-03 3 1  ON 45
ci_047                -1.002438e-03 3 1  ON 46
ci_048                -8.335727e-04 3 1  ON 47
ci_049                 7.785830e-04 3 1  ON 48
ci_050                 9.957473e-04 3 1  ON 49
ci_051                -3.145557e-04 3 1  ON 50
ci_052                -1.210783e-03 3 1  ON 51
ci_053                -2.434023e-03 3 1  ON 52
ci_054                -2.689576e-03 3 1  ON 53
ci_055                -1.798841e-03 3 1  ON 54
ci_056                -1.928934e-03 3 1  ON 55
ci_057                -1.307222e-03 3 1  ON 56
ci_058                -9.883971e-04 3 1  ON 57
ci_059                -5.510670e-04 3 1  ON 58
ci_060                -7.599410e-04 3 1  ON 59
ci_061                -5.114973e-05 3 1  ON 60
ci_062                -9.209629e-04 3 1  ON 61
ci_063                -8.861006e-04 3 1  ON 62
ci_064                -5.242801e-04 3 1  ON 63
ci_065                -1.359755e-03 3 1  ON 64
ci_066                -1.883816e-03 3 1  ON 65
ci_067                -1.812715e-03 3 1  ON 66
ci_068                -1.557064e-03 3 1  ON 67
ci_069                -5.540884e-04 3 1  ON 68
ci_070                -4.262523e-04 3 1  ON 69
ci_071                -2.088191e-03 3 1  ON 70
ci_072                -2.001156e-03 3 1  ON 71
ci_073                 1.611440e-04 3 1  ON 72
ci_074                 1.977617e-04 3 1  ON 73
ci_075                 1.616430e-04 3 1  ON 74
ci_076                 7.851836e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4011e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7572
    reference variance = 0.527746
====================================================
  Execution time = 2.5711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5268e-01
  Total weights = 1.955440693e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440966045772
                                         uncertainty =       0.002144007669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440966045772
                                         uncertainty =       0.002144007669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469605298
  error estimate for blocks of size 2^( 2) =       0.000494155601
  error estimate for blocks of size 2^( 3) =       0.000516137354
  error estimate for blocks of size 2^( 4) =       0.000532574319
  error estimate for blocks of size 2^( 5) =       0.000542495284
  error estimate for blocks of size 2^( 6) =       0.000549044552
  error estimate for blocks of size 2^( 7) =       0.000548809142

      target function =      -0.743118316080
              le_mean =     -22.661374388173
             les_mean =     513.990568849477
             stat err =       0.000543230824
             autocorr =       1.338143949617
   target nu stat err =       0.000543230824
   target dn stat err =       0.002885867712
      target stat err =       0.002425017422
              std dev =       0.664122180701
             le_variance =       0.441058270899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266137438817e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743125272851       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743125280993       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743125282462       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743125282630       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743125282633       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743125282671       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743125282661       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743125282665       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743125282665       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743125282666       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743125282668       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 9.083403e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743125272851       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743125274886       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743125275254       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743125275296       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743125275294       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743125275325       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743125275321       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743125275312       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743125275300       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743125275309       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743125275314       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+03 is 2.270878e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743125272851       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743125273360       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743125273451       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743125273462       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743125273564       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743125273464       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743125273473       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743125273458       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743125273426       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743125273465       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743125273460       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+04 is 5.677214e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158946 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0413e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013085e-02 3 1  ON 2
ci_004                -5.100235e-02 3 1  ON 3
ci_005                 1.949594e-02 3 1  ON 4
ci_006                 1.981736e-02 3 1  ON 5
ci_007                 1.474631e-02 3 1  ON 6
ci_008                 1.554108e-02 3 1  ON 7
ci_009                -1.320229e-02 3 1  ON 8
ci_010                -1.208038e-02 3 1  ON 9
ci_011                -9.910902e-03 3 1  ON 10
ci_012                -9.099470e-03 3 1  ON 11
ci_013                 8.349837e-03 3 1  ON 12
ci_014                 9.370081e-03 3 1  ON 13
ci_015                 9.520283e-03 3 1  ON 14
ci_016                 9.413215e-03 3 1  ON 15
ci_017                 8.493916e-03 3 1  ON 16
ci_018                 8.287056e-03 3 1  ON 17
ci_019                -1.221762e-03 3 1  ON 18
ci_020                -1.534772e-03 3 1  ON 19
ci_021                -1.177669e-02 3 1  ON 20
ci_022                -1.179812e-02 3 1  ON 21
ci_023                 4.854106e-03 3 1  ON 22
ci_024                 4.919490e-03 3 1  ON 23
ci_025                 1.143517e-02 3 1  ON 24
ci_026                 1.147189e-02 3 1  ON 25
ci_027                 6.467179e-03 3 1  ON 26
ci_028                 6.188135e-03 3 1  ON 27
ci_029                -5.082720e-03 3 1  ON 28
ci_030                -4.170367e-03 3 1  ON 29
ci_031                 3.328429e-03 3 1  ON 30
ci_032                 4.542700e-03 3 1  ON 31
ci_033                 2.363026e-03 3 1  ON 32
ci_034                 4.136085e-03 3 1  ON 33
ci_035                 1.723441e-03 3 1  ON 34
ci_036                 2.153787e-03 3 1  ON 35
ci_037                 3.539046e-03 3 1  ON 36
ci_038                 3.700013e-03 3 1  ON 37
ci_039                 4.622612e-03 3 1  ON 38
ci_040                 4.935092e-03 3 1  ON 39
ci_041                 2.971045e-03 3 1  ON 40
ci_042                 2.733727e-03 3 1  ON 41
ci_043                 2.944845e-03 3 1  ON 42
ci_044                 3.188794e-03 3 1  ON 43
ci_045                 2.451517e-03 3 1  ON 44
ci_046                 2.721077e-03 3 1  ON 45
ci_047                -1.002435e-03 3 1  ON 46
ci_048                -8.335723e-04 3 1  ON 47
ci_049                 7.785776e-04 3 1  ON 48
ci_050                 9.957446e-04 3 1  ON 49
ci_051                -3.145579e-04 3 1  ON 50
ci_052                -1.210782e-03 3 1  ON 51
ci_053                -2.434014e-03 3 1  ON 52
ci_054                -2.689570e-03 3 1  ON 53
ci_055                -1.798840e-03 3 1  ON 54
ci_056                -1.928935e-03 3 1  ON 55
ci_057                -1.307225e-03 3 1  ON 56
ci_058                -9.883955e-04 3 1  ON 57
ci_059                -5.510689e-04 3 1  ON 58
ci_060                -7.599351e-04 3 1  ON 59
ci_061                -5.114957e-05 3 1  ON 60
ci_062                -9.209648e-04 3 1  ON 61
ci_063                -8.861051e-04 3 1  ON 62
ci_064                -5.242830e-04 3 1  ON 63
ci_065                -1.359760e-03 3 1  ON 64
ci_066                -1.883810e-03 3 1  ON 65
ci_067                -1.812714e-03 3 1  ON 66
ci_068                -1.557059e-03 3 1  ON 67
ci_069                -5.540858e-04 3 1  ON 68
ci_070                -4.262485e-04 3 1  ON 69
ci_071                -2.088192e-03 3 1  ON 70
ci_072                -2.001147e-03 3 1  ON 71
ci_073                 1.611407e-04 3 1  ON 72
ci_074                 1.977604e-04 3 1  ON 73
ci_075                 1.616493e-04 3 1  ON 74
ci_076                 7.851829e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.6435
    reference variance = 0.346439
====================================================
  Execution time = 2.5314e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5109e-01
  Total weights = 1.9553e+06
  Execution time = 3.6252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465056975
                                         uncertainty =       0.002313516276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465056975
                                         uncertainty =       0.002313516276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469868414
  error estimate for blocks of size 2^( 2) =       0.000493829828
  error estimate for blocks of size 2^( 3) =       0.000515982220
  error estimate for blocks of size 2^( 4) =       0.000531431130
  error estimate for blocks of size 2^( 5) =       0.000540953926
  error estimate for blocks of size 2^( 6) =       0.000544591918
  error estimate for blocks of size 2^( 7) =       0.000546005185

      target function =      -0.744425882679
              le_mean =     -22.662321483928
             les_mean =     514.031904463647
             stat err =       0.000540745540
             autocorr =       1.324443355177
   target nu stat err =       0.000540745540
   target dn stat err =       0.002688461767
      target stat err =       0.002279668336
              std dev =       0.664494283718
             le_variance =       0.441552653093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465040368
                                         uncertainty =       0.002313517118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465040368
                                         uncertainty =       0.002313517118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469868405
  error estimate for blocks of size 2^( 2) =       0.000493829822
  error estimate for blocks of size 2^( 3) =       0.000515982215
  error estimate for blocks of size 2^( 4) =       0.000531431124
  error estimate for blocks of size 2^( 5) =       0.000540953921
  error estimate for blocks of size 2^( 6) =       0.000544591913
  error estimate for blocks of size 2^( 7) =       0.000546005179

      target function =      -0.744425943478
              le_mean =     -22.662321483680
             les_mean =     514.031904378136
             stat err =       0.000540745534
             autocorr =       1.324443377909
   target nu stat err =       0.000540745534
   target dn stat err =       0.002688463197
      target stat err =       0.002279669824
              std dev =       0.664494271206
             le_variance =       0.441552636465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465048671
                                         uncertainty =       0.002313516697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465048671
                                         uncertainty =       0.002313516697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469868410
  error estimate for blocks of size 2^( 2) =       0.000493829825
  error estimate for blocks of size 2^( 3) =       0.000515982217
  error estimate for blocks of size 2^( 4) =       0.000531431127
  error estimate for blocks of size 2^( 5) =       0.000540953924
  error estimate for blocks of size 2^( 6) =       0.000544591915
  error estimate for blocks of size 2^( 7) =       0.000546005182

      target function =      -0.744425913093
              le_mean =     -22.662321483804
             les_mean =     514.031904420873
             stat err =       0.000540745537
             autocorr =       1.324443366539
   target nu stat err =       0.000540745537
   target dn stat err =       0.002688462482
      target stat err =       0.002279669080
              std dev =       0.664494277462
             le_variance =       0.441552644779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465055937
                                         uncertainty =       0.002313516329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441465055937
                                         uncertainty =       0.002313516329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469868414
  error estimate for blocks of size 2^( 2) =       0.000493829828
  error estimate for blocks of size 2^( 3) =       0.000515982220
  error estimate for blocks of size 2^( 4) =       0.000531431129
  error estimate for blocks of size 2^( 5) =       0.000540953926
  error estimate for blocks of size 2^( 6) =       0.000544591918
  error estimate for blocks of size 2^( 7) =       0.000546005184

      target function =      -0.744425886482
              le_mean =     -22.662321483912
             les_mean =     514.031904458299
             stat err =       0.000540745539
             autocorr =       1.324443356592
   target nu stat err =       0.000540745539
   target dn stat err =       0.002688461856
      target stat err =       0.002279668429
              std dev =       0.664494282935
             le_variance =       0.441552652054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744425882679        initial
     2.3283e+03     2.3283e+04             9.0834e-08        -0.744425943478  <--
     9.3132e+03     9.3132e+04             2.2709e-08        -0.744425913093
     3.7253e+04     3.7253e+05             5.6772e-09        -0.744425886482

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 4.3531e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_001                -7.055860e-01 3 1  ON 0
ci_002                -7.029015e-01 3 1  ON 1
ci_003                -5.013089e-02 3 1  ON 2
ci_004                -5.100231e-02 3 1  ON 3
ci_005                 1.949591e-02 3 1  ON 4
ci_006                 1.981733e-02 3 1  ON 5
ci_007                 1.474630e-02 3 1  ON 6
ci_008                 1.554104e-02 3 1  ON 7
ci_009                -1.320227e-02 3 1  ON 8
ci_010                -1.208036e-02 3 1  ON 9
ci_011                -9.910917e-03 3 1  ON 10
ci_012                -9.099468e-03 3 1  ON 11
ci_013                 8.349808e-03 3 1  ON 12
ci_014                 9.370051e-03 3 1  ON 13
ci_015                 9.520265e-03 3 1  ON 14
ci_016                 9.413170e-03 3 1  ON 15
ci_017                 8.493933e-03 3 1  ON 16
ci_018                 8.287048e-03 3 1  ON 17
ci_019                -1.221830e-03 3 1  ON 18
ci_020                -1.534818e-03 3 1  ON 19
ci_021                -1.177670e-02 3 1  ON 20
ci_022                -1.179815e-02 3 1  ON 21
ci_023                 4.854100e-03 3 1  ON 22
ci_024                 4.919485e-03 3 1  ON 23
ci_025                 1.143521e-02 3 1  ON 24
ci_026                 1.147189e-02 3 1  ON 25
ci_027                 6.467170e-03 3 1  ON 26
ci_028                 6.188126e-03 3 1  ON 27
ci_029                -5.082684e-03 3 1  ON 28
ci_030                -4.170353e-03 3 1  ON 29
ci_031                 3.328478e-03 3 1  ON 30
ci_032                 4.542714e-03 3 1  ON 31
ci_033                 2.363050e-03 3 1  ON 32
ci_034                 4.136082e-03 3 1  ON 33
ci_035                 1.723450e-03 3 1  ON 34
ci_036                 2.153775e-03 3 1  ON 35
ci_037                 3.539064e-03 3 1  ON 36
ci_038                 3.699975e-03 3 1  ON 37
ci_039                 4.622607e-03 3 1  ON 38
ci_040                 4.935100e-03 3 1  ON 39
ci_041                 2.971045e-03 3 1  ON 40
ci_042                 2.733712e-03 3 1  ON 41
ci_043                 2.944863e-03 3 1  ON 42
ci_044                 3.188783e-03 3 1  ON 43
ci_045                 2.451504e-03 3 1  ON 44
ci_046                 2.721069e-03 3 1  ON 45
ci_047                -1.002426e-03 3 1  ON 46
ci_048                -8.335710e-04 3 1  ON 47
ci_049                 7.785613e-04 3 1  ON 48
ci_050                 9.957367e-04 3 1  ON 49
ci_051                -3.145643e-04 3 1  ON 50
ci_052                -1.210776e-03 3 1  ON 51
ci_053                -2.433986e-03 3 1  ON 52
ci_054                -2.689551e-03 3 1  ON 53
ci_055                -1.798838e-03 3 1  ON 54
ci_056                -1.928939e-03 3 1  ON 55
ci_057                -1.307233e-03 3 1  ON 56
ci_058                -9.883905e-04 3 1  ON 57
ci_059                -5.510748e-04 3 1  ON 58
ci_060                -7.599175e-04 3 1  ON 59
ci_061                -5.114907e-05 3 1  ON 60
ci_062                -9.209707e-04 3 1  ON 61
ci_063                -8.861187e-04 3 1  ON 62
ci_064                -5.242916e-04 3 1  ON 63
ci_065                -1.359774e-03 3 1  ON 64
ci_066                -1.883792e-03 3 1  ON 65
ci_067                -1.812709e-03 3 1  ON 66
ci_068                -1.557045e-03 3 1  ON 67
ci_069                -5.540780e-04 3 1  ON 68
ci_070                -4.262369e-04 3 1  ON 69
ci_071                -2.088196e-03 3 1  ON 70
ci_072                -2.001123e-03 3 1  ON 71
ci_073                 1.611310e-04 3 1  ON 72
ci_074                 1.977565e-04 3 1  ON 73
ci_075                 1.616682e-04 3 1  ON 74
ci_076                 7.851808e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.7034
    reference variance = 0.382521
====================================================
  Execution time = 2.7848e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4544e-01
  Total weights = 1.955082910e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437141433078
                                         uncertainty =       0.001765015523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437141433078
                                         uncertainty =       0.001765015523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467506835
  error estimate for blocks of size 2^( 2) =       0.000491605769
  error estimate for blocks of size 2^( 3) =       0.000513284909
  error estimate for blocks of size 2^( 4) =       0.000528619443
  error estimate for blocks of size 2^( 5) =       0.000537299980
  error estimate for blocks of size 2^( 6) =       0.000541359349
  error estimate for blocks of size 2^( 7) =       0.000545891757

      target function =      -0.749084205828
              le_mean =     -22.662487681306
             les_mean =     514.033787245943
             stat err =       0.000538292632
             autocorr =       1.325747878732
   target nu stat err =       0.000538292632
   target dn stat err =       0.002309452221
      target stat err =       0.002005246966
              std dev =       0.661154507087
             le_variance =       0.437125282242


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266248768131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749088601171       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749088627051       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749088632020       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749088632560       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749088632606       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749088632639       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749088632612       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749088632594       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749088632605       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749088632617       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749088632631       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+02 is 3.005408e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749088601171       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749088607641       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749088608884       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749088609019       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749088609033       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749088609038       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749088609033       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749088609027       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749088609032       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749088609029       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749088609036       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 7.513898e-08

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749088601171       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749088602789       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749088603099       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749088603133       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749088603126       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749088603147       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749088603120       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749088603118       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749088603136       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749088603117       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749088603153       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+03 is 1.878498e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163135 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2574e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_001                -7.055859e-01 3 1  ON 0
ci_002                -7.029016e-01 3 1  ON 1
ci_003                -5.013087e-02 3 1  ON 2
ci_004                -5.100231e-02 3 1  ON 3
ci_005                 1.949587e-02 3 1  ON 4
ci_006                 1.981732e-02 3 1  ON 5
ci_007                 1.474627e-02 3 1  ON 6
ci_008                 1.554100e-02 3 1  ON 7
ci_009                -1.320224e-02 3 1  ON 8
ci_010                -1.208030e-02 3 1  ON 9
ci_011                -9.910868e-03 3 1  ON 10
ci_012                -9.099437e-03 3 1  ON 11
ci_013                 8.349775e-03 3 1  ON 12
ci_014                 9.370053e-03 3 1  ON 13
ci_015                 9.520239e-03 3 1  ON 14
ci_016                 9.413134e-03 3 1  ON 15
ci_017                 8.493945e-03 3 1  ON 16
ci_018                 8.287025e-03 3 1  ON 17
ci_019                -1.221903e-03 3 1  ON 18
ci_020                -1.534893e-03 3 1  ON 19
ci_021                -1.177668e-02 3 1  ON 20
ci_022                -1.179821e-02 3 1  ON 21
ci_023                 4.854095e-03 3 1  ON 22
ci_024                 4.919479e-03 3 1  ON 23
ci_025                 1.143526e-02 3 1  ON 24
ci_026                 1.147193e-02 3 1  ON 25
ci_027                 6.467170e-03 3 1  ON 26
ci_028                 6.188136e-03 3 1  ON 27
ci_029                -5.082679e-03 3 1  ON 28
ci_030                -4.170329e-03 3 1  ON 29
ci_031                 3.328525e-03 3 1  ON 30
ci_032                 4.542731e-03 3 1  ON 31
ci_033                 2.363060e-03 3 1  ON 32
ci_034                 4.136093e-03 3 1  ON 33
ci_035                 1.723474e-03 3 1  ON 34
ci_036                 2.153760e-03 3 1  ON 35
ci_037                 3.539064e-03 3 1  ON 36
ci_038                 3.699951e-03 3 1  ON 37
ci_039                 4.622596e-03 3 1  ON 38
ci_040                 4.935073e-03 3 1  ON 39
ci_041                 2.971048e-03 3 1  ON 40
ci_042                 2.733729e-03 3 1  ON 41
ci_043                 2.944836e-03 3 1  ON 42
ci_044                 3.188770e-03 3 1  ON 43
ci_045                 2.451512e-03 3 1  ON 44
ci_046                 2.721057e-03 3 1  ON 45
ci_047                -1.002420e-03 3 1  ON 46
ci_048                -8.335828e-04 3 1  ON 47
ci_049                 7.785688e-04 3 1  ON 48
ci_050                 9.957236e-04 3 1  ON 49
ci_051                -3.145780e-04 3 1  ON 50
ci_052                -1.210768e-03 3 1  ON 51
ci_053                -2.433970e-03 3 1  ON 52
ci_054                -2.689537e-03 3 1  ON 53
ci_055                -1.798856e-03 3 1  ON 54
ci_056                -1.928937e-03 3 1  ON 55
ci_057                -1.307249e-03 3 1  ON 56
ci_058                -9.884000e-04 3 1  ON 57
ci_059                -5.510876e-04 3 1  ON 58
ci_060                -7.599110e-04 3 1  ON 59
ci_061                -5.113108e-05 3 1  ON 60
ci_062                -9.209478e-04 3 1  ON 61
ci_063                -8.861166e-04 3 1  ON 62
ci_064                -5.242863e-04 3 1  ON 63
ci_065                -1.359760e-03 3 1  ON 64
ci_066                -1.883765e-03 3 1  ON 65
ci_067                -1.812698e-03 3 1  ON 66
ci_068                -1.557020e-03 3 1  ON 67
ci_069                -5.540771e-04 3 1  ON 68
ci_070                -4.262226e-04 3 1  ON 69
ci_071                -2.088176e-03 3 1  ON 70
ci_072                -2.001122e-03 3 1  ON 71
ci_073                 1.611405e-04 3 1  ON 72
ci_074                 1.977468e-04 3 1  ON 73
ci_075                 1.616817e-04 3 1  ON 74
ci_076                 7.851697e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.693
    reference variance = 0.377843
====================================================
  Execution time = 2.5084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5522e-01
  Total weights = 1.9551e+06
  Execution time = 3.6160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443194779275
                                         uncertainty =       0.003486917687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443194779275
                                         uncertainty =       0.003486917687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470700514
  error estimate for blocks of size 2^( 2) =       0.000494830167
  error estimate for blocks of size 2^( 3) =       0.000517509187
  error estimate for blocks of size 2^( 4) =       0.000533882781
  error estimate for blocks of size 2^( 5) =       0.000544258854
  error estimate for blocks of size 2^( 6) =       0.000548992985
  error estimate for blocks of size 2^( 7) =       0.000546787896

      target function =      -0.741048827608
              le_mean =     -22.662463700000
             les_mean =     514.042481523918
             stat err =       0.000543480629
             autocorr =       1.333149316372
   target nu stat err =       0.000543480629
   target dn stat err =       0.004424731902
      target stat err =       0.003639050443
              std dev =       0.665671050134
             le_variance =       0.443117946987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443194620470
                                         uncertainty =       0.003486916360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443194620470
                                         uncertainty =       0.003486916360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470700429
  error estimate for blocks of size 2^( 2) =       0.000494830094
  error estimate for blocks of size 2^( 3) =       0.000517509122
  error estimate for blocks of size 2^( 4) =       0.000533882720
  error estimate for blocks of size 2^( 5) =       0.000544258801
  error estimate for blocks of size 2^( 6) =       0.000548992926
  error estimate for blocks of size 2^( 7) =       0.000546787830

      target function =      -0.741048948726
              le_mean =     -22.662463701048
             les_mean =     514.042481423329
             stat err =       0.000543480569
             autocorr =       1.333149501277
   target nu stat err =       0.000543480569
   target dn stat err =       0.004424608842
      target stat err =       0.003638953105
              std dev =       0.665670931077
             le_variance =       0.443117788481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443194699866
                                         uncertainty =       0.003486917024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443194699866
                                         uncertainty =       0.003486917024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470700471
  error estimate for blocks of size 2^( 2) =       0.000494830130
  error estimate for blocks of size 2^( 3) =       0.000517509154
  error estimate for blocks of size 2^( 4) =       0.000533882751
  error estimate for blocks of size 2^( 5) =       0.000544258828
  error estimate for blocks of size 2^( 6) =       0.000548992956
  error estimate for blocks of size 2^( 7) =       0.000546787863

      target function =      -0.741048889398
              le_mean =     -22.662463700524
             les_mean =     514.042481472093
             stat err =       0.000543480599
             autocorr =       1.333149408825
   target nu stat err =       0.000543480599
   target dn stat err =       0.004424670359
      target stat err =       0.003639001775
              std dev =       0.665670990601
             le_variance =       0.443117867728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443194769349
                                         uncertainty =       0.003486917604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443194769349
                                         uncertainty =       0.003486917604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470700508
  error estimate for blocks of size 2^( 2) =       0.000494830162
  error estimate for blocks of size 2^( 3) =       0.000517509183
  error estimate for blocks of size 2^( 4) =       0.000533882777
  error estimate for blocks of size 2^( 5) =       0.000544258851
  error estimate for blocks of size 2^( 6) =       0.000548992981
  error estimate for blocks of size 2^( 7) =       0.000546787892

      target function =      -0.741048835464
              le_mean =     -22.662463700065
             les_mean =     514.042481517275
             stat err =       0.000543480625
             autocorr =       1.333149327938
   target nu stat err =       0.000543480625
   target dn stat err =       0.004424724208
      target stat err =       0.003639044360
              std dev =       0.665671042692
             le_variance =       0.443117937079


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741048827608        initial
     5.8208e+02     5.8208e+03             3.0054e-07        -0.741048948726  <--
     2.3283e+03     2.3283e+04             7.5139e-08        -0.741048889398
     9.3132e+03     9.3132e+04             1.8785e-08        -0.741048835464

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 4.6085e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_001                -7.055858e-01 3 1  ON 0
ci_002                -7.029017e-01 3 1  ON 1
ci_003                -5.013080e-02 3 1  ON 2
ci_004                -5.100228e-02 3 1  ON 3
ci_005                 1.949577e-02 3 1  ON 4
ci_006                 1.981726e-02 3 1  ON 5
ci_007                 1.474619e-02 3 1  ON 6
ci_008                 1.554088e-02 3 1  ON 7
ci_009                -1.320217e-02 3 1  ON 8
ci_010                -1.208011e-02 3 1  ON 9
ci_011                -9.910720e-03 3 1  ON 10
ci_012                -9.099343e-03 3 1  ON 11
ci_013                 8.349674e-03 3 1  ON 12
ci_014                 9.370059e-03 3 1  ON 13
ci_015                 9.520162e-03 3 1  ON 14
ci_016                 9.413025e-03 3 1  ON 15
ci_017                 8.493980e-03 3 1  ON 16
ci_018                 8.286955e-03 3 1  ON 17
ci_019                -1.222120e-03 3 1  ON 18
ci_020                -1.535118e-03 3 1  ON 19
ci_021                -1.177662e-02 3 1  ON 20
ci_022                -1.179840e-02 3 1  ON 21
ci_023                 4.854080e-03 3 1  ON 22
ci_024                 4.919463e-03 3 1  ON 23
ci_025                 1.143541e-02 3 1  ON 24
ci_026                 1.147204e-02 3 1  ON 25
ci_027                 6.467171e-03 3 1  ON 26
ci_028                 6.188167e-03 3 1  ON 27
ci_029                -5.082662e-03 3 1  ON 28
ci_030                -4.170256e-03 3 1  ON 29
ci_031                 3.328668e-03 3 1  ON 30
ci_032                 4.542784e-03 3 1  ON 31
ci_033                 2.363090e-03 3 1  ON 32
ci_034                 4.136126e-03 3 1  ON 33
ci_035                 1.723546e-03 3 1  ON 34
ci_036                 2.153717e-03 3 1  ON 35
ci_037                 3.539061e-03 3 1  ON 36
ci_038                 3.699877e-03 3 1  ON 37
ci_039                 4.622561e-03 3 1  ON 38
ci_040                 4.934990e-03 3 1  ON 39
ci_041                 2.971058e-03 3 1  ON 40
ci_042                 2.733780e-03 3 1  ON 41
ci_043                 2.944754e-03 3 1  ON 42
ci_044                 3.188733e-03 3 1  ON 43
ci_045                 2.451537e-03 3 1  ON 44
ci_046                 2.721020e-03 3 1  ON 45
ci_047                -1.002403e-03 3 1  ON 46
ci_048                -8.336182e-04 3 1  ON 47
ci_049                 7.785910e-04 3 1  ON 48
ci_050                 9.956842e-04 3 1  ON 49
ci_051                -3.146190e-04 3 1  ON 50
ci_052                -1.210743e-03 3 1  ON 51
ci_053                -2.433923e-03 3 1  ON 52
ci_054                -2.689496e-03 3 1  ON 53
ci_055                -1.798910e-03 3 1  ON 54
ci_056                -1.928933e-03 3 1  ON 55
ci_057                -1.307296e-03 3 1  ON 56
ci_058                -9.884285e-04 3 1  ON 57
ci_059                -5.511260e-04 3 1  ON 58
ci_060                -7.598914e-04 3 1  ON 59
ci_061                -5.107712e-05 3 1  ON 60
ci_062                -9.208792e-04 3 1  ON 61
ci_063                -8.861101e-04 3 1  ON 62
ci_064                -5.242705e-04 3 1  ON 63
ci_065                -1.359717e-03 3 1  ON 64
ci_066                -1.883686e-03 3 1  ON 65
ci_067                -1.812665e-03 3 1  ON 66
ci_068                -1.556944e-03 3 1  ON 67
ci_069                -5.540743e-04 3 1  ON 68
ci_070                -4.261796e-04 3 1  ON 69
ci_071                -2.088115e-03 3 1  ON 70
ci_072                -2.001117e-03 3 1  ON 71
ci_073                 1.611692e-04 3 1  ON 72
ci_074                 1.977180e-04 3 1  ON 73
ci_075                 1.617221e-04 3 1  ON 74
ci_076                 7.851365e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8666e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7038
    reference variance = 0.451899
====================================================
  Execution time = 2.6056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4568e-01
  Total weights = 1.955317901e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437344712018
                                         uncertainty =       0.002086827126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437344712018
                                         uncertainty =       0.002086827126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467600738
  error estimate for blocks of size 2^( 2) =       0.000491558355
  error estimate for blocks of size 2^( 3) =       0.000513809681
  error estimate for blocks of size 2^( 4) =       0.000528456919
  error estimate for blocks of size 2^( 5) =       0.000538849010
  error estimate for blocks of size 2^( 6) =       0.000543466295
  error estimate for blocks of size 2^( 7) =       0.000547842030

      target function =      -0.748875742704
              le_mean =     -22.661829051633
             les_mean =     514.004174336344
             stat err =       0.000539653564
             autocorr =       1.331924852308
   target nu stat err =       0.000539653564
   target dn stat err =       0.002305728326
      target stat err =       0.001999736906
              std dev =       0.661287305515
             le_variance =       0.437300900435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266182905163e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748880127389       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748880211908       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748880227081       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748880228257       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748880228014       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748880228288       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748880228284       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748880228169       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748880228209       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748880228230       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+02 is 1.572810e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748880127389       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748880148524       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748880152317       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748880152612       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748880152551       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748880152619       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748880152618       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748880152590       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748880152599       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748880152605       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+02 is 3.932797e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748880127389       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748880132673       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748880133621       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748880133695       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748880133682       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748880133702       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748880133696       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748880133689       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748880133694       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748880133691       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 9.832476e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0790e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_001                -7.055858e-01 3 1  ON 0
ci_002                -7.029018e-01 3 1  ON 1
ci_003                -5.013078e-02 3 1  ON 2
ci_004                -5.100222e-02 3 1  ON 3
ci_005                 1.949577e-02 3 1  ON 4
ci_006                 1.981707e-02 3 1  ON 5
ci_007                 1.474611e-02 3 1  ON 6
ci_008                 1.554083e-02 3 1  ON 7
ci_009                -1.320186e-02 3 1  ON 8
ci_010                -1.208006e-02 3 1  ON 9
ci_011                -9.910651e-03 3 1  ON 10
ci_012                -9.099180e-03 3 1  ON 11
ci_013                 8.349641e-03 3 1  ON 12
ci_014                 9.369873e-03 3 1  ON 13
ci_015                 9.520002e-03 3 1  ON 14
ci_016                 9.412971e-03 3 1  ON 15
ci_017                 8.493966e-03 3 1  ON 16
ci_018                 8.286845e-03 3 1  ON 17
ci_019                -1.222513e-03 3 1  ON 18
ci_020                -1.535243e-03 3 1  ON 19
ci_021                -1.177670e-02 3 1  ON 20
ci_022                -1.179859e-02 3 1  ON 21
ci_023                 4.854094e-03 3 1  ON 22
ci_024                 4.919455e-03 3 1  ON 23
ci_025                 1.143559e-02 3 1  ON 24
ci_026                 1.147213e-02 3 1  ON 25
ci_027                 6.467121e-03 3 1  ON 26
ci_028                 6.188211e-03 3 1  ON 27
ci_029                -5.082456e-03 3 1  ON 28
ci_030                -4.170165e-03 3 1  ON 29
ci_031                 3.328898e-03 3 1  ON 30
ci_032                 4.542916e-03 3 1  ON 31
ci_033                 2.363182e-03 3 1  ON 32
ci_034                 4.136194e-03 3 1  ON 33
ci_035                 1.723593e-03 3 1  ON 34
ci_036                 2.153691e-03 3 1  ON 35
ci_037                 3.539102e-03 3 1  ON 36
ci_038                 3.699883e-03 3 1  ON 37
ci_039                 4.622547e-03 3 1  ON 38
ci_040                 4.935141e-03 3 1  ON 39
ci_041                 2.971103e-03 3 1  ON 40
ci_042                 2.733784e-03 3 1  ON 41
ci_043                 2.944708e-03 3 1  ON 42
ci_044                 3.188641e-03 3 1  ON 43
ci_045                 2.451506e-03 3 1  ON 44
ci_046                 2.721009e-03 3 1  ON 45
ci_047                -1.002385e-03 3 1  ON 46
ci_048                -8.336732e-04 3 1  ON 47
ci_049                 7.785779e-04 3 1  ON 48
ci_050                 9.956874e-04 3 1  ON 49
ci_051                -3.146623e-04 3 1  ON 50
ci_052                -1.210666e-03 3 1  ON 51
ci_053                -2.433931e-03 3 1  ON 52
ci_054                -2.689527e-03 3 1  ON 53
ci_055                -1.798918e-03 3 1  ON 54
ci_056                -1.928842e-03 3 1  ON 55
ci_057                -1.307314e-03 3 1  ON 56
ci_058                -9.884029e-04 3 1  ON 57
ci_059                -5.510174e-04 3 1  ON 58
ci_060                -7.599017e-04 3 1  ON 59
ci_061                -5.109695e-05 3 1  ON 60
ci_062                -9.208539e-04 3 1  ON 61
ci_063                -8.861041e-04 3 1  ON 62
ci_064                -5.243162e-04 3 1  ON 63
ci_065                -1.359633e-03 3 1  ON 64
ci_066                -1.883755e-03 3 1  ON 65
ci_067                -1.812678e-03 3 1  ON 66
ci_068                -1.556914e-03 3 1  ON 67
ci_069                -5.541671e-04 3 1  ON 68
ci_070                -4.261756e-04 3 1  ON 69
ci_071                -2.088050e-03 3 1  ON 70
ci_072                -2.001060e-03 3 1  ON 71
ci_073                 1.611686e-04 3 1  ON 72
ci_074                 1.977102e-04 3 1  ON 73
ci_075                 1.617465e-04 3 1  ON 74
ci_076                 7.851076e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.656
    reference variance = 0.482132
====================================================
  Execution time = 2.5257e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5755e-01
  Total weights = 1.9556e+06
  Execution time = 3.6200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448062510238
                                         uncertainty =       0.004263078213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448062510238
                                         uncertainty =       0.004263078213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473318274
  error estimate for blocks of size 2^( 2) =       0.000497402401
  error estimate for blocks of size 2^( 3) =       0.000519258475
  error estimate for blocks of size 2^( 4) =       0.000535322132
  error estimate for blocks of size 2^( 5) =       0.000544795639
  error estimate for blocks of size 2^( 6) =       0.000551097348
  error estimate for blocks of size 2^( 7) =       0.000551070963

      target function =      -0.739158315914
              le_mean =     -22.661759018110
             les_mean =     514.012873976126
             stat err =       0.000545571521
             autocorr =       1.328607925613
   target nu stat err =       0.000545571521
   target dn stat err =       0.004769825975
      target stat err =       0.003892134640
              std dev =       0.669373122605
             le_variance =       0.448060377265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448062115141
                                         uncertainty =       0.004263034752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448062115141
                                         uncertainty =       0.004263034752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473318066
  error estimate for blocks of size 2^( 2) =       0.000497402221
  error estimate for blocks of size 2^( 3) =       0.000519258313
  error estimate for blocks of size 2^( 4) =       0.000535321983
  error estimate for blocks of size 2^( 5) =       0.000544795494
  error estimate for blocks of size 2^( 6) =       0.000551097202
  error estimate for blocks of size 2^( 7) =       0.000551070858

      target function =      -0.739159173884
              le_mean =     -22.661759019425
             les_mean =     514.012872973081
             stat err =       0.000545571384
             autocorr =       1.328608431514
   target nu stat err =       0.000545571384
   target dn stat err =       0.004769695963
      target stat err =       0.003892039942
              std dev =       0.669372827869
             le_variance =       0.448059982689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448062312619
                                         uncertainty =       0.004263056477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448062312619
                                         uncertainty =       0.004263056477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473318170
  error estimate for blocks of size 2^( 2) =       0.000497402311
  error estimate for blocks of size 2^( 3) =       0.000519258394
  error estimate for blocks of size 2^( 4) =       0.000535322058
  error estimate for blocks of size 2^( 5) =       0.000544795567
  error estimate for blocks of size 2^( 6) =       0.000551097275
  error estimate for blocks of size 2^( 7) =       0.000551070911

      target function =      -0.739158746095
              le_mean =     -22.661759018764
             les_mean =     514.012873472962
             stat err =       0.000545571452
             autocorr =       1.328608178625
   target nu stat err =       0.000545571452
   target dn stat err =       0.004769760915
      target stat err =       0.003892087260
              std dev =       0.669372975185
             le_variance =       0.448060179908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448062485531
                                         uncertainty =       0.004263075496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448062485531
                                         uncertainty =       0.004263075496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473318261
  error estimate for blocks of size 2^( 2) =       0.000497402390
  error estimate for blocks of size 2^( 3) =       0.000519258465
  error estimate for blocks of size 2^( 4) =       0.000535322123
  error estimate for blocks of size 2^( 5) =       0.000544795630
  error estimate for blocks of size 2^( 6) =       0.000551097339
  error estimate for blocks of size 2^( 7) =       0.000551070956

      target function =      -0.739158369809
              le_mean =     -22.661759018191
             les_mean =     514.012873913062
             stat err =       0.000545571512
             autocorr =       1.328607957241
   target nu stat err =       0.000545571512
   target dn stat err =       0.004769817838
      target stat err =       0.003892128715
              std dev =       0.669373104174
             le_variance =       0.448060352591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739158315914        initial
     1.4552e+02     1.4552e+03             1.5728e-06        -0.739159173884  <--
     5.8208e+02     5.8208e+03             3.9328e-07        -0.739158746095
     2.3283e+03     2.3283e+04             9.8325e-08        -0.739158369809

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 4.3417e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_001                -7.055856e-01 3 1  ON 0
ci_002                -7.029020e-01 3 1  ON 1
ci_003                -5.013073e-02 3 1  ON 2
ci_004                -5.100204e-02 3 1  ON 3
ci_005                 1.949577e-02 3 1  ON 4
ci_006                 1.981652e-02 3 1  ON 5
ci_007                 1.474588e-02 3 1  ON 6
ci_008                 1.554066e-02 3 1  ON 7
ci_009                -1.320095e-02 3 1  ON 8
ci_010                -1.207991e-02 3 1  ON 9
ci_011                -9.910444e-03 3 1  ON 10
ci_012                -9.098693e-03 3 1  ON 11
ci_013                 8.349542e-03 3 1  ON 12
ci_014                 9.369314e-03 3 1  ON 13
ci_015                 9.519524e-03 3 1  ON 14
ci_016                 9.412809e-03 3 1  ON 15
ci_017                 8.493925e-03 3 1  ON 16
ci_018                 8.286516e-03 3 1  ON 17
ci_019                -1.223693e-03 3 1  ON 18
ci_020                -1.535616e-03 3 1  ON 19
ci_021                -1.177696e-02 3 1  ON 20
ci_022                -1.179916e-02 3 1  ON 21
ci_023                 4.854135e-03 3 1  ON 22
ci_024                 4.919429e-03 3 1  ON 23
ci_025                 1.143611e-02 3 1  ON 24
ci_026                 1.147242e-02 3 1  ON 25
ci_027                 6.466974e-03 3 1  ON 26
ci_028                 6.188342e-03 3 1  ON 27
ci_029                -5.081837e-03 3 1  ON 28
ci_030                -4.169895e-03 3 1  ON 29
ci_031                 3.329588e-03 3 1  ON 30
ci_032                 4.543311e-03 3 1  ON 31
ci_033                 2.363459e-03 3 1  ON 32
ci_034                 4.136398e-03 3 1  ON 33
ci_035                 1.723732e-03 3 1  ON 34
ci_036                 2.153612e-03 3 1  ON 35
ci_037                 3.539226e-03 3 1  ON 36
ci_038                 3.699900e-03 3 1  ON 37
ci_039                 4.622506e-03 3 1  ON 38
ci_040                 4.935595e-03 3 1  ON 39
ci_041                 2.971235e-03 3 1  ON 40
ci_042                 2.733797e-03 3 1  ON 41
ci_043                 2.944573e-03 3 1  ON 42
ci_044                 3.188364e-03 3 1  ON 43
ci_045                 2.451413e-03 3 1  ON 44
ci_046                 2.720974e-03 3 1  ON 45
ci_047                -1.002333e-03 3 1  ON 46
ci_048                -8.338384e-04 3 1  ON 47
ci_049                 7.785384e-04 3 1  ON 48
ci_050                 9.956968e-04 3 1  ON 49
ci_051                -3.147921e-04 3 1  ON 50
ci_052                -1.210438e-03 3 1  ON 51
ci_053                -2.433955e-03 3 1  ON 52
ci_054                -2.689620e-03 3 1  ON 53
ci_055                -1.798939e-03 3 1  ON 54
ci_056                -1.928570e-03 3 1  ON 55
ci_057                -1.307366e-03 3 1  ON 56
ci_058                -9.883262e-04 3 1  ON 57
ci_059                -5.506918e-04 3 1  ON 58
ci_060                -7.599326e-04 3 1  ON 59
ci_061                -5.115642e-05 3 1  ON 60
ci_062                -9.207778e-04 3 1  ON 61
ci_063                -8.860859e-04 3 1  ON 62
ci_064                -5.244532e-04 3 1  ON 63
ci_065                -1.359380e-03 3 1  ON 64
ci_066                -1.883962e-03 3 1  ON 65
ci_067                -1.812715e-03 3 1  ON 66
ci_068                -1.556822e-03 3 1  ON 67
ci_069                -5.544454e-04 3 1  ON 68
ci_070                -4.261636e-04 3 1  ON 69
ci_071                -2.087854e-03 3 1  ON 70
ci_072                -2.000890e-03 3 1  ON 71
ci_073                 1.611668e-04 3 1  ON 72
ci_074                 1.976868e-04 3 1  ON 73
ci_075                 1.618197e-04 3 1  ON 74
ci_076                 7.850209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4214e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6232
    reference variance = 0.32932
====================================================
  Execution time = 2.5821e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4879e-01
  Total weights = 1.955161134e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438915695329
                                         uncertainty =       0.002195011013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438915695329
                                         uncertainty =       0.002195011013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468449505
  error estimate for blocks of size 2^( 2) =       0.000492689329
  error estimate for blocks of size 2^( 3) =       0.000515486391
  error estimate for blocks of size 2^( 4) =       0.000532076962
  error estimate for blocks of size 2^( 5) =       0.000540662247
  error estimate for blocks of size 2^( 6) =       0.000545882766
  error estimate for blocks of size 2^( 7) =       0.000545854852

      target function =      -0.746314764554
              le_mean =     -22.662218987976
             les_mean =     514.024954887469
             stat err =       0.000541119207
             autocorr =       1.334321026100
   target nu stat err =       0.000541119207
   target dn stat err =       0.002834708534
      target stat err =       0.002406980767
              std dev =       0.662487643562
             le_variance =       0.438889877872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266221898798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746321579679       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746321939582       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746322013386       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746322020135       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746322021127       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746322020555       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746322020059       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746322020501       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746322020796       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746322020864       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746322020734       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+01 is 5.578693e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746321579679       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746321669741       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746321688201       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746321689888       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746321690136       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746321689993       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746321689869       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746321689979       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746321690053       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746321690070       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746321690038       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+02 is 1.395767e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746321579679       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746321602200       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746321606815       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746321607237       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746321607300       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746321607264       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746321607232       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746321607260       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746321607278       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746321607282       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746321607274       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+02 is 3.490101e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170901 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0528e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_001                -7.055850e-01 3 1  ON 0
ci_002                -7.029028e-01 3 1  ON 1
ci_003                -5.012999e-02 3 1  ON 2
ci_004                -5.100158e-02 3 1  ON 3
ci_005                 1.949520e-02 3 1  ON 4
ci_006                 1.981604e-02 3 1  ON 5
ci_007                 1.474570e-02 3 1  ON 6
ci_008                 1.554037e-02 3 1  ON 7
ci_009                -1.320030e-02 3 1  ON 8
ci_010                -1.207966e-02 3 1  ON 9
ci_011                -9.909556e-03 3 1  ON 10
ci_012                -9.098560e-03 3 1  ON 11
ci_013                 8.349004e-03 3 1  ON 12
ci_014                 9.368719e-03 3 1  ON 13
ci_015                 9.519253e-03 3 1  ON 14
ci_016                 9.412428e-03 3 1  ON 15
ci_017                 8.493276e-03 3 1  ON 16
ci_018                 8.286107e-03 3 1  ON 17
ci_019                -1.225089e-03 3 1  ON 18
ci_020                -1.536698e-03 3 1  ON 19
ci_021                -1.177692e-02 3 1  ON 20
ci_022                -1.179979e-02 3 1  ON 21
ci_023                 4.854096e-03 3 1  ON 22
ci_024                 4.919254e-03 3 1  ON 23
ci_025                 1.143696e-02 3 1  ON 24
ci_026                 1.147300e-02 3 1  ON 25
ci_027                 6.466918e-03 3 1  ON 26
ci_028                 6.188623e-03 3 1  ON 27
ci_029                -5.081545e-03 3 1  ON 28
ci_030                -4.169920e-03 3 1  ON 29
ci_031                 3.329868e-03 3 1  ON 30
ci_032                 4.544041e-03 3 1  ON 31
ci_033                 2.363732e-03 3 1  ON 32
ci_034                 4.135836e-03 3 1  ON 33
ci_035                 1.723782e-03 3 1  ON 34
ci_036                 2.153584e-03 3 1  ON 35
ci_037                 3.538919e-03 3 1  ON 36
ci_038                 3.699361e-03 3 1  ON 37
ci_039                 4.622315e-03 3 1  ON 38
ci_040                 4.935610e-03 3 1  ON 39
ci_041                 2.970855e-03 3 1  ON 40
ci_042                 2.733802e-03 3 1  ON 41
ci_043                 2.944509e-03 3 1  ON 42
ci_044                 3.188238e-03 3 1  ON 43
ci_045                 2.451505e-03 3 1  ON 44
ci_046                 2.720973e-03 3 1  ON 45
ci_047                -1.002034e-03 3 1  ON 46
ci_048                -8.337799e-04 3 1  ON 47
ci_049                 7.782800e-04 3 1  ON 48
ci_050                 9.957334e-04 3 1  ON 49
ci_051                -3.146291e-04 3 1  ON 50
ci_052                -1.210799e-03 3 1  ON 51
ci_053                -2.434416e-03 3 1  ON 52
ci_054                -2.689236e-03 3 1  ON 53
ci_055                -1.798689e-03 3 1  ON 54
ci_056                -1.928449e-03 3 1  ON 55
ci_057                -1.307224e-03 3 1  ON 56
ci_058                -9.881407e-04 3 1  ON 57
ci_059                -5.509015e-04 3 1  ON 58
ci_060                -7.597216e-04 3 1  ON 59
ci_061                -5.113379e-05 3 1  ON 60
ci_062                -9.202818e-04 3 1  ON 61
ci_063                -8.863116e-04 3 1  ON 62
ci_064                -5.240186e-04 3 1  ON 63
ci_065                -1.359313e-03 3 1  ON 64
ci_066                -1.883820e-03 3 1  ON 65
ci_067                -1.812825e-03 3 1  ON 66
ci_068                -1.557038e-03 3 1  ON 67
ci_069                -5.543176e-04 3 1  ON 68
ci_070                -4.262106e-04 3 1  ON 69
ci_071                -2.087984e-03 3 1  ON 70
ci_072                -2.000705e-03 3 1  ON 71
ci_073                 1.612867e-04 3 1  ON 72
ci_074                 1.977154e-04 3 1  ON 73
ci_075                 1.619868e-04 3 1  ON 74
ci_076                 7.851829e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.6809
    reference variance = 0.349699
====================================================
  Execution time = 2.5229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5692e-01
  Total weights = 1.9553e+06
  Execution time = 3.6127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446817835267
                                         uncertainty =       0.003237463846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446817835267
                                         uncertainty =       0.003237463846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472666689
  error estimate for blocks of size 2^( 2) =       0.000496241204
  error estimate for blocks of size 2^( 3) =       0.000518317919
  error estimate for blocks of size 2^( 4) =       0.000534167728
  error estimate for blocks of size 2^( 5) =       0.000544080085
  error estimate for blocks of size 2^( 6) =       0.000549658774
  error estimate for blocks of size 2^( 7) =       0.000553863601

      target function =      -0.739675449366
              le_mean =     -22.662875949620
             les_mean =     514.062868305999
             stat err =       0.000545442547
             autocorr =       1.331643675885
   target nu stat err =       0.000545442547
   target dn stat err =       0.003886520359
      target stat err =       0.003199687873
              std dev =       0.668451641922
             le_variance =       0.446827597588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446816543369
                                         uncertainty =       0.003237524745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446816543369
                                         uncertainty =       0.003237524745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472666005
  error estimate for blocks of size 2^( 2) =       0.000496240605
  error estimate for blocks of size 2^( 3) =       0.000518317412
  error estimate for blocks of size 2^( 4) =       0.000534167231
  error estimate for blocks of size 2^( 5) =       0.000544079721
  error estimate for blocks of size 2^( 6) =       0.000549658415
  error estimate for blocks of size 2^( 7) =       0.000553863339

      target function =      -0.739674497460
              le_mean =     -22.662875922213
             les_mean =     514.062868240915
             stat err =       0.000545442176
             autocorr =       1.331645720726
   target nu stat err =       0.000545442176
   target dn stat err =       0.003886487400
      target stat err =       0.003199653383
              std dev =       0.668450674344
             le_variance =       0.446826304031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446817188376
                                         uncertainty =       0.003237494300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446817188376
                                         uncertainty =       0.003237494300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472666346
  error estimate for blocks of size 2^( 2) =       0.000496240904
  error estimate for blocks of size 2^( 3) =       0.000518317665
  error estimate for blocks of size 2^( 4) =       0.000534167479
  error estimate for blocks of size 2^( 5) =       0.000544079902
  error estimate for blocks of size 2^( 6) =       0.000549658594
  error estimate for blocks of size 2^( 7) =       0.000553863470

      target function =      -0.739675464866
              le_mean =     -22.662875935813
             les_mean =     514.062867661158
             stat err =       0.000545442361
             autocorr =       1.331644699225
   target nu stat err =       0.000545442361
   target dn stat err =       0.003886503129
      target stat err =       0.003199674209
              std dev =       0.668451157428
             le_variance =       0.446826949867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446817754342
                                         uncertainty =       0.003237467652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446817754342
                                         uncertainty =       0.003237467652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472666646
  error estimate for blocks of size 2^( 2) =       0.000496241167
  error estimate for blocks of size 2^( 3) =       0.000518317888
  error estimate for blocks of size 2^( 4) =       0.000534167697
  error estimate for blocks of size 2^( 5) =       0.000544080062
  error estimate for blocks of size 2^( 6) =       0.000549658751
  error estimate for blocks of size 2^( 7) =       0.000553863585

      target function =      -0.739675476663
              le_mean =     -22.662875947885
             les_mean =     514.062868193622
             stat err =       0.000545442524
             autocorr =       1.331643803815
   target nu stat err =       0.000545442524
   target dn stat err =       0.003886518152
      target stat err =       0.003199686337
              std dev =       0.668451581312
             le_variance =       0.446827516559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739675449366        initial
     3.6380e+01     3.6380e+02             5.5787e-06        -0.739674497460
     1.4552e+02     1.4552e+03             1.3958e-06        -0.739675464866
     5.8208e+02     5.8208e+03             3.4901e-07        -0.739675476663  <--

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 4.3303e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_001                -7.055855e-01 3 1  ON 0
ci_002                -7.029022e-01 3 1  ON 1
ci_003                -5.013055e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949562e-02 3 1  ON 4
ci_006                 1.981640e-02 3 1  ON 5
ci_007                 1.474583e-02 3 1  ON 6
ci_008                 1.554059e-02 3 1  ON 7
ci_009                -1.320079e-02 3 1  ON 8
ci_010                -1.207985e-02 3 1  ON 9
ci_011                -9.910222e-03 3 1  ON 10
ci_012                -9.098660e-03 3 1  ON 11
ci_013                 8.349408e-03 3 1  ON 12
ci_014                 9.369165e-03 3 1  ON 13
ci_015                 9.519457e-03 3 1  ON 14
ci_016                 9.412714e-03 3 1  ON 15
ci_017                 8.493763e-03 3 1  ON 16
ci_018                 8.286414e-03 3 1  ON 17
ci_019                -1.224042e-03 3 1  ON 18
ci_020                -1.535887e-03 3 1  ON 19
ci_021                -1.177695e-02 3 1  ON 20
ci_022                -1.179932e-02 3 1  ON 21
ci_023                 4.854125e-03 3 1  ON 22
ci_024                 4.919385e-03 3 1  ON 23
ci_025                 1.143633e-02 3 1  ON 24
ci_026                 1.147257e-02 3 1  ON 25
ci_027                 6.466960e-03 3 1  ON 26
ci_028                 6.188412e-03 3 1  ON 27
ci_029                -5.081764e-03 3 1  ON 28
ci_030                -4.169901e-03 3 1  ON 29
ci_031                 3.329658e-03 3 1  ON 30
ci_032                 4.543494e-03 3 1  ON 31
ci_033                 2.363527e-03 3 1  ON 32
ci_034                 4.136258e-03 3 1  ON 33
ci_035                 1.723744e-03 3 1  ON 34
ci_036                 2.153605e-03 3 1  ON 35
ci_037                 3.539149e-03 3 1  ON 36
ci_038                 3.699765e-03 3 1  ON 37
ci_039                 4.622458e-03 3 1  ON 38
ci_040                 4.935599e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733798e-03 3 1  ON 41
ci_043                 2.944557e-03 3 1  ON 42
ci_044                 3.188333e-03 3 1  ON 43
ci_045                 2.451436e-03 3 1  ON 44
ci_046                 2.720974e-03 3 1  ON 45
ci_047                -1.002258e-03 3 1  ON 46
ci_048                -8.338238e-04 3 1  ON 47
ci_049                 7.784737e-04 3 1  ON 48
ci_050                 9.957060e-04 3 1  ON 49
ci_051                -3.147514e-04 3 1  ON 50
ci_052                -1.210528e-03 3 1  ON 51
ci_053                -2.434070e-03 3 1  ON 52
ci_054                -2.689524e-03 3 1  ON 53
ci_055                -1.798877e-03 3 1  ON 54
ci_056                -1.928539e-03 3 1  ON 55
ci_057                -1.307331e-03 3 1  ON 56
ci_058                -9.882798e-04 3 1  ON 57
ci_059                -5.507443e-04 3 1  ON 58
ci_060                -7.598798e-04 3 1  ON 59
ci_061                -5.115076e-05 3 1  ON 60
ci_062                -9.206538e-04 3 1  ON 61
ci_063                -8.861424e-04 3 1  ON 62
ci_064                -5.243445e-04 3 1  ON 63
ci_065                -1.359364e-03 3 1  ON 64
ci_066                -1.883926e-03 3 1  ON 65
ci_067                -1.812743e-03 3 1  ON 66
ci_068                -1.556876e-03 3 1  ON 67
ci_069                -5.544134e-04 3 1  ON 68
ci_070                -4.261753e-04 3 1  ON 69
ci_071                -2.087887e-03 3 1  ON 70
ci_072                -2.000844e-03 3 1  ON 71
ci_073                 1.611968e-04 3 1  ON 72
ci_074                 1.976939e-04 3 1  ON 73
ci_075                 1.618615e-04 3 1  ON 74
ci_076                 7.850614e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3838e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7183
    reference variance = 0.335401
====================================================
  Execution time = 2.5784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4861e-01
  Total weights = 1.955424652e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439343687133
                                         uncertainty =       0.002128864050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439343687133
                                         uncertainty =       0.002128864050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468689865
  error estimate for blocks of size 2^( 2) =       0.000492612271
  error estimate for blocks of size 2^( 3) =       0.000514678655
  error estimate for blocks of size 2^( 4) =       0.000530362361
  error estimate for blocks of size 2^( 5) =       0.000539971529
  error estimate for blocks of size 2^( 6) =       0.000545948537
  error estimate for blocks of size 2^( 7) =       0.000547071593

      target function =      -0.746464091857
              le_mean =     -22.662703364971
             les_mean =     514.046735664708
             stat err =       0.000540838505
             autocorr =       1.331570245426
   target nu stat err =       0.000540838505
   target dn stat err =       0.002664917396
      target stat err =       0.002274346820
              std dev =       0.662827563837
             le_variance =       0.439340379382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266270336497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746469995158       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746470097194       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746470110976       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746470113298       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746470114262       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746470114219       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746470114371       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746470114389       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746470114423       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+02 is 1.234733e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746469995158       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746470020673       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746470024119       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746470024700       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746470024941       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746470024930       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746470024968       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746470024972       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746470024979       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+02 is 3.087082e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746469995158       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746470001537       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746470002399       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746470002544       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746470002604       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746470002602       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746470002611       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746470002612       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746470002617       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+03 is 7.717861e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174030 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0518e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_001                -7.055855e-01 3 1  ON 0
ci_002                -7.029022e-01 3 1  ON 1
ci_003                -5.013024e-02 3 1  ON 2
ci_004                -5.100217e-02 3 1  ON 3
ci_005                 1.949552e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474583e-02 3 1  ON 6
ci_008                 1.554045e-02 3 1  ON 7
ci_009                -1.320060e-02 3 1  ON 8
ci_010                -1.207973e-02 3 1  ON 9
ci_011                -9.910079e-03 3 1  ON 10
ci_012                -9.098659e-03 3 1  ON 11
ci_013                 8.349169e-03 3 1  ON 12
ci_014                 9.368887e-03 3 1  ON 13
ci_015                 9.519275e-03 3 1  ON 14
ci_016                 9.412663e-03 3 1  ON 15
ci_017                 8.493763e-03 3 1  ON 16
ci_018                 8.286478e-03 3 1  ON 17
ci_019                -1.224057e-03 3 1  ON 18
ci_020                -1.536052e-03 3 1  ON 19
ci_021                -1.177715e-02 3 1  ON 20
ci_022                -1.179944e-02 3 1  ON 21
ci_023                 4.854156e-03 3 1  ON 22
ci_024                 4.919411e-03 3 1  ON 23
ci_025                 1.143655e-02 3 1  ON 24
ci_026                 1.147275e-02 3 1  ON 25
ci_027                 6.466911e-03 3 1  ON 26
ci_028                 6.188455e-03 3 1  ON 27
ci_029                -5.081652e-03 3 1  ON 28
ci_030                -4.169818e-03 3 1  ON 29
ci_031                 3.329810e-03 3 1  ON 30
ci_032                 4.543603e-03 3 1  ON 31
ci_033                 2.363595e-03 3 1  ON 32
ci_034                 4.136213e-03 3 1  ON 33
ci_035                 1.723714e-03 3 1  ON 34
ci_036                 2.153594e-03 3 1  ON 35
ci_037                 3.539178e-03 3 1  ON 36
ci_038                 3.699622e-03 3 1  ON 37
ci_039                 4.622410e-03 3 1  ON 38
ci_040                 4.935633e-03 3 1  ON 39
ci_041                 2.971099e-03 3 1  ON 40
ci_042                 2.733744e-03 3 1  ON 41
ci_043                 2.944553e-03 3 1  ON 42
ci_044                 3.188301e-03 3 1  ON 43
ci_045                 2.451398e-03 3 1  ON 44
ci_046                 2.720819e-03 3 1  ON 45
ci_047                -1.002284e-03 3 1  ON 46
ci_048                -8.337764e-04 3 1  ON 47
ci_049                 7.784947e-04 3 1  ON 48
ci_050                 9.956459e-04 3 1  ON 49
ci_051                -3.147137e-04 3 1  ON 50
ci_052                -1.210549e-03 3 1  ON 51
ci_053                -2.434204e-03 3 1  ON 52
ci_054                -2.689325e-03 3 1  ON 53
ci_055                -1.798922e-03 3 1  ON 54
ci_056                -1.928584e-03 3 1  ON 55
ci_057                -1.307274e-03 3 1  ON 56
ci_058                -9.883061e-04 3 1  ON 57
ci_059                -5.506751e-04 3 1  ON 58
ci_060                -7.598335e-04 3 1  ON 59
ci_061                -5.108116e-05 3 1  ON 60
ci_062                -9.205920e-04 3 1  ON 61
ci_063                -8.860707e-04 3 1  ON 62
ci_064                -5.245023e-04 3 1  ON 63
ci_065                -1.359403e-03 3 1  ON 64
ci_066                -1.883815e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.556925e-03 3 1  ON 67
ci_069                -5.544942e-04 3 1  ON 68
ci_070                -4.261974e-04 3 1  ON 69
ci_071                -2.087917e-03 3 1  ON 70
ci_072                -2.000851e-03 3 1  ON 71
ci_073                 1.611914e-04 3 1  ON 72
ci_074                 1.976231e-04 3 1  ON 73
ci_075                 1.618021e-04 3 1  ON 74
ci_076                 7.850948e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6213
    reference variance = 0.337481
====================================================
  Execution time = 2.5290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4882e-01
  Total weights = 1.9551e+06
  Execution time = 3.6176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439785594134
                                         uncertainty =       0.002677753078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439785594134
                                         uncertainty =       0.002677753078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468931616
  error estimate for blocks of size 2^( 2) =       0.000493184611
  error estimate for blocks of size 2^( 3) =       0.000515182135
  error estimate for blocks of size 2^( 4) =       0.000531203016
  error estimate for blocks of size 2^( 5) =       0.000540466848
  error estimate for blocks of size 2^( 6) =       0.000544486412
  error estimate for blocks of size 2^( 7) =       0.000543659066

      target function =      -0.746272137106
              le_mean =     -22.661501294455
             les_mean =     513.992462681489
             stat err =       0.000539953835
             autocorr =       1.325849507974
   target nu stat err =       0.000539953835
   target dn stat err =       0.003522326266
      target stat err =       0.002954608606
              std dev =       0.663169451306
             le_variance =       0.439793721145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439785387814
                                         uncertainty =       0.002677728238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439785387814
                                         uncertainty =       0.002677728238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468931506
  error estimate for blocks of size 2^( 2) =       0.000493184529
  error estimate for blocks of size 2^( 3) =       0.000515182075
  error estimate for blocks of size 2^( 4) =       0.000531202964
  error estimate for blocks of size 2^( 5) =       0.000540466801
  error estimate for blocks of size 2^( 6) =       0.000544486351
  error estimate for blocks of size 2^( 7) =       0.000543659005

      target function =      -0.746270767904
              le_mean =     -22.661501295785
             les_mean =     513.992464401742
             stat err =       0.000539953780
             autocorr =       1.325849860799
   target nu stat err =       0.000539953780
   target dn stat err =       0.003523157658
      target stat err =       0.002955267155
              std dev =       0.663169295186
             le_variance =       0.439793514077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439785490933
                                         uncertainty =       0.002677740663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439785490933
                                         uncertainty =       0.002677740663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468931561
  error estimate for blocks of size 2^( 2) =       0.000493184570
  error estimate for blocks of size 2^( 3) =       0.000515182105
  error estimate for blocks of size 2^( 4) =       0.000531202990
  error estimate for blocks of size 2^( 5) =       0.000540466824
  error estimate for blocks of size 2^( 6) =       0.000544486381
  error estimate for blocks of size 2^( 7) =       0.000543659036

      target function =      -0.746271461537
              le_mean =     -22.661501295113
             les_mean =     513.992463530338
             stat err =       0.000539953808
             autocorr =       1.325849684460
   target nu stat err =       0.000539953808
   target dn stat err =       0.003522741491
      target stat err =       0.002954937571
              std dev =       0.663169373215
             le_variance =       0.439793617571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439785581229
                                         uncertainty =       0.002677751526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439785581229
                                         uncertainty =       0.002677751526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468931609
  error estimate for blocks of size 2^( 2) =       0.000493184606
  error estimate for blocks of size 2^( 3) =       0.000515182131
  error estimate for blocks of size 2^( 4) =       0.000531203013
  error estimate for blocks of size 2^( 5) =       0.000540466845
  error estimate for blocks of size 2^( 6) =       0.000544486408
  error estimate for blocks of size 2^( 7) =       0.000543659062

      target function =      -0.746272053601
              le_mean =     -22.661501294537
             les_mean =     513.992462786420
             stat err =       0.000539953832
             autocorr =       1.325849530050
   target nu stat err =       0.000539953832
   target dn stat err =       0.003522378111
      target stat err =       0.002954649687
              std dev =       0.663169441541
             le_variance =       0.439793708194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746272137106        initial  <--
     1.4552e+02     1.4552e+03             1.2347e-06        -0.746270767904
     5.8208e+02     5.8208e+03             3.0871e-07        -0.746271461537
     2.3283e+03     2.3283e+04             7.7179e-08        -0.746272053601

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.3903
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_001                -7.055855e-01 3 1  ON 0
ci_002                -7.029022e-01 3 1  ON 1
ci_003                -5.013055e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949562e-02 3 1  ON 4
ci_006                 1.981640e-02 3 1  ON 5
ci_007                 1.474583e-02 3 1  ON 6
ci_008                 1.554059e-02 3 1  ON 7
ci_009                -1.320079e-02 3 1  ON 8
ci_010                -1.207985e-02 3 1  ON 9
ci_011                -9.910222e-03 3 1  ON 10
ci_012                -9.098660e-03 3 1  ON 11
ci_013                 8.349408e-03 3 1  ON 12
ci_014                 9.369165e-03 3 1  ON 13
ci_015                 9.519457e-03 3 1  ON 14
ci_016                 9.412714e-03 3 1  ON 15
ci_017                 8.493763e-03 3 1  ON 16
ci_018                 8.286414e-03 3 1  ON 17
ci_019                -1.224042e-03 3 1  ON 18
ci_020                -1.535887e-03 3 1  ON 19
ci_021                -1.177695e-02 3 1  ON 20
ci_022                -1.179932e-02 3 1  ON 21
ci_023                 4.854125e-03 3 1  ON 22
ci_024                 4.919385e-03 3 1  ON 23
ci_025                 1.143633e-02 3 1  ON 24
ci_026                 1.147257e-02 3 1  ON 25
ci_027                 6.466960e-03 3 1  ON 26
ci_028                 6.188412e-03 3 1  ON 27
ci_029                -5.081764e-03 3 1  ON 28
ci_030                -4.169901e-03 3 1  ON 29
ci_031                 3.329658e-03 3 1  ON 30
ci_032                 4.543494e-03 3 1  ON 31
ci_033                 2.363527e-03 3 1  ON 32
ci_034                 4.136258e-03 3 1  ON 33
ci_035                 1.723744e-03 3 1  ON 34
ci_036                 2.153605e-03 3 1  ON 35
ci_037                 3.539149e-03 3 1  ON 36
ci_038                 3.699765e-03 3 1  ON 37
ci_039                 4.622458e-03 3 1  ON 38
ci_040                 4.935599e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733798e-03 3 1  ON 41
ci_043                 2.944557e-03 3 1  ON 42
ci_044                 3.188333e-03 3 1  ON 43
ci_045                 2.451436e-03 3 1  ON 44
ci_046                 2.720974e-03 3 1  ON 45
ci_047                -1.002258e-03 3 1  ON 46
ci_048                -8.338238e-04 3 1  ON 47
ci_049                 7.784737e-04 3 1  ON 48
ci_050                 9.957060e-04 3 1  ON 49
ci_051                -3.147514e-04 3 1  ON 50
ci_052                -1.210528e-03 3 1  ON 51
ci_053                -2.434070e-03 3 1  ON 52
ci_054                -2.689524e-03 3 1  ON 53
ci_055                -1.798877e-03 3 1  ON 54
ci_056                -1.928539e-03 3 1  ON 55
ci_057                -1.307331e-03 3 1  ON 56
ci_058                -9.882798e-04 3 1  ON 57
ci_059                -5.507443e-04 3 1  ON 58
ci_060                -7.598798e-04 3 1  ON 59
ci_061                -5.115076e-05 3 1  ON 60
ci_062                -9.206538e-04 3 1  ON 61
ci_063                -8.861424e-04 3 1  ON 62
ci_064                -5.243445e-04 3 1  ON 63
ci_065                -1.359364e-03 3 1  ON 64
ci_066                -1.883926e-03 3 1  ON 65
ci_067                -1.812743e-03 3 1  ON 66
ci_068                -1.556876e-03 3 1  ON 67
ci_069                -5.544134e-04 3 1  ON 68
ci_070                -4.261753e-04 3 1  ON 69
ci_071                -2.087887e-03 3 1  ON 70
ci_072                -2.000844e-03 3 1  ON 71
ci_073                 1.611968e-04 3 1  ON 72
ci_074                 1.976939e-04 3 1  ON 73
ci_075                 1.618615e-04 3 1  ON 74
ci_076                 7.850614e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3915e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.576
    reference variance = 0.387193
====================================================
  Execution time = 2.7803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4651e-01
  Total weights = 1.955219945e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438955360766
                                         uncertainty =       0.002023775159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438955360766
                                         uncertainty =       0.002023775159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468492201
  error estimate for blocks of size 2^( 2) =       0.000492357853
  error estimate for blocks of size 2^( 3) =       0.000514744801
  error estimate for blocks of size 2^( 4) =       0.000530893258
  error estimate for blocks of size 2^( 5) =       0.000540428768
  error estimate for blocks of size 2^( 6) =       0.000545029362
  error estimate for blocks of size 2^( 7) =       0.000547092078

      target function =      -0.748213209931
              le_mean =     -22.663475010289
             les_mean =     514.079605438073
             stat err =       0.000540860866
             autocorr =       1.332804309273
   target nu stat err =       0.000540860866
   target dn stat err =       0.002509552922
      target stat err =       0.002163318044
              std dev =       0.662548024098
             le_variance =       0.438969884236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266347501029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748218570540       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748218582029       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748218584275       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748218584620       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748218584700       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748218584786       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748218584802       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748218584832       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748218584823       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748218584825       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748218584824       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+03 is 1.242984e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748218570540       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748218573413       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748218573974       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748218574060       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748218574080       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748218574104       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748218574106       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748218574113       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748218574111       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748218574114       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748218574112       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+03 is 3.107465e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748218570540       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748218571258       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748218571399       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748218571420       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748218571421       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748218571431       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748218571446       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748218571455       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748218571439       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748218571512       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748218571446       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+04 is 7.768664e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178218 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2506e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029022e-01 3 1  ON 1
ci_003                -5.013055e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949562e-02 3 1  ON 4
ci_006                 1.981638e-02 3 1  ON 5
ci_007                 1.474582e-02 3 1  ON 6
ci_008                 1.554058e-02 3 1  ON 7
ci_009                -1.320077e-02 3 1  ON 8
ci_010                -1.207984e-02 3 1  ON 9
ci_011                -9.910205e-03 3 1  ON 10
ci_012                -9.098667e-03 3 1  ON 11
ci_013                 8.349402e-03 3 1  ON 12
ci_014                 9.369146e-03 3 1  ON 13
ci_015                 9.519448e-03 3 1  ON 14
ci_016                 9.412712e-03 3 1  ON 15
ci_017                 8.493746e-03 3 1  ON 16
ci_018                 8.286424e-03 3 1  ON 17
ci_019                -1.224060e-03 3 1  ON 18
ci_020                -1.535910e-03 3 1  ON 19
ci_021                -1.177697e-02 3 1  ON 20
ci_022                -1.179932e-02 3 1  ON 21
ci_023                 4.854122e-03 3 1  ON 22
ci_024                 4.919374e-03 3 1  ON 23
ci_025                 1.143634e-02 3 1  ON 24
ci_026                 1.147259e-02 3 1  ON 25
ci_027                 6.466960e-03 3 1  ON 26
ci_028                 6.188406e-03 3 1  ON 27
ci_029                -5.081760e-03 3 1  ON 28
ci_030                -4.169893e-03 3 1  ON 29
ci_031                 3.329683e-03 3 1  ON 30
ci_032                 4.543504e-03 3 1  ON 31
ci_033                 2.363535e-03 3 1  ON 32
ci_034                 4.136256e-03 3 1  ON 33
ci_035                 1.723741e-03 3 1  ON 34
ci_036                 2.153605e-03 3 1  ON 35
ci_037                 3.539145e-03 3 1  ON 36
ci_038                 3.699765e-03 3 1  ON 37
ci_039                 4.622437e-03 3 1  ON 38
ci_040                 4.935593e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733797e-03 3 1  ON 41
ci_043                 2.944553e-03 3 1  ON 42
ci_044                 3.188328e-03 3 1  ON 43
ci_045                 2.451423e-03 3 1  ON 44
ci_046                 2.720977e-03 3 1  ON 45
ci_047                -1.002261e-03 3 1  ON 46
ci_048                -8.338241e-04 3 1  ON 47
ci_049                 7.784653e-04 3 1  ON 48
ci_050                 9.957109e-04 3 1  ON 49
ci_051                -3.147531e-04 3 1  ON 50
ci_052                -1.210524e-03 3 1  ON 51
ci_053                -2.434074e-03 3 1  ON 52
ci_054                -2.689526e-03 3 1  ON 53
ci_055                -1.798864e-03 3 1  ON 54
ci_056                -1.928533e-03 3 1  ON 55
ci_057                -1.307342e-03 3 1  ON 56
ci_058                -9.882811e-04 3 1  ON 57
ci_059                -5.507379e-04 3 1  ON 58
ci_060                -7.598749e-04 3 1  ON 59
ci_061                -5.113941e-05 3 1  ON 60
ci_062                -9.206573e-04 3 1  ON 61
ci_063                -8.861418e-04 3 1  ON 62
ci_064                -5.243561e-04 3 1  ON 63
ci_065                -1.359369e-03 3 1  ON 64
ci_066                -1.883920e-03 3 1  ON 65
ci_067                -1.812743e-03 3 1  ON 66
ci_068                -1.556865e-03 3 1  ON 67
ci_069                -5.544094e-04 3 1  ON 68
ci_070                -4.261838e-04 3 1  ON 69
ci_071                -2.087876e-03 3 1  ON 70
ci_072                -2.000835e-03 3 1  ON 71
ci_073                 1.611921e-04 3 1  ON 72
ci_074                 1.976894e-04 3 1  ON 73
ci_075                 1.618598e-04 3 1  ON 74
ci_076                 7.850740e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6698
    reference variance = 0.573871
====================================================
  Execution time = 2.5205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4769e-01
  Total weights = 1.9555e+06
  Execution time = 3.5962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438308931302
                                         uncertainty =       0.001824124757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438308931302
                                         uncertainty =       0.001824124757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468163499
  error estimate for blocks of size 2^( 2) =       0.000492153908
  error estimate for blocks of size 2^( 3) =       0.000514009317
  error estimate for blocks of size 2^( 4) =       0.000528909007
  error estimate for blocks of size 2^( 5) =       0.000539140496
  error estimate for blocks of size 2^( 6) =       0.000544658327
  error estimate for blocks of size 2^( 7) =       0.000548677357

      target function =      -0.747222877769
              le_mean =     -22.662319938208
             les_mean =     514.028430364846
             stat err =       0.000540346297
             autocorr =       1.332138128834
   target nu stat err =       0.000540346297
   target dn stat err =       0.002691319391
      target stat err =       0.002298403401
              std dev =       0.662083169034
             le_variance =       0.438354122718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438308912447
                                         uncertainty =       0.001824124888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438308912447
                                         uncertainty =       0.001824124888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468163488
  error estimate for blocks of size 2^( 2) =       0.000492153901
  error estimate for blocks of size 2^( 3) =       0.000514009314
  error estimate for blocks of size 2^( 4) =       0.000528909005
  error estimate for blocks of size 2^( 5) =       0.000539140494
  error estimate for blocks of size 2^( 6) =       0.000544658326
  error estimate for blocks of size 2^( 7) =       0.000548677357

      target function =      -0.747222952309
              le_mean =     -22.662319938127
             les_mean =     514.028430270776
             stat err =       0.000540346296
             autocorr =       1.332138180776
   target nu stat err =       0.000540346296
   target dn stat err =       0.002691322044
      target stat err =       0.002298405957
              std dev =       0.662083154769
             le_variance =       0.438354103829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438308921874
                                         uncertainty =       0.001824124823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438308921874
                                         uncertainty =       0.001824124823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468163493
  error estimate for blocks of size 2^( 2) =       0.000492153905
  error estimate for blocks of size 2^( 3) =       0.000514009315
  error estimate for blocks of size 2^( 4) =       0.000528909006
  error estimate for blocks of size 2^( 5) =       0.000539140495
  error estimate for blocks of size 2^( 6) =       0.000544658327
  error estimate for blocks of size 2^( 7) =       0.000548677357

      target function =      -0.747222915092
              le_mean =     -22.662319938167
             les_mean =     514.028430317745
             stat err =       0.000540346296
             autocorr =       1.332138154809
   target nu stat err =       0.000540346296
   target dn stat err =       0.002691320716
      target stat err =       0.002298404679
              std dev =       0.662083161901
             le_variance =       0.438354113273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438308930124
                                         uncertainty =       0.001824124765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438308930124
                                         uncertainty =       0.001824124765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468163498
  error estimate for blocks of size 2^( 2) =       0.000492153907
  error estimate for blocks of size 2^( 3) =       0.000514009317
  error estimate for blocks of size 2^( 4) =       0.000528909007
  error estimate for blocks of size 2^( 5) =       0.000539140496
  error estimate for blocks of size 2^( 6) =       0.000544658327
  error estimate for blocks of size 2^( 7) =       0.000548677357

      target function =      -0.747222882440
              le_mean =     -22.662319938202
             les_mean =     514.028430358951
             stat err =       0.000540346297
             autocorr =       1.332138132074
   target nu stat err =       0.000540346297
   target dn stat err =       0.002691319556
      target stat err =       0.002298403561
              std dev =       0.662083168142
             le_variance =       0.438354121537


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747222877769        initial
     1.4552e+03     1.4552e+04             1.2430e-07        -0.747222952309  <--
     5.8208e+03     5.8208e+04             3.1075e-08        -0.747222915092
     2.3283e+04     2.3283e+05             7.7687e-09        -0.747222882440

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 4.5815e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013058e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949561e-02 3 1  ON 4
ci_006                 1.981633e-02 3 1  ON 5
ci_007                 1.474576e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320072e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910153e-03 3 1  ON 10
ci_012                -9.098688e-03 3 1  ON 11
ci_013                 8.349384e-03 3 1  ON 12
ci_014                 9.369090e-03 3 1  ON 13
ci_015                 9.519421e-03 3 1  ON 14
ci_016                 9.412707e-03 3 1  ON 15
ci_017                 8.493695e-03 3 1  ON 16
ci_018                 8.286454e-03 3 1  ON 17
ci_019                -1.224115e-03 3 1  ON 18
ci_020                -1.535979e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179934e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919339e-03 3 1  ON 23
ci_025                 1.143640e-02 3 1  ON 24
ci_026                 1.147266e-02 3 1  ON 25
ci_027                 6.466961e-03 3 1  ON 26
ci_028                 6.188386e-03 3 1  ON 27
ci_029                -5.081749e-03 3 1  ON 28
ci_030                -4.169870e-03 3 1  ON 29
ci_031                 3.329759e-03 3 1  ON 30
ci_032                 4.543536e-03 3 1  ON 31
ci_033                 2.363560e-03 3 1  ON 32
ci_034                 4.136252e-03 3 1  ON 33
ci_035                 1.723730e-03 3 1  ON 34
ci_036                 2.153604e-03 3 1  ON 35
ci_037                 3.539132e-03 3 1  ON 36
ci_038                 3.699764e-03 3 1  ON 37
ci_039                 4.622373e-03 3 1  ON 38
ci_040                 4.935574e-03 3 1  ON 39
ci_041                 2.971143e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944542e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720987e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338251e-04 3 1  ON 47
ci_049                 7.784399e-04 3 1  ON 48
ci_050                 9.957257e-04 3 1  ON 49
ci_051                -3.147583e-04 3 1  ON 50
ci_052                -1.210510e-03 3 1  ON 51
ci_053                -2.434087e-03 3 1  ON 52
ci_054                -2.689534e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928515e-03 3 1  ON 55
ci_057                -1.307377e-03 3 1  ON 56
ci_058                -9.882851e-04 3 1  ON 57
ci_059                -5.507189e-04 3 1  ON 58
ci_060                -7.598600e-04 3 1  ON 59
ci_061                -5.110536e-05 3 1  ON 60
ci_062                -9.206677e-04 3 1  ON 61
ci_063                -8.861402e-04 3 1  ON 62
ci_064                -5.243907e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883902e-03 3 1  ON 65
ci_067                -1.812743e-03 3 1  ON 66
ci_068                -1.556831e-03 3 1  ON 67
ci_069                -5.543973e-04 3 1  ON 68
ci_070                -4.262091e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000807e-03 3 1  ON 71
ci_073                 1.611780e-04 3 1  ON 72
ci_074                 1.976760e-04 3 1  ON 73
ci_075                 1.618548e-04 3 1  ON 74
ci_076                 7.851116e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8328e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6057
    reference variance = 0.41873
====================================================
  Execution time = 2.5777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4775e-01
  Total weights = 1.954993882e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990574917
                                         uncertainty =       0.001716575806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437990574917
                                         uncertainty =       0.001716575806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467960055
  error estimate for blocks of size 2^( 2) =       0.000492011842
  error estimate for blocks of size 2^( 3) =       0.000513699613
  error estimate for blocks of size 2^( 4) =       0.000528881962
  error estimate for blocks of size 2^( 5) =       0.000537605669
  error estimate for blocks of size 2^( 6) =       0.000543567250
  error estimate for blocks of size 2^( 7) =       0.000546651854

      target function =      -0.747165138111
              le_mean =     -22.662228987255
             les_mean =     514.024376717537
             stat err =       0.000539176684
             autocorr =       1.327530903333
   target nu stat err =       0.000539176684
   target dn stat err =       0.002663798836
      target stat err =       0.002275507335
              std dev =       0.661795456629
             le_variance =       0.437973226415


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266222898726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747171126897       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747171190842       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747171200661       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747171199508       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747171199179       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747171199402       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747171199498       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747171199591       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747171199581       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747171199463       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747171199443       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747171199437       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+02 is 6.526460e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747171126897       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747171142885       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747171145339       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747171145051       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747171144970       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747171145022       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747171145049       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747171145072       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747171145069       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747171145039       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747171145039       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747171145033       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+03 is 1.631778e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747171126897       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747171130894       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747171131507       residual = 8.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747171131435       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747171131413       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747171131420       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747171131429       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747171131435       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747171131441       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747171131430       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747171131432       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747171131426       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+03 is 4.079546e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0488e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029024e-01 3 1  ON 1
ci_003                -5.013055e-02 3 1  ON 2
ci_004                -5.100184e-02 3 1  ON 3
ci_005                 1.949555e-02 3 1  ON 4
ci_006                 1.981628e-02 3 1  ON 5
ci_007                 1.474570e-02 3 1  ON 6
ci_008                 1.554047e-02 3 1  ON 7
ci_009                -1.320060e-02 3 1  ON 8
ci_010                -1.207986e-02 3 1  ON 9
ci_011                -9.910079e-03 3 1  ON 10
ci_012                -9.098643e-03 3 1  ON 11
ci_013                 8.349320e-03 3 1  ON 12
ci_014                 9.369040e-03 3 1  ON 13
ci_015                 9.519487e-03 3 1  ON 14
ci_016                 9.412705e-03 3 1  ON 15
ci_017                 8.493634e-03 3 1  ON 16
ci_018                 8.286414e-03 3 1  ON 17
ci_019                -1.224225e-03 3 1  ON 18
ci_020                -1.536084e-03 3 1  ON 19
ci_021                -1.177708e-02 3 1  ON 20
ci_022                -1.179941e-02 3 1  ON 21
ci_023                 4.854037e-03 3 1  ON 22
ci_024                 4.919343e-03 3 1  ON 23
ci_025                 1.143644e-02 3 1  ON 24
ci_026                 1.147273e-02 3 1  ON 25
ci_027                 6.466999e-03 3 1  ON 26
ci_028                 6.188357e-03 3 1  ON 27
ci_029                -5.081623e-03 3 1  ON 28
ci_030                -4.169884e-03 3 1  ON 29
ci_031                 3.329667e-03 3 1  ON 30
ci_032                 4.543596e-03 3 1  ON 31
ci_033                 2.363572e-03 3 1  ON 32
ci_034                 4.136158e-03 3 1  ON 33
ci_035                 1.723722e-03 3 1  ON 34
ci_036                 2.153505e-03 3 1  ON 35
ci_037                 3.539103e-03 3 1  ON 36
ci_038                 3.699729e-03 3 1  ON 37
ci_039                 4.622323e-03 3 1  ON 38
ci_040                 4.935521e-03 3 1  ON 39
ci_041                 2.971043e-03 3 1  ON 40
ci_042                 2.733804e-03 3 1  ON 41
ci_043                 2.944562e-03 3 1  ON 42
ci_044                 3.188319e-03 3 1  ON 43
ci_045                 2.451386e-03 3 1  ON 44
ci_046                 2.721024e-03 3 1  ON 45
ci_047                -1.002267e-03 3 1  ON 46
ci_048                -8.338696e-04 3 1  ON 47
ci_049                 7.784869e-04 3 1  ON 48
ci_050                 9.956921e-04 3 1  ON 49
ci_051                -3.147654e-04 3 1  ON 50
ci_052                -1.210529e-03 3 1  ON 51
ci_053                -2.434085e-03 3 1  ON 52
ci_054                -2.689492e-03 3 1  ON 53
ci_055                -1.798663e-03 3 1  ON 54
ci_056                -1.928525e-03 3 1  ON 55
ci_057                -1.307440e-03 3 1  ON 56
ci_058                -9.882525e-04 3 1  ON 57
ci_059                -5.507168e-04 3 1  ON 58
ci_060                -7.598675e-04 3 1  ON 59
ci_061                -5.109626e-05 3 1  ON 60
ci_062                -9.207343e-04 3 1  ON 61
ci_063                -8.861254e-04 3 1  ON 62
ci_064                -5.243943e-04 3 1  ON 63
ci_065                -1.359403e-03 3 1  ON 64
ci_066                -1.883924e-03 3 1  ON 65
ci_067                -1.812711e-03 3 1  ON 66
ci_068                -1.556819e-03 3 1  ON 67
ci_069                -5.543595e-04 3 1  ON 68
ci_070                -4.261908e-04 3 1  ON 69
ci_071                -2.087864e-03 3 1  ON 70
ci_072                -2.000859e-03 3 1  ON 71
ci_073                 1.611974e-04 3 1  ON 72
ci_074                 1.976740e-04 3 1  ON 73
ci_075                 1.618488e-04 3 1  ON 74
ci_076                 7.850909e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.7054
    reference variance = 0.555538
====================================================
  Execution time = 2.5350e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5193e-01
  Total weights = 1.9551e+06
  Execution time = 3.6208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441578957202
                                         uncertainty =       0.002873477111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441578957202
                                         uncertainty =       0.002873477111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922123
  error estimate for blocks of size 2^( 2) =       0.000494105434
  error estimate for blocks of size 2^( 3) =       0.000516163819
  error estimate for blocks of size 2^( 4) =       0.000532633936
  error estimate for blocks of size 2^( 5) =       0.000543392395
  error estimate for blocks of size 2^( 6) =       0.000549025901
  error estimate for blocks of size 2^( 7) =       0.000551222802

      target function =      -0.743734691501
              le_mean =     -22.662389218521
             les_mean =     514.035816629970
             stat err =       0.000544068759
             autocorr =       1.340465973786
   target nu stat err =       0.000544068759
   target dn stat err =       0.003231661480
      target stat err =       0.002707590107
              std dev =       0.664570240033
             le_variance =       0.441653603938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441579150145
                                         uncertainty =       0.002873705100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441579150145
                                         uncertainty =       0.002873705100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922225
  error estimate for blocks of size 2^( 2) =       0.000494105540
  error estimate for blocks of size 2^( 3) =       0.000516163938
  error estimate for blocks of size 2^( 4) =       0.000532634049
  error estimate for blocks of size 2^( 5) =       0.000543392511
  error estimate for blocks of size 2^( 6) =       0.000549026008
  error estimate for blocks of size 2^( 7) =       0.000551222892

      target function =      -0.743733294698
              le_mean =     -22.662389212525
             les_mean =     514.035818066079
             stat err =       0.000544068865
             autocorr =       1.340465915609
   target nu stat err =       0.000544068865
   target dn stat err =       0.003231860072
      target stat err =       0.002707738467
              std dev =       0.664570384360
             le_variance =       0.441653795768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441579053662
                                         uncertainty =       0.002873591105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441579053662
                                         uncertainty =       0.002873591105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922174
  error estimate for blocks of size 2^( 2) =       0.000494105487
  error estimate for blocks of size 2^( 3) =       0.000516163878
  error estimate for blocks of size 2^( 4) =       0.000532633993
  error estimate for blocks of size 2^( 5) =       0.000543392453
  error estimate for blocks of size 2^( 6) =       0.000549025954
  error estimate for blocks of size 2^( 7) =       0.000551222847

      target function =      -0.743734145507
              le_mean =     -22.662389215517
             les_mean =     514.035817161224
             stat err =       0.000544068812
             autocorr =       1.340465944787
   target nu stat err =       0.000544068812
   target dn stat err =       0.003231760369
      target stat err =       0.002707665046
              std dev =       0.664570312188
             le_variance =       0.441653699842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441578969258
                                         uncertainty =       0.002873491360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441578969258
                                         uncertainty =       0.002873491360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922130
  error estimate for blocks of size 2^( 2) =       0.000494105441
  error estimate for blocks of size 2^( 3) =       0.000516163826
  error estimate for blocks of size 2^( 4) =       0.000532633943
  error estimate for blocks of size 2^( 5) =       0.000543392403
  error estimate for blocks of size 2^( 6) =       0.000549025907
  error estimate for blocks of size 2^( 7) =       0.000551222808

      target function =      -0.743734635303
              le_mean =     -22.662389218145
             les_mean =     514.035816681603
             stat err =       0.000544068765
             autocorr =       1.340465970176
   target nu stat err =       0.000544068765
   target dn stat err =       0.003231673812
      target stat err =       0.002707599537
              std dev =       0.664570249051
             le_variance =       0.441653615924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743734691501        initial  <--
     3.6380e+02     3.6380e+03             6.5265e-07        -0.743733294698
     1.4552e+03     1.4552e+04             1.6318e-07        -0.743734145507
     5.8208e+03     5.8208e+04             4.0795e-08        -0.743734635303

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4488
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013058e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949561e-02 3 1  ON 4
ci_006                 1.981633e-02 3 1  ON 5
ci_007                 1.474576e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320072e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910153e-03 3 1  ON 10
ci_012                -9.098688e-03 3 1  ON 11
ci_013                 8.349384e-03 3 1  ON 12
ci_014                 9.369090e-03 3 1  ON 13
ci_015                 9.519421e-03 3 1  ON 14
ci_016                 9.412707e-03 3 1  ON 15
ci_017                 8.493695e-03 3 1  ON 16
ci_018                 8.286454e-03 3 1  ON 17
ci_019                -1.224115e-03 3 1  ON 18
ci_020                -1.535979e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179934e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919339e-03 3 1  ON 23
ci_025                 1.143640e-02 3 1  ON 24
ci_026                 1.147266e-02 3 1  ON 25
ci_027                 6.466961e-03 3 1  ON 26
ci_028                 6.188386e-03 3 1  ON 27
ci_029                -5.081749e-03 3 1  ON 28
ci_030                -4.169870e-03 3 1  ON 29
ci_031                 3.329759e-03 3 1  ON 30
ci_032                 4.543536e-03 3 1  ON 31
ci_033                 2.363560e-03 3 1  ON 32
ci_034                 4.136252e-03 3 1  ON 33
ci_035                 1.723730e-03 3 1  ON 34
ci_036                 2.153604e-03 3 1  ON 35
ci_037                 3.539132e-03 3 1  ON 36
ci_038                 3.699764e-03 3 1  ON 37
ci_039                 4.622373e-03 3 1  ON 38
ci_040                 4.935574e-03 3 1  ON 39
ci_041                 2.971143e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944542e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720987e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338251e-04 3 1  ON 47
ci_049                 7.784399e-04 3 1  ON 48
ci_050                 9.957257e-04 3 1  ON 49
ci_051                -3.147583e-04 3 1  ON 50
ci_052                -1.210510e-03 3 1  ON 51
ci_053                -2.434087e-03 3 1  ON 52
ci_054                -2.689534e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928515e-03 3 1  ON 55
ci_057                -1.307377e-03 3 1  ON 56
ci_058                -9.882851e-04 3 1  ON 57
ci_059                -5.507189e-04 3 1  ON 58
ci_060                -7.598600e-04 3 1  ON 59
ci_061                -5.110536e-05 3 1  ON 60
ci_062                -9.206677e-04 3 1  ON 61
ci_063                -8.861402e-04 3 1  ON 62
ci_064                -5.243907e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883902e-03 3 1  ON 65
ci_067                -1.812743e-03 3 1  ON 66
ci_068                -1.556831e-03 3 1  ON 67
ci_069                -5.543973e-04 3 1  ON 68
ci_070                -4.262091e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000807e-03 3 1  ON 71
ci_073                 1.611780e-04 3 1  ON 72
ci_074                 1.976760e-04 3 1  ON 73
ci_075                 1.618548e-04 3 1  ON 74
ci_076                 7.851116e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6298
    reference variance = 0.533963
====================================================
  Execution time = 2.5653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4939e-01
  Total weights = 1.955135948e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439450463064
                                         uncertainty =       0.002418257054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439450463064
                                         uncertainty =       0.002418257054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468679816
  error estimate for blocks of size 2^( 2) =       0.000492772162
  error estimate for blocks of size 2^( 3) =       0.000514669706
  error estimate for blocks of size 2^( 4) =       0.000530645672
  error estimate for blocks of size 2^( 5) =       0.000539877513
  error estimate for blocks of size 2^( 6) =       0.000544202696
  error estimate for blocks of size 2^( 7) =       0.000544048209

      target function =      -0.745802650555
              le_mean =     -22.661012135684
             les_mean =     513.970860763837
             stat err =       0.000539693522
             autocorr =       1.325995069302
   target nu stat err =       0.000539693522
   target dn stat err =       0.003026327002
      target stat err =       0.002551665597
              std dev =       0.662813352472
             le_variance =       0.439321540215


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266101213568e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745810340888       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745810364714       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745810367942       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745810368556       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745810368610       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745810368624       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745810368617       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745810368636       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745810368641       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745810368643       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745810368634       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745810368639       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+03 is 6.684929e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745810340888       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745810346845       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745810347652       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745810347803       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745810347819       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745810347824       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745810347833       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745810347818       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745810347865       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745810347838       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745810347833       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745810347814       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+04 is 1.671255e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745810340888       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745810342377       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745810342579       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745810342618       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745810342609       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745810342645       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745810342728       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745810342493       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745810342634       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745810342756       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745810342629       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745810342661       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+04 is 4.178150e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187923 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0420e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981632e-02 3 1  ON 5
ci_007                 1.474576e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910155e-03 3 1  ON 10
ci_012                -9.098684e-03 3 1  ON 11
ci_013                 8.349382e-03 3 1  ON 12
ci_014                 9.369079e-03 3 1  ON 13
ci_015                 9.519410e-03 3 1  ON 14
ci_016                 9.412701e-03 3 1  ON 15
ci_017                 8.493686e-03 3 1  ON 16
ci_018                 8.286460e-03 3 1  ON 17
ci_019                -1.224124e-03 3 1  ON 18
ci_020                -1.535993e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854102e-03 3 1  ON 22
ci_024                 4.919342e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466958e-03 3 1  ON 26
ci_028                 6.188389e-03 3 1  ON 27
ci_029                -5.081748e-03 3 1  ON 28
ci_030                -4.169867e-03 3 1  ON 29
ci_031                 3.329764e-03 3 1  ON 30
ci_032                 4.543541e-03 3 1  ON 31
ci_033                 2.363570e-03 3 1  ON 32
ci_034                 4.136247e-03 3 1  ON 33
ci_035                 1.723731e-03 3 1  ON 34
ci_036                 2.153599e-03 3 1  ON 35
ci_037                 3.539133e-03 3 1  ON 36
ci_038                 3.699760e-03 3 1  ON 37
ci_039                 4.622369e-03 3 1  ON 38
ci_040                 4.935567e-03 3 1  ON 39
ci_041                 2.971139e-03 3 1  ON 40
ci_042                 2.733794e-03 3 1  ON 41
ci_043                 2.944539e-03 3 1  ON 42
ci_044                 3.188311e-03 3 1  ON 43
ci_045                 2.451397e-03 3 1  ON 44
ci_046                 2.720986e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338235e-04 3 1  ON 47
ci_049                 7.784443e-04 3 1  ON 48
ci_050                 9.957243e-04 3 1  ON 49
ci_051                -3.147603e-04 3 1  ON 50
ci_052                -1.210509e-03 3 1  ON 51
ci_053                -2.434081e-03 3 1  ON 52
ci_054                -2.689540e-03 3 1  ON 53
ci_055                -1.798828e-03 3 1  ON 54
ci_056                -1.928510e-03 3 1  ON 55
ci_057                -1.307373e-03 3 1  ON 56
ci_058                -9.882950e-04 3 1  ON 57
ci_059                -5.507180e-04 3 1  ON 58
ci_060                -7.598605e-04 3 1  ON 59
ci_061                -5.110225e-05 3 1  ON 60
ci_062                -9.206666e-04 3 1  ON 61
ci_063                -8.861375e-04 3 1  ON 62
ci_064                -5.243889e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883899e-03 3 1  ON 65
ci_067                -1.812739e-03 3 1  ON 66
ci_068                -1.556834e-03 3 1  ON 67
ci_069                -5.543985e-04 3 1  ON 68
ci_070                -4.261924e-04 3 1  ON 69
ci_071                -2.087842e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611786e-04 3 1  ON 72
ci_074                 1.976692e-04 3 1  ON 73
ci_075                 1.618558e-04 3 1  ON 74
ci_076                 7.851208e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.696
    reference variance = 0.518947
====================================================
  Execution time = 2.5185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4773e-01
  Total weights = 1.9554e+06
  Execution time = 3.6153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439106079464
                                         uncertainty =       0.002756170359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439106079464
                                         uncertainty =       0.002756170359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468553212
  error estimate for blocks of size 2^( 2) =       0.000492544794
  error estimate for blocks of size 2^( 3) =       0.000514404151
  error estimate for blocks of size 2^( 4) =       0.000529202495
  error estimate for blocks of size 2^( 5) =       0.000538005186
  error estimate for blocks of size 2^( 6) =       0.000544339471
  error estimate for blocks of size 2^( 7) =       0.000545949242

      target function =      -0.747190486027
              le_mean =     -22.662601072938
             les_mean =     514.041215121184
             stat err =       0.000539374098
             autocorr =       1.325141745711
   target nu stat err =       0.000539374098
   target dn stat err =       0.002871980210
      target stat err =       0.002443156763
              std dev =       0.662634306997
             le_variance =       0.439084224809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439106072567
                                         uncertainty =       0.002756170312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439106072567
                                         uncertainty =       0.002756170312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468553208
  error estimate for blocks of size 2^( 2) =       0.000492544791
  error estimate for blocks of size 2^( 3) =       0.000514404150
  error estimate for blocks of size 2^( 4) =       0.000529202494
  error estimate for blocks of size 2^( 5) =       0.000538005185
  error estimate for blocks of size 2^( 6) =       0.000544339470
  error estimate for blocks of size 2^( 7) =       0.000545949240

      target function =      -0.747190472130
              le_mean =     -22.662601072396
             les_mean =     514.041215113448
             stat err =       0.000539374097
             autocorr =       1.325141760529
   target nu stat err =       0.000539374097
   target dn stat err =       0.002871981296
      target stat err =       0.002443157541
              std dev =       0.662634301845
             le_variance =       0.439084217981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439106076015
                                         uncertainty =       0.002756170336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439106076015
                                         uncertainty =       0.002756170336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468553210
  error estimate for blocks of size 2^( 2) =       0.000492544792
  error estimate for blocks of size 2^( 3) =       0.000514404150
  error estimate for blocks of size 2^( 4) =       0.000529202495
  error estimate for blocks of size 2^( 5) =       0.000538005185
  error estimate for blocks of size 2^( 6) =       0.000544339470
  error estimate for blocks of size 2^( 7) =       0.000545949241

      target function =      -0.747190479087
              le_mean =     -22.662601072667
             les_mean =     514.041215117306
             stat err =       0.000539374098
             autocorr =       1.325141753121
   target nu stat err =       0.000539374098
   target dn stat err =       0.002871980753
      target stat err =       0.002443157152
              std dev =       0.662634304420
             le_variance =       0.439084221395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439106079033
                                         uncertainty =       0.002756170356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439106079033
                                         uncertainty =       0.002756170356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468553212
  error estimate for blocks of size 2^( 2) =       0.000492544793
  error estimate for blocks of size 2^( 3) =       0.000514404151
  error estimate for blocks of size 2^( 4) =       0.000529202495
  error estimate for blocks of size 2^( 5) =       0.000538005186
  error estimate for blocks of size 2^( 6) =       0.000544339471
  error estimate for blocks of size 2^( 7) =       0.000545949242

      target function =      -0.747190485161
              le_mean =     -22.662601072904
             les_mean =     514.041215120698
             stat err =       0.000539374098
             autocorr =       1.325141746626
   target nu stat err =       0.000539374098
   target dn stat err =       0.002871980278
      target stat err =       0.002443156811
              std dev =       0.662634306674
             le_variance =       0.439084224382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747190486027        initial  <--
     3.6380e+03     3.6380e+04             6.6849e-08        -0.747190472130
     1.4552e+04     1.4552e+05             1.6713e-08        -0.747190479087
     5.8208e+04     5.8208e+05             4.1782e-09        -0.747190485161

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2686
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013058e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949561e-02 3 1  ON 4
ci_006                 1.981633e-02 3 1  ON 5
ci_007                 1.474576e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320072e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910153e-03 3 1  ON 10
ci_012                -9.098688e-03 3 1  ON 11
ci_013                 8.349384e-03 3 1  ON 12
ci_014                 9.369090e-03 3 1  ON 13
ci_015                 9.519421e-03 3 1  ON 14
ci_016                 9.412707e-03 3 1  ON 15
ci_017                 8.493695e-03 3 1  ON 16
ci_018                 8.286454e-03 3 1  ON 17
ci_019                -1.224115e-03 3 1  ON 18
ci_020                -1.535979e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179934e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919339e-03 3 1  ON 23
ci_025                 1.143640e-02 3 1  ON 24
ci_026                 1.147266e-02 3 1  ON 25
ci_027                 6.466961e-03 3 1  ON 26
ci_028                 6.188386e-03 3 1  ON 27
ci_029                -5.081749e-03 3 1  ON 28
ci_030                -4.169870e-03 3 1  ON 29
ci_031                 3.329759e-03 3 1  ON 30
ci_032                 4.543536e-03 3 1  ON 31
ci_033                 2.363560e-03 3 1  ON 32
ci_034                 4.136252e-03 3 1  ON 33
ci_035                 1.723730e-03 3 1  ON 34
ci_036                 2.153604e-03 3 1  ON 35
ci_037                 3.539132e-03 3 1  ON 36
ci_038                 3.699764e-03 3 1  ON 37
ci_039                 4.622373e-03 3 1  ON 38
ci_040                 4.935574e-03 3 1  ON 39
ci_041                 2.971143e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944542e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720987e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338251e-04 3 1  ON 47
ci_049                 7.784399e-04 3 1  ON 48
ci_050                 9.957257e-04 3 1  ON 49
ci_051                -3.147583e-04 3 1  ON 50
ci_052                -1.210510e-03 3 1  ON 51
ci_053                -2.434087e-03 3 1  ON 52
ci_054                -2.689534e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928515e-03 3 1  ON 55
ci_057                -1.307377e-03 3 1  ON 56
ci_058                -9.882851e-04 3 1  ON 57
ci_059                -5.507189e-04 3 1  ON 58
ci_060                -7.598600e-04 3 1  ON 59
ci_061                -5.110536e-05 3 1  ON 60
ci_062                -9.206677e-04 3 1  ON 61
ci_063                -8.861402e-04 3 1  ON 62
ci_064                -5.243907e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883902e-03 3 1  ON 65
ci_067                -1.812743e-03 3 1  ON 66
ci_068                -1.556831e-03 3 1  ON 67
ci_069                -5.543973e-04 3 1  ON 68
ci_070                -4.262091e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000807e-03 3 1  ON 71
ci_073                 1.611780e-04 3 1  ON 72
ci_074                 1.976760e-04 3 1  ON 73
ci_075                 1.618548e-04 3 1  ON 74
ci_076                 7.851116e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3696e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6496
    reference variance = 0.375095
====================================================
  Execution time = 2.5658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5472e-01
  Total weights = 1.955261828e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443663163874
                                         uncertainty =       0.002381411057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443663163874
                                         uncertainty =       0.002381411057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470940515
  error estimate for blocks of size 2^( 2) =       0.000494952910
  error estimate for blocks of size 2^( 3) =       0.000517139149
  error estimate for blocks of size 2^( 4) =       0.000532843695
  error estimate for blocks of size 2^( 5) =       0.000542092641
  error estimate for blocks of size 2^( 6) =       0.000545575633
  error estimate for blocks of size 2^( 7) =       0.000548151268

      target function =      -0.741456398481
              le_mean =     -22.661775738319
             les_mean =     514.010800707294
             stat err =       0.000542165809
             autocorr =       1.325354762075
   target nu stat err =       0.000542165809
   target dn stat err =       0.003710763467
      target stat err =       0.003068914398
              std dev =       0.666010463965
             le_variance =       0.443569938111


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266177573832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741468289958       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741468290521       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741468290653       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741468290689       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741468290680       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741468290650       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741468290656       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741468290636       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741468290640       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741468290655       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741468290628       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+04 is 6.015604e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741468289958       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741468290099       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741468290132       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741468290169       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741468290055       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741468290106       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741468289837       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741468290005       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741468290049       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741468289987       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741468289773       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+05 is 1.503902e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741468289958       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741468289993       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741468290002       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741468290003       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741468290004       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741468290066       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741468288448       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741468288978       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741468291044       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741468289647       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741468291042       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+05 is 3.759756e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0359e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013058e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949561e-02 3 1  ON 4
ci_006                 1.981633e-02 3 1  ON 5
ci_007                 1.474576e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320072e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910153e-03 3 1  ON 10
ci_012                -9.098689e-03 3 1  ON 11
ci_013                 8.349383e-03 3 1  ON 12
ci_014                 9.369089e-03 3 1  ON 13
ci_015                 9.519421e-03 3 1  ON 14
ci_016                 9.412707e-03 3 1  ON 15
ci_017                 8.493694e-03 3 1  ON 16
ci_018                 8.286454e-03 3 1  ON 17
ci_019                -1.224116e-03 3 1  ON 18
ci_020                -1.535979e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179934e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919339e-03 3 1  ON 23
ci_025                 1.143640e-02 3 1  ON 24
ci_026                 1.147266e-02 3 1  ON 25
ci_027                 6.466961e-03 3 1  ON 26
ci_028                 6.188386e-03 3 1  ON 27
ci_029                -5.081748e-03 3 1  ON 28
ci_030                -4.169870e-03 3 1  ON 29
ci_031                 3.329760e-03 3 1  ON 30
ci_032                 4.543536e-03 3 1  ON 31
ci_033                 2.363560e-03 3 1  ON 32
ci_034                 4.136252e-03 3 1  ON 33
ci_035                 1.723730e-03 3 1  ON 34
ci_036                 2.153604e-03 3 1  ON 35
ci_037                 3.539132e-03 3 1  ON 36
ci_038                 3.699763e-03 3 1  ON 37
ci_039                 4.622373e-03 3 1  ON 38
ci_040                 4.935574e-03 3 1  ON 39
ci_041                 2.971143e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944542e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720986e-03 3 1  ON 45
ci_047                -1.002267e-03 3 1  ON 46
ci_048                -8.338248e-04 3 1  ON 47
ci_049                 7.784403e-04 3 1  ON 48
ci_050                 9.957255e-04 3 1  ON 49
ci_051                -3.147583e-04 3 1  ON 50
ci_052                -1.210510e-03 3 1  ON 51
ci_053                -2.434086e-03 3 1  ON 52
ci_054                -2.689533e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928514e-03 3 1  ON 55
ci_057                -1.307376e-03 3 1  ON 56
ci_058                -9.882847e-04 3 1  ON 57
ci_059                -5.507189e-04 3 1  ON 58
ci_060                -7.598595e-04 3 1  ON 59
ci_061                -5.110516e-05 3 1  ON 60
ci_062                -9.206676e-04 3 1  ON 61
ci_063                -8.861407e-04 3 1  ON 62
ci_064                -5.243907e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812743e-03 3 1  ON 66
ci_068                -1.556830e-03 3 1  ON 67
ci_069                -5.543969e-04 3 1  ON 68
ci_070                -4.262094e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000807e-03 3 1  ON 71
ci_073                 1.611782e-04 3 1  ON 72
ci_074                 1.976757e-04 3 1  ON 73
ci_075                 1.618551e-04 3 1  ON 74
ci_076                 7.851116e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.6471
    reference variance = 0.353918
====================================================
  Execution time = 2.5195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5124e-01
  Total weights = 1.9556e+06
  Execution time = 3.5955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439089222823
                                         uncertainty =       0.002375050658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439089222823
                                         uncertainty =       0.002375050658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468533755
  error estimate for blocks of size 2^( 2) =       0.000492849389
  error estimate for blocks of size 2^( 3) =       0.000515148181
  error estimate for blocks of size 2^( 4) =       0.000530454364
  error estimate for blocks of size 2^( 5) =       0.000540063114
  error estimate for blocks of size 2^( 6) =       0.000543567162
  error estimate for blocks of size 2^( 7) =       0.000545357204

      target function =      -0.744296594965
              le_mean =     -22.661458945554
             les_mean =     513.992957463678
             stat err =       0.000539860461
             autocorr =       1.327642888535
   target nu stat err =       0.000539860461
   target dn stat err =       0.002978150375
      target stat err =       0.002505094141
              std dev =       0.662606790378
             le_variance =       0.439047758655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439089221639
                                         uncertainty =       0.002375050666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439089221639
                                         uncertainty =       0.002375050666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468533754
  error estimate for blocks of size 2^( 2) =       0.000492849388
  error estimate for blocks of size 2^( 3) =       0.000515148181
  error estimate for blocks of size 2^( 4) =       0.000530454363
  error estimate for blocks of size 2^( 5) =       0.000540063114
  error estimate for blocks of size 2^( 6) =       0.000543567162
  error estimate for blocks of size 2^( 7) =       0.000545357204

      target function =      -0.744296611331
              le_mean =     -22.661458945537
             les_mean =     513.992957442907
             stat err =       0.000539860461
             autocorr =       1.327642890737
   target nu stat err =       0.000539860461
   target dn stat err =       0.002978146274
      target stat err =       0.002505090992
              std dev =       0.662606789482
             le_variance =       0.439047757468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439089222231
                                         uncertainty =       0.002375050662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439089222231
                                         uncertainty =       0.002375050662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468533754
  error estimate for blocks of size 2^( 2) =       0.000492849388
  error estimate for blocks of size 2^( 3) =       0.000515148181
  error estimate for blocks of size 2^( 4) =       0.000530454364
  error estimate for blocks of size 2^( 5) =       0.000540063114
  error estimate for blocks of size 2^( 6) =       0.000543567162
  error estimate for blocks of size 2^( 7) =       0.000545357204

      target function =      -0.744296603148
              le_mean =     -22.661458945545
             les_mean =     513.992957453293
             stat err =       0.000539860461
             autocorr =       1.327642889635
   target nu stat err =       0.000539860461
   target dn stat err =       0.002978148324
      target stat err =       0.002505092567
              std dev =       0.662606789930
             le_variance =       0.439047758061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439089222749
                                         uncertainty =       0.002375050659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439089222749
                                         uncertainty =       0.002375050659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468533755
  error estimate for blocks of size 2^( 2) =       0.000492849389
  error estimate for blocks of size 2^( 3) =       0.000515148181
  error estimate for blocks of size 2^( 4) =       0.000530454364
  error estimate for blocks of size 2^( 5) =       0.000540063114
  error estimate for blocks of size 2^( 6) =       0.000543567162
  error estimate for blocks of size 2^( 7) =       0.000545357204

      target function =      -0.744296595988
              le_mean =     -22.661458945552
             les_mean =     513.992957462380
             stat err =       0.000539860461
             autocorr =       1.327642888685
   target nu stat err =       0.000539860461
   target dn stat err =       0.002978150118
      target stat err =       0.002505093944
              std dev =       0.662606790322
             le_variance =       0.439047758580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744296594965        initial
     3.6380e+04     3.6380e+05             6.0156e-09        -0.744296611331  <--
     1.4552e+05     1.4552e+06             1.5039e-09        -0.744296603148
     5.8208e+05     5.8208e+06             3.7598e-10        -0.744296595988

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 4.3234e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949561e-02 3 1  ON 4
ci_006                 1.981632e-02 3 1  ON 5
ci_007                 1.474576e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320072e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910152e-03 3 1  ON 10
ci_012                -9.098690e-03 3 1  ON 11
ci_013                 8.349381e-03 3 1  ON 12
ci_014                 9.369087e-03 3 1  ON 13
ci_015                 9.519418e-03 3 1  ON 14
ci_016                 9.412705e-03 3 1  ON 15
ci_017                 8.493693e-03 3 1  ON 16
ci_018                 8.286454e-03 3 1  ON 17
ci_019                -1.224121e-03 3 1  ON 18
ci_020                -1.535982e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179934e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919339e-03 3 1  ON 23
ci_025                 1.143640e-02 3 1  ON 24
ci_026                 1.147266e-02 3 1  ON 25
ci_027                 6.466960e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081746e-03 3 1  ON 28
ci_030                -4.169870e-03 3 1  ON 29
ci_031                 3.329765e-03 3 1  ON 30
ci_032                 4.543537e-03 3 1  ON 31
ci_033                 2.363561e-03 3 1  ON 32
ci_034                 4.136250e-03 3 1  ON 33
ci_035                 1.723730e-03 3 1  ON 34
ci_036                 2.153604e-03 3 1  ON 35
ci_037                 3.539130e-03 3 1  ON 36
ci_038                 3.699761e-03 3 1  ON 37
ci_039                 4.622374e-03 3 1  ON 38
ci_040                 4.935574e-03 3 1  ON 39
ci_041                 2.971144e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944542e-03 3 1  ON 42
ci_044                 3.188312e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720985e-03 3 1  ON 45
ci_047                -1.002266e-03 3 1  ON 46
ci_048                -8.338240e-04 3 1  ON 47
ci_049                 7.784415e-04 3 1  ON 48
ci_050                 9.957251e-04 3 1  ON 49
ci_051                -3.147584e-04 3 1  ON 50
ci_052                -1.210510e-03 3 1  ON 51
ci_053                -2.434086e-03 3 1  ON 52
ci_054                -2.689532e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928513e-03 3 1  ON 55
ci_057                -1.307376e-03 3 1  ON 56
ci_058                -9.882836e-04 3 1  ON 57
ci_059                -5.507188e-04 3 1  ON 58
ci_060                -7.598582e-04 3 1  ON 59
ci_061                -5.110454e-05 3 1  ON 60
ci_062                -9.206672e-04 3 1  ON 61
ci_063                -8.861419e-04 3 1  ON 62
ci_064                -5.243908e-04 3 1  ON 63
ci_065                -1.359384e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812743e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543958e-04 3 1  ON 68
ci_070                -4.262100e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000807e-03 3 1  ON 71
ci_073                 1.611788e-04 3 1  ON 72
ci_074                 1.976749e-04 3 1  ON 73
ci_075                 1.618557e-04 3 1  ON 74
ci_076                 7.851116e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3601e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6961
    reference variance = 0.359061
====================================================
  Execution time = 2.7704e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4946e-01
  Total weights = 1.955190582e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439703655497
                                         uncertainty =       0.002175482094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439703655497
                                         uncertainty =       0.002175482094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468902472
  error estimate for blocks of size 2^( 2) =       0.000492881320
  error estimate for blocks of size 2^( 3) =       0.000515176579
  error estimate for blocks of size 2^( 4) =       0.000530926081
  error estimate for blocks of size 2^( 5) =       0.000538634907
  error estimate for blocks of size 2^( 6) =       0.000544179924
  error estimate for blocks of size 2^( 7) =       0.000546898327

      target function =      -0.745752331729
              le_mean =     -22.661526234254
             les_mean =     513.994229805668
             stat err =       0.000540159810
             autocorr =       1.327026179055
   target nu stat err =       0.000540159810
   target dn stat err =       0.003064571956
      target stat err =       0.002583916446
              std dev =       0.663128235335
             le_variance =       0.439739056499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266152623425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745760324930       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745760326983       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745760327373       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745760327383       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745760327393       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745760327408       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745760327389       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745760327417       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745760327388       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745760327402       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745760327405       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+03 is 2.061447e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745760324930       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745760325444       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745760325541       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745760325543       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745760325545       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745760325534       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745760325558       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745760325479       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745760325599       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745760325509       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745760325509       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+04 is 5.153635e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745760324930       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745760325059       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745760325083       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745760325084       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745760325074       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745760325026       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745760325025       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745760325361       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745760324798       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745760325325       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745760324757       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+05 is 1.288410e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2424e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949561e-02 3 1  ON 4
ci_006                 1.981632e-02 3 1  ON 5
ci_007                 1.474576e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320072e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910149e-03 3 1  ON 10
ci_012                -9.098687e-03 3 1  ON 11
ci_013                 8.349378e-03 3 1  ON 12
ci_014                 9.369083e-03 3 1  ON 13
ci_015                 9.519414e-03 3 1  ON 14
ci_016                 9.412702e-03 3 1  ON 15
ci_017                 8.493690e-03 3 1  ON 16
ci_018                 8.286452e-03 3 1  ON 17
ci_019                -1.224126e-03 3 1  ON 18
ci_020                -1.535987e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919338e-03 3 1  ON 23
ci_025                 1.143640e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466959e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081746e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329769e-03 3 1  ON 30
ci_032                 4.543537e-03 3 1  ON 31
ci_033                 2.363562e-03 3 1  ON 32
ci_034                 4.136247e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153603e-03 3 1  ON 35
ci_037                 3.539130e-03 3 1  ON 36
ci_038                 3.699760e-03 3 1  ON 37
ci_039                 4.622373e-03 3 1  ON 38
ci_040                 4.935573e-03 3 1  ON 39
ci_041                 2.971143e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944542e-03 3 1  ON 42
ci_044                 3.188313e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720984e-03 3 1  ON 45
ci_047                -1.002267e-03 3 1  ON 46
ci_048                -8.338242e-04 3 1  ON 47
ci_049                 7.784388e-04 3 1  ON 48
ci_050                 9.957262e-04 3 1  ON 49
ci_051                -3.147586e-04 3 1  ON 50
ci_052                -1.210508e-03 3 1  ON 51
ci_053                -2.434085e-03 3 1  ON 52
ci_054                -2.689531e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928511e-03 3 1  ON 55
ci_057                -1.307374e-03 3 1  ON 56
ci_058                -9.882834e-04 3 1  ON 57
ci_059                -5.507188e-04 3 1  ON 58
ci_060                -7.598569e-04 3 1  ON 59
ci_061                -5.110368e-05 3 1  ON 60
ci_062                -9.206650e-04 3 1  ON 61
ci_063                -8.861421e-04 3 1  ON 62
ci_064                -5.243920e-04 3 1  ON 63
ci_065                -1.359384e-03 3 1  ON 64
ci_066                -1.883900e-03 3 1  ON 65
ci_067                -1.812743e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543933e-04 3 1  ON 68
ci_070                -4.262085e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000807e-03 3 1  ON 71
ci_073                 1.611784e-04 3 1  ON 72
ci_074                 1.976748e-04 3 1  ON 73
ci_075                 1.618558e-04 3 1  ON 74
ci_076                 7.851114e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.616
    reference variance = 0.291315
====================================================
  Execution time = 2.5549e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5727e-01
  Total weights = 1.9551e+06
  Execution time = 3.6074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445835764044
                                         uncertainty =       0.004327711432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445835764044
                                         uncertainty =       0.004327711432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472129724
  error estimate for blocks of size 2^( 2) =       0.000496168002
  error estimate for blocks of size 2^( 3) =       0.000518077214
  error estimate for blocks of size 2^( 4) =       0.000532833759
  error estimate for blocks of size 2^( 5) =       0.000541366538
  error estimate for blocks of size 2^( 6) =       0.000544625735
  error estimate for blocks of size 2^( 7) =       0.000546453771

      target function =      -0.739379477258
              le_mean =     -22.661477973171
             les_mean =     513.999858057304
             stat err =       0.000541319951
             autocorr =       1.314575035777
   target nu stat err =       0.000541319951
   target dn stat err =       0.005094209509
      target stat err =       0.004150919699
              std dev =       0.667692259248
             le_variance =       0.445812953059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445835761345
                                         uncertainty =       0.004327714413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445835761345
                                         uncertainty =       0.004327714413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472129723
  error estimate for blocks of size 2^( 2) =       0.000496168001
  error estimate for blocks of size 2^( 3) =       0.000518077213
  error estimate for blocks of size 2^( 4) =       0.000532833759
  error estimate for blocks of size 2^( 5) =       0.000541366538
  error estimate for blocks of size 2^( 6) =       0.000544625735
  error estimate for blocks of size 2^( 7) =       0.000546453771

      target function =      -0.739379520076
              le_mean =     -22.661477973381
             les_mean =     513.999858013768
             stat err =       0.000541319951
             autocorr =       1.314575041807
   target nu stat err =       0.000541319951
   target dn stat err =       0.005094204238
      target stat err =       0.004150915968
              std dev =       0.667692257213
             le_variance =       0.445812950342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445835762694
                                         uncertainty =       0.004327712923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445835762694
                                         uncertainty =       0.004327712923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472129724
  error estimate for blocks of size 2^( 2) =       0.000496168001
  error estimate for blocks of size 2^( 3) =       0.000518077214
  error estimate for blocks of size 2^( 4) =       0.000532833759
  error estimate for blocks of size 2^( 5) =       0.000541366538
  error estimate for blocks of size 2^( 6) =       0.000544625735
  error estimate for blocks of size 2^( 7) =       0.000546453771

      target function =      -0.739379498668
              le_mean =     -22.661477973276
             les_mean =     513.999858035534
             stat err =       0.000541319951
             autocorr =       1.314575038790
   target nu stat err =       0.000541319951
   target dn stat err =       0.005094206873
      target stat err =       0.004150917834
              std dev =       0.667692258230
             le_variance =       0.445812951700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445835763875
                                         uncertainty =       0.004327711619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445835763875
                                         uncertainty =       0.004327711619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472129724
  error estimate for blocks of size 2^( 2) =       0.000496168002
  error estimate for blocks of size 2^( 3) =       0.000518077214
  error estimate for blocks of size 2^( 4) =       0.000532833759
  error estimate for blocks of size 2^( 5) =       0.000541366538
  error estimate for blocks of size 2^( 6) =       0.000544625735
  error estimate for blocks of size 2^( 7) =       0.000546453771

      target function =      -0.739379479934
              le_mean =     -22.661477973184
             les_mean =     513.999858054583
             stat err =       0.000541319951
             autocorr =       1.314575036144
   target nu stat err =       0.000541319951
   target dn stat err =       0.005094209179
      target stat err =       0.004150919466
              std dev =       0.667692259120
             le_variance =       0.445812952889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739379477258        initial
     9.0949e+03     9.0949e+04             2.0614e-08        -0.739379520076  <--
     3.6380e+04     3.6380e+05             5.1536e-09        -0.739379498668
     1.4552e+05     1.4552e+06             1.2884e-09        -0.739379479934

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 4.6034e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098679e-03 3 1  ON 11
ci_013                 8.349371e-03 3 1  ON 12
ci_014                 9.369073e-03 3 1  ON 13
ci_015                 9.519403e-03 3 1  ON 14
ci_016                 9.412695e-03 3 1  ON 15
ci_017                 8.493682e-03 3 1  ON 16
ci_018                 8.286446e-03 3 1  ON 17
ci_019                -1.224140e-03 3 1  ON 18
ci_020                -1.536002e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919333e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466954e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081745e-03 3 1  ON 28
ci_030                -4.169873e-03 3 1  ON 29
ci_031                 3.329783e-03 3 1  ON 30
ci_032                 4.543537e-03 3 1  ON 31
ci_033                 2.363564e-03 3 1  ON 32
ci_034                 4.136238e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153599e-03 3 1  ON 35
ci_037                 3.539129e-03 3 1  ON 36
ci_038                 3.699754e-03 3 1  ON 37
ci_039                 4.622370e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944543e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338247e-04 3 1  ON 47
ci_049                 7.784305e-04 3 1  ON 48
ci_050                 9.957292e-04 3 1  ON 49
ci_051                -3.147592e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798828e-03 3 1  ON 54
ci_056                -1.928505e-03 3 1  ON 55
ci_057                -1.307368e-03 3 1  ON 56
ci_058                -9.882826e-04 3 1  ON 57
ci_059                -5.507189e-04 3 1  ON 58
ci_060                -7.598530e-04 3 1  ON 59
ci_061                -5.110108e-05 3 1  ON 60
ci_062                -9.206581e-04 3 1  ON 61
ci_063                -8.861428e-04 3 1  ON 62
ci_064                -5.243957e-04 3 1  ON 63
ci_065                -1.359384e-03 3 1  ON 64
ci_066                -1.883900e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543858e-04 3 1  ON 68
ci_070                -4.262042e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611770e-04 3 1  ON 72
ci_074                 1.976746e-04 3 1  ON 73
ci_075                 1.618560e-04 3 1  ON 74
ci_076                 7.851105e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8466e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6932
    reference variance = 0.348271
====================================================
  Execution time = 2.5676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5162e-01
  Total weights = 1.955173007e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439201079656
                                         uncertainty =       0.001630192093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439201079656
                                         uncertainty =       0.001630192093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468596877
  error estimate for blocks of size 2^( 2) =       0.000492766817
  error estimate for blocks of size 2^( 3) =       0.000514706603
  error estimate for blocks of size 2^( 4) =       0.000530335193
  error estimate for blocks of size 2^( 5) =       0.000541444086
  error estimate for blocks of size 2^( 6) =       0.000545961610
  error estimate for blocks of size 2^( 7) =       0.000547687681

      target function =      -0.743979156663
              le_mean =     -22.661775639560
             les_mean =     514.007697609630
             stat err =       0.000541357142
             autocorr =       1.334654831405
   target nu stat err =       0.000541357142
   target dn stat err =       0.003734623017
      target stat err =       0.003108401731
              std dev =       0.662696058331
             le_variance =       0.439166065728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266177563956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743991189775       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743991198401       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743991200018       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743991200192       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743991200226       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743991200228       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743991200234       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743991200240       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743991200232       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743991200240       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743991200246       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+03 is 8.462461e-08

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743991189775       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743991191932       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743991192336       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743991192380       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743991192379       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743991192384       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743991192386       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743991192372       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743991192371       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743991192404       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743991192402       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+03 is 2.115642e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743991189775       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743991190315       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743991190416       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743991190428       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743991190424       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743991190432       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743991190530       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743991190407       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743991190379       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743991190431       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743991190345       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+04 is 5.289121e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200435 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0402e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013058e-02 3 1  ON 2
ci_004                -5.100193e-02 3 1  ON 3
ci_005                 1.949559e-02 3 1  ON 4
ci_006                 1.981630e-02 3 1  ON 5
ci_007                 1.474574e-02 3 1  ON 6
ci_008                 1.554054e-02 3 1  ON 7
ci_009                -1.320070e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910138e-03 3 1  ON 10
ci_012                -9.098673e-03 3 1  ON 11
ci_013                 8.349365e-03 3 1  ON 12
ci_014                 9.369061e-03 3 1  ON 13
ci_015                 9.519391e-03 3 1  ON 14
ci_016                 9.412683e-03 3 1  ON 15
ci_017                 8.493675e-03 3 1  ON 16
ci_018                 8.286442e-03 3 1  ON 17
ci_019                -1.224145e-03 3 1  ON 18
ci_020                -1.536023e-03 3 1  ON 19
ci_021                -1.177705e-02 3 1  ON 20
ci_022                -1.179937e-02 3 1  ON 21
ci_023                 4.854118e-03 3 1  ON 22
ci_024                 4.919339e-03 3 1  ON 23
ci_025                 1.143643e-02 3 1  ON 24
ci_026                 1.147269e-02 3 1  ON 25
ci_027                 6.466951e-03 3 1  ON 26
ci_028                 6.188391e-03 3 1  ON 27
ci_029                -5.081744e-03 3 1  ON 28
ci_030                -4.169864e-03 3 1  ON 29
ci_031                 3.329798e-03 3 1  ON 30
ci_032                 4.543545e-03 3 1  ON 31
ci_033                 2.363569e-03 3 1  ON 32
ci_034                 4.136232e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539116e-03 3 1  ON 36
ci_038                 3.699750e-03 3 1  ON 37
ci_039                 4.622369e-03 3 1  ON 38
ci_040                 4.935569e-03 3 1  ON 39
ci_041                 2.971143e-03 3 1  ON 40
ci_042                 2.733791e-03 3 1  ON 41
ci_043                 2.944541e-03 3 1  ON 42
ci_044                 3.188319e-03 3 1  ON 43
ci_045                 2.451382e-03 3 1  ON 44
ci_046                 2.720973e-03 3 1  ON 45
ci_047                -1.002274e-03 3 1  ON 46
ci_048                -8.338316e-04 3 1  ON 47
ci_049                 7.784310e-04 3 1  ON 48
ci_050                 9.957335e-04 3 1  ON 49
ci_051                -3.147577e-04 3 1  ON 50
ci_052                -1.210500e-03 3 1  ON 51
ci_053                -2.434080e-03 3 1  ON 52
ci_054                -2.689529e-03 3 1  ON 53
ci_055                -1.798823e-03 3 1  ON 54
ci_056                -1.928501e-03 3 1  ON 55
ci_057                -1.307361e-03 3 1  ON 56
ci_058                -9.882847e-04 3 1  ON 57
ci_059                -5.507230e-04 3 1  ON 58
ci_060                -7.598480e-04 3 1  ON 59
ci_061                -5.109621e-05 3 1  ON 60
ci_062                -9.206516e-04 3 1  ON 61
ci_063                -8.861322e-04 3 1  ON 62
ci_064                -5.243973e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883910e-03 3 1  ON 65
ci_067                -1.812747e-03 3 1  ON 66
ci_068                -1.556831e-03 3 1  ON 67
ci_069                -5.543810e-04 3 1  ON 68
ci_070                -4.261992e-04 3 1  ON 69
ci_071                -2.087848e-03 3 1  ON 70
ci_072                -2.000805e-03 3 1  ON 71
ci_073                 1.611794e-04 3 1  ON 72
ci_074                 1.976724e-04 3 1  ON 73
ci_075                 1.618587e-04 3 1  ON 74
ci_076                 7.851093e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7165
    reference variance = 0.452877
====================================================
  Execution time = 2.5259e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5319e-01
  Total weights = 1.9554e+06
  Execution time = 3.6114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441723263280
                                         uncertainty =       0.002170299519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441723263280
                                         uncertainty =       0.002170299519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469984963
  error estimate for blocks of size 2^( 2) =       0.000493708888
  error estimate for blocks of size 2^( 3) =       0.000516387496
  error estimate for blocks of size 2^( 4) =       0.000532912923
  error estimate for blocks of size 2^( 5) =       0.000542424837
  error estimate for blocks of size 2^( 6) =       0.000546703989
  error estimate for blocks of size 2^( 7) =       0.000550894984

      target function =      -0.742698572141
              le_mean =     -22.661624560902
             les_mean =     514.002420536344
             stat err =       0.000543234183
             autocorr =       1.335999372905
   target nu stat err =       0.000543234183
   target dn stat err =       0.003560377737
      target stat err =       0.002958545224
              std dev =       0.664659108674
             le_variance =       0.441771730743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441723233647
                                         uncertainty =       0.002170294758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441723233647
                                         uncertainty =       0.002170294758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469984947
  error estimate for blocks of size 2^( 2) =       0.000493708875
  error estimate for blocks of size 2^( 3) =       0.000516387485
  error estimate for blocks of size 2^( 4) =       0.000532912911
  error estimate for blocks of size 2^( 5) =       0.000542424827
  error estimate for blocks of size 2^( 6) =       0.000546703981
  error estimate for blocks of size 2^( 7) =       0.000550894974

      target function =      -0.742698443479
              le_mean =     -22.661624560983
             les_mean =     514.002420698227
             stat err =       0.000543234173
             autocorr =       1.335999413526
   target nu stat err =       0.000543234173
   target dn stat err =       0.003560364359
      target stat err =       0.002958533551
              std dev =       0.664659086453
             le_variance =       0.441771701204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441723248463
                                         uncertainty =       0.002170297139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441723248463
                                         uncertainty =       0.002170297139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469984955
  error estimate for blocks of size 2^( 2) =       0.000493708882
  error estimate for blocks of size 2^( 3) =       0.000516387490
  error estimate for blocks of size 2^( 4) =       0.000532912917
  error estimate for blocks of size 2^( 5) =       0.000542424832
  error estimate for blocks of size 2^( 6) =       0.000546703985
  error estimate for blocks of size 2^( 7) =       0.000550894979

      target function =      -0.742698507848
              le_mean =     -22.661624560942
             les_mean =     514.002420617238
             stat err =       0.000543234178
             autocorr =       1.335999393216
   target nu stat err =       0.000543234178
   target dn stat err =       0.003560371043
      target stat err =       0.002958539384
              std dev =       0.664659097563
             le_variance =       0.441771715973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441723261428
                                         uncertainty =       0.002170299222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441723261428
                                         uncertainty =       0.002170299222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469984962
  error estimate for blocks of size 2^( 2) =       0.000493708888
  error estimate for blocks of size 2^( 3) =       0.000516387495
  error estimate for blocks of size 2^( 4) =       0.000532912922
  error estimate for blocks of size 2^( 5) =       0.000542424836
  error estimate for blocks of size 2^( 6) =       0.000546703989
  error estimate for blocks of size 2^( 7) =       0.000550894983

      target function =      -0.742698564109
              le_mean =     -22.661624560907
             les_mean =     514.002420546451
             stat err =       0.000543234182
             autocorr =       1.335999375446
   target nu stat err =       0.000543234182
   target dn stat err =       0.003560376900
      target stat err =       0.002958544493
              std dev =       0.664659107285
             le_variance =       0.441771728897


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742698572141        initial  <--
     2.2737e+03     2.2737e+04             8.4625e-08        -0.742698443479
     9.0949e+03     9.0949e+04             2.1156e-08        -0.742698507848
     3.6380e+04     3.6380e+05             5.2891e-09        -0.742698564109

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.3687
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098679e-03 3 1  ON 11
ci_013                 8.349371e-03 3 1  ON 12
ci_014                 9.369073e-03 3 1  ON 13
ci_015                 9.519403e-03 3 1  ON 14
ci_016                 9.412695e-03 3 1  ON 15
ci_017                 8.493682e-03 3 1  ON 16
ci_018                 8.286446e-03 3 1  ON 17
ci_019                -1.224140e-03 3 1  ON 18
ci_020                -1.536002e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919333e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466954e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081745e-03 3 1  ON 28
ci_030                -4.169873e-03 3 1  ON 29
ci_031                 3.329783e-03 3 1  ON 30
ci_032                 4.543537e-03 3 1  ON 31
ci_033                 2.363564e-03 3 1  ON 32
ci_034                 4.136238e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153599e-03 3 1  ON 35
ci_037                 3.539129e-03 3 1  ON 36
ci_038                 3.699754e-03 3 1  ON 37
ci_039                 4.622370e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944543e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338247e-04 3 1  ON 47
ci_049                 7.784305e-04 3 1  ON 48
ci_050                 9.957292e-04 3 1  ON 49
ci_051                -3.147592e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798828e-03 3 1  ON 54
ci_056                -1.928505e-03 3 1  ON 55
ci_057                -1.307368e-03 3 1  ON 56
ci_058                -9.882826e-04 3 1  ON 57
ci_059                -5.507189e-04 3 1  ON 58
ci_060                -7.598530e-04 3 1  ON 59
ci_061                -5.110108e-05 3 1  ON 60
ci_062                -9.206581e-04 3 1  ON 61
ci_063                -8.861428e-04 3 1  ON 62
ci_064                -5.243957e-04 3 1  ON 63
ci_065                -1.359384e-03 3 1  ON 64
ci_066                -1.883900e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543858e-04 3 1  ON 68
ci_070                -4.262042e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611770e-04 3 1  ON 72
ci_074                 1.976746e-04 3 1  ON 73
ci_075                 1.618560e-04 3 1  ON 74
ci_076                 7.851105e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2661e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.7117
    reference variance = 0.398926
====================================================
  Execution time = 2.5952e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5035e-01
  Total weights = 1.954971617e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440276247561
                                         uncertainty =       0.002835292222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440276247561
                                         uncertainty =       0.002835292222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469177174
  error estimate for blocks of size 2^( 2) =       0.000493338577
  error estimate for blocks of size 2^( 3) =       0.000515968630
  error estimate for blocks of size 2^( 4) =       0.000531904607
  error estimate for blocks of size 2^( 5) =       0.000541090921
  error estimate for blocks of size 2^( 6) =       0.000546204689
  error estimate for blocks of size 2^( 7) =       0.000551064848

      target function =      -0.745023244344
              le_mean =     -22.661994047232
             les_mean =     514.016326613966
             stat err =       0.000542566266
             autocorr =       1.337309181298
   target nu stat err =       0.000542566266
   target dn stat err =       0.003268284275
      target stat err =       0.002744089837
              std dev =       0.663516722743
             le_variance =       0.440254441360


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266199404723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745032496126       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745032496969       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745032497093       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745032497105       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745032497078       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745032497144       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745032497111       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745032497128       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745032497071       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+04 is 8.066576e-09

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745032496126       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745032496337       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745032496368       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745032496321       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745032496424       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745032496351       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745032496339       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745032496355       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745032496470       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+04 is 2.016646e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745032496126       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745032496179       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745032496187       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745032496238       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745032496343       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745032495954       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745032496269       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745032495669       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745032495837       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+05 is 5.041618e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203550 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0676e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098679e-03 3 1  ON 11
ci_013                 8.349370e-03 3 1  ON 12
ci_014                 9.369071e-03 3 1  ON 13
ci_015                 9.519402e-03 3 1  ON 14
ci_016                 9.412694e-03 3 1  ON 15
ci_017                 8.493682e-03 3 1  ON 16
ci_018                 8.286446e-03 3 1  ON 17
ci_019                -1.224142e-03 3 1  ON 18
ci_020                -1.536004e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919333e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466954e-03 3 1  ON 26
ci_028                 6.188386e-03 3 1  ON 27
ci_029                -5.081744e-03 3 1  ON 28
ci_030                -4.169872e-03 3 1  ON 29
ci_031                 3.329785e-03 3 1  ON 30
ci_032                 4.543538e-03 3 1  ON 31
ci_033                 2.363565e-03 3 1  ON 32
ci_034                 4.136237e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153599e-03 3 1  ON 35
ci_037                 3.539129e-03 3 1  ON 36
ci_038                 3.699754e-03 3 1  ON 37
ci_039                 4.622369e-03 3 1  ON 38
ci_040                 4.935570e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944544e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451383e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338244e-04 3 1  ON 47
ci_049                 7.784295e-04 3 1  ON 48
ci_050                 9.957289e-04 3 1  ON 49
ci_051                -3.147600e-04 3 1  ON 50
ci_052                -1.210502e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689529e-03 3 1  ON 53
ci_055                -1.798828e-03 3 1  ON 54
ci_056                -1.928504e-03 3 1  ON 55
ci_057                -1.307368e-03 3 1  ON 56
ci_058                -9.882823e-04 3 1  ON 57
ci_059                -5.507187e-04 3 1  ON 58
ci_060                -7.598525e-04 3 1  ON 59
ci_061                -5.110182e-05 3 1  ON 60
ci_062                -9.206574e-04 3 1  ON 61
ci_063                -8.861424e-04 3 1  ON 62
ci_064                -5.243957e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883899e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543856e-04 3 1  ON 68
ci_070                -4.262039e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611770e-04 3 1  ON 72
ci_074                 1.976748e-04 3 1  ON 73
ci_075                 1.618558e-04 3 1  ON 74
ci_076                 7.851101e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.6859
    reference variance = 0.81714
====================================================
  Execution time = 2.5039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5420e-01
  Total weights = 1.9550e+06
  Execution time = 3.6138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444650860846
                                         uncertainty =       0.004792684292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444650860846
                                         uncertainty =       0.004792684292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471545990
  error estimate for blocks of size 2^( 2) =       0.000495702318
  error estimate for blocks of size 2^( 3) =       0.000517958478
  error estimate for blocks of size 2^( 4) =       0.000533454698
  error estimate for blocks of size 2^( 5) =       0.000541400008
  error estimate for blocks of size 2^( 6) =       0.000545924779
  error estimate for blocks of size 2^( 7) =       0.000546545664

      target function =      -0.741843452360
              le_mean =     -22.660755170506
             les_mean =     513.964026040421
             stat err =       0.000541831287
             autocorr =       1.320322567729
   target nu stat err =       0.000541831287
   target dn stat err =       0.006811408344
      target stat err =       0.005556290426
              std dev =       0.666866733940
             le_variance =       0.444711240835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444650862223
                                         uncertainty =       0.004792687125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444650862223
                                         uncertainty =       0.004792687125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471545990
  error estimate for blocks of size 2^( 2) =       0.000495702319
  error estimate for blocks of size 2^( 3) =       0.000517958479
  error estimate for blocks of size 2^( 4) =       0.000533454699
  error estimate for blocks of size 2^( 5) =       0.000541400009
  error estimate for blocks of size 2^( 6) =       0.000545924780
  error estimate for blocks of size 2^( 7) =       0.000546545665

      target function =      -0.741843445709
              le_mean =     -22.660755170518
             les_mean =     513.964026049085
             stat err =       0.000541831288
             autocorr =       1.320322569080
   target nu stat err =       0.000541831288
   target dn stat err =       0.006811412747
      target stat err =       0.005556293878
              std dev =       0.666866734973
             le_variance =       0.444711242214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444650861534
                                         uncertainty =       0.004792685708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444650861534
                                         uncertainty =       0.004792685708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471545990
  error estimate for blocks of size 2^( 2) =       0.000495702318
  error estimate for blocks of size 2^( 3) =       0.000517958479
  error estimate for blocks of size 2^( 4) =       0.000533454698
  error estimate for blocks of size 2^( 5) =       0.000541400009
  error estimate for blocks of size 2^( 6) =       0.000545924779
  error estimate for blocks of size 2^( 7) =       0.000546545665

      target function =      -0.741843449038
              le_mean =     -22.660755170512
             les_mean =     513.964026044749
             stat err =       0.000541831288
             autocorr =       1.320322568404
   target nu stat err =       0.000541831288
   target dn stat err =       0.006811410545
      target stat err =       0.005556292152
              std dev =       0.666866734456
             le_variance =       0.444711241525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444650860932
                                         uncertainty =       0.004792684469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444650860932
                                         uncertainty =       0.004792684469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471545990
  error estimate for blocks of size 2^( 2) =       0.000495702318
  error estimate for blocks of size 2^( 3) =       0.000517958478
  error estimate for blocks of size 2^( 4) =       0.000533454698
  error estimate for blocks of size 2^( 5) =       0.000541400008
  error estimate for blocks of size 2^( 6) =       0.000545924779
  error estimate for blocks of size 2^( 7) =       0.000546545664

      target function =      -0.741843451945
              le_mean =     -22.660755170507
             les_mean =     513.964026040961
             stat err =       0.000541831287
             autocorr =       1.320322567818
   target nu stat err =       0.000541831287
   target dn stat err =       0.006811408619
      target stat err =       0.005556290642
              std dev =       0.666866734004
             le_variance =       0.444711240922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741843452360        initial  <--
     2.2737e+04     2.2737e+05             8.0666e-09        -0.741843445709
     9.0949e+04     9.0949e+05             2.0166e-09        -0.741843449038
     3.6380e+05     3.6380e+06             5.0416e-10        -0.741843451945

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1260
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098679e-03 3 1  ON 11
ci_013                 8.349371e-03 3 1  ON 12
ci_014                 9.369073e-03 3 1  ON 13
ci_015                 9.519403e-03 3 1  ON 14
ci_016                 9.412695e-03 3 1  ON 15
ci_017                 8.493682e-03 3 1  ON 16
ci_018                 8.286446e-03 3 1  ON 17
ci_019                -1.224140e-03 3 1  ON 18
ci_020                -1.536002e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919333e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466954e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081745e-03 3 1  ON 28
ci_030                -4.169873e-03 3 1  ON 29
ci_031                 3.329783e-03 3 1  ON 30
ci_032                 4.543537e-03 3 1  ON 31
ci_033                 2.363564e-03 3 1  ON 32
ci_034                 4.136238e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153599e-03 3 1  ON 35
ci_037                 3.539129e-03 3 1  ON 36
ci_038                 3.699754e-03 3 1  ON 37
ci_039                 4.622370e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944543e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338247e-04 3 1  ON 47
ci_049                 7.784305e-04 3 1  ON 48
ci_050                 9.957292e-04 3 1  ON 49
ci_051                -3.147592e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798828e-03 3 1  ON 54
ci_056                -1.928505e-03 3 1  ON 55
ci_057                -1.307368e-03 3 1  ON 56
ci_058                -9.882826e-04 3 1  ON 57
ci_059                -5.507189e-04 3 1  ON 58
ci_060                -7.598530e-04 3 1  ON 59
ci_061                -5.110108e-05 3 1  ON 60
ci_062                -9.206581e-04 3 1  ON 61
ci_063                -8.861428e-04 3 1  ON 62
ci_064                -5.243957e-04 3 1  ON 63
ci_065                -1.359384e-03 3 1  ON 64
ci_066                -1.883900e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543858e-04 3 1  ON 68
ci_070                -4.262042e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611770e-04 3 1  ON 72
ci_074                 1.976746e-04 3 1  ON 73
ci_075                 1.618560e-04 3 1  ON 74
ci_076                 7.851105e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6708
    reference variance = 1.0351
====================================================
  Execution time = 2.5703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5281e-01
  Total weights = 1.955482542e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442140029514
                                         uncertainty =       0.002301144961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442140029514
                                         uncertainty =       0.002301144961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470189680
  error estimate for blocks of size 2^( 2) =       0.000494236512
  error estimate for blocks of size 2^( 3) =       0.000515874879
  error estimate for blocks of size 2^( 4) =       0.000531724773
  error estimate for blocks of size 2^( 5) =       0.000542045075
  error estimate for blocks of size 2^( 6) =       0.000547850776
  error estimate for blocks of size 2^( 7) =       0.000551458770

      target function =      -0.743013453088
              le_mean =     -22.662147911256
             les_mean =     514.025762383911
             stat err =       0.000543269849
             autocorr =       1.335011538010
   target nu stat err =       0.000543269849
   target dn stat err =       0.003054843699
      target stat err =       0.002560903573
              std dev =       0.664948622418
             le_variance =       0.442156670456


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266214791126e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743021345002       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743021345086       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743021345099       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743021345101       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743021345101       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743021345000       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743021345063       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743021345101       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743021344589       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743021345101       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743021345496       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743021344870       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+05 is 9.214432e-10

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743021345002       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743021345023       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743021345026       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743021344816       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743021344964       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743021346672       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743021345077       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743021347018       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743021345239       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743021344515       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743021342708       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743021342825       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+05 is 2.303608e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743021345002       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743021345007       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743021345008       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743021345008       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743021344291       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743021345008       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743021347092       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743021353543       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743021339656       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743021340671       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743021342858       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743021347083       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+06 is 5.759020e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208369 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0427e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098679e-03 3 1  ON 11
ci_013                 8.349371e-03 3 1  ON 12
ci_014                 9.369073e-03 3 1  ON 13
ci_015                 9.519403e-03 3 1  ON 14
ci_016                 9.412695e-03 3 1  ON 15
ci_017                 8.493682e-03 3 1  ON 16
ci_018                 8.286446e-03 3 1  ON 17
ci_019                -1.224141e-03 3 1  ON 18
ci_020                -1.536002e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919333e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466953e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081745e-03 3 1  ON 28
ci_030                -4.169873e-03 3 1  ON 29
ci_031                 3.329783e-03 3 1  ON 30
ci_032                 4.543537e-03 3 1  ON 31
ci_033                 2.363564e-03 3 1  ON 32
ci_034                 4.136238e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153599e-03 3 1  ON 35
ci_037                 3.539129e-03 3 1  ON 36
ci_038                 3.699754e-03 3 1  ON 37
ci_039                 4.622370e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944543e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338247e-04 3 1  ON 47
ci_049                 7.784306e-04 3 1  ON 48
ci_050                 9.957292e-04 3 1  ON 49
ci_051                -3.147593e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798828e-03 3 1  ON 54
ci_056                -1.928505e-03 3 1  ON 55
ci_057                -1.307368e-03 3 1  ON 56
ci_058                -9.882826e-04 3 1  ON 57
ci_059                -5.507189e-04 3 1  ON 58
ci_060                -7.598530e-04 3 1  ON 59
ci_061                -5.110102e-05 3 1  ON 60
ci_062                -9.206581e-04 3 1  ON 61
ci_063                -8.861429e-04 3 1  ON 62
ci_064                -5.243957e-04 3 1  ON 63
ci_065                -1.359384e-03 3 1  ON 64
ci_066                -1.883900e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543858e-04 3 1  ON 68
ci_070                -4.262042e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611770e-04 3 1  ON 72
ci_074                 1.976746e-04 3 1  ON 73
ci_075                 1.618561e-04 3 1  ON 74
ci_076                 7.851104e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6856
    reference variance = 0.248377
====================================================
  Execution time = 2.5148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5388e-01
  Total weights = 1.9551e+06
  Execution time = 3.6290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442012749907
                                         uncertainty =       0.002858592440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442012749907
                                         uncertainty =       0.002858592440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470079918
  error estimate for blocks of size 2^( 2) =       0.000493954141
  error estimate for blocks of size 2^( 3) =       0.000516142732
  error estimate for blocks of size 2^( 4) =       0.000531922072
  error estimate for blocks of size 2^( 5) =       0.000540032287
  error estimate for blocks of size 2^( 6) =       0.000543477783
  error estimate for blocks of size 2^( 7) =       0.000548428100

      target function =      -0.742131534736
              le_mean =     -22.661986198606
             les_mean =     514.019501462569
             stat err =       0.000540965061
             autocorr =       1.324326399412
   target nu stat err =       0.000540965061
   target dn stat err =       0.004637635222
      target stat err =       0.003817461975
              std dev =       0.664793394907
             le_variance =       0.441950257913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442012749637
                                         uncertainty =       0.002858592439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442012749637
                                         uncertainty =       0.002858592439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470079917
  error estimate for blocks of size 2^( 2) =       0.000493954141
  error estimate for blocks of size 2^( 3) =       0.000516142732
  error estimate for blocks of size 2^( 4) =       0.000531922072
  error estimate for blocks of size 2^( 5) =       0.000540032287
  error estimate for blocks of size 2^( 6) =       0.000543477783
  error estimate for blocks of size 2^( 7) =       0.000548428100

      target function =      -0.742131535949
              le_mean =     -22.661986198603
             les_mean =     514.019501460962
             stat err =       0.000540965061
             autocorr =       1.324326399789
   target nu stat err =       0.000540965061
   target dn stat err =       0.004637635083
      target stat err =       0.003817461876
              std dev =       0.664793394704
             le_variance =       0.441950257642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442012749772
                                         uncertainty =       0.002858592439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442012749772
                                         uncertainty =       0.002858592439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470079918
  error estimate for blocks of size 2^( 2) =       0.000493954141
  error estimate for blocks of size 2^( 3) =       0.000516142732
  error estimate for blocks of size 2^( 4) =       0.000531922072
  error estimate for blocks of size 2^( 5) =       0.000540032287
  error estimate for blocks of size 2^( 6) =       0.000543477783
  error estimate for blocks of size 2^( 7) =       0.000548428100

      target function =      -0.742131535342
              le_mean =     -22.661986198604
             les_mean =     514.019501461765
             stat err =       0.000540965061
             autocorr =       1.324326399601
   target nu stat err =       0.000540965061
   target dn stat err =       0.004637635153
      target stat err =       0.003817461926
              std dev =       0.664793394805
             le_variance =       0.441950257777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442012749891
                                         uncertainty =       0.002858592440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442012749891
                                         uncertainty =       0.002858592440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470079918
  error estimate for blocks of size 2^( 2) =       0.000493954141
  error estimate for blocks of size 2^( 3) =       0.000516142732
  error estimate for blocks of size 2^( 4) =       0.000531922072
  error estimate for blocks of size 2^( 5) =       0.000540032287
  error estimate for blocks of size 2^( 6) =       0.000543477783
  error estimate for blocks of size 2^( 7) =       0.000548428100

      target function =      -0.742131534811
              le_mean =     -22.661986198605
             les_mean =     514.019501462468
             stat err =       0.000540965061
             autocorr =       1.324326399443
   target nu stat err =       0.000540965061
   target dn stat err =       0.004637635213
      target stat err =       0.003817461969
              std dev =       0.664793394895
             le_variance =       0.441950257896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742131534736        initial
     2.2737e+05     2.2737e+06             9.2144e-10        -0.742131535949  <--
     9.0949e+05     9.0949e+06             2.3036e-10        -0.742131535342
     3.6380e+06     3.6380e+07             5.7590e-11        -0.742131534811

*****************************************************************************
Applying the update for shift_i =   2.2737e+05     and shift_s =   2.2737e+06
*****************************************************************************

  Execution time = 4.3263e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207981e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098678e-03 3 1  ON 11
ci_013                 8.349371e-03 3 1  ON 12
ci_014                 9.369073e-03 3 1  ON 13
ci_015                 9.519402e-03 3 1  ON 14
ci_016                 9.412694e-03 3 1  ON 15
ci_017                 8.493683e-03 3 1  ON 16
ci_018                 8.286446e-03 3 1  ON 17
ci_019                -1.224141e-03 3 1  ON 18
ci_020                -1.536003e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919334e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466953e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081745e-03 3 1  ON 28
ci_030                -4.169873e-03 3 1  ON 29
ci_031                 3.329784e-03 3 1  ON 30
ci_032                 4.543537e-03 3 1  ON 31
ci_033                 2.363564e-03 3 1  ON 32
ci_034                 4.136237e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153599e-03 3 1  ON 35
ci_037                 3.539129e-03 3 1  ON 36
ci_038                 3.699754e-03 3 1  ON 37
ci_039                 4.622370e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944543e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451384e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338249e-04 3 1  ON 47
ci_049                 7.784306e-04 3 1  ON 48
ci_050                 9.957292e-04 3 1  ON 49
ci_051                -3.147595e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798828e-03 3 1  ON 54
ci_056                -1.928505e-03 3 1  ON 55
ci_057                -1.307368e-03 3 1  ON 56
ci_058                -9.882826e-04 3 1  ON 57
ci_059                -5.507188e-04 3 1  ON 58
ci_060                -7.598529e-04 3 1  ON 59
ci_061                -5.110084e-05 3 1  ON 60
ci_062                -9.206582e-04 3 1  ON 61
ci_063                -8.861433e-04 3 1  ON 62
ci_064                -5.243959e-04 3 1  ON 63
ci_065                -1.359384e-03 3 1  ON 64
ci_066                -1.883900e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543857e-04 3 1  ON 68
ci_070                -4.262041e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611770e-04 3 1  ON 72
ci_074                 1.976746e-04 3 1  ON 73
ci_075                 1.618563e-04 3 1  ON 74
ci_076                 7.851102e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6863
    reference variance = 0.250673
====================================================
  Execution time = 2.7935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5127e-01
  Total weights = 1.955180756e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438710808695
                                         uncertainty =       0.002300505843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438710808695
                                         uncertainty =       0.002300505843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468288492
  error estimate for blocks of size 2^( 2) =       0.000492844430
  error estimate for blocks of size 2^( 3) =       0.000514830372
  error estimate for blocks of size 2^( 4) =       0.000530927648
  error estimate for blocks of size 2^( 5) =       0.000541963161
  error estimate for blocks of size 2^( 6) =       0.000546106706
  error estimate for blocks of size 2^( 7) =       0.000549134379

      target function =      -0.744255132886
              le_mean =     -22.660826448698
             les_mean =     513.964328961661
             stat err =       0.000542032973
             autocorr =       1.339752090662
   target nu stat err =       0.000542032973
   target dn stat err =       0.003654329165
      target stat err =       0.003042138397
              std dev =       0.662259936103
             le_variance =       0.438588222967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266082644870e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744266670795       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744266671127       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744266671202       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744266671207       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744266671218       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744266671211       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744266671253       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744266671211       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744266671211       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744266671211       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744266671157       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+04 is 3.454979e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744266670795       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744266670878       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744266670896       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744266670927       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744266670898       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744266671088       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744266670899       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744266671198       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744266670899       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744266670412       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744266670981       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+05 is 8.637452e-10

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744266670795       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744266670815       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744266670820       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744266670820       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744266670821       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744266670821       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744266669228       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744266670821       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744266670160       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744266670911       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744266670821       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+05 is 2.159363e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2658e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098678e-03 3 1  ON 11
ci_013                 8.349370e-03 3 1  ON 12
ci_014                 9.369072e-03 3 1  ON 13
ci_015                 9.519402e-03 3 1  ON 14
ci_016                 9.412694e-03 3 1  ON 15
ci_017                 8.493683e-03 3 1  ON 16
ci_018                 8.286447e-03 3 1  ON 17
ci_019                -1.224142e-03 3 1  ON 18
ci_020                -1.536003e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919334e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466953e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081745e-03 3 1  ON 28
ci_030                -4.169872e-03 3 1  ON 29
ci_031                 3.329784e-03 3 1  ON 30
ci_032                 4.543537e-03 3 1  ON 31
ci_033                 2.363564e-03 3 1  ON 32
ci_034                 4.136237e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153599e-03 3 1  ON 35
ci_037                 3.539129e-03 3 1  ON 36
ci_038                 3.699754e-03 3 1  ON 37
ci_039                 4.622370e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944543e-03 3 1  ON 42
ci_044                 3.188313e-03 3 1  ON 43
ci_045                 2.451383e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338250e-04 3 1  ON 47
ci_049                 7.784308e-04 3 1  ON 48
ci_050                 9.957291e-04 3 1  ON 49
ci_051                -3.147599e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798828e-03 3 1  ON 54
ci_056                -1.928504e-03 3 1  ON 55
ci_057                -1.307368e-03 3 1  ON 56
ci_058                -9.882828e-04 3 1  ON 57
ci_059                -5.507186e-04 3 1  ON 58
ci_060                -7.598528e-04 3 1  ON 59
ci_061                -5.110106e-05 3 1  ON 60
ci_062                -9.206583e-04 3 1  ON 61
ci_063                -8.861435e-04 3 1  ON 62
ci_064                -5.243958e-04 3 1  ON 63
ci_065                -1.359384e-03 3 1  ON 64
ci_066                -1.883900e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543855e-04 3 1  ON 68
ci_070                -4.262040e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611767e-04 3 1  ON 72
ci_074                 1.976748e-04 3 1  ON 73
ci_075                 1.618560e-04 3 1  ON 74
ci_076                 7.851102e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.8057
    reference variance = 0.504813
====================================================
  Execution time = 2.5115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5636e-01
  Total weights = 1.9553e+06
  Execution time = 3.6034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441930510109
                                         uncertainty =       0.001989280309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441930510109
                                         uncertainty =       0.001989280309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470096777
  error estimate for blocks of size 2^( 2) =       0.000494395493
  error estimate for blocks of size 2^( 3) =       0.000516582931
  error estimate for blocks of size 2^( 4) =       0.000532679992
  error estimate for blocks of size 2^( 5) =       0.000543120485
  error estimate for blocks of size 2^( 6) =       0.000546549127
  error estimate for blocks of size 2^( 7) =       0.000548241118

      target function =      -0.740096700764
              le_mean =     -22.662116462428
             les_mean =     514.027883245754
             stat err =       0.000542647680
             autocorr =       1.332482011782
   target nu stat err =       0.000542647680
   target dn stat err =       0.007129156891
      target stat err =       0.005797163859
              std dev =       0.664817237407
             le_variance =       0.441981959154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441930509124
                                         uncertainty =       0.001989280246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441930509124
                                         uncertainty =       0.001989280246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470096776
  error estimate for blocks of size 2^( 2) =       0.000494395493
  error estimate for blocks of size 2^( 3) =       0.000516582931
  error estimate for blocks of size 2^( 4) =       0.000532679991
  error estimate for blocks of size 2^( 5) =       0.000543120485
  error estimate for blocks of size 2^( 6) =       0.000546549127
  error estimate for blocks of size 2^( 7) =       0.000548241118

      target function =      -0.740096705102
              le_mean =     -22.662116462435
             les_mean =     514.027883240778
             stat err =       0.000542647680
             autocorr =       1.332482013564
   target nu stat err =       0.000542647680
   target dn stat err =       0.007129152970
      target stat err =       0.005797160771
              std dev =       0.664817236671
             le_variance =       0.441981958175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441930509617
                                         uncertainty =       0.001989280278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441930509617
                                         uncertainty =       0.001989280278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470096777
  error estimate for blocks of size 2^( 2) =       0.000494395493
  error estimate for blocks of size 2^( 3) =       0.000516582931
  error estimate for blocks of size 2^( 4) =       0.000532679991
  error estimate for blocks of size 2^( 5) =       0.000543120485
  error estimate for blocks of size 2^( 6) =       0.000546549127
  error estimate for blocks of size 2^( 7) =       0.000548241118

      target function =      -0.740096702933
              le_mean =     -22.662116462431
             les_mean =     514.027883243266
             stat err =       0.000542647680
             autocorr =       1.332482012680
   target nu stat err =       0.000542647680
   target dn stat err =       0.007129154930
      target stat err =       0.005797162315
              std dev =       0.664817237039
             le_variance =       0.441981958665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441930510048
                                         uncertainty =       0.001989280306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441930510048
                                         uncertainty =       0.001989280306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470096777
  error estimate for blocks of size 2^( 2) =       0.000494395493
  error estimate for blocks of size 2^( 3) =       0.000516582931
  error estimate for blocks of size 2^( 4) =       0.000532679992
  error estimate for blocks of size 2^( 5) =       0.000543120485
  error estimate for blocks of size 2^( 6) =       0.000546549127
  error estimate for blocks of size 2^( 7) =       0.000548241118

      target function =      -0.740096701035
              le_mean =     -22.662116462428
             les_mean =     514.027883245443
             stat err =       0.000542647680
             autocorr =       1.332482011900
   target nu stat err =       0.000542647680
   target dn stat err =       0.007129156646
      target stat err =       0.005797163666
              std dev =       0.664817237362
             le_variance =       0.441981959093


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740096700764        initial
     5.6843e+04     5.6843e+05             3.4550e-09        -0.740096705102  <--
     2.2737e+05     2.2737e+06             8.6375e-10        -0.740096702933
     9.0949e+05     9.0949e+06             2.1594e-10        -0.740096701035

*****************************************************************************
Applying the update for shift_i =   5.6843e+04     and shift_s =   5.6843e+05
*****************************************************************************

  Execution time = 4.6765e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098677e-03 3 1  ON 11
ci_013                 8.349368e-03 3 1  ON 12
ci_014                 9.369071e-03 3 1  ON 13
ci_015                 9.519401e-03 3 1  ON 14
ci_016                 9.412692e-03 3 1  ON 15
ci_017                 8.493682e-03 3 1  ON 16
ci_018                 8.286447e-03 3 1  ON 17
ci_019                -1.224145e-03 3 1  ON 18
ci_020                -1.536004e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919334e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466952e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081745e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329784e-03 3 1  ON 30
ci_032                 4.543538e-03 3 1  ON 31
ci_033                 2.363565e-03 3 1  ON 32
ci_034                 4.136237e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539128e-03 3 1  ON 36
ci_038                 3.699752e-03 3 1  ON 37
ci_039                 4.622370e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944544e-03 3 1  ON 42
ci_044                 3.188312e-03 3 1  ON 43
ci_045                 2.451383e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338253e-04 3 1  ON 47
ci_049                 7.784313e-04 3 1  ON 48
ci_050                 9.957288e-04 3 1  ON 49
ci_051                -3.147614e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798827e-03 3 1  ON 54
ci_056                -1.928503e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882834e-04 3 1  ON 57
ci_059                -5.507182e-04 3 1  ON 58
ci_060                -7.598527e-04 3 1  ON 59
ci_061                -5.110175e-05 3 1  ON 60
ci_062                -9.206585e-04 3 1  ON 61
ci_063                -8.861442e-04 3 1  ON 62
ci_064                -5.243958e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556828e-03 3 1  ON 67
ci_069                -5.543850e-04 3 1  ON 68
ci_070                -4.262036e-04 3 1  ON 69
ci_071                -2.087847e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611761e-04 3 1  ON 72
ci_074                 1.976754e-04 3 1  ON 73
ci_075                 1.618553e-04 3 1  ON 74
ci_076                 7.851100e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.7206
    reference variance = 0.456209
====================================================
  Execution time = 2.5783e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4793e-01
  Total weights = 1.955280576e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437509955814
                                         uncertainty =       0.002026754413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437509955814
                                         uncertainty =       0.002026754413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467718962
  error estimate for blocks of size 2^( 2) =       0.000492095801
  error estimate for blocks of size 2^( 3) =       0.000514072538
  error estimate for blocks of size 2^( 4) =       0.000530315465
  error estimate for blocks of size 2^( 5) =       0.000539228191
  error estimate for blocks of size 2^( 6) =       0.000546411367
  error estimate for blocks of size 2^( 7) =       0.000549735826

      target function =      -0.747007833964
              le_mean =     -22.661371891080
             les_mean =     513.985707222191
             stat err =       0.000541422712
             autocorr =       1.339994405862
   target nu stat err =       0.000541422712
   target dn stat err =       0.002603013808
      target stat err =       0.002224114185
              std dev =       0.661454499701
             le_variance =       0.437522055174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266137189108e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+04, overlap shift 1.4211e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747013510781       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747013511856       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747013512132       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747013512170       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747013512171       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747013512171       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747013512172       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747013512170       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747013512148       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747013512170       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+04 is 1.998132e-08

solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747013510781       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747013511049       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747013511119       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747013511128       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747013511128       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747013511128       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747013511129       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747013511005       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747013511128       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747013511008       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+04 is 4.995340e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747013510781       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747013510848       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747013510865       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747013510870       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747013510868       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747013510050       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747013510875       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747013510868       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747013511068       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747013510707       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+05 is 1.248836e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0482e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098676e-03 3 1  ON 11
ci_013                 8.349367e-03 3 1  ON 12
ci_014                 9.369069e-03 3 1  ON 13
ci_015                 9.519400e-03 3 1  ON 14
ci_016                 9.412691e-03 3 1  ON 15
ci_017                 8.493681e-03 3 1  ON 16
ci_018                 8.286446e-03 3 1  ON 17
ci_019                -1.224148e-03 3 1  ON 18
ci_020                -1.536007e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854112e-03 3 1  ON 22
ci_024                 4.919333e-03 3 1  ON 23
ci_025                 1.143642e-02 3 1  ON 24
ci_026                 1.147268e-02 3 1  ON 25
ci_027                 6.466953e-03 3 1  ON 26
ci_028                 6.188384e-03 3 1  ON 27
ci_029                -5.081744e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329787e-03 3 1  ON 30
ci_032                 4.543540e-03 3 1  ON 31
ci_033                 2.363565e-03 3 1  ON 32
ci_034                 4.136236e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539128e-03 3 1  ON 36
ci_038                 3.699751e-03 3 1  ON 37
ci_039                 4.622370e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971142e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944544e-03 3 1  ON 42
ci_044                 3.188313e-03 3 1  ON 43
ci_045                 2.451383e-03 3 1  ON 44
ci_046                 2.720983e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338257e-04 3 1  ON 47
ci_049                 7.784315e-04 3 1  ON 48
ci_050                 9.957284e-04 3 1  ON 49
ci_051                -3.147623e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689529e-03 3 1  ON 53
ci_055                -1.798827e-03 3 1  ON 54
ci_056                -1.928504e-03 3 1  ON 55
ci_057                -1.307366e-03 3 1  ON 56
ci_058                -9.882834e-04 3 1  ON 57
ci_059                -5.507170e-04 3 1  ON 58
ci_060                -7.598522e-04 3 1  ON 59
ci_061                -5.110231e-05 3 1  ON 60
ci_062                -9.206582e-04 3 1  ON 61
ci_063                -8.861446e-04 3 1  ON 62
ci_064                -5.243964e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556827e-03 3 1  ON 67
ci_069                -5.543845e-04 3 1  ON 68
ci_070                -4.262028e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611752e-04 3 1  ON 72
ci_074                 1.976751e-04 3 1  ON 73
ci_075                 1.618547e-04 3 1  ON 74
ci_076                 7.851100e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6298
    reference variance = 0.48864
====================================================
  Execution time = 2.5065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4468e-01
  Total weights = 1.9554e+06
  Execution time = 3.6177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437256847244
                                         uncertainty =       0.002281621305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437256847244
                                         uncertainty =       0.002281621305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467571868
  error estimate for blocks of size 2^( 2) =       0.000491951617
  error estimate for blocks of size 2^( 3) =       0.000513893077
  error estimate for blocks of size 2^( 4) =       0.000529191647
  error estimate for blocks of size 2^( 5) =       0.000537569736
  error estimate for blocks of size 2^( 6) =       0.000544323572
  error estimate for blocks of size 2^( 7) =       0.000545411438

      target function =      -0.749723345345
              le_mean =     -22.663158136203
             les_mean =     514.063418068972
             stat err =       0.000539124098
             autocorr =       1.329476739719
   target nu stat err =       0.000539124098
   target dn stat err =       0.002391456363
      target stat err =       0.002075973446
              std dev =       0.661246476640
             le_variance =       0.437246902869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437256842975
                                         uncertainty =       0.002281621129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437256842975
                                         uncertainty =       0.002281621129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467571865
  error estimate for blocks of size 2^( 2) =       0.000491951615
  error estimate for blocks of size 2^( 3) =       0.000513893075
  error estimate for blocks of size 2^( 4) =       0.000529191646
  error estimate for blocks of size 2^( 5) =       0.000537569734
  error estimate for blocks of size 2^( 6) =       0.000544323571
  error estimate for blocks of size 2^( 7) =       0.000545411437

      target function =      -0.749723341920
              le_mean =     -22.663158136260
             les_mean =     514.063418075672
             stat err =       0.000539124097
             autocorr =       1.329476745101
   target nu stat err =       0.000539124097
   target dn stat err =       0.002391456427
      target stat err =       0.002075973478
              std dev =       0.661246473376
             le_variance =       0.437246898552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437256845110
                                         uncertainty =       0.002281621217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437256845110
                                         uncertainty =       0.002281621217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467571867
  error estimate for blocks of size 2^( 2) =       0.000491951616
  error estimate for blocks of size 2^( 3) =       0.000513893076
  error estimate for blocks of size 2^( 4) =       0.000529191646
  error estimate for blocks of size 2^( 5) =       0.000537569735
  error estimate for blocks of size 2^( 6) =       0.000544323571
  error estimate for blocks of size 2^( 7) =       0.000545411437

      target function =      -0.749723343633
              le_mean =     -22.663158136232
             les_mean =     514.063418072321
             stat err =       0.000539124098
             autocorr =       1.329476742418
   target nu stat err =       0.000539124098
   target dn stat err =       0.002391456395
      target stat err =       0.002075973462
              std dev =       0.661246475008
             le_variance =       0.437246900711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437256846977
                                         uncertainty =       0.002281621294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437256846977
                                         uncertainty =       0.002281621294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467571868
  error estimate for blocks of size 2^( 2) =       0.000491951617
  error estimate for blocks of size 2^( 3) =       0.000513893077
  error estimate for blocks of size 2^( 4) =       0.000529191647
  error estimate for blocks of size 2^( 5) =       0.000537569736
  error estimate for blocks of size 2^( 6) =       0.000544323572
  error estimate for blocks of size 2^( 7) =       0.000545411438

      target function =      -0.749723345131
              le_mean =     -22.663158136207
             les_mean =     514.063418069391
             stat err =       0.000539124098
             autocorr =       1.329476740052
   target nu stat err =       0.000539124098
   target dn stat err =       0.002391456367
      target stat err =       0.002075973448
              std dev =       0.661246476436
             le_variance =       0.437246902599


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749723345345        initial  <--
     1.4211e+04     1.4211e+05             1.9981e-08        -0.749723341920
     5.6843e+04     5.6843e+05             4.9953e-09        -0.749723343633
     2.2737e+05     2.2737e+06             1.2488e-09        -0.749723345131

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1948
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098677e-03 3 1  ON 11
ci_013                 8.349368e-03 3 1  ON 12
ci_014                 9.369071e-03 3 1  ON 13
ci_015                 9.519401e-03 3 1  ON 14
ci_016                 9.412692e-03 3 1  ON 15
ci_017                 8.493682e-03 3 1  ON 16
ci_018                 8.286447e-03 3 1  ON 17
ci_019                -1.224145e-03 3 1  ON 18
ci_020                -1.536004e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919334e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466952e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081745e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329784e-03 3 1  ON 30
ci_032                 4.543538e-03 3 1  ON 31
ci_033                 2.363565e-03 3 1  ON 32
ci_034                 4.136237e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539128e-03 3 1  ON 36
ci_038                 3.699752e-03 3 1  ON 37
ci_039                 4.622370e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944544e-03 3 1  ON 42
ci_044                 3.188312e-03 3 1  ON 43
ci_045                 2.451383e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338253e-04 3 1  ON 47
ci_049                 7.784313e-04 3 1  ON 48
ci_050                 9.957288e-04 3 1  ON 49
ci_051                -3.147614e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798827e-03 3 1  ON 54
ci_056                -1.928503e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882834e-04 3 1  ON 57
ci_059                -5.507182e-04 3 1  ON 58
ci_060                -7.598527e-04 3 1  ON 59
ci_061                -5.110175e-05 3 1  ON 60
ci_062                -9.206585e-04 3 1  ON 61
ci_063                -8.861442e-04 3 1  ON 62
ci_064                -5.243958e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556828e-03 3 1  ON 67
ci_069                -5.543850e-04 3 1  ON 68
ci_070                -4.262036e-04 3 1  ON 69
ci_071                -2.087847e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611761e-04 3 1  ON 72
ci_074                 1.976754e-04 3 1  ON 73
ci_075                 1.618553e-04 3 1  ON 74
ci_076                 7.851100e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3683e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7233
    reference variance = 0.423121
====================================================
  Execution time = 2.5647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5917e-01
  Total weights = 1.955226098e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447996590441
                                         uncertainty =       0.004840170146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447996590441
                                         uncertainty =       0.004840170146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473278598
  error estimate for blocks of size 2^( 2) =       0.000497250790
  error estimate for blocks of size 2^( 3) =       0.000519227601
  error estimate for blocks of size 2^( 4) =       0.000534797243
  error estimate for blocks of size 2^( 5) =       0.000543687728
  error estimate for blocks of size 2^( 6) =       0.000548305074
  error estimate for blocks of size 2^( 7) =       0.000551478291

      target function =      -0.737837773183
              le_mean =     -22.662079455814
             les_mean =     514.029019051543
             stat err =       0.000544567084
             autocorr =       1.323942253324
   target nu stat err =       0.000544567084
   target dn stat err =       0.006314854725
      target stat err =       0.005111137869
              std dev =       0.669317011954
             le_variance =       0.447985262490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266207945581e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737872594244       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737872594440       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737872594477       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737872594480       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737872594839       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737872594610       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737872594832       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737872594485       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737872594819       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737872594799       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737872594485       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737872594523       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+05 is 1.658458e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737872594244       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737872594293       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737872594303       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737872594303       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737872594304       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737872594255       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737872594304       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737872593626       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737872594304       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737872594305       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737872594304       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737872594970       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+05 is 4.146145e-10

solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737872594244       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737872594257       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737872594259       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737872594259       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737872595607       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737872593770       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737872594633       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737872596666       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737872585796       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737872592492       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737872599293       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737872592013       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+06 is 1.036536e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220893 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0380e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098677e-03 3 1  ON 11
ci_013                 8.349368e-03 3 1  ON 12
ci_014                 9.369071e-03 3 1  ON 13
ci_015                 9.519400e-03 3 1  ON 14
ci_016                 9.412692e-03 3 1  ON 15
ci_017                 8.493682e-03 3 1  ON 16
ci_018                 8.286447e-03 3 1  ON 17
ci_019                -1.224145e-03 3 1  ON 18
ci_020                -1.536004e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179935e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919334e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466952e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081744e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329784e-03 3 1  ON 30
ci_032                 4.543539e-03 3 1  ON 31
ci_033                 2.363565e-03 3 1  ON 32
ci_034                 4.136237e-03 3 1  ON 33
ci_035                 1.723729e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539128e-03 3 1  ON 36
ci_038                 3.699752e-03 3 1  ON 37
ci_039                 4.622369e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944543e-03 3 1  ON 42
ci_044                 3.188312e-03 3 1  ON 43
ci_045                 2.451382e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338253e-04 3 1  ON 47
ci_049                 7.784313e-04 3 1  ON 48
ci_050                 9.957287e-04 3 1  ON 49
ci_051                -3.147615e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798827e-03 3 1  ON 54
ci_056                -1.928503e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882834e-04 3 1  ON 57
ci_059                -5.507182e-04 3 1  ON 58
ci_060                -7.598525e-04 3 1  ON 59
ci_061                -5.110187e-05 3 1  ON 60
ci_062                -9.206588e-04 3 1  ON 61
ci_063                -8.861442e-04 3 1  ON 62
ci_064                -5.243956e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556828e-03 3 1  ON 67
ci_069                -5.543849e-04 3 1  ON 68
ci_070                -4.262036e-04 3 1  ON 69
ci_071                -2.087847e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611761e-04 3 1  ON 72
ci_074                 1.976753e-04 3 1  ON 73
ci_075                 1.618553e-04 3 1  ON 74
ci_076                 7.851101e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.7099
    reference variance = 0.341837
====================================================
  Execution time = 2.5110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5037e-01
  Total weights = 1.9561e+06
  Execution time = 3.6139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440736465616
                                         uncertainty =       0.003875785422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440736465616
                                         uncertainty =       0.003875785422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469382465
  error estimate for blocks of size 2^( 2) =       0.000493667320
  error estimate for blocks of size 2^( 3) =       0.000516128373
  error estimate for blocks of size 2^( 4) =       0.000532137906
  error estimate for blocks of size 2^( 5) =       0.000540566908
  error estimate for blocks of size 2^( 6) =       0.000544001717
  error estimate for blocks of size 2^( 7) =       0.000546807319

      target function =      -0.744994394403
              le_mean =     -22.661417645604
             les_mean =     513.990220564108
             stat err =       0.000540878462
             autocorr =       1.327839713408
   target nu stat err =       0.000540878462
   target dn stat err =       0.004419238952
      target stat err =       0.003666806458
              std dev =       0.663807048352
             le_variance =       0.440639797441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440736465183
                                         uncertainty =       0.003875785351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440736465183
                                         uncertainty =       0.003875785351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469382465
  error estimate for blocks of size 2^( 2) =       0.000493667320
  error estimate for blocks of size 2^( 3) =       0.000516128372
  error estimate for blocks of size 2^( 4) =       0.000532137906
  error estimate for blocks of size 2^( 5) =       0.000540566908
  error estimate for blocks of size 2^( 6) =       0.000544001716
  error estimate for blocks of size 2^( 7) =       0.000546807319

      target function =      -0.744994400219
              le_mean =     -22.661417645603
             les_mean =     513.990220556947
             stat err =       0.000540878462
             autocorr =       1.327839714248
   target nu stat err =       0.000540878462
   target dn stat err =       0.004419238761
      target stat err =       0.003666806360
              std dev =       0.663807048027
             le_variance =       0.440639797010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440736465399
                                         uncertainty =       0.003875785386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440736465399
                                         uncertainty =       0.003875785386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469382465
  error estimate for blocks of size 2^( 2) =       0.000493667320
  error estimate for blocks of size 2^( 3) =       0.000516128372
  error estimate for blocks of size 2^( 4) =       0.000532137906
  error estimate for blocks of size 2^( 5) =       0.000540566908
  error estimate for blocks of size 2^( 6) =       0.000544001716
  error estimate for blocks of size 2^( 7) =       0.000546807319

      target function =      -0.744994397311
              le_mean =     -22.661417645603
             les_mean =     513.990220560528
             stat err =       0.000540878462
             autocorr =       1.327839713825
   target nu stat err =       0.000540878462
   target dn stat err =       0.004419238857
      target stat err =       0.003666806409
              std dev =       0.663807048189
             le_variance =       0.440639797226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440736465589
                                         uncertainty =       0.003875785418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440736465589
                                         uncertainty =       0.003875785418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469382465
  error estimate for blocks of size 2^( 2) =       0.000493667320
  error estimate for blocks of size 2^( 3) =       0.000516128373
  error estimate for blocks of size 2^( 4) =       0.000532137906
  error estimate for blocks of size 2^( 5) =       0.000540566908
  error estimate for blocks of size 2^( 6) =       0.000544001717
  error estimate for blocks of size 2^( 7) =       0.000546807319

      target function =      -0.744994394767
              le_mean =     -22.661417645604
             les_mean =     513.990220563661
             stat err =       0.000540878462
             autocorr =       1.327839713453
   target nu stat err =       0.000540878462
   target dn stat err =       0.004419238940
      target stat err =       0.003666806452
              std dev =       0.663807048331
             le_variance =       0.440639797414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744994394403        initial
     1.4211e+05     1.4211e+06             1.6585e-09        -0.744994400219  <--
     5.6843e+05     5.6843e+06             4.1461e-10        -0.744994397311
     2.2737e+06     2.2737e+07             1.0365e-10        -0.744994394767

*****************************************************************************
Applying the update for shift_i =   1.4211e+05     and shift_s =   1.4211e+06
*****************************************************************************

  Execution time = 4.3174e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098677e-03 3 1  ON 11
ci_013                 8.349367e-03 3 1  ON 12
ci_014                 9.369071e-03 3 1  ON 13
ci_015                 9.519400e-03 3 1  ON 14
ci_016                 9.412691e-03 3 1  ON 15
ci_017                 8.493681e-03 3 1  ON 16
ci_018                 8.286447e-03 3 1  ON 17
ci_019                -1.224145e-03 3 1  ON 18
ci_020                -1.536005e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919333e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147267e-02 3 1  ON 25
ci_027                 6.466952e-03 3 1  ON 26
ci_028                 6.188385e-03 3 1  ON 27
ci_029                -5.081744e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329785e-03 3 1  ON 30
ci_032                 4.543540e-03 3 1  ON 31
ci_033                 2.363566e-03 3 1  ON 32
ci_034                 4.136237e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539128e-03 3 1  ON 36
ci_038                 3.699752e-03 3 1  ON 37
ci_039                 4.622369e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944543e-03 3 1  ON 42
ci_044                 3.188312e-03 3 1  ON 43
ci_045                 2.451382e-03 3 1  ON 44
ci_046                 2.720983e-03 3 1  ON 45
ci_047                -1.002269e-03 3 1  ON 46
ci_048                -8.338251e-04 3 1  ON 47
ci_049                 7.784313e-04 3 1  ON 48
ci_050                 9.957286e-04 3 1  ON 49
ci_051                -3.147618e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798827e-03 3 1  ON 54
ci_056                -1.928502e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882833e-04 3 1  ON 57
ci_059                -5.507181e-04 3 1  ON 58
ci_060                -7.598519e-04 3 1  ON 59
ci_061                -5.110224e-05 3 1  ON 60
ci_062                -9.206596e-04 3 1  ON 61
ci_063                -8.861440e-04 3 1  ON 62
ci_064                -5.243950e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556828e-03 3 1  ON 67
ci_069                -5.543847e-04 3 1  ON 68
ci_070                -4.262037e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611762e-04 3 1  ON 72
ci_074                 1.976750e-04 3 1  ON 73
ci_075                 1.618554e-04 3 1  ON 74
ci_076                 7.851104e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.5965
    reference variance = 0.263512
====================================================
  Execution time = 2.5630e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5583e-01
  Total weights = 1.955154151e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445065052377
                                         uncertainty =       0.002426217022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445065052377
                                         uncertainty =       0.002426217022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471742867
  error estimate for blocks of size 2^( 2) =       0.000496023830
  error estimate for blocks of size 2^( 3) =       0.000518346919
  error estimate for blocks of size 2^( 4) =       0.000534654967
  error estimate for blocks of size 2^( 5) =       0.000543391086
  error estimate for blocks of size 2^( 6) =       0.000548252289
  error estimate for blocks of size 2^( 7) =       0.000551058041

      target function =      -0.740565842739
              le_mean =     -22.662351554763
             les_mean =     514.038003950285
             stat err =       0.000544339096
             autocorr =       1.331460757679
   target nu stat err =       0.000544339096
   target dn stat err =       0.003249254307
      target stat err =       0.002698943684
              std dev =       0.667145160079
             le_variance =       0.445082664617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266235155476e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740574790194       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740574790649       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740574790723       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740574790735       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740574790738       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740574790731       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740574790744       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740574790690       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740574790708       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740574790741       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740574790819       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+04 is 5.086046e-09

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740574790194       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740574790308       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740574790326       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740574790316       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740574790273       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740574790327       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740574790361       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740574790682       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740574789706       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740574789698       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740574790171       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+05 is 1.271512e-09

solving harmonic davidson linear method for identity shift 5.6843e+05, overlap shift 5.6843e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740574790194       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740574790222       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740574790227       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740574790228       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740574790220       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740574789680       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740574791036       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740574790701       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740574790318       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740574788224       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740574789545       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+05 is 3.178782e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0350e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320071e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910139e-03 3 1  ON 10
ci_012                -9.098677e-03 3 1  ON 11
ci_013                 8.349368e-03 3 1  ON 12
ci_014                 9.369070e-03 3 1  ON 13
ci_015                 9.519400e-03 3 1  ON 14
ci_016                 9.412691e-03 3 1  ON 15
ci_017                 8.493681e-03 3 1  ON 16
ci_018                 8.286447e-03 3 1  ON 17
ci_019                -1.224146e-03 3 1  ON 18
ci_020                -1.536006e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919333e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147268e-02 3 1  ON 25
ci_027                 6.466951e-03 3 1  ON 26
ci_028                 6.188384e-03 3 1  ON 27
ci_029                -5.081743e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329786e-03 3 1  ON 30
ci_032                 4.543540e-03 3 1  ON 31
ci_033                 2.363566e-03 3 1  ON 32
ci_034                 4.136236e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539128e-03 3 1  ON 36
ci_038                 3.699752e-03 3 1  ON 37
ci_039                 4.622368e-03 3 1  ON 38
ci_040                 4.935571e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944543e-03 3 1  ON 42
ci_044                 3.188312e-03 3 1  ON 43
ci_045                 2.451382e-03 3 1  ON 44
ci_046                 2.720983e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338250e-04 3 1  ON 47
ci_049                 7.784317e-04 3 1  ON 48
ci_050                 9.957275e-04 3 1  ON 49
ci_051                -3.147620e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798827e-03 3 1  ON 54
ci_056                -1.928502e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882835e-04 3 1  ON 57
ci_059                -5.507178e-04 3 1  ON 58
ci_060                -7.598519e-04 3 1  ON 59
ci_061                -5.110266e-05 3 1  ON 60
ci_062                -9.206591e-04 3 1  ON 61
ci_063                -8.861433e-04 3 1  ON 62
ci_064                -5.243949e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556828e-03 3 1  ON 67
ci_069                -5.543849e-04 3 1  ON 68
ci_070                -4.262038e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000809e-03 3 1  ON 71
ci_073                 1.611760e-04 3 1  ON 72
ci_074                 1.976750e-04 3 1  ON 73
ci_075                 1.618553e-04 3 1  ON 74
ci_076                 7.851103e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6812
    reference variance = 0.47508
====================================================
  Execution time = 2.4991e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4808e-01
  Total weights = 1.9554e+06
  Execution time = 3.6205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117926494
                                         uncertainty =       0.002278651704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117926494
                                         uncertainty =       0.002278651704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469072079
  error estimate for blocks of size 2^( 2) =       0.000493198567
  error estimate for blocks of size 2^( 3) =       0.000514808142
  error estimate for blocks of size 2^( 4) =       0.000531317264
  error estimate for blocks of size 2^( 5) =       0.000540921252
  error estimate for blocks of size 2^( 6) =       0.000545137882
  error estimate for blocks of size 2^( 7) =       0.000547957312

      target function =      -0.746896103550
              le_mean =     -22.662238953953
             les_mean =     514.025155112534
             stat err =       0.000541333428
             autocorr =       1.331835312366
   target nu stat err =       0.000541333428
   target dn stat err =       0.002648409946
      target stat err =       0.002262349452
              std dev =       0.663368096116
             le_variance =       0.440057230945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117925855
                                         uncertainty =       0.002278651754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117925855
                                         uncertainty =       0.002278651754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469072079
  error estimate for blocks of size 2^( 2) =       0.000493198567
  error estimate for blocks of size 2^( 3) =       0.000514808142
  error estimate for blocks of size 2^( 4) =       0.000531317264
  error estimate for blocks of size 2^( 5) =       0.000540921252
  error estimate for blocks of size 2^( 6) =       0.000545137882
  error estimate for blocks of size 2^( 7) =       0.000547957312

      target function =      -0.746896106363
              le_mean =     -22.662238953940
             les_mean =     514.025155108527
             stat err =       0.000541333428
             autocorr =       1.331835314355
   target nu stat err =       0.000541333428
   target dn stat err =       0.002648409743
      target stat err =       0.002262349307
              std dev =       0.663368095634
             le_variance =       0.440057230305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117926175
                                         uncertainty =       0.002278651729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117926175
                                         uncertainty =       0.002278651729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469072079
  error estimate for blocks of size 2^( 2) =       0.000493198567
  error estimate for blocks of size 2^( 3) =       0.000514808142
  error estimate for blocks of size 2^( 4) =       0.000531317264
  error estimate for blocks of size 2^( 5) =       0.000540921252
  error estimate for blocks of size 2^( 6) =       0.000545137882
  error estimate for blocks of size 2^( 7) =       0.000547957312

      target function =      -0.746896104957
              le_mean =     -22.662238953947
             les_mean =     514.025155110530
             stat err =       0.000541333428
             autocorr =       1.331835313352
   target nu stat err =       0.000541333428
   target dn stat err =       0.002648409845
      target stat err =       0.002262349379
              std dev =       0.663368095876
             le_variance =       0.440057230626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117926454
                                         uncertainty =       0.002278651708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440117926454
                                         uncertainty =       0.002278651708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469072079
  error estimate for blocks of size 2^( 2) =       0.000493198567
  error estimate for blocks of size 2^( 3) =       0.000514808142
  error estimate for blocks of size 2^( 4) =       0.000531317264
  error estimate for blocks of size 2^( 5) =       0.000540921252
  error estimate for blocks of size 2^( 6) =       0.000545137882
  error estimate for blocks of size 2^( 7) =       0.000547957312

      target function =      -0.746896103726
              le_mean =     -22.662238953953
             les_mean =     514.025155112284
             stat err =       0.000541333428
             autocorr =       1.331835312493
   target nu stat err =       0.000541333428
   target dn stat err =       0.002648409934
      target stat err =       0.002262349443
              std dev =       0.663368096086
             le_variance =       0.440057230905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746896103550        initial
     3.5527e+04     3.5527e+05             5.0860e-09        -0.746896106363  <--
     1.4211e+05     1.4211e+06             1.2715e-09        -0.746896104957
     5.6843e+05     5.6843e+06             3.1788e-10        -0.746896103726

*****************************************************************************
Applying the update for shift_i =   3.5527e+04     and shift_s =   3.5527e+05
*****************************************************************************

  Execution time = 4.3083e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320070e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910138e-03 3 1  ON 10
ci_012                -9.098678e-03 3 1  ON 11
ci_013                 8.349369e-03 3 1  ON 12
ci_014                 9.369069e-03 3 1  ON 13
ci_015                 9.519398e-03 3 1  ON 14
ci_016                 9.412691e-03 3 1  ON 15
ci_017                 8.493680e-03 3 1  ON 16
ci_018                 8.286447e-03 3 1  ON 17
ci_019                -1.224149e-03 3 1  ON 18
ci_020                -1.536010e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854114e-03 3 1  ON 22
ci_024                 4.919331e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147268e-02 3 1  ON 25
ci_027                 6.466951e-03 3 1  ON 26
ci_028                 6.188384e-03 3 1  ON 27
ci_029                -5.081742e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329789e-03 3 1  ON 30
ci_032                 4.543539e-03 3 1  ON 31
ci_033                 2.363567e-03 3 1  ON 32
ci_034                 4.136233e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539129e-03 3 1  ON 36
ci_038                 3.699753e-03 3 1  ON 37
ci_039                 4.622368e-03 3 1  ON 38
ci_040                 4.935570e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944544e-03 3 1  ON 42
ci_044                 3.188311e-03 3 1  ON 43
ci_045                 2.451380e-03 3 1  ON 44
ci_046                 2.720983e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338245e-04 3 1  ON 47
ci_049                 7.784329e-04 3 1  ON 48
ci_050                 9.957242e-04 3 1  ON 49
ci_051                -3.147628e-04 3 1  ON 50
ci_052                -1.210502e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689526e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928502e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882839e-04 3 1  ON 57
ci_059                -5.507171e-04 3 1  ON 58
ci_060                -7.598520e-04 3 1  ON 59
ci_061                -5.110392e-05 3 1  ON 60
ci_062                -9.206575e-04 3 1  ON 61
ci_063                -8.861413e-04 3 1  ON 62
ci_064                -5.243946e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812745e-03 3 1  ON 66
ci_068                -1.556827e-03 3 1  ON 67
ci_069                -5.543854e-04 3 1  ON 68
ci_070                -4.262040e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000808e-03 3 1  ON 71
ci_073                 1.611755e-04 3 1  ON 72
ci_074                 1.976751e-04 3 1  ON 73
ci_075                 1.618550e-04 3 1  ON 74
ci_076                 7.851101e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2665e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.6334
    reference variance = 1.90986
====================================================
  Execution time = 2.7859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5381e-01
  Total weights = 1.955256597e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441513387247
                                         uncertainty =       0.002324874220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441513387247
                                         uncertainty =       0.002324874220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469874974
  error estimate for blocks of size 2^( 2) =       0.000494102557
  error estimate for blocks of size 2^( 3) =       0.000516829853
  error estimate for blocks of size 2^( 4) =       0.000533210143
  error estimate for blocks of size 2^( 5) =       0.000541892373
  error estimate for blocks of size 2^( 6) =       0.000545500119
  error estimate for blocks of size 2^( 7) =       0.000548317777

      target function =      -0.742204221196
              le_mean =     -22.662559290597
             les_mean =     514.045405091812
             stat err =       0.000542230103
             autocorr =       1.331688411078
   target nu stat err =       0.000542230103
   target dn stat err =       0.002947411090
      target stat err =       0.002471797243
              std dev =       0.664503560471
             le_variance =       0.441564981879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266255929060e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+03, overlap shift 8.8818e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742211541150       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742211544150       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742211544642       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742211544714       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742211544726       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742211544721       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742211544720       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742211544732       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742211544715       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742211544736       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742211544746       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742211544688       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+03 is 2.627495e-08

solving harmonic davidson linear method for identity shift 3.5527e+04, overlap shift 3.5527e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742211541150       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742211541900       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742211542023       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742211542064       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742211542095       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742211542039       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742211542015       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742211542080       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742211542099       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742211542035       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742211542123       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742211542099       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+04 is 6.568759e-09

solving harmonic davidson linear method for identity shift 1.4211e+05, overlap shift 1.4211e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742211541150       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742211541338       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742211541368       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742211541373       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742211541420       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742211541643       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742211541396       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742211541156       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742211541439       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742211541864       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742211541535       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742211541455       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+05 is 1.642191e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229920 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2572e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949559e-02 3 1  ON 4
ci_006                 1.981630e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554054e-02 3 1  ON 7
ci_009                -1.320070e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910137e-03 3 1  ON 10
ci_012                -9.098676e-03 3 1  ON 11
ci_013                 8.349366e-03 3 1  ON 12
ci_014                 9.369067e-03 3 1  ON 13
ci_015                 9.519392e-03 3 1  ON 14
ci_016                 9.412691e-03 3 1  ON 15
ci_017                 8.493679e-03 3 1  ON 16
ci_018                 8.286450e-03 3 1  ON 17
ci_019                -1.224154e-03 3 1  ON 18
ci_020                -1.536016e-03 3 1  ON 19
ci_021                -1.177705e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854114e-03 3 1  ON 22
ci_024                 4.919330e-03 3 1  ON 23
ci_025                 1.143642e-02 3 1  ON 24
ci_026                 1.147268e-02 3 1  ON 25
ci_027                 6.466950e-03 3 1  ON 26
ci_028                 6.188383e-03 3 1  ON 27
ci_029                -5.081741e-03 3 1  ON 28
ci_030                -4.169869e-03 3 1  ON 29
ci_031                 3.329795e-03 3 1  ON 30
ci_032                 4.543543e-03 3 1  ON 31
ci_033                 2.363568e-03 3 1  ON 32
ci_034                 4.136230e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153597e-03 3 1  ON 35
ci_037                 3.539126e-03 3 1  ON 36
ci_038                 3.699752e-03 3 1  ON 37
ci_039                 4.622367e-03 3 1  ON 38
ci_040                 4.935570e-03 3 1  ON 39
ci_041                 2.971139e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944544e-03 3 1  ON 42
ci_044                 3.188311e-03 3 1  ON 43
ci_045                 2.451380e-03 3 1  ON 44
ci_046                 2.720984e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338240e-04 3 1  ON 47
ci_049                 7.784323e-04 3 1  ON 48
ci_050                 9.957225e-04 3 1  ON 49
ci_051                -3.147641e-04 3 1  ON 50
ci_052                -1.210501e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689525e-03 3 1  ON 53
ci_055                -1.798824e-03 3 1  ON 54
ci_056                -1.928502e-03 3 1  ON 55
ci_057                -1.307366e-03 3 1  ON 56
ci_058                -9.882822e-04 3 1  ON 57
ci_059                -5.507154e-04 3 1  ON 58
ci_060                -7.598502e-04 3 1  ON 59
ci_061                -5.110327e-05 3 1  ON 60
ci_062                -9.206585e-04 3 1  ON 61
ci_063                -8.861423e-04 3 1  ON 62
ci_064                -5.243961e-04 3 1  ON 63
ci_065                -1.359385e-03 3 1  ON 64
ci_066                -1.883898e-03 3 1  ON 65
ci_067                -1.812740e-03 3 1  ON 66
ci_068                -1.556827e-03 3 1  ON 67
ci_069                -5.543846e-04 3 1  ON 68
ci_070                -4.262041e-04 3 1  ON 69
ci_071                -2.087848e-03 3 1  ON 70
ci_072                -2.000805e-03 3 1  ON 71
ci_073                 1.611745e-04 3 1  ON 72
ci_074                 1.976743e-04 3 1  ON 73
ci_075                 1.618560e-04 3 1  ON 74
ci_076                 7.851107e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.6347
    reference variance = 0.396476
====================================================
  Execution time = 2.4951e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5110e-01
  Total weights = 1.9550e+06
  Execution time = 3.6040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441632395713
                                         uncertainty =       0.002941634517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441632395713
                                         uncertainty =       0.002941634517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469977216
  error estimate for blocks of size 2^( 2) =       0.000494074630
  error estimate for blocks of size 2^( 3) =       0.000515677897
  error estimate for blocks of size 2^( 4) =       0.000531664157
  error estimate for blocks of size 2^( 5) =       0.000540253650
  error estimate for blocks of size 2^( 6) =       0.000544547639
  error estimate for blocks of size 2^( 7) =       0.000548323480

      target function =      -0.744406819658
              le_mean =     -22.661671984762
             les_mean =     514.002477844123
             stat err =       0.000541197232
             autocorr =       1.326042748466
   target nu stat err =       0.000541197232
   target dn stat err =       0.003382723085
      target stat err =       0.002829456217
              std dev =       0.664648152436
             le_variance =       0.441757166537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441632392836
                                         uncertainty =       0.002941635999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441632392836
                                         uncertainty =       0.002941635999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469977214
  error estimate for blocks of size 2^( 2) =       0.000494074629
  error estimate for blocks of size 2^( 3) =       0.000515677896
  error estimate for blocks of size 2^( 4) =       0.000531664157
  error estimate for blocks of size 2^( 5) =       0.000540253650
  error estimate for blocks of size 2^( 6) =       0.000544547639
  error estimate for blocks of size 2^( 7) =       0.000548323480

      target function =      -0.744406812732
              le_mean =     -22.661671984659
             les_mean =     514.002477847900
             stat err =       0.000541197231
             autocorr =       1.326042755248
   target nu stat err =       0.000541197231
   target dn stat err =       0.003382724479
      target stat err =       0.002829457280
              std dev =       0.664648150255
             le_variance =       0.441757163637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441632394275
                                         uncertainty =       0.002941635258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441632394275
                                         uncertainty =       0.002941635258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469977215
  error estimate for blocks of size 2^( 2) =       0.000494074629
  error estimate for blocks of size 2^( 3) =       0.000515677897
  error estimate for blocks of size 2^( 4) =       0.000531664157
  error estimate for blocks of size 2^( 5) =       0.000540253650
  error estimate for blocks of size 2^( 6) =       0.000544547639
  error estimate for blocks of size 2^( 7) =       0.000548323480

      target function =      -0.744406816230
              le_mean =     -22.661671984711
             les_mean =     514.002477845969
             stat err =       0.000541197232
             autocorr =       1.326042751854
   target nu stat err =       0.000541197232
   target dn stat err =       0.003382723782
      target stat err =       0.002829456748
              std dev =       0.664648151346
             le_variance =       0.441757165087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441632395534
                                         uncertainty =       0.002941634610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441632395534
                                         uncertainty =       0.002941634610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469977216
  error estimate for blocks of size 2^( 2) =       0.000494074630
  error estimate for blocks of size 2^( 3) =       0.000515677897
  error estimate for blocks of size 2^( 4) =       0.000531664157
  error estimate for blocks of size 2^( 5) =       0.000540253650
  error estimate for blocks of size 2^( 6) =       0.000544547639
  error estimate for blocks of size 2^( 7) =       0.000548323480

      target function =      -0.744406819234
              le_mean =     -22.661671984756
             les_mean =     514.002477844349
             stat err =       0.000541197232
             autocorr =       1.326042748894
   target nu stat err =       0.000541197232
   target dn stat err =       0.003382723172
      target stat err =       0.002829456283
              std dev =       0.664648152300
             le_variance =       0.441757166356


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744406819658        initial  <--
     8.8818e+03     8.8818e+04             2.6275e-08        -0.744406812732
     3.5527e+04     3.5527e+05             6.5688e-09        -0.744406816230
     1.4211e+05     1.4211e+06             1.6422e-09        -0.744406819234

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.0521
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949560e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554055e-02 3 1  ON 7
ci_009                -1.320070e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910138e-03 3 1  ON 10
ci_012                -9.098678e-03 3 1  ON 11
ci_013                 8.349369e-03 3 1  ON 12
ci_014                 9.369069e-03 3 1  ON 13
ci_015                 9.519398e-03 3 1  ON 14
ci_016                 9.412691e-03 3 1  ON 15
ci_017                 8.493680e-03 3 1  ON 16
ci_018                 8.286447e-03 3 1  ON 17
ci_019                -1.224149e-03 3 1  ON 18
ci_020                -1.536010e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854114e-03 3 1  ON 22
ci_024                 4.919331e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147268e-02 3 1  ON 25
ci_027                 6.466951e-03 3 1  ON 26
ci_028                 6.188384e-03 3 1  ON 27
ci_029                -5.081742e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329789e-03 3 1  ON 30
ci_032                 4.543539e-03 3 1  ON 31
ci_033                 2.363567e-03 3 1  ON 32
ci_034                 4.136233e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539129e-03 3 1  ON 36
ci_038                 3.699753e-03 3 1  ON 37
ci_039                 4.622368e-03 3 1  ON 38
ci_040                 4.935570e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944544e-03 3 1  ON 42
ci_044                 3.188311e-03 3 1  ON 43
ci_045                 2.451380e-03 3 1  ON 44
ci_046                 2.720983e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338245e-04 3 1  ON 47
ci_049                 7.784329e-04 3 1  ON 48
ci_050                 9.957242e-04 3 1  ON 49
ci_051                -3.147628e-04 3 1  ON 50
ci_052                -1.210502e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689526e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928502e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882839e-04 3 1  ON 57
ci_059                -5.507171e-04 3 1  ON 58
ci_060                -7.598520e-04 3 1  ON 59
ci_061                -5.110392e-05 3 1  ON 60
ci_062                -9.206575e-04 3 1  ON 61
ci_063                -8.861413e-04 3 1  ON 62
ci_064                -5.243946e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812745e-03 3 1  ON 66
ci_068                -1.556827e-03 3 1  ON 67
ci_069                -5.543854e-04 3 1  ON 68
ci_070                -4.262040e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000808e-03 3 1  ON 71
ci_073                 1.611755e-04 3 1  ON 72
ci_074                 1.976751e-04 3 1  ON 73
ci_075                 1.618550e-04 3 1  ON 74
ci_076                 7.851101e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8631e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7479
    reference variance = 0.263638
====================================================
  Execution time = 2.5740e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5526e-01
  Total weights = 1.955248757e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442541085565
                                         uncertainty =       0.002610515422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442541085565
                                         uncertainty =       0.002610515422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470373165
  error estimate for blocks of size 2^( 2) =       0.000494284157
  error estimate for blocks of size 2^( 3) =       0.000516444756
  error estimate for blocks of size 2^( 4) =       0.000531746363
  error estimate for blocks of size 2^( 5) =       0.000540343824
  error estimate for blocks of size 2^( 6) =       0.000545620975
  error estimate for blocks of size 2^( 7) =       0.000550879429

      target function =      -0.741008031771
              le_mean =     -22.660544909584
             les_mean =     513.955556238584
             stat err =       0.000542147647
             autocorr =       1.328464890838
   target nu stat err =       0.000542147647
   target dn stat err =       0.004303487114
      target stat err =       0.003531390904
              std dev =       0.665208109200
             le_variance =       0.442501828545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266054490958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741023947911       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741023948110       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741023948141       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741023948140       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741023948139       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741023948160       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741023948069       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741023947958       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741023947935       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741023948099       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741023948136       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+04 is 2.838524e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741023947911       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741023947960       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741023947968       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741023947968       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741023947969       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741023947765       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741023947273       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741023948149       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741023947810       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741023948000       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741023947312       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+05 is 7.096314e-10

solving harmonic davidson linear method for identity shift 1.4211e+06, overlap shift 1.4211e+07 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741023947911       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741023947923       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741023947925       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741023947925       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741023947965       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741023947927       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741023948272       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741023947836       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741023950714       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741023945869       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741023951684       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+06 is 1.774078e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0476e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949559e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554054e-02 3 1  ON 7
ci_009                -1.320070e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910138e-03 3 1  ON 10
ci_012                -9.098678e-03 3 1  ON 11
ci_013                 8.349369e-03 3 1  ON 12
ci_014                 9.369069e-03 3 1  ON 13
ci_015                 9.519398e-03 3 1  ON 14
ci_016                 9.412691e-03 3 1  ON 15
ci_017                 8.493680e-03 3 1  ON 16
ci_018                 8.286447e-03 3 1  ON 17
ci_019                -1.224149e-03 3 1  ON 18
ci_020                -1.536010e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854114e-03 3 1  ON 22
ci_024                 4.919331e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147268e-02 3 1  ON 25
ci_027                 6.466951e-03 3 1  ON 26
ci_028                 6.188384e-03 3 1  ON 27
ci_029                -5.081742e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329789e-03 3 1  ON 30
ci_032                 4.543539e-03 3 1  ON 31
ci_033                 2.363567e-03 3 1  ON 32
ci_034                 4.136233e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539128e-03 3 1  ON 36
ci_038                 3.699753e-03 3 1  ON 37
ci_039                 4.622368e-03 3 1  ON 38
ci_040                 4.935570e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944544e-03 3 1  ON 42
ci_044                 3.188311e-03 3 1  ON 43
ci_045                 2.451380e-03 3 1  ON 44
ci_046                 2.720983e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338247e-04 3 1  ON 47
ci_049                 7.784329e-04 3 1  ON 48
ci_050                 9.957243e-04 3 1  ON 49
ci_051                -3.147628e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689526e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928502e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882839e-04 3 1  ON 57
ci_059                -5.507170e-04 3 1  ON 58
ci_060                -7.598519e-04 3 1  ON 59
ci_061                -5.110380e-05 3 1  ON 60
ci_062                -9.206575e-04 3 1  ON 61
ci_063                -8.861413e-04 3 1  ON 62
ci_064                -5.243947e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883901e-03 3 1  ON 65
ci_067                -1.812745e-03 3 1  ON 66
ci_068                -1.556827e-03 3 1  ON 67
ci_069                -5.543854e-04 3 1  ON 68
ci_070                -4.262041e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000808e-03 3 1  ON 71
ci_073                 1.611753e-04 3 1  ON 72
ci_074                 1.976750e-04 3 1  ON 73
ci_075                 1.618551e-04 3 1  ON 74
ci_076                 7.851099e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7904
    reference variance = 0.339218
====================================================
  Execution time = 2.4952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5458e-01
  Total weights = 1.9552e+06
  Execution time = 3.6014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442551760681
                                         uncertainty =       0.003563115522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442551760681
                                         uncertainty =       0.003563115522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470362282
  error estimate for blocks of size 2^( 2) =       0.000493939952
  error estimate for blocks of size 2^( 3) =       0.000516496161
  error estimate for blocks of size 2^( 4) =       0.000531754467
  error estimate for blocks of size 2^( 5) =       0.000541351108
  error estimate for blocks of size 2^( 6) =       0.000545986863
  error estimate for blocks of size 2^( 7) =       0.000547738522

      target function =      -0.741566791579
              le_mean =     -22.662812071247
             les_mean =     514.057631945060
             stat err =       0.000541707740
             autocorr =       1.326371262924
   target nu stat err =       0.000541707740
   target dn stat err =       0.004754935751
      target stat err =       0.003910733140
              std dev =       0.665192718655
             le_variance =       0.442481352951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442551757748
                                         uncertainty =       0.003563113430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442551757748
                                         uncertainty =       0.003563113430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470362281
  error estimate for blocks of size 2^( 2) =       0.000493939950
  error estimate for blocks of size 2^( 3) =       0.000516496159
  error estimate for blocks of size 2^( 4) =       0.000531754466
  error estimate for blocks of size 2^( 5) =       0.000541351106
  error estimate for blocks of size 2^( 6) =       0.000545986861
  error estimate for blocks of size 2^( 7) =       0.000547738520

      target function =      -0.741566796293
              le_mean =     -22.662812071252
             les_mean =     514.057631939539
             stat err =       0.000541707739
             autocorr =       1.326371265171
   target nu stat err =       0.000541707739
   target dn stat err =       0.004754933278
      target stat err =       0.003910731202
              std dev =       0.665192716456
             le_variance =       0.442481350026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442551759215
                                         uncertainty =       0.003563114476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442551759215
                                         uncertainty =       0.003563114476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470362281
  error estimate for blocks of size 2^( 2) =       0.000493939951
  error estimate for blocks of size 2^( 3) =       0.000516496160
  error estimate for blocks of size 2^( 4) =       0.000531754467
  error estimate for blocks of size 2^( 5) =       0.000541351107
  error estimate for blocks of size 2^( 6) =       0.000545986862
  error estimate for blocks of size 2^( 7) =       0.000547738521

      target function =      -0.741566793936
              le_mean =     -22.662812071249
             les_mean =     514.057631942299
             stat err =       0.000541707739
             autocorr =       1.326371264051
   target nu stat err =       0.000541707739
   target dn stat err =       0.004754934514
      target stat err =       0.003910732171
              std dev =       0.665192717555
             le_variance =       0.442481351489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442551760498
                                         uncertainty =       0.003563115391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442551760498
                                         uncertainty =       0.003563115391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470362282
  error estimate for blocks of size 2^( 2) =       0.000493939952
  error estimate for blocks of size 2^( 3) =       0.000516496160
  error estimate for blocks of size 2^( 4) =       0.000531754467
  error estimate for blocks of size 2^( 5) =       0.000541351108
  error estimate for blocks of size 2^( 6) =       0.000545986863
  error estimate for blocks of size 2^( 7) =       0.000547738522

      target function =      -0.741566791873
              le_mean =     -22.662812071247
             les_mean =     514.057631944715
             stat err =       0.000541707740
             autocorr =       1.326371263070
   target nu stat err =       0.000541707740
   target dn stat err =       0.004754935596
      target stat err =       0.003910733019
              std dev =       0.665192718517
             le_variance =       0.442481352768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741566791579        initial
     8.8818e+04     8.8818e+05             2.8385e-09        -0.741566796293  <--
     3.5527e+05     3.5527e+06             7.0963e-10        -0.741566793936
     1.4211e+06     1.4211e+07             1.7741e-10        -0.741566791873

*****************************************************************************
Applying the update for shift_i =   8.8818e+04     and shift_s =   8.8818e+05
*****************************************************************************

  Execution time = 4.3038e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949559e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554054e-02 3 1  ON 7
ci_009                -1.320070e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910137e-03 3 1  ON 10
ci_012                -9.098677e-03 3 1  ON 11
ci_013                 8.349369e-03 3 1  ON 12
ci_014                 9.369068e-03 3 1  ON 13
ci_015                 9.519397e-03 3 1  ON 14
ci_016                 9.412691e-03 3 1  ON 15
ci_017                 8.493679e-03 3 1  ON 16
ci_018                 8.286448e-03 3 1  ON 17
ci_019                -1.224151e-03 3 1  ON 18
ci_020                -1.536011e-03 3 1  ON 19
ci_021                -1.177704e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854114e-03 3 1  ON 22
ci_024                 4.919331e-03 3 1  ON 23
ci_025                 1.143641e-02 3 1  ON 24
ci_026                 1.147268e-02 3 1  ON 25
ci_027                 6.466951e-03 3 1  ON 26
ci_028                 6.188384e-03 3 1  ON 27
ci_029                -5.081742e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329790e-03 3 1  ON 30
ci_032                 4.543539e-03 3 1  ON 31
ci_033                 2.363568e-03 3 1  ON 32
ci_034                 4.136233e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539127e-03 3 1  ON 36
ci_038                 3.699752e-03 3 1  ON 37
ci_039                 4.622368e-03 3 1  ON 38
ci_040                 4.935570e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733794e-03 3 1  ON 41
ci_043                 2.944545e-03 3 1  ON 42
ci_044                 3.188312e-03 3 1  ON 43
ci_045                 2.451381e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338253e-04 3 1  ON 47
ci_049                 7.784328e-04 3 1  ON 48
ci_050                 9.957245e-04 3 1  ON 49
ci_051                -3.147628e-04 3 1  ON 50
ci_052                -1.210503e-03 3 1  ON 51
ci_053                -2.434083e-03 3 1  ON 52
ci_054                -2.689526e-03 3 1  ON 53
ci_055                -1.798826e-03 3 1  ON 54
ci_056                -1.928501e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882838e-04 3 1  ON 57
ci_059                -5.507165e-04 3 1  ON 58
ci_060                -7.598515e-04 3 1  ON 59
ci_061                -5.110345e-05 3 1  ON 60
ci_062                -9.206573e-04 3 1  ON 61
ci_063                -8.861414e-04 3 1  ON 62
ci_064                -5.243950e-04 3 1  ON 63
ci_065                -1.359384e-03 3 1  ON 64
ci_066                -1.883900e-03 3 1  ON 65
ci_067                -1.812745e-03 3 1  ON 66
ci_068                -1.556827e-03 3 1  ON 67
ci_069                -5.543854e-04 3 1  ON 68
ci_070                -4.262041e-04 3 1  ON 69
ci_071                -2.087846e-03 3 1  ON 70
ci_072                -2.000807e-03 3 1  ON 71
ci_073                 1.611748e-04 3 1  ON 72
ci_074                 1.976749e-04 3 1  ON 73
ci_075                 1.618554e-04 3 1  ON 74
ci_076                 7.851096e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3520e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2666e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6605
    reference variance = 0.442268
====================================================
  Execution time = 2.5637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6398e-01
  Total weights = 1.954885054e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443734024568
                                         uncertainty =       0.002500193908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443734024568
                                         uncertainty =       0.002500193908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471024870
  error estimate for blocks of size 2^( 2) =       0.000495368990
  error estimate for blocks of size 2^( 3) =       0.000517869527
  error estimate for blocks of size 2^( 4) =       0.000533718448
  error estimate for blocks of size 2^( 5) =       0.000542260077
  error estimate for blocks of size 2^( 6) =       0.000547712932
  error estimate for blocks of size 2^( 7) =       0.000553775548

      target function =      -0.733927711702
              le_mean =     -22.662440281797
             les_mean =     514.050180424614
             stat err =       0.000544366751
             autocorr =       1.335658725795
   target nu stat err =       0.000544366751
   target dn stat err =       0.010669629266
      target stat err =       0.008512516445
              std dev =       0.666129760056
             le_variance =       0.443728857233


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266244028180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734025682980       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734025684325       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734025684550       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734025684599       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734025684626       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734025684678       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734025684654       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734025684599       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734025684647       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734025684668       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734025684639       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734025684689       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+04 is 1.775717e-08

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734025682980       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734025683316       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734025683372       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734025683385       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734025683391       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734025683307       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734025683394       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734025683395       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734025683395       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734025683395       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734025683395       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734025683395       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+04 is 4.439294e-09

solving harmonic davidson linear method for identity shift 3.5527e+05, overlap shift 3.5527e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.734025682980       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.734025683064       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.734025683078       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.734025683081       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734025683083       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.734025683083       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.734025683083       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734025683084       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.734025683084       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734025683084       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734025683084       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734025683084       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+05 is 1.109824e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0384e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100192e-02 3 1  ON 3
ci_005                 1.949559e-02 3 1  ON 4
ci_006                 1.981631e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554054e-02 3 1  ON 7
ci_009                -1.320070e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910137e-03 3 1  ON 10
ci_012                -9.098677e-03 3 1  ON 11
ci_013                 8.349371e-03 3 1  ON 12
ci_014                 9.369066e-03 3 1  ON 13
ci_015                 9.519399e-03 3 1  ON 14
ci_016                 9.412689e-03 3 1  ON 15
ci_017                 8.493678e-03 3 1  ON 16
ci_018                 8.286446e-03 3 1  ON 17
ci_019                -1.224153e-03 3 1  ON 18
ci_020                -1.536012e-03 3 1  ON 19
ci_021                -1.177705e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854114e-03 3 1  ON 22
ci_024                 4.919330e-03 3 1  ON 23
ci_025                 1.143642e-02 3 1  ON 24
ci_026                 1.147268e-02 3 1  ON 25
ci_027                 6.466950e-03 3 1  ON 26
ci_028                 6.188384e-03 3 1  ON 27
ci_029                -5.081742e-03 3 1  ON 28
ci_030                -4.169871e-03 3 1  ON 29
ci_031                 3.329792e-03 3 1  ON 30
ci_032                 4.543540e-03 3 1  ON 31
ci_033                 2.363568e-03 3 1  ON 32
ci_034                 4.136233e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539128e-03 3 1  ON 36
ci_038                 3.699751e-03 3 1  ON 37
ci_039                 4.622367e-03 3 1  ON 38
ci_040                 4.935570e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733793e-03 3 1  ON 41
ci_043                 2.944545e-03 3 1  ON 42
ci_044                 3.188311e-03 3 1  ON 43
ci_045                 2.451380e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338250e-04 3 1  ON 47
ci_049                 7.784331e-04 3 1  ON 48
ci_050                 9.957237e-04 3 1  ON 49
ci_051                -3.147630e-04 3 1  ON 50
ci_052                -1.210502e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689526e-03 3 1  ON 53
ci_055                -1.798825e-03 3 1  ON 54
ci_056                -1.928501e-03 3 1  ON 55
ci_057                -1.307367e-03 3 1  ON 56
ci_058                -9.882841e-04 3 1  ON 57
ci_059                -5.507166e-04 3 1  ON 58
ci_060                -7.598512e-04 3 1  ON 59
ci_061                -5.110263e-05 3 1  ON 60
ci_062                -9.206564e-04 3 1  ON 61
ci_063                -8.861424e-04 3 1  ON 62
ci_064                -5.243939e-04 3 1  ON 63
ci_065                -1.359383e-03 3 1  ON 64
ci_066                -1.883900e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556827e-03 3 1  ON 67
ci_069                -5.543853e-04 3 1  ON 68
ci_070                -4.262038e-04 3 1  ON 69
ci_071                -2.087845e-03 3 1  ON 70
ci_072                -2.000807e-03 3 1  ON 71
ci_073                 1.611744e-04 3 1  ON 72
ci_074                 1.976750e-04 3 1  ON 73
ci_075                 1.618548e-04 3 1  ON 74
ci_076                 7.851090e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.7122
    reference variance = 0.31424
====================================================
  Execution time = 2.5184e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4847e-01
  Total weights = 1.9550e+06
  Execution time = 3.6253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437819638913
                                         uncertainty =       0.001636812131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437819638913
                                         uncertainty =       0.001636812131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467891785
  error estimate for blocks of size 2^( 2) =       0.000492318703
  error estimate for blocks of size 2^( 3) =       0.000514715530
  error estimate for blocks of size 2^( 4) =       0.000530615015
  error estimate for blocks of size 2^( 5) =       0.000539586296
  error estimate for blocks of size 2^( 6) =       0.000545290902
  error estimate for blocks of size 2^( 7) =       0.000547615310

      target function =      -0.746560580683
              le_mean =     -22.661143339494
             les_mean =     513.975886992667
             stat err =       0.000540776881
             autocorr =       1.335812158119
   target nu stat err =       0.000540776881
   target dn stat err =       0.002867898173
      target stat err =       0.002431042467
              std dev =       0.661698908724
             le_variance =       0.437845445806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437819637033
                                         uncertainty =       0.001636812036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437819637033
                                         uncertainty =       0.001636812036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467891784
  error estimate for blocks of size 2^( 2) =       0.000492318702
  error estimate for blocks of size 2^( 3) =       0.000514715529
  error estimate for blocks of size 2^( 4) =       0.000530615014
  error estimate for blocks of size 2^( 5) =       0.000539586295
  error estimate for blocks of size 2^( 6) =       0.000545290901
  error estimate for blocks of size 2^( 7) =       0.000547615309

      target function =      -0.746560592533
              le_mean =     -22.661143339512
             les_mean =     513.975886979131
             stat err =       0.000540776880
             autocorr =       1.335812159011
   target nu stat err =       0.000540776880
   target dn stat err =       0.002867889827
      target stat err =       0.002431035891
              std dev =       0.661698907316
             le_variance =       0.437845443943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437819637973
                                         uncertainty =       0.001636812083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437819637973
                                         uncertainty =       0.001636812083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467891785
  error estimate for blocks of size 2^( 2) =       0.000492318703
  error estimate for blocks of size 2^( 3) =       0.000514715529
  error estimate for blocks of size 2^( 4) =       0.000530615015
  error estimate for blocks of size 2^( 5) =       0.000539586295
  error estimate for blocks of size 2^( 6) =       0.000545290902
  error estimate for blocks of size 2^( 7) =       0.000547615310

      target function =      -0.746560586608
              le_mean =     -22.661143339503
             les_mean =     513.975886985899
             stat err =       0.000540776880
             autocorr =       1.335812158575
   target nu stat err =       0.000540776880
   target dn stat err =       0.002867894000
      target stat err =       0.002431039179
              std dev =       0.661698908020
             le_variance =       0.437845444875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437819638796
                                         uncertainty =       0.001636812125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437819638796
                                         uncertainty =       0.001636812125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467891785
  error estimate for blocks of size 2^( 2) =       0.000492318703
  error estimate for blocks of size 2^( 3) =       0.000514715529
  error estimate for blocks of size 2^( 4) =       0.000530615015
  error estimate for blocks of size 2^( 5) =       0.000539586296
  error estimate for blocks of size 2^( 6) =       0.000545290902
  error estimate for blocks of size 2^( 7) =       0.000547615310

      target function =      -0.746560581424
              le_mean =     -22.661143339495
             les_mean =     513.975886991821
             stat err =       0.000540776881
             autocorr =       1.335812158175
   target nu stat err =       0.000540776881
   target dn stat err =       0.002867897651
      target stat err =       0.002431042056
              std dev =       0.661698908636
             le_variance =       0.437845445690


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746560580683        initial
     2.2204e+04     2.2204e+05             1.7757e-08        -0.746560592533  <--
     8.8818e+04     8.8818e+05             4.4393e-09        -0.746560586608
     3.5527e+05     3.5527e+06             1.1098e-09        -0.746560581424

*****************************************************************************
Applying the update for shift_i =   2.2204e+04     and shift_s =   2.2204e+05
*****************************************************************************

  Execution time = 4.3348e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100190e-02 3 1  ON 3
ci_005                 1.949559e-02 3 1  ON 4
ci_006                 1.981630e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554054e-02 3 1  ON 7
ci_009                -1.320070e-02 3 1  ON 8
ci_010                -1.207980e-02 3 1  ON 9
ci_011                -9.910135e-03 3 1  ON 10
ci_012                -9.098676e-03 3 1  ON 11
ci_013                 8.349374e-03 3 1  ON 12
ci_014                 9.369058e-03 3 1  ON 13
ci_015                 9.519404e-03 3 1  ON 14
ci_016                 9.412684e-03 3 1  ON 15
ci_017                 8.493675e-03 3 1  ON 16
ci_018                 8.286440e-03 3 1  ON 17
ci_019                -1.224160e-03 3 1  ON 18
ci_020                -1.536016e-03 3 1  ON 19
ci_021                -1.177705e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854113e-03 3 1  ON 22
ci_024                 4.919328e-03 3 1  ON 23
ci_025                 1.143642e-02 3 1  ON 24
ci_026                 1.147269e-02 3 1  ON 25
ci_027                 6.466949e-03 3 1  ON 26
ci_028                 6.188384e-03 3 1  ON 27
ci_029                -5.081744e-03 3 1  ON 28
ci_030                -4.169870e-03 3 1  ON 29
ci_031                 3.329798e-03 3 1  ON 30
ci_032                 4.543543e-03 3 1  ON 31
ci_033                 2.363568e-03 3 1  ON 32
ci_034                 4.136231e-03 3 1  ON 33
ci_035                 1.723727e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539130e-03 3 1  ON 36
ci_038                 3.699748e-03 3 1  ON 37
ci_039                 4.622365e-03 3 1  ON 38
ci_040                 4.935570e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733790e-03 3 1  ON 41
ci_043                 2.944546e-03 3 1  ON 42
ci_044                 3.188309e-03 3 1  ON 43
ci_045                 2.451379e-03 3 1  ON 44
ci_046                 2.720981e-03 3 1  ON 45
ci_047                -1.002268e-03 3 1  ON 46
ci_048                -8.338241e-04 3 1  ON 47
ci_049                 7.784342e-04 3 1  ON 48
ci_050                 9.957214e-04 3 1  ON 49
ci_051                -3.147638e-04 3 1  ON 50
ci_052                -1.210498e-03 3 1  ON 51
ci_053                -2.434086e-03 3 1  ON 52
ci_054                -2.689528e-03 3 1  ON 53
ci_055                -1.798825e-03 3 1  ON 54
ci_056                -1.928500e-03 3 1  ON 55
ci_057                -1.307366e-03 3 1  ON 56
ci_058                -9.882848e-04 3 1  ON 57
ci_059                -5.507168e-04 3 1  ON 58
ci_060                -7.598506e-04 3 1  ON 59
ci_061                -5.110015e-05 3 1  ON 60
ci_062                -9.206535e-04 3 1  ON 61
ci_063                -8.861453e-04 3 1  ON 62
ci_064                -5.243908e-04 3 1  ON 63
ci_065                -1.359380e-03 3 1  ON 64
ci_066                -1.883899e-03 3 1  ON 65
ci_067                -1.812741e-03 3 1  ON 66
ci_068                -1.556829e-03 3 1  ON 67
ci_069                -5.543852e-04 3 1  ON 68
ci_070                -4.262030e-04 3 1  ON 69
ci_071                -2.087841e-03 3 1  ON 70
ci_072                -2.000808e-03 3 1  ON 71
ci_073                 1.611732e-04 3 1  ON 72
ci_074                 1.976755e-04 3 1  ON 73
ci_075                 1.618529e-04 3 1  ON 74
ci_076                 7.851073e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3738e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.6707
    reference variance = 0.296504
====================================================
  Execution time = 2.5634e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4585e-01
  Total weights = 1.955158774e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438193080269
                                         uncertainty =       0.001963312387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438193080269
                                         uncertainty =       0.001963312387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468069383
  error estimate for blocks of size 2^( 2) =       0.000492349550
  error estimate for blocks of size 2^( 3) =       0.000514345038
  error estimate for blocks of size 2^( 4) =       0.000529986728
  error estimate for blocks of size 2^( 5) =       0.000538859407
  error estimate for blocks of size 2^( 6) =       0.000543212120
  error estimate for blocks of size 2^( 7) =       0.000546907410

      target function =      -0.748746901232
              le_mean =     -22.662575645578
             les_mean =     514.038182831132
             stat err =       0.000539741416
             autocorr =       1.329691890040
   target nu stat err =       0.000539741416
   target dn stat err =       0.002304571645
      target stat err =       0.002000399434
              std dev =       0.661950069483
             le_variance =       0.438177894489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266257564558e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748751305914       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748751310284       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748751311163       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748751311225       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748751311240       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748751311252       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748751311269       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748751311290       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748751311281       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748751311294       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+03 is 3.830809e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748751305914       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748751307007       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748751307226       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748751307246       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748751307248       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748751307290       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748751307253       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748751307209       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748751307201       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748751307275       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+04 is 9.577075e-09

solving harmonic davidson linear method for identity shift 8.8818e+04, overlap shift 8.8818e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748751305914       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748751306187       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748751306242       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748751306246       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748751306247       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748751306248       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748751306278       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748751306250       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748751306049       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748751306235       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+04 is 2.394272e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.242604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0378e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100190e-02 3 1  ON 3
ci_005                 1.949559e-02 3 1  ON 4
ci_006                 1.981630e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554054e-02 3 1  ON 7
ci_009                -1.320069e-02 3 1  ON 8
ci_010                -1.207979e-02 3 1  ON 9
ci_011                -9.910133e-03 3 1  ON 10
ci_012                -9.098675e-03 3 1  ON 11
ci_013                 8.349371e-03 3 1  ON 12
ci_014                 9.369057e-03 3 1  ON 13
ci_015                 9.519403e-03 3 1  ON 14
ci_016                 9.412679e-03 3 1  ON 15
ci_017                 8.493675e-03 3 1  ON 16
ci_018                 8.286439e-03 3 1  ON 17
ci_019                -1.224169e-03 3 1  ON 18
ci_020                -1.536025e-03 3 1  ON 19
ci_021                -1.177706e-02 3 1  ON 20
ci_022                -1.179936e-02 3 1  ON 21
ci_023                 4.854114e-03 3 1  ON 22
ci_024                 4.919324e-03 3 1  ON 23
ci_025                 1.143642e-02 3 1  ON 24
ci_026                 1.147270e-02 3 1  ON 25
ci_027                 6.466944e-03 3 1  ON 26
ci_028                 6.188387e-03 3 1  ON 27
ci_029                -5.081739e-03 3 1  ON 28
ci_030                -4.169867e-03 3 1  ON 29
ci_031                 3.329805e-03 3 1  ON 30
ci_032                 4.543546e-03 3 1  ON 31
ci_033                 2.363569e-03 3 1  ON 32
ci_034                 4.136225e-03 3 1  ON 33
ci_035                 1.723727e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539127e-03 3 1  ON 36
ci_038                 3.699747e-03 3 1  ON 37
ci_039                 4.622365e-03 3 1  ON 38
ci_040                 4.935567e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733789e-03 3 1  ON 41
ci_043                 2.944546e-03 3 1  ON 42
ci_044                 3.188310e-03 3 1  ON 43
ci_045                 2.451380e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002266e-03 3 1  ON 46
ci_048                -8.338249e-04 3 1  ON 47
ci_049                 7.784361e-04 3 1  ON 48
ci_050                 9.957199e-04 3 1  ON 49
ci_051                -3.147624e-04 3 1  ON 50
ci_052                -1.210497e-03 3 1  ON 51
ci_053                -2.434084e-03 3 1  ON 52
ci_054                -2.689526e-03 3 1  ON 53
ci_055                -1.798822e-03 3 1  ON 54
ci_056                -1.928496e-03 3 1  ON 55
ci_057                -1.307365e-03 3 1  ON 56
ci_058                -9.882850e-04 3 1  ON 57
ci_059                -5.507158e-04 3 1  ON 58
ci_060                -7.598494e-04 3 1  ON 59
ci_061                -5.110065e-05 3 1  ON 60
ci_062                -9.206528e-04 3 1  ON 61
ci_063                -8.861449e-04 3 1  ON 62
ci_064                -5.243870e-04 3 1  ON 63
ci_065                -1.359380e-03 3 1  ON 64
ci_066                -1.883896e-03 3 1  ON 65
ci_067                -1.812744e-03 3 1  ON 66
ci_068                -1.556830e-03 3 1  ON 67
ci_069                -5.543827e-04 3 1  ON 68
ci_070                -4.262037e-04 3 1  ON 69
ci_071                -2.087841e-03 3 1  ON 70
ci_072                -2.000806e-03 3 1  ON 71
ci_073                 1.611745e-04 3 1  ON 72
ci_074                 1.976737e-04 3 1  ON 73
ci_075                 1.618555e-04 3 1  ON 74
ci_076                 7.851060e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7379
    reference variance = 0.271881
====================================================
  Execution time = 2.4948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4854e-01
  Total weights = 1.9553e+06
  Execution time = 3.6392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771932855
                                         uncertainty =       0.001991472382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771932855
                                         uncertainty =       0.001991472382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468868598
  error estimate for blocks of size 2^( 2) =       0.000493186317
  error estimate for blocks of size 2^( 3) =       0.000515109199
  error estimate for blocks of size 2^( 4) =       0.000531049034
  error estimate for blocks of size 2^( 5) =       0.000539715573
  error estimate for blocks of size 2^( 6) =       0.000544586167
  error estimate for blocks of size 2^( 7) =       0.000546385793

      target function =      -0.746516418846
              le_mean =     -22.662080780908
             les_mean =     514.018445808709
             stat err =       0.000540434141
             autocorr =       1.328566387667
   target nu stat err =       0.000540434141
   target dn stat err =       0.002457400561
      target stat err =       0.002108125761
              std dev =       0.663080329849
             le_variance =       0.439675523833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771921305
                                         uncertainty =       0.001991472016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771921305
                                         uncertainty =       0.001991472016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468868592
  error estimate for blocks of size 2^( 2) =       0.000493186312
  error estimate for blocks of size 2^( 3) =       0.000515109195
  error estimate for blocks of size 2^( 4) =       0.000531049030
  error estimate for blocks of size 2^( 5) =       0.000539715569
  error estimate for blocks of size 2^( 6) =       0.000544586163
  error estimate for blocks of size 2^( 7) =       0.000546385789

      target function =      -0.746516433601
              le_mean =     -22.662080781121
             les_mean =     514.018445800445
             stat err =       0.000540434138
             autocorr =       1.328566404951
   target nu stat err =       0.000540434138
   target dn stat err =       0.002457399658
      target stat err =       0.002108125129
              std dev =       0.663080321104
             le_variance =       0.439675512236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771927080
                                         uncertainty =       0.001991472199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771927080
                                         uncertainty =       0.001991472199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468868595
  error estimate for blocks of size 2^( 2) =       0.000493186314
  error estimate for blocks of size 2^( 3) =       0.000515109197
  error estimate for blocks of size 2^( 4) =       0.000531049032
  error estimate for blocks of size 2^( 5) =       0.000539715571
  error estimate for blocks of size 2^( 6) =       0.000544586165
  error estimate for blocks of size 2^( 7) =       0.000546385791

      target function =      -0.746516426243
              le_mean =     -22.662080781014
             les_mean =     514.018445804553
             stat err =       0.000540434140
             autocorr =       1.328566396313
   target nu stat err =       0.000540434140
   target dn stat err =       0.002457400109
      target stat err =       0.002108125445
              std dev =       0.663080325476
             le_variance =       0.439675518034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771932133
                                         uncertainty =       0.001991472359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439771932133
                                         uncertainty =       0.001991472359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468868597
  error estimate for blocks of size 2^( 2) =       0.000493186317
  error estimate for blocks of size 2^( 3) =       0.000515109199
  error estimate for blocks of size 2^( 4) =       0.000531049033
  error estimate for blocks of size 2^( 5) =       0.000539715572
  error estimate for blocks of size 2^( 6) =       0.000544586166
  error estimate for blocks of size 2^( 7) =       0.000546385793

      target function =      -0.746516419773
              le_mean =     -22.662080780921
             les_mean =     514.018445808187
             stat err =       0.000540434141
             autocorr =       1.328566388755
   target nu stat err =       0.000540434141
   target dn stat err =       0.002457400504
      target stat err =       0.002108125722
              std dev =       0.663080329302
             le_variance =       0.439675523108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746516418846        initial
     5.5511e+03     5.5511e+04             3.8308e-08        -0.746516433601  <--
     2.2204e+04     2.2204e+05             9.5771e-09        -0.746516426243
     8.8818e+04     8.8818e+05             2.3943e-09        -0.746516419773

*****************************************************************************
Applying the update for shift_i =   5.5511e+03     and shift_s =   5.5511e+04
*****************************************************************************

  Execution time = 4.3053e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100190e-02 3 1  ON 3
ci_005                 1.949557e-02 3 1  ON 4
ci_006                 1.981629e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554054e-02 3 1  ON 7
ci_009                -1.320068e-02 3 1  ON 8
ci_010                -1.207977e-02 3 1  ON 9
ci_011                -9.910128e-03 3 1  ON 10
ci_012                -9.098673e-03 3 1  ON 11
ci_013                 8.349361e-03 3 1  ON 12
ci_014                 9.369051e-03 3 1  ON 13
ci_015                 9.519401e-03 3 1  ON 14
ci_016                 9.412663e-03 3 1  ON 15
ci_017                 8.493674e-03 3 1  ON 16
ci_018                 8.286436e-03 3 1  ON 17
ci_019                -1.224198e-03 3 1  ON 18
ci_020                -1.536051e-03 3 1  ON 19
ci_021                -1.177708e-02 3 1  ON 20
ci_022                -1.179938e-02 3 1  ON 21
ci_023                 4.854117e-03 3 1  ON 22
ci_024                 4.919312e-03 3 1  ON 23
ci_025                 1.143644e-02 3 1  ON 24
ci_026                 1.147272e-02 3 1  ON 25
ci_027                 6.466930e-03 3 1  ON 26
ci_028                 6.188395e-03 3 1  ON 27
ci_029                -5.081725e-03 3 1  ON 28
ci_030                -4.169861e-03 3 1  ON 29
ci_031                 3.329826e-03 3 1  ON 30
ci_032                 4.543556e-03 3 1  ON 31
ci_033                 2.363573e-03 3 1  ON 32
ci_034                 4.136206e-03 3 1  ON 33
ci_035                 1.723727e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539116e-03 3 1  ON 36
ci_038                 3.699743e-03 3 1  ON 37
ci_039                 4.622364e-03 3 1  ON 38
ci_040                 4.935558e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733787e-03 3 1  ON 41
ci_043                 2.944547e-03 3 1  ON 42
ci_044                 3.188312e-03 3 1  ON 43
ci_045                 2.451383e-03 3 1  ON 44
ci_046                 2.720985e-03 3 1  ON 45
ci_047                -1.002261e-03 3 1  ON 46
ci_048                -8.338272e-04 3 1  ON 47
ci_049                 7.784417e-04 3 1  ON 48
ci_050                 9.957152e-04 3 1  ON 49
ci_051                -3.147579e-04 3 1  ON 50
ci_052                -1.210496e-03 3 1  ON 51
ci_053                -2.434078e-03 3 1  ON 52
ci_054                -2.689523e-03 3 1  ON 53
ci_055                -1.798816e-03 3 1  ON 54
ci_056                -1.928483e-03 3 1  ON 55
ci_057                -1.307360e-03 3 1  ON 56
ci_058                -9.882855e-04 3 1  ON 57
ci_059                -5.507131e-04 3 1  ON 58
ci_060                -7.598457e-04 3 1  ON 59
ci_061                -5.110215e-05 3 1  ON 60
ci_062                -9.206509e-04 3 1  ON 61
ci_063                -8.861440e-04 3 1  ON 62
ci_064                -5.243756e-04 3 1  ON 63
ci_065                -1.359380e-03 3 1  ON 64
ci_066                -1.883887e-03 3 1  ON 65
ci_067                -1.812754e-03 3 1  ON 66
ci_068                -1.556834e-03 3 1  ON 67
ci_069                -5.543751e-04 3 1  ON 68
ci_070                -4.262059e-04 3 1  ON 69
ci_071                -2.087842e-03 3 1  ON 70
ci_072                -2.000802e-03 3 1  ON 71
ci_073                 1.611782e-04 3 1  ON 72
ci_074                 1.976683e-04 3 1  ON 73
ci_075                 1.618634e-04 3 1  ON 74
ci_076                 7.851020e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3438e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.7076
    reference variance = 1.28679
====================================================
  Execution time = 2.7694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4913e-01
  Total weights = 1.955290087e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439526636777
                                         uncertainty =       0.002026987976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439526636777
                                         uncertainty =       0.002026987976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468794891
  error estimate for blocks of size 2^( 2) =       0.000492882334
  error estimate for blocks of size 2^( 3) =       0.000514803082
  error estimate for blocks of size 2^( 4) =       0.000530259610
  error estimate for blocks of size 2^( 5) =       0.000540193125
  error estimate for blocks of size 2^( 6) =       0.000545040926
  error estimate for blocks of size 2^( 7) =       0.000549266245

      target function =      -0.746032263902
              le_mean =     -22.662843173549
             les_mean =     514.053594961448
             stat err =       0.000541189977
             autocorr =       1.332704147136
   target nu stat err =       0.000541189977
   target dn stat err =       0.003280882878
      target stat err =       0.002764596360
              std dev =       0.662976092611
             le_variance =       0.439537299373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266284317355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+03, overlap shift 1.3878e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746041477796       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746041494374       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746041497747       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746041498005       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746041498381       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746041498693       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746041498833       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746041498827       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746041498837       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746041498845       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746041498841       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746041498836       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+03 is 2.496758e-07

solving harmonic davidson linear method for identity shift 5.5511e+03, overlap shift 5.5511e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746041477796       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746041481940       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746041482784       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746041482848       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746041482942       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746041483015       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746041483047       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746041483057       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746041483056       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746041483074       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746041483073       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746041483045       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+03 is 6.241898e-08

solving harmonic davidson linear method for identity shift 2.2204e+04, overlap shift 2.2204e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746041477796       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746041478832       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746041479043       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746041479059       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746041479083       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746041479065       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746041479043       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746041479126       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746041479095       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746041479126       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746041479178       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746041479111       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+04 is 1.560475e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247417 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2389e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013058e-02 3 1  ON 2
ci_004                -5.100188e-02 3 1  ON 3
ci_005                 1.949557e-02 3 1  ON 4
ci_006                 1.981627e-02 3 1  ON 5
ci_007                 1.474577e-02 3 1  ON 6
ci_008                 1.554052e-02 3 1  ON 7
ci_009                -1.320066e-02 3 1  ON 8
ci_010                -1.207975e-02 3 1  ON 9
ci_011                -9.910100e-03 3 1  ON 10
ci_012                -9.098674e-03 3 1  ON 11
ci_013                 8.349366e-03 3 1  ON 12
ci_014                 9.369053e-03 3 1  ON 13
ci_015                 9.519372e-03 3 1  ON 14
ci_016                 9.412650e-03 3 1  ON 15
ci_017                 8.493667e-03 3 1  ON 16
ci_018                 8.286412e-03 3 1  ON 17
ci_019                -1.224225e-03 3 1  ON 18
ci_020                -1.536097e-03 3 1  ON 19
ci_021                -1.177707e-02 3 1  ON 20
ci_022                -1.179939e-02 3 1  ON 21
ci_023                 4.854110e-03 3 1  ON 22
ci_024                 4.919323e-03 3 1  ON 23
ci_025                 1.143646e-02 3 1  ON 24
ci_026                 1.147275e-02 3 1  ON 25
ci_027                 6.466928e-03 3 1  ON 26
ci_028                 6.188399e-03 3 1  ON 27
ci_029                -5.081726e-03 3 1  ON 28
ci_030                -4.169866e-03 3 1  ON 29
ci_031                 3.329830e-03 3 1  ON 30
ci_032                 4.543551e-03 3 1  ON 31
ci_033                 2.363576e-03 3 1  ON 32
ci_034                 4.136181e-03 3 1  ON 33
ci_035                 1.723722e-03 3 1  ON 34
ci_036                 2.153595e-03 3 1  ON 35
ci_037                 3.539115e-03 3 1  ON 36
ci_038                 3.699744e-03 3 1  ON 37
ci_039                 4.622362e-03 3 1  ON 38
ci_040                 4.935546e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733777e-03 3 1  ON 41
ci_043                 2.944546e-03 3 1  ON 42
ci_044                 3.188316e-03 3 1  ON 43
ci_045                 2.451392e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002265e-03 3 1  ON 46
ci_048                -8.338286e-04 3 1  ON 47
ci_049                 7.784536e-04 3 1  ON 48
ci_050                 9.957025e-04 3 1  ON 49
ci_051                -3.147638e-04 3 1  ON 50
ci_052                -1.210493e-03 3 1  ON 51
ci_053                -2.434074e-03 3 1  ON 52
ci_054                -2.689520e-03 3 1  ON 53
ci_055                -1.798811e-03 3 1  ON 54
ci_056                -1.928473e-03 3 1  ON 55
ci_057                -1.307366e-03 3 1  ON 56
ci_058                -9.882852e-04 3 1  ON 57
ci_059                -5.507152e-04 3 1  ON 58
ci_060                -7.598303e-04 3 1  ON 59
ci_061                -5.109912e-05 3 1  ON 60
ci_062                -9.206539e-04 3 1  ON 61
ci_063                -8.861452e-04 3 1  ON 62
ci_064                -5.243817e-04 3 1  ON 63
ci_065                -1.359377e-03 3 1  ON 64
ci_066                -1.883879e-03 3 1  ON 65
ci_067                -1.812752e-03 3 1  ON 66
ci_068                -1.556853e-03 3 1  ON 67
ci_069                -5.543784e-04 3 1  ON 68
ci_070                -4.261967e-04 3 1  ON 69
ci_071                -2.087843e-03 3 1  ON 70
ci_072                -2.000801e-03 3 1  ON 71
ci_073                 1.611831e-04 3 1  ON 72
ci_074                 1.976690e-04 3 1  ON 73
ci_075                 1.618728e-04 3 1  ON 74
ci_076                 7.851039e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6529
    reference variance = 0.266587
====================================================
  Execution time = 2.4906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5197e-01
  Total weights = 1.9550e+06
  Execution time = 3.6152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441358650390
                                         uncertainty =       0.002205922021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441358650390
                                         uncertainty =       0.002205922021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469723982
  error estimate for blocks of size 2^( 2) =       0.000493756546
  error estimate for blocks of size 2^( 3) =       0.000516680480
  error estimate for blocks of size 2^( 4) =       0.000532249272
  error estimate for blocks of size 2^( 5) =       0.000542428493
  error estimate for blocks of size 2^( 6) =       0.000547183057
  error estimate for blocks of size 2^( 7) =       0.000549976936

      target function =      -0.743712408596
              le_mean =     -22.662323481943
             les_mean =     514.032867160045
             stat err =       0.000542959439
             autocorr =       1.336131821315
   target nu stat err =       0.000542959439
   target dn stat err =       0.002729069401
      target stat err =       0.002308127192
              std dev =       0.664290026406
             le_variance =       0.441281239183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441358620744
                                         uncertainty =       0.002205920904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441358620744
                                         uncertainty =       0.002205920904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469723966
  error estimate for blocks of size 2^( 2) =       0.000493756532
  error estimate for blocks of size 2^( 3) =       0.000516680466
  error estimate for blocks of size 2^( 4) =       0.000532249258
  error estimate for blocks of size 2^( 5) =       0.000542428476
  error estimate for blocks of size 2^( 6) =       0.000547183040
  error estimate for blocks of size 2^( 7) =       0.000549976916

      target function =      -0.743653653405
              le_mean =     -22.662323482391
             les_mean =     514.032939093380
             stat err =       0.000542959423
             autocorr =       1.336131828383
   target nu stat err =       0.000542959423
   target dn stat err =       0.002730373889
      target stat err =       0.002308804145
              std dev =       0.664290003986
             le_variance =       0.441281209396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441358635566
                                         uncertainty =       0.002205921462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441358635566
                                         uncertainty =       0.002205921462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469723974
  error estimate for blocks of size 2^( 2) =       0.000493756539
  error estimate for blocks of size 2^( 3) =       0.000516680473
  error estimate for blocks of size 2^( 4) =       0.000532249265
  error estimate for blocks of size 2^( 5) =       0.000542428484
  error estimate for blocks of size 2^( 6) =       0.000547183049
  error estimate for blocks of size 2^( 7) =       0.000549976926

      target function =      -0.743701933712
              le_mean =     -22.662323482172
             les_mean =     514.032879991146
             stat err =       0.000542959431
             autocorr =       1.336131824807
   target nu stat err =       0.000542959431
   target dn stat err =       0.002729149468
      target stat err =       0.002308127538
              std dev =       0.664290015196
             le_variance =       0.441281224289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441358648537
                                         uncertainty =       0.002205921951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441358648537
                                         uncertainty =       0.002205921951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469723981
  error estimate for blocks of size 2^( 2) =       0.000493756546
  error estimate for blocks of size 2^( 3) =       0.000516680479
  error estimate for blocks of size 2^( 4) =       0.000532249271
  error estimate for blocks of size 2^( 5) =       0.000542428492
  error estimate for blocks of size 2^( 6) =       0.000547183056
  error estimate for blocks of size 2^( 7) =       0.000549976935

      target function =      -0.743711640484
              le_mean =     -22.662323481972
             les_mean =     514.032868101486
             stat err =       0.000542959438
             autocorr =       1.336131821747
   target nu stat err =       0.000542959438
   target dn stat err =       0.002729072141
      target stat err =       0.002308124747
              std dev =       0.664290025005
             le_variance =       0.441281237321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743712408596        initial  <--
     1.3878e+03     1.3878e+04             2.4968e-07        -0.743653653405
     5.5511e+03     5.5511e+04             6.2419e-08        -0.743701933712
     2.2204e+04     2.2204e+05             1.5605e-08        -0.743711640484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.7006
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100190e-02 3 1  ON 3
ci_005                 1.949557e-02 3 1  ON 4
ci_006                 1.981629e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554054e-02 3 1  ON 7
ci_009                -1.320068e-02 3 1  ON 8
ci_010                -1.207977e-02 3 1  ON 9
ci_011                -9.910128e-03 3 1  ON 10
ci_012                -9.098673e-03 3 1  ON 11
ci_013                 8.349361e-03 3 1  ON 12
ci_014                 9.369051e-03 3 1  ON 13
ci_015                 9.519401e-03 3 1  ON 14
ci_016                 9.412663e-03 3 1  ON 15
ci_017                 8.493674e-03 3 1  ON 16
ci_018                 8.286436e-03 3 1  ON 17
ci_019                -1.224198e-03 3 1  ON 18
ci_020                -1.536051e-03 3 1  ON 19
ci_021                -1.177708e-02 3 1  ON 20
ci_022                -1.179938e-02 3 1  ON 21
ci_023                 4.854117e-03 3 1  ON 22
ci_024                 4.919312e-03 3 1  ON 23
ci_025                 1.143644e-02 3 1  ON 24
ci_026                 1.147272e-02 3 1  ON 25
ci_027                 6.466930e-03 3 1  ON 26
ci_028                 6.188395e-03 3 1  ON 27
ci_029                -5.081725e-03 3 1  ON 28
ci_030                -4.169861e-03 3 1  ON 29
ci_031                 3.329826e-03 3 1  ON 30
ci_032                 4.543556e-03 3 1  ON 31
ci_033                 2.363573e-03 3 1  ON 32
ci_034                 4.136206e-03 3 1  ON 33
ci_035                 1.723727e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539116e-03 3 1  ON 36
ci_038                 3.699743e-03 3 1  ON 37
ci_039                 4.622364e-03 3 1  ON 38
ci_040                 4.935558e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733787e-03 3 1  ON 41
ci_043                 2.944547e-03 3 1  ON 42
ci_044                 3.188312e-03 3 1  ON 43
ci_045                 2.451383e-03 3 1  ON 44
ci_046                 2.720985e-03 3 1  ON 45
ci_047                -1.002261e-03 3 1  ON 46
ci_048                -8.338272e-04 3 1  ON 47
ci_049                 7.784417e-04 3 1  ON 48
ci_050                 9.957152e-04 3 1  ON 49
ci_051                -3.147579e-04 3 1  ON 50
ci_052                -1.210496e-03 3 1  ON 51
ci_053                -2.434078e-03 3 1  ON 52
ci_054                -2.689523e-03 3 1  ON 53
ci_055                -1.798816e-03 3 1  ON 54
ci_056                -1.928483e-03 3 1  ON 55
ci_057                -1.307360e-03 3 1  ON 56
ci_058                -9.882855e-04 3 1  ON 57
ci_059                -5.507131e-04 3 1  ON 58
ci_060                -7.598457e-04 3 1  ON 59
ci_061                -5.110215e-05 3 1  ON 60
ci_062                -9.206509e-04 3 1  ON 61
ci_063                -8.861440e-04 3 1  ON 62
ci_064                -5.243756e-04 3 1  ON 63
ci_065                -1.359380e-03 3 1  ON 64
ci_066                -1.883887e-03 3 1  ON 65
ci_067                -1.812754e-03 3 1  ON 66
ci_068                -1.556834e-03 3 1  ON 67
ci_069                -5.543751e-04 3 1  ON 68
ci_070                -4.262059e-04 3 1  ON 69
ci_071                -2.087842e-03 3 1  ON 70
ci_072                -2.000802e-03 3 1  ON 71
ci_073                 1.611782e-04 3 1  ON 72
ci_074                 1.976683e-04 3 1  ON 73
ci_075                 1.618634e-04 3 1  ON 74
ci_076                 7.851020e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.709
    reference variance = 0.527775
====================================================
  Execution time = 2.5792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5119e-01
  Total weights = 1.954820803e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441910528819
                                         uncertainty =       0.002251626904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441910528819
                                         uncertainty =       0.002251626904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470061957
  error estimate for blocks of size 2^( 2) =       0.000494216049
  error estimate for blocks of size 2^( 3) =       0.000516001922
  error estimate for blocks of size 2^( 4) =       0.000532192462
  error estimate for blocks of size 2^( 5) =       0.000541881529
  error estimate for blocks of size 2^( 6) =       0.000546767885
  error estimate for blocks of size 2^( 7) =       0.000548683721

      target function =      -0.744343640757
              le_mean =     -22.662469307229
             les_mean =     514.038704303247
             stat err =       0.000542381399
             autocorr =       1.331371834254
   target nu stat err =       0.000542381399
   target dn stat err =       0.003036763696
      target stat err =       0.002556431860
              std dev =       0.664767995307
             le_variance =       0.441916487585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266246930723e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744351520468       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744351521408       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744351521656       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744351521665       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744351521669       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744351521652       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744351521711       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744351521684       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744351521681       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744351521682       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744351521688       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+04 is 1.151232e-08

solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744351520468       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744351520703       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744351520765       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744351520771       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744351520694       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744351520751       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744351520689       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744351520751       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744351520832       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744351520779       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744351520651       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+04 is 2.878086e-09

solving harmonic davidson linear method for identity shift 2.2204e+05, overlap shift 2.2204e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744351520468       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744351520527       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744351520542       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744351520530       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744351520586       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744351520007       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744351520448       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744351520332       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744351520473       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744351520064       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744351520614       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+05 is 7.195218e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0523e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100190e-02 3 1  ON 3
ci_005                 1.949557e-02 3 1  ON 4
ci_006                 1.981629e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554053e-02 3 1  ON 7
ci_009                -1.320067e-02 3 1  ON 8
ci_010                -1.207977e-02 3 1  ON 9
ci_011                -9.910127e-03 3 1  ON 10
ci_012                -9.098672e-03 3 1  ON 11
ci_013                 8.349361e-03 3 1  ON 12
ci_014                 9.369049e-03 3 1  ON 13
ci_015                 9.519400e-03 3 1  ON 14
ci_016                 9.412661e-03 3 1  ON 15
ci_017                 8.493674e-03 3 1  ON 16
ci_018                 8.286436e-03 3 1  ON 17
ci_019                -1.224200e-03 3 1  ON 18
ci_020                -1.536054e-03 3 1  ON 19
ci_021                -1.177708e-02 3 1  ON 20
ci_022                -1.179938e-02 3 1  ON 21
ci_023                 4.854118e-03 3 1  ON 22
ci_024                 4.919312e-03 3 1  ON 23
ci_025                 1.143644e-02 3 1  ON 24
ci_026                 1.147272e-02 3 1  ON 25
ci_027                 6.466929e-03 3 1  ON 26
ci_028                 6.188395e-03 3 1  ON 27
ci_029                -5.081724e-03 3 1  ON 28
ci_030                -4.169861e-03 3 1  ON 29
ci_031                 3.329827e-03 3 1  ON 30
ci_032                 4.543558e-03 3 1  ON 31
ci_033                 2.363573e-03 3 1  ON 32
ci_034                 4.136206e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153598e-03 3 1  ON 35
ci_037                 3.539116e-03 3 1  ON 36
ci_038                 3.699743e-03 3 1  ON 37
ci_039                 4.622364e-03 3 1  ON 38
ci_040                 4.935558e-03 3 1  ON 39
ci_041                 2.971140e-03 3 1  ON 40
ci_042                 2.733787e-03 3 1  ON 41
ci_043                 2.944547e-03 3 1  ON 42
ci_044                 3.188313e-03 3 1  ON 43
ci_045                 2.451383e-03 3 1  ON 44
ci_046                 2.720985e-03 3 1  ON 45
ci_047                -1.002261e-03 3 1  ON 46
ci_048                -8.338268e-04 3 1  ON 47
ci_049                 7.784414e-04 3 1  ON 48
ci_050                 9.957152e-04 3 1  ON 49
ci_051                -3.147582e-04 3 1  ON 50
ci_052                -1.210494e-03 3 1  ON 51
ci_053                -2.434078e-03 3 1  ON 52
ci_054                -2.689523e-03 3 1  ON 53
ci_055                -1.798814e-03 3 1  ON 54
ci_056                -1.928481e-03 3 1  ON 55
ci_057                -1.307359e-03 3 1  ON 56
ci_058                -9.882857e-04 3 1  ON 57
ci_059                -5.507151e-04 3 1  ON 58
ci_060                -7.598453e-04 3 1  ON 59
ci_061                -5.110253e-05 3 1  ON 60
ci_062                -9.206504e-04 3 1  ON 61
ci_063                -8.861445e-04 3 1  ON 62
ci_064                -5.243752e-04 3 1  ON 63
ci_065                -1.359380e-03 3 1  ON 64
ci_066                -1.883886e-03 3 1  ON 65
ci_067                -1.812755e-03 3 1  ON 66
ci_068                -1.556835e-03 3 1  ON 67
ci_069                -5.543756e-04 3 1  ON 68
ci_070                -4.262058e-04 3 1  ON 69
ci_071                -2.087842e-03 3 1  ON 70
ci_072                -2.000802e-03 3 1  ON 71
ci_073                 1.611778e-04 3 1  ON 72
ci_074                 1.976685e-04 3 1  ON 73
ci_075                 1.618631e-04 3 1  ON 74
ci_076                 7.851017e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.736
    reference variance = 0.457315
====================================================
  Execution time = 2.5047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5052e-01
  Total weights = 1.9554e+06
  Execution time = 3.6032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327055259
                                         uncertainty =       0.002237602355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327055259
                                         uncertainty =       0.002237602355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469788017
  error estimate for blocks of size 2^( 2) =       0.000494056878
  error estimate for blocks of size 2^( 3) =       0.000515898358
  error estimate for blocks of size 2^( 4) =       0.000531348349
  error estimate for blocks of size 2^( 5) =       0.000541580564
  error estimate for blocks of size 2^( 6) =       0.000547305088
  error estimate for blocks of size 2^( 7) =       0.000549132637

      target function =      -0.744876042265
              le_mean =     -22.661281093679
             les_mean =     513.984186431488
             stat err =       0.000542341659
             autocorr =       1.332729653081
   target nu stat err =       0.000542341659
   target dn stat err =       0.002906141577
      target stat err =       0.002451672415
              std dev =       0.664380585392
             le_variance =       0.441401562246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327052054
                                         uncertainty =       0.002237602450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327052054
                                         uncertainty =       0.002237602450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469788016
  error estimate for blocks of size 2^( 2) =       0.000494056876
  error estimate for blocks of size 2^( 3) =       0.000515898357
  error estimate for blocks of size 2^( 4) =       0.000531348348
  error estimate for blocks of size 2^( 5) =       0.000541580563
  error estimate for blocks of size 2^( 6) =       0.000547305087
  error estimate for blocks of size 2^( 7) =       0.000549132636

      target function =      -0.744880952794
              le_mean =     -22.661281093712
             les_mean =     513.984180432711
             stat err =       0.000542341659
             autocorr =       1.332729658633
   target nu stat err =       0.000542341659
   target dn stat err =       0.002906060009
      target stat err =       0.002451639035
              std dev =       0.664380582983
             le_variance =       0.441401559045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327053656
                                         uncertainty =       0.002237602403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327053656
                                         uncertainty =       0.002237602403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469788016
  error estimate for blocks of size 2^( 2) =       0.000494056877
  error estimate for blocks of size 2^( 3) =       0.000515898357
  error estimate for blocks of size 2^( 4) =       0.000531348348
  error estimate for blocks of size 2^( 5) =       0.000541580564
  error estimate for blocks of size 2^( 6) =       0.000547305087
  error estimate for blocks of size 2^( 7) =       0.000549132636

      target function =      -0.744878648439
              le_mean =     -22.661281093696
             les_mean =     513.984183247701
             stat err =       0.000542341659
             autocorr =       1.332729655860
   target nu stat err =       0.000542341659
   target dn stat err =       0.002906096722
      target stat err =       0.002451653458
              std dev =       0.664380584187
             le_variance =       0.441401560645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327055058
                                         uncertainty =       0.002237602361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441327055058
                                         uncertainty =       0.002237602361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469788017
  error estimate for blocks of size 2^( 2) =       0.000494056878
  error estimate for blocks of size 2^( 3) =       0.000515898358
  error estimate for blocks of size 2^( 4) =       0.000531348349
  error estimate for blocks of size 2^( 5) =       0.000541580564
  error estimate for blocks of size 2^( 6) =       0.000547305088
  error estimate for blocks of size 2^( 7) =       0.000549132637

      target function =      -0.744876386316
              le_mean =     -22.661281093681
             les_mean =     513.984186011179
             stat err =       0.000542341659
             autocorr =       1.332729653426
   target nu stat err =       0.000542341659
   target dn stat err =       0.002906135453
      target stat err =       0.002451669752
              std dev =       0.664380585242
             le_variance =       0.441401562046


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744876042265        initial
     1.3878e+04     1.3878e+05             1.1512e-08        -0.744880952794  <--
     5.5511e+04     5.5511e+05             2.8781e-09        -0.744878648439
     2.2204e+05     2.2204e+06             7.1952e-10        -0.744876386316

*****************************************************************************
Applying the update for shift_i =   1.3878e+04     and shift_s =   1.3878e+05
*****************************************************************************

  Execution time = 4.3070e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013057e-02 3 1  ON 2
ci_004                -5.100190e-02 3 1  ON 3
ci_005                 1.949556e-02 3 1  ON 4
ci_006                 1.981628e-02 3 1  ON 5
ci_007                 1.474576e-02 3 1  ON 6
ci_008                 1.554053e-02 3 1  ON 7
ci_009                -1.320067e-02 3 1  ON 8
ci_010                -1.207977e-02 3 1  ON 9
ci_011                -9.910126e-03 3 1  ON 10
ci_012                -9.098669e-03 3 1  ON 11
ci_013                 8.349362e-03 3 1  ON 12
ci_014                 9.369045e-03 3 1  ON 13
ci_015                 9.519398e-03 3 1  ON 14
ci_016                 9.412656e-03 3 1  ON 15
ci_017                 8.493672e-03 3 1  ON 16
ci_018                 8.286437e-03 3 1  ON 17
ci_019                -1.224206e-03 3 1  ON 18
ci_020                -1.536063e-03 3 1  ON 19
ci_021                -1.177709e-02 3 1  ON 20
ci_022                -1.179938e-02 3 1  ON 21
ci_023                 4.854120e-03 3 1  ON 22
ci_024                 4.919312e-03 3 1  ON 23
ci_025                 1.143644e-02 3 1  ON 24
ci_026                 1.147273e-02 3 1  ON 25
ci_027                 6.466927e-03 3 1  ON 26
ci_028                 6.188394e-03 3 1  ON 27
ci_029                -5.081722e-03 3 1  ON 28
ci_030                -4.169860e-03 3 1  ON 29
ci_031                 3.329831e-03 3 1  ON 30
ci_032                 4.543564e-03 3 1  ON 31
ci_033                 2.363572e-03 3 1  ON 32
ci_034                 4.136205e-03 3 1  ON 33
ci_035                 1.723731e-03 3 1  ON 34
ci_036                 2.153597e-03 3 1  ON 35
ci_037                 3.539117e-03 3 1  ON 36
ci_038                 3.699744e-03 3 1  ON 37
ci_039                 4.622365e-03 3 1  ON 38
ci_040                 4.935559e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733789e-03 3 1  ON 41
ci_043                 2.944547e-03 3 1  ON 42
ci_044                 3.188314e-03 3 1  ON 43
ci_045                 2.451383e-03 3 1  ON 44
ci_046                 2.720986e-03 3 1  ON 45
ci_047                -1.002262e-03 3 1  ON 46
ci_048                -8.338255e-04 3 1  ON 47
ci_049                 7.784404e-04 3 1  ON 48
ci_050                 9.957152e-04 3 1  ON 49
ci_051                -3.147590e-04 3 1  ON 50
ci_052                -1.210489e-03 3 1  ON 51
ci_053                -2.434079e-03 3 1  ON 52
ci_054                -2.689522e-03 3 1  ON 53
ci_055                -1.798809e-03 3 1  ON 54
ci_056                -1.928475e-03 3 1  ON 55
ci_057                -1.307357e-03 3 1  ON 56
ci_058                -9.882863e-04 3 1  ON 57
ci_059                -5.507212e-04 3 1  ON 58
ci_060                -7.598442e-04 3 1  ON 59
ci_061                -5.110366e-05 3 1  ON 60
ci_062                -9.206488e-04 3 1  ON 61
ci_063                -8.861460e-04 3 1  ON 62
ci_064                -5.243739e-04 3 1  ON 63
ci_065                -1.359379e-03 3 1  ON 64
ci_066                -1.883884e-03 3 1  ON 65
ci_067                -1.812758e-03 3 1  ON 66
ci_068                -1.556836e-03 3 1  ON 67
ci_069                -5.543771e-04 3 1  ON 68
ci_070                -4.262052e-04 3 1  ON 69
ci_071                -2.087844e-03 3 1  ON 70
ci_072                -2.000801e-03 3 1  ON 71
ci_073                 1.611765e-04 3 1  ON 72
ci_074                 1.976689e-04 3 1  ON 73
ci_075                 1.618622e-04 3 1  ON 74
ci_076                 7.851009e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3600e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.6532
    reference variance = 0.446718
====================================================
  Execution time = 2.5798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5663e-01
  Total weights = 1.955468093e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7703e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445682845180
                                         uncertainty =       0.002102723833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445682845180
                                         uncertainty =       0.002102723833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472103025
  error estimate for blocks of size 2^( 2) =       0.000495734410
  error estimate for blocks of size 2^( 3) =       0.000517794293
  error estimate for blocks of size 2^( 4) =       0.000532804897
  error estimate for blocks of size 2^( 5) =       0.000541215191
  error estimate for blocks of size 2^( 6) =       0.000545963121
  error estimate for blocks of size 2^( 7) =       0.000546904909

      target function =      -0.739915893377
              le_mean =     -22.663047774939
             les_mean =     514.070365846424
             stat err =       0.000541722030
             autocorr =       1.316677542335
   target nu stat err =       0.000541722030
   target dn stat err =       0.003058292431
      target stat err =       0.002545873067
              std dev =       0.667654500220
             le_variance =       0.445762531665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266304777494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739923788588       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739923795941       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739923796987       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739923797321       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739923797464       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739923797439       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739923797456       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739923797466       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739923797480       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739923797494       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739923797479       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739923797480       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+03 is 6.374276e-08

solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739923788588       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739923790426       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739923790688       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739923790771       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739923790805       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739923790812       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739923790822       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739923790805       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739923790803       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739923790820       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739923790846       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739923790828       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+04 is 1.593583e-08

solving harmonic davidson linear method for identity shift 5.5511e+04, overlap shift 5.5511e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739923788588       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739923789047       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739923789113       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739923789133       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739923789125       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739923789124       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739923789162       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739923789086       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739923789178       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739923789141       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739923789132       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739923789069       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+04 is 3.983967e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256464 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0579e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013055e-02 3 1  ON 2
ci_004                -5.100189e-02 3 1  ON 3
ci_005                 1.949555e-02 3 1  ON 4
ci_006                 1.981627e-02 3 1  ON 5
ci_007                 1.474575e-02 3 1  ON 6
ci_008                 1.554053e-02 3 1  ON 7
ci_009                -1.320067e-02 3 1  ON 8
ci_010                -1.207977e-02 3 1  ON 9
ci_011                -9.910120e-03 3 1  ON 10
ci_012                -9.098670e-03 3 1  ON 11
ci_013                 8.349355e-03 3 1  ON 12
ci_014                 9.369046e-03 3 1  ON 13
ci_015                 9.519391e-03 3 1  ON 14
ci_016                 9.412651e-03 3 1  ON 15
ci_017                 8.493669e-03 3 1  ON 16
ci_018                 8.286429e-03 3 1  ON 17
ci_019                -1.224215e-03 3 1  ON 18
ci_020                -1.536074e-03 3 1  ON 19
ci_021                -1.177709e-02 3 1  ON 20
ci_022                -1.179939e-02 3 1  ON 21
ci_023                 4.854124e-03 3 1  ON 22
ci_024                 4.919313e-03 3 1  ON 23
ci_025                 1.143644e-02 3 1  ON 24
ci_026                 1.147274e-02 3 1  ON 25
ci_027                 6.466925e-03 3 1  ON 26
ci_028                 6.188393e-03 3 1  ON 27
ci_029                -5.081716e-03 3 1  ON 28
ci_030                -4.169855e-03 3 1  ON 29
ci_031                 3.329847e-03 3 1  ON 30
ci_032                 4.543569e-03 3 1  ON 31
ci_033                 2.363572e-03 3 1  ON 32
ci_034                 4.136203e-03 3 1  ON 33
ci_035                 1.723733e-03 3 1  ON 34
ci_036                 2.153595e-03 3 1  ON 35
ci_037                 3.539110e-03 3 1  ON 36
ci_038                 3.699745e-03 3 1  ON 37
ci_039                 4.622365e-03 3 1  ON 38
ci_040                 4.935555e-03 3 1  ON 39
ci_041                 2.971147e-03 3 1  ON 40
ci_042                 2.733789e-03 3 1  ON 41
ci_043                 2.944556e-03 3 1  ON 42
ci_044                 3.188318e-03 3 1  ON 43
ci_045                 2.451386e-03 3 1  ON 44
ci_046                 2.720982e-03 3 1  ON 45
ci_047                -1.002264e-03 3 1  ON 46
ci_048                -8.338256e-04 3 1  ON 47
ci_049                 7.784402e-04 3 1  ON 48
ci_050                 9.957154e-04 3 1  ON 49
ci_051                -3.147591e-04 3 1  ON 50
ci_052                -1.210486e-03 3 1  ON 51
ci_053                -2.434066e-03 3 1  ON 52
ci_054                -2.689522e-03 3 1  ON 53
ci_055                -1.798802e-03 3 1  ON 54
ci_056                -1.928472e-03 3 1  ON 55
ci_057                -1.307358e-03 3 1  ON 56
ci_058                -9.882861e-04 3 1  ON 57
ci_059                -5.507159e-04 3 1  ON 58
ci_060                -7.598479e-04 3 1  ON 59
ci_061                -5.110232e-05 3 1  ON 60
ci_062                -9.206491e-04 3 1  ON 61
ci_063                -8.861409e-04 3 1  ON 62
ci_064                -5.243688e-04 3 1  ON 63
ci_065                -1.359387e-03 3 1  ON 64
ci_066                -1.883877e-03 3 1  ON 65
ci_067                -1.812764e-03 3 1  ON 66
ci_068                -1.556838e-03 3 1  ON 67
ci_069                -5.543824e-04 3 1  ON 68
ci_070                -4.262010e-04 3 1  ON 69
ci_071                -2.087840e-03 3 1  ON 70
ci_072                -2.000790e-03 3 1  ON 71
ci_073                 1.611782e-04 3 1  ON 72
ci_074                 1.976695e-04 3 1  ON 73
ci_075                 1.618628e-04 3 1  ON 74
ci_076                 7.851005e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.8514
    reference variance = 0.525942
====================================================
  Execution time = 2.5112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4614e-01
  Total weights = 1.9554e+06
  Execution time = 3.6059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438313707909
                                         uncertainty =       0.002254276937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438313707909
                                         uncertainty =       0.002254276937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468112907
  error estimate for blocks of size 2^( 2) =       0.000491949331
  error estimate for blocks of size 2^( 3) =       0.000513928667
  error estimate for blocks of size 2^( 4) =       0.000529566942
  error estimate for blocks of size 2^( 5) =       0.000539497470
  error estimate for blocks of size 2^( 6) =       0.000543973810
  error estimate for blocks of size 2^( 7) =       0.000548840867

      target function =      -0.748515770848
              le_mean =     -22.663392605720
             les_mean =     514.075504443013
             stat err =       0.000540469772
             autocorr =       1.333035106474
   target nu stat err =       0.000540469772
   target dn stat err =       0.002420050675
      target stat err =       0.002093418573
              std dev =       0.662011621733
             le_variance =       0.438259387309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438313699707
                                         uncertainty =       0.002254276718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438313699707
                                         uncertainty =       0.002254276718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468112903
  error estimate for blocks of size 2^( 2) =       0.000491949328
  error estimate for blocks of size 2^( 3) =       0.000513928665
  error estimate for blocks of size 2^( 4) =       0.000529566940
  error estimate for blocks of size 2^( 5) =       0.000539497469
  error estimate for blocks of size 2^( 6) =       0.000543973809
  error estimate for blocks of size 2^( 7) =       0.000548840868

      target function =      -0.748515798735
              le_mean =     -22.663392605863
             les_mean =     514.075504415850
             stat err =       0.000540469771
             autocorr =       1.333035128163
   target nu stat err =       0.000540469771
   target dn stat err =       0.002420049878
      target stat err =       0.002093418090
              std dev =       0.662011615518
             le_variance =       0.438259379080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438313703808
                                         uncertainty =       0.002254276828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438313703808
                                         uncertainty =       0.002254276828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468112905
  error estimate for blocks of size 2^( 2) =       0.000491949330
  error estimate for blocks of size 2^( 3) =       0.000513928666
  error estimate for blocks of size 2^( 4) =       0.000529566941
  error estimate for blocks of size 2^( 5) =       0.000539497469
  error estimate for blocks of size 2^( 6) =       0.000543973809
  error estimate for blocks of size 2^( 7) =       0.000548840867

      target function =      -0.748515784998
              le_mean =     -22.663392605792
             les_mean =     514.075504429181
             stat err =       0.000540469772
             autocorr =       1.333035117331
   target nu stat err =       0.000540469772
   target dn stat err =       0.002420050276
      target stat err =       0.002093418333
              std dev =       0.662011618625
             le_variance =       0.438259383195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438313707397
                                         uncertainty =       0.002254276924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438313707397
                                         uncertainty =       0.002254276924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468112907
  error estimate for blocks of size 2^( 2) =       0.000491949331
  error estimate for blocks of size 2^( 3) =       0.000513928667
  error estimate for blocks of size 2^( 4) =       0.000529566942
  error estimate for blocks of size 2^( 5) =       0.000539497470
  error estimate for blocks of size 2^( 6) =       0.000543973810
  error estimate for blocks of size 2^( 7) =       0.000548840867

      target function =      -0.748515772639
              le_mean =     -22.663392605729
             les_mean =     514.075504441256
             stat err =       0.000540469772
             autocorr =       1.333035107826
   target nu stat err =       0.000540469772
   target dn stat err =       0.002420050625
      target stat err =       0.002093418543
              std dev =       0.662011621345
             le_variance =       0.438259386796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748515770848        initial
     3.4694e+03     3.4694e+04             6.3743e-08        -0.748515798735  <--
     1.3878e+04     1.3878e+05             1.5936e-08        -0.748515784998
     5.5511e+04     5.5511e+05             3.9840e-09        -0.748515772639

*****************************************************************************
Applying the update for shift_i =   3.4694e+03     and shift_s =   3.4694e+04
*****************************************************************************

  Execution time = 4.3158e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029024e-01 3 1  ON 1
ci_003                -5.013051e-02 3 1  ON 2
ci_004                -5.100187e-02 3 1  ON 3
ci_005                 1.949553e-02 3 1  ON 4
ci_006                 1.981626e-02 3 1  ON 5
ci_007                 1.474574e-02 3 1  ON 6
ci_008                 1.554052e-02 3 1  ON 7
ci_009                -1.320067e-02 3 1  ON 8
ci_010                -1.207975e-02 3 1  ON 9
ci_011                -9.910103e-03 3 1  ON 10
ci_012                -9.098670e-03 3 1  ON 11
ci_013                 8.349333e-03 3 1  ON 12
ci_014                 9.369051e-03 3 1  ON 13
ci_015                 9.519371e-03 3 1  ON 14
ci_016                 9.412633e-03 3 1  ON 15
ci_017                 8.493660e-03 3 1  ON 16
ci_018                 8.286407e-03 3 1  ON 17
ci_019                -1.224240e-03 3 1  ON 18
ci_020                -1.536107e-03 3 1  ON 19
ci_021                -1.177711e-02 3 1  ON 20
ci_022                -1.179941e-02 3 1  ON 21
ci_023                 4.854138e-03 3 1  ON 22
ci_024                 4.919317e-03 3 1  ON 23
ci_025                 1.143645e-02 3 1  ON 24
ci_026                 1.147275e-02 3 1  ON 25
ci_027                 6.466918e-03 3 1  ON 26
ci_028                 6.188389e-03 3 1  ON 27
ci_029                -5.081697e-03 3 1  ON 28
ci_030                -4.169843e-03 3 1  ON 29
ci_031                 3.329895e-03 3 1  ON 30
ci_032                 4.543586e-03 3 1  ON 31
ci_033                 2.363572e-03 3 1  ON 32
ci_034                 4.136195e-03 3 1  ON 33
ci_035                 1.723738e-03 3 1  ON 34
ci_036                 2.153588e-03 3 1  ON 35
ci_037                 3.539088e-03 3 1  ON 36
ci_038                 3.699746e-03 3 1  ON 37
ci_039                 4.622365e-03 3 1  ON 38
ci_040                 4.935545e-03 3 1  ON 39
ci_041                 2.971166e-03 3 1  ON 40
ci_042                 2.733788e-03 3 1  ON 41
ci_043                 2.944584e-03 3 1  ON 42
ci_044                 3.188328e-03 3 1  ON 43
ci_045                 2.451392e-03 3 1  ON 44
ci_046                 2.720972e-03 3 1  ON 45
ci_047                -1.002271e-03 3 1  ON 46
ci_048                -8.338261e-04 3 1  ON 47
ci_049                 7.784395e-04 3 1  ON 48
ci_050                 9.957158e-04 3 1  ON 49
ci_051                -3.147593e-04 3 1  ON 50
ci_052                -1.210477e-03 3 1  ON 51
ci_053                -2.434028e-03 3 1  ON 52
ci_054                -2.689522e-03 3 1  ON 53
ci_055                -1.798779e-03 3 1  ON 54
ci_056                -1.928463e-03 3 1  ON 55
ci_057                -1.307359e-03 3 1  ON 56
ci_058                -9.882854e-04 3 1  ON 57
ci_059                -5.507000e-04 3 1  ON 58
ci_060                -7.598590e-04 3 1  ON 59
ci_061                -5.109831e-05 3 1  ON 60
ci_062                -9.206499e-04 3 1  ON 61
ci_063                -8.861255e-04 3 1  ON 62
ci_064                -5.243534e-04 3 1  ON 63
ci_065                -1.359414e-03 3 1  ON 64
ci_066                -1.883857e-03 3 1  ON 65
ci_067                -1.812781e-03 3 1  ON 66
ci_068                -1.556844e-03 3 1  ON 67
ci_069                -5.543982e-04 3 1  ON 68
ci_070                -4.261884e-04 3 1  ON 69
ci_071                -2.087825e-03 3 1  ON 70
ci_072                -2.000756e-03 3 1  ON 71
ci_073                 1.611832e-04 3 1  ON 72
ci_074                 1.976713e-04 3 1  ON 73
ci_075                 1.618645e-04 3 1  ON 74
ci_076                 7.850994e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3744e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.5984
    reference variance = 0.314671
====================================================
  Execution time = 2.5764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5315e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4957e-01
  Total weights = 1.955490731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440552001186
                                         uncertainty =       0.002572588899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440552001186
                                         uncertainty =       0.002572588899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469350705
  error estimate for blocks of size 2^( 2) =       0.000493065128
  error estimate for blocks of size 2^( 3) =       0.000514746801
  error estimate for blocks of size 2^( 4) =       0.000530669193
  error estimate for blocks of size 2^( 5) =       0.000540612881
  error estimate for blocks of size 2^( 6) =       0.000546522361
  error estimate for blocks of size 2^( 7) =       0.000549583434

      target function =      -0.745664597235
              le_mean =     -22.662029067317
             les_mean =     514.017134804481
             stat err =       0.000541846967
             autocorr =       1.332779623708
   target nu stat err =       0.000541846967
   target dn stat err =       0.002938501957
      target stat err =       0.002485076086
              std dev =       0.663762132596
             le_variance =       0.440580168669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266202906732e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745671891773       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745671937214       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745671944537       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745671944441       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745671944226       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745671944180       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745671944246       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745671944235       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745671944233       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+02 is 2.577807e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745671891773       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745671903134       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745671904965       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745671904941       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745671904887       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745671904882       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745671904889       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745671904885       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745671904890       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+03 is 6.444739e-08

solving harmonic davidson linear method for identity shift 1.3878e+04, overlap shift 1.3878e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745671891773       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745671894613       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745671895071       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745671895065       residual = 9.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745671895044       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745671895063       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745671895054       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745671895034       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745671895052       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+04 is 1.611198e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0499e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029024e-01 3 1  ON 1
ci_003                -5.013048e-02 3 1  ON 2
ci_004                -5.100183e-02 3 1  ON 3
ci_005                 1.949548e-02 3 1  ON 4
ci_006                 1.981625e-02 3 1  ON 5
ci_007                 1.474576e-02 3 1  ON 6
ci_008                 1.554050e-02 3 1  ON 7
ci_009                -1.320064e-02 3 1  ON 8
ci_010                -1.207975e-02 3 1  ON 9
ci_011                -9.910039e-03 3 1  ON 10
ci_012                -9.098624e-03 3 1  ON 11
ci_013                 8.349331e-03 3 1  ON 12
ci_014                 9.369061e-03 3 1  ON 13
ci_015                 9.519328e-03 3 1  ON 14
ci_016                 9.412652e-03 3 1  ON 15
ci_017                 8.493675e-03 3 1  ON 16
ci_018                 8.286397e-03 3 1  ON 17
ci_019                -1.224244e-03 3 1  ON 18
ci_020                -1.536123e-03 3 1  ON 19
ci_021                -1.177712e-02 3 1  ON 20
ci_022                -1.179944e-02 3 1  ON 21
ci_023                 4.854156e-03 3 1  ON 22
ci_024                 4.919300e-03 3 1  ON 23
ci_025                 1.143645e-02 3 1  ON 24
ci_026                 1.147278e-02 3 1  ON 25
ci_027                 6.466908e-03 3 1  ON 26
ci_028                 6.188363e-03 3 1  ON 27
ci_029                -5.081678e-03 3 1  ON 28
ci_030                -4.169827e-03 3 1  ON 29
ci_031                 3.329942e-03 3 1  ON 30
ci_032                 4.543556e-03 3 1  ON 31
ci_033                 2.363581e-03 3 1  ON 32
ci_034                 4.136188e-03 3 1  ON 33
ci_035                 1.723728e-03 3 1  ON 34
ci_036                 2.153576e-03 3 1  ON 35
ci_037                 3.539066e-03 3 1  ON 36
ci_038                 3.699758e-03 3 1  ON 37
ci_039                 4.622358e-03 3 1  ON 38
ci_040                 4.935526e-03 3 1  ON 39
ci_041                 2.971160e-03 3 1  ON 40
ci_042                 2.733780e-03 3 1  ON 41
ci_043                 2.944559e-03 3 1  ON 42
ci_044                 3.188277e-03 3 1  ON 43
ci_045                 2.451389e-03 3 1  ON 44
ci_046                 2.720986e-03 3 1  ON 45
ci_047                -1.002260e-03 3 1  ON 46
ci_048                -8.338237e-04 3 1  ON 47
ci_049                 7.784671e-04 3 1  ON 48
ci_050                 9.957087e-04 3 1  ON 49
ci_051                -3.147720e-04 3 1  ON 50
ci_052                -1.210469e-03 3 1  ON 51
ci_053                -2.434092e-03 3 1  ON 52
ci_054                -2.689506e-03 3 1  ON 53
ci_055                -1.798773e-03 3 1  ON 54
ci_056                -1.928405e-03 3 1  ON 55
ci_057                -1.307336e-03 3 1  ON 56
ci_058                -9.882904e-04 3 1  ON 57
ci_059                -5.506939e-04 3 1  ON 58
ci_060                -7.598597e-04 3 1  ON 59
ci_061                -5.108374e-05 3 1  ON 60
ci_062                -9.206429e-04 3 1  ON 61
ci_063                -8.861192e-04 3 1  ON 62
ci_064                -5.243332e-04 3 1  ON 63
ci_065                -1.359426e-03 3 1  ON 64
ci_066                -1.883879e-03 3 1  ON 65
ci_067                -1.812766e-03 3 1  ON 66
ci_068                -1.556877e-03 3 1  ON 67
ci_069                -5.544021e-04 3 1  ON 68
ci_070                -4.261622e-04 3 1  ON 69
ci_071                -2.087811e-03 3 1  ON 70
ci_072                -2.000764e-03 3 1  ON 71
ci_073                 1.611912e-04 3 1  ON 72
ci_074                 1.976741e-04 3 1  ON 73
ci_075                 1.618475e-04 3 1  ON 74
ci_076                 7.850987e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6236
    reference variance = 0.367915
====================================================
  Execution time = 2.5193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5401e-01
  Total weights = 1.9554e+06
  Execution time = 3.6229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437621346692
                                         uncertainty =       0.002008172544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437621346692
                                         uncertainty =       0.002008172544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467772694
  error estimate for blocks of size 2^( 2) =       0.000491658018
  error estimate for blocks of size 2^( 3) =       0.000513470106
  error estimate for blocks of size 2^( 4) =       0.000529174011
  error estimate for blocks of size 2^( 5) =       0.000538417868
  error estimate for blocks of size 2^( 6) =       0.000542830510
  error estimate for blocks of size 2^( 7) =       0.000542115553

      target function =      -0.741997796748
              le_mean =     -22.662176571817
             les_mean =     514.028256979860
             stat err =       0.000538134486
             autocorr =       1.323463338189
   target nu stat err =       0.000538134486
   target dn stat err =       0.007554020552
      target stat err =       0.006170683828
              std dev =       0.661530487834
             le_variance =       0.437622586333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437621229960
                                         uncertainty =       0.002008157146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437621229960
                                         uncertainty =       0.002008157146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467772631
  error estimate for blocks of size 2^( 2) =       0.000491657961
  error estimate for blocks of size 2^( 3) =       0.000513470057
  error estimate for blocks of size 2^( 4) =       0.000529173959
  error estimate for blocks of size 2^( 5) =       0.000538417811
  error estimate for blocks of size 2^( 6) =       0.000542830434
  error estimate for blocks of size 2^( 7) =       0.000542115485

      target function =      -0.741997980586
              le_mean =     -22.662176573726
             les_mean =     514.028256844898
             stat err =       0.000538134422
             autocorr =       1.323463381614
   target nu stat err =       0.000538134422
   target dn stat err =       0.007553739132
      target stat err =       0.006170459066
              std dev =       0.661530399233
             le_variance =       0.437622469109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437621288318
                                         uncertainty =       0.002008164844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437621288318
                                         uncertainty =       0.002008164844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467772663
  error estimate for blocks of size 2^( 2) =       0.000491657989
  error estimate for blocks of size 2^( 3) =       0.000513470082
  error estimate for blocks of size 2^( 4) =       0.000529173985
  error estimate for blocks of size 2^( 5) =       0.000538417839
  error estimate for blocks of size 2^( 6) =       0.000542830472
  error estimate for blocks of size 2^( 7) =       0.000542115519

      target function =      -0.741997889317
              le_mean =     -22.662176572771
             les_mean =     514.028256911572
             stat err =       0.000538134454
             autocorr =       1.323463359916
   target nu stat err =       0.000538134454
   target dn stat err =       0.007553879830
      target stat err =       0.006170571448
              std dev =       0.661530443527
             le_variance =       0.437622527713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437621339394
                                         uncertainty =       0.002008171582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437621339394
                                         uncertainty =       0.002008171582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467772690
  error estimate for blocks of size 2^( 2) =       0.000491658014
  error estimate for blocks of size 2^( 3) =       0.000513470103
  error estimate for blocks of size 2^( 4) =       0.000529174008
  error estimate for blocks of size 2^( 5) =       0.000538417864
  error estimate for blocks of size 2^( 6) =       0.000542830505
  error estimate for blocks of size 2^( 7) =       0.000542115549

      target function =      -0.741997808390
              le_mean =     -22.662176571937
             les_mean =     514.028256971237
             stat err =       0.000538134482
             autocorr =       1.323463340909
   target nu stat err =       0.000538134482
   target dn stat err =       0.007554002961
      target stat err =       0.006170669781
              std dev =       0.661530482295
             le_variance =       0.437622579005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741997796748        initial
     8.6736e+02     8.6736e+03             2.5778e-07        -0.741997980586  <--
     3.4694e+03     3.4694e+04             6.4447e-08        -0.741997889317
     1.3878e+04     1.3878e+05             1.6112e-08        -0.741997808390

*****************************************************************************
Applying the update for shift_i =   8.6736e+02     and shift_s =   8.6736e+03
*****************************************************************************

  Execution time = 4.3355e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029024e-01 3 1  ON 1
ci_003                -5.013040e-02 3 1  ON 2
ci_004                -5.100171e-02 3 1  ON 3
ci_005                 1.949533e-02 3 1  ON 4
ci_006                 1.981622e-02 3 1  ON 5
ci_007                 1.474582e-02 3 1  ON 6
ci_008                 1.554046e-02 3 1  ON 7
ci_009                -1.320054e-02 3 1  ON 8
ci_010                -1.207975e-02 3 1  ON 9
ci_011                -9.909846e-03 3 1  ON 10
ci_012                -9.098486e-03 3 1  ON 11
ci_013                 8.349327e-03 3 1  ON 12
ci_014                 9.369091e-03 3 1  ON 13
ci_015                 9.519197e-03 3 1  ON 14
ci_016                 9.412710e-03 3 1  ON 15
ci_017                 8.493719e-03 3 1  ON 16
ci_018                 8.286366e-03 3 1  ON 17
ci_019                -1.224255e-03 3 1  ON 18
ci_020                -1.536171e-03 3 1  ON 19
ci_021                -1.177714e-02 3 1  ON 20
ci_022                -1.179953e-02 3 1  ON 21
ci_023                 4.854213e-03 3 1  ON 22
ci_024                 4.919249e-03 3 1  ON 23
ci_025                 1.143645e-02 3 1  ON 24
ci_026                 1.147284e-02 3 1  ON 25
ci_027                 6.466878e-03 3 1  ON 26
ci_028                 6.188283e-03 3 1  ON 27
ci_029                -5.081621e-03 3 1  ON 28
ci_030                -4.169778e-03 3 1  ON 29
ci_031                 3.330082e-03 3 1  ON 30
ci_032                 4.543467e-03 3 1  ON 31
ci_033                 2.363609e-03 3 1  ON 32
ci_034                 4.136166e-03 3 1  ON 33
ci_035                 1.723697e-03 3 1  ON 34
ci_036                 2.153539e-03 3 1  ON 35
ci_037                 3.538997e-03 3 1  ON 36
ci_038                 3.699794e-03 3 1  ON 37
ci_039                 4.622335e-03 3 1  ON 38
ci_040                 4.935469e-03 3 1  ON 39
ci_041                 2.971144e-03 3 1  ON 40
ci_042                 2.733756e-03 3 1  ON 41
ci_043                 2.944482e-03 3 1  ON 42
ci_044                 3.188126e-03 3 1  ON 43
ci_045                 2.451381e-03 3 1  ON 44
ci_046                 2.721029e-03 3 1  ON 45
ci_047                -1.002227e-03 3 1  ON 46
ci_048                -8.338163e-04 3 1  ON 47
ci_049                 7.785498e-04 3 1  ON 48
ci_050                 9.956872e-04 3 1  ON 49
ci_051                -3.148100e-04 3 1  ON 50
ci_052                -1.210444e-03 3 1  ON 51
ci_053                -2.434283e-03 3 1  ON 52
ci_054                -2.689457e-03 3 1  ON 53
ci_055                -1.798755e-03 3 1  ON 54
ci_056                -1.928232e-03 3 1  ON 55
ci_057                -1.307268e-03 3 1  ON 56
ci_058                -9.883052e-04 3 1  ON 57
ci_059                -5.506756e-04 3 1  ON 58
ci_060                -7.598618e-04 3 1  ON 59
ci_061                -5.104005e-05 3 1  ON 60
ci_062                -9.206219e-04 3 1  ON 61
ci_063                -8.861002e-04 3 1  ON 62
ci_064                -5.242725e-04 3 1  ON 63
ci_065                -1.359461e-03 3 1  ON 64
ci_066                -1.883945e-03 3 1  ON 65
ci_067                -1.812719e-03 3 1  ON 66
ci_068                -1.556978e-03 3 1  ON 67
ci_069                -5.544139e-04 3 1  ON 68
ci_070                -4.260838e-04 3 1  ON 69
ci_071                -2.087771e-03 3 1  ON 70
ci_072                -2.000787e-03 3 1  ON 71
ci_073                 1.612153e-04 3 1  ON 72
ci_074                 1.976826e-04 3 1  ON 73
ci_075                 1.617965e-04 3 1  ON 74
ci_076                 7.850967e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3861e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.673
    reference variance = 0.295645
====================================================
  Execution time = 2.7766e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4712e-01
  Total weights = 1.955264897e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436972199230
                                         uncertainty =       0.001984524469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436972199230
                                         uncertainty =       0.001984524469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467392899
  error estimate for blocks of size 2^( 2) =       0.000491574413
  error estimate for blocks of size 2^( 3) =       0.000513837118
  error estimate for blocks of size 2^( 4) =       0.000531157765
  error estimate for blocks of size 2^( 5) =       0.000540949806
  error estimate for blocks of size 2^( 6) =       0.000547400465
  error estimate for blocks of size 2^( 7) =       0.000551300942

      target function =      -0.747675336389
              le_mean =     -22.661556670531
             les_mean =     513.993273118972
             stat err =       0.000542702244
             autocorr =       1.348214565938
   target nu stat err =       0.000542702244
   target dn stat err =       0.002923725115
      target stat err =       0.002484763830
              std dev =       0.660993377101
             le_variance =       0.436912244572


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266155667053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747682670143       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747682751618       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747682763803       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747682765654       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747682765807       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747682766154       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747682766312       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747682766476       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747682766532       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747682766538       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747682766543       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+02 is 8.791989e-07

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747682670143       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747682690515       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747682693562       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747682694025       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747682694062       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747682694151       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747682694188       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747682694229       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747682694244       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747682694245       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747682694247       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+02 is 2.198323e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747682670143       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747682675236       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747682675998       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747682676114       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747682676124       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747682676162       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747682676161       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747682676171       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747682676185       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747682676167       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747682676173       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+03 is 5.496012e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.263804 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2472e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_001                -7.055852e-01 3 1  ON 0
ci_002                -7.029025e-01 3 1  ON 1
ci_003                -5.013044e-02 3 1  ON 2
ci_004                -5.100175e-02 3 1  ON 3
ci_005                 1.949525e-02 3 1  ON 4
ci_006                 1.981613e-02 3 1  ON 5
ci_007                 1.474566e-02 3 1  ON 6
ci_008                 1.554032e-02 3 1  ON 7
ci_009                -1.320032e-02 3 1  ON 8
ci_010                -1.207959e-02 3 1  ON 9
ci_011                -9.909767e-03 3 1  ON 10
ci_012                -9.098470e-03 3 1  ON 11
ci_013                 8.349242e-03 3 1  ON 12
ci_014                 9.368923e-03 3 1  ON 13
ci_015                 9.519257e-03 3 1  ON 14
ci_016                 9.412583e-03 3 1  ON 15
ci_017                 8.493807e-03 3 1  ON 16
ci_018                 8.286266e-03 3 1  ON 17
ci_019                -1.224427e-03 3 1  ON 18
ci_020                -1.536245e-03 3 1  ON 19
ci_021                -1.177709e-02 3 1  ON 20
ci_022                -1.179972e-02 3 1  ON 21
ci_023                 4.854237e-03 3 1  ON 22
ci_024                 4.919236e-03 3 1  ON 23
ci_025                 1.143655e-02 3 1  ON 24
ci_026                 1.147287e-02 3 1  ON 25
ci_027                 6.466832e-03 3 1  ON 26
ci_028                 6.188232e-03 3 1  ON 27
ci_029                -5.081563e-03 3 1  ON 28
ci_030                -4.169722e-03 3 1  ON 29
ci_031                 3.330073e-03 3 1  ON 30
ci_032                 4.543560e-03 3 1  ON 31
ci_033                 2.363604e-03 3 1  ON 32
ci_034                 4.136118e-03 3 1  ON 33
ci_035                 1.723709e-03 3 1  ON 34
ci_036                 2.153478e-03 3 1  ON 35
ci_037                 3.538987e-03 3 1  ON 36
ci_038                 3.699785e-03 3 1  ON 37
ci_039                 4.622355e-03 3 1  ON 38
ci_040                 4.935451e-03 3 1  ON 39
ci_041                 2.971120e-03 3 1  ON 40
ci_042                 2.733792e-03 3 1  ON 41
ci_043                 2.944474e-03 3 1  ON 42
ci_044                 3.188168e-03 3 1  ON 43
ci_045                 2.451411e-03 3 1  ON 44
ci_046                 2.721059e-03 3 1  ON 45
ci_047                -1.002197e-03 3 1  ON 46
ci_048                -8.337839e-04 3 1  ON 47
ci_049                 7.785762e-04 3 1  ON 48
ci_050                 9.955768e-04 3 1  ON 49
ci_051                -3.147993e-04 3 1  ON 50
ci_052                -1.210358e-03 3 1  ON 51
ci_053                -2.434183e-03 3 1  ON 52
ci_054                -2.689502e-03 3 1  ON 53
ci_055                -1.798865e-03 3 1  ON 54
ci_056                -1.928206e-03 3 1  ON 55
ci_057                -1.307250e-03 3 1  ON 56
ci_058                -9.883166e-04 3 1  ON 57
ci_059                -5.506792e-04 3 1  ON 58
ci_060                -7.598849e-04 3 1  ON 59
ci_061                -5.106374e-05 3 1  ON 60
ci_062                -9.205804e-04 3 1  ON 61
ci_063                -8.860812e-04 3 1  ON 62
ci_064                -5.243282e-04 3 1  ON 63
ci_065                -1.359450e-03 3 1  ON 64
ci_066                -1.883930e-03 3 1  ON 65
ci_067                -1.812686e-03 3 1  ON 66
ci_068                -1.556951e-03 3 1  ON 67
ci_069                -5.543874e-04 3 1  ON 68
ci_070                -4.260516e-04 3 1  ON 69
ci_071                -2.087733e-03 3 1  ON 70
ci_072                -2.000741e-03 3 1  ON 71
ci_073                 1.611659e-04 3 1  ON 72
ci_074                 1.976962e-04 3 1  ON 73
ci_075                 1.617837e-04 3 1  ON 74
ci_076                 7.850562e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.5902
    reference variance = 0.438845
====================================================
  Execution time = 2.5010e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4891e-01
  Total weights = 1.9553e+06
  Execution time = 3.6069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892292680
                                         uncertainty =       0.002085050054

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892292680
                                         uncertainty =       0.002085050054

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468434482
  error estimate for blocks of size 2^( 2) =       0.000492433876
  error estimate for blocks of size 2^( 3) =       0.000514295733
  error estimate for blocks of size 2^( 4) =       0.000528448289
  error estimate for blocks of size 2^( 5) =       0.000537700366
  error estimate for blocks of size 2^( 6) =       0.000543164858
  error estimate for blocks of size 2^( 7) =       0.000544568399

      target function =      -0.746212573461
              le_mean =     -22.661888727099
             les_mean =     514.010107828663
             stat err =       0.000538470478
             autocorr =       1.321374991044
   target nu stat err =       0.000538470478
   target dn stat err =       0.002448679191
      target stat err =       0.002098393139
              std dev =       0.662466397402
             le_variance =       0.438861727687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892037876
                                         uncertainty =       0.002085042858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892037876
                                         uncertainty =       0.002085042858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468434346
  error estimate for blocks of size 2^( 2) =       0.000492433774
  error estimate for blocks of size 2^( 3) =       0.000514295643
  error estimate for blocks of size 2^( 4) =       0.000528448213
  error estimate for blocks of size 2^( 5) =       0.000537700278
  error estimate for blocks of size 2^( 6) =       0.000543164793
  error estimate for blocks of size 2^( 7) =       0.000544568365

      target function =      -0.746212303998
              le_mean =     -22.661888726075
             les_mean =     514.010108109987
             stat err =       0.000538470412
             autocorr =       1.321375435908
   target nu stat err =       0.000538470412
   target dn stat err =       0.002448692257
      target stat err =       0.002098401962
              std dev =       0.662466204918
             le_variance =       0.438861472659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892165240
                                         uncertainty =       0.002085046455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892165240
                                         uncertainty =       0.002085046455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468434414
  error estimate for blocks of size 2^( 2) =       0.000492433825
  error estimate for blocks of size 2^( 3) =       0.000514295688
  error estimate for blocks of size 2^( 4) =       0.000528448251
  error estimate for blocks of size 2^( 5) =       0.000537700322
  error estimate for blocks of size 2^( 6) =       0.000543164825
  error estimate for blocks of size 2^( 7) =       0.000544568382

      target function =      -0.746212440017
              le_mean =     -22.661888726585
             les_mean =     514.010107967644
             stat err =       0.000538470445
             autocorr =       1.321375213535
   target nu stat err =       0.000538470445
   target dn stat err =       0.002448685596
      target stat err =       0.002098397457
              std dev =       0.662466301132
             le_variance =       0.438861600135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892276747
                                         uncertainty =       0.002085049604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438892276747
                                         uncertainty =       0.002085049604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468434473
  error estimate for blocks of size 2^( 2) =       0.000492433870
  error estimate for blocks of size 2^( 3) =       0.000514295727
  error estimate for blocks of size 2^( 4) =       0.000528448284
  error estimate for blocks of size 2^( 5) =       0.000537700361
  error estimate for blocks of size 2^( 6) =       0.000543164854
  error estimate for blocks of size 2^( 7) =       0.000544568397

      target function =      -0.746212556921
              le_mean =     -22.661888727035
             les_mean =     514.010107845852
             stat err =       0.000538470474
             autocorr =       1.321375018854
   target nu stat err =       0.000538470474
   target dn stat err =       0.002448679978
      target stat err =       0.002098393668
              std dev =       0.662466385367
             le_variance =       0.438861711741


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746212573461        initial  <--
     2.1684e+02     2.1684e+03             8.7920e-07        -0.746212303998
     8.6736e+02     8.6736e+03             2.1983e-07        -0.746212440017
     3.4694e+03     3.4694e+04             5.4960e-08        -0.746212556921

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.7928
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029024e-01 3 1  ON 1
ci_003                -5.013040e-02 3 1  ON 2
ci_004                -5.100171e-02 3 1  ON 3
ci_005                 1.949533e-02 3 1  ON 4
ci_006                 1.981622e-02 3 1  ON 5
ci_007                 1.474582e-02 3 1  ON 6
ci_008                 1.554046e-02 3 1  ON 7
ci_009                -1.320054e-02 3 1  ON 8
ci_010                -1.207975e-02 3 1  ON 9
ci_011                -9.909846e-03 3 1  ON 10
ci_012                -9.098486e-03 3 1  ON 11
ci_013                 8.349327e-03 3 1  ON 12
ci_014                 9.369091e-03 3 1  ON 13
ci_015                 9.519197e-03 3 1  ON 14
ci_016                 9.412710e-03 3 1  ON 15
ci_017                 8.493719e-03 3 1  ON 16
ci_018                 8.286366e-03 3 1  ON 17
ci_019                -1.224255e-03 3 1  ON 18
ci_020                -1.536171e-03 3 1  ON 19
ci_021                -1.177714e-02 3 1  ON 20
ci_022                -1.179953e-02 3 1  ON 21
ci_023                 4.854213e-03 3 1  ON 22
ci_024                 4.919249e-03 3 1  ON 23
ci_025                 1.143645e-02 3 1  ON 24
ci_026                 1.147284e-02 3 1  ON 25
ci_027                 6.466878e-03 3 1  ON 26
ci_028                 6.188283e-03 3 1  ON 27
ci_029                -5.081621e-03 3 1  ON 28
ci_030                -4.169778e-03 3 1  ON 29
ci_031                 3.330082e-03 3 1  ON 30
ci_032                 4.543467e-03 3 1  ON 31
ci_033                 2.363609e-03 3 1  ON 32
ci_034                 4.136166e-03 3 1  ON 33
ci_035                 1.723697e-03 3 1  ON 34
ci_036                 2.153539e-03 3 1  ON 35
ci_037                 3.538997e-03 3 1  ON 36
ci_038                 3.699794e-03 3 1  ON 37
ci_039                 4.622335e-03 3 1  ON 38
ci_040                 4.935469e-03 3 1  ON 39
ci_041                 2.971144e-03 3 1  ON 40
ci_042                 2.733756e-03 3 1  ON 41
ci_043                 2.944482e-03 3 1  ON 42
ci_044                 3.188126e-03 3 1  ON 43
ci_045                 2.451381e-03 3 1  ON 44
ci_046                 2.721029e-03 3 1  ON 45
ci_047                -1.002227e-03 3 1  ON 46
ci_048                -8.338163e-04 3 1  ON 47
ci_049                 7.785498e-04 3 1  ON 48
ci_050                 9.956872e-04 3 1  ON 49
ci_051                -3.148100e-04 3 1  ON 50
ci_052                -1.210444e-03 3 1  ON 51
ci_053                -2.434283e-03 3 1  ON 52
ci_054                -2.689457e-03 3 1  ON 53
ci_055                -1.798755e-03 3 1  ON 54
ci_056                -1.928232e-03 3 1  ON 55
ci_057                -1.307268e-03 3 1  ON 56
ci_058                -9.883052e-04 3 1  ON 57
ci_059                -5.506756e-04 3 1  ON 58
ci_060                -7.598618e-04 3 1  ON 59
ci_061                -5.104005e-05 3 1  ON 60
ci_062                -9.206219e-04 3 1  ON 61
ci_063                -8.861002e-04 3 1  ON 62
ci_064                -5.242725e-04 3 1  ON 63
ci_065                -1.359461e-03 3 1  ON 64
ci_066                -1.883945e-03 3 1  ON 65
ci_067                -1.812719e-03 3 1  ON 66
ci_068                -1.556978e-03 3 1  ON 67
ci_069                -5.544139e-04 3 1  ON 68
ci_070                -4.260838e-04 3 1  ON 69
ci_071                -2.087771e-03 3 1  ON 70
ci_072                -2.000787e-03 3 1  ON 71
ci_073                 1.612153e-04 3 1  ON 72
ci_074                 1.976826e-04 3 1  ON 73
ci_075                 1.617965e-04 3 1  ON 74
ci_076                 7.850967e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6991
    reference variance = 0.467563
====================================================
  Execution time = 2.5689e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4687e-01
  Total weights = 1.955489386e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438169894397
                                         uncertainty =       0.001782885891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438169894397
                                         uncertainty =       0.001782885891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468029491
  error estimate for blocks of size 2^( 2) =       0.000491877378
  error estimate for blocks of size 2^( 3) =       0.000513952534
  error estimate for blocks of size 2^( 4) =       0.000529788761
  error estimate for blocks of size 2^( 5) =       0.000540856369
  error estimate for blocks of size 2^( 6) =       0.000545063179
  error estimate for blocks of size 2^( 7) =       0.000547472458

      target function =      -0.747895831040
              le_mean =     -22.662392416101
             les_mean =     514.030902787311
             stat err =       0.000540795192
             autocorr =       1.335116626251
   target nu stat err =       0.000540795192
   target dn stat err =       0.002419147605
      target stat err =       0.002086393738
              std dev =       0.661893654171
             le_variance =       0.438103209431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266239241610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+03, overlap shift 2.1684e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747900753624       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747900762130       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747900763310       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747900763514       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747900763538       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747900763531       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747900763524       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747900763522       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747900763528       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747900763523       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747900763536       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+03 is 9.033346e-08

solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747900753624       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747900755750       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747900756045       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747900756096       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747900756103       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747900756089       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747900756101       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747900756101       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747900756107       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747900756094       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747900756090       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+03 is 2.258366e-08

solving harmonic davidson linear method for identity shift 3.4694e+04, overlap shift 3.4694e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747900753624       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747900754155       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747900754229       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747900754242       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747900754250       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747900754266       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747900754248       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747900754367       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747900754249       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747900754170       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747900754267       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+04 is 5.645932e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0398e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029024e-01 3 1  ON 1
ci_003                -5.013037e-02 3 1  ON 2
ci_004                -5.100171e-02 3 1  ON 3
ci_005                 1.949532e-02 3 1  ON 4
ci_006                 1.981621e-02 3 1  ON 5
ci_007                 1.474580e-02 3 1  ON 6
ci_008                 1.554044e-02 3 1  ON 7
ci_009                -1.320054e-02 3 1  ON 8
ci_010                -1.207974e-02 3 1  ON 9
ci_011                -9.909827e-03 3 1  ON 10
ci_012                -9.098481e-03 3 1  ON 11
ci_013                 8.349320e-03 3 1  ON 12
ci_014                 9.369078e-03 3 1  ON 13
ci_015                 9.519187e-03 3 1  ON 14
ci_016                 9.412705e-03 3 1  ON 15
ci_017                 8.493722e-03 3 1  ON 16
ci_018                 8.286369e-03 3 1  ON 17
ci_019                -1.224278e-03 3 1  ON 18
ci_020                -1.536191e-03 3 1  ON 19
ci_021                -1.177716e-02 3 1  ON 20
ci_022                -1.179953e-02 3 1  ON 21
ci_023                 4.854213e-03 3 1  ON 22
ci_024                 4.919249e-03 3 1  ON 23
ci_025                 1.143647e-02 3 1  ON 24
ci_026                 1.147286e-02 3 1  ON 25
ci_027                 6.466875e-03 3 1  ON 26
ci_028                 6.188282e-03 3 1  ON 27
ci_029                -5.081612e-03 3 1  ON 28
ci_030                -4.169780e-03 3 1  ON 29
ci_031                 3.330089e-03 3 1  ON 30
ci_032                 4.543474e-03 3 1  ON 31
ci_033                 2.363607e-03 3 1  ON 32
ci_034                 4.136161e-03 3 1  ON 33
ci_035                 1.723696e-03 3 1  ON 34
ci_036                 2.153539e-03 3 1  ON 35
ci_037                 3.538994e-03 3 1  ON 36
ci_038                 3.699789e-03 3 1  ON 37
ci_039                 4.622334e-03 3 1  ON 38
ci_040                 4.935467e-03 3 1  ON 39
ci_041                 2.971141e-03 3 1  ON 40
ci_042                 2.733761e-03 3 1  ON 41
ci_043                 2.944480e-03 3 1  ON 42
ci_044                 3.188125e-03 3 1  ON 43
ci_045                 2.451381e-03 3 1  ON 44
ci_046                 2.721030e-03 3 1  ON 45
ci_047                -1.002225e-03 3 1  ON 46
ci_048                -8.338142e-04 3 1  ON 47
ci_049                 7.785490e-04 3 1  ON 48
ci_050                 9.956971e-04 3 1  ON 49
ci_051                -3.148109e-04 3 1  ON 50
ci_052                -1.210439e-03 3 1  ON 51
ci_053                -2.434287e-03 3 1  ON 52
ci_054                -2.689459e-03 3 1  ON 53
ci_055                -1.798752e-03 3 1  ON 54
ci_056                -1.928225e-03 3 1  ON 55
ci_057                -1.307256e-03 3 1  ON 56
ci_058                -9.883054e-04 3 1  ON 57
ci_059                -5.506778e-04 3 1  ON 58
ci_060                -7.598569e-04 3 1  ON 59
ci_061                -5.103892e-05 3 1  ON 60
ci_062                -9.206136e-04 3 1  ON 61
ci_063                -8.861016e-04 3 1  ON 62
ci_064                -5.242714e-04 3 1  ON 63
ci_065                -1.359469e-03 3 1  ON 64
ci_066                -1.883936e-03 3 1  ON 65
ci_067                -1.812724e-03 3 1  ON 66
ci_068                -1.556983e-03 3 1  ON 67
ci_069                -5.544093e-04 3 1  ON 68
ci_070                -4.260795e-04 3 1  ON 69
ci_071                -2.087762e-03 3 1  ON 70
ci_072                -2.000785e-03 3 1  ON 71
ci_073                 1.612175e-04 3 1  ON 72
ci_074                 1.976815e-04 3 1  ON 73
ci_075                 1.617922e-04 3 1  ON 74
ci_076                 7.850878e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6617
    reference variance = 0.418647
====================================================
  Execution time = 2.5253e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5274e-01
  Total weights = 1.9550e+06
  Execution time = 3.6077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442466665167
                                         uncertainty =       0.001993660774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442466665167
                                         uncertainty =       0.001993660774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470336141
  error estimate for blocks of size 2^( 2) =       0.000494242372
  error estimate for blocks of size 2^( 3) =       0.000516558570
  error estimate for blocks of size 2^( 4) =       0.000532396857
  error estimate for blocks of size 2^( 5) =       0.000540806683
  error estimate for blocks of size 2^( 6) =       0.000545157605
  error estimate for blocks of size 2^( 7) =       0.000544728462

      target function =      -0.743069889241
              le_mean =     -22.661262150057
             les_mean =     513.985541380452
             stat err =       0.000540772402
             autocorr =       1.321941799834
   target nu stat err =       0.000540772402
   target dn stat err =       0.002700404609
      target stat err =       0.002277500784
              std dev =       0.665155749610
             le_variance =       0.442432171240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442466644287
                                         uncertainty =       0.001993660814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442466644287
                                         uncertainty =       0.001993660814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470336130
  error estimate for blocks of size 2^( 2) =       0.000494242363
  error estimate for blocks of size 2^( 3) =       0.000516558560
  error estimate for blocks of size 2^( 4) =       0.000532396846
  error estimate for blocks of size 2^( 5) =       0.000540806671
  error estimate for blocks of size 2^( 6) =       0.000545157592
  error estimate for blocks of size 2^( 7) =       0.000544728451

      target function =      -0.743069914019
              le_mean =     -22.661262149853
             les_mean =     513.985541340712
             stat err =       0.000540772390
             autocorr =       1.321941805868
   target nu stat err =       0.000540772390
   target dn stat err =       0.002700415673
      target stat err =       0.002277509626
              std dev =       0.665155733958
             le_variance =       0.442432150417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442466654726
                                         uncertainty =       0.001993660794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442466654726
                                         uncertainty =       0.001993660794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470336136
  error estimate for blocks of size 2^( 2) =       0.000494242367
  error estimate for blocks of size 2^( 3) =       0.000516558565
  error estimate for blocks of size 2^( 4) =       0.000532396852
  error estimate for blocks of size 2^( 5) =       0.000540806677
  error estimate for blocks of size 2^( 6) =       0.000545157598
  error estimate for blocks of size 2^( 7) =       0.000544728457

      target function =      -0.743069901647
              le_mean =     -22.661262149955
             les_mean =     513.985541360561
             stat err =       0.000540772396
             autocorr =       1.321941802853
   target nu stat err =       0.000540772396
   target dn stat err =       0.002700410140
      target stat err =       0.002277505205
              std dev =       0.665155741784
             le_variance =       0.442432160828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442466663862
                                         uncertainty =       0.001993660777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442466663862
                                         uncertainty =       0.001993660777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470336140
  error estimate for blocks of size 2^( 2) =       0.000494242372
  error estimate for blocks of size 2^( 3) =       0.000516558569
  error estimate for blocks of size 2^( 4) =       0.000532396856
  error estimate for blocks of size 2^( 5) =       0.000540806682
  error estimate for blocks of size 2^( 6) =       0.000545157604
  error estimate for blocks of size 2^( 7) =       0.000544728462

      target function =      -0.743069890793
              le_mean =     -22.661262150044
             les_mean =     513.985541377963
             stat err =       0.000540772401
             autocorr =       1.321941800210
   target nu stat err =       0.000540772401
   target dn stat err =       0.002700405300
      target stat err =       0.002277501336
              std dev =       0.665155748632
             le_variance =       0.442432169938


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743069889241        initial
     2.1684e+03     2.1684e+04             9.0333e-08        -0.743069914019  <--
     8.6736e+03     8.6736e+04             2.2584e-08        -0.743069901647
     3.4694e+04     3.4694e+05             5.6459e-09        -0.743069890793

*****************************************************************************
Applying the update for shift_i =   2.1684e+03     and shift_s =   2.1684e+04
*****************************************************************************

  Execution time = 4.3305e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029024e-01 3 1  ON 1
ci_003                -5.013031e-02 3 1  ON 2
ci_004                -5.100170e-02 3 1  ON 3
ci_005                 1.949531e-02 3 1  ON 4
ci_006                 1.981619e-02 3 1  ON 5
ci_007                 1.474577e-02 3 1  ON 6
ci_008                 1.554041e-02 3 1  ON 7
ci_009                -1.320053e-02 3 1  ON 8
ci_010                -1.207971e-02 3 1  ON 9
ci_011                -9.909771e-03 3 1  ON 10
ci_012                -9.098467e-03 3 1  ON 11
ci_013                 8.349298e-03 3 1  ON 12
ci_014                 9.369039e-03 3 1  ON 13
ci_015                 9.519158e-03 3 1  ON 14
ci_016                 9.412688e-03 3 1  ON 15
ci_017                 8.493730e-03 3 1  ON 16
ci_018                 8.286377e-03 3 1  ON 17
ci_019                -1.224346e-03 3 1  ON 18
ci_020                -1.536252e-03 3 1  ON 19
ci_021                -1.177720e-02 3 1  ON 20
ci_022                -1.179953e-02 3 1  ON 21
ci_023                 4.854213e-03 3 1  ON 22
ci_024                 4.919250e-03 3 1  ON 23
ci_025                 1.143653e-02 3 1  ON 24
ci_026                 1.147291e-02 3 1  ON 25
ci_027                 6.466867e-03 3 1  ON 26
ci_028                 6.188281e-03 3 1  ON 27
ci_029                -5.081585e-03 3 1  ON 28
ci_030                -4.169786e-03 3 1  ON 29
ci_031                 3.330112e-03 3 1  ON 30
ci_032                 4.543496e-03 3 1  ON 31
ci_033                 2.363600e-03 3 1  ON 32
ci_034                 4.136145e-03 3 1  ON 33
ci_035                 1.723693e-03 3 1  ON 34
ci_036                 2.153538e-03 3 1  ON 35
ci_037                 3.538983e-03 3 1  ON 36
ci_038                 3.699773e-03 3 1  ON 37
ci_039                 4.622333e-03 3 1  ON 38
ci_040                 4.935459e-03 3 1  ON 39
ci_041                 2.971129e-03 3 1  ON 40
ci_042                 2.733775e-03 3 1  ON 41
ci_043                 2.944475e-03 3 1  ON 42
ci_044                 3.188124e-03 3 1  ON 43
ci_045                 2.451380e-03 3 1  ON 44
ci_046                 2.721031e-03 3 1  ON 45
ci_047                -1.002219e-03 3 1  ON 46
ci_048                -8.338076e-04 3 1  ON 47
ci_049                 7.785467e-04 3 1  ON 48
ci_050                 9.957267e-04 3 1  ON 49
ci_051                -3.148137e-04 3 1  ON 50
ci_052                -1.210422e-03 3 1  ON 51
ci_053                -2.434299e-03 3 1  ON 52
ci_054                -2.689465e-03 3 1  ON 53
ci_055                -1.798743e-03 3 1  ON 54
ci_056                -1.928205e-03 3 1  ON 55
ci_057                -1.307221e-03 3 1  ON 56
ci_058                -9.883059e-04 3 1  ON 57
ci_059                -5.506845e-04 3 1  ON 58
ci_060                -7.598420e-04 3 1  ON 59
ci_061                -5.103554e-05 3 1  ON 60
ci_062                -9.205885e-04 3 1  ON 61
ci_063                -8.861057e-04 3 1  ON 62
ci_064                -5.242682e-04 3 1  ON 63
ci_065                -1.359493e-03 3 1  ON 64
ci_066                -1.883909e-03 3 1  ON 65
ci_067                -1.812740e-03 3 1  ON 66
ci_068                -1.556998e-03 3 1  ON 67
ci_069                -5.543954e-04 3 1  ON 68
ci_070                -4.260665e-04 3 1  ON 69
ci_071                -2.087738e-03 3 1  ON 70
ci_072                -2.000778e-03 3 1  ON 71
ci_073                 1.612240e-04 3 1  ON 72
ci_074                 1.976782e-04 3 1  ON 73
ci_075                 1.617793e-04 3 1  ON 74
ci_076                 7.850612e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3710e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.682
    reference variance = 0.335645
====================================================
  Execution time = 2.5904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5413e-01
  Total weights = 1.955285487e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442957001392
                                         uncertainty =       0.002664276632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442957001392
                                         uncertainty =       0.002664276632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470584343
  error estimate for blocks of size 2^( 2) =       0.000494741185
  error estimate for blocks of size 2^( 3) =       0.000516516134
  error estimate for blocks of size 2^( 4) =       0.000532186483
  error estimate for blocks of size 2^( 5) =       0.000540668088
  error estimate for blocks of size 2^( 6) =       0.000544011002
  error estimate for blocks of size 2^( 7) =       0.000547726793

      target function =      -0.741937890729
              le_mean =     -22.662272550013
             les_mean =     514.032726627283
             stat err =       0.000541148092
             autocorr =       1.322383177525
   target nu stat err =       0.000541148092
   target dn stat err =       0.003938828488
      target stat err =       0.003257022841
              std dev =       0.665506759769
             le_variance =       0.442899247298


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266227255001e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741951377985       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741951487661       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741951508977       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741951510684       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741951511018       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741951511027       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741951511143       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741951511252       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741951511213       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741951511209       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741951511202       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+02 is 8.347732e-07

solving harmonic davidson linear method for identity shift 2.1684e+03, overlap shift 2.1684e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741951377985       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741951405406       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741951410735       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741951411165       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741951411247       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741951411247       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741951411279       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741951411301       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741951411296       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741951411300       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741951411292       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+03 is 2.087052e-07

solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741951377985       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741951384840       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741951386172       residual = 7.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741951386279       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741951386313       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741951386304       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741951386293       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741951386306       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741951386310       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741951386304       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741951386303       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+03 is 5.217705e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0619e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_001                -7.055853e-01 3 1  ON 0
ci_002                -7.029024e-01 3 1  ON 1
ci_003                -5.013028e-02 3 1  ON 2
ci_004                -5.100169e-02 3 1  ON 3
ci_005                 1.949526e-02 3 1  ON 4
ci_006                 1.981610e-02 3 1  ON 5
ci_007                 1.474573e-02 3 1  ON 6
ci_008                 1.554030e-02 3 1  ON 7
ci_009                -1.320054e-02 3 1  ON 8
ci_010                -1.207970e-02 3 1  ON 9
ci_011                -9.909720e-03 3 1  ON 10
ci_012                -9.098436e-03 3 1  ON 11
ci_013                 8.349315e-03 3 1  ON 12
ci_014                 9.369018e-03 3 1  ON 13
ci_015                 9.519142e-03 3 1  ON 14
ci_016                 9.412636e-03 3 1  ON 15
ci_017                 8.493720e-03 3 1  ON 16
ci_018                 8.286346e-03 3 1  ON 17
ci_019                -1.224386e-03 3 1  ON 18
ci_020                -1.536460e-03 3 1  ON 19
ci_021                -1.177722e-02 3 1  ON 20
ci_022                -1.179956e-02 3 1  ON 21
ci_023                 4.854204e-03 3 1  ON 22
ci_024                 4.919255e-03 3 1  ON 23
ci_025                 1.143664e-02 3 1  ON 24
ci_026                 1.147309e-02 3 1  ON 25
ci_027                 6.466869e-03 3 1  ON 26
ci_028                 6.188261e-03 3 1  ON 27
ci_029                -5.081581e-03 3 1  ON 28
ci_030                -4.169773e-03 3 1  ON 29
ci_031                 3.330133e-03 3 1  ON 30
ci_032                 4.543572e-03 3 1  ON 31
ci_033                 2.363590e-03 3 1  ON 32
ci_034                 4.136096e-03 3 1  ON 33
ci_035                 1.723670e-03 3 1  ON 34
ci_036                 2.153527e-03 3 1  ON 35
ci_037                 3.538988e-03 3 1  ON 36
ci_038                 3.699810e-03 3 1  ON 37
ci_039                 4.622292e-03 3 1  ON 38
ci_040                 4.935462e-03 3 1  ON 39
ci_041                 2.971135e-03 3 1  ON 40
ci_042                 2.733781e-03 3 1  ON 41
ci_043                 2.944495e-03 3 1  ON 42
ci_044                 3.188129e-03 3 1  ON 43
ci_045                 2.451473e-03 3 1  ON 44
ci_046                 2.721050e-03 3 1  ON 45
ci_047                -1.002205e-03 3 1  ON 46
ci_048                -8.337731e-04 3 1  ON 47
ci_049                 7.785337e-04 3 1  ON 48
ci_050                 9.957370e-04 3 1  ON 49
ci_051                -3.148188e-04 3 1  ON 50
ci_052                -1.210297e-03 3 1  ON 51
ci_053                -2.434304e-03 3 1  ON 52
ci_054                -2.689482e-03 3 1  ON 53
ci_055                -1.798713e-03 3 1  ON 54
ci_056                -1.928221e-03 3 1  ON 55
ci_057                -1.307195e-03 3 1  ON 56
ci_058                -9.883266e-04 3 1  ON 57
ci_059                -5.506412e-04 3 1  ON 58
ci_060                -7.598090e-04 3 1  ON 59
ci_061                -5.101711e-05 3 1  ON 60
ci_062                -9.205761e-04 3 1  ON 61
ci_063                -8.861042e-04 3 1  ON 62
ci_064                -5.241931e-04 3 1  ON 63
ci_065                -1.359515e-03 3 1  ON 64
ci_066                -1.883896e-03 3 1  ON 65
ci_067                -1.812741e-03 3 1  ON 66
ci_068                -1.556986e-03 3 1  ON 67
ci_069                -5.543971e-04 3 1  ON 68
ci_070                -4.260828e-04 3 1  ON 69
ci_071                -2.087687e-03 3 1  ON 70
ci_072                -2.000714e-03 3 1  ON 71
ci_073                 1.612341e-04 3 1  ON 72
ci_074                 1.976419e-04 3 1  ON 73
ci_075                 1.618138e-04 3 1  ON 74
ci_076                 7.850796e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.6678
    reference variance = 0.42832
====================================================
  Execution time = 2.4946e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4780e-01
  Total weights = 1.9554e+06
  Execution time = 3.6086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439981894443
                                         uncertainty =       0.002248126328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439981894443
                                         uncertainty =       0.002248126328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468990764
  error estimate for blocks of size 2^( 2) =       0.000492986785
  error estimate for blocks of size 2^( 3) =       0.000515603498
  error estimate for blocks of size 2^( 4) =       0.000531580167
  error estimate for blocks of size 2^( 5) =       0.000542735908
  error estimate for blocks of size 2^( 6) =       0.000545923739
  error estimate for blocks of size 2^( 7) =       0.000547514846

      target function =      -0.747126861599
              le_mean =     -22.662114746693
             les_mean =     514.019243426237
             stat err =       0.000541938665
             autocorr =       1.335277999965
   target nu stat err =       0.000541938665
   target dn stat err =       0.002688084400
      target stat err =       0.002295018244
              std dev =       0.663253099525
             le_variance =       0.439904674029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439981761898
                                         uncertainty =       0.002248123559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439981761898
                                         uncertainty =       0.002248123559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468990694
  error estimate for blocks of size 2^( 2) =       0.000492986727
  error estimate for blocks of size 2^( 3) =       0.000515603449
  error estimate for blocks of size 2^( 4) =       0.000531580121
  error estimate for blocks of size 2^( 5) =       0.000542735852
  error estimate for blocks of size 2^( 6) =       0.000545923693
  error estimate for blocks of size 2^( 7) =       0.000547514794

      target function =      -0.747126899981
              le_mean =     -22.662114750379
             les_mean =     514.019243546862
             stat err =       0.000541938615
             autocorr =       1.335278156468
   target nu stat err =       0.000541938615
   target dn stat err =       0.002688068891
      target stat err =       0.002295006127
              std dev =       0.663252999503
             le_variance =       0.439904541350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439981828160
                                         uncertainty =       0.002248124943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439981828160
                                         uncertainty =       0.002248124943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468990729
  error estimate for blocks of size 2^( 2) =       0.000492986756
  error estimate for blocks of size 2^( 3) =       0.000515603473
  error estimate for blocks of size 2^( 4) =       0.000531580144
  error estimate for blocks of size 2^( 5) =       0.000542735880
  error estimate for blocks of size 2^( 6) =       0.000545923716
  error estimate for blocks of size 2^( 7) =       0.000547514820

      target function =      -0.747126884923
              le_mean =     -22.662114748536
             les_mean =     514.019243481509
             stat err =       0.000541938640
             autocorr =       1.335278078225
   target nu stat err =       0.000541938640
   target dn stat err =       0.002688076611
      target stat err =       0.002295012183
              std dev =       0.663253049506
             le_variance =       0.439904607679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439981886157
                                         uncertainty =       0.002248126154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439981886157
                                         uncertainty =       0.002248126154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468990760
  error estimate for blocks of size 2^( 2) =       0.000492986782
  error estimate for blocks of size 2^( 3) =       0.000515603495
  error estimate for blocks of size 2^( 4) =       0.000531580164
  error estimate for blocks of size 2^( 5) =       0.000542735904
  error estimate for blocks of size 2^( 6) =       0.000545923736
  error estimate for blocks of size 2^( 7) =       0.000547514843

      target function =      -0.747126864947
              le_mean =     -22.662114746924
             les_mean =     514.019243432619
             stat err =       0.000541938662
             autocorr =       1.335278009761
   target nu stat err =       0.000541938662
   target dn stat err =       0.002688083423
      target stat err =       0.002295017486
              std dev =       0.663253093272
             le_variance =       0.439904665735


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747126861599        initial
     5.4210e+02     5.4210e+03             8.3477e-07        -0.747126899981  <--
     2.1684e+03     2.1684e+04             2.0871e-07        -0.747126884923
     8.6736e+03     8.6736e+04             5.2177e-08        -0.747126864947

*****************************************************************************
Applying the update for shift_i =   5.4210e+02     and shift_s =   5.4210e+03
*****************************************************************************

  Execution time = 4.3007e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_001                -7.055854e-01 3 1  ON 0
ci_002                -7.029023e-01 3 1  ON 1
ci_003                -5.013021e-02 3 1  ON 2
ci_004                -5.100165e-02 3 1  ON 3
ci_005                 1.949514e-02 3 1  ON 4
ci_006                 1.981584e-02 3 1  ON 5
ci_007                 1.474562e-02 3 1  ON 6
ci_008                 1.553999e-02 3 1  ON 7
ci_009                -1.320057e-02 3 1  ON 8
ci_010                -1.207966e-02 3 1  ON 9
ci_011                -9.909570e-03 3 1  ON 10
ci_012                -9.098343e-03 3 1  ON 11
ci_013                 8.349366e-03 3 1  ON 12
ci_014                 9.368953e-03 3 1  ON 13
ci_015                 9.519091e-03 3 1  ON 14
ci_016                 9.412481e-03 3 1  ON 15
ci_017                 8.493689e-03 3 1  ON 16
ci_018                 8.286254e-03 3 1  ON 17
ci_019                -1.224506e-03 3 1  ON 18
ci_020                -1.537086e-03 3 1  ON 19
ci_021                -1.177730e-02 3 1  ON 20
ci_022                -1.179964e-02 3 1  ON 21
ci_023                 4.854176e-03 3 1  ON 22
ci_024                 4.919269e-03 3 1  ON 23
ci_025                 1.143695e-02 3 1  ON 24
ci_026                 1.147362e-02 3 1  ON 25
ci_027                 6.466875e-03 3 1  ON 26
ci_028                 6.188200e-03 3 1  ON 27
ci_029                -5.081568e-03 3 1  ON 28
ci_030                -4.169737e-03 3 1  ON 29
ci_031                 3.330197e-03 3 1  ON 30
ci_032                 4.543801e-03 3 1  ON 31
ci_033                 2.363557e-03 3 1  ON 32
ci_034                 4.135949e-03 3 1  ON 33
ci_035                 1.723603e-03 3 1  ON 34
ci_036                 2.153496e-03 3 1  ON 35
ci_037                 3.539002e-03 3 1  ON 36
ci_038                 3.699921e-03 3 1  ON 37
ci_039                 4.622171e-03 3 1  ON 38
ci_040                 4.935470e-03 3 1  ON 39
ci_041                 2.971156e-03 3 1  ON 40
ci_042                 2.733801e-03 3 1  ON 41
ci_043                 2.944557e-03 3 1  ON 42
ci_044                 3.188142e-03 3 1  ON 43
ci_045                 2.451750e-03 3 1  ON 44
ci_046                 2.721107e-03 3 1  ON 45
ci_047                -1.002160e-03 3 1  ON 46
ci_048                -8.336696e-04 3 1  ON 47
ci_049                 7.784948e-04 3 1  ON 48
ci_050                 9.957681e-04 3 1  ON 49
ci_051                -3.148341e-04 3 1  ON 50
ci_052                -1.209922e-03 3 1  ON 51
ci_053                -2.434319e-03 3 1  ON 52
ci_054                -2.689534e-03 3 1  ON 53
ci_055                -1.798620e-03 3 1  ON 54
ci_056                -1.928269e-03 3 1  ON 55
ci_057                -1.307117e-03 3 1  ON 56
ci_058                -9.883885e-04 3 1  ON 57
ci_059                -5.505113e-04 3 1  ON 58
ci_060                -7.597101e-04 3 1  ON 59
ci_061                -5.096185e-05 3 1  ON 60
ci_062                -9.205389e-04 3 1  ON 61
ci_063                -8.860996e-04 3 1  ON 62
ci_064                -5.239681e-04 3 1  ON 63
ci_065                -1.359579e-03 3 1  ON 64
ci_066                -1.883858e-03 3 1  ON 65
ci_067                -1.812746e-03 3 1  ON 66
ci_068                -1.556950e-03 3 1  ON 67
ci_069                -5.544023e-04 3 1  ON 68
ci_070                -4.261317e-04 3 1  ON 69
ci_071                -2.087535e-03 3 1  ON 70
ci_072                -2.000520e-03 3 1  ON 71
ci_073                 1.612645e-04 3 1  ON 72
ci_074                 1.975330e-04 3 1  ON 73
ci_075                 1.619171e-04 3 1  ON 74
ci_076                 7.851349e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3653e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.6409
    reference variance = 0.360549
====================================================
  Execution time = 2.5638e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4663e-01
  Total weights = 1.955312036e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438985028933
                                         uncertainty =       0.002189825040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438985028933
                                         uncertainty =       0.002189825040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468504211
  error estimate for blocks of size 2^( 2) =       0.000492483774
  error estimate for blocks of size 2^( 3) =       0.000514460331
  error estimate for blocks of size 2^( 4) =       0.000530173269
  error estimate for blocks of size 2^( 5) =       0.000538633227
  error estimate for blocks of size 2^( 6) =       0.000545402343
  error estimate for blocks of size 2^( 7) =       0.000548681450

      target function =      -0.748102145685
              le_mean =     -22.662567046514
             les_mean =     514.038570628250
             stat err =       0.000540722572
             autocorr =       1.332054524236
   target nu stat err =       0.000540722572
   target dn stat err =       0.002541712932
      target stat err =       0.002185326432
              std dev =       0.662565008597
             le_variance =       0.438992390617


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266256704651e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+02, overlap shift 1.3553e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748107588371       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748107736129       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748107783531       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748107792352       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748107797003       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748107801001       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748107801654       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748107802025       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748107802245       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748107802213       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748107802211       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+02 is 2.434900e-06

solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748107588371       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748107625322       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748107637174       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748107639379       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748107640542       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748107641542       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748107641705       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748107641797       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748107641852       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748107641844       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748107641844       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+02 is 6.087302e-07

solving harmonic davidson linear method for identity shift 2.1684e+03, overlap shift 2.1684e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748107588371       residual = 2.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748107597609       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748107600573       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748107601124       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748107601415       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748107601664       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748107601705       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748107601728       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748107601745       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748107601740       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748107601740       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+03 is 1.521829e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0379e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_001                -7.055848e-01 3 1  ON 0
ci_002                -7.029029e-01 3 1  ON 1
ci_003                -5.013026e-02 3 1  ON 2
ci_004                -5.100171e-02 3 1  ON 3
ci_005                 1.949499e-02 3 1  ON 4
ci_006                 1.981565e-02 3 1  ON 5
ci_007                 1.474543e-02 3 1  ON 6
ci_008                 1.553991e-02 3 1  ON 7
ci_009                -1.320047e-02 3 1  ON 8
ci_010                -1.207968e-02 3 1  ON 9
ci_011                -9.909365e-03 3 1  ON 10
ci_012                -9.098230e-03 3 1  ON 11
ci_013                 8.349445e-03 3 1  ON 12
ci_014                 9.368871e-03 3 1  ON 13
ci_015                 9.518942e-03 3 1  ON 14
ci_016                 9.412555e-03 3 1  ON 15
ci_017                 8.493680e-03 3 1  ON 16
ci_018                 8.286152e-03 3 1  ON 17
ci_019                -1.224779e-03 3 1  ON 18
ci_020                -1.537405e-03 3 1  ON 19
ci_021                -1.177742e-02 3 1  ON 20
ci_022                -1.179979e-02 3 1  ON 21
ci_023                 4.854138e-03 3 1  ON 22
ci_024                 4.919166e-03 3 1  ON 23
ci_025                 1.143716e-02 3 1  ON 24
ci_026                 1.147381e-02 3 1  ON 25
ci_027                 6.466901e-03 3 1  ON 26
ci_028                 6.188171e-03 3 1  ON 27
ci_029                -5.081360e-03 3 1  ON 28
ci_030                -4.169728e-03 3 1  ON 29
ci_031                 3.330383e-03 3 1  ON 30
ci_032                 4.543904e-03 3 1  ON 31
ci_033                 2.363599e-03 3 1  ON 32
ci_034                 4.135783e-03 3 1  ON 33
ci_035                 1.723375e-03 3 1  ON 34
ci_036                 2.153447e-03 3 1  ON 35
ci_037                 3.538989e-03 3 1  ON 36
ci_038                 3.699849e-03 3 1  ON 37
ci_039                 4.622193e-03 3 1  ON 38
ci_040                 4.935411e-03 3 1  ON 39
ci_041                 2.971264e-03 3 1  ON 40
ci_042                 2.733834e-03 3 1  ON 41
ci_043                 2.944527e-03 3 1  ON 42
ci_044                 3.188083e-03 3 1  ON 43
ci_045                 2.451835e-03 3 1  ON 44
ci_046                 2.721096e-03 3 1  ON 45
ci_047                -1.002196e-03 3 1  ON 46
ci_048                -8.336205e-04 3 1  ON 47
ci_049                 7.784238e-04 3 1  ON 48
ci_050                 9.957797e-04 3 1  ON 49
ci_051                -3.150075e-04 3 1  ON 50
ci_052                -1.209893e-03 3 1  ON 51
ci_053                -2.434410e-03 3 1  ON 52
ci_054                -2.689494e-03 3 1  ON 53
ci_055                -1.798449e-03 3 1  ON 54
ci_056                -1.927908e-03 3 1  ON 55
ci_057                -1.306973e-03 3 1  ON 56
ci_058                -9.883969e-04 3 1  ON 57
ci_059                -5.505642e-04 3 1  ON 58
ci_060                -7.596437e-04 3 1  ON 59
ci_061                -5.097696e-05 3 1  ON 60
ci_062                -9.204229e-04 3 1  ON 61
ci_063                -8.861176e-04 3 1  ON 62
ci_064                -5.238464e-04 3 1  ON 63
ci_065                -1.359658e-03 3 1  ON 64
ci_066                -1.883861e-03 3 1  ON 65
ci_067                -1.812742e-03 3 1  ON 66
ci_068                -1.557038e-03 3 1  ON 67
ci_069                -5.544191e-04 3 1  ON 68
ci_070                -4.261477e-04 3 1  ON 69
ci_071                -2.087366e-03 3 1  ON 70
ci_072                -2.000467e-03 3 1  ON 71
ci_073                 1.612794e-04 3 1  ON 72
ci_074                 1.974732e-04 3 1  ON 73
ci_075                 1.619907e-04 3 1  ON 74
ci_076                 7.851043e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.6505
    reference variance = 0.3036
====================================================
  Execution time = 2.5072e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5158e-01
  Total weights = 1.9551e+06
  Execution time = 3.6064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442943513723
                                         uncertainty =       0.002252736790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442943513723
                                         uncertainty =       0.002252736790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470604104
  error estimate for blocks of size 2^( 2) =       0.000494374948
  error estimate for blocks of size 2^( 3) =       0.000516323593
  error estimate for blocks of size 2^( 4) =       0.000532500789
  error estimate for blocks of size 2^( 5) =       0.000541602016
  error estimate for blocks of size 2^( 6) =       0.000545361841
  error estimate for blocks of size 2^( 7) =       0.000545827105

      target function =      -0.744014728325
              le_mean =     -22.661335608562
             les_mean =     513.987711235263
             stat err =       0.000541322938
             autocorr =       1.323126717650
   target nu stat err =       0.000541322938
   target dn stat err =       0.002937789404
      target stat err =       0.002471173864
              std dev =       0.665534706648
             le_variance =       0.442936445753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442943232448
                                         uncertainty =       0.002252747946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442943232448
                                         uncertainty =       0.002252747946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470603954
  error estimate for blocks of size 2^( 2) =       0.000494374838
  error estimate for blocks of size 2^( 3) =       0.000516323499
  error estimate for blocks of size 2^( 4) =       0.000532500729
  error estimate for blocks of size 2^( 5) =       0.000541601944
  error estimate for blocks of size 2^( 6) =       0.000545361782
  error estimate for blocks of size 2^( 7) =       0.000545827029

      target function =      -0.744015287162
              le_mean =     -22.661335616772
             les_mean =     513.987710922999
             stat err =       0.000541322871
             autocorr =       1.323127232804
   target nu stat err =       0.000541322871
   target dn stat err =       0.002937795847
      target stat err =       0.002471182588
              std dev =       0.665534494941
             le_variance =       0.442936163957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442943372993
                                         uncertainty =       0.002252742366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442943372993
                                         uncertainty =       0.002252742366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470604029
  error estimate for blocks of size 2^( 2) =       0.000494374893
  error estimate for blocks of size 2^( 3) =       0.000516323546
  error estimate for blocks of size 2^( 4) =       0.000532500759
  error estimate for blocks of size 2^( 5) =       0.000541601980
  error estimate for blocks of size 2^( 6) =       0.000545361811
  error estimate for blocks of size 2^( 7) =       0.000545827067

      target function =      -0.744015028728
              le_mean =     -22.661335612659
             les_mean =     513.987711053080
             stat err =       0.000541322904
             autocorr =       1.323126975336
   target nu stat err =       0.000541322904
   target dn stat err =       0.002937792540
      target stat err =       0.002471178293
              std dev =       0.665534600725
             le_variance =       0.442936304762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442943496126
                                         uncertainty =       0.002252737487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442943496126
                                         uncertainty =       0.002252737487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470604095
  error estimate for blocks of size 2^( 2) =       0.000494374941
  error estimate for blocks of size 2^( 3) =       0.000516323587
  error estimate for blocks of size 2^( 4) =       0.000532500785
  error estimate for blocks of size 2^( 5) =       0.000541602011
  error estimate for blocks of size 2^( 6) =       0.000545361837
  error estimate for blocks of size 2^( 7) =       0.000545827100

      target function =      -0.744014767886
              le_mean =     -22.661335609073
             les_mean =     513.987711209985
             stat err =       0.000541322933
             autocorr =       1.323126749869
   target nu stat err =       0.000541322933
   target dn stat err =       0.002937789788
      target stat err =       0.002471174424
              std dev =       0.665534693403
             le_variance =       0.442936428123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744014728325        initial
     1.3553e+02     1.3553e+03             2.4349e-06        -0.744015287162  <--
     5.4210e+02     5.4210e+03             6.0873e-07        -0.744015028728
     2.1684e+03     2.1684e+04             1.5218e-07        -0.744014767886

*****************************************************************************
Applying the update for shift_i =   1.3553e+02     and shift_s =   1.3553e+03
*****************************************************************************

  Execution time = 4.3162e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_001                -7.055830e-01 3 1  ON 0
ci_002                -7.029047e-01 3 1  ON 1
ci_003                -5.013042e-02 3 1  ON 2
ci_004                -5.100189e-02 3 1  ON 3
ci_005                 1.949456e-02 3 1  ON 4
ci_006                 1.981506e-02 3 1  ON 5
ci_007                 1.474484e-02 3 1  ON 6
ci_008                 1.553966e-02 3 1  ON 7
ci_009                -1.320017e-02 3 1  ON 8
ci_010                -1.207975e-02 3 1  ON 9
ci_011                -9.908753e-03 3 1  ON 10
ci_012                -9.097890e-03 3 1  ON 11
ci_013                 8.349683e-03 3 1  ON 12
ci_014                 9.368625e-03 3 1  ON 13
ci_015                 9.518495e-03 3 1  ON 14
ci_016                 9.412775e-03 3 1  ON 15
ci_017                 8.493652e-03 3 1  ON 16
ci_018                 8.285847e-03 3 1  ON 17
ci_019                -1.225597e-03 3 1  ON 18
ci_020                -1.538361e-03 3 1  ON 19
ci_021                -1.177779e-02 3 1  ON 20
ci_022                -1.180026e-02 3 1  ON 21
ci_023                 4.854024e-03 3 1  ON 22
ci_024                 4.918857e-03 3 1  ON 23
ci_025                 1.143776e-02 3 1  ON 24
ci_026                 1.147440e-02 3 1  ON 25
ci_027                 6.466980e-03 3 1  ON 26
ci_028                 6.188082e-03 3 1  ON 27
ci_029                -5.080735e-03 3 1  ON 28
ci_030                -4.169704e-03 3 1  ON 29
ci_031                 3.330942e-03 3 1  ON 30
ci_032                 4.544212e-03 3 1  ON 31
ci_033                 2.363725e-03 3 1  ON 32
ci_034                 4.135282e-03 3 1  ON 33
ci_035                 1.722691e-03 3 1  ON 34
ci_036                 2.153300e-03 3 1  ON 35
ci_037                 3.538951e-03 3 1  ON 36
ci_038                 3.699631e-03 3 1  ON 37
ci_039                 4.622259e-03 3 1  ON 38
ci_040                 4.935234e-03 3 1  ON 39
ci_041                 2.971588e-03 3 1  ON 40
ci_042                 2.733934e-03 3 1  ON 41
ci_043                 2.944438e-03 3 1  ON 42
ci_044                 3.187909e-03 3 1  ON 43
ci_045                 2.452090e-03 3 1  ON 44
ci_046                 2.721064e-03 3 1  ON 45
ci_047                -1.002303e-03 3 1  ON 46
ci_048                -8.334732e-04 3 1  ON 47
ci_049                 7.782105e-04 3 1  ON 48
ci_050                 9.958147e-04 3 1  ON 49
ci_051                -3.155276e-04 3 1  ON 50
ci_052                -1.209807e-03 3 1  ON 51
ci_053                -2.434682e-03 3 1  ON 52
ci_054                -2.689373e-03 3 1  ON 53
ci_055                -1.797937e-03 3 1  ON 54
ci_056                -1.926828e-03 3 1  ON 55
ci_057                -1.306543e-03 3 1  ON 56
ci_058                -9.884218e-04 3 1  ON 57
ci_059                -5.507230e-04 3 1  ON 58
ci_060                -7.594446e-04 3 1  ON 59
ci_061                -5.102226e-05 3 1  ON 60
ci_062                -9.200750e-04 3 1  ON 61
ci_063                -8.861714e-04 3 1  ON 62
ci_064                -5.234815e-04 3 1  ON 63
ci_065                -1.359892e-03 3 1  ON 64
ci_066                -1.883868e-03 3 1  ON 65
ci_067                -1.812731e-03 3 1  ON 66
ci_068                -1.557302e-03 3 1  ON 67
ci_069                -5.544696e-04 3 1  ON 68
ci_070                -4.261957e-04 3 1  ON 69
ci_071                -2.086861e-03 3 1  ON 70
ci_072                -2.000308e-03 3 1  ON 71
ci_073                 1.613244e-04 3 1  ON 72
ci_074                 1.972938e-04 3 1  ON 73
ci_075                 1.622113e-04 3 1  ON 74
ci_076                 7.850125e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.6616
    reference variance = 0.415565
====================================================
  Execution time = 2.7825e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4699e-01
  Total weights = 1.954869121e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438991961214
                                         uncertainty =       0.001868202924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438991961214
                                         uncertainty =       0.001868202924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468585051
  error estimate for blocks of size 2^( 2) =       0.000492860696
  error estimate for blocks of size 2^( 3) =       0.000514540521
  error estimate for blocks of size 2^( 4) =       0.000530892545
  error estimate for blocks of size 2^( 5) =       0.000539192602
  error estimate for blocks of size 2^( 6) =       0.000544097544
  error estimate for blocks of size 2^( 7) =       0.000548283105

      target function =      -0.747790847412
              le_mean =     -22.661980590215
             les_mean =     514.012358774891
             stat err =       0.000540616449
             autocorr =       1.331072322140
   target nu stat err =       0.000540616449
   target dn stat err =       0.002090270003
      target stat err =       0.001826009473
              std dev =       0.662679333841
             le_variance =       0.439143899500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266198059021e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+01, overlap shift 3.3881e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747794397348       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747794944561       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747795066229       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747795090242       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747795091372       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747795091165       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747795093136       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747795093401       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747795094284       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747795094075       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747795093807       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+01 is 6.269732e-06

solving harmonic davidson linear method for identity shift 1.3553e+02, overlap shift 1.3553e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747794397348       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747794534298       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747794564729       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747794570735       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747794571016       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747794570964       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747794571456       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747794571523       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747794571743       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747794571691       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747794571624       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+02 is 1.568765e-06

solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747794397348       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747794431595       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747794439204       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747794440705       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747794440775       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747794440762       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747794440885       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747794440903       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747794440957       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747794440944       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747794440928       residual = 9.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+02 is 3.922746e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2534e+01
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_001                -7.055838e-01 3 1  ON 0
ci_002                -7.029041e-01 3 1  ON 1
ci_003                -5.012939e-02 3 1  ON 2
ci_004                -5.100206e-02 3 1  ON 3
ci_005                 1.949406e-02 3 1  ON 4
ci_006                 1.981433e-02 3 1  ON 5
ci_007                 1.474457e-02 3 1  ON 6
ci_008                 1.553909e-02 3 1  ON 7
ci_009                -1.319967e-02 3 1  ON 8
ci_010                -1.207964e-02 3 1  ON 9
ci_011                -9.908404e-03 3 1  ON 10
ci_012                -9.097874e-03 3 1  ON 11
ci_013                 8.349649e-03 3 1  ON 12
ci_014                 9.367475e-03 3 1  ON 13
ci_015                 9.516927e-03 3 1  ON 14
ci_016                 9.411845e-03 3 1  ON 15
ci_017                 8.493634e-03 3 1  ON 16
ci_018                 8.286561e-03 3 1  ON 17
ci_019                -1.227026e-03 3 1  ON 18
ci_020                -1.539340e-03 3 1  ON 19
ci_021                -1.177872e-02 3 1  ON 20
ci_022                -1.180139e-02 3 1  ON 21
ci_023                 4.854103e-03 3 1  ON 22
ci_024                 4.919261e-03 3 1  ON 23
ci_025                 1.143863e-02 3 1  ON 24
ci_026                 1.147538e-02 3 1  ON 25
ci_027                 6.466637e-03 3 1  ON 26
ci_028                 6.188152e-03 3 1  ON 27
ci_029                -5.080313e-03 3 1  ON 28
ci_030                -4.169297e-03 3 1  ON 29
ci_031                 3.331584e-03 3 1  ON 30
ci_032                 4.544984e-03 3 1  ON 31
ci_033                 2.363676e-03 3 1  ON 32
ci_034                 4.134756e-03 3 1  ON 33
ci_035                 1.722445e-03 3 1  ON 34
ci_036                 2.152890e-03 3 1  ON 35
ci_037                 3.538686e-03 3 1  ON 36
ci_038                 3.699099e-03 3 1  ON 37
ci_039                 4.621503e-03 3 1  ON 38
ci_040                 4.935110e-03 3 1  ON 39
ci_041                 2.971738e-03 3 1  ON 40
ci_042                 2.733834e-03 3 1  ON 41
ci_043                 2.944381e-03 3 1  ON 42
ci_044                 3.187728e-03 3 1  ON 43
ci_045                 2.452669e-03 3 1  ON 44
ci_046                 2.721528e-03 3 1  ON 45
ci_047                -1.002471e-03 3 1  ON 46
ci_048                -8.336149e-04 3 1  ON 47
ci_049                 7.777347e-04 3 1  ON 48
ci_050                 9.958797e-04 3 1  ON 49
ci_051                -3.160351e-04 3 1  ON 50
ci_052                -1.209669e-03 3 1  ON 51
ci_053                -2.434251e-03 3 1  ON 52
ci_054                -2.689202e-03 3 1  ON 53
ci_055                -1.798155e-03 3 1  ON 54
ci_056                -1.926868e-03 3 1  ON 55
ci_057                -1.306165e-03 3 1  ON 56
ci_058                -9.886766e-04 3 1  ON 57
ci_059                -5.504732e-04 3 1  ON 58
ci_060                -7.593161e-04 3 1  ON 59
ci_061                -5.078161e-05 3 1  ON 60
ci_062                -9.198813e-04 3 1  ON 61
ci_063                -8.859133e-04 3 1  ON 62
ci_064                -5.236243e-04 3 1  ON 63
ci_065                -1.359881e-03 3 1  ON 64
ci_066                -1.883961e-03 3 1  ON 65
ci_067                -1.812100e-03 3 1  ON 66
ci_068                -1.557561e-03 3 1  ON 67
ci_069                -5.547838e-04 3 1  ON 68
ci_070                -4.263078e-04 3 1  ON 69
ci_071                -2.086550e-03 3 1  ON 70
ci_072                -2.000478e-03 3 1  ON 71
ci_073                 1.610613e-04 3 1  ON 72
ci_074                 1.973396e-04 3 1  ON 73
ci_075                 1.621152e-04 3 1  ON 74
ci_076                 7.849148e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.652
    reference variance = 0.405434
====================================================
  Execution time = 2.5034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4727e-01
  Total weights = 1.9553e+06
  Execution time = 3.6137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438257229238
                                         uncertainty =       0.001887201988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438257229238
                                         uncertainty =       0.001887201988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468056944
  error estimate for blocks of size 2^( 2) =       0.000492154204
  error estimate for blocks of size 2^( 3) =       0.000514246061
  error estimate for blocks of size 2^( 4) =       0.000530112798
  error estimate for blocks of size 2^( 5) =       0.000539773334
  error estimate for blocks of size 2^( 6) =       0.000543806134
  error estimate for blocks of size 2^( 7) =       0.000548117923

      target function =      -0.747566296307
              le_mean =     -22.662361441404
             les_mean =     514.029896970795
             stat err =       0.000540452547
             autocorr =       1.333268905407
   target nu stat err =       0.000540452547
   target dn stat err =       0.002510708541
      target stat err =       0.002156960855
              std dev =       0.661932478145
             le_variance =       0.438154605624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438255249003
                                         uncertainty =       0.001887056153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438255249003
                                         uncertainty =       0.001887056153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468055889
  error estimate for blocks of size 2^( 2) =       0.000492153297
  error estimate for blocks of size 2^( 3) =       0.000514245280
  error estimate for blocks of size 2^( 4) =       0.000530112054
  error estimate for blocks of size 2^( 5) =       0.000539772592
  error estimate for blocks of size 2^( 6) =       0.000543805539
  error estimate for blocks of size 2^( 7) =       0.000548117151

      target function =      -0.747576188214
              le_mean =     -22.662361507715
             les_mean =     514.029887998273
             stat err =       0.000540451834
             autocorr =       1.333271396504
   target nu stat err =       0.000540451834
   target dn stat err =       0.002510170531
      target stat err =       0.002156588913
              std dev =       0.661930986266
             le_variance =       0.438152630579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438256237540
                                         uncertainty =       0.001887128971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438256237540
                                         uncertainty =       0.001887128971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468056416
  error estimate for blocks of size 2^( 2) =       0.000492153750
  error estimate for blocks of size 2^( 3) =       0.000514245670
  error estimate for blocks of size 2^( 4) =       0.000530112425
  error estimate for blocks of size 2^( 5) =       0.000539772962
  error estimate for blocks of size 2^( 6) =       0.000543805836
  error estimate for blocks of size 2^( 7) =       0.000548117536

      target function =      -0.747571402471
              le_mean =     -22.662361474445
             les_mean =     514.029892285293
             stat err =       0.000540452190
             autocorr =       1.333270153453
   target nu stat err =       0.000540452190
   target dn stat err =       0.002510429027
      target stat err =       0.002156767438
              std dev =       0.661931731014
             le_variance =       0.438153616523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438257105166
                                         uncertainty =       0.001887192855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438257105166
                                         uncertainty =       0.001887192855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468056878
  error estimate for blocks of size 2^( 2) =       0.000492154147
  error estimate for blocks of size 2^( 3) =       0.000514246012
  error estimate for blocks of size 2^( 4) =       0.000530112752
  error estimate for blocks of size 2^( 5) =       0.000539773287
  error estimate for blocks of size 2^( 6) =       0.000543806097
  error estimate for blocks of size 2^( 7) =       0.000548117874

      target function =      -0.747566952579
              le_mean =     -22.662361445519
             les_mean =     514.029896362612
             stat err =       0.000540452502
             autocorr =       1.333269061591
   target nu stat err =       0.000540452502
   target dn stat err =       0.002510672371
      target stat err =       0.002156935802
              std dev =       0.661932384671
             le_variance =       0.438154481877


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747566296307        initial
     3.3881e+01     3.3881e+02             6.2697e-06        -0.747576188214  <--
     1.3553e+02     1.3553e+03             1.5688e-06        -0.747571402471
     5.4210e+02     5.4210e+03             3.9227e-07        -0.747566952579

*****************************************************************************
Applying the update for shift_i =   3.3881e+01     and shift_s =   3.3881e+02
*****************************************************************************

  Execution time = 4.6282e+01
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_001                -7.055862e-01 3 1  ON 0
ci_002                -7.029020e-01 3 1  ON 1
ci_003                -5.012629e-02 3 1  ON 2
ci_004                -5.100259e-02 3 1  ON 3
ci_005                 1.949258e-02 3 1  ON 4
ci_006                 1.981217e-02 3 1  ON 5
ci_007                 1.474375e-02 3 1  ON 6
ci_008                 1.553738e-02 3 1  ON 7
ci_009                -1.319816e-02 3 1  ON 8
ci_010                -1.207932e-02 3 1  ON 9
ci_011                -9.907359e-03 3 1  ON 10
ci_012                -9.097823e-03 3 1  ON 11
ci_013                 8.349546e-03 3 1  ON 12
ci_014                 9.364030e-03 3 1  ON 13
ci_015                 9.512226e-03 3 1  ON 14
ci_016                 9.409056e-03 3 1  ON 15
ci_017                 8.493581e-03 3 1  ON 16
ci_018                 8.288700e-03 3 1  ON 17
ci_019                -1.231310e-03 3 1  ON 18
ci_020                -1.542275e-03 3 1  ON 19
ci_021                -1.178150e-02 3 1  ON 20
ci_022                -1.180476e-02 3 1  ON 21
ci_023                 4.854337e-03 3 1  ON 22
ci_024                 4.920473e-03 3 1  ON 23
ci_025                 1.144123e-02 3 1  ON 24
ci_026                 1.147832e-02 3 1  ON 25
ci_027                 6.465607e-03 3 1  ON 26
ci_028                 6.188359e-03 3 1  ON 27
ci_029                -5.079046e-03 3 1  ON 28
ci_030                -4.168077e-03 3 1  ON 29
ci_031                 3.333510e-03 3 1  ON 30
ci_032                 4.547298e-03 3 1  ON 31
ci_033                 2.363527e-03 3 1  ON 32
ci_034                 4.133177e-03 3 1  ON 33
ci_035                 1.721708e-03 3 1  ON 34
ci_036                 2.151663e-03 3 1  ON 35
ci_037                 3.537892e-03 3 1  ON 36
ci_038                 3.697507e-03 3 1  ON 37
ci_039                 4.619239e-03 3 1  ON 38
ci_040                 4.934738e-03 3 1  ON 39
ci_041                 2.972186e-03 3 1  ON 40
ci_042                 2.733533e-03 3 1  ON 41
ci_043                 2.944210e-03 3 1  ON 42
ci_044                 3.187187e-03 3 1  ON 43
ci_045                 2.454406e-03 3 1  ON 44
ci_046                 2.722919e-03 3 1  ON 45
ci_047                -1.002976e-03 3 1  ON 46
ci_048                -8.340393e-04 3 1  ON 47
ci_049                 7.763093e-04 3 1  ON 48
ci_050                 9.960742e-04 3 1  ON 49
ci_051                -3.175560e-04 3 1  ON 50
ci_052                -1.209256e-03 3 1  ON 51
ci_053                -2.432960e-03 3 1  ON 52
ci_054                -2.688687e-03 3 1  ON 53
ci_055                -1.798808e-03 3 1  ON 54
ci_056                -1.926990e-03 3 1  ON 55
ci_057                -1.305031e-03 3 1  ON 56
ci_058                -9.894400e-04 3 1  ON 57
ci_059                -5.497250e-04 3 1  ON 58
ci_060                -7.589313e-04 3 1  ON 59
ci_061                -5.006063e-05 3 1  ON 60
ci_062                -9.193007e-04 3 1  ON 61
ci_063                -8.851401e-04 3 1  ON 62
ci_064                -5.240526e-04 3 1  ON 63
ci_065                -1.359848e-03 3 1  ON 64
ci_066                -1.884242e-03 3 1  ON 65
ci_067                -1.810207e-03 3 1  ON 66
ci_068                -1.558340e-03 3 1  ON 67
ci_069                -5.557252e-04 3 1  ON 68
ci_070                -4.266437e-04 3 1  ON 69
ci_071                -2.085617e-03 3 1  ON 70
ci_072                -2.000985e-03 3 1  ON 71
ci_073                 1.602732e-04 3 1  ON 72
ci_074                 1.974767e-04 3 1  ON 73
ci_075                 1.618271e-04 3 1  ON 74
ci_076                 7.846221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.7166
    reference variance = 0.504218
====================================================
  Execution time = 2.5776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4899e-01
  Total weights = 1.955112845e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440243711430
                                         uncertainty =       0.001883702772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440243711430
                                         uncertainty =       0.001883702772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469143164
  error estimate for blocks of size 2^( 2) =       0.000493067219
  error estimate for blocks of size 2^( 3) =       0.000514613182
  error estimate for blocks of size 2^( 4) =       0.000531188068
  error estimate for blocks of size 2^( 5) =       0.000541149797
  error estimate for blocks of size 2^( 6) =       0.000547116256
  error estimate for blocks of size 2^( 7) =       0.000552813191

      target function =      -0.746138773709
              le_mean =     -22.661530559228
             les_mean =     513.993957737116
             stat err =       0.000543066828
             autocorr =       1.339972131030
   target nu stat err =       0.000543066828
   target dn stat err =       0.002645650789
      target stat err =       0.002253883315
              std dev =       0.663468625709
             le_variance =       0.440190617301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266153055923e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+00, overlap shift 8.4703e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746144672979       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746146432798       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746146711470       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746146765136       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746146800341       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746146816972       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746146826499       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746146834043       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746146835086       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746146835819       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746146836910       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+00 is 3.885073e-05

solving harmonic davidson linear method for identity shift 3.3881e+01, overlap shift 3.3881e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746144672979       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746145114698       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746145184497       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746145197928       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746145206719       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746145210841       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746145213203       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746145215078       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746145215337       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746145215520       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746145215791       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+01 is 9.713692e-06

solving harmonic davidson linear method for identity shift 1.3553e+02, overlap shift 1.3553e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746144672979       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746144783519       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746144800977       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746144804336       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746144806533       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746144807561       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746144808150       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746144808619       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746144808683       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746144808729       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746144808797       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+02 is 2.428486e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284735 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0468e+01
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_001                -7.055959e-01 3 1  ON 0
ci_002                -7.028928e-01 3 1  ON 1
ci_003                -5.012639e-02 3 1  ON 2
ci_004                -5.100091e-02 3 1  ON 3
ci_005                 1.949138e-02 3 1  ON 4
ci_006                 1.981002e-02 3 1  ON 5
ci_007                 1.474321e-02 3 1  ON 6
ci_008                 1.553486e-02 3 1  ON 7
ci_009                -1.319601e-02 3 1  ON 8
ci_010                -1.207727e-02 3 1  ON 9
ci_011                -9.905239e-03 3 1  ON 10
ci_012                -9.093980e-03 3 1  ON 11
ci_013                 8.350443e-03 3 1  ON 12
ci_014                 9.360840e-03 3 1  ON 13
ci_015                 9.505999e-03 3 1  ON 14
ci_016                 9.407939e-03 3 1  ON 15
ci_017                 8.490133e-03 3 1  ON 16
ci_018                 8.287024e-03 3 1  ON 17
ci_019                -1.236491e-03 3 1  ON 18
ci_020                -1.546643e-03 3 1  ON 19
ci_021                -1.178199e-02 3 1  ON 20
ci_022                -1.180428e-02 3 1  ON 21
ci_023                 4.855457e-03 3 1  ON 22
ci_024                 4.919411e-03 3 1  ON 23
ci_025                 1.144473e-02 3 1  ON 24
ci_026                 1.148177e-02 3 1  ON 25
ci_027                 6.464588e-03 3 1  ON 26
ci_028                 6.188721e-03 3 1  ON 27
ci_029                -5.077658e-03 3 1  ON 28
ci_030                -4.166611e-03 3 1  ON 29
ci_031                 3.336238e-03 3 1  ON 30
ci_032                 4.549489e-03 3 1  ON 31
ci_033                 2.363293e-03 3 1  ON 32
ci_034                 4.130831e-03 3 1  ON 33
ci_035                 1.722579e-03 3 1  ON 34
ci_036                 2.151522e-03 3 1  ON 35
ci_037                 3.537291e-03 3 1  ON 36
ci_038                 3.697525e-03 3 1  ON 37
ci_039                 4.618748e-03 3 1  ON 38
ci_040                 4.934332e-03 3 1  ON 39
ci_041                 2.972228e-03 3 1  ON 40
ci_042                 2.733980e-03 3 1  ON 41
ci_043                 2.942486e-03 3 1  ON 42
ci_044                 3.186187e-03 3 1  ON 43
ci_045                 2.454352e-03 3 1  ON 44
ci_046                 2.722459e-03 3 1  ON 45
ci_047                -1.002210e-03 3 1  ON 46
ci_048                -8.346730e-04 3 1  ON 47
ci_049                 7.767902e-04 3 1  ON 48
ci_050                 9.966257e-04 3 1  ON 49
ci_051                -3.187665e-04 3 1  ON 50
ci_052                -1.208608e-03 3 1  ON 51
ci_053                -2.431453e-03 3 1  ON 52
ci_054                -2.690841e-03 3 1  ON 53
ci_055                -1.799601e-03 3 1  ON 54
ci_056                -1.927430e-03 3 1  ON 55
ci_057                -1.304838e-03 3 1  ON 56
ci_058                -9.896756e-04 3 1  ON 57
ci_059                -5.489619e-04 3 1  ON 58
ci_060                -7.584496e-04 3 1  ON 59
ci_061                -5.264469e-05 3 1  ON 60
ci_062                -9.203958e-04 3 1  ON 61
ci_063                -8.869472e-04 3 1  ON 62
ci_064                -5.260203e-04 3 1  ON 63
ci_065                -1.360397e-03 3 1  ON 64
ci_066                -1.884354e-03 3 1  ON 65
ci_067                -1.808519e-03 3 1  ON 66
ci_068                -1.558071e-03 3 1  ON 67
ci_069                -5.535697e-04 3 1  ON 68
ci_070                -4.265096e-04 3 1  ON 69
ci_071                -2.085421e-03 3 1  ON 70
ci_072                -2.000516e-03 3 1  ON 71
ci_073                 1.605152e-04 3 1  ON 72
ci_074                 1.971946e-04 3 1  ON 73
ci_075                 1.615332e-04 3 1  ON 74
ci_076                 7.848959e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.6749
    reference variance = 0.449969
====================================================
  Execution time = 2.5274e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5143e-01
  Total weights = 1.9556e+06
  Execution time = 3.6110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442066124684
                                         uncertainty =       0.002213606356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442066124684
                                         uncertainty =       0.002213606356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470102651
  error estimate for blocks of size 2^( 2) =       0.000493450836
  error estimate for blocks of size 2^( 3) =       0.000515537120
  error estimate for blocks of size 2^( 4) =       0.000530762490
  error estimate for blocks of size 2^( 5) =       0.000540003652
  error estimate for blocks of size 2^( 6) =       0.000542961390
  error estimate for blocks of size 2^( 7) =       0.000548548252

      target function =      -0.744154189695
              le_mean =     -22.662232814973
             les_mean =     514.028216756574
             stat err =       0.000540568946
             autocorr =       1.322259773561
   target nu stat err =       0.000540568946
   target dn stat err =       0.002695543902
      target stat err =       0.002283304473
              std dev =       0.664825544721
             le_variance =       0.441993004914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442060353111
                                         uncertainty =       0.002213417962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442060353111
                                         uncertainty =       0.002213417962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470099589
  error estimate for blocks of size 2^( 2) =       0.000493448390
  error estimate for blocks of size 2^( 3) =       0.000515535059
  error estimate for blocks of size 2^( 4) =       0.000530760769
  error estimate for blocks of size 2^( 5) =       0.000540001738
  error estimate for blocks of size 2^( 6) =       0.000542958839
  error estimate for blocks of size 2^( 7) =       0.000548545892

      target function =      -0.744122886957
              le_mean =     -22.662232677739
             les_mean =     514.028248810952
             stat err =       0.000540566809
             autocorr =       1.322266545638
   target nu stat err =       0.000540566809
   target dn stat err =       0.002695424025
      target stat err =       0.002283023149
              std dev =       0.664821214699
             le_variance =       0.441987247514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442063217895
                                         uncertainty =       0.002213511560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442063217895
                                         uncertainty =       0.002213511560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470101109
  error estimate for blocks of size 2^( 2) =       0.000493449603
  error estimate for blocks of size 2^( 3) =       0.000515536080
  error estimate for blocks of size 2^( 4) =       0.000530761621
  error estimate for blocks of size 2^( 5) =       0.000540002686
  error estimate for blocks of size 2^( 6) =       0.000542960107
  error estimate for blocks of size 2^( 7) =       0.000548547070

      target function =      -0.744144018633
              le_mean =     -22.662232745497
             les_mean =     514.028226044775
             stat err =       0.000540567871
             autocorr =       1.322263189200
   target nu stat err =       0.000540567871
   target dn stat err =       0.002695273214
      target stat err =       0.002283029865
              std dev =       0.664823363943
             le_variance =       0.441990105244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442065759734
                                         uncertainty =       0.002213594448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442065759734
                                         uncertainty =       0.002213594448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470102457
  error estimate for blocks of size 2^( 2) =       0.000493450681
  error estimate for blocks of size 2^( 3) =       0.000515536989
  error estimate for blocks of size 2^( 4) =       0.000530762381
  error estimate for blocks of size 2^( 5) =       0.000540003530
  error estimate for blocks of size 2^( 6) =       0.000542961229
  error estimate for blocks of size 2^( 7) =       0.000548548104

      target function =      -0.744153285166
              le_mean =     -22.662232806185
             les_mean =     514.028217464404
             stat err =       0.000540568811
             autocorr =       1.322260202224
   target nu stat err =       0.000540568811
   target dn stat err =       0.002695499591
      target stat err =       0.002283264049
              std dev =       0.664825270922
             le_variance =       0.441992640856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744154189695        initial  <--
     8.4703e+00     8.4703e+01             3.8851e-05        -0.744122886957
     3.3881e+01     3.3881e+02             9.7137e-06        -0.744144018633
     1.3553e+02     1.3553e+03             2.4285e-06        -0.744153285166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.3926
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_001                -7.055862e-01 3 1  ON 0
ci_002                -7.029020e-01 3 1  ON 1
ci_003                -5.012629e-02 3 1  ON 2
ci_004                -5.100259e-02 3 1  ON 3
ci_005                 1.949258e-02 3 1  ON 4
ci_006                 1.981217e-02 3 1  ON 5
ci_007                 1.474375e-02 3 1  ON 6
ci_008                 1.553738e-02 3 1  ON 7
ci_009                -1.319816e-02 3 1  ON 8
ci_010                -1.207932e-02 3 1  ON 9
ci_011                -9.907359e-03 3 1  ON 10
ci_012                -9.097823e-03 3 1  ON 11
ci_013                 8.349546e-03 3 1  ON 12
ci_014                 9.364030e-03 3 1  ON 13
ci_015                 9.512226e-03 3 1  ON 14
ci_016                 9.409056e-03 3 1  ON 15
ci_017                 8.493581e-03 3 1  ON 16
ci_018                 8.288700e-03 3 1  ON 17
ci_019                -1.231310e-03 3 1  ON 18
ci_020                -1.542275e-03 3 1  ON 19
ci_021                -1.178150e-02 3 1  ON 20
ci_022                -1.180476e-02 3 1  ON 21
ci_023                 4.854337e-03 3 1  ON 22
ci_024                 4.920473e-03 3 1  ON 23
ci_025                 1.144123e-02 3 1  ON 24
ci_026                 1.147832e-02 3 1  ON 25
ci_027                 6.465607e-03 3 1  ON 26
ci_028                 6.188359e-03 3 1  ON 27
ci_029                -5.079046e-03 3 1  ON 28
ci_030                -4.168077e-03 3 1  ON 29
ci_031                 3.333510e-03 3 1  ON 30
ci_032                 4.547298e-03 3 1  ON 31
ci_033                 2.363527e-03 3 1  ON 32
ci_034                 4.133177e-03 3 1  ON 33
ci_035                 1.721708e-03 3 1  ON 34
ci_036                 2.151663e-03 3 1  ON 35
ci_037                 3.537892e-03 3 1  ON 36
ci_038                 3.697507e-03 3 1  ON 37
ci_039                 4.619239e-03 3 1  ON 38
ci_040                 4.934738e-03 3 1  ON 39
ci_041                 2.972186e-03 3 1  ON 40
ci_042                 2.733533e-03 3 1  ON 41
ci_043                 2.944210e-03 3 1  ON 42
ci_044                 3.187187e-03 3 1  ON 43
ci_045                 2.454406e-03 3 1  ON 44
ci_046                 2.722919e-03 3 1  ON 45
ci_047                -1.002976e-03 3 1  ON 46
ci_048                -8.340393e-04 3 1  ON 47
ci_049                 7.763093e-04 3 1  ON 48
ci_050                 9.960742e-04 3 1  ON 49
ci_051                -3.175560e-04 3 1  ON 50
ci_052                -1.209256e-03 3 1  ON 51
ci_053                -2.432960e-03 3 1  ON 52
ci_054                -2.688687e-03 3 1  ON 53
ci_055                -1.798808e-03 3 1  ON 54
ci_056                -1.926990e-03 3 1  ON 55
ci_057                -1.305031e-03 3 1  ON 56
ci_058                -9.894400e-04 3 1  ON 57
ci_059                -5.497250e-04 3 1  ON 58
ci_060                -7.589313e-04 3 1  ON 59
ci_061                -5.006063e-05 3 1  ON 60
ci_062                -9.193007e-04 3 1  ON 61
ci_063                -8.851401e-04 3 1  ON 62
ci_064                -5.240526e-04 3 1  ON 63
ci_065                -1.359848e-03 3 1  ON 64
ci_066                -1.884242e-03 3 1  ON 65
ci_067                -1.810207e-03 3 1  ON 66
ci_068                -1.558340e-03 3 1  ON 67
ci_069                -5.557252e-04 3 1  ON 68
ci_070                -4.266437e-04 3 1  ON 69
ci_071                -2.085617e-03 3 1  ON 70
ci_072                -2.000985e-03 3 1  ON 71
ci_073                 1.602732e-04 3 1  ON 72
ci_074                 1.974767e-04 3 1  ON 73
ci_075                 1.618271e-04 3 1  ON 74
ci_076                 7.846221e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3872e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.6088
    reference variance = 0.422918
====================================================
  Execution time = 2.5662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4911e-01
  Total weights = 1.955155177e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439554130721
                                         uncertainty =       0.002097711744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439554130721
                                         uncertainty =       0.002097711744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468767280
  error estimate for blocks of size 2^( 2) =       0.000492877457
  error estimate for blocks of size 2^( 3) =       0.000515116917
  error estimate for blocks of size 2^( 4) =       0.000530588008
  error estimate for blocks of size 2^( 5) =       0.000539643162
  error estimate for blocks of size 2^( 6) =       0.000546436391
  error estimate for blocks of size 2^( 7) =       0.000552375757

      target function =      -0.746051444598
              le_mean =     -22.662786640639
             les_mean =     514.051011712379
             stat err =       0.000542260829
             autocorr =       1.338141028775
   target nu stat err =       0.000542260829
   target dn stat err =       0.002793005541
      target stat err =       0.002374444543
              std dev =       0.662937045089
             le_variance =       0.439485525751


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266278664064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+01, overlap shift 8.4703e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746058054441       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746058356011       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746058411230       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746058418371       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746058420094       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746058420266       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746058420271       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746058420265       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746058420299       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+01 is 4.340484e-06

solving harmonic davidson linear method for identity shift 3.3881e+02, overlap shift 3.3881e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746058054441       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746058129866       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746058143674       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746058145459       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746058145890       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746058145933       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746058145934       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746058145932       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746058145941       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+02 is 1.085500e-06

solving harmonic davidson linear method for identity shift 1.3553e+03, overlap shift 1.3553e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746058054441       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746058073299       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746058076751       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746058077197       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746058077306       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746058077315       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746058077311       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746058077316       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746058077318       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+03 is 2.713987e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287874 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0387e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_001                -7.055863e-01 3 1  ON 0
ci_002                -7.029020e-01 3 1  ON 1
ci_003                -5.012598e-02 3 1  ON 2
ci_004                -5.100266e-02 3 1  ON 3
ci_005                 1.949204e-02 3 1  ON 4
ci_006                 1.981192e-02 3 1  ON 5
ci_007                 1.474345e-02 3 1  ON 6
ci_008                 1.553725e-02 3 1  ON 7
ci_009                -1.319809e-02 3 1  ON 8
ci_010                -1.207893e-02 3 1  ON 9
ci_011                -9.907317e-03 3 1  ON 10
ci_012                -9.097717e-03 3 1  ON 11
ci_013                 8.349655e-03 3 1  ON 12
ci_014                 9.363685e-03 3 1  ON 13
ci_015                 9.511953e-03 3 1  ON 14
ci_016                 9.409160e-03 3 1  ON 15
ci_017                 8.492853e-03 3 1  ON 16
ci_018                 8.288613e-03 3 1  ON 17
ci_019                -1.232396e-03 3 1  ON 18
ci_020                -1.542610e-03 3 1  ON 19
ci_021                -1.178161e-02 3 1  ON 20
ci_022                -1.180509e-02 3 1  ON 21
ci_023                 4.854380e-03 3 1  ON 22
ci_024                 4.920489e-03 3 1  ON 23
ci_025                 1.144164e-02 3 1  ON 24
ci_026                 1.147863e-02 3 1  ON 25
ci_027                 6.465598e-03 3 1  ON 26
ci_028                 6.188343e-03 3 1  ON 27
ci_029                -5.079154e-03 3 1  ON 28
ci_030                -4.167934e-03 3 1  ON 29
ci_031                 3.333790e-03 3 1  ON 30
ci_032                 4.547445e-03 3 1  ON 31
ci_033                 2.363635e-03 3 1  ON 32
ci_034                 4.133058e-03 3 1  ON 33
ci_035                 1.721585e-03 3 1  ON 34
ci_036                 2.151589e-03 3 1  ON 35
ci_037                 3.537941e-03 3 1  ON 36
ci_038                 3.697327e-03 3 1  ON 37
ci_039                 4.619134e-03 3 1  ON 38
ci_040                 4.934590e-03 3 1  ON 39
ci_041                 2.972269e-03 3 1  ON 40
ci_042                 2.733605e-03 3 1  ON 41
ci_043                 2.944273e-03 3 1  ON 42
ci_044                 3.187253e-03 3 1  ON 43
ci_045                 2.454581e-03 3 1  ON 44
ci_046                 2.722725e-03 3 1  ON 45
ci_047                -1.002717e-03 3 1  ON 46
ci_048                -8.341282e-04 3 1  ON 47
ci_049                 7.763515e-04 3 1  ON 48
ci_050                 9.959902e-04 3 1  ON 49
ci_051                -3.175105e-04 3 1  ON 50
ci_052                -1.209280e-03 3 1  ON 51
ci_053                -2.433069e-03 3 1  ON 52
ci_054                -2.688574e-03 3 1  ON 53
ci_055                -1.798830e-03 3 1  ON 54
ci_056                -1.927022e-03 3 1  ON 55
ci_057                -1.305105e-03 3 1  ON 56
ci_058                -9.894790e-04 3 1  ON 57
ci_059                -5.496552e-04 3 1  ON 58
ci_060                -7.588751e-04 3 1  ON 59
ci_061                -4.996211e-05 3 1  ON 60
ci_062                -9.192627e-04 3 1  ON 61
ci_063                -8.851672e-04 3 1  ON 62
ci_064                -5.239828e-04 3 1  ON 63
ci_065                -1.359855e-03 3 1  ON 64
ci_066                -1.884182e-03 3 1  ON 65
ci_067                -1.810131e-03 3 1  ON 66
ci_068                -1.558437e-03 3 1  ON 67
ci_069                -5.556418e-04 3 1  ON 68
ci_070                -4.264097e-04 3 1  ON 69
ci_071                -2.085641e-03 3 1  ON 70
ci_072                -2.000846e-03 3 1  ON 71
ci_073                 1.601781e-04 3 1  ON 72
ci_074                 1.975622e-04 3 1  ON 73
ci_075                 1.620535e-04 3 1  ON 74
ci_076                 7.845944e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.6903
    reference variance = 0.910944
====================================================
  Execution time = 2.5338e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4851e-01
  Total weights = 1.9552e+06
  Execution time = 3.6177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440315436854
                                         uncertainty =       0.002203815671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440315436854
                                         uncertainty =       0.002203815671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469180040
  error estimate for blocks of size 2^( 2) =       0.000493427814
  error estimate for blocks of size 2^( 3) =       0.000515494971
  error estimate for blocks of size 2^( 4) =       0.000530906780
  error estimate for blocks of size 2^( 5) =       0.000540799027
  error estimate for blocks of size 2^( 6) =       0.000546921565
  error estimate for blocks of size 2^( 7) =       0.000549621388

      target function =      -0.746544387470
              le_mean =     -22.662430488943
             les_mean =     514.034267232119
             stat err =       0.000542062190
             autocorr =       1.334809149862
   target nu stat err =       0.000542062190
   target dn stat err =       0.002474227755
      target stat err =       0.002123165948
              std dev =       0.663520775628
             le_variance =       0.440259819690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440314667847
                                         uncertainty =       0.002203788904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440314667847
                                         uncertainty =       0.002203788904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469179631
  error estimate for blocks of size 2^( 2) =       0.000493427478
  error estimate for blocks of size 2^( 3) =       0.000515494692
  error estimate for blocks of size 2^( 4) =       0.000530906493
  error estimate for blocks of size 2^( 5) =       0.000540798671
  error estimate for blocks of size 2^( 6) =       0.000546921216
  error estimate for blocks of size 2^( 7) =       0.000549621113

      target function =      -0.746546371352
              le_mean =     -22.662430453373
             les_mean =     514.034263210649
             stat err =       0.000542061873
             autocorr =       1.334809914100
   target nu stat err =       0.000542061873
   target dn stat err =       0.002474099671
      target stat err =       0.002123075377
              std dev =       0.663520197902
             le_variance =       0.440259053024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440315052073
                                         uncertainty =       0.002203802278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440315052073
                                         uncertainty =       0.002203802278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469179836
  error estimate for blocks of size 2^( 2) =       0.000493427646
  error estimate for blocks of size 2^( 3) =       0.000515494831
  error estimate for blocks of size 2^( 4) =       0.000530906637
  error estimate for blocks of size 2^( 5) =       0.000540798849
  error estimate for blocks of size 2^( 6) =       0.000546921390
  error estimate for blocks of size 2^( 7) =       0.000549621250

      target function =      -0.746545402984
              le_mean =     -22.662430471130
             les_mean =     514.034265191477
             stat err =       0.000542062031
             autocorr =       1.334809532178
   target nu stat err =       0.000542062031
   target dn stat err =       0.002474163689
      target stat err =       0.002123120772
              std dev =       0.663520486556
             le_variance =       0.440259436080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440315388737
                                         uncertainty =       0.002203813996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440315388737
                                         uncertainty =       0.002203813996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469180014
  error estimate for blocks of size 2^( 2) =       0.000493427793
  error estimate for blocks of size 2^( 3) =       0.000515494953
  error estimate for blocks of size 2^( 4) =       0.000530906762
  error estimate for blocks of size 2^( 5) =       0.000540799005
  error estimate for blocks of size 2^( 6) =       0.000546921543
  error estimate for blocks of size 2^( 7) =       0.000549621371

      target function =      -0.746544368468
              le_mean =     -22.662430486713
             les_mean =     514.034267154118
             stat err =       0.000542062170
             autocorr =       1.334809197646
   target nu stat err =       0.000542062170
   target dn stat err =       0.002474219489
      target stat err =       0.002123159299
              std dev =       0.663520739479
             le_variance =       0.440259771719


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746544387470        initial
     8.4703e+01     8.4703e+02             4.3405e-06        -0.746546371352  <--
     3.3881e+02     3.3881e+03             1.0855e-06        -0.746545402984
     1.3553e+03     1.3553e+04             2.7140e-07        -0.746544368468

*****************************************************************************
Applying the update for shift_i =   8.4703e+01     and shift_s =   8.4703e+02
*****************************************************************************

  Execution time = 4.3448e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_001                -7.055864e-01 3 1  ON 0
ci_002                -7.029020e-01 3 1  ON 1
ci_003                -5.012507e-02 3 1  ON 2
ci_004                -5.100289e-02 3 1  ON 3
ci_005                 1.949045e-02 3 1  ON 4
ci_006                 1.981120e-02 3 1  ON 5
ci_007                 1.474255e-02 3 1  ON 6
ci_008                 1.553687e-02 3 1  ON 7
ci_009                -1.319790e-02 3 1  ON 8
ci_010                -1.207776e-02 3 1  ON 9
ci_011                -9.907193e-03 3 1  ON 10
ci_012                -9.097399e-03 3 1  ON 11
ci_013                 8.349982e-03 3 1  ON 12
ci_014                 9.362652e-03 3 1  ON 13
ci_015                 9.511134e-03 3 1  ON 14
ci_016                 9.409472e-03 3 1  ON 15
ci_017                 8.490670e-03 3 1  ON 16
ci_018                 8.288353e-03 3 1  ON 17
ci_019                -1.235651e-03 3 1  ON 18
ci_020                -1.543613e-03 3 1  ON 19
ci_021                -1.178195e-02 3 1  ON 20
ci_022                -1.180608e-02 3 1  ON 21
ci_023                 4.854509e-03 3 1  ON 22
ci_024                 4.920539e-03 3 1  ON 23
ci_025                 1.144288e-02 3 1  ON 24
ci_026                 1.147957e-02 3 1  ON 25
ci_027                 6.465572e-03 3 1  ON 26
ci_028                 6.188294e-03 3 1  ON 27
ci_029                -5.079480e-03 3 1  ON 28
ci_030                -4.167508e-03 3 1  ON 29
ci_031                 3.334629e-03 3 1  ON 30
ci_032                 4.547888e-03 3 1  ON 31
ci_033                 2.363957e-03 3 1  ON 32
ci_034                 4.132701e-03 3 1  ON 33
ci_035                 1.721215e-03 3 1  ON 34
ci_036                 2.151367e-03 3 1  ON 35
ci_037                 3.538090e-03 3 1  ON 36
ci_038                 3.696787e-03 3 1  ON 37
ci_039                 4.618821e-03 3 1  ON 38
ci_040                 4.934143e-03 3 1  ON 39
ci_041                 2.972518e-03 3 1  ON 40
ci_042                 2.733822e-03 3 1  ON 41
ci_043                 2.944460e-03 3 1  ON 42
ci_044                 3.187452e-03 3 1  ON 43
ci_045                 2.455107e-03 3 1  ON 44
ci_046                 2.722141e-03 3 1  ON 45
ci_047                -1.001942e-03 3 1  ON 46
ci_048                -8.343947e-04 3 1  ON 47
ci_049                 7.764780e-04 3 1  ON 48
ci_050                 9.957382e-04 3 1  ON 49
ci_051                -3.173740e-04 3 1  ON 50
ci_052                -1.209351e-03 3 1  ON 51
ci_053                -2.433395e-03 3 1  ON 52
ci_054                -2.688237e-03 3 1  ON 53
ci_055                -1.798896e-03 3 1  ON 54
ci_056                -1.927120e-03 3 1  ON 55
ci_057                -1.305329e-03 3 1  ON 56
ci_058                -9.895962e-04 3 1  ON 57
ci_059                -5.494459e-04 3 1  ON 58
ci_060                -7.587065e-04 3 1  ON 59
ci_061                -4.966672e-05 3 1  ON 60
ci_062                -9.191488e-04 3 1  ON 61
ci_063                -8.852486e-04 3 1  ON 62
ci_064                -5.237734e-04 3 1  ON 63
ci_065                -1.359874e-03 3 1  ON 64
ci_066                -1.884002e-03 3 1  ON 65
ci_067                -1.809904e-03 3 1  ON 66
ci_068                -1.558728e-03 3 1  ON 67
ci_069                -5.553918e-04 3 1  ON 68
ci_070                -4.257081e-04 3 1  ON 69
ci_071                -2.085712e-03 3 1  ON 70
ci_072                -2.000427e-03 3 1  ON 71
ci_073                 1.598928e-04 3 1  ON 72
ci_074                 1.978185e-04 3 1  ON 73
ci_075                 1.627323e-04 3 1  ON 74
ci_076                 7.845114e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3861e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.6652
    reference variance = 0.244214
====================================================
  Execution time = 2.6057e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5293e-01
  Total weights = 1.955035530e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440321576371
                                         uncertainty =       0.001952590637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440321576371
                                         uncertainty =       0.001952590637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469212535
  error estimate for blocks of size 2^( 2) =       0.000493232581
  error estimate for blocks of size 2^( 3) =       0.000515231882
  error estimate for blocks of size 2^( 4) =       0.000531783429
  error estimate for blocks of size 2^( 5) =       0.000542673474
  error estimate for blocks of size 2^( 6) =       0.000549166457
  error estimate for blocks of size 2^( 7) =       0.000552770280

      target function =      -0.742915936990
              le_mean =     -22.662206684160
             les_mean =     514.028537900506
             stat err =       0.000544098410
             autocorr =       1.344669956707
   target nu stat err =       0.000544098410
   target dn stat err =       0.004140097295
      target stat err =       0.003427181263
              std dev =       0.663566730745
             le_variance =       0.440320806151


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266220668416e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+01, overlap shift 2.1176e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742930704253       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742931848275       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742932002123       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742932024420       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742932027178       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742932029659       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742932029456       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742932030090       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742932030085       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+01 is 1.186482e-05

solving harmonic davidson linear method for identity shift 8.4703e+01, overlap shift 8.4703e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742930704253       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742930990760       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742931029254       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742931034829       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742931035518       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742931036138       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742931036087       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742931036245       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742931036244       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+01 is 2.971647e-06

solving harmonic davidson linear method for identity shift 3.3881e+02, overlap shift 3.3881e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742930704253       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742930775911       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742930785536       residual = 4.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742930786930       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742930787102       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742930787257       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742930787244       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742930787284       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742930787284       residual = 8.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+02 is 7.432527e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0762e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_001                -7.055864e-01 3 1  ON 0
ci_002                -7.029022e-01 3 1  ON 1
ci_003                -5.012451e-02 3 1  ON 2
ci_004                -5.100331e-02 3 1  ON 3
ci_005                 1.948979e-02 3 1  ON 4
ci_006                 1.981006e-02 3 1  ON 5
ci_007                 1.474271e-02 3 1  ON 6
ci_008                 1.553576e-02 3 1  ON 7
ci_009                -1.319742e-02 3 1  ON 8
ci_010                -1.207664e-02 3 1  ON 9
ci_011                -9.906382e-03 3 1  ON 10
ci_012                -9.096535e-03 3 1  ON 11
ci_013                 8.348607e-03 3 1  ON 12
ci_014                 9.362285e-03 3 1  ON 13
ci_015                 9.511197e-03 3 1  ON 14
ci_016                 9.408130e-03 3 1  ON 15
ci_017                 8.489610e-03 3 1  ON 16
ci_018                 8.287966e-03 3 1  ON 17
ci_019                -1.237694e-03 3 1  ON 18
ci_020                -1.544857e-03 3 1  ON 19
ci_021                -1.178283e-02 3 1  ON 20
ci_022                -1.180722e-02 3 1  ON 21
ci_023                 4.853934e-03 3 1  ON 22
ci_024                 4.920513e-03 3 1  ON 23
ci_025                 1.144326e-02 3 1  ON 24
ci_026                 1.148120e-02 3 1  ON 25
ci_027                 6.465348e-03 3 1  ON 26
ci_028                 6.188507e-03 3 1  ON 27
ci_029                -5.078953e-03 3 1  ON 28
ci_030                -4.167063e-03 3 1  ON 29
ci_031                 3.336120e-03 3 1  ON 30
ci_032                 4.549342e-03 3 1  ON 31
ci_033                 2.364653e-03 3 1  ON 32
ci_034                 4.132094e-03 3 1  ON 33
ci_035                 1.720808e-03 3 1  ON 34
ci_036                 2.150696e-03 3 1  ON 35
ci_037                 3.537907e-03 3 1  ON 36
ci_038                 3.697071e-03 3 1  ON 37
ci_039                 4.618104e-03 3 1  ON 38
ci_040                 4.933589e-03 3 1  ON 39
ci_041                 2.971513e-03 3 1  ON 40
ci_042                 2.734573e-03 3 1  ON 41
ci_043                 2.944481e-03 3 1  ON 42
ci_044                 3.187788e-03 3 1  ON 43
ci_045                 2.455523e-03 3 1  ON 44
ci_046                 2.721876e-03 3 1  ON 45
ci_047                -1.002139e-03 3 1  ON 46
ci_048                -8.345212e-04 3 1  ON 47
ci_049                 7.759827e-04 3 1  ON 48
ci_050                 9.952660e-04 3 1  ON 49
ci_051                -3.172189e-04 3 1  ON 50
ci_052                -1.209837e-03 3 1  ON 51
ci_053                -2.433673e-03 3 1  ON 52
ci_054                -2.689158e-03 3 1  ON 53
ci_055                -1.799338e-03 3 1  ON 54
ci_056                -1.925995e-03 3 1  ON 55
ci_057                -1.308301e-03 3 1  ON 56
ci_058                -9.891804e-04 3 1  ON 57
ci_059                -5.489640e-04 3 1  ON 58
ci_060                -7.582114e-04 3 1  ON 59
ci_061                -4.961097e-05 3 1  ON 60
ci_062                -9.180799e-04 3 1  ON 61
ci_063                -8.851893e-04 3 1  ON 62
ci_064                -5.240339e-04 3 1  ON 63
ci_065                -1.360234e-03 3 1  ON 64
ci_066                -1.883657e-03 3 1  ON 65
ci_067                -1.809679e-03 3 1  ON 66
ci_068                -1.559350e-03 3 1  ON 67
ci_069                -5.550273e-04 3 1  ON 68
ci_070                -4.257371e-04 3 1  ON 69
ci_071                -2.085423e-03 3 1  ON 70
ci_072                -1.999296e-03 3 1  ON 71
ci_073                 1.596094e-04 3 1  ON 72
ci_074                 1.971457e-04 3 1  ON 73
ci_075                 1.627810e-04 3 1  ON 74
ci_076                 7.841421e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.714
    reference variance = 0.66382
====================================================
  Execution time = 2.5418e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5383e-01
  Total weights = 1.9552e+06
  Execution time = 3.6175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441747823915
                                         uncertainty =       0.001937611290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441747823915
                                         uncertainty =       0.001937611290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470014169
  error estimate for blocks of size 2^( 2) =       0.000494357010
  error estimate for blocks of size 2^( 3) =       0.000516439226
  error estimate for blocks of size 2^( 4) =       0.000531662091
  error estimate for blocks of size 2^( 5) =       0.000541131380
  error estimate for blocks of size 2^( 6) =       0.000546759270
  error estimate for blocks of size 2^( 7) =       0.000549268271

      target function =      -0.742180788330
              le_mean =     -22.661704563577
             les_mean =     514.006682724089
             stat err =       0.000542205253
             autocorr =       1.330777779560
   target nu stat err =       0.000542205253
   target dn stat err =       0.003697245804
      target stat err =       0.003063704894
              std dev =       0.664700412097
             le_variance =       0.441826637842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441746099461
                                         uncertainty =       0.001937609327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441746099461
                                         uncertainty =       0.001937609327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470013253
  error estimate for blocks of size 2^( 2) =       0.000494356311
  error estimate for blocks of size 2^( 3) =       0.000516438711
  error estimate for blocks of size 2^( 4) =       0.000531661561
  error estimate for blocks of size 2^( 5) =       0.000541131002
  error estimate for blocks of size 2^( 6) =       0.000546758741
  error estimate for blocks of size 2^( 7) =       0.000549267868

      target function =      -0.742185217652
              le_mean =     -22.661704528240
             les_mean =     514.006675682618
             stat err =       0.000542204793
             autocorr =       1.330780713189
   target nu stat err =       0.000542204793
   target dn stat err =       0.003696113038
      target stat err =       0.003062837093
              std dev =       0.664699116287
             le_variance =       0.441824915193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441746958635
                                         uncertainty =       0.001937610255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441746958635
                                         uncertainty =       0.001937610255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470013709
  error estimate for blocks of size 2^( 2) =       0.000494356659
  error estimate for blocks of size 2^( 3) =       0.000516438967
  error estimate for blocks of size 2^( 4) =       0.000531661825
  error estimate for blocks of size 2^( 5) =       0.000541131190
  error estimate for blocks of size 2^( 6) =       0.000546759004
  error estimate for blocks of size 2^( 7) =       0.000549268068

      target function =      -0.742183049659
              le_mean =     -22.661704545571
             les_mean =     514.006679130662
             stat err =       0.000542205022
             autocorr =       1.330779249734
   target nu stat err =       0.000542205022
   target dn stat err =       0.003696677275
      target stat err =       0.003063269659
              std dev =       0.664699761899
             le_variance =       0.441825773468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441747715512
                                         uncertainty =       0.001937611155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441747715512
                                         uncertainty =       0.001937611155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470014111
  error estimate for blocks of size 2^( 2) =       0.000494356966
  error estimate for blocks of size 2^( 3) =       0.000516439194
  error estimate for blocks of size 2^( 4) =       0.000531662057
  error estimate for blocks of size 2^( 5) =       0.000541131356
  error estimate for blocks of size 2^( 6) =       0.000546759236
  error estimate for blocks of size 2^( 7) =       0.000549268245

      target function =      -0.742181075935
              le_mean =     -22.661704561291
             les_mean =     514.006682267243
             stat err =       0.000542205224
             autocorr =       1.330777963520
   target nu stat err =       0.000542205224
   target dn stat err =       0.003697174564
      target stat err =       0.003063650391
              std dev =       0.664700330639
             le_variance =       0.441826529552


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742180788330        initial
     2.1176e+01     2.1176e+02             1.1865e-05        -0.742185217652  <--
     8.4703e+01     8.4703e+02             2.9716e-06        -0.742183049659
     3.3881e+02     3.3881e+03             7.4325e-07        -0.742181075935

*****************************************************************************
Applying the update for shift_i =   2.1176e+01     and shift_s =   2.1176e+02
*****************************************************************************

  Execution time = 4.3488e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_001                -7.055863e-01 3 1  ON 0
ci_002                -7.029026e-01 3 1  ON 1
ci_003                -5.012285e-02 3 1  ON 2
ci_004                -5.100457e-02 3 1  ON 3
ci_005                 1.948781e-02 3 1  ON 4
ci_006                 1.980663e-02 3 1  ON 5
ci_007                 1.474321e-02 3 1  ON 6
ci_008                 1.553244e-02 3 1  ON 7
ci_009                -1.319598e-02 3 1  ON 8
ci_010                -1.207326e-02 3 1  ON 9
ci_011                -9.903952e-03 3 1  ON 10
ci_012                -9.093947e-03 3 1  ON 11
ci_013                 8.344490e-03 3 1  ON 12
ci_014                 9.361188e-03 3 1  ON 13
ci_015                 9.511384e-03 3 1  ON 14
ci_016                 9.404111e-03 3 1  ON 15
ci_017                 8.486437e-03 3 1  ON 16
ci_018                 8.286805e-03 3 1  ON 17
ci_019                -1.243812e-03 3 1  ON 18
ci_020                -1.548581e-03 3 1  ON 19
ci_021                -1.178549e-02 3 1  ON 20
ci_022                -1.181062e-02 3 1  ON 21
ci_023                 4.852212e-03 3 1  ON 22
ci_024                 4.920435e-03 3 1  ON 23
ci_025                 1.144442e-02 3 1  ON 24
ci_026                 1.148608e-02 3 1  ON 25
ci_027                 6.464678e-03 3 1  ON 26
ci_028                 6.189141e-03 3 1  ON 27
ci_029                -5.077374e-03 3 1  ON 28
ci_030                -4.165733e-03 3 1  ON 29
ci_031                 3.340583e-03 3 1  ON 30
ci_032                 4.553695e-03 3 1  ON 31
ci_033                 2.366734e-03 3 1  ON 32
ci_034                 4.130274e-03 3 1  ON 33
ci_035                 1.719592e-03 3 1  ON 34
ci_036                 2.148689e-03 3 1  ON 35
ci_037                 3.537361e-03 3 1  ON 36
ci_038                 3.697920e-03 3 1  ON 37
ci_039                 4.615958e-03 3 1  ON 38
ci_040                 4.931929e-03 3 1  ON 39
ci_041                 2.968505e-03 3 1  ON 40
ci_042                 2.736823e-03 3 1  ON 41
ci_043                 2.944545e-03 3 1  ON 42
ci_044                 3.188796e-03 3 1  ON 43
ci_045                 2.456766e-03 3 1  ON 44
ci_046                 2.721085e-03 3 1  ON 45
ci_047                -1.002727e-03 3 1  ON 46
ci_048                -8.348997e-04 3 1  ON 47
ci_049                 7.745003e-04 3 1  ON 48
ci_050                 9.938528e-04 3 1  ON 49
ci_051                -3.167552e-04 3 1  ON 50
ci_052                -1.211291e-03 3 1  ON 51
ci_053                -2.434506e-03 3 1  ON 52
ci_054                -2.691917e-03 3 1  ON 53
ci_055                -1.800661e-03 3 1  ON 54
ci_056                -1.922627e-03 3 1  ON 55
ci_057                -1.317194e-03 3 1  ON 56
ci_058                -9.879360e-04 3 1  ON 57
ci_059                -5.475212e-04 3 1  ON 58
ci_060                -7.567295e-04 3 1  ON 59
ci_061                -4.944440e-05 3 1  ON 60
ci_062                -9.148794e-04 3 1  ON 61
ci_063                -8.850121e-04 3 1  ON 62
ci_064                -5.248140e-04 3 1  ON 63
ci_065                -1.361312e-03 3 1  ON 64
ci_066                -1.882624e-03 3 1  ON 65
ci_067                -1.809008e-03 3 1  ON 66
ci_068                -1.561212e-03 3 1  ON 67
ci_069                -5.539361e-04 3 1  ON 68
ci_070                -4.258236e-04 3 1  ON 69
ci_071                -2.084559e-03 3 1  ON 70
ci_072                -1.995909e-03 3 1  ON 71
ci_073                 1.587612e-04 3 1  ON 72
ci_074                 1.951318e-04 3 1  ON 73
ci_075                 1.629268e-04 3 1  ON 74
ci_076                 7.830364e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4256e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.6346
    reference variance = 0.447451
====================================================
  Execution time = 2.7691e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5678e-01
  Total weights = 1.955400601e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444058604643
                                         uncertainty =       0.003022738197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444058604643
                                         uncertainty =       0.003022738197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471203253
  error estimate for blocks of size 2^( 2) =       0.000495672848
  error estimate for blocks of size 2^( 3) =       0.000517842028
  error estimate for blocks of size 2^( 4) =       0.000534403693
  error estimate for blocks of size 2^( 5) =       0.000543329405
  error estimate for blocks of size 2^( 6) =       0.000548939608
  error estimate for blocks of size 2^( 7) =       0.000553256675

      target function =      -0.739784824892
              le_mean =     -22.662545423768
             les_mean =     514.047745489940
             stat err =       0.000544982345
             autocorr =       1.337667906573
   target nu stat err =       0.000544982345
   target dn stat err =       0.004557361016
      target stat err =       0.003733365282
              std dev =       0.666382030754
             le_variance =       0.444065010912


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266254542377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+00, overlap shift 5.2940e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739802641565       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739813854970       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739815053425       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739815242108       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739815281476       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739815295898       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739815320988       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739815339291       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739815347385       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739815350540       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739815351888       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739815350840       residual = 1.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+00 is 9.157354e-05

solving harmonic davidson linear method for identity shift 2.1176e+01, overlap shift 2.1176e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739802641565       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739805463192       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739805763905       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739805811108       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739805820920       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739805824481       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739805830727       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739805835279       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739805837282       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739805838050       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739805838377       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739805838119       residual = 1.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+01 is 2.303204e-05

solving harmonic davidson linear method for identity shift 8.4703e+01, overlap shift 8.4703e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739802641565       residual = 4.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739803348123       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739803423370       residual = 6.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739803435173       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739803437624       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739803438512       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739803440071       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739803441208       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739803441707       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739803441898       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739803441979       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739803441915       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+01 is 5.766741e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295889 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2426e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_001                -7.055974e-01 3 1  ON 0
ci_002                -7.028919e-01 3 1  ON 1
ci_003                -5.012883e-02 3 1  ON 2
ci_004                -5.099695e-02 3 1  ON 3
ci_005                 1.948421e-02 3 1  ON 4
ci_006                 1.980073e-02 3 1  ON 5
ci_007                 1.473979e-02 3 1  ON 6
ci_008                 1.552641e-02 3 1  ON 7
ci_009                -1.319478e-02 3 1  ON 8
ci_010                -1.207223e-02 3 1  ON 9
ci_011                -9.898033e-03 3 1  ON 10
ci_012                -9.094203e-03 3 1  ON 11
ci_013                 8.341127e-03 3 1  ON 12
ci_014                 9.355305e-03 3 1  ON 13
ci_015                 9.508571e-03 3 1  ON 14
ci_016                 9.395285e-03 3 1  ON 15
ci_017                 8.490099e-03 3 1  ON 16
ci_018                 8.285288e-03 3 1  ON 17
ci_019                -1.253443e-03 3 1  ON 18
ci_020                -1.552746e-03 3 1  ON 19
ci_021                -1.179188e-02 3 1  ON 20
ci_022                -1.181985e-02 3 1  ON 21
ci_023                 4.851431e-03 3 1  ON 22
ci_024                 4.922259e-03 3 1  ON 23
ci_025                 1.145134e-02 3 1  ON 24
ci_026                 1.149126e-02 3 1  ON 25
ci_027                 6.464970e-03 3 1  ON 26
ci_028                 6.186882e-03 3 1  ON 27
ci_029                -5.073301e-03 3 1  ON 28
ci_030                -4.160158e-03 3 1  ON 29
ci_031                 3.345584e-03 3 1  ON 30
ci_032                 4.576727e-03 3 1  ON 31
ci_033                 2.365911e-03 3 1  ON 32
ci_034                 4.125727e-03 3 1  ON 33
ci_035                 1.721523e-03 3 1  ON 34
ci_036                 2.148979e-03 3 1  ON 35
ci_037                 3.533520e-03 3 1  ON 36
ci_038                 3.699235e-03 3 1  ON 37
ci_039                 4.614731e-03 3 1  ON 38
ci_040                 4.930694e-03 3 1  ON 39
ci_041                 2.965631e-03 3 1  ON 40
ci_042                 2.734615e-03 3 1  ON 41
ci_043                 2.942877e-03 3 1  ON 42
ci_044                 3.191751e-03 3 1  ON 43
ci_045                 2.459550e-03 3 1  ON 44
ci_046                 2.725619e-03 3 1  ON 45
ci_047                -1.002559e-03 3 1  ON 46
ci_048                -8.348474e-04 3 1  ON 47
ci_049                 7.751400e-04 3 1  ON 48
ci_050                 9.942567e-04 3 1  ON 49
ci_051                -3.209956e-04 3 1  ON 50
ci_052                -1.209264e-03 3 1  ON 51
ci_053                -2.435137e-03 3 1  ON 52
ci_054                -2.694534e-03 3 1  ON 53
ci_055                -1.797534e-03 3 1  ON 54
ci_056                -1.933573e-03 3 1  ON 55
ci_057                -1.313677e-03 3 1  ON 56
ci_058                -9.903292e-04 3 1  ON 57
ci_059                -5.454011e-04 3 1  ON 58
ci_060                -7.543648e-04 3 1  ON 59
ci_061                -3.902135e-05 3 1  ON 60
ci_062                -9.111546e-04 3 1  ON 61
ci_063                -8.815661e-04 3 1  ON 62
ci_064                -5.189265e-04 3 1  ON 63
ci_065                -1.363210e-03 3 1  ON 64
ci_066                -1.882115e-03 3 1  ON 65
ci_067                -1.810351e-03 3 1  ON 66
ci_068                -1.539513e-03 3 1  ON 67
ci_069                -5.543965e-04 3 1  ON 68
ci_070                -4.246050e-04 3 1  ON 69
ci_071                -2.081051e-03 3 1  ON 70
ci_072                -1.995213e-03 3 1  ON 71
ci_073                 1.563766e-04 3 1  ON 72
ci_074                 1.920645e-04 3 1  ON 73
ci_075                 1.651166e-04 3 1  ON 74
ci_076                 7.820526e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.6287
    reference variance = 0.371742
====================================================
  Execution time = 2.5413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5196e-01
  Total weights = 1.9550e+06
  Execution time = 3.6173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441955853257
                                         uncertainty =       0.002535953844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441955853257
                                         uncertainty =       0.002535953844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470091487
  error estimate for blocks of size 2^( 2) =       0.000494129705
  error estimate for blocks of size 2^( 3) =       0.000516746602
  error estimate for blocks of size 2^( 4) =       0.000532881093
  error estimate for blocks of size 2^( 5) =       0.000541527312
  error estimate for blocks of size 2^( 6) =       0.000543273389
  error estimate for blocks of size 2^( 7) =       0.000543344872

      target function =      -0.743674880277
              le_mean =     -22.662642190085
             les_mean =     514.047357451568
             stat err =       0.000540256666
             autocorr =       1.320795243696
   target nu stat err =       0.000540256666
   target dn stat err =       0.003330263335
      target stat err =       0.002785941439
              std dev =       0.664809756186
             le_variance =       0.441972011920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441942231062
                                         uncertainty =       0.002535118642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441942231062
                                         uncertainty =       0.002535118642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470084267
  error estimate for blocks of size 2^( 2) =       0.000494123361
  error estimate for blocks of size 2^( 3) =       0.000516741336
  error estimate for blocks of size 2^( 4) =       0.000532876976
  error estimate for blocks of size 2^( 5) =       0.000541523502
  error estimate for blocks of size 2^( 6) =       0.000543269168
  error estimate for blocks of size 2^( 7) =       0.000543341037

      target function =      -0.743732018947
              le_mean =     -22.662641453937
             les_mean =     514.047254057942
             stat err =       0.000540252671
             autocorr =       1.320816274454
   target nu stat err =       0.000540252671
   target dn stat err =       0.003346192973
      target stat err =       0.002799080257
              std dev =       0.664799546356
             le_variance =       0.441958436836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948910603
                                         uncertainty =       0.002535532041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948910603
                                         uncertainty =       0.002535532041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470087807
  error estimate for blocks of size 2^( 2) =       0.000494126483
  error estimate for blocks of size 2^( 3) =       0.000516743910
  error estimate for blocks of size 2^( 4) =       0.000532879000
  error estimate for blocks of size 2^( 5) =       0.000541525367
  error estimate for blocks of size 2^( 6) =       0.000543271245
  error estimate for blocks of size 2^( 7) =       0.000543342976

      target function =      -0.743615627211
              le_mean =     -22.662641796551
             les_mean =     514.047412036572
             stat err =       0.000540254647
             autocorr =       1.320806046846
   target nu stat err =       0.000540254647
   target dn stat err =       0.003341087383
      target stat err =       0.002794148534
              std dev =       0.664804552533
             le_variance =       0.441965093069

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441955014842
                                         uncertainty =       0.002535907535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441955014842
                                         uncertainty =       0.002535907535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470091042
  error estimate for blocks of size 2^( 2) =       0.000494129301
  error estimate for blocks of size 2^( 3) =       0.000516746080
  error estimate for blocks of size 2^( 4) =       0.000532880579
  error estimate for blocks of size 2^( 5) =       0.000541527152
  error estimate for blocks of size 2^( 6) =       0.000543273614
  error estimate for blocks of size 2^( 7) =       0.000543345635

      target function =      -0.599141551842
              le_mean =     -22.662642286491
             les_mean =     514.234814881957
             stat err =       0.000540256745
             autocorr =       1.320798125219
   target nu stat err =       0.000540256745
   target dn stat err =       0.187632506542
      target stat err =       0.102448060161
              std dev =       0.664809127826
             le_variance =       0.441971176441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743674880277        initial
     5.2940e+00     5.2940e+01             9.1574e-05        -0.743732018947  <--
     2.1176e+01     2.1176e+02             2.3032e-05        -0.743615627211
     8.4703e+01     8.4703e+02             5.7667e-06        -0.599141551842

*****************************************************************************
Applying the update for shift_i =   5.2940e+00     and shift_s =   5.2940e+01
*****************************************************************************

  Execution time = 4.6038e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_001                -7.056307e-01 3 1  ON 0
ci_002                -7.028599e-01 3 1  ON 1
ci_003                -5.014671e-02 3 1  ON 2
ci_004                -5.097415e-02 3 1  ON 3
ci_005                 1.947351e-02 3 1  ON 4
ci_006                 1.978319e-02 3 1  ON 5
ci_007                 1.472962e-02 3 1  ON 6
ci_008                 1.550845e-02 3 1  ON 7
ci_009                -1.319120e-02 3 1  ON 8
ci_010                -1.206914e-02 3 1  ON 9
ci_011                -9.880405e-03 3 1  ON 10
ci_012                -9.094970e-03 3 1  ON 11
ci_013                 8.331113e-03 3 1  ON 12
ci_014                 9.337802e-03 3 1  ON 13
ci_015                 9.500187e-03 3 1  ON 14
ci_016                 9.369003e-03 3 1  ON 15
ci_017                 8.501002e-03 3 1  ON 16
ci_018                 8.280777e-03 3 1  ON 17
ci_019                -1.282135e-03 3 1  ON 18
ci_020                -1.565160e-03 3 1  ON 19
ci_021                -1.181092e-02 3 1  ON 20
ci_022                -1.184732e-02 3 1  ON 21
ci_023                 4.849110e-03 3 1  ON 22
ci_024                 4.927681e-03 3 1  ON 23
ci_025                 1.147196e-02 3 1  ON 24
ci_026                 1.150670e-02 3 1  ON 25
ci_027                 6.465839e-03 3 1  ON 26
ci_028                 6.180166e-03 3 1  ON 27
ci_029                -5.061175e-03 3 1  ON 28
ci_030                -4.143564e-03 3 1  ON 29
ci_031                 3.360482e-03 3 1  ON 30
ci_032                 4.645268e-03 3 1  ON 31
ci_033                 2.363457e-03 3 1  ON 32
ci_034                 4.112178e-03 3 1  ON 33
ci_035                 1.727256e-03 3 1  ON 34
ci_036                 2.149835e-03 3 1  ON 35
ci_037                 3.522086e-03 3 1  ON 36
ci_038                 3.703140e-03 3 1  ON 37
ci_039                 4.611089e-03 3 1  ON 38
ci_040                 4.927016e-03 3 1  ON 39
ci_041                 2.957095e-03 3 1  ON 40
ci_042                 2.728055e-03 3 1  ON 41
ci_043                 2.937896e-03 3 1  ON 42
ci_044                 3.200529e-03 3 1  ON 43
ci_045                 2.467838e-03 3 1  ON 44
ci_046                 2.739121e-03 3 1  ON 45
ci_047                -1.002058e-03 3 1  ON 46
ci_048                -8.346892e-04 3 1  ON 47
ci_049                 7.770443e-04 3 1  ON 48
ci_050                 9.954604e-04 3 1  ON 49
ci_051                -3.336059e-04 3 1  ON 50
ci_052                -1.203226e-03 3 1  ON 51
ci_053                -2.437031e-03 3 1  ON 52
ci_054                -2.702316e-03 3 1  ON 53
ci_055                -1.788227e-03 3 1  ON 54
ci_056                -1.966149e-03 3 1  ON 55
ci_057                -1.303226e-03 3 1  ON 56
ci_058                -9.974413e-04 3 1  ON 57
ci_059                -5.390966e-04 3 1  ON 58
ci_060                -7.473364e-04 3 1  ON 59
ci_061                -8.022843e-06 3 1  ON 60
ci_062                -9.000741e-04 3 1  ON 61
ci_063                -8.713076e-04 3 1  ON 62
ci_064                -5.014078e-04 3 1  ON 63
ci_065                -1.368864e-03 3 1  ON 64
ci_066                -1.880598e-03 3 1  ON 65
ci_067                -1.814350e-03 3 1  ON 66
ci_068                -1.474982e-03 3 1  ON 67
ci_069                -5.557717e-04 3 1  ON 68
ci_070                -4.209775e-04 3 1  ON 69
ci_071                -2.070615e-03 3 1  ON 70
ci_072                -1.993138e-03 3 1  ON 71
ci_073                 1.492899e-04 3 1  ON 72
ci_074                 1.829588e-04 3 1  ON 73
ci_075                 1.716363e-04 3 1  ON 74
ci_076                 7.791230e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8470e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.6458
    reference variance = 0.543118
====================================================
  Execution time = 2.5864e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5971e-01
  Total weights = 1.955229232e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443334813444
                                         uncertainty =       0.002860791838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443334813444
                                         uncertainty =       0.002860791838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470782539
  error estimate for blocks of size 2^( 2) =       0.000495017896
  error estimate for blocks of size 2^( 3) =       0.000516789190
  error estimate for blocks of size 2^( 4) =       0.000531665534
  error estimate for blocks of size 2^( 5) =       0.000540091358
  error estimate for blocks of size 2^( 6) =       0.000543738399
  error estimate for blocks of size 2^( 7) =       0.000545861745

      target function =      -0.737394419845
              le_mean =     -22.662115414001
             les_mean =     514.031188542273
             stat err =       0.000540339259
             autocorr =       1.317323233815
   target nu stat err =       0.000540339259
   target dn stat err =       0.007153543616
      target stat err =       0.005774343028
              std dev =       0.665787052192
             le_variance =       0.443272398867


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266211541400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+00, overlap shift 1.3235e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737438896575       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737463600253       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737468068715       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737468985998       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737469064587       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737469359419       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737469499692       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737469542747       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737469565150       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737469569304       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737469580164       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737469582380       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+00 is 2.362321e-04

solving harmonic davidson linear method for identity shift 5.2940e+00, overlap shift 5.2940e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737438896575       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737445235038       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737446366337       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737446597033       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737446615384       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737446688471       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737446722278       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737446732434       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737446737687       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737446738630       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737446741168       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737446741678       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+00 is 5.918022e-05

solving harmonic davidson linear method for identity shift 2.1176e+01, overlap shift 2.1176e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737438896575       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737440491686       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737440775399       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737440833156       residual = 2.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737440837660       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737440855890       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737440864263       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737440866764       residual = 7.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737440868055       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737440868285       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737440868909       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737440869034       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+01 is 1.480292e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0579e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_001                -7.055749e-01 3 1  ON 0
ci_002                -7.029190e-01 3 1  ON 1
ci_003                -5.011012e-02 3 1  ON 2
ci_004                -5.098460e-02 3 1  ON 3
ci_005                 1.947241e-02 3 1  ON 4
ci_006                 1.976442e-02 3 1  ON 5
ci_007                 1.473341e-02 3 1  ON 6
ci_008                 1.549909e-02 3 1  ON 7
ci_009                -1.316394e-02 3 1  ON 8
ci_010                -1.205643e-02 3 1  ON 9
ci_011                -9.852641e-03 3 1  ON 10
ci_012                -9.087354e-03 3 1  ON 11
ci_013                 8.372270e-03 3 1  ON 12
ci_014                 9.305907e-03 3 1  ON 13
ci_015                 9.501434e-03 3 1  ON 14
ci_016                 9.365428e-03 3 1  ON 15
ci_017                 8.491514e-03 3 1  ON 16
ci_018                 8.270180e-03 3 1  ON 17
ci_019                -1.254338e-03 3 1  ON 18
ci_020                -1.578712e-03 3 1  ON 19
ci_021                -1.181851e-02 3 1  ON 20
ci_022                -1.183235e-02 3 1  ON 21
ci_023                 4.840218e-03 3 1  ON 22
ci_024                 4.911576e-03 3 1  ON 23
ci_025                 1.152117e-02 3 1  ON 24
ci_026                 1.152216e-02 3 1  ON 25
ci_027                 6.478586e-03 3 1  ON 26
ci_028                 6.177878e-03 3 1  ON 27
ci_029                -5.036660e-03 3 1  ON 28
ci_030                -4.117284e-03 3 1  ON 29
ci_031                 3.409763e-03 3 1  ON 30
ci_032                 4.673453e-03 3 1  ON 31
ci_033                 2.350452e-03 3 1  ON 32
ci_034                 4.110467e-03 3 1  ON 33
ci_035                 1.724512e-03 3 1  ON 34
ci_036                 2.139400e-03 3 1  ON 35
ci_037                 3.496104e-03 3 1  ON 36
ci_038                 3.700376e-03 3 1  ON 37
ci_039                 4.608678e-03 3 1  ON 38
ci_040                 4.921159e-03 3 1  ON 39
ci_041                 2.958017e-03 3 1  ON 40
ci_042                 2.732234e-03 3 1  ON 41
ci_043                 2.939994e-03 3 1  ON 42
ci_044                 3.208232e-03 3 1  ON 43
ci_045                 2.474668e-03 3 1  ON 44
ci_046                 2.734063e-03 3 1  ON 45
ci_047                -1.005806e-03 3 1  ON 46
ci_048                -8.436662e-04 3 1  ON 47
ci_049                 7.774474e-04 3 1  ON 48
ci_050                 9.964194e-04 3 1  ON 49
ci_051                -3.351686e-04 3 1  ON 50
ci_052                -1.211130e-03 3 1  ON 51
ci_053                -2.459921e-03 3 1  ON 52
ci_054                -2.689467e-03 3 1  ON 53
ci_055                -1.792436e-03 3 1  ON 54
ci_056                -1.966453e-03 3 1  ON 55
ci_057                -1.321638e-03 3 1  ON 56
ci_058                -9.950890e-04 3 1  ON 57
ci_059                -5.210415e-04 3 1  ON 58
ci_060                -7.415438e-04 3 1  ON 59
ci_061                 5.162940e-06 3 1  ON 60
ci_062                -9.086380e-04 3 1  ON 61
ci_063                -8.908316e-04 3 1  ON 62
ci_064                -5.015338e-04 3 1  ON 63
ci_065                -1.366383e-03 3 1  ON 64
ci_066                -1.880471e-03 3 1  ON 65
ci_067                -1.825674e-03 3 1  ON 66
ci_068                -1.480035e-03 3 1  ON 67
ci_069                -5.508848e-04 3 1  ON 68
ci_070                -4.219650e-04 3 1  ON 69
ci_071                -2.066783e-03 3 1  ON 70
ci_072                -1.993380e-03 3 1  ON 71
ci_073                 1.617139e-04 3 1  ON 72
ci_074                 1.780361e-04 3 1  ON 73
ci_075                 1.703451e-04 3 1  ON 74
ci_076                 7.922932e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.7158
    reference variance = 0.409199
====================================================
  Execution time = 2.5241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4864e-01
  Total weights = 1.9553e+06
  Execution time = 3.5898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440737782184
                                         uncertainty =       0.002319201997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440737782184
                                         uncertainty =       0.002319201997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469409563
  error estimate for blocks of size 2^( 2) =       0.000493278850
  error estimate for blocks of size 2^( 3) =       0.000515160323
  error estimate for blocks of size 2^( 4) =       0.000530512718
  error estimate for blocks of size 2^( 5) =       0.000540664366
  error estimate for blocks of size 2^( 6) =       0.000545692841
  error estimate for blocks of size 2^( 7) =       0.000546853203

      target function =      -0.746403878924
              le_mean =     -22.662571192538
             les_mean =     514.040817210760
             stat err =       0.000540930782
             autocorr =       1.327943278973
   target nu stat err =       0.000540930782
   target dn stat err =       0.002474928998
      target stat err =       0.002123042780
              std dev =       0.663845370478
             le_variance =       0.440690675905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440707640907
                                         uncertainty =       0.002315888778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440707640907
                                         uncertainty =       0.002315888778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469393581
  error estimate for blocks of size 2^( 2) =       0.000493266062
  error estimate for blocks of size 2^( 3) =       0.000515152731
  error estimate for blocks of size 2^( 4) =       0.000530507105
  error estimate for blocks of size 2^( 5) =       0.000540660555
  error estimate for blocks of size 2^( 6) =       0.000545688056
  error estimate for blocks of size 2^( 7) =       0.000546839732

      target function =      -0.746459689963
              le_mean =     -22.662569752392
             les_mean =     514.040684161757
             stat err =       0.000540923862
             autocorr =       1.327999730994
   target nu stat err =       0.000540923862
   target dn stat err =       0.002468079620
      target stat err =       0.002117929244
              std dev =       0.663822768573
             le_variance =       0.440660668076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440721648950
                                         uncertainty =       0.002317496065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440721648950
                                         uncertainty =       0.002317496065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469401008
  error estimate for blocks of size 2^( 2) =       0.000493271943
  error estimate for blocks of size 2^( 3) =       0.000515156087
  error estimate for blocks of size 2^( 4) =       0.000530509501
  error estimate for blocks of size 2^( 5) =       0.000540662059
  error estimate for blocks of size 2^( 6) =       0.000545690003
  error estimate for blocks of size 2^( 7) =       0.000546845973

      target function =      -0.746460134545
              le_mean =     -22.662570351333
             les_mean =     514.040710764254
             stat err =       0.000540926884
             autocorr =       1.327972550455
   target nu stat err =       0.000540926884
   target dn stat err =       0.002470632973
      target stat err =       0.002119951804
              std dev =       0.663833270998
             le_variance =       0.440674611684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440735660340
                                         uncertainty =       0.002318985368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440735660340
                                         uncertainty =       0.002318985368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469408438
  error estimate for blocks of size 2^( 2) =       0.000493277932
  error estimate for blocks of size 2^( 3) =       0.000515159744
  error estimate for blocks of size 2^( 4) =       0.000530512264
  error estimate for blocks of size 2^( 5) =       0.000540664023
  error estimate for blocks of size 2^( 6) =       0.000545692418
  error estimate for blocks of size 2^( 7) =       0.000546852218

      target function =      -0.746425645012
              le_mean =     -22.662571079565
             les_mean =     514.040785653539
             stat err =       0.000540930231
             autocorr =       1.327946941862
   target nu stat err =       0.000540930231
   target dn stat err =       0.002474232213
      target stat err =       0.002122610642
              std dev =       0.663843778939
             le_variance =       0.440688562836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746403878924        initial
     1.3235e+00     1.3235e+01             2.3623e-04        -0.746459689963
     5.2940e+00     5.2940e+01             5.9180e-05        -0.746460134545  <--
     2.1176e+01     2.1176e+02             1.4803e-05        -0.746425645012

*****************************************************************************
Applying the update for shift_i =   5.2940e+00     and shift_s =   5.2940e+01
*****************************************************************************

  Execution time = 4.3255e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_001                -7.055749e-01 3 1  ON 0
ci_002                -7.029190e-01 3 1  ON 1
ci_003                -5.011012e-02 3 1  ON 2
ci_004                -5.098460e-02 3 1  ON 3
ci_005                 1.947241e-02 3 1  ON 4
ci_006                 1.976442e-02 3 1  ON 5
ci_007                 1.473341e-02 3 1  ON 6
ci_008                 1.549909e-02 3 1  ON 7
ci_009                -1.316394e-02 3 1  ON 8
ci_010                -1.205643e-02 3 1  ON 9
ci_011                -9.852641e-03 3 1  ON 10
ci_012                -9.087354e-03 3 1  ON 11
ci_013                 8.372270e-03 3 1  ON 12
ci_014                 9.305907e-03 3 1  ON 13
ci_015                 9.501434e-03 3 1  ON 14
ci_016                 9.365428e-03 3 1  ON 15
ci_017                 8.491514e-03 3 1  ON 16
ci_018                 8.270180e-03 3 1  ON 17
ci_019                -1.254338e-03 3 1  ON 18
ci_020                -1.578712e-03 3 1  ON 19
ci_021                -1.181851e-02 3 1  ON 20
ci_022                -1.183235e-02 3 1  ON 21
ci_023                 4.840218e-03 3 1  ON 22
ci_024                 4.911576e-03 3 1  ON 23
ci_025                 1.152117e-02 3 1  ON 24
ci_026                 1.152216e-02 3 1  ON 25
ci_027                 6.478586e-03 3 1  ON 26
ci_028                 6.177878e-03 3 1  ON 27
ci_029                -5.036660e-03 3 1  ON 28
ci_030                -4.117284e-03 3 1  ON 29
ci_031                 3.409763e-03 3 1  ON 30
ci_032                 4.673453e-03 3 1  ON 31
ci_033                 2.350452e-03 3 1  ON 32
ci_034                 4.110467e-03 3 1  ON 33
ci_035                 1.724512e-03 3 1  ON 34
ci_036                 2.139400e-03 3 1  ON 35
ci_037                 3.496104e-03 3 1  ON 36
ci_038                 3.700376e-03 3 1  ON 37
ci_039                 4.608678e-03 3 1  ON 38
ci_040                 4.921159e-03 3 1  ON 39
ci_041                 2.958017e-03 3 1  ON 40
ci_042                 2.732234e-03 3 1  ON 41
ci_043                 2.939994e-03 3 1  ON 42
ci_044                 3.208232e-03 3 1  ON 43
ci_045                 2.474668e-03 3 1  ON 44
ci_046                 2.734063e-03 3 1  ON 45
ci_047                -1.005806e-03 3 1  ON 46
ci_048                -8.436662e-04 3 1  ON 47
ci_049                 7.774474e-04 3 1  ON 48
ci_050                 9.964194e-04 3 1  ON 49
ci_051                -3.351686e-04 3 1  ON 50
ci_052                -1.211130e-03 3 1  ON 51
ci_053                -2.459921e-03 3 1  ON 52
ci_054                -2.689467e-03 3 1  ON 53
ci_055                -1.792436e-03 3 1  ON 54
ci_056                -1.966453e-03 3 1  ON 55
ci_057                -1.321638e-03 3 1  ON 56
ci_058                -9.950890e-04 3 1  ON 57
ci_059                -5.210415e-04 3 1  ON 58
ci_060                -7.415438e-04 3 1  ON 59
ci_061                 5.162940e-06 3 1  ON 60
ci_062                -9.086380e-04 3 1  ON 61
ci_063                -8.908316e-04 3 1  ON 62
ci_064                -5.015338e-04 3 1  ON 63
ci_065                -1.366383e-03 3 1  ON 64
ci_066                -1.880471e-03 3 1  ON 65
ci_067                -1.825674e-03 3 1  ON 66
ci_068                -1.480035e-03 3 1  ON 67
ci_069                -5.508848e-04 3 1  ON 68
ci_070                -4.219650e-04 3 1  ON 69
ci_071                -2.066783e-03 3 1  ON 70
ci_072                -1.993380e-03 3 1  ON 71
ci_073                 1.617139e-04 3 1  ON 72
ci_074                 1.780361e-04 3 1  ON 73
ci_075                 1.703451e-04 3 1  ON 74
ci_076                 7.922932e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.6186
    reference variance = 0.261397
====================================================
  Execution time = 2.5927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5136e-01
  Total weights = 1.955198346e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440943553842
                                         uncertainty =       0.002139888992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440943553842
                                         uncertainty =       0.002139888992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469538508
  error estimate for blocks of size 2^( 2) =       0.000493469749
  error estimate for blocks of size 2^( 3) =       0.000515867152
  error estimate for blocks of size 2^( 4) =       0.000532239386
  error estimate for blocks of size 2^( 5) =       0.000542196018
  error estimate for blocks of size 2^( 6) =       0.000546136446
  error estimate for blocks of size 2^( 7) =       0.000546894070

      target function =      -0.744196613096
              le_mean =     -22.661460491567
             les_mean =     513.993151520848
             stat err =       0.000541866480
             autocorr =       1.331809601161
   target nu stat err =       0.000541866480
   target dn stat err =       0.002717074946
      target stat err =       0.002298313461
              std dev =       0.664027726037
             le_variance =       0.440932820946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266146049157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+00, overlap shift 1.3235e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744202755312       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744215302316       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744217721054       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744218067811       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744218265805       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744218217399       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744218259065       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744218212772       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744218223639       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744218234522       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744218239982       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+00 is 1.501470e-04

solving harmonic davidson linear method for identity shift 5.2940e+00, overlap shift 5.2940e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744202755312       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744205979379       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744206591104       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744206677908       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744206727439       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744206714250       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744206724504       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744206713167       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744206715861       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744206718556       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744206719782       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+00 is 3.759684e-05

solving harmonic davidson linear method for identity shift 2.1176e+01, overlap shift 2.1176e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744202755312       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744203566977       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744203720347       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744203742053       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744203754437       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744203751070       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744203753624       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744203750805       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744203751477       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744203752149       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744203752447       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+01 is 9.403062e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304874 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0640e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_001                -7.055382e-01 3 1  ON 0
ci_002                -7.029566e-01 3 1  ON 1
ci_003                -5.012926e-02 3 1  ON 2
ci_004                -5.098487e-02 3 1  ON 3
ci_005                 1.946831e-02 3 1  ON 4
ci_006                 1.975274e-02 3 1  ON 5
ci_007                 1.473571e-02 3 1  ON 6
ci_008                 1.548099e-02 3 1  ON 7
ci_009                -1.313782e-02 3 1  ON 8
ci_010                -1.204933e-02 3 1  ON 9
ci_011                -9.839588e-03 3 1  ON 10
ci_012                -9.079471e-03 3 1  ON 11
ci_013                 8.348693e-03 3 1  ON 12
ci_014                 9.277444e-03 3 1  ON 13
ci_015                 9.497947e-03 3 1  ON 14
ci_016                 9.353121e-03 3 1  ON 15
ci_017                 8.489855e-03 3 1  ON 16
ci_018                 8.255320e-03 3 1  ON 17
ci_019                -1.284308e-03 3 1  ON 18
ci_020                -1.601754e-03 3 1  ON 19
ci_021                -1.181922e-02 3 1  ON 20
ci_022                -1.183999e-02 3 1  ON 21
ci_023                 4.850394e-03 3 1  ON 22
ci_024                 4.908998e-03 3 1  ON 23
ci_025                 1.154726e-02 3 1  ON 24
ci_026                 1.155100e-02 3 1  ON 25
ci_027                 6.473405e-03 3 1  ON 26
ci_028                 6.175386e-03 3 1  ON 27
ci_029                -5.022056e-03 3 1  ON 28
ci_030                -4.109763e-03 3 1  ON 29
ci_031                 3.422063e-03 3 1  ON 30
ci_032                 4.658621e-03 3 1  ON 31
ci_033                 2.346918e-03 3 1  ON 32
ci_034                 4.102772e-03 3 1  ON 33
ci_035                 1.722547e-03 3 1  ON 34
ci_036                 2.132010e-03 3 1  ON 35
ci_037                 3.484932e-03 3 1  ON 36
ci_038                 3.702272e-03 3 1  ON 37
ci_039                 4.584533e-03 3 1  ON 38
ci_040                 4.920923e-03 3 1  ON 39
ci_041                 2.948266e-03 3 1  ON 40
ci_042                 2.740404e-03 3 1  ON 41
ci_043                 2.936056e-03 3 1  ON 42
ci_044                 3.202076e-03 3 1  ON 43
ci_045                 2.471851e-03 3 1  ON 44
ci_046                 2.739882e-03 3 1  ON 45
ci_047                -1.009049e-03 3 1  ON 46
ci_048                -8.483855e-04 3 1  ON 47
ci_049                 7.930947e-04 3 1  ON 48
ci_050                 9.928288e-04 3 1  ON 49
ci_051                -3.396913e-04 3 1  ON 50
ci_052                -1.215583e-03 3 1  ON 51
ci_053                -2.461421e-03 3 1  ON 52
ci_054                -2.687719e-03 3 1  ON 53
ci_055                -1.785336e-03 3 1  ON 54
ci_056                -1.959965e-03 3 1  ON 55
ci_057                -1.317338e-03 3 1  ON 56
ci_058                -1.002482e-03 3 1  ON 57
ci_059                -5.252873e-04 3 1  ON 58
ci_060                -7.426012e-04 3 1  ON 59
ci_061                 9.343477e-06 3 1  ON 60
ci_062                -9.058328e-04 3 1  ON 61
ci_063                -8.823039e-04 3 1  ON 62
ci_064                -5.087569e-04 3 1  ON 63
ci_065                -1.363610e-03 3 1  ON 64
ci_066                -1.886402e-03 3 1  ON 65
ci_067                -1.820006e-03 3 1  ON 66
ci_068                -1.482654e-03 3 1  ON 67
ci_069                -5.504686e-04 3 1  ON 68
ci_070                -4.176352e-04 3 1  ON 69
ci_071                -2.059884e-03 3 1  ON 70
ci_072                -1.989162e-03 3 1  ON 71
ci_073                 1.518629e-04 3 1  ON 72
ci_074                 1.730515e-04 3 1  ON 73
ci_075                 1.752710e-04 3 1  ON 74
ci_076                 7.918675e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.635
    reference variance = 0.485687
====================================================
  Execution time = 2.5471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5209e-01
  Total weights = 1.9551e+06
  Execution time = 3.6147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439240610566
                                         uncertainty =       0.002467995534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439240610566
                                         uncertainty =       0.002467995534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468718732
  error estimate for blocks of size 2^( 2) =       0.000493251242
  error estimate for blocks of size 2^( 3) =       0.000515810820
  error estimate for blocks of size 2^( 4) =       0.000532189900
  error estimate for blocks of size 2^( 5) =       0.000542066099
  error estimate for blocks of size 2^( 6) =       0.000546500756
  error estimate for blocks of size 2^( 7) =       0.000548496625

      target function =      -0.743596244513
              le_mean =     -22.662246870182
             les_mean =     514.029529161221
             stat err =       0.000542313345
             autocorr =       1.338677494456
   target nu stat err =       0.000542313345
   target dn stat err =       0.003737643902
      target stat err =       0.003110045400
              std dev =       0.662868388008
             le_variance =       0.439394499821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439214110835
                                         uncertainty =       0.002466930392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439214110835
                                         uncertainty =       0.002466930392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468704482
  error estimate for blocks of size 2^( 2) =       0.000493239543
  error estimate for blocks of size 2^( 3) =       0.000515802168
  error estimate for blocks of size 2^( 4) =       0.000532182767
  error estimate for blocks of size 2^( 5) =       0.000542058110
  error estimate for blocks of size 2^( 6) =       0.000546491985
  error estimate for blocks of size 2^( 7) =       0.000548485554

      target function =      -0.743555272865
              le_mean =     -22.662247049784
             les_mean =     514.029587479150
             stat err =       0.000542304604
             autocorr =       1.338715738770
   target nu stat err =       0.000542304604
   target dn stat err =       0.003737425521
      target stat err =       0.003109532913
              std dev =       0.662848235777
             le_variance =       0.439367783673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226729984
                                         uncertainty =       0.002467443451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439226729984
                                         uncertainty =       0.002467443451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468711270
  error estimate for blocks of size 2^( 2) =       0.000493245086
  error estimate for blocks of size 2^( 3) =       0.000515806233
  error estimate for blocks of size 2^( 4) =       0.000532186096
  error estimate for blocks of size 2^( 5) =       0.000542061863
  error estimate for blocks of size 2^( 6) =       0.000546496145
  error estimate for blocks of size 2^( 7) =       0.000548490859

      target function =      -0.743594131957
              le_mean =     -22.662246915932
             les_mean =     514.029533825260
             stat err =       0.000542308741
             autocorr =       1.338697389003
   target nu stat err =       0.000542308741
   target dn stat err =       0.003737343613
      target stat err =       0.003109786583
              std dev =       0.662857834931
             le_variance =       0.439380509329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439238826335
                                         uncertainty =       0.002467925143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439238826335
                                         uncertainty =       0.002467925143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468717773
  error estimate for blocks of size 2^( 2) =       0.000493250447
  error estimate for blocks of size 2^( 3) =       0.000515810223
  error estimate for blocks of size 2^( 4) =       0.000532189403
  error estimate for blocks of size 2^( 5) =       0.000542065547
  error estimate for blocks of size 2^( 6) =       0.000546500160
  error estimate for blocks of size 2^( 7) =       0.000548495885

      target function =      -0.743597523549
              le_mean =     -22.662246869958
             les_mean =     514.029527585436
             stat err =       0.000542312749
             autocorr =       1.338680029344
   target nu stat err =       0.000542312749
   target dn stat err =       0.003737590512
      target stat err =       0.003110012979
              std dev =       0.662867031784
             le_variance =       0.439392701826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743596244513        initial
     1.3235e+00     1.3235e+01             1.5015e-04        -0.743555272865
     5.2940e+00     5.2940e+01             3.7597e-05        -0.743594131957
     2.1176e+01     2.1176e+02             9.4031e-06        -0.743597523549  <--

*****************************************************************************
Applying the update for shift_i =   2.1176e+01     and shift_s =   2.1176e+02
*****************************************************************************

  Execution time = 4.3560e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_001                -7.055657e-01 3 1  ON 0
ci_002                -7.029284e-01 3 1  ON 1
ci_003                -5.011491e-02 3 1  ON 2
ci_004                -5.098467e-02 3 1  ON 3
ci_005                 1.947138e-02 3 1  ON 4
ci_006                 1.976148e-02 3 1  ON 5
ci_007                 1.473399e-02 3 1  ON 6
ci_008                 1.549453e-02 3 1  ON 7
ci_009                -1.315738e-02 3 1  ON 8
ci_010                -1.205464e-02 3 1  ON 9
ci_011                -9.849358e-03 3 1  ON 10
ci_012                -9.085371e-03 3 1  ON 11
ci_013                 8.366343e-03 3 1  ON 12
ci_014                 9.298749e-03 3 1  ON 13
ci_015                 9.500557e-03 3 1  ON 14
ci_016                 9.362335e-03 3 1  ON 15
ci_017                 8.491095e-03 3 1  ON 16
ci_018                 8.266443e-03 3 1  ON 17
ci_019                -1.261870e-03 3 1  ON 18
ci_020                -1.584503e-03 3 1  ON 19
ci_021                -1.181869e-02 3 1  ON 20
ci_022                -1.183427e-02 3 1  ON 21
ci_023                 4.842779e-03 3 1  ON 22
ci_024                 4.910927e-03 3 1  ON 23
ci_025                 1.152773e-02 3 1  ON 24
ci_026                 1.152940e-02 3 1  ON 25
ci_027                 6.477281e-03 3 1  ON 26
ci_028                 6.177250e-03 3 1  ON 27
ci_029                -5.032990e-03 3 1  ON 28
ci_030                -4.115393e-03 3 1  ON 29
ci_031                 3.412856e-03 3 1  ON 30
ci_032                 4.669723e-03 3 1  ON 31
ci_033                 2.349563e-03 3 1  ON 32
ci_034                 4.108533e-03 3 1  ON 33
ci_035                 1.724017e-03 3 1  ON 34
ci_036                 2.137539e-03 3 1  ON 35
ci_037                 3.493293e-03 3 1  ON 36
ci_038                 3.700854e-03 3 1  ON 37
ci_039                 4.602595e-03 3 1  ON 38
ci_040                 4.921099e-03 3 1  ON 39
ci_041                 2.955560e-03 3 1  ON 40
ci_042                 2.734291e-03 3 1  ON 41
ci_043                 2.939004e-03 3 1  ON 42
ci_044                 3.206684e-03 3 1  ON 43
ci_045                 2.473959e-03 3 1  ON 44
ci_046                 2.735525e-03 3 1  ON 45
ci_047                -1.006623e-03 3 1  ON 46
ci_048                -8.448552e-04 3 1  ON 47
ci_049                 7.813846e-04 3 1  ON 48
ci_050                 9.955154e-04 3 1  ON 49
ci_051                -3.363054e-04 3 1  ON 50
ci_052                -1.212251e-03 3 1  ON 51
ci_053                -2.460297e-03 3 1  ON 52
ci_054                -2.689027e-03 3 1  ON 53
ci_055                -1.790651e-03 3 1  ON 54
ci_056                -1.964823e-03 3 1  ON 55
ci_057                -1.320557e-03 3 1  ON 56
ci_058                -9.969501e-04 3 1  ON 57
ci_059                -5.221109e-04 3 1  ON 58
ci_060                -7.418104e-04 3 1  ON 59
ci_061                 6.215182e-06 3 1  ON 60
ci_062                -9.079337e-04 3 1  ON 61
ci_063                -8.886841e-04 3 1  ON 62
ci_064                -5.033481e-04 3 1  ON 63
ci_065                -1.365686e-03 3 1  ON 64
ci_066                -1.881962e-03 3 1  ON 65
ci_067                -1.824247e-03 3 1  ON 66
ci_068                -1.480694e-03 3 1  ON 67
ci_069                -5.507793e-04 3 1  ON 68
ci_070                -4.208759e-04 3 1  ON 69
ci_071                -2.065049e-03 3 1  ON 70
ci_072                -1.992319e-03 3 1  ON 71
ci_073                 1.592317e-04 3 1  ON 72
ci_074                 1.767804e-04 3 1  ON 73
ci_075                 1.715833e-04 3 1  ON 74
ci_076                 7.921861e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4207e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.5243
    reference variance = 0.38144
====================================================
  Execution time = 2.5963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5341e-01
  Total weights = 1.955403737e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443671804494
                                         uncertainty =       0.002197533706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443671804494
                                         uncertainty =       0.002197533706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471050623
  error estimate for blocks of size 2^( 2) =       0.000495147599
  error estimate for blocks of size 2^( 3) =       0.000517584962
  error estimate for blocks of size 2^( 4) =       0.000533338644
  error estimate for blocks of size 2^( 5) =       0.000541225801
  error estimate for blocks of size 2^( 6) =       0.000546017825
  error estimate for blocks of size 2^( 7) =       0.000547845189

      target function =      -0.742526037862
              le_mean =     -22.661666600787
             les_mean =     514.004544065822
             stat err =       0.000542106865
             autocorr =       1.324447196671
   target nu stat err =       0.000542106865
   target dn stat err =       0.002725804771
      target stat err =       0.002295976469
              std dev =       0.666166179812
             le_variance =       0.443777379125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266166660079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+00, overlap shift 5.2940e+01 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742532179301       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742534693783       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742535382239       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742535437876       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742535452198       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742535450682       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742535450403       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742535451848       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742535449946       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742535449071       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742535448297       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+00 is 3.549658e-05

solving harmonic davidson linear method for identity shift 2.1176e+01, overlap shift 2.1176e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742532179301       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742532812220       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742532984862       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742532998771       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742533002339       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742533001954       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742533001884       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742533002243       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742533001767       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742533001550       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742533001361       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+01 is 8.922852e-06

solving harmonic davidson linear method for identity shift 8.4703e+01, overlap shift 8.4703e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742532179301       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742532337801       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742532380995       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742532384472       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742532385363       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742532385267       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742532385249       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742532385339       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742532385220       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742532385166       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742532385119       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+01 is 2.233778e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309078 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1404e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_001                -7.055678e-01 3 1  ON 0
ci_002                -7.029272e-01 3 1  ON 1
ci_003                -5.011380e-02 3 1  ON 2
ci_004                -5.098088e-02 3 1  ON 3
ci_005                 1.946810e-02 3 1  ON 4
ci_006                 1.975828e-02 3 1  ON 5
ci_007                 1.473309e-02 3 1  ON 6
ci_008                 1.549161e-02 3 1  ON 7
ci_009                -1.315344e-02 3 1  ON 8
ci_010                -1.205429e-02 3 1  ON 9
ci_011                -9.848385e-03 3 1  ON 10
ci_012                -9.085915e-03 3 1  ON 11
ci_013                 8.364476e-03 3 1  ON 12
ci_014                 9.291441e-03 3 1  ON 13
ci_015                 9.491634e-03 3 1  ON 14
ci_016                 9.355295e-03 3 1  ON 15
ci_017                 8.493083e-03 3 1  ON 16
ci_018                 8.266556e-03 3 1  ON 17
ci_019                -1.267259e-03 3 1  ON 18
ci_020                -1.585033e-03 3 1  ON 19
ci_021                -1.182242e-02 3 1  ON 20
ci_022                -1.183570e-02 3 1  ON 21
ci_023                 4.842380e-03 3 1  ON 22
ci_024                 4.911004e-03 3 1  ON 23
ci_025                 1.153080e-02 3 1  ON 24
ci_026                 1.153437e-02 3 1  ON 25
ci_027                 6.474929e-03 3 1  ON 26
ci_028                 6.175306e-03 3 1  ON 27
ci_029                -5.030402e-03 3 1  ON 28
ci_030                -4.115094e-03 3 1  ON 29
ci_031                 3.420315e-03 3 1  ON 30
ci_032                 4.669157e-03 3 1  ON 31
ci_033                 2.352778e-03 3 1  ON 32
ci_034                 4.108429e-03 3 1  ON 33
ci_035                 1.724571e-03 3 1  ON 34
ci_036                 2.138729e-03 3 1  ON 35
ci_037                 3.491582e-03 3 1  ON 36
ci_038                 3.699036e-03 3 1  ON 37
ci_039                 4.603247e-03 3 1  ON 38
ci_040                 4.919178e-03 3 1  ON 39
ci_041                 2.954948e-03 3 1  ON 40
ci_042                 2.735438e-03 3 1  ON 41
ci_043                 2.940445e-03 3 1  ON 42
ci_044                 3.206854e-03 3 1  ON 43
ci_045                 2.472124e-03 3 1  ON 44
ci_046                 2.734598e-03 3 1  ON 45
ci_047                -1.007831e-03 3 1  ON 46
ci_048                -8.467987e-04 3 1  ON 47
ci_049                 7.769463e-04 3 1  ON 48
ci_050                 9.949392e-04 3 1  ON 49
ci_051                -3.384111e-04 3 1  ON 50
ci_052                -1.211939e-03 3 1  ON 51
ci_053                -2.461588e-03 3 1  ON 52
ci_054                -2.685464e-03 3 1  ON 53
ci_055                -1.790883e-03 3 1  ON 54
ci_056                -1.961343e-03 3 1  ON 55
ci_057                -1.319666e-03 3 1  ON 56
ci_058                -9.963320e-04 3 1  ON 57
ci_059                -5.218392e-04 3 1  ON 58
ci_060                -7.419495e-04 3 1  ON 59
ci_061                 5.249179e-06 3 1  ON 60
ci_062                -9.060049e-04 3 1  ON 61
ci_063                -8.882390e-04 3 1  ON 62
ci_064                -5.060735e-04 3 1  ON 63
ci_065                -1.368267e-03 3 1  ON 64
ci_066                -1.880691e-03 3 1  ON 65
ci_067                -1.824408e-03 3 1  ON 66
ci_068                -1.480088e-03 3 1  ON 67
ci_069                -5.519628e-04 3 1  ON 68
ci_070                -4.195768e-04 3 1  ON 69
ci_071                -2.063236e-03 3 1  ON 70
ci_072                -1.988731e-03 3 1  ON 71
ci_073                 1.591887e-04 3 1  ON 72
ci_074                 1.749418e-04 3 1  ON 73
ci_075                 1.690415e-04 3 1  ON 74
ci_076                 7.904977e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.6561
    reference variance = 0.336764
====================================================
  Execution time = 2.5070e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5053e-01
  Total weights = 1.9550e+06
  Execution time = 3.5996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436608291994
                                         uncertainty =       0.001961811850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436608291994
                                         uncertainty =       0.001961811850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467249510
  error estimate for blocks of size 2^( 2) =       0.000490932627
  error estimate for blocks of size 2^( 3) =       0.000513527217
  error estimate for blocks of size 2^( 4) =       0.000529033113
  error estimate for blocks of size 2^( 5) =       0.000540001166
  error estimate for blocks of size 2^( 6) =       0.000544371954
  error estimate for blocks of size 2^( 7) =       0.000549198708

      target function =      -0.744871424175
              le_mean =     -22.661720148444
             les_mean =     514.004085703048
             stat err =       0.000540651235
             autocorr =       1.338864697456
   target nu stat err =       0.000540651235
   target dn stat err =       0.004317871525
      target stat err =       0.003585322755
              std dev =       0.660790593844
             le_variance =       0.436644208913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436599325101
                                         uncertainty =       0.001960389183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436599325101
                                         uncertainty =       0.001960389183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467244699
  error estimate for blocks of size 2^( 2) =       0.000490928687
  error estimate for blocks of size 2^( 3) =       0.000513524401
  error estimate for blocks of size 2^( 4) =       0.000529030896
  error estimate for blocks of size 2^( 5) =       0.000539998924
  error estimate for blocks of size 2^( 6) =       0.000544370373
  error estimate for blocks of size 2^( 7) =       0.000549196891

      target function =      -0.744868313501
              le_mean =     -22.661719889150
             les_mean =     514.004077721190
             stat err =       0.000540649271
             autocorr =       1.338882539167
   target nu stat err =       0.000540649271
   target dn stat err =       0.004320594065
      target stat err =       0.003587490113
              std dev =       0.660783789954
             le_variance =       0.436635217066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436603755606
                                         uncertainty =       0.001961095431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436603755606
                                         uncertainty =       0.001961095431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467247076
  error estimate for blocks of size 2^( 2) =       0.000490930632
  error estimate for blocks of size 2^( 3) =       0.000513525788
  error estimate for blocks of size 2^( 4) =       0.000529031986
  error estimate for blocks of size 2^( 5) =       0.000540000026
  error estimate for blocks of size 2^( 6) =       0.000544371147
  error estimate for blocks of size 2^( 7) =       0.000549197783

      target function =      -0.744870511513
              le_mean =     -22.661720015047
             les_mean =     514.004080757631
             stat err =       0.000540650236
             autocorr =       1.338873694354
   target nu stat err =       0.000540650236
   target dn stat err =       0.004319190923
      target stat err =       0.003586378700
              std dev =       0.660787151776
             le_variance =       0.436639659953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436607720982
                                         uncertainty =       0.001961722056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436607720982
                                         uncertainty =       0.001961722056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467249203
  error estimate for blocks of size 2^( 2) =       0.000490932376
  error estimate for blocks of size 2^( 3) =       0.000513527037
  error estimate for blocks of size 2^( 4) =       0.000529032971
  error estimate for blocks of size 2^( 5) =       0.000540001022
  error estimate for blocks of size 2^( 6) =       0.000544371851
  error estimate for blocks of size 2^( 7) =       0.000549198591

      target function =      -0.744871384521
              le_mean =     -22.661720131406
             les_mean =     514.004084977553
             stat err =       0.000540651109
             autocorr =       1.338865825924
   target nu stat err =       0.000540651109
   target dn stat err =       0.004318030812
      target stat err =       0.003585450900
              std dev =       0.660790160585
             le_variance =       0.436643636326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744871424175        initial  <--
     5.2940e+00     5.2940e+01             3.5497e-05        -0.744868313501
     2.1176e+01     2.1176e+02             8.9229e-06        -0.744870511513
     8.4703e+01     8.4703e+02             2.2338e-06        -0.744871384521

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1240
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_001                -7.055657e-01 3 1  ON 0
ci_002                -7.029284e-01 3 1  ON 1
ci_003                -5.011491e-02 3 1  ON 2
ci_004                -5.098467e-02 3 1  ON 3
ci_005                 1.947138e-02 3 1  ON 4
ci_006                 1.976148e-02 3 1  ON 5
ci_007                 1.473399e-02 3 1  ON 6
ci_008                 1.549453e-02 3 1  ON 7
ci_009                -1.315738e-02 3 1  ON 8
ci_010                -1.205464e-02 3 1  ON 9
ci_011                -9.849358e-03 3 1  ON 10
ci_012                -9.085371e-03 3 1  ON 11
ci_013                 8.366343e-03 3 1  ON 12
ci_014                 9.298749e-03 3 1  ON 13
ci_015                 9.500557e-03 3 1  ON 14
ci_016                 9.362335e-03 3 1  ON 15
ci_017                 8.491095e-03 3 1  ON 16
ci_018                 8.266443e-03 3 1  ON 17
ci_019                -1.261870e-03 3 1  ON 18
ci_020                -1.584503e-03 3 1  ON 19
ci_021                -1.181869e-02 3 1  ON 20
ci_022                -1.183427e-02 3 1  ON 21
ci_023                 4.842779e-03 3 1  ON 22
ci_024                 4.910927e-03 3 1  ON 23
ci_025                 1.152773e-02 3 1  ON 24
ci_026                 1.152940e-02 3 1  ON 25
ci_027                 6.477281e-03 3 1  ON 26
ci_028                 6.177250e-03 3 1  ON 27
ci_029                -5.032990e-03 3 1  ON 28
ci_030                -4.115393e-03 3 1  ON 29
ci_031                 3.412856e-03 3 1  ON 30
ci_032                 4.669723e-03 3 1  ON 31
ci_033                 2.349563e-03 3 1  ON 32
ci_034                 4.108533e-03 3 1  ON 33
ci_035                 1.724017e-03 3 1  ON 34
ci_036                 2.137539e-03 3 1  ON 35
ci_037                 3.493293e-03 3 1  ON 36
ci_038                 3.700854e-03 3 1  ON 37
ci_039                 4.602595e-03 3 1  ON 38
ci_040                 4.921099e-03 3 1  ON 39
ci_041                 2.955560e-03 3 1  ON 40
ci_042                 2.734291e-03 3 1  ON 41
ci_043                 2.939004e-03 3 1  ON 42
ci_044                 3.206684e-03 3 1  ON 43
ci_045                 2.473959e-03 3 1  ON 44
ci_046                 2.735525e-03 3 1  ON 45
ci_047                -1.006623e-03 3 1  ON 46
ci_048                -8.448552e-04 3 1  ON 47
ci_049                 7.813846e-04 3 1  ON 48
ci_050                 9.955154e-04 3 1  ON 49
ci_051                -3.363054e-04 3 1  ON 50
ci_052                -1.212251e-03 3 1  ON 51
ci_053                -2.460297e-03 3 1  ON 52
ci_054                -2.689027e-03 3 1  ON 53
ci_055                -1.790651e-03 3 1  ON 54
ci_056                -1.964823e-03 3 1  ON 55
ci_057                -1.320557e-03 3 1  ON 56
ci_058                -9.969501e-04 3 1  ON 57
ci_059                -5.221109e-04 3 1  ON 58
ci_060                -7.418104e-04 3 1  ON 59
ci_061                 6.215182e-06 3 1  ON 60
ci_062                -9.079337e-04 3 1  ON 61
ci_063                -8.886841e-04 3 1  ON 62
ci_064                -5.033481e-04 3 1  ON 63
ci_065                -1.365686e-03 3 1  ON 64
ci_066                -1.881962e-03 3 1  ON 65
ci_067                -1.824247e-03 3 1  ON 66
ci_068                -1.480694e-03 3 1  ON 67
ci_069                -5.507793e-04 3 1  ON 68
ci_070                -4.208759e-04 3 1  ON 69
ci_071                -2.065049e-03 3 1  ON 70
ci_072                -1.992319e-03 3 1  ON 71
ci_073                 1.592317e-04 3 1  ON 72
ci_074                 1.767804e-04 3 1  ON 73
ci_075                 1.715833e-04 3 1  ON 74
ci_076                 7.921861e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4545e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.6937
    reference variance = 0.519789
====================================================
  Execution time = 2.7824e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4944e-01
  Total weights = 1.955189221e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441274601205
                                         uncertainty =       0.002343219417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441274601205
                                         uncertainty =       0.002343219417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469687353
  error estimate for blocks of size 2^( 2) =       0.000493903834
  error estimate for blocks of size 2^( 3) =       0.000516195619
  error estimate for blocks of size 2^( 4) =       0.000532150935
  error estimate for blocks of size 2^( 5) =       0.000542086865
  error estimate for blocks of size 2^( 6) =       0.000547741543
  error estimate for blocks of size 2^( 7) =       0.000549431641

      target function =      -0.745790264345
              le_mean =     -22.663320727400
             les_mean =     514.075544950119
             stat err =       0.000542852746
             autocorr =       1.335815088449
   target nu stat err =       0.000542852746
   target dn stat err =       0.002551924669
      target stat err =       0.002183491823
              std dev =       0.664238225160
             le_variance =       0.441212419764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266332072740e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+01, overlap shift 5.2940e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745795741772       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745796018767       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745796045889       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745796047056       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745796047448       residual = 7.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745796047661       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745796047468       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745796047539       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745796047509       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+01 is 3.137426e-06

solving harmonic davidson linear method for identity shift 2.1176e+02, overlap shift 2.1176e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745795741772       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745795811066       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745795817849       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745795818140       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745795818238       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745795818291       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745795818243       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745795818260       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745795818253       residual = 1.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+02 is 7.847732e-07

solving harmonic davidson linear method for identity shift 8.4703e+02, overlap shift 8.4703e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745795741772       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745795759099       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745795760794       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745795760868       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745795760891       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745795760905       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745795760891       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745795760898       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745795760896       residual = 1.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+02 is 1.962194e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2523e+01
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_001                -7.055657e-01 3 1  ON 0
ci_002                -7.029285e-01 3 1  ON 1
ci_003                -5.011518e-02 3 1  ON 2
ci_004                -5.098434e-02 3 1  ON 3
ci_005                 1.947130e-02 3 1  ON 4
ci_006                 1.976116e-02 3 1  ON 5
ci_007                 1.473407e-02 3 1  ON 6
ci_008                 1.549456e-02 3 1  ON 7
ci_009                -1.315695e-02 3 1  ON 8
ci_010                -1.205446e-02 3 1  ON 9
ci_011                -9.848729e-03 3 1  ON 10
ci_012                -9.085468e-03 3 1  ON 11
ci_013                 8.366463e-03 3 1  ON 12
ci_014                 9.298472e-03 3 1  ON 13
ci_015                 9.500551e-03 3 1  ON 14
ci_016                 9.362226e-03 3 1  ON 15
ci_017                 8.490902e-03 3 1  ON 16
ci_018                 8.265756e-03 3 1  ON 17
ci_019                -1.262655e-03 3 1  ON 18
ci_020                -1.584883e-03 3 1  ON 19
ci_021                -1.181885e-02 3 1  ON 20
ci_022                -1.183502e-02 3 1  ON 21
ci_023                 4.842729e-03 3 1  ON 22
ci_024                 4.911122e-03 3 1  ON 23
ci_025                 1.152823e-02 3 1  ON 24
ci_026                 1.152939e-02 3 1  ON 25
ci_027                 6.477220e-03 3 1  ON 26
ci_028                 6.177195e-03 3 1  ON 27
ci_029                -5.032419e-03 3 1  ON 28
ci_030                -4.115124e-03 3 1  ON 29
ci_031                 3.413573e-03 3 1  ON 30
ci_032                 4.669948e-03 3 1  ON 31
ci_033                 2.349568e-03 3 1  ON 32
ci_034                 4.108386e-03 3 1  ON 33
ci_035                 1.723946e-03 3 1  ON 34
ci_036                 2.137318e-03 3 1  ON 35
ci_037                 3.493220e-03 3 1  ON 36
ci_038                 3.700906e-03 3 1  ON 37
ci_039                 4.602547e-03 3 1  ON 38
ci_040                 4.921101e-03 3 1  ON 39
ci_041                 2.955271e-03 3 1  ON 40
ci_042                 2.734158e-03 3 1  ON 41
ci_043                 2.939289e-03 3 1  ON 42
ci_044                 3.206769e-03 3 1  ON 43
ci_045                 2.473967e-03 3 1  ON 44
ci_046                 2.735621e-03 3 1  ON 45
ci_047                -1.006688e-03 3 1  ON 46
ci_048                -8.448806e-04 3 1  ON 47
ci_049                 7.817494e-04 3 1  ON 48
ci_050                 9.956591e-04 3 1  ON 49
ci_051                -3.362268e-04 3 1  ON 50
ci_052                -1.212535e-03 3 1  ON 51
ci_053                -2.460027e-03 3 1  ON 52
ci_054                -2.689020e-03 3 1  ON 53
ci_055                -1.790461e-03 3 1  ON 54
ci_056                -1.964692e-03 3 1  ON 55
ci_057                -1.320401e-03 3 1  ON 56
ci_058                -9.970536e-04 3 1  ON 57
ci_059                -5.221959e-04 3 1  ON 58
ci_060                -7.418662e-04 3 1  ON 59
ci_061                 6.214627e-06 3 1  ON 60
ci_062                -9.077915e-04 3 1  ON 61
ci_063                -8.888505e-04 3 1  ON 62
ci_064                -5.032411e-04 3 1  ON 63
ci_065                -1.365138e-03 3 1  ON 64
ci_066                -1.882123e-03 3 1  ON 65
ci_067                -1.824256e-03 3 1  ON 66
ci_068                -1.480466e-03 3 1  ON 67
ci_069                -5.505939e-04 3 1  ON 68
ci_070                -4.207860e-04 3 1  ON 69
ci_071                -2.065062e-03 3 1  ON 70
ci_072                -1.992374e-03 3 1  ON 71
ci_073                 1.592084e-04 3 1  ON 72
ci_074                 1.766286e-04 3 1  ON 73
ci_075                 1.718664e-04 3 1  ON 74
ci_076                 7.919653e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.7932
    reference variance = 0.832631
====================================================
  Execution time = 2.5130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5001e-01
  Total weights = 1.9551e+06
  Execution time = 3.6117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440819221305
                                         uncertainty =       0.002163217828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440819221305
                                         uncertainty =       0.002163217828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469522361
  error estimate for blocks of size 2^( 2) =       0.000493875423
  error estimate for blocks of size 2^( 3) =       0.000515995853
  error estimate for blocks of size 2^( 4) =       0.000531685755
  error estimate for blocks of size 2^( 5) =       0.000542187539
  error estimate for blocks of size 2^( 6) =       0.000547009870
  error estimate for blocks of size 2^( 7) =       0.000551550598

      target function =      -0.745296822494
              le_mean =     -22.661297847123
             les_mean =     513.984433303045
             stat err =       0.000543108441
             autocorr =       1.338013649099
   target nu stat err =       0.000543108441
   target dn stat err =       0.002703353702
      target stat err =       0.002293830398
              std dev =       0.664004891087
             le_variance =       0.440902495388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440818504757
                                         uncertainty =       0.002163168561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440818504757
                                         uncertainty =       0.002163168561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469521978
  error estimate for blocks of size 2^( 2) =       0.000493875098
  error estimate for blocks of size 2^( 3) =       0.000515995558
  error estimate for blocks of size 2^( 4) =       0.000531685471
  error estimate for blocks of size 2^( 5) =       0.000542187277
  error estimate for blocks of size 2^( 6) =       0.000547009515
  error estimate for blocks of size 2^( 7) =       0.000551550178

      target function =      -0.745295528449
              le_mean =     -22.661297860543
             les_mean =     513.984435491605
             stat err =       0.000543108110
             autocorr =       1.338014203985
   target nu stat err =       0.000543108110
   target dn stat err =       0.002703250554
      target stat err =       0.002293741057
              std dev =       0.664004349138
             le_variance =       0.440901775674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440818862630
                                         uncertainty =       0.002163193174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440818862630
                                         uncertainty =       0.002163193174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469522169
  error estimate for blocks of size 2^( 2) =       0.000493875260
  error estimate for blocks of size 2^( 3) =       0.000515995705
  error estimate for blocks of size 2^( 4) =       0.000531685613
  error estimate for blocks of size 2^( 5) =       0.000542187408
  error estimate for blocks of size 2^( 6) =       0.000547009693
  error estimate for blocks of size 2^( 7) =       0.000551550388

      target function =      -0.745296204433
              le_mean =     -22.661297853808
             les_mean =     513.984434360864
             stat err =       0.000543108275
             autocorr =       1.338013926808
   target nu stat err =       0.000543108275
   target dn stat err =       0.002703301714
      target stat err =       0.002293785572
              std dev =       0.664004619810
             le_variance =       0.440902135129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440819176442
                                         uncertainty =       0.002163214745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440819176442
                                         uncertainty =       0.002163214745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469522337
  error estimate for blocks of size 2^( 2) =       0.000493875403
  error estimate for blocks of size 2^( 3) =       0.000515995834
  error estimate for blocks of size 2^( 4) =       0.000531685738
  error estimate for blocks of size 2^( 5) =       0.000542187523
  error estimate for blocks of size 2^( 6) =       0.000547009848
  error estimate for blocks of size 2^( 7) =       0.000551550571

      target function =      -0.745296748302
              le_mean =     -22.661297847956
             les_mean =     513.984433431397
             stat err =       0.000543108420
             autocorr =       1.338013683834
   target nu stat err =       0.000543108420
   target dn stat err =       0.002703347163
      target stat err =       0.002293824780
              std dev =       0.664004857156
             le_variance =       0.440902450327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745296822494        initial  <--
     5.2940e+01     5.2940e+02             3.1374e-06        -0.745295528449
     2.1176e+02     2.1176e+03             7.8477e-07        -0.745296204433
     8.4703e+02     8.4703e+03             1.9622e-07        -0.745296748302

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.1309
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_001                -7.055657e-01 3 1  ON 0
ci_002                -7.029284e-01 3 1  ON 1
ci_003                -5.011491e-02 3 1  ON 2
ci_004                -5.098467e-02 3 1  ON 3
ci_005                 1.947138e-02 3 1  ON 4
ci_006                 1.976148e-02 3 1  ON 5
ci_007                 1.473399e-02 3 1  ON 6
ci_008                 1.549453e-02 3 1  ON 7
ci_009                -1.315738e-02 3 1  ON 8
ci_010                -1.205464e-02 3 1  ON 9
ci_011                -9.849358e-03 3 1  ON 10
ci_012                -9.085371e-03 3 1  ON 11
ci_013                 8.366343e-03 3 1  ON 12
ci_014                 9.298749e-03 3 1  ON 13
ci_015                 9.500557e-03 3 1  ON 14
ci_016                 9.362335e-03 3 1  ON 15
ci_017                 8.491095e-03 3 1  ON 16
ci_018                 8.266443e-03 3 1  ON 17
ci_019                -1.261870e-03 3 1  ON 18
ci_020                -1.584503e-03 3 1  ON 19
ci_021                -1.181869e-02 3 1  ON 20
ci_022                -1.183427e-02 3 1  ON 21
ci_023                 4.842779e-03 3 1  ON 22
ci_024                 4.910927e-03 3 1  ON 23
ci_025                 1.152773e-02 3 1  ON 24
ci_026                 1.152940e-02 3 1  ON 25
ci_027                 6.477281e-03 3 1  ON 26
ci_028                 6.177250e-03 3 1  ON 27
ci_029                -5.032990e-03 3 1  ON 28
ci_030                -4.115393e-03 3 1  ON 29
ci_031                 3.412856e-03 3 1  ON 30
ci_032                 4.669723e-03 3 1  ON 31
ci_033                 2.349563e-03 3 1  ON 32
ci_034                 4.108533e-03 3 1  ON 33
ci_035                 1.724017e-03 3 1  ON 34
ci_036                 2.137539e-03 3 1  ON 35
ci_037                 3.493293e-03 3 1  ON 36
ci_038                 3.700854e-03 3 1  ON 37
ci_039                 4.602595e-03 3 1  ON 38
ci_040                 4.921099e-03 3 1  ON 39
ci_041                 2.955560e-03 3 1  ON 40
ci_042                 2.734291e-03 3 1  ON 41
ci_043                 2.939004e-03 3 1  ON 42
ci_044                 3.206684e-03 3 1  ON 43
ci_045                 2.473959e-03 3 1  ON 44
ci_046                 2.735525e-03 3 1  ON 45
ci_047                -1.006623e-03 3 1  ON 46
ci_048                -8.448552e-04 3 1  ON 47
ci_049                 7.813846e-04 3 1  ON 48
ci_050                 9.955154e-04 3 1  ON 49
ci_051                -3.363054e-04 3 1  ON 50
ci_052                -1.212251e-03 3 1  ON 51
ci_053                -2.460297e-03 3 1  ON 52
ci_054                -2.689027e-03 3 1  ON 53
ci_055                -1.790651e-03 3 1  ON 54
ci_056                -1.964823e-03 3 1  ON 55
ci_057                -1.320557e-03 3 1  ON 56
ci_058                -9.969501e-04 3 1  ON 57
ci_059                -5.221109e-04 3 1  ON 58
ci_060                -7.418104e-04 3 1  ON 59
ci_061                 6.215182e-06 3 1  ON 60
ci_062                -9.079337e-04 3 1  ON 61
ci_063                -8.886841e-04 3 1  ON 62
ci_064                -5.033481e-04 3 1  ON 63
ci_065                -1.365686e-03 3 1  ON 64
ci_066                -1.881962e-03 3 1  ON 65
ci_067                -1.824247e-03 3 1  ON 66
ci_068                -1.480694e-03 3 1  ON 67
ci_069                -5.507793e-04 3 1  ON 68
ci_070                -4.208759e-04 3 1  ON 69
ci_071                -2.065049e-03 3 1  ON 70
ci_072                -1.992319e-03 3 1  ON 71
ci_073                 1.592317e-04 3 1  ON 72
ci_074                 1.767804e-04 3 1  ON 73
ci_075                 1.715833e-04 3 1  ON 74
ci_076                 7.921861e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7706e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.817
    reference variance = 0.400603
====================================================
  Execution time = 2.6294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5298e-01
  Total weights = 1.954947050e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441824396213
                                         uncertainty =       0.002224534838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441824396213
                                         uncertainty =       0.002224534838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470032861
  error estimate for blocks of size 2^( 2) =       0.000494106641
  error estimate for blocks of size 2^( 3) =       0.000516375686
  error estimate for blocks of size 2^( 4) =       0.000531033166
  error estimate for blocks of size 2^( 5) =       0.000540033431
  error estimate for blocks of size 2^( 6) =       0.000547322529
  error estimate for blocks of size 2^( 7) =       0.000550813861

      target function =      -0.742866009448
              le_mean =     -22.662513368927
             les_mean =     514.042491743250
             stat err =       0.000542300747
             autocorr =       1.331140695805
   target nu stat err =       0.000542300747
   target dn stat err =       0.005108557989
      target stat err =       0.004207910490
              std dev =       0.664726847394
             le_variance =       0.441861781647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266251336893e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+02, overlap shift 5.2940e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742889092586       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742889138627       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742889145575       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742889146268       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742889146950       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742889147692       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742889147807       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742889147789       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742889147934       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742889147966       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742889147935       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+02 is 5.475204e-07

solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742889092586       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742889104097       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742889105834       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742889106008       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742889106177       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742889106367       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742889106392       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742889106388       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742889106422       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742889106435       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742889106424       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+03 is 1.368881e-07

solving harmonic davidson linear method for identity shift 8.4703e+03, overlap shift 8.4703e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742889092586       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742889095464       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742889095898       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742889095942       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742889095983       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742889096020       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742889096050       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742889096026       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742889096039       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742889096032       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742889096026       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+03 is 3.422254e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.316385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1033e+01
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_001                -7.055658e-01 3 1  ON 0
ci_002                -7.029283e-01 3 1  ON 1
ci_003                -5.011497e-02 3 1  ON 2
ci_004                -5.098473e-02 3 1  ON 3
ci_005                 1.947136e-02 3 1  ON 4
ci_006                 1.976142e-02 3 1  ON 5
ci_007                 1.473397e-02 3 1  ON 6
ci_008                 1.549447e-02 3 1  ON 7
ci_009                -1.315733e-02 3 1  ON 8
ci_010                -1.205472e-02 3 1  ON 9
ci_011                -9.849321e-03 3 1  ON 10
ci_012                -9.085402e-03 3 1  ON 11
ci_013                 8.366324e-03 3 1  ON 12
ci_014                 9.298728e-03 3 1  ON 13
ci_015                 9.500496e-03 3 1  ON 14
ci_016                 9.362344e-03 3 1  ON 15
ci_017                 8.491051e-03 3 1  ON 16
ci_018                 8.266428e-03 3 1  ON 17
ci_019                -1.261936e-03 3 1  ON 18
ci_020                -1.584563e-03 3 1  ON 19
ci_021                -1.181870e-02 3 1  ON 20
ci_022                -1.183440e-02 3 1  ON 21
ci_023                 4.842768e-03 3 1  ON 22
ci_024                 4.910919e-03 3 1  ON 23
ci_025                 1.152776e-02 3 1  ON 24
ci_026                 1.152945e-02 3 1  ON 25
ci_027                 6.477271e-03 3 1  ON 26
ci_028                 6.177284e-03 3 1  ON 27
ci_029                -5.032946e-03 3 1  ON 28
ci_030                -4.115381e-03 3 1  ON 29
ci_031                 3.412906e-03 3 1  ON 30
ci_032                 4.669727e-03 3 1  ON 31
ci_033                 2.349536e-03 3 1  ON 32
ci_034                 4.108525e-03 3 1  ON 33
ci_035                 1.724030e-03 3 1  ON 34
ci_036                 2.137528e-03 3 1  ON 35
ci_037                 3.493288e-03 3 1  ON 36
ci_038                 3.700844e-03 3 1  ON 37
ci_039                 4.602606e-03 3 1  ON 38
ci_040                 4.921072e-03 3 1  ON 39
ci_041                 2.955580e-03 3 1  ON 40
ci_042                 2.734284e-03 3 1  ON 41
ci_043                 2.938991e-03 3 1  ON 42
ci_044                 3.206671e-03 3 1  ON 43
ci_045                 2.473948e-03 3 1  ON 44
ci_046                 2.735540e-03 3 1  ON 45
ci_047                -1.006607e-03 3 1  ON 46
ci_048                -8.448746e-04 3 1  ON 47
ci_049                 7.813428e-04 3 1  ON 48
ci_050                 9.955143e-04 3 1  ON 49
ci_051                -3.363200e-04 3 1  ON 50
ci_052                -1.212234e-03 3 1  ON 51
ci_053                -2.460312e-03 3 1  ON 52
ci_054                -2.689005e-03 3 1  ON 53
ci_055                -1.790655e-03 3 1  ON 54
ci_056                -1.964859e-03 3 1  ON 55
ci_057                -1.320538e-03 3 1  ON 56
ci_058                -9.969243e-04 3 1  ON 57
ci_059                -5.221141e-04 3 1  ON 58
ci_060                -7.417800e-04 3 1  ON 59
ci_061                 6.230654e-06 3 1  ON 60
ci_062                -9.079249e-04 3 1  ON 61
ci_063                -8.886883e-04 3 1  ON 62
ci_064                -5.033672e-04 3 1  ON 63
ci_065                -1.365695e-03 3 1  ON 64
ci_066                -1.881973e-03 3 1  ON 65
ci_067                -1.824253e-03 3 1  ON 66
ci_068                -1.480713e-03 3 1  ON 67
ci_069                -5.508019e-04 3 1  ON 68
ci_070                -4.208700e-04 3 1  ON 69
ci_071                -2.065051e-03 3 1  ON 70
ci_072                -1.992290e-03 3 1  ON 71
ci_073                 1.592203e-04 3 1  ON 72
ci_074                 1.767754e-04 3 1  ON 73
ci_075                 1.715916e-04 3 1  ON 74
ci_076                 7.921424e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.6234
    reference variance = 0.932338
====================================================
  Execution time = 2.5392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4677e-01
  Total weights = 1.9551e+06
  Execution time = 3.6253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438658700117
                                         uncertainty =       0.001740188042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438658700117
                                         uncertainty =       0.001740188042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468306320
  error estimate for blocks of size 2^( 2) =       0.000492099179
  error estimate for blocks of size 2^( 3) =       0.000514239613
  error estimate for blocks of size 2^( 4) =       0.000530358474
  error estimate for blocks of size 2^( 5) =       0.000539703568
  error estimate for blocks of size 2^( 6) =       0.000545507815
  error estimate for blocks of size 2^( 7) =       0.000550611856

      target function =      -0.747976244921
              le_mean =     -22.661864104914
             les_mean =     514.006851881951
             stat err =       0.000541545428
             autocorr =       1.337241205593
   target nu stat err =       0.000541545428
   target dn stat err =       0.002255364644
      target stat err =       0.001956233745
              std dev =       0.662285148840
             le_variance =       0.438621618374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438658596877
                                         uncertainty =       0.001740182559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438658596877
                                         uncertainty =       0.001740182559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468306265
  error estimate for blocks of size 2^( 2) =       0.000492099130
  error estimate for blocks of size 2^( 3) =       0.000514239566
  error estimate for blocks of size 2^( 4) =       0.000530358427
  error estimate for blocks of size 2^( 5) =       0.000539703515
  error estimate for blocks of size 2^( 6) =       0.000545507756
  error estimate for blocks of size 2^( 7) =       0.000550611817

      target function =      -0.747976759110
              le_mean =     -22.661864105496
             les_mean =     514.006851285831
             stat err =       0.000541545379
             autocorr =       1.337241276285
   target nu stat err =       0.000541545379
   target dn stat err =       0.002255337493
      target stat err =       0.001956214944
              std dev =       0.662285070797
             le_variance =       0.438621515000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438658648486
                                         uncertainty =       0.001740185300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438658648486
                                         uncertainty =       0.001740185300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468306292
  error estimate for blocks of size 2^( 2) =       0.000492099155
  error estimate for blocks of size 2^( 3) =       0.000514239590
  error estimate for blocks of size 2^( 4) =       0.000530358450
  error estimate for blocks of size 2^( 5) =       0.000539703541
  error estimate for blocks of size 2^( 6) =       0.000545507786
  error estimate for blocks of size 2^( 7) =       0.000550611837

      target function =      -0.747976502407
              le_mean =     -22.661864105204
             les_mean =     514.006851583390
             stat err =       0.000541545404
             autocorr =       1.337241240951
   target nu stat err =       0.000541545404
   target dn stat err =       0.002255351056
      target stat err =       0.001956224336
              std dev =       0.662285109810
             le_variance =       0.438621566676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438658693662
                                         uncertainty =       0.001740187699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438658693662
                                         uncertainty =       0.001740187699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468306316
  error estimate for blocks of size 2^( 2) =       0.000492099176
  error estimate for blocks of size 2^( 3) =       0.000514239610
  error estimate for blocks of size 2^( 4) =       0.000530358471
  error estimate for blocks of size 2^( 5) =       0.000539703564
  error estimate for blocks of size 2^( 6) =       0.000545507811
  error estimate for blocks of size 2^( 7) =       0.000550611854

      target function =      -0.747976277148
              le_mean =     -22.661864104950
             les_mean =     514.006851844577
             stat err =       0.000541545425
             autocorr =       1.337241210013
   target nu stat err =       0.000541545425
   target dn stat err =       0.002255362944
      target stat err =       0.001956232568
              std dev =       0.662285143960
             le_variance =       0.438621611911


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747976244921        initial
     5.2940e+02     5.2940e+03             5.4752e-07        -0.747976759110  <--
     2.1176e+03     2.1176e+04             1.3689e-07        -0.747976502407
     8.4703e+03     8.4703e+04             3.4223e-08        -0.747976277148

*****************************************************************************
Applying the update for shift_i =   5.2940e+02     and shift_s =   5.2940e+03
*****************************************************************************

  Execution time = 4.3575e+01
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_001                -7.055661e-01 3 1  ON 0
ci_002                -7.029280e-01 3 1  ON 1
ci_003                -5.011516e-02 3 1  ON 2
ci_004                -5.098494e-02 3 1  ON 3
ci_005                 1.947131e-02 3 1  ON 4
ci_006                 1.976126e-02 3 1  ON 5
ci_007                 1.473394e-02 3 1  ON 6
ci_008                 1.549430e-02 3 1  ON 7
ci_009                -1.315719e-02 3 1  ON 8
ci_010                -1.205496e-02 3 1  ON 9
ci_011                -9.849208e-03 3 1  ON 10
ci_012                -9.085496e-03 3 1  ON 11
ci_013                 8.366268e-03 3 1  ON 12
ci_014                 9.298666e-03 3 1  ON 13
ci_015                 9.500311e-03 3 1  ON 14
ci_016                 9.362370e-03 3 1  ON 15
ci_017                 8.490918e-03 3 1  ON 16
ci_018                 8.266384e-03 3 1  ON 17
ci_019                -1.262135e-03 3 1  ON 18
ci_020                -1.584743e-03 3 1  ON 19
ci_021                -1.181874e-02 3 1  ON 20
ci_022                -1.183482e-02 3 1  ON 21
ci_023                 4.842735e-03 3 1  ON 22
ci_024                 4.910896e-03 3 1  ON 23
ci_025                 1.152787e-02 3 1  ON 24
ci_026                 1.152958e-02 3 1  ON 25
ci_027                 6.477240e-03 3 1  ON 26
ci_028                 6.177387e-03 3 1  ON 27
ci_029                -5.032814e-03 3 1  ON 28
ci_030                -4.115345e-03 3 1  ON 29
ci_031                 3.413056e-03 3 1  ON 30
ci_032                 4.669737e-03 3 1  ON 31
ci_033                 2.349455e-03 3 1  ON 32
ci_034                 4.108502e-03 3 1  ON 33
ci_035                 1.724070e-03 3 1  ON 34
ci_036                 2.137494e-03 3 1  ON 35
ci_037                 3.493274e-03 3 1  ON 36
ci_038                 3.700814e-03 3 1  ON 37
ci_039                 4.602636e-03 3 1  ON 38
ci_040                 4.920992e-03 3 1  ON 39
ci_041                 2.955640e-03 3 1  ON 40
ci_042                 2.734263e-03 3 1  ON 41
ci_043                 2.938950e-03 3 1  ON 42
ci_044                 3.206633e-03 3 1  ON 43
ci_045                 2.473914e-03 3 1  ON 44
ci_046                 2.735586e-03 3 1  ON 45
ci_047                -1.006558e-03 3 1  ON 46
ci_048                -8.449327e-04 3 1  ON 47
ci_049                 7.812175e-04 3 1  ON 48
ci_050                 9.955111e-04 3 1  ON 49
ci_051                -3.363637e-04 3 1  ON 50
ci_052                -1.212183e-03 3 1  ON 51
ci_053                -2.460356e-03 3 1  ON 52
ci_054                -2.688939e-03 3 1  ON 53
ci_055                -1.790668e-03 3 1  ON 54
ci_056                -1.964970e-03 3 1  ON 55
ci_057                -1.320483e-03 3 1  ON 56
ci_058                -9.968470e-04 3 1  ON 57
ci_059                -5.221237e-04 3 1  ON 58
ci_060                -7.416887e-04 3 1  ON 59
ci_061                 6.277067e-06 3 1  ON 60
ci_062                -9.078986e-04 3 1  ON 61
ci_063                -8.887008e-04 3 1  ON 62
ci_064                -5.034246e-04 3 1  ON 63
ci_065                -1.365720e-03 3 1  ON 64
ci_066                -1.882007e-03 3 1  ON 65
ci_067                -1.824269e-03 3 1  ON 66
ci_068                -1.480770e-03 3 1  ON 67
ci_069                -5.508696e-04 3 1  ON 68
ci_070                -4.208523e-04 3 1  ON 69
ci_071                -2.065059e-03 3 1  ON 70
ci_072                -1.992200e-03 3 1  ON 71
ci_073                 1.591860e-04 3 1  ON 72
ci_074                 1.767604e-04 3 1  ON 73
ci_075                 1.716164e-04 3 1  ON 74
ci_076                 7.920115e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4645e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7808
    reference variance = 0.71599
====================================================
  Execution time = 2.6272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4918e-01
  Total weights = 1.955067680e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439363953728
                                         uncertainty =       0.001799818254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439363953728
                                         uncertainty =       0.001799818254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468737279
  error estimate for blocks of size 2^( 2) =       0.000492563755
  error estimate for blocks of size 2^( 3) =       0.000514103704
  error estimate for blocks of size 2^( 4) =       0.000530584788
  error estimate for blocks of size 2^( 5) =       0.000538969015
  error estimate for blocks of size 2^( 6) =       0.000542970536
  error estimate for blocks of size 2^( 7) =       0.000545001805

      target function =      -0.745991150094
              le_mean =     -22.662501325626
             les_mean =     514.038150332118
             stat err =       0.000539381536
             autocorr =       1.324137733753
   target nu stat err =       0.000539381536
   target dn stat err =       0.002638718516
      target stat err =       0.002249682035
              std dev =       0.662894617201
             le_variance =       0.439429273514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266250132563e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+02, overlap shift 1.3235e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745996956506       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745997071391       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745997094085       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745997095372       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745997095571       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745997096247       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745997096213       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745997096319       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745997096294       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745997096228       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745997096257       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+02 is 1.345302e-06

solving harmonic davidson linear method for identity shift 5.2940e+02, overlap shift 5.2940e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745996956506       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745996985235       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745996990910       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745996991231       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745996991281       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745996991453       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745996991441       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745996991468       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745996991462       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745996991447       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745996991453       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+02 is 3.363993e-07

solving harmonic davidson linear method for identity shift 2.1176e+03, overlap shift 2.1176e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745996956506       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745996963689       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745996965108       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745996965188       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745996965202       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745996965243       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745996965241       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745996965243       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745996965250       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745996965239       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745996965247       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+03 is 8.410446e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0965e+01
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_001                -7.055659e-01 3 1  ON 0
ci_002                -7.029283e-01 3 1  ON 1
ci_003                -5.011525e-02 3 1  ON 2
ci_004                -5.098495e-02 3 1  ON 3
ci_005                 1.947125e-02 3 1  ON 4
ci_006                 1.976108e-02 3 1  ON 5
ci_007                 1.473381e-02 3 1  ON 6
ci_008                 1.549427e-02 3 1  ON 7
ci_009                -1.315699e-02 3 1  ON 8
ci_010                -1.205488e-02 3 1  ON 9
ci_011                -9.849009e-03 3 1  ON 10
ci_012                -9.085436e-03 3 1  ON 11
ci_013                 8.366010e-03 3 1  ON 12
ci_014                 9.298504e-03 3 1  ON 13
ci_015                 9.500178e-03 3 1  ON 14
ci_016                 9.362305e-03 3 1  ON 15
ci_017                 8.490843e-03 3 1  ON 16
ci_018                 8.266283e-03 3 1  ON 17
ci_019                -1.262424e-03 3 1  ON 18
ci_020                -1.585049e-03 3 1  ON 19
ci_021                -1.181890e-02 3 1  ON 20
ci_022                -1.183515e-02 3 1  ON 21
ci_023                 4.842706e-03 3 1  ON 22
ci_024                 4.910944e-03 3 1  ON 23
ci_025                 1.152803e-02 3 1  ON 24
ci_026                 1.152978e-02 3 1  ON 25
ci_027                 6.477171e-03 3 1  ON 26
ci_028                 6.177401e-03 3 1  ON 27
ci_029                -5.032732e-03 3 1  ON 28
ci_030                -4.115162e-03 3 1  ON 29
ci_031                 3.413273e-03 3 1  ON 30
ci_032                 4.669908e-03 3 1  ON 31
ci_033                 2.349538e-03 3 1  ON 32
ci_034                 4.108431e-03 3 1  ON 33
ci_035                 1.724059e-03 3 1  ON 34
ci_036                 2.137436e-03 3 1  ON 35
ci_037                 3.493189e-03 3 1  ON 36
ci_038                 3.700831e-03 3 1  ON 37
ci_039                 4.602547e-03 3 1  ON 38
ci_040                 4.920959e-03 3 1  ON 39
ci_041                 2.955616e-03 3 1  ON 40
ci_042                 2.734242e-03 3 1  ON 41
ci_043                 2.938752e-03 3 1  ON 42
ci_044                 3.206605e-03 3 1  ON 43
ci_045                 2.473900e-03 3 1  ON 44
ci_046                 2.735576e-03 3 1  ON 45
ci_047                -1.006622e-03 3 1  ON 46
ci_048                -8.449642e-04 3 1  ON 47
ci_049                 7.813718e-04 3 1  ON 48
ci_050                 9.955144e-04 3 1  ON 49
ci_051                -3.364605e-04 3 1  ON 50
ci_052                -1.212305e-03 3 1  ON 51
ci_053                -2.460384e-03 3 1  ON 52
ci_054                -2.688965e-03 3 1  ON 53
ci_055                -1.790695e-03 3 1  ON 54
ci_056                -1.964699e-03 3 1  ON 55
ci_057                -1.320479e-03 3 1  ON 56
ci_058                -9.968328e-04 3 1  ON 57
ci_059                -5.221836e-04 3 1  ON 58
ci_060                -7.416795e-04 3 1  ON 59
ci_061                 6.169789e-06 3 1  ON 60
ci_062                -9.079303e-04 3 1  ON 61
ci_063                -8.887608e-04 3 1  ON 62
ci_064                -5.034371e-04 3 1  ON 63
ci_065                -1.365743e-03 3 1  ON 64
ci_066                -1.881997e-03 3 1  ON 65
ci_067                -1.824229e-03 3 1  ON 66
ci_068                -1.480696e-03 3 1  ON 67
ci_069                -5.507558e-04 3 1  ON 68
ci_070                -4.208521e-04 3 1  ON 69
ci_071                -2.065035e-03 3 1  ON 70
ci_072                -1.992193e-03 3 1  ON 71
ci_073                 1.593161e-04 3 1  ON 72
ci_074                 1.766427e-04 3 1  ON 73
ci_075                 1.715577e-04 3 1  ON 74
ci_076                 7.920763e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.7188
    reference variance = 0.42115
====================================================
  Execution time = 2.5372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4959e-01
  Total weights = 1.9555e+06
  Execution time = 3.6121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439163636372
                                         uncertainty =       0.002032457792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439163636372
                                         uncertainty =       0.002032457792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468641980
  error estimate for blocks of size 2^( 2) =       0.000493061175
  error estimate for blocks of size 2^( 3) =       0.000515039831
  error estimate for blocks of size 2^( 4) =       0.000531228280
  error estimate for blocks of size 2^( 5) =       0.000541125016
  error estimate for blocks of size 2^( 6) =       0.000546336932
  error estimate for blocks of size 2^( 7) =       0.000549624986

      target function =      -0.745649712341
              le_mean =     -22.661526264434
             les_mean =     513.994357999236
             stat err =       0.000542078804
             autocorr =       1.337957974761
   target nu stat err =       0.000542078804
   target dn stat err =       0.002782731700
      target stat err =       0.002359352551
              std dev =       0.662759844500
             le_variance =       0.439250611482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439163382370
                                         uncertainty =       0.002032460073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439163382370
                                         uncertainty =       0.002032460073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468641854
  error estimate for blocks of size 2^( 2) =       0.000493061074
  error estimate for blocks of size 2^( 3) =       0.000515039754
  error estimate for blocks of size 2^( 4) =       0.000531228206
  error estimate for blocks of size 2^( 5) =       0.000541124938
  error estimate for blocks of size 2^( 6) =       0.000546336851
  error estimate for blocks of size 2^( 7) =       0.000549624979

      target function =      -0.745649332184
              le_mean =     -22.661526253567
             les_mean =     513.994357969077
             stat err =       0.000542078744
             autocorr =       1.337958399004
   target nu stat err =       0.000542078744
   target dn stat err =       0.002782876998
      target stat err =       0.002359465491
              std dev =       0.662759665990
             le_variance =       0.439250374863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439163509301
                                         uncertainty =       0.002032458932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439163509301
                                         uncertainty =       0.002032458932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468641917
  error estimate for blocks of size 2^( 2) =       0.000493061124
  error estimate for blocks of size 2^( 3) =       0.000515039793
  error estimate for blocks of size 2^( 4) =       0.000531228243
  error estimate for blocks of size 2^( 5) =       0.000541124977
  error estimate for blocks of size 2^( 6) =       0.000546336891
  error estimate for blocks of size 2^( 7) =       0.000549624983

      target function =      -0.745649530178
              le_mean =     -22.661526258994
             les_mean =     513.994357974197
             stat err =       0.000542078774
             autocorr =       1.337958186974
   target nu stat err =       0.000542078774
   target dn stat err =       0.002782804284
      target stat err =       0.002359409018
              std dev =       0.662759755193
             le_variance =       0.439250493104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439163620484
                                         uncertainty =       0.002032457935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439163620484
                                         uncertainty =       0.002032457935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468641972
  error estimate for blocks of size 2^( 2) =       0.000493061169
  error estimate for blocks of size 2^( 3) =       0.000515039826
  error estimate for blocks of size 2^( 4) =       0.000531228275
  error estimate for blocks of size 2^( 5) =       0.000541125011
  error estimate for blocks of size 2^( 6) =       0.000546336927
  error estimate for blocks of size 2^( 7) =       0.000549624986

      target function =      -0.745649690484
              le_mean =     -22.661526263753
             les_mean =     513.994357994963
             stat err =       0.000542078800
             autocorr =       1.337958001284
   target nu stat err =       0.000542078800
   target dn stat err =       0.002782740766
      target stat err =       0.002359359610
              std dev =       0.662759833333
             le_variance =       0.439250596679


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745649712341        initial  <--
     1.3235e+02     1.3235e+03             1.3453e-06        -0.745649332184
     5.2940e+02     5.2940e+03             3.3640e-07        -0.745649530178
     2.1176e+03     2.1176e+04             8.4104e-08        -0.745649690484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4956
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_001                -7.055661e-01 3 1  ON 0
ci_002                -7.029280e-01 3 1  ON 1
ci_003                -5.011516e-02 3 1  ON 2
ci_004                -5.098494e-02 3 1  ON 3
ci_005                 1.947131e-02 3 1  ON 4
ci_006                 1.976126e-02 3 1  ON 5
ci_007                 1.473394e-02 3 1  ON 6
ci_008                 1.549430e-02 3 1  ON 7
ci_009                -1.315719e-02 3 1  ON 8
ci_010                -1.205496e-02 3 1  ON 9
ci_011                -9.849208e-03 3 1  ON 10
ci_012                -9.085496e-03 3 1  ON 11
ci_013                 8.366268e-03 3 1  ON 12
ci_014                 9.298666e-03 3 1  ON 13
ci_015                 9.500311e-03 3 1  ON 14
ci_016                 9.362370e-03 3 1  ON 15
ci_017                 8.490918e-03 3 1  ON 16
ci_018                 8.266384e-03 3 1  ON 17
ci_019                -1.262135e-03 3 1  ON 18
ci_020                -1.584743e-03 3 1  ON 19
ci_021                -1.181874e-02 3 1  ON 20
ci_022                -1.183482e-02 3 1  ON 21
ci_023                 4.842735e-03 3 1  ON 22
ci_024                 4.910896e-03 3 1  ON 23
ci_025                 1.152787e-02 3 1  ON 24
ci_026                 1.152958e-02 3 1  ON 25
ci_027                 6.477240e-03 3 1  ON 26
ci_028                 6.177387e-03 3 1  ON 27
ci_029                -5.032814e-03 3 1  ON 28
ci_030                -4.115345e-03 3 1  ON 29
ci_031                 3.413056e-03 3 1  ON 30
ci_032                 4.669737e-03 3 1  ON 31
ci_033                 2.349455e-03 3 1  ON 32
ci_034                 4.108502e-03 3 1  ON 33
ci_035                 1.724070e-03 3 1  ON 34
ci_036                 2.137494e-03 3 1  ON 35
ci_037                 3.493274e-03 3 1  ON 36
ci_038                 3.700814e-03 3 1  ON 37
ci_039                 4.602636e-03 3 1  ON 38
ci_040                 4.920992e-03 3 1  ON 39
ci_041                 2.955640e-03 3 1  ON 40
ci_042                 2.734263e-03 3 1  ON 41
ci_043                 2.938950e-03 3 1  ON 42
ci_044                 3.206633e-03 3 1  ON 43
ci_045                 2.473914e-03 3 1  ON 44
ci_046                 2.735586e-03 3 1  ON 45
ci_047                -1.006558e-03 3 1  ON 46
ci_048                -8.449327e-04 3 1  ON 47
ci_049                 7.812175e-04 3 1  ON 48
ci_050                 9.955111e-04 3 1  ON 49
ci_051                -3.363637e-04 3 1  ON 50
ci_052                -1.212183e-03 3 1  ON 51
ci_053                -2.460356e-03 3 1  ON 52
ci_054                -2.688939e-03 3 1  ON 53
ci_055                -1.790668e-03 3 1  ON 54
ci_056                -1.964970e-03 3 1  ON 55
ci_057                -1.320483e-03 3 1  ON 56
ci_058                -9.968470e-04 3 1  ON 57
ci_059                -5.221237e-04 3 1  ON 58
ci_060                -7.416887e-04 3 1  ON 59
ci_061                 6.277067e-06 3 1  ON 60
ci_062                -9.078986e-04 3 1  ON 61
ci_063                -8.887008e-04 3 1  ON 62
ci_064                -5.034246e-04 3 1  ON 63
ci_065                -1.365720e-03 3 1  ON 64
ci_066                -1.882007e-03 3 1  ON 65
ci_067                -1.824269e-03 3 1  ON 66
ci_068                -1.480770e-03 3 1  ON 67
ci_069                -5.508696e-04 3 1  ON 68
ci_070                -4.208523e-04 3 1  ON 69
ci_071                -2.065059e-03 3 1  ON 70
ci_072                -1.992200e-03 3 1  ON 71
ci_073                 1.591860e-04 3 1  ON 72
ci_074                 1.767604e-04 3 1  ON 73
ci_075                 1.716164e-04 3 1  ON 74
ci_076                 7.920115e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7117
    reference variance = 0.455772
====================================================
  Execution time = 2.6347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5159e-01
  Total weights = 1.955488963e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442163220087
                                         uncertainty =       0.002414845888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442163220087
                                         uncertainty =       0.002414845888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470206134
  error estimate for blocks of size 2^( 2) =       0.000494591562
  error estimate for blocks of size 2^( 3) =       0.000516859097
  error estimate for blocks of size 2^( 4) =       0.000532141644
  error estimate for blocks of size 2^( 5) =       0.000540733874
  error estimate for blocks of size 2^( 6) =       0.000545480974
  error estimate for blocks of size 2^( 7) =       0.000549084429

      target function =      -0.743997128691
              le_mean =     -22.661153562792
             les_mean =     513.979474789152
             stat err =       0.000541860230
             autocorr =       1.327999689232
   target nu stat err =       0.000541860230
   target dn stat err =       0.003644327063
      target stat err =       0.003033492492
              std dev =       0.664971892014
             le_variance =       0.442187617168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266115356279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+03, overlap shift 1.3235e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744008556627       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744008579103       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744008583821       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744008584080       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744008584073       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744008584153       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744008584162       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744008584172       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744008584181       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+03 is 2.262767e-07

solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744008556627       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744008562247       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744008563426       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744008563491       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744008563487       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744008563513       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744008563510       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744008563514       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744008563511       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+03 is 5.657042e-08

solving harmonic davidson linear method for identity shift 2.1176e+04, overlap shift 2.1176e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744008556627       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744008558032       residual = 5.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744008558327       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744008558346       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744008558351       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744008558359       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744008558312       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744008558343       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744008558342       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+04 is 1.414268e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1034e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_001                -7.055661e-01 3 1  ON 0
ci_002                -7.029280e-01 3 1  ON 1
ci_003                -5.011519e-02 3 1  ON 2
ci_004                -5.098495e-02 3 1  ON 3
ci_005                 1.947130e-02 3 1  ON 4
ci_006                 1.976124e-02 3 1  ON 5
ci_007                 1.473393e-02 3 1  ON 6
ci_008                 1.549427e-02 3 1  ON 7
ci_009                -1.315718e-02 3 1  ON 8
ci_010                -1.205496e-02 3 1  ON 9
ci_011                -9.849192e-03 3 1  ON 10
ci_012                -9.085497e-03 3 1  ON 11
ci_013                 8.366268e-03 3 1  ON 12
ci_014                 9.298639e-03 3 1  ON 13
ci_015                 9.500292e-03 3 1  ON 14
ci_016                 9.362356e-03 3 1  ON 15
ci_017                 8.490886e-03 3 1  ON 16
ci_018                 8.266381e-03 3 1  ON 17
ci_019                -1.262175e-03 3 1  ON 18
ci_020                -1.584800e-03 3 1  ON 19
ci_021                -1.181875e-02 3 1  ON 20
ci_022                -1.183483e-02 3 1  ON 21
ci_023                 4.842740e-03 3 1  ON 22
ci_024                 4.910905e-03 3 1  ON 23
ci_025                 1.152789e-02 3 1  ON 24
ci_026                 1.152961e-02 3 1  ON 25
ci_027                 6.477218e-03 3 1  ON 26
ci_028                 6.177388e-03 3 1  ON 27
ci_029                -5.032812e-03 3 1  ON 28
ci_030                -4.115349e-03 3 1  ON 29
ci_031                 3.413095e-03 3 1  ON 30
ci_032                 4.669736e-03 3 1  ON 31
ci_033                 2.349466e-03 3 1  ON 32
ci_034                 4.108509e-03 3 1  ON 33
ci_035                 1.724078e-03 3 1  ON 34
ci_036                 2.137486e-03 3 1  ON 35
ci_037                 3.493261e-03 3 1  ON 36
ci_038                 3.700806e-03 3 1  ON 37
ci_039                 4.602635e-03 3 1  ON 38
ci_040                 4.920992e-03 3 1  ON 39
ci_041                 2.955634e-03 3 1  ON 40
ci_042                 2.734270e-03 3 1  ON 41
ci_043                 2.938964e-03 3 1  ON 42
ci_044                 3.206616e-03 3 1  ON 43
ci_045                 2.473915e-03 3 1  ON 44
ci_046                 2.735585e-03 3 1  ON 45
ci_047                -1.006550e-03 3 1  ON 46
ci_048                -8.449341e-04 3 1  ON 47
ci_049                 7.812168e-04 3 1  ON 48
ci_050                 9.955099e-04 3 1  ON 49
ci_051                -3.363578e-04 3 1  ON 50
ci_052                -1.212181e-03 3 1  ON 51
ci_053                -2.460386e-03 3 1  ON 52
ci_054                -2.688939e-03 3 1  ON 53
ci_055                -1.790699e-03 3 1  ON 54
ci_056                -1.964990e-03 3 1  ON 55
ci_057                -1.320472e-03 3 1  ON 56
ci_058                -9.968477e-04 3 1  ON 57
ci_059                -5.221160e-04 3 1  ON 58
ci_060                -7.416815e-04 3 1  ON 59
ci_061                 6.257991e-06 3 1  ON 60
ci_062                -9.078896e-04 3 1  ON 61
ci_063                -8.886929e-04 3 1  ON 62
ci_064                -5.034188e-04 3 1  ON 63
ci_065                -1.365721e-03 3 1  ON 64
ci_066                -1.881994e-03 3 1  ON 65
ci_067                -1.824294e-03 3 1  ON 66
ci_068                -1.480762e-03 3 1  ON 67
ci_069                -5.508444e-04 3 1  ON 68
ci_070                -4.208496e-04 3 1  ON 69
ci_071                -2.065061e-03 3 1  ON 70
ci_072                -1.992183e-03 3 1  ON 71
ci_073                 1.591890e-04 3 1  ON 72
ci_074                 1.767581e-04 3 1  ON 73
ci_075                 1.716001e-04 3 1  ON 74
ci_076                 7.920092e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.6619
    reference variance = 0.286422
====================================================
  Execution time = 2.5436e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4876e-01
  Total weights = 1.9553e+06
  Execution time = 3.5949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440148733701
                                         uncertainty =       0.002025368821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440148733701
                                         uncertainty =       0.002025368821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469124323
  error estimate for blocks of size 2^( 2) =       0.000493304517
  error estimate for blocks of size 2^( 3) =       0.000515185207
  error estimate for blocks of size 2^( 4) =       0.000530947965
  error estimate for blocks of size 2^( 5) =       0.000538738244
  error estimate for blocks of size 2^( 6) =       0.000542438510
  error estimate for blocks of size 2^( 7) =       0.000544292001

      target function =      -0.746340236167
              le_mean =     -22.662149322834
             les_mean =     514.021767767462
             stat err =       0.000539104180
             autocorr =       1.320594541232
   target nu stat err =       0.000539104180
   target dn stat err =       0.002426879046
      target stat err =       0.002082893698
              std dev =       0.663441979528
             le_variance =       0.440155260200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440148710835
                                         uncertainty =       0.002025369090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440148710835
                                         uncertainty =       0.002025369090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469124311
  error estimate for blocks of size 2^( 2) =       0.000493304507
  error estimate for blocks of size 2^( 3) =       0.000515185199
  error estimate for blocks of size 2^( 4) =       0.000530947956
  error estimate for blocks of size 2^( 5) =       0.000538738239
  error estimate for blocks of size 2^( 6) =       0.000542438504
  error estimate for blocks of size 2^( 7) =       0.000544291986

      target function =      -0.746340409531
              le_mean =     -22.662149323706
             les_mean =     514.021767596241
             stat err =       0.000539104171
             autocorr =       1.320594566038
   target nu stat err =       0.000539104171
   target dn stat err =       0.002426879589
      target stat err =       0.002082895055
              std dev =       0.663441962385
             le_variance =       0.440155237454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440148722267
                                         uncertainty =       0.002025368955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440148722267
                                         uncertainty =       0.002025368955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469124317
  error estimate for blocks of size 2^( 2) =       0.000493304512
  error estimate for blocks of size 2^( 3) =       0.000515185203
  error estimate for blocks of size 2^( 4) =       0.000530947960
  error estimate for blocks of size 2^( 5) =       0.000538738242
  error estimate for blocks of size 2^( 6) =       0.000542438507
  error estimate for blocks of size 2^( 7) =       0.000544291993

      target function =      -0.746340322973
              le_mean =     -22.662149323270
             les_mean =     514.021767681697
             stat err =       0.000539104176
             autocorr =       1.320594553628
   target nu stat err =       0.000539104176
   target dn stat err =       0.002426879314
      target stat err =       0.002082894374
              std dev =       0.663441970956
             le_variance =       0.440155248826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440148732272
                                         uncertainty =       0.002025368838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440148732272
                                         uncertainty =       0.002025368838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469124322
  error estimate for blocks of size 2^( 2) =       0.000493304516
  error estimate for blocks of size 2^( 3) =       0.000515185207
  error estimate for blocks of size 2^( 4) =       0.000530947964
  error estimate for blocks of size 2^( 5) =       0.000538738244
  error estimate for blocks of size 2^( 6) =       0.000542438510
  error estimate for blocks of size 2^( 7) =       0.000544292000

      target function =      -0.746340247031
              le_mean =     -22.662149322888
             les_mean =     514.021767756724
             stat err =       0.000539104180
             autocorr =       1.320594542788
   target nu stat err =       0.000539104180
   target dn stat err =       0.002426879079
      target stat err =       0.002082893782
              std dev =       0.663441978456
             le_variance =       0.440155258778


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746340236167        initial
     1.3235e+03     1.3235e+04             2.2628e-07        -0.746340409531  <--
     5.2940e+03     5.2940e+04             5.6570e-08        -0.746340322973
     2.1176e+04     2.1176e+05             1.4143e-08        -0.746340247031

*****************************************************************************
Applying the update for shift_i =   1.3235e+03     and shift_s =   1.3235e+04
*****************************************************************************

  Execution time = 4.3489e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_001                -7.055661e-01 3 1  ON 0
ci_002                -7.029280e-01 3 1  ON 1
ci_003                -5.011527e-02 3 1  ON 2
ci_004                -5.098498e-02 3 1  ON 3
ci_005                 1.947125e-02 3 1  ON 4
ci_006                 1.976118e-02 3 1  ON 5
ci_007                 1.473392e-02 3 1  ON 6
ci_008                 1.549417e-02 3 1  ON 7
ci_009                -1.315714e-02 3 1  ON 8
ci_010                -1.205494e-02 3 1  ON 9
ci_011                -9.849143e-03 3 1  ON 10
ci_012                -9.085501e-03 3 1  ON 11
ci_013                 8.366268e-03 3 1  ON 12
ci_014                 9.298557e-03 3 1  ON 13
ci_015                 9.500237e-03 3 1  ON 14
ci_016                 9.362313e-03 3 1  ON 15
ci_017                 8.490790e-03 3 1  ON 16
ci_018                 8.266372e-03 3 1  ON 17
ci_019                -1.262294e-03 3 1  ON 18
ci_020                -1.584969e-03 3 1  ON 19
ci_021                -1.181880e-02 3 1  ON 20
ci_022                -1.183488e-02 3 1  ON 21
ci_023                 4.842758e-03 3 1  ON 22
ci_024                 4.910932e-03 3 1  ON 23
ci_025                 1.152797e-02 3 1  ON 24
ci_026                 1.152970e-02 3 1  ON 25
ci_027                 6.477152e-03 3 1  ON 26
ci_028                 6.177393e-03 3 1  ON 27
ci_029                -5.032807e-03 3 1  ON 28
ci_030                -4.115359e-03 3 1  ON 29
ci_031                 3.413210e-03 3 1  ON 30
ci_032                 4.669732e-03 3 1  ON 31
ci_033                 2.349499e-03 3 1  ON 32
ci_034                 4.108532e-03 3 1  ON 33
ci_035                 1.724102e-03 3 1  ON 34
ci_036                 2.137462e-03 3 1  ON 35
ci_037                 3.493220e-03 3 1  ON 36
ci_038                 3.700783e-03 3 1  ON 37
ci_039                 4.602629e-03 3 1  ON 38
ci_040                 4.920991e-03 3 1  ON 39
ci_041                 2.955615e-03 3 1  ON 40
ci_042                 2.734289e-03 3 1  ON 41
ci_043                 2.939004e-03 3 1  ON 42
ci_044                 3.206564e-03 3 1  ON 43
ci_045                 2.473920e-03 3 1  ON 44
ci_046                 2.735582e-03 3 1  ON 45
ci_047                -1.006526e-03 3 1  ON 46
ci_048                -8.449382e-04 3 1  ON 47
ci_049                 7.812147e-04 3 1  ON 48
ci_050                 9.955063e-04 3 1  ON 49
ci_051                -3.363400e-04 3 1  ON 50
ci_052                -1.212177e-03 3 1  ON 51
ci_053                -2.460475e-03 3 1  ON 52
ci_054                -2.688939e-03 3 1  ON 53
ci_055                -1.790792e-03 3 1  ON 54
ci_056                -1.965051e-03 3 1  ON 55
ci_057                -1.320437e-03 3 1  ON 56
ci_058                -9.968497e-04 3 1  ON 57
ci_059                -5.220928e-04 3 1  ON 58
ci_060                -7.416599e-04 3 1  ON 59
ci_061                 6.200764e-06 3 1  ON 60
ci_062                -9.078626e-04 3 1  ON 61
ci_063                -8.886690e-04 3 1  ON 62
ci_064                -5.034016e-04 3 1  ON 63
ci_065                -1.365724e-03 3 1  ON 64
ci_066                -1.881956e-03 3 1  ON 65
ci_067                -1.824367e-03 3 1  ON 66
ci_068                -1.480737e-03 3 1  ON 67
ci_069                -5.507691e-04 3 1  ON 68
ci_070                -4.208415e-04 3 1  ON 69
ci_071                -2.065067e-03 3 1  ON 70
ci_072                -1.992131e-03 3 1  ON 71
ci_073                 1.591979e-04 3 1  ON 72
ci_074                 1.767513e-04 3 1  ON 73
ci_075                 1.715515e-04 3 1  ON 74
ci_076                 7.920023e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4530e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.671
    reference variance = 0.390196
====================================================
  Execution time = 2.8144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5507e-01
  Total weights = 1.955093511e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443641219055
                                         uncertainty =       0.002357088542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443641219055
                                         uncertainty =       0.002357088542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470949295
  error estimate for blocks of size 2^( 2) =       0.000494791829
  error estimate for blocks of size 2^( 3) =       0.000517139194
  error estimate for blocks of size 2^( 4) =       0.000533298403
  error estimate for blocks of size 2^( 5) =       0.000542516785
  error estimate for blocks of size 2^( 6) =       0.000548194164
  error estimate for blocks of size 2^( 7) =       0.000548534254

      target function =      -0.741172326499
              le_mean =     -22.661925301753
             les_mean =     514.017930914050
             stat err =       0.000543135902
             autocorr =       1.330052302935
   target nu stat err =       0.000543135902
   target dn stat err =       0.003677313392
      target stat err =       0.003040879647
              std dev =       0.666022880175
             le_variance =       0.443586476917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266192530175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+02, overlap shift 3.3087e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741183921641       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741184027753       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741184040933       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741184043278       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741184044664       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741184046468       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741184047132       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741184047150       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741184047072       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741184047104       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741184047061       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741184047071       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+02 is 1.001349e-06

solving harmonic davidson linear method for identity shift 1.3235e+03, overlap shift 1.3235e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741183921641       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741183948172       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741183951467       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741183952053       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741183952401       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741183952851       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741183953013       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741183953021       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741183953003       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741183953010       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741183953000       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741183953001       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+03 is 2.503387e-07

solving harmonic davidson linear method for identity shift 5.2940e+03, overlap shift 5.2940e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741183921641       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741183928274       residual = 4.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741183929098       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741183929244       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741183929327       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741183929440       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741183929497       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741183929484       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741183929477       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741183929471       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741183929470       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741183929471       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+03 is 6.258476e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2882e+01
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_001                -7.055664e-01 3 1  ON 0
ci_002                -7.029278e-01 3 1  ON 1
ci_003                -5.011514e-02 3 1  ON 2
ci_004                -5.098499e-02 3 1  ON 3
ci_005                 1.947121e-02 3 1  ON 4
ci_006                 1.976109e-02 3 1  ON 5
ci_007                 1.473388e-02 3 1  ON 6
ci_008                 1.549412e-02 3 1  ON 7
ci_009                -1.315703e-02 3 1  ON 8
ci_010                -1.205498e-02 3 1  ON 9
ci_011                -9.849179e-03 3 1  ON 10
ci_012                -9.085433e-03 3 1  ON 11
ci_013                 8.366260e-03 3 1  ON 12
ci_014                 9.298467e-03 3 1  ON 13
ci_015                 9.500198e-03 3 1  ON 14
ci_016                 9.362263e-03 3 1  ON 15
ci_017                 8.490789e-03 3 1  ON 16
ci_018                 8.266327e-03 3 1  ON 17
ci_019                -1.262446e-03 3 1  ON 18
ci_020                -1.585008e-03 3 1  ON 19
ci_021                -1.181885e-02 3 1  ON 20
ci_022                -1.183497e-02 3 1  ON 21
ci_023                 4.842716e-03 3 1  ON 22
ci_024                 4.911107e-03 3 1  ON 23
ci_025                 1.152806e-02 3 1  ON 24
ci_026                 1.152990e-02 3 1  ON 25
ci_027                 6.477128e-03 3 1  ON 26
ci_028                 6.177336e-03 3 1  ON 27
ci_029                -5.032714e-03 3 1  ON 28
ci_030                -4.115361e-03 3 1  ON 29
ci_031                 3.413297e-03 3 1  ON 30
ci_032                 4.669848e-03 3 1  ON 31
ci_033                 2.349572e-03 3 1  ON 32
ci_034                 4.108487e-03 3 1  ON 33
ci_035                 1.724127e-03 3 1  ON 34
ci_036                 2.137443e-03 3 1  ON 35
ci_037                 3.493242e-03 3 1  ON 36
ci_038                 3.700771e-03 3 1  ON 37
ci_039                 4.602599e-03 3 1  ON 38
ci_040                 4.921041e-03 3 1  ON 39
ci_041                 2.955586e-03 3 1  ON 40
ci_042                 2.734216e-03 3 1  ON 41
ci_043                 2.939070e-03 3 1  ON 42
ci_044                 3.206519e-03 3 1  ON 43
ci_045                 2.473844e-03 3 1  ON 44
ci_046                 2.735633e-03 3 1  ON 45
ci_047                -1.006521e-03 3 1  ON 46
ci_048                -8.449545e-04 3 1  ON 47
ci_049                 7.812303e-04 3 1  ON 48
ci_050                 9.954581e-04 3 1  ON 49
ci_051                -3.363933e-04 3 1  ON 50
ci_052                -1.212278e-03 3 1  ON 51
ci_053                -2.460434e-03 3 1  ON 52
ci_054                -2.688868e-03 3 1  ON 53
ci_055                -1.790760e-03 3 1  ON 54
ci_056                -1.964962e-03 3 1  ON 55
ci_057                -1.320414e-03 3 1  ON 56
ci_058                -9.968608e-04 3 1  ON 57
ci_059                -5.220622e-04 3 1  ON 58
ci_060                -7.416458e-04 3 1  ON 59
ci_061                 6.243602e-06 3 1  ON 60
ci_062                -9.077655e-04 3 1  ON 61
ci_063                -8.886878e-04 3 1  ON 62
ci_064                -5.034657e-04 3 1  ON 63
ci_065                -1.365705e-03 3 1  ON 64
ci_066                -1.881979e-03 3 1  ON 65
ci_067                -1.824392e-03 3 1  ON 66
ci_068                -1.480674e-03 3 1  ON 67
ci_069                -5.508100e-04 3 1  ON 68
ci_070                -4.208867e-04 3 1  ON 69
ci_071                -2.065032e-03 3 1  ON 70
ci_072                -1.992045e-03 3 1  ON 71
ci_073                 1.591810e-04 3 1  ON 72
ci_074                 1.767371e-04 3 1  ON 73
ci_075                 1.715453e-04 3 1  ON 74
ci_076                 7.920166e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6867
    reference variance = 0.348379
====================================================
  Execution time = 2.5668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5367e-01
  Total weights = 1.9552e+06
  Execution time = 3.9249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442394840772
                                         uncertainty =       0.002337941452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442394840772
                                         uncertainty =       0.002337941452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470266259
  error estimate for blocks of size 2^( 2) =       0.000494229393
  error estimate for blocks of size 2^( 3) =       0.000516507018
  error estimate for blocks of size 2^( 4) =       0.000532472919
  error estimate for blocks of size 2^( 5) =       0.000542050495
  error estimate for blocks of size 2^( 6) =       0.000547105342
  error estimate for blocks of size 2^( 7) =       0.000548096739

      target function =      -0.742311415320
              le_mean =     -22.662166856201
             les_mean =     514.027480373301
             stat err =       0.000542431373
             autocorr =       1.330460428860
   target nu stat err =       0.000542431373
   target dn stat err =       0.003440278732
      target stat err =       0.002862041437
              std dev =       0.665056920923
             le_variance =       0.442300708067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442395107039
                                         uncertainty =       0.002338055562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442395107039
                                         uncertainty =       0.002338055562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470266399
  error estimate for blocks of size 2^( 2) =       0.000494229538
  error estimate for blocks of size 2^( 3) =       0.000516507154
  error estimate for blocks of size 2^( 4) =       0.000532473071
  error estimate for blocks of size 2^( 5) =       0.000542050633
  error estimate for blocks of size 2^( 6) =       0.000547105486
  error estimate for blocks of size 2^( 7) =       0.000548096822

      target function =      -0.742310719279
              le_mean =     -22.662166852144
             les_mean =     514.027481039532
             stat err =       0.000542431503
             autocorr =       1.330460272800
   target nu stat err =       0.000542431503
   target dn stat err =       0.003440971969
      target stat err =       0.002862588038
              std dev =       0.665057118865
             le_variance =       0.442300971352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442394973848
                                         uncertainty =       0.002337998487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442394973848
                                         uncertainty =       0.002337998487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470266329
  error estimate for blocks of size 2^( 2) =       0.000494229465
  error estimate for blocks of size 2^( 3) =       0.000516507086
  error estimate for blocks of size 2^( 4) =       0.000532472995
  error estimate for blocks of size 2^( 5) =       0.000542050564
  error estimate for blocks of size 2^( 6) =       0.000547105414
  error estimate for blocks of size 2^( 7) =       0.000548096780

      target function =      -0.742311070336
              le_mean =     -22.662166854172
             les_mean =     514.027480702661
             stat err =       0.000542431438
             autocorr =       1.330460350878
   target nu stat err =       0.000542431438
   target dn stat err =       0.003440625231
      target stat err =       0.002862314665
              std dev =       0.665057019850
             le_variance =       0.442300839652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442394857399
                                         uncertainty =       0.002337948579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442394857399
                                         uncertainty =       0.002337948579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470266267
  error estimate for blocks of size 2^( 2) =       0.000494229402
  error estimate for blocks of size 2^( 3) =       0.000516507026
  error estimate for blocks of size 2^( 4) =       0.000532472928
  error estimate for blocks of size 2^( 5) =       0.000542050503
  error estimate for blocks of size 2^( 6) =       0.000547105351
  error estimate for blocks of size 2^( 7) =       0.000548096744

      target function =      -0.742311372542
              le_mean =     -22.662166855947
             les_mean =     514.027480414044
             stat err =       0.000542431382
             autocorr =       1.330460419124
   target nu stat err =       0.000542431382
   target dn stat err =       0.003440322029
      target stat err =       0.002862075581
              std dev =       0.665056933283
             le_variance =       0.442300724508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742311415320        initial  <--
     3.3087e+02     3.3087e+03             1.0013e-06        -0.742310719279
     1.3235e+03     1.3235e+04             2.5034e-07        -0.742311070336
     5.2940e+03     5.2940e+04             6.2585e-08        -0.742311372542

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3865
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_001                -7.055661e-01 3 1  ON 0
ci_002                -7.029280e-01 3 1  ON 1
ci_003                -5.011527e-02 3 1  ON 2
ci_004                -5.098498e-02 3 1  ON 3
ci_005                 1.947125e-02 3 1  ON 4
ci_006                 1.976118e-02 3 1  ON 5
ci_007                 1.473392e-02 3 1  ON 6
ci_008                 1.549417e-02 3 1  ON 7
ci_009                -1.315714e-02 3 1  ON 8
ci_010                -1.205494e-02 3 1  ON 9
ci_011                -9.849143e-03 3 1  ON 10
ci_012                -9.085501e-03 3 1  ON 11
ci_013                 8.366268e-03 3 1  ON 12
ci_014                 9.298557e-03 3 1  ON 13
ci_015                 9.500237e-03 3 1  ON 14
ci_016                 9.362313e-03 3 1  ON 15
ci_017                 8.490790e-03 3 1  ON 16
ci_018                 8.266372e-03 3 1  ON 17
ci_019                -1.262294e-03 3 1  ON 18
ci_020                -1.584969e-03 3 1  ON 19
ci_021                -1.181880e-02 3 1  ON 20
ci_022                -1.183488e-02 3 1  ON 21
ci_023                 4.842758e-03 3 1  ON 22
ci_024                 4.910932e-03 3 1  ON 23
ci_025                 1.152797e-02 3 1  ON 24
ci_026                 1.152970e-02 3 1  ON 25
ci_027                 6.477152e-03 3 1  ON 26
ci_028                 6.177393e-03 3 1  ON 27
ci_029                -5.032807e-03 3 1  ON 28
ci_030                -4.115359e-03 3 1  ON 29
ci_031                 3.413210e-03 3 1  ON 30
ci_032                 4.669732e-03 3 1  ON 31
ci_033                 2.349499e-03 3 1  ON 32
ci_034                 4.108532e-03 3 1  ON 33
ci_035                 1.724102e-03 3 1  ON 34
ci_036                 2.137462e-03 3 1  ON 35
ci_037                 3.493220e-03 3 1  ON 36
ci_038                 3.700783e-03 3 1  ON 37
ci_039                 4.602629e-03 3 1  ON 38
ci_040                 4.920991e-03 3 1  ON 39
ci_041                 2.955615e-03 3 1  ON 40
ci_042                 2.734289e-03 3 1  ON 41
ci_043                 2.939004e-03 3 1  ON 42
ci_044                 3.206564e-03 3 1  ON 43
ci_045                 2.473920e-03 3 1  ON 44
ci_046                 2.735582e-03 3 1  ON 45
ci_047                -1.006526e-03 3 1  ON 46
ci_048                -8.449382e-04 3 1  ON 47
ci_049                 7.812147e-04 3 1  ON 48
ci_050                 9.955063e-04 3 1  ON 49
ci_051                -3.363400e-04 3 1  ON 50
ci_052                -1.212177e-03 3 1  ON 51
ci_053                -2.460475e-03 3 1  ON 52
ci_054                -2.688939e-03 3 1  ON 53
ci_055                -1.790792e-03 3 1  ON 54
ci_056                -1.965051e-03 3 1  ON 55
ci_057                -1.320437e-03 3 1  ON 56
ci_058                -9.968497e-04 3 1  ON 57
ci_059                -5.220928e-04 3 1  ON 58
ci_060                -7.416599e-04 3 1  ON 59
ci_061                 6.200764e-06 3 1  ON 60
ci_062                -9.078626e-04 3 1  ON 61
ci_063                -8.886690e-04 3 1  ON 62
ci_064                -5.034016e-04 3 1  ON 63
ci_065                -1.365724e-03 3 1  ON 64
ci_066                -1.881956e-03 3 1  ON 65
ci_067                -1.824367e-03 3 1  ON 66
ci_068                -1.480737e-03 3 1  ON 67
ci_069                -5.507691e-04 3 1  ON 68
ci_070                -4.208415e-04 3 1  ON 69
ci_071                -2.065067e-03 3 1  ON 70
ci_072                -1.992131e-03 3 1  ON 71
ci_073                 1.591979e-04 3 1  ON 72
ci_074                 1.767513e-04 3 1  ON 73
ci_075                 1.715515e-04 3 1  ON 74
ci_076                 7.920023e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7275e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6893
    reference variance = 0.397651
====================================================
  Execution time = 2.6286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4856e-01
  Total weights = 1.955250273e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439330650531
                                         uncertainty =       0.002140992522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439330650531
                                         uncertainty =       0.002140992522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468684170
  error estimate for blocks of size 2^( 2) =       0.000492705740
  error estimate for blocks of size 2^( 3) =       0.000514428246
  error estimate for blocks of size 2^( 4) =       0.000531117878
  error estimate for blocks of size 2^( 5) =       0.000540246075
  error estimate for blocks of size 2^( 6) =       0.000545053896
  error estimate for blocks of size 2^( 7) =       0.000548107850

      target function =      -0.746491058247
              le_mean =     -22.661461853949
             les_mean =     513.990413601298
             stat err =       0.000541131425
             autocorr =       1.333045395650
   target nu stat err =       0.000541131425
   target dn stat err =       0.002724323264
      target stat err =       0.002317585760
              std dev =       0.662819510107
             le_variance =       0.439329702979


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266146185395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+03, overlap shift 3.3087e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746497311288       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746497318119       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746497319067       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746497319130       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746497319175       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746497319194       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746497319184       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746497319185       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746497319187       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746497319186       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746497319192       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746497319195       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+03 is 7.074193e-08

solving harmonic davidson linear method for identity shift 1.3235e+04, overlap shift 1.3235e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746497311288       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746497312996       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746497313233       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746497313248       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746497313237       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746497313275       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746497313267       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746497313281       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746497313258       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746497313259       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746497313262       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746497313304       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+04 is 1.768565e-08

solving harmonic davidson linear method for identity shift 5.2940e+04, overlap shift 5.2940e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746497311288       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746497311715       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746497311774       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746497311778       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746497311762       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746497311685       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746497311773       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746497311805       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746497311751       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746497311817       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746497311695       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746497311808       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+04 is 4.421424e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.333389 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1002e+01
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_001                -7.055661e-01 3 1  ON 0
ci_002                -7.029280e-01 3 1  ON 1
ci_003                -5.011528e-02 3 1  ON 2
ci_004                -5.098497e-02 3 1  ON 3
ci_005                 1.947125e-02 3 1  ON 4
ci_006                 1.976117e-02 3 1  ON 5
ci_007                 1.473391e-02 3 1  ON 6
ci_008                 1.549417e-02 3 1  ON 7
ci_009                -1.315713e-02 3 1  ON 8
ci_010                -1.205494e-02 3 1  ON 9
ci_011                -9.849136e-03 3 1  ON 10
ci_012                -9.085497e-03 3 1  ON 11
ci_013                 8.366265e-03 3 1  ON 12
ci_014                 9.298539e-03 3 1  ON 13
ci_015                 9.500229e-03 3 1  ON 14
ci_016                 9.362303e-03 3 1  ON 15
ci_017                 8.490790e-03 3 1  ON 16
ci_018                 8.266373e-03 3 1  ON 17
ci_019                -1.262309e-03 3 1  ON 18
ci_020                -1.584976e-03 3 1  ON 19
ci_021                -1.181880e-02 3 1  ON 20
ci_022                -1.183489e-02 3 1  ON 21
ci_023                 4.842759e-03 3 1  ON 22
ci_024                 4.910939e-03 3 1  ON 23
ci_025                 1.152797e-02 3 1  ON 24
ci_026                 1.152970e-02 3 1  ON 25
ci_027                 6.477148e-03 3 1  ON 26
ci_028                 6.177397e-03 3 1  ON 27
ci_029                -5.032799e-03 3 1  ON 28
ci_030                -4.115358e-03 3 1  ON 29
ci_031                 3.413219e-03 3 1  ON 30
ci_032                 4.669743e-03 3 1  ON 31
ci_033                 2.349498e-03 3 1  ON 32
ci_034                 4.108532e-03 3 1  ON 33
ci_035                 1.724105e-03 3 1  ON 34
ci_036                 2.137461e-03 3 1  ON 35
ci_037                 3.493210e-03 3 1  ON 36
ci_038                 3.700777e-03 3 1  ON 37
ci_039                 4.602630e-03 3 1  ON 38
ci_040                 4.920987e-03 3 1  ON 39
ci_041                 2.955614e-03 3 1  ON 40
ci_042                 2.734287e-03 3 1  ON 41
ci_043                 2.939002e-03 3 1  ON 42
ci_044                 3.206563e-03 3 1  ON 43
ci_045                 2.473924e-03 3 1  ON 44
ci_046                 2.735578e-03 3 1  ON 45
ci_047                -1.006522e-03 3 1  ON 46
ci_048                -8.449357e-04 3 1  ON 47
ci_049                 7.812193e-04 3 1  ON 48
ci_050                 9.954986e-04 3 1  ON 49
ci_051                -3.363378e-04 3 1  ON 50
ci_052                -1.212172e-03 3 1  ON 51
ci_053                -2.460479e-03 3 1  ON 52
ci_054                -2.688942e-03 3 1  ON 53
ci_055                -1.790792e-03 3 1  ON 54
ci_056                -1.965052e-03 3 1  ON 55
ci_057                -1.320437e-03 3 1  ON 56
ci_058                -9.968531e-04 3 1  ON 57
ci_059                -5.220912e-04 3 1  ON 58
ci_060                -7.416607e-04 3 1  ON 59
ci_061                 6.199245e-06 3 1  ON 60
ci_062                -9.078630e-04 3 1  ON 61
ci_063                -8.886669e-04 3 1  ON 62
ci_064                -5.034010e-04 3 1  ON 63
ci_065                -1.365719e-03 3 1  ON 64
ci_066                -1.881957e-03 3 1  ON 65
ci_067                -1.824366e-03 3 1  ON 66
ci_068                -1.480737e-03 3 1  ON 67
ci_069                -5.507616e-04 3 1  ON 68
ci_070                -4.208491e-04 3 1  ON 69
ci_071                -2.065071e-03 3 1  ON 70
ci_072                -1.992128e-03 3 1  ON 71
ci_073                 1.591992e-04 3 1  ON 72
ci_074                 1.767527e-04 3 1  ON 73
ci_075                 1.715530e-04 3 1  ON 74
ci_076                 7.920039e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6286
    reference variance = 0.342509
====================================================
  Execution time = 2.5454e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5228e-01
  Total weights = 1.9554e+06
  Execution time = 3.6003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443329316994
                                         uncertainty =       0.002319898166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443329316994
                                         uncertainty =       0.002319898166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470807751
  error estimate for blocks of size 2^( 2) =       0.000494595509
  error estimate for blocks of size 2^( 3) =       0.000516751995
  error estimate for blocks of size 2^( 4) =       0.000531598126
  error estimate for blocks of size 2^( 5) =       0.000541446877
  error estimate for blocks of size 2^( 6) =       0.000546920552
  error estimate for blocks of size 2^( 7) =       0.000547876739

      target function =      -0.743454579893
              le_mean =     -22.662133882152
             les_mean =     514.024588039681
             stat err =       0.000541960574
             autocorr =       1.325098552485
   target nu stat err =       0.000541960574
   target dn stat err =       0.002670958400
      target stat err =       0.002259858229
              std dev =       0.665822706674
             le_variance =       0.443319876723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443329308566
                                         uncertainty =       0.002319898934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443329308566
                                         uncertainty =       0.002319898934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470807746
  error estimate for blocks of size 2^( 2) =       0.000494595506
  error estimate for blocks of size 2^( 3) =       0.000516751993
  error estimate for blocks of size 2^( 4) =       0.000531598124
  error estimate for blocks of size 2^( 5) =       0.000541446877
  error estimate for blocks of size 2^( 6) =       0.000546920551
  error estimate for blocks of size 2^( 7) =       0.000547876740

      target function =      -0.743454605805
              le_mean =     -22.662133882045
             les_mean =     514.024588003097
             stat err =       0.000541960573
             autocorr =       1.325098573589
   target nu stat err =       0.000541960573
   target dn stat err =       0.002670958425
      target stat err =       0.002259858400
              std dev =       0.665822700317
             le_variance =       0.443319868258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443329312780
                                         uncertainty =       0.002319898550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443329312780
                                         uncertainty =       0.002319898550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470807749
  error estimate for blocks of size 2^( 2) =       0.000494595508
  error estimate for blocks of size 2^( 3) =       0.000516751994
  error estimate for blocks of size 2^( 4) =       0.000531598125
  error estimate for blocks of size 2^( 5) =       0.000541446877
  error estimate for blocks of size 2^( 6) =       0.000546920552
  error estimate for blocks of size 2^( 7) =       0.000547876739

      target function =      -0.743454592854
              le_mean =     -22.662133882098
             les_mean =     514.024588021382
             stat err =       0.000541960573
             autocorr =       1.325098563035
   target nu stat err =       0.000541960573
   target dn stat err =       0.002670958412
      target stat err =       0.002259858315
              std dev =       0.665822703496
             le_variance =       0.443319872490

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443329316467
                                         uncertainty =       0.002319898214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443329316467
                                         uncertainty =       0.002319898214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470807751
  error estimate for blocks of size 2^( 2) =       0.000494595509
  error estimate for blocks of size 2^( 3) =       0.000516751995
  error estimate for blocks of size 2^( 4) =       0.000531598126
  error estimate for blocks of size 2^( 5) =       0.000541446877
  error estimate for blocks of size 2^( 6) =       0.000546920552
  error estimate for blocks of size 2^( 7) =       0.000547876739

      target function =      -0.743454581514
              le_mean =     -22.662133882145
             les_mean =     514.024588037393
             stat err =       0.000541960574
             autocorr =       1.325098553802
   target nu stat err =       0.000541960574
   target dn stat err =       0.002670958401
      target stat err =       0.002259858240
              std dev =       0.665822706277
             le_variance =       0.443319876194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743454579893        initial
     3.3087e+03     3.3087e+04             7.0742e-08        -0.743454605805  <--
     1.3235e+04     1.3235e+05             1.7686e-08        -0.743454592854
     5.2940e+04     5.2940e+05             4.4214e-09        -0.743454581514

*****************************************************************************
Applying the update for shift_i =   3.3087e+03     and shift_s =   3.3087e+04
*****************************************************************************

  Execution time = 4.3514e+01
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_001                -7.055662e-01 3 1  ON 0
ci_002                -7.029280e-01 3 1  ON 1
ci_003                -5.011530e-02 3 1  ON 2
ci_004                -5.098496e-02 3 1  ON 3
ci_005                 1.947124e-02 3 1  ON 4
ci_006                 1.976115e-02 3 1  ON 5
ci_007                 1.473390e-02 3 1  ON 6
ci_008                 1.549414e-02 3 1  ON 7
ci_009                -1.315710e-02 3 1  ON 8
ci_010                -1.205493e-02 3 1  ON 9
ci_011                -9.849116e-03 3 1  ON 10
ci_012                -9.085486e-03 3 1  ON 11
ci_013                 8.366257e-03 3 1  ON 12
ci_014                 9.298486e-03 3 1  ON 13
ci_015                 9.500207e-03 3 1  ON 14
ci_016                 9.362272e-03 3 1  ON 15
ci_017                 8.490790e-03 3 1  ON 16
ci_018                 8.266377e-03 3 1  ON 17
ci_019                -1.262353e-03 3 1  ON 18
ci_020                -1.584997e-03 3 1  ON 19
ci_021                -1.181882e-02 3 1  ON 20
ci_022                -1.183491e-02 3 1  ON 21
ci_023                 4.842760e-03 3 1  ON 22
ci_024                 4.910959e-03 3 1  ON 23
ci_025                 1.152798e-02 3 1  ON 24
ci_026                 1.152969e-02 3 1  ON 25
ci_027                 6.477135e-03 3 1  ON 26
ci_028                 6.177408e-03 3 1  ON 27
ci_029                -5.032777e-03 3 1  ON 28
ci_030                -4.115352e-03 3 1  ON 29
ci_031                 3.413248e-03 3 1  ON 30
ci_032                 4.669777e-03 3 1  ON 31
ci_033                 2.349497e-03 3 1  ON 32
ci_034                 4.108531e-03 3 1  ON 33
ci_035                 1.724112e-03 3 1  ON 34
ci_036                 2.137458e-03 3 1  ON 35
ci_037                 3.493179e-03 3 1  ON 36
ci_038                 3.700761e-03 3 1  ON 37
ci_039                 4.602632e-03 3 1  ON 38
ci_040                 4.920975e-03 3 1  ON 39
ci_041                 2.955612e-03 3 1  ON 40
ci_042                 2.734278e-03 3 1  ON 41
ci_043                 2.938998e-03 3 1  ON 42
ci_044                 3.206559e-03 3 1  ON 43
ci_045                 2.473937e-03 3 1  ON 44
ci_046                 2.735569e-03 3 1  ON 45
ci_047                -1.006509e-03 3 1  ON 46
ci_048                -8.449282e-04 3 1  ON 47
ci_049                 7.812331e-04 3 1  ON 48
ci_050                 9.954753e-04 3 1  ON 49
ci_051                -3.363313e-04 3 1  ON 50
ci_052                -1.212155e-03 3 1  ON 51
ci_053                -2.460490e-03 3 1  ON 52
ci_054                -2.688951e-03 3 1  ON 53
ci_055                -1.790792e-03 3 1  ON 54
ci_056                -1.965055e-03 3 1  ON 55
ci_057                -1.320436e-03 3 1  ON 56
ci_058                -9.968634e-04 3 1  ON 57
ci_059                -5.220863e-04 3 1  ON 58
ci_060                -7.416631e-04 3 1  ON 59
ci_061                 6.194686e-06 3 1  ON 60
ci_062                -9.078642e-04 3 1  ON 61
ci_063                -8.886607e-04 3 1  ON 62
ci_064                -5.033993e-04 3 1  ON 63
ci_065                -1.365702e-03 3 1  ON 64
ci_066                -1.881960e-03 3 1  ON 65
ci_067                -1.824364e-03 3 1  ON 66
ci_068                -1.480738e-03 3 1  ON 67
ci_069                -5.507394e-04 3 1  ON 68
ci_070                -4.208720e-04 3 1  ON 69
ci_071                -2.065080e-03 3 1  ON 70
ci_072                -1.992119e-03 3 1  ON 71
ci_073                 1.592033e-04 3 1  ON 72
ci_074                 1.767569e-04 3 1  ON 73
ci_075                 1.715575e-04 3 1  ON 74
ci_076                 7.920089e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4532e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.6834
    reference variance = 0.488502
====================================================
  Execution time = 2.6235e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4836e-01
  Total weights = 1.955031361e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439444554121
                                         uncertainty =       0.002066742534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439444554121
                                         uncertainty =       0.002066742534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468738529
  error estimate for blocks of size 2^( 2) =       0.000493048473
  error estimate for blocks of size 2^( 3) =       0.000515560296
  error estimate for blocks of size 2^( 4) =       0.000531937699
  error estimate for blocks of size 2^( 5) =       0.000542166021
  error estimate for blocks of size 2^( 6) =       0.000547197904
  error estimate for blocks of size 2^( 7) =       0.000549115239

      target function =      -0.746659073205
              le_mean =     -22.661692631316
             les_mean =     514.000671592100
             stat err =       0.000542604216
             autocorr =       1.340000692272
   target nu stat err =       0.000542604216
   target dn stat err =       0.002878522066
      target stat err =       0.002442603886
              std dev =       0.662896384335
             le_variance =       0.439431616364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266169263132e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+02, overlap shift 8.2718e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746666126910       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746666147822       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746666152141       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746666152499       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746666152792       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746666152824       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746666152901       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746666152924       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746666152964       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746666152980       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746666152977       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+02 is 2.153830e-07

solving harmonic davidson linear method for identity shift 3.3087e+03, overlap shift 3.3087e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746666126910       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746666132138       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746666133218       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746666133308       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746666133384       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746666133392       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746666133403       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746666133423       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746666133425       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746666133433       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746666133417       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+03 is 5.384772e-08

solving harmonic davidson linear method for identity shift 1.3235e+04, overlap shift 1.3235e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746666126910       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746666128217       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746666128487       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746666128506       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746666128525       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746666128533       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746666128539       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746666128557       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746666128518       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746666128538       residual = 5.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746666128542       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+04 is 1.346205e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0970e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_001                -7.055662e-01 3 1  ON 0
ci_002                -7.029279e-01 3 1  ON 1
ci_003                -5.011532e-02 3 1  ON 2
ci_004                -5.098499e-02 3 1  ON 3
ci_005                 1.947122e-02 3 1  ON 4
ci_006                 1.976113e-02 3 1  ON 5
ci_007                 1.473389e-02 3 1  ON 6
ci_008                 1.549415e-02 3 1  ON 7
ci_009                -1.315709e-02 3 1  ON 8
ci_010                -1.205489e-02 3 1  ON 9
ci_011                -9.849063e-03 3 1  ON 10
ci_012                -9.085455e-03 3 1  ON 11
ci_013                 8.366261e-03 3 1  ON 12
ci_014                 9.298478e-03 3 1  ON 13
ci_015                 9.500163e-03 3 1  ON 14
ci_016                 9.362252e-03 3 1  ON 15
ci_017                 8.490811e-03 3 1  ON 16
ci_018                 8.266382e-03 3 1  ON 17
ci_019                -1.262388e-03 3 1  ON 18
ci_020                -1.585051e-03 3 1  ON 19
ci_021                -1.181884e-02 3 1  ON 20
ci_022                -1.183496e-02 3 1  ON 21
ci_023                 4.842763e-03 3 1  ON 22
ci_024                 4.910959e-03 3 1  ON 23
ci_025                 1.152801e-02 3 1  ON 24
ci_026                 1.152971e-02 3 1  ON 25
ci_027                 6.477125e-03 3 1  ON 26
ci_028                 6.177418e-03 3 1  ON 27
ci_029                -5.032758e-03 3 1  ON 28
ci_030                -4.115333e-03 3 1  ON 29
ci_031                 3.413297e-03 3 1  ON 30
ci_032                 4.669808e-03 3 1  ON 31
ci_033                 2.349502e-03 3 1  ON 32
ci_034                 4.108498e-03 3 1  ON 33
ci_035                 1.724101e-03 3 1  ON 34
ci_036                 2.137449e-03 3 1  ON 35
ci_037                 3.493191e-03 3 1  ON 36
ci_038                 3.700747e-03 3 1  ON 37
ci_039                 4.602621e-03 3 1  ON 38
ci_040                 4.920984e-03 3 1  ON 39
ci_041                 2.955601e-03 3 1  ON 40
ci_042                 2.734290e-03 3 1  ON 41
ci_043                 2.938994e-03 3 1  ON 42
ci_044                 3.206567e-03 3 1  ON 43
ci_045                 2.473938e-03 3 1  ON 44
ci_046                 2.735578e-03 3 1  ON 45
ci_047                -1.006514e-03 3 1  ON 46
ci_048                -8.449289e-04 3 1  ON 47
ci_049                 7.812372e-04 3 1  ON 48
ci_050                 9.954858e-04 3 1  ON 49
ci_051                -3.363425e-04 3 1  ON 50
ci_052                -1.212167e-03 3 1  ON 51
ci_053                -2.460500e-03 3 1  ON 52
ci_054                -2.688965e-03 3 1  ON 53
ci_055                -1.790786e-03 3 1  ON 54
ci_056                -1.965048e-03 3 1  ON 55
ci_057                -1.320432e-03 3 1  ON 56
ci_058                -9.968609e-04 3 1  ON 57
ci_059                -5.220719e-04 3 1  ON 58
ci_060                -7.416615e-04 3 1  ON 59
ci_061                 6.186978e-06 3 1  ON 60
ci_062                -9.078605e-04 3 1  ON 61
ci_063                -8.886304e-04 3 1  ON 62
ci_064                -5.034088e-04 3 1  ON 63
ci_065                -1.365708e-03 3 1  ON 64
ci_066                -1.881946e-03 3 1  ON 65
ci_067                -1.824344e-03 3 1  ON 66
ci_068                -1.480761e-03 3 1  ON 67
ci_069                -5.507402e-04 3 1  ON 68
ci_070                -4.208827e-04 3 1  ON 69
ci_071                -2.065065e-03 3 1  ON 70
ci_072                -1.992116e-03 3 1  ON 71
ci_073                 1.591884e-04 3 1  ON 72
ci_074                 1.767573e-04 3 1  ON 73
ci_075                 1.715379e-04 3 1  ON 74
ci_076                 7.920238e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.6772
    reference variance = 0.336265
====================================================
  Execution time = 2.5407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5089e-01
  Total weights = 1.9551e+06
  Execution time = 3.6206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441756595593
                                         uncertainty =       0.002314317507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441756595593
                                         uncertainty =       0.002314317507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470042037
  error estimate for blocks of size 2^( 2) =       0.000493789800
  error estimate for blocks of size 2^( 3) =       0.000516045207
  error estimate for blocks of size 2^( 4) =       0.000531352238
  error estimate for blocks of size 2^( 5) =       0.000540896700
  error estimate for blocks of size 2^( 6) =       0.000546029045
  error estimate for blocks of size 2^( 7) =       0.000549714946

      target function =      -0.744577495220
              le_mean =     -22.661231864117
             les_mean =     513.982319007690
             stat err =       0.000541998232
             autocorr =       1.329604083951
   target nu stat err =       0.000541998232
   target dn stat err =       0.002971099341
      target stat err =       0.002501049426
              std dev =       0.664739824075
             le_variance =       0.441879033711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441756544558
                                         uncertainty =       0.002314315822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441756544558
                                         uncertainty =       0.002314315822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470042010
  error estimate for blocks of size 2^( 2) =       0.000493789776
  error estimate for blocks of size 2^( 3) =       0.000516045183
  error estimate for blocks of size 2^( 4) =       0.000531352218
  error estimate for blocks of size 2^( 5) =       0.000540896683
  error estimate for blocks of size 2^( 6) =       0.000546029030
  error estimate for blocks of size 2^( 7) =       0.000549714932

      target function =      -0.744577560524
              le_mean =     -22.661231863815
             les_mean =     513.982318914177
             stat err =       0.000541998216
             autocorr =       1.329604158698
   target nu stat err =       0.000541998216
   target dn stat err =       0.002971093395
      target stat err =       0.002501045125
              std dev =       0.664739785148
             le_variance =       0.441878981958

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441756570074
                                         uncertainty =       0.002314316665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441756570074
                                         uncertainty =       0.002314316665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470042024
  error estimate for blocks of size 2^( 2) =       0.000493789788
  error estimate for blocks of size 2^( 3) =       0.000516045195
  error estimate for blocks of size 2^( 4) =       0.000531352228
  error estimate for blocks of size 2^( 5) =       0.000540896691
  error estimate for blocks of size 2^( 6) =       0.000546029037
  error estimate for blocks of size 2^( 7) =       0.000549714939

      target function =      -0.744577527903
              le_mean =     -22.661231863966
             les_mean =     513.982318960888
             stat err =       0.000541998224
             autocorr =       1.329604121340
   target nu stat err =       0.000541998224
   target dn stat err =       0.002971096367
      target stat err =       0.002501047275
              std dev =       0.664739804609
             le_variance =       0.441879007832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441756592403
                                         uncertainty =       0.002314317402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441756592403
                                         uncertainty =       0.002314317402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470042036
  error estimate for blocks of size 2^( 2) =       0.000493789799
  error estimate for blocks of size 2^( 3) =       0.000516045205
  error estimate for blocks of size 2^( 4) =       0.000531352237
  error estimate for blocks of size 2^( 5) =       0.000540896699
  error estimate for blocks of size 2^( 6) =       0.000546029044
  error estimate for blocks of size 2^( 7) =       0.000549714945

      target function =      -0.744577499308
              le_mean =     -22.661231864098
             les_mean =     513.982319001835
             stat err =       0.000541998231
             autocorr =       1.329604088622
   target nu stat err =       0.000541998231
   target dn stat err =       0.002971098969
      target stat err =       0.002501049157
              std dev =       0.664739821641
             le_variance =       0.441879030476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744577495220        initial
     8.2718e+02     8.2718e+03             2.1538e-07        -0.744577560524  <--
     3.3087e+03     3.3087e+04             5.3848e-08        -0.744577527903
     1.3235e+04     1.3235e+05             1.3462e-08        -0.744577499308

*****************************************************************************
Applying the update for shift_i =   8.2718e+02     and shift_s =   8.2718e+03
*****************************************************************************

  Execution time = 4.3550e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_001                -7.055663e-01 3 1  ON 0
ci_002                -7.029278e-01 3 1  ON 1
ci_003                -5.011538e-02 3 1  ON 2
ci_004                -5.098507e-02 3 1  ON 3
ci_005                 1.947118e-02 3 1  ON 4
ci_006                 1.976105e-02 3 1  ON 5
ci_007                 1.473387e-02 3 1  ON 6
ci_008                 1.549418e-02 3 1  ON 7
ci_009                -1.315706e-02 3 1  ON 8
ci_010                -1.205479e-02 3 1  ON 9
ci_011                -9.848906e-03 3 1  ON 10
ci_012                -9.085362e-03 3 1  ON 11
ci_013                 8.366273e-03 3 1  ON 12
ci_014                 9.298452e-03 3 1  ON 13
ci_015                 9.500030e-03 3 1  ON 14
ci_016                 9.362191e-03 3 1  ON 15
ci_017                 8.490874e-03 3 1  ON 16
ci_018                 8.266398e-03 3 1  ON 17
ci_019                -1.262495e-03 3 1  ON 18
ci_020                -1.585212e-03 3 1  ON 19
ci_021                -1.181891e-02 3 1  ON 20
ci_022                -1.183509e-02 3 1  ON 21
ci_023                 4.842770e-03 3 1  ON 22
ci_024                 4.910959e-03 3 1  ON 23
ci_025                 1.152810e-02 3 1  ON 24
ci_026                 1.152977e-02 3 1  ON 25
ci_027                 6.477094e-03 3 1  ON 26
ci_028                 6.177447e-03 3 1  ON 27
ci_029                -5.032703e-03 3 1  ON 28
ci_030                -4.115277e-03 3 1  ON 29
ci_031                 3.413445e-03 3 1  ON 30
ci_032                 4.669899e-03 3 1  ON 31
ci_033                 2.349517e-03 3 1  ON 32
ci_034                 4.108399e-03 3 1  ON 33
ci_035                 1.724067e-03 3 1  ON 34
ci_036                 2.137422e-03 3 1  ON 35
ci_037                 3.493224e-03 3 1  ON 36
ci_038                 3.700706e-03 3 1  ON 37
ci_039                 4.602588e-03 3 1  ON 38
ci_040                 4.921011e-03 3 1  ON 39
ci_041                 2.955570e-03 3 1  ON 40
ci_042                 2.734325e-03 3 1  ON 41
ci_043                 2.938981e-03 3 1  ON 42
ci_044                 3.206589e-03 3 1  ON 43
ci_045                 2.473940e-03 3 1  ON 44
ci_046                 2.735607e-03 3 1  ON 45
ci_047                -1.006529e-03 3 1  ON 46
ci_048                -8.449311e-04 3 1  ON 47
ci_049                 7.812494e-04 3 1  ON 48
ci_050                 9.955174e-04 3 1  ON 49
ci_051                -3.363761e-04 3 1  ON 50
ci_052                -1.212201e-03 3 1  ON 51
ci_053                -2.460531e-03 3 1  ON 52
ci_054                -2.689007e-03 3 1  ON 53
ci_055                -1.790768e-03 3 1  ON 54
ci_056                -1.965029e-03 3 1  ON 55
ci_057                -1.320419e-03 3 1  ON 56
ci_058                -9.968534e-04 3 1  ON 57
ci_059                -5.220287e-04 3 1  ON 58
ci_060                -7.416565e-04 3 1  ON 59
ci_061                 6.163855e-06 3 1  ON 60
ci_062                -9.078493e-04 3 1  ON 61
ci_063                -8.885394e-04 3 1  ON 62
ci_064                -5.034374e-04 3 1  ON 63
ci_065                -1.365726e-03 3 1  ON 64
ci_066                -1.881903e-03 3 1  ON 65
ci_067                -1.824284e-03 3 1  ON 66
ci_068                -1.480831e-03 3 1  ON 67
ci_069                -5.507426e-04 3 1  ON 68
ci_070                -4.209146e-04 3 1  ON 69
ci_071                -2.065019e-03 3 1  ON 70
ci_072                -1.992107e-03 3 1  ON 71
ci_073                 1.591434e-04 3 1  ON 72
ci_074                 1.767586e-04 3 1  ON 73
ci_075                 1.714791e-04 3 1  ON 74
ci_076                 7.920686e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4547e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.6718
    reference variance = 0.53758
====================================================
  Execution time = 2.6701e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5045e-01
  Total weights = 1.954834748e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441580396363
                                         uncertainty =       0.002230763837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441580396363
                                         uncertainty =       0.002230763837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469850639
  error estimate for blocks of size 2^( 2) =       0.000493931086
  error estimate for blocks of size 2^( 3) =       0.000516395929
  error estimate for blocks of size 2^( 4) =       0.000532063231
  error estimate for blocks of size 2^( 5) =       0.000541315554
  error estimate for blocks of size 2^( 6) =       0.000546868384
  error estimate for blocks of size 2^( 7) =       0.000548586639

      target function =      -0.744952514850
              le_mean =     -22.662926374993
             les_mean =     514.058685339293
             stat err =       0.000542208452
             autocorr =       1.331720000844
   target nu stat err =       0.000542208452
   target dn stat err =       0.002647195214
      target stat err =       0.002252581887
              std dev =       0.664469146224
             le_variance =       0.441519246283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266292637499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+02, overlap shift 2.0680e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744958356530       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744958426140       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744958438161       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744958439681       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744958439927       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744958439820       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744958439949       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744958439964       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744958439972       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+02 is 1.077613e-06

solving harmonic davidson linear method for identity shift 8.2718e+02, overlap shift 8.2718e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744958356530       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744958373936       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744958376941       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744958377321       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744958377383       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744958377356       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744958377387       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744958377393       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744958377394       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+02 is 2.694413e-07

solving harmonic davidson linear method for identity shift 3.3087e+03, overlap shift 3.3087e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744958356530       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744958360882       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744958361633       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744958361728       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744958361744       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744958361734       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744958361752       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744958361744       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744958361749       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+03 is 6.736271e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.340664 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1423e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_001                -7.055663e-01 3 1  ON 0
ci_002                -7.029278e-01 3 1  ON 1
ci_003                -5.011535e-02 3 1  ON 2
ci_004                -5.098499e-02 3 1  ON 3
ci_005                 1.947112e-02 3 1  ON 4
ci_006                 1.976094e-02 3 1  ON 5
ci_007                 1.473383e-02 3 1  ON 6
ci_008                 1.549418e-02 3 1  ON 7
ci_009                -1.315702e-02 3 1  ON 8
ci_010                -1.205477e-02 3 1  ON 9
ci_011                -9.848828e-03 3 1  ON 10
ci_012                -9.085320e-03 3 1  ON 11
ci_013                 8.366303e-03 3 1  ON 12
ci_014                 9.298327e-03 3 1  ON 13
ci_015                 9.500010e-03 3 1  ON 14
ci_016                 9.362237e-03 3 1  ON 15
ci_017                 8.490795e-03 3 1  ON 16
ci_018                 8.266406e-03 3 1  ON 17
ci_019                -1.262764e-03 3 1  ON 18
ci_020                -1.585359e-03 3 1  ON 19
ci_021                -1.181909e-02 3 1  ON 20
ci_022                -1.183520e-02 3 1  ON 21
ci_023                 4.842744e-03 3 1  ON 22
ci_024                 4.910967e-03 3 1  ON 23
ci_025                 1.152822e-02 3 1  ON 24
ci_026                 1.152980e-02 3 1  ON 25
ci_027                 6.477071e-03 3 1  ON 26
ci_028                 6.177451e-03 3 1  ON 27
ci_029                -5.032656e-03 3 1  ON 28
ci_030                -4.115310e-03 3 1  ON 29
ci_031                 3.413636e-03 3 1  ON 30
ci_032                 4.669856e-03 3 1  ON 31
ci_033                 2.349586e-03 3 1  ON 32
ci_034                 4.108289e-03 3 1  ON 33
ci_035                 1.724083e-03 3 1  ON 34
ci_036                 2.137425e-03 3 1  ON 35
ci_037                 3.493215e-03 3 1  ON 36
ci_038                 3.700695e-03 3 1  ON 37
ci_039                 4.602609e-03 3 1  ON 38
ci_040                 4.921019e-03 3 1  ON 39
ci_041                 2.955610e-03 3 1  ON 40
ci_042                 2.734329e-03 3 1  ON 41
ci_043                 2.938919e-03 3 1  ON 42
ci_044                 3.206538e-03 3 1  ON 43
ci_045                 2.473927e-03 3 1  ON 44
ci_046                 2.735678e-03 3 1  ON 45
ci_047                -1.006520e-03 3 1  ON 46
ci_048                -8.449428e-04 3 1  ON 47
ci_049                 7.812570e-04 3 1  ON 48
ci_050                 9.954784e-04 3 1  ON 49
ci_051                -3.363948e-04 3 1  ON 50
ci_052                -1.212209e-03 3 1  ON 51
ci_053                -2.460660e-03 3 1  ON 52
ci_054                -2.688922e-03 3 1  ON 53
ci_055                -1.790751e-03 3 1  ON 54
ci_056                -1.964910e-03 3 1  ON 55
ci_057                -1.320408e-03 3 1  ON 56
ci_058                -9.968354e-04 3 1  ON 57
ci_059                -5.220192e-04 3 1  ON 58
ci_060                -7.416240e-04 3 1  ON 59
ci_061                 6.132101e-06 3 1  ON 60
ci_062                -9.077526e-04 3 1  ON 61
ci_063                -8.885362e-04 3 1  ON 62
ci_064                -5.033818e-04 3 1  ON 63
ci_065                -1.365841e-03 3 1  ON 64
ci_066                -1.881900e-03 3 1  ON 65
ci_067                -1.824261e-03 3 1  ON 66
ci_068                -1.480896e-03 3 1  ON 67
ci_069                -5.506834e-04 3 1  ON 68
ci_070                -4.208818e-04 3 1  ON 69
ci_071                -2.065061e-03 3 1  ON 70
ci_072                -1.992113e-03 3 1  ON 71
ci_073                 1.590810e-04 3 1  ON 72
ci_074                 1.767286e-04 3 1  ON 73
ci_075                 1.715788e-04 3 1  ON 74
ci_076                 7.920686e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.6258
    reference variance = 0.380178
====================================================
  Execution time = 2.5530e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5483e-01
  Total weights = 1.9551e+06
  Execution time = 3.6029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442540057222
                                         uncertainty =       0.003485615409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442540057222
                                         uncertainty =       0.003485615409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470355710
  error estimate for blocks of size 2^( 2) =       0.000494608042
  error estimate for blocks of size 2^( 3) =       0.000517202012
  error estimate for blocks of size 2^( 4) =       0.000532899846
  error estimate for blocks of size 2^( 5) =       0.000541784975
  error estimate for blocks of size 2^( 6) =       0.000546154995
  error estimate for blocks of size 2^( 7) =       0.000550860957

      target function =      -0.741348314114
              le_mean =     -22.660953586513
             les_mean =     513.973649469871
             stat err =       0.000542925193
             autocorr =       1.332377066975
   target nu stat err =       0.000542925193
   target dn stat err =       0.005392380638
      target stat err =       0.004409132045
              std dev =       0.665183423559
             le_variance =       0.442468986977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442539829523
                                         uncertainty =       0.003485520819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442539829523
                                         uncertainty =       0.003485520819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470355589
  error estimate for blocks of size 2^( 2) =       0.000494607938
  error estimate for blocks of size 2^( 3) =       0.000517201912
  error estimate for blocks of size 2^( 4) =       0.000532899750
  error estimate for blocks of size 2^( 5) =       0.000541784870
  error estimate for blocks of size 2^( 6) =       0.000546154882
  error estimate for blocks of size 2^( 7) =       0.000550860852

      target function =      -0.741348013371
              le_mean =     -22.660953591420
             les_mean =     513.973650062875
             stat err =       0.000542925088
             autocorr =       1.332377235271
   target nu stat err =       0.000542925088
   target dn stat err =       0.005392439554
      target stat err =       0.004409175821
              std dev =       0.665183252746
             le_variance =       0.442468759734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442539943342
                                         uncertainty =       0.003485568106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442539943342
                                         uncertainty =       0.003485568106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470355649
  error estimate for blocks of size 2^( 2) =       0.000494607990
  error estimate for blocks of size 2^( 3) =       0.000517201962
  error estimate for blocks of size 2^( 4) =       0.000532899798
  error estimate for blocks of size 2^( 5) =       0.000541784922
  error estimate for blocks of size 2^( 6) =       0.000546154938
  error estimate for blocks of size 2^( 7) =       0.000550860905

      target function =      -0.741348164842
              le_mean =     -22.660953588965
             les_mean =     513.973649764940
             stat err =       0.000542925141
             autocorr =       1.332377151147
   target nu stat err =       0.000542925141
   target dn stat err =       0.005392410081
      target stat err =       0.004409153934
              std dev =       0.665183338129
             le_variance =       0.442468873325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442540042984
                                         uncertainty =       0.003485609496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442540042984
                                         uncertainty =       0.003485609496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470355702
  error estimate for blocks of size 2^( 2) =       0.000494608036
  error estimate for blocks of size 2^( 3) =       0.000517202005
  error estimate for blocks of size 2^( 4) =       0.000532899840
  error estimate for blocks of size 2^( 5) =       0.000541784968
  error estimate for blocks of size 2^( 6) =       0.000546154988
  error estimate for blocks of size 2^( 7) =       0.000550860951

      target function =      -0.741348295577
              le_mean =     -22.660953586819
             les_mean =     513.973649506594
             stat err =       0.000542925187
             autocorr =       1.332377077497
   target nu stat err =       0.000542925187
   target dn stat err =       0.005392384316
      target stat err =       0.004409134781
              std dev =       0.665183412878
             le_variance =       0.442468972768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741348314114        initial  <--
     2.0680e+02     2.0680e+03             1.0776e-06        -0.741348013371
     8.2718e+02     8.2718e+03             2.6944e-07        -0.741348164842
     3.3087e+03     3.3087e+04             6.7363e-08        -0.741348295577

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6114
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_001                -7.055663e-01 3 1  ON 0
ci_002                -7.029278e-01 3 1  ON 1
ci_003                -5.011538e-02 3 1  ON 2
ci_004                -5.098507e-02 3 1  ON 3
ci_005                 1.947118e-02 3 1  ON 4
ci_006                 1.976105e-02 3 1  ON 5
ci_007                 1.473387e-02 3 1  ON 6
ci_008                 1.549418e-02 3 1  ON 7
ci_009                -1.315706e-02 3 1  ON 8
ci_010                -1.205479e-02 3 1  ON 9
ci_011                -9.848906e-03 3 1  ON 10
ci_012                -9.085362e-03 3 1  ON 11
ci_013                 8.366273e-03 3 1  ON 12
ci_014                 9.298452e-03 3 1  ON 13
ci_015                 9.500030e-03 3 1  ON 14
ci_016                 9.362191e-03 3 1  ON 15
ci_017                 8.490874e-03 3 1  ON 16
ci_018                 8.266398e-03 3 1  ON 17
ci_019                -1.262495e-03 3 1  ON 18
ci_020                -1.585212e-03 3 1  ON 19
ci_021                -1.181891e-02 3 1  ON 20
ci_022                -1.183509e-02 3 1  ON 21
ci_023                 4.842770e-03 3 1  ON 22
ci_024                 4.910959e-03 3 1  ON 23
ci_025                 1.152810e-02 3 1  ON 24
ci_026                 1.152977e-02 3 1  ON 25
ci_027                 6.477094e-03 3 1  ON 26
ci_028                 6.177447e-03 3 1  ON 27
ci_029                -5.032703e-03 3 1  ON 28
ci_030                -4.115277e-03 3 1  ON 29
ci_031                 3.413445e-03 3 1  ON 30
ci_032                 4.669899e-03 3 1  ON 31
ci_033                 2.349517e-03 3 1  ON 32
ci_034                 4.108399e-03 3 1  ON 33
ci_035                 1.724067e-03 3 1  ON 34
ci_036                 2.137422e-03 3 1  ON 35
ci_037                 3.493224e-03 3 1  ON 36
ci_038                 3.700706e-03 3 1  ON 37
ci_039                 4.602588e-03 3 1  ON 38
ci_040                 4.921011e-03 3 1  ON 39
ci_041                 2.955570e-03 3 1  ON 40
ci_042                 2.734325e-03 3 1  ON 41
ci_043                 2.938981e-03 3 1  ON 42
ci_044                 3.206589e-03 3 1  ON 43
ci_045                 2.473940e-03 3 1  ON 44
ci_046                 2.735607e-03 3 1  ON 45
ci_047                -1.006529e-03 3 1  ON 46
ci_048                -8.449311e-04 3 1  ON 47
ci_049                 7.812494e-04 3 1  ON 48
ci_050                 9.955174e-04 3 1  ON 49
ci_051                -3.363761e-04 3 1  ON 50
ci_052                -1.212201e-03 3 1  ON 51
ci_053                -2.460531e-03 3 1  ON 52
ci_054                -2.689007e-03 3 1  ON 53
ci_055                -1.790768e-03 3 1  ON 54
ci_056                -1.965029e-03 3 1  ON 55
ci_057                -1.320419e-03 3 1  ON 56
ci_058                -9.968534e-04 3 1  ON 57
ci_059                -5.220287e-04 3 1  ON 58
ci_060                -7.416565e-04 3 1  ON 59
ci_061                 6.163855e-06 3 1  ON 60
ci_062                -9.078493e-04 3 1  ON 61
ci_063                -8.885394e-04 3 1  ON 62
ci_064                -5.034374e-04 3 1  ON 63
ci_065                -1.365726e-03 3 1  ON 64
ci_066                -1.881903e-03 3 1  ON 65
ci_067                -1.824284e-03 3 1  ON 66
ci_068                -1.480831e-03 3 1  ON 67
ci_069                -5.507426e-04 3 1  ON 68
ci_070                -4.209146e-04 3 1  ON 69
ci_071                -2.065019e-03 3 1  ON 70
ci_072                -1.992107e-03 3 1  ON 71
ci_073                 1.591434e-04 3 1  ON 72
ci_074                 1.767586e-04 3 1  ON 73
ci_075                 1.714791e-04 3 1  ON 74
ci_076                 7.920686e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5040e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6586
    reference variance = 0.409902
====================================================
  Execution time = 2.8099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4879e-01
  Total weights = 1.955260178e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439686835584
                                         uncertainty =       0.001955702339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439686835584
                                         uncertainty =       0.001955702339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468865003
  error estimate for blocks of size 2^( 2) =       0.000492664746
  error estimate for blocks of size 2^( 3) =       0.000514654883
  error estimate for blocks of size 2^( 4) =       0.000530897899
  error estimate for blocks of size 2^( 5) =       0.000539906529
  error estimate for blocks of size 2^( 6) =       0.000546938605
  error estimate for blocks of size 2^( 7) =       0.000550890992

      target function =      -0.746313798035
              le_mean =     -22.661982240975
             les_mean =     514.014225011934
             stat err =       0.000542158506
             autocorr =       1.337078539198
   target nu stat err =       0.000542158506
   target dn stat err =       0.002357121937
      target stat err =       0.002028312228
              std dev =       0.663075245518
             le_variance =       0.439668781218


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266198224098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+03, overlap shift 2.0680e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746318350354       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746318360379       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746318361958       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746318362277       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746318362337       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746318362375       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746318362353       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746318362350       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746318362338       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746318362339       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746318362338       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+03 is 1.132656e-07

solving harmonic davidson linear method for identity shift 8.2718e+03, overlap shift 8.2718e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746318350354       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746318352860       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746318353255       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746318353335       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746318353350       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746318353360       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746318353364       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746318353347       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746318353360       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746318353347       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746318353363       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+03 is 2.831679e-08

solving harmonic davidson linear method for identity shift 3.3087e+04, overlap shift 3.3087e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746318350354       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746318350981       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746318351080       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746318351100       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746318351103       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746318351089       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746318351191       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746318351093       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746318351104       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746318351079       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746318351104       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+04 is 7.079223e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344855 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2832e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_001                -7.055663e-01 3 1  ON 0
ci_002                -7.029278e-01 3 1  ON 1
ci_003                -5.011539e-02 3 1  ON 2
ci_004                -5.098506e-02 3 1  ON 3
ci_005                 1.947118e-02 3 1  ON 4
ci_006                 1.976105e-02 3 1  ON 5
ci_007                 1.473388e-02 3 1  ON 6
ci_008                 1.549417e-02 3 1  ON 7
ci_009                -1.315704e-02 3 1  ON 8
ci_010                -1.205479e-02 3 1  ON 9
ci_011                -9.848908e-03 3 1  ON 10
ci_012                -9.085359e-03 3 1  ON 11
ci_013                 8.366265e-03 3 1  ON 12
ci_014                 9.298443e-03 3 1  ON 13
ci_015                 9.500018e-03 3 1  ON 14
ci_016                 9.362186e-03 3 1  ON 15
ci_017                 8.490859e-03 3 1  ON 16
ci_018                 8.266402e-03 3 1  ON 17
ci_019                -1.262520e-03 3 1  ON 18
ci_020                -1.585241e-03 3 1  ON 19
ci_021                -1.181892e-02 3 1  ON 20
ci_022                -1.183510e-02 3 1  ON 21
ci_023                 4.842766e-03 3 1  ON 22
ci_024                 4.910957e-03 3 1  ON 23
ci_025                 1.152811e-02 3 1  ON 24
ci_026                 1.152979e-02 3 1  ON 25
ci_027                 6.477088e-03 3 1  ON 26
ci_028                 6.177448e-03 3 1  ON 27
ci_029                -5.032691e-03 3 1  ON 28
ci_030                -4.115280e-03 3 1  ON 29
ci_031                 3.413465e-03 3 1  ON 30
ci_032                 4.669892e-03 3 1  ON 31
ci_033                 2.349522e-03 3 1  ON 32
ci_034                 4.108393e-03 3 1  ON 33
ci_035                 1.724065e-03 3 1  ON 34
ci_036                 2.137418e-03 3 1  ON 35
ci_037                 3.493227e-03 3 1  ON 36
ci_038                 3.700688e-03 3 1  ON 37
ci_039                 4.602586e-03 3 1  ON 38
ci_040                 4.921008e-03 3 1  ON 39
ci_041                 2.955569e-03 3 1  ON 40
ci_042                 2.734323e-03 3 1  ON 41
ci_043                 2.938982e-03 3 1  ON 42
ci_044                 3.206585e-03 3 1  ON 43
ci_045                 2.473947e-03 3 1  ON 44
ci_046                 2.735596e-03 3 1  ON 45
ci_047                -1.006531e-03 3 1  ON 46
ci_048                -8.449329e-04 3 1  ON 47
ci_049                 7.812554e-04 3 1  ON 48
ci_050                 9.955142e-04 3 1  ON 49
ci_051                -3.363848e-04 3 1  ON 50
ci_052                -1.212201e-03 3 1  ON 51
ci_053                -2.460523e-03 3 1  ON 52
ci_054                -2.689003e-03 3 1  ON 53
ci_055                -1.790771e-03 3 1  ON 54
ci_056                -1.965024e-03 3 1  ON 55
ci_057                -1.320411e-03 3 1  ON 56
ci_058                -9.968563e-04 3 1  ON 57
ci_059                -5.220234e-04 3 1  ON 58
ci_060                -7.416567e-04 3 1  ON 59
ci_061                 6.163671e-06 3 1  ON 60
ci_062                -9.078463e-04 3 1  ON 61
ci_063                -8.885448e-04 3 1  ON 62
ci_064                -5.034297e-04 3 1  ON 63
ci_065                -1.365724e-03 3 1  ON 64
ci_066                -1.881895e-03 3 1  ON 65
ci_067                -1.824285e-03 3 1  ON 66
ci_068                -1.480828e-03 3 1  ON 67
ci_069                -5.507412e-04 3 1  ON 68
ci_070                -4.209124e-04 3 1  ON 69
ci_071                -2.065026e-03 3 1  ON 70
ci_072                -1.992099e-03 3 1  ON 71
ci_073                 1.591408e-04 3 1  ON 72
ci_074                 1.767588e-04 3 1  ON 73
ci_075                 1.714799e-04 3 1  ON 74
ci_076                 7.920660e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.5523
    reference variance = 0.245116
====================================================
  Execution time = 2.5600e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4841e-01
  Total weights = 1.9553e+06
  Execution time = 4.1783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438679216287
                                         uncertainty =       0.001957989784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438679216287
                                         uncertainty =       0.001957989784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468333965
  error estimate for blocks of size 2^( 2) =       0.000492563151
  error estimate for blocks of size 2^( 3) =       0.000514948557
  error estimate for blocks of size 2^( 4) =       0.000530596865
  error estimate for blocks of size 2^( 5) =       0.000540994011
  error estimate for blocks of size 2^( 6) =       0.000547538693
  error estimate for blocks of size 2^( 7) =       0.000550846807

      target function =      -0.746617202803
              le_mean =     -22.661918603143
             les_mean =     514.010969493992
             stat err =       0.000542494094
             autocorr =       1.341771982383
   target nu stat err =       0.000542494094
   target dn stat err =       0.002608481407
      target stat err =       0.002228317036
              std dev =       0.662324244609
             le_variance =       0.438673404997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438679202754
                                         uncertainty =       0.001957989676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438679202754
                                         uncertainty =       0.001957989676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468333957
  error estimate for blocks of size 2^( 2) =       0.000492563145
  error estimate for blocks of size 2^( 3) =       0.000514948553
  error estimate for blocks of size 2^( 4) =       0.000530596860
  error estimate for blocks of size 2^( 5) =       0.000540994007
  error estimate for blocks of size 2^( 6) =       0.000547538690
  error estimate for blocks of size 2^( 7) =       0.000550846805

      target function =      -0.746617298385
              le_mean =     -22.661918603824
             les_mean =     514.010969408694
             stat err =       0.000542494091
             autocorr =       1.341772007933
   target nu stat err =       0.000542494091
   target dn stat err =       0.002608489147
      target stat err =       0.002228323724
              std dev =       0.662324234377
             le_variance =       0.438673391443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438679209520
                                         uncertainty =       0.001957989730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438679209520
                                         uncertainty =       0.001957989730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468333961
  error estimate for blocks of size 2^( 2) =       0.000492563148
  error estimate for blocks of size 2^( 3) =       0.000514948555
  error estimate for blocks of size 2^( 4) =       0.000530596863
  error estimate for blocks of size 2^( 5) =       0.000540994009
  error estimate for blocks of size 2^( 6) =       0.000547538692
  error estimate for blocks of size 2^( 7) =       0.000550846806

      target function =      -0.746617250606
              le_mean =     -22.661918603483
             les_mean =     514.010969451328
             stat err =       0.000542494092
             autocorr =       1.341771995167
   target nu stat err =       0.000542494092
   target dn stat err =       0.002608485276
      target stat err =       0.002228320379
              std dev =       0.662324239493
             le_variance =       0.438673398220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438679215441
                                         uncertainty =       0.001957989777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438679215441
                                         uncertainty =       0.001957989777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468333964
  error estimate for blocks of size 2^( 2) =       0.000492563151
  error estimate for blocks of size 2^( 3) =       0.000514948557
  error estimate for blocks of size 2^( 4) =       0.000530596864
  error estimate for blocks of size 2^( 5) =       0.000540994011
  error estimate for blocks of size 2^( 6) =       0.000547538693
  error estimate for blocks of size 2^( 7) =       0.000550846807

      target function =      -0.746617208779
              le_mean =     -22.661918603185
             les_mean =     514.010969488658
             stat err =       0.000542494094
             autocorr =       1.341771983982
   target nu stat err =       0.000542494094
   target dn stat err =       0.002608481890
      target stat err =       0.002228317454
              std dev =       0.662324243970
             le_variance =       0.438673404150


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746617202803        initial
     2.0680e+03     2.0680e+04             1.1327e-07        -0.746617298385  <--
     8.2718e+03     8.2718e+04             2.8317e-08        -0.746617250606
     3.3087e+04     3.3087e+05             7.0792e-09        -0.746617208779

*****************************************************************************
Applying the update for shift_i =   2.0680e+03     and shift_s =   2.0680e+04
*****************************************************************************

  Execution time = 4.4333e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_001                -7.055663e-01 3 1  ON 0
ci_002                -7.029279e-01 3 1  ON 1
ci_003                -5.011540e-02 3 1  ON 2
ci_004                -5.098504e-02 3 1  ON 3
ci_005                 1.947116e-02 3 1  ON 4
ci_006                 1.976102e-02 3 1  ON 5
ci_007                 1.473389e-02 3 1  ON 6
ci_008                 1.549413e-02 3 1  ON 7
ci_009                -1.315698e-02 3 1  ON 8
ci_010                -1.205480e-02 3 1  ON 9
ci_011                -9.848914e-03 3 1  ON 10
ci_012                -9.085350e-03 3 1  ON 11
ci_013                 8.366240e-03 3 1  ON 12
ci_014                 9.298419e-03 3 1  ON 13
ci_015                 9.499983e-03 3 1  ON 14
ci_016                 9.362169e-03 3 1  ON 15
ci_017                 8.490815e-03 3 1  ON 16
ci_018                 8.266414e-03 3 1  ON 17
ci_019                -1.262594e-03 3 1  ON 18
ci_020                -1.585326e-03 3 1  ON 19
ci_021                -1.181893e-02 3 1  ON 20
ci_022                -1.183514e-02 3 1  ON 21
ci_023                 4.842753e-03 3 1  ON 22
ci_024                 4.910950e-03 3 1  ON 23
ci_025                 1.152816e-02 3 1  ON 24
ci_026                 1.152985e-02 3 1  ON 25
ci_027                 6.477070e-03 3 1  ON 26
ci_028                 6.177451e-03 3 1  ON 27
ci_029                -5.032656e-03 3 1  ON 28
ci_030                -4.115290e-03 3 1  ON 29
ci_031                 3.413525e-03 3 1  ON 30
ci_032                 4.669871e-03 3 1  ON 31
ci_033                 2.349535e-03 3 1  ON 32
ci_034                 4.108376e-03 3 1  ON 33
ci_035                 1.724059e-03 3 1  ON 34
ci_036                 2.137404e-03 3 1  ON 35
ci_037                 3.493235e-03 3 1  ON 36
ci_038                 3.700636e-03 3 1  ON 37
ci_039                 4.602582e-03 3 1  ON 38
ci_040                 4.920999e-03 3 1  ON 39
ci_041                 2.955565e-03 3 1  ON 40
ci_042                 2.734317e-03 3 1  ON 41
ci_043                 2.938985e-03 3 1  ON 42
ci_044                 3.206571e-03 3 1  ON 43
ci_045                 2.473966e-03 3 1  ON 44
ci_046                 2.735566e-03 3 1  ON 45
ci_047                -1.006535e-03 3 1  ON 46
ci_048                -8.449382e-04 3 1  ON 47
ci_049                 7.812733e-04 3 1  ON 48
ci_050                 9.955045e-04 3 1  ON 49
ci_051                -3.364109e-04 3 1  ON 50
ci_052                -1.212200e-03 3 1  ON 51
ci_053                -2.460501e-03 3 1  ON 52
ci_054                -2.688988e-03 3 1  ON 53
ci_055                -1.790781e-03 3 1  ON 54
ci_056                -1.965009e-03 3 1  ON 55
ci_057                -1.320385e-03 3 1  ON 56
ci_058                -9.968650e-04 3 1  ON 57
ci_059                -5.220075e-04 3 1  ON 58
ci_060                -7.416573e-04 3 1  ON 59
ci_061                 6.163119e-06 3 1  ON 60
ci_062                -9.078373e-04 3 1  ON 61
ci_063                -8.885611e-04 3 1  ON 62
ci_064                -5.034066e-04 3 1  ON 63
ci_065                -1.365716e-03 3 1  ON 64
ci_066                -1.881871e-03 3 1  ON 65
ci_067                -1.824287e-03 3 1  ON 66
ci_068                -1.480818e-03 3 1  ON 67
ci_069                -5.507370e-04 3 1  ON 68
ci_070                -4.209059e-04 3 1  ON 69
ci_071                -2.065046e-03 3 1  ON 70
ci_072                -1.992076e-03 3 1  ON 71
ci_073                 1.591332e-04 3 1  ON 72
ci_074                 1.767596e-04 3 1  ON 73
ci_075                 1.714823e-04 3 1  ON 74
ci_076                 7.920579e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7217e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.6613
    reference variance = 0.323294
====================================================
  Execution time = 2.6242e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5886e-01
  Total weights = 1.954608643e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448544293130
                                         uncertainty =       0.003246186140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448544293130
                                         uncertainty =       0.003246186140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473570226
  error estimate for blocks of size 2^( 2) =       0.000497522817
  error estimate for blocks of size 2^( 3) =       0.000519391784
  error estimate for blocks of size 2^( 4) =       0.000535201296
  error estimate for blocks of size 2^( 5) =       0.000545149503
  error estimate for blocks of size 2^( 6) =       0.000547150271
  error estimate for blocks of size 2^( 7) =       0.000550837381

      target function =      -0.738111640221
              le_mean =     -22.661707246980
             les_mean =     514.011838621740
             stat err =       0.000544584613
             autocorr =       1.322397296115
   target nu stat err =       0.000544584613
   target dn stat err =       0.003575112519
      target stat err =       0.002935107755
              std dev =       0.669729436436
             le_variance =       0.448537518029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266170724698e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+02, overlap shift 5.1699e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738122307399       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738122358350       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738122367775       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738122369403       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738122369494       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738122369877       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738122370097       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738122370178       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738122370189       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738122370218       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738122370226       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738122370233       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+02 is 4.447240e-07

solving harmonic davidson linear method for identity shift 2.0680e+03, overlap shift 2.0680e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738122307399       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738122320138       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738122322494       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738122322901       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738122322924       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738122323019       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738122323073       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738122323096       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738122323098       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738122323105       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738122323107       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738122323115       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+03 is 1.111871e-07

solving harmonic davidson linear method for identity shift 8.2718e+03, overlap shift 8.2718e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.738122307399       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.738122310584       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.738122311173       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.738122311275       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.738122311279       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.738122311304       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738122311318       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738122311329       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738122311324       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738122311326       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738122311326       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738122311325       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+03 is 2.779716e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.349760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1002e+01
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_001                -7.055662e-01 3 1  ON 0
ci_002                -7.029280e-01 3 1  ON 1
ci_003                -5.011541e-02 3 1  ON 2
ci_004                -5.098502e-02 3 1  ON 3
ci_005                 1.947108e-02 3 1  ON 4
ci_006                 1.976096e-02 3 1  ON 5
ci_007                 1.473388e-02 3 1  ON 6
ci_008                 1.549410e-02 3 1  ON 7
ci_009                -1.315693e-02 3 1  ON 8
ci_010                -1.205476e-02 3 1  ON 9
ci_011                -9.848888e-03 3 1  ON 10
ci_012                -9.085337e-03 3 1  ON 11
ci_013                 8.366207e-03 3 1  ON 12
ci_014                 9.298355e-03 3 1  ON 13
ci_015                 9.499955e-03 3 1  ON 14
ci_016                 9.362142e-03 3 1  ON 15
ci_017                 8.490782e-03 3 1  ON 16
ci_018                 8.266409e-03 3 1  ON 17
ci_019                -1.262705e-03 3 1  ON 18
ci_020                -1.585409e-03 3 1  ON 19
ci_021                -1.181888e-02 3 1  ON 20
ci_022                -1.183518e-02 3 1  ON 21
ci_023                 4.842766e-03 3 1  ON 22
ci_024                 4.910972e-03 3 1  ON 23
ci_025                 1.152819e-02 3 1  ON 24
ci_026                 1.152994e-02 3 1  ON 25
ci_027                 6.477049e-03 3 1  ON 26
ci_028                 6.177469e-03 3 1  ON 27
ci_029                -5.032690e-03 3 1  ON 28
ci_030                -4.115255e-03 3 1  ON 29
ci_031                 3.413614e-03 3 1  ON 30
ci_032                 4.669912e-03 3 1  ON 31
ci_033                 2.349555e-03 3 1  ON 32
ci_034                 4.108381e-03 3 1  ON 33
ci_035                 1.724059e-03 3 1  ON 34
ci_036                 2.137400e-03 3 1  ON 35
ci_037                 3.493155e-03 3 1  ON 36
ci_038                 3.700633e-03 3 1  ON 37
ci_039                 4.602559e-03 3 1  ON 38
ci_040                 4.920987e-03 3 1  ON 39
ci_041                 2.955536e-03 3 1  ON 40
ci_042                 2.734315e-03 3 1  ON 41
ci_043                 2.939009e-03 3 1  ON 42
ci_044                 3.206561e-03 3 1  ON 43
ci_045                 2.473958e-03 3 1  ON 44
ci_046                 2.735552e-03 3 1  ON 45
ci_047                -1.006499e-03 3 1  ON 46
ci_048                -8.449340e-04 3 1  ON 47
ci_049                 7.812728e-04 3 1  ON 48
ci_050                 9.954951e-04 3 1  ON 49
ci_051                -3.364880e-04 3 1  ON 50
ci_052                -1.212187e-03 3 1  ON 51
ci_053                -2.460516e-03 3 1  ON 52
ci_054                -2.688990e-03 3 1  ON 53
ci_055                -1.790802e-03 3 1  ON 54
ci_056                -1.965006e-03 3 1  ON 55
ci_057                -1.320366e-03 3 1  ON 56
ci_058                -9.968711e-04 3 1  ON 57
ci_059                -5.220184e-04 3 1  ON 58
ci_060                -7.416138e-04 3 1  ON 59
ci_061                 6.161421e-06 3 1  ON 60
ci_062                -9.077914e-04 3 1  ON 61
ci_063                -8.885777e-04 3 1  ON 62
ci_064                -5.033813e-04 3 1  ON 63
ci_065                -1.365695e-03 3 1  ON 64
ci_066                -1.881847e-03 3 1  ON 65
ci_067                -1.824262e-03 3 1  ON 66
ci_068                -1.480805e-03 3 1  ON 67
ci_069                -5.507418e-04 3 1  ON 68
ci_070                -4.209141e-04 3 1  ON 69
ci_071                -2.065002e-03 3 1  ON 70
ci_072                -1.992067e-03 3 1  ON 71
ci_073                 1.591189e-04 3 1  ON 72
ci_074                 1.767489e-04 3 1  ON 73
ci_075                 1.714796e-04 3 1  ON 74
ci_076                 7.920732e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.6651
    reference variance = 0.433151
====================================================
  Execution time = 2.5366e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5305e-01
  Total weights = 1.9552e+06
  Execution time = 3.6012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442406701530
                                         uncertainty =       0.002802778185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442406701530
                                         uncertainty =       0.002802778185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470305027
  error estimate for blocks of size 2^( 2) =       0.000494531304
  error estimate for blocks of size 2^( 3) =       0.000516279633
  error estimate for blocks of size 2^( 4) =       0.000532079859
  error estimate for blocks of size 2^( 5) =       0.000541561883
  error estimate for blocks of size 2^( 6) =       0.000545965976
  error estimate for blocks of size 2^( 7) =       0.000547711356

      target function =      -0.742808400307
              le_mean =     -22.661182217008
             les_mean =     513.982228445859
             stat err =       0.000541829768
             autocorr =       1.327292017367
   target nu stat err =       0.000541829768
   target dn stat err =       0.004137306643
      target stat err =       0.003418359275
              std dev =       0.665111747149
             le_variance =       0.442373636196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442406523668
                                         uncertainty =       0.002802767336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442406523668
                                         uncertainty =       0.002802767336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470304932
  error estimate for blocks of size 2^( 2) =       0.000494531226
  error estimate for blocks of size 2^( 3) =       0.000516279564
  error estimate for blocks of size 2^( 4) =       0.000532079794
  error estimate for blocks of size 2^( 5) =       0.000541561814
  error estimate for blocks of size 2^( 6) =       0.000545965918
  error estimate for blocks of size 2^( 7) =       0.000547711287

      target function =      -0.742808664346
              le_mean =     -22.661182222650
             les_mean =     513.982228377552
             stat err =       0.000541829703
             autocorr =       1.327292231374
   target nu stat err =       0.000541829703
   target dn stat err =       0.004137253819
      target stat err =       0.003418319354
              std dev =       0.665111613678
             le_variance =       0.442373458649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442406612582
                                         uncertainty =       0.002802772759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442406612582
                                         uncertainty =       0.002802772759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470304979
  error estimate for blocks of size 2^( 2) =       0.000494531265
  error estimate for blocks of size 2^( 3) =       0.000516279598
  error estimate for blocks of size 2^( 4) =       0.000532079826
  error estimate for blocks of size 2^( 5) =       0.000541561849
  error estimate for blocks of size 2^( 6) =       0.000545965947
  error estimate for blocks of size 2^( 7) =       0.000547711321

      target function =      -0.742808532660
              le_mean =     -22.661182219829
             les_mean =     513.982228411278
             stat err =       0.000541829736
             autocorr =       1.327292124372
   target nu stat err =       0.000541829736
   target dn stat err =       0.004137280215
      target stat err =       0.003418339304
              std dev =       0.665111680400
             le_variance =       0.442373547405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442406690410
                                         uncertainty =       0.002802777506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442406690410
                                         uncertainty =       0.002802777506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470305021
  error estimate for blocks of size 2^( 2) =       0.000494531299
  error estimate for blocks of size 2^( 3) =       0.000516279628
  error estimate for blocks of size 2^( 4) =       0.000532079855
  error estimate for blocks of size 2^( 5) =       0.000541561879
  error estimate for blocks of size 2^( 6) =       0.000545965973
  error estimate for blocks of size 2^( 7) =       0.000547711351

      target function =      -0.742808416887
              le_mean =     -22.661182217361
             les_mean =     513.982228441489
             stat err =       0.000541829764
             autocorr =       1.327292030739
   target nu stat err =       0.000541829764
   target dn stat err =       0.004137303338
      target stat err =       0.003418356777
              std dev =       0.665111738804
             le_variance =       0.442373625095


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742808400307        initial
     5.1699e+02     5.1699e+03             4.4472e-07        -0.742808664346  <--
     2.0680e+03     2.0680e+04             1.1119e-07        -0.742808532660
     8.2718e+03     8.2718e+04             2.7797e-08        -0.742808416887

*****************************************************************************
Applying the update for shift_i =   5.1699e+02     and shift_s =   5.1699e+03
*****************************************************************************

  Execution time = 4.3420e+01
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_001                -7.055659e-01 3 1  ON 0
ci_002                -7.029283e-01 3 1  ON 1
ci_003                -5.011543e-02 3 1  ON 2
ci_004                -5.098494e-02 3 1  ON 3
ci_005                 1.947084e-02 3 1  ON 4
ci_006                 1.976076e-02 3 1  ON 5
ci_007                 1.473387e-02 3 1  ON 6
ci_008                 1.549402e-02 3 1  ON 7
ci_009                -1.315675e-02 3 1  ON 8
ci_010                -1.205463e-02 3 1  ON 9
ci_011                -9.848809e-03 3 1  ON 10
ci_012                -9.085297e-03 3 1  ON 11
ci_013                 8.366108e-03 3 1  ON 12
ci_014                 9.298162e-03 3 1  ON 13
ci_015                 9.499872e-03 3 1  ON 14
ci_016                 9.362061e-03 3 1  ON 15
ci_017                 8.490681e-03 3 1  ON 16
ci_018                 8.266391e-03 3 1  ON 17
ci_019                -1.263039e-03 3 1  ON 18
ci_020                -1.585658e-03 3 1  ON 19
ci_021                -1.181874e-02 3 1  ON 20
ci_022                -1.183530e-02 3 1  ON 21
ci_023                 4.842803e-03 3 1  ON 22
ci_024                 4.911040e-03 3 1  ON 23
ci_025                 1.152828e-02 3 1  ON 24
ci_026                 1.153022e-02 3 1  ON 25
ci_027                 6.476985e-03 3 1  ON 26
ci_028                 6.177522e-03 3 1  ON 27
ci_029                -5.032793e-03 3 1  ON 28
ci_030                -4.115150e-03 3 1  ON 29
ci_031                 3.413881e-03 3 1  ON 30
ci_032                 4.670033e-03 3 1  ON 31
ci_033                 2.349616e-03 3 1  ON 32
ci_034                 4.108395e-03 3 1  ON 33
ci_035                 1.724060e-03 3 1  ON 34
ci_036                 2.137386e-03 3 1  ON 35
ci_037                 3.492912e-03 3 1  ON 36
ci_038                 3.700624e-03 3 1  ON 37
ci_039                 4.602489e-03 3 1  ON 38
ci_040                 4.920952e-03 3 1  ON 39
ci_041                 2.955449e-03 3 1  ON 40
ci_042                 2.734309e-03 3 1  ON 41
ci_043                 2.939083e-03 3 1  ON 42
ci_044                 3.206534e-03 3 1  ON 43
ci_045                 2.473932e-03 3 1  ON 44
ci_046                 2.735511e-03 3 1  ON 45
ci_047                -1.006390e-03 3 1  ON 46
ci_048                -8.449212e-04 3 1  ON 47
ci_049                 7.812715e-04 3 1  ON 48
ci_050                 9.954669e-04 3 1  ON 49
ci_051                -3.367196e-04 3 1  ON 50
ci_052                -1.212147e-03 3 1  ON 51
ci_053                -2.460559e-03 3 1  ON 52
ci_054                -2.688997e-03 3 1  ON 53
ci_055                -1.790865e-03 3 1  ON 54
ci_056                -1.964997e-03 3 1  ON 55
ci_057                -1.320311e-03 3 1  ON 56
ci_058                -9.968894e-04 3 1  ON 57
ci_059                -5.220512e-04 3 1  ON 58
ci_060                -7.414834e-04 3 1  ON 59
ci_061                 6.156327e-06 3 1  ON 60
ci_062                -9.076536e-04 3 1  ON 61
ci_063                -8.886275e-04 3 1  ON 62
ci_064                -5.033056e-04 3 1  ON 63
ci_065                -1.365634e-03 3 1  ON 64
ci_066                -1.881778e-03 3 1  ON 65
ci_067                -1.824186e-03 3 1  ON 66
ci_068                -1.480765e-03 3 1  ON 67
ci_069                -5.507565e-04 3 1  ON 68
ci_070                -4.209387e-04 3 1  ON 69
ci_071                -2.064872e-03 3 1  ON 70
ci_072                -1.992039e-03 3 1  ON 71
ci_073                 1.590762e-04 3 1  ON 72
ci_074                 1.767169e-04 3 1  ON 73
ci_075                 1.714716e-04 3 1  ON 74
ci_076                 7.921191e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4428e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.694
    reference variance = 0.325295
====================================================
  Execution time = 2.6132e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4853e-01
  Total weights = 1.955174056e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438830575108
                                         uncertainty =       0.002083985695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438830575108
                                         uncertainty =       0.002083985695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468379542
  error estimate for blocks of size 2^( 2) =       0.000492310859
  error estimate for blocks of size 2^( 3) =       0.000514770982
  error estimate for blocks of size 2^( 4) =       0.000530831755
  error estimate for blocks of size 2^( 5) =       0.000539739046
  error estimate for blocks of size 2^( 6) =       0.000541957775
  error estimate for blocks of size 2^( 7) =       0.000545277047

      target function =      -0.746523394463
              le_mean =     -22.662067585101
             les_mean =     514.017835448157
             stat err =       0.000539451406
             autocorr =       1.326504789804
   target nu stat err =       0.000539451406
   target dn stat err =       0.003049544115
      target stat err =       0.002578976429
              std dev =       0.662388701278
             le_variance =       0.438758791581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266206758510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+02, overlap shift 1.2925e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746531387531       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746531527020       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746531554614       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746531555647       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746531557171       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746531557403       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746531557733       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746531557896       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746531557896       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+02 is 1.642844e-06

solving harmonic davidson linear method for identity shift 5.1699e+02, overlap shift 5.1699e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746531387531       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746531422413       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746531429312       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746531429570       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746531429951       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746531430009       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746531430092       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746531430133       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746531430134       residual = 6.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+02 is 4.108009e-07

solving harmonic davidson linear method for identity shift 2.0680e+03, overlap shift 2.0680e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746531387531       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746531396252       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746531397977       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746531398042       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746531398135       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746531398149       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746531398171       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746531398184       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746531398178       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+03 is 1.027058e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0822e+01
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_001                -7.055659e-01 3 1  ON 0
ci_002                -7.029283e-01 3 1  ON 1
ci_003                -5.011506e-02 3 1  ON 2
ci_004                -5.098510e-02 3 1  ON 3
ci_005                 1.947070e-02 3 1  ON 4
ci_006                 1.976061e-02 3 1  ON 5
ci_007                 1.473373e-02 3 1  ON 6
ci_008                 1.549390e-02 3 1  ON 7
ci_009                -1.315663e-02 3 1  ON 8
ci_010                -1.205448e-02 3 1  ON 9
ci_011                -9.848685e-03 3 1  ON 10
ci_012                -9.085199e-03 3 1  ON 11
ci_013                 8.366054e-03 3 1  ON 12
ci_014                 9.297890e-03 3 1  ON 13
ci_015                 9.499714e-03 3 1  ON 14
ci_016                 9.361852e-03 3 1  ON 15
ci_017                 8.490728e-03 3 1  ON 16
ci_018                 8.266328e-03 3 1  ON 17
ci_019                -1.263338e-03 3 1  ON 18
ci_020                -1.586069e-03 3 1  ON 19
ci_021                -1.181913e-02 3 1  ON 20
ci_022                -1.183537e-02 3 1  ON 21
ci_023                 4.842736e-03 3 1  ON 22
ci_024                 4.911124e-03 3 1  ON 23
ci_025                 1.152865e-02 3 1  ON 24
ci_026                 1.153048e-02 3 1  ON 25
ci_027                 6.477014e-03 3 1  ON 26
ci_028                 6.177450e-03 3 1  ON 27
ci_029                -5.032665e-03 3 1  ON 28
ci_030                -4.115074e-03 3 1  ON 29
ci_031                 3.414086e-03 3 1  ON 30
ci_032                 4.670058e-03 3 1  ON 31
ci_033                 2.349678e-03 3 1  ON 32
ci_034                 4.108371e-03 3 1  ON 33
ci_035                 1.724080e-03 3 1  ON 34
ci_036                 2.137396e-03 3 1  ON 35
ci_037                 3.492801e-03 3 1  ON 36
ci_038                 3.700462e-03 3 1  ON 37
ci_039                 4.602557e-03 3 1  ON 38
ci_040                 4.920834e-03 3 1  ON 39
ci_041                 2.955468e-03 3 1  ON 40
ci_042                 2.734327e-03 3 1  ON 41
ci_043                 2.939067e-03 3 1  ON 42
ci_044                 3.206565e-03 3 1  ON 43
ci_045                 2.473920e-03 3 1  ON 44
ci_046                 2.735439e-03 3 1  ON 45
ci_047                -1.006363e-03 3 1  ON 46
ci_048                -8.449029e-04 3 1  ON 47
ci_049                 7.811654e-04 3 1  ON 48
ci_050                 9.954142e-04 3 1  ON 49
ci_051                -3.367271e-04 3 1  ON 50
ci_052                -1.212063e-03 3 1  ON 51
ci_053                -2.460488e-03 3 1  ON 52
ci_054                -2.689012e-03 3 1  ON 53
ci_055                -1.790871e-03 3 1  ON 54
ci_056                -1.964956e-03 3 1  ON 55
ci_057                -1.320123e-03 3 1  ON 56
ci_058                -9.968348e-04 3 1  ON 57
ci_059                -5.221002e-04 3 1  ON 58
ci_060                -7.414324e-04 3 1  ON 59
ci_061                 6.194407e-06 3 1  ON 60
ci_062                -9.075094e-04 3 1  ON 61
ci_063                -8.885923e-04 3 1  ON 62
ci_064                -5.035410e-04 3 1  ON 63
ci_065                -1.365673e-03 3 1  ON 64
ci_066                -1.881779e-03 3 1  ON 65
ci_067                -1.824067e-03 3 1  ON 66
ci_068                -1.480892e-03 3 1  ON 67
ci_069                -5.507425e-04 3 1  ON 68
ci_070                -4.210012e-04 3 1  ON 69
ci_071                -2.064761e-03 3 1  ON 70
ci_072                -1.991839e-03 3 1  ON 71
ci_073                 1.590358e-04 3 1  ON 72
ci_074                 1.767042e-04 3 1  ON 73
ci_075                 1.714913e-04 3 1  ON 74
ci_076                 7.921514e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6312
    reference variance = 0.304102
====================================================
  Execution time = 2.5479e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4841e-01
  Total weights = 1.9553e+06
  Execution time = 3.6206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439375554961
                                         uncertainty =       0.002526046168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439375554961
                                         uncertainty =       0.002526046168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468696131
  error estimate for blocks of size 2^( 2) =       0.000492902248
  error estimate for blocks of size 2^( 3) =       0.000514232345
  error estimate for blocks of size 2^( 4) =       0.000531670889
  error estimate for blocks of size 2^( 5) =       0.000541801741
  error estimate for blocks of size 2^( 6) =       0.000546903241
  error estimate for blocks of size 2^( 7) =       0.000547894747

      target function =      -0.746616581936
              le_mean =     -22.661422185481
             les_mean =     513.988460834824
             stat err =       0.000542067654
             autocorr =       1.337593806464
   target nu stat err =       0.000542067654
   target dn stat err =       0.002998999459
      target stat err =       0.002537395747
              std dev =       0.662836425221
             le_variance =       0.439352126599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439375126736
                                         uncertainty =       0.002526024960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439375126736
                                         uncertainty =       0.002526024960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468695903
  error estimate for blocks of size 2^( 2) =       0.000492902046
  error estimate for blocks of size 2^( 3) =       0.000514232159
  error estimate for blocks of size 2^( 4) =       0.000531670700
  error estimate for blocks of size 2^( 5) =       0.000541801546
  error estimate for blocks of size 2^( 6) =       0.000546903066
  error estimate for blocks of size 2^( 7) =       0.000547894546

      target function =      -0.746617026192
              le_mean =     -22.661422173578
             les_mean =     513.988459755104
             stat err =       0.000542067465
             autocorr =       1.337594172585
   target nu stat err =       0.000542067465
   target dn stat err =       0.002998964252
      target stat err =       0.002537370450
              std dev =       0.662836102591
             le_variance =       0.439351698898

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439375340754
                                         uncertainty =       0.002526035562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439375340754
                                         uncertainty =       0.002526035562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468696017
  error estimate for blocks of size 2^( 2) =       0.000492902147
  error estimate for blocks of size 2^( 3) =       0.000514232252
  error estimate for blocks of size 2^( 4) =       0.000531670794
  error estimate for blocks of size 2^( 5) =       0.000541801644
  error estimate for blocks of size 2^( 6) =       0.000546903153
  error estimate for blocks of size 2^( 7) =       0.000547894646

      target function =      -0.746616806142
              le_mean =     -22.661422179522
             les_mean =     513.988460292102
             stat err =       0.000542067559
             autocorr =       1.337593989599
   target nu stat err =       0.000542067559
   target dn stat err =       0.002998981824
      target stat err =       0.002537383087
              std dev =       0.662836263834
             le_variance =       0.439351912654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439375528178
                                         uncertainty =       0.002526044842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439375528178
                                         uncertainty =       0.002526044842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468696117
  error estimate for blocks of size 2^( 2) =       0.000492902235
  error estimate for blocks of size 2^( 3) =       0.000514232333
  error estimate for blocks of size 2^( 4) =       0.000531670877
  error estimate for blocks of size 2^( 5) =       0.000541801729
  error estimate for blocks of size 2^( 6) =       0.000546903230
  error estimate for blocks of size 2^( 7) =       0.000547894734

      target function =      -0.746616610185
              le_mean =     -22.661422184735
             les_mean =     513.988460766680
             stat err =       0.000542067642
             autocorr =       1.337593829365
   target nu stat err =       0.000542067642
   target dn stat err =       0.002998997252
      target stat err =       0.002537394164
              std dev =       0.662836405042
             le_variance =       0.439352099849


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746616581936        initial
     1.2925e+02     1.2925e+03             1.6428e-06        -0.746617026192  <--
     5.1699e+02     5.1699e+03             4.1080e-07        -0.746616806142
     2.0680e+03     2.0680e+04             1.0271e-07        -0.746616610185

*****************************************************************************
Applying the update for shift_i =   1.2925e+02     and shift_s =   1.2925e+03
*****************************************************************************

  Execution time = 4.3630e+01
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_001                -7.055658e-01 3 1  ON 0
ci_002                -7.029285e-01 3 1  ON 1
ci_003                -5.011396e-02 3 1  ON 2
ci_004                -5.098556e-02 3 1  ON 3
ci_005                 1.947029e-02 3 1  ON 4
ci_006                 1.976018e-02 3 1  ON 5
ci_007                 1.473330e-02 3 1  ON 6
ci_008                 1.549354e-02 3 1  ON 7
ci_009                -1.315626e-02 3 1  ON 8
ci_010                -1.205403e-02 3 1  ON 9
ci_011                -9.848314e-03 3 1  ON 10
ci_012                -9.084904e-03 3 1  ON 11
ci_013                 8.365893e-03 3 1  ON 12
ci_014                 9.297075e-03 3 1  ON 13
ci_015                 9.499240e-03 3 1  ON 14
ci_016                 9.361223e-03 3 1  ON 15
ci_017                 8.490867e-03 3 1  ON 16
ci_018                 8.266139e-03 3 1  ON 17
ci_019                -1.264235e-03 3 1  ON 18
ci_020                -1.587301e-03 3 1  ON 19
ci_021                -1.182032e-02 3 1  ON 20
ci_022                -1.183556e-02 3 1  ON 21
ci_023                 4.842534e-03 3 1  ON 22
ci_024                 4.911379e-03 3 1  ON 23
ci_025                 1.152977e-02 3 1  ON 24
ci_026                 1.153125e-02 3 1  ON 25
ci_027                 6.477101e-03 3 1  ON 26
ci_028                 6.177231e-03 3 1  ON 27
ci_029                -5.032282e-03 3 1  ON 28
ci_030                -4.114846e-03 3 1  ON 29
ci_031                 3.414701e-03 3 1  ON 30
ci_032                 4.670134e-03 3 1  ON 31
ci_033                 2.349864e-03 3 1  ON 32
ci_034                 4.108298e-03 3 1  ON 33
ci_035                 1.724140e-03 3 1  ON 34
ci_036                 2.137428e-03 3 1  ON 35
ci_037                 3.492469e-03 3 1  ON 36
ci_038                 3.699975e-03 3 1  ON 37
ci_039                 4.602763e-03 3 1  ON 38
ci_040                 4.920479e-03 3 1  ON 39
ci_041                 2.955525e-03 3 1  ON 40
ci_042                 2.734381e-03 3 1  ON 41
ci_043                 2.939018e-03 3 1  ON 42
ci_044                 3.206661e-03 3 1  ON 43
ci_045                 2.473884e-03 3 1  ON 44
ci_046                 2.735224e-03 3 1  ON 45
ci_047                -1.006280e-03 3 1  ON 46
ci_048                -8.448480e-04 3 1  ON 47
ci_049                 7.808470e-04 3 1  ON 48
ci_050                 9.952562e-04 3 1  ON 49
ci_051                -3.367495e-04 3 1  ON 50
ci_052                -1.211813e-03 3 1  ON 51
ci_053                -2.460276e-03 3 1  ON 52
ci_054                -2.689056e-03 3 1  ON 53
ci_055                -1.790888e-03 3 1  ON 54
ci_056                -1.964834e-03 3 1  ON 55
ci_057                -1.319560e-03 3 1  ON 56
ci_058                -9.966710e-04 3 1  ON 57
ci_059                -5.222470e-04 3 1  ON 58
ci_060                -7.412794e-04 3 1  ON 59
ci_061                 6.308608e-06 3 1  ON 60
ci_062                -9.070767e-04 3 1  ON 61
ci_063                -8.884867e-04 3 1  ON 62
ci_064                -5.042471e-04 3 1  ON 63
ci_065                -1.365789e-03 3 1  ON 64
ci_066                -1.881780e-03 3 1  ON 65
ci_067                -1.823713e-03 3 1  ON 66
ci_068                -1.481273e-03 3 1  ON 67
ci_069                -5.507006e-04 3 1  ON 68
ci_070                -4.211885e-04 3 1  ON 69
ci_071                -2.064426e-03 3 1  ON 70
ci_072                -1.991240e-03 3 1  ON 71
ci_073                 1.589147e-04 3 1  ON 72
ci_074                 1.766661e-04 3 1  ON 73
ci_075                 1.715503e-04 3 1  ON 74
ci_076                 7.922484e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4458e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.6778
    reference variance = 0.420561
====================================================
  Execution time = 2.6445e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5151e-01
  Total weights = 1.955562908e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442391862877
                                         uncertainty =       0.002405918646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442391862877
                                         uncertainty =       0.002405918646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470320125
  error estimate for blocks of size 2^( 2) =       0.000494149280
  error estimate for blocks of size 2^( 3) =       0.000515790338
  error estimate for blocks of size 2^( 4) =       0.000531655356
  error estimate for blocks of size 2^( 5) =       0.000540228204
  error estimate for blocks of size 2^( 6) =       0.000544905359
  error estimate for blocks of size 2^( 7) =       0.000549026927

      target function =      -0.744075235663
              le_mean =     -22.661628459222
             les_mean =     514.000915404783
             stat err =       0.000541453962
             autocorr =       1.325366366721
   target nu stat err =       0.000541453962
   target dn stat err =       0.002627827993
      target stat err =       0.002227688519
              std dev =       0.665133099831
             le_variance =       0.442402040490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266162845922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+01, overlap shift 3.2312e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744080932019       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744081415677       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744081543758       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744081555256       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744081555091       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744081554411       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744081554610       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744081554872       residual = 7.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744081554756       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744081554876       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744081554798       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+01 is 7.636430e-06

solving harmonic davidson linear method for identity shift 1.2925e+02, overlap shift 1.2925e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744080932019       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744081053066       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744081085104       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744081087979       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744081087937       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744081087767       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744081087817       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744081087882       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744081087853       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744081087883       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744081087864       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+02 is 1.910783e-06

solving harmonic davidson linear method for identity shift 5.1699e+02, overlap shift 5.1699e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744080932019       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744080962289       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744080970300       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744080971019       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744080971008       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744080970966       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744080970979       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744080970995       residual = 7.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744080970986       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744080970995       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744080970990       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+02 is 4.778006e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1200e+01
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011352e-02 3 1  ON 2
ci_004                -5.098571e-02 3 1  ON 3
ci_005                 1.946982e-02 3 1  ON 4
ci_006                 1.975941e-02 3 1  ON 5
ci_007                 1.473303e-02 3 1  ON 6
ci_008                 1.549327e-02 3 1  ON 7
ci_009                -1.315543e-02 3 1  ON 8
ci_010                -1.205412e-02 3 1  ON 9
ci_011                -9.847474e-03 3 1  ON 10
ci_012                -9.085051e-03 3 1  ON 11
ci_013                 8.365368e-03 3 1  ON 12
ci_014                 9.296328e-03 3 1  ON 13
ci_015                 9.498539e-03 3 1  ON 14
ci_016                 9.360721e-03 3 1  ON 15
ci_017                 8.490689e-03 3 1  ON 16
ci_018                 8.265787e-03 3 1  ON 17
ci_019                -1.266146e-03 3 1  ON 18
ci_020                -1.588527e-03 3 1  ON 19
ci_021                -1.182074e-02 3 1  ON 20
ci_022                -1.183574e-02 3 1  ON 21
ci_023                 4.842596e-03 3 1  ON 22
ci_024                 4.911506e-03 3 1  ON 23
ci_025                 1.153090e-02 3 1  ON 24
ci_026                 1.153221e-02 3 1  ON 25
ci_027                 6.476908e-03 3 1  ON 26
ci_028                 6.177051e-03 3 1  ON 27
ci_029                -5.032042e-03 3 1  ON 28
ci_030                -4.114529e-03 3 1  ON 29
ci_031                 3.415772e-03 3 1  ON 30
ci_032                 4.670617e-03 3 1  ON 31
ci_033                 2.350124e-03 3 1  ON 32
ci_034                 4.108071e-03 3 1  ON 33
ci_035                 1.723805e-03 3 1  ON 34
ci_036                 2.137307e-03 3 1  ON 35
ci_037                 3.492337e-03 3 1  ON 36
ci_038                 3.699461e-03 3 1  ON 37
ci_039                 4.602744e-03 3 1  ON 38
ci_040                 4.920154e-03 3 1  ON 39
ci_041                 2.955543e-03 3 1  ON 40
ci_042                 2.734600e-03 3 1  ON 41
ci_043                 2.938957e-03 3 1  ON 42
ci_044                 3.206729e-03 3 1  ON 43
ci_045                 2.473854e-03 3 1  ON 44
ci_046                 2.735396e-03 3 1  ON 45
ci_047                -1.006362e-03 3 1  ON 46
ci_048                -8.448323e-04 3 1  ON 47
ci_049                 7.813158e-04 3 1  ON 48
ci_050                 9.950956e-04 3 1  ON 49
ci_051                -3.369006e-04 3 1  ON 50
ci_052                -1.211709e-03 3 1  ON 51
ci_053                -2.460145e-03 3 1  ON 52
ci_054                -2.689099e-03 3 1  ON 53
ci_055                -1.789905e-03 3 1  ON 54
ci_056                -1.964306e-03 3 1  ON 55
ci_057                -1.319714e-03 3 1  ON 56
ci_058                -9.965936e-04 3 1  ON 57
ci_059                -5.220329e-04 3 1  ON 58
ci_060                -7.407722e-04 3 1  ON 59
ci_061                 6.193627e-06 3 1  ON 60
ci_062                -9.067548e-04 3 1  ON 61
ci_063                -8.879774e-04 3 1  ON 62
ci_064                -5.047947e-04 3 1  ON 63
ci_065                -1.365539e-03 3 1  ON 64
ci_066                -1.881572e-03 3 1  ON 65
ci_067                -1.823881e-03 3 1  ON 66
ci_068                -1.481290e-03 3 1  ON 67
ci_069                -5.503646e-04 3 1  ON 68
ci_070                -4.209208e-04 3 1  ON 69
ci_071                -2.063961e-03 3 1  ON 70
ci_072                -1.991466e-03 3 1  ON 71
ci_073                 1.586879e-04 3 1  ON 72
ci_074                 1.767499e-04 3 1  ON 73
ci_075                 1.712288e-04 3 1  ON 74
ci_076                 7.926970e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.7465
    reference variance = 0.373316
====================================================
  Execution time = 2.5318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5390e-01
  Total weights = 1.9555e+06
  Execution time = 3.6003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442814825300
                                         uncertainty =       0.004534702441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442814825300
                                         uncertainty =       0.004534702441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470514006
  error estimate for blocks of size 2^( 2) =       0.000494519363
  error estimate for blocks of size 2^( 3) =       0.000516707540
  error estimate for blocks of size 2^( 4) =       0.000532866931
  error estimate for blocks of size 2^( 5) =       0.000542521270
  error estimate for blocks of size 2^( 6) =       0.000546737035
  error estimate for blocks of size 2^( 7) =       0.000549011291

      target function =      -0.742109795307
              le_mean =     -22.661688340536
             les_mean =     514.006016339294
             stat err =       0.000542784132
             autocorr =       1.330788911613
   target nu stat err =       0.000542784132
   target dn stat err =       0.005525128481
      target stat err =       0.004529827007
              std dev =       0.665407288898
             le_variance =       0.442766860119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442814226538
                                         uncertainty =       0.004534572993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442814226538
                                         uncertainty =       0.004534572993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470513686
  error estimate for blocks of size 2^( 2) =       0.000494519136
  error estimate for blocks of size 2^( 3) =       0.000516707383
  error estimate for blocks of size 2^( 4) =       0.000532866783
  error estimate for blocks of size 2^( 5) =       0.000542521033
  error estimate for blocks of size 2^( 6) =       0.000546736872
  error estimate for blocks of size 2^( 7) =       0.000549010968

      target function =      -0.742106936278
              le_mean =     -22.661688344845
             les_mean =     514.006020052193
             stat err =       0.000542783914
             autocorr =       1.330789654533
   target nu stat err =       0.000542783914
   target dn stat err =       0.005525152859
      target stat err =       0.004529812044
              std dev =       0.665406836076
             le_variance =       0.442766257497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442814524948
                                         uncertainty =       0.004534637642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442814524948
                                         uncertainty =       0.004534637642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470513846
  error estimate for blocks of size 2^( 2) =       0.000494519249
  error estimate for blocks of size 2^( 3) =       0.000516707461
  error estimate for blocks of size 2^( 4) =       0.000532866857
  error estimate for blocks of size 2^( 5) =       0.000542521151
  error estimate for blocks of size 2^( 6) =       0.000546736953
  error estimate for blocks of size 2^( 7) =       0.000549011129

      target function =      -0.742108488623
              le_mean =     -22.661688342611
             les_mean =     514.006018041008
             stat err =       0.000542784023
             autocorr =       1.330789283790
   target nu stat err =       0.000542784023
   target dn stat err =       0.005525140136
      target stat err =       0.004529820582
              std dev =       0.665407061757
             le_variance =       0.442766557836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442814787668
                                         uncertainty =       0.004534694337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442814787668
                                         uncertainty =       0.004534694337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470513986
  error estimate for blocks of size 2^( 2) =       0.000494519348
  error estimate for blocks of size 2^( 3) =       0.000516707530
  error estimate for blocks of size 2^( 4) =       0.000532866922
  error estimate for blocks of size 2^( 5) =       0.000542521256
  error estimate for blocks of size 2^( 6) =       0.000546737025
  error estimate for blocks of size 2^( 7) =       0.000549011271

      target function =      -0.742109650043
              le_mean =     -22.661688340788
             les_mean =     514.006016529399
             stat err =       0.000542784118
             autocorr =       1.330788958150
   target nu stat err =       0.000542784118
   target dn stat err =       0.005525129876
      target stat err =       0.004529826373
              std dev =       0.665407260440
             le_variance =       0.442766822246


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742109795307        initial  <--
     3.2312e+01     3.2312e+02             7.6364e-06        -0.742106936278
     1.2925e+02     1.2925e+03             1.9108e-06        -0.742108488623
     5.1699e+02     5.1699e+03             4.7780e-07        -0.742109650043

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4134
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_001                -7.055658e-01 3 1  ON 0
ci_002                -7.029285e-01 3 1  ON 1
ci_003                -5.011396e-02 3 1  ON 2
ci_004                -5.098556e-02 3 1  ON 3
ci_005                 1.947029e-02 3 1  ON 4
ci_006                 1.976018e-02 3 1  ON 5
ci_007                 1.473330e-02 3 1  ON 6
ci_008                 1.549354e-02 3 1  ON 7
ci_009                -1.315626e-02 3 1  ON 8
ci_010                -1.205403e-02 3 1  ON 9
ci_011                -9.848314e-03 3 1  ON 10
ci_012                -9.084904e-03 3 1  ON 11
ci_013                 8.365893e-03 3 1  ON 12
ci_014                 9.297075e-03 3 1  ON 13
ci_015                 9.499240e-03 3 1  ON 14
ci_016                 9.361223e-03 3 1  ON 15
ci_017                 8.490867e-03 3 1  ON 16
ci_018                 8.266139e-03 3 1  ON 17
ci_019                -1.264235e-03 3 1  ON 18
ci_020                -1.587301e-03 3 1  ON 19
ci_021                -1.182032e-02 3 1  ON 20
ci_022                -1.183556e-02 3 1  ON 21
ci_023                 4.842534e-03 3 1  ON 22
ci_024                 4.911379e-03 3 1  ON 23
ci_025                 1.152977e-02 3 1  ON 24
ci_026                 1.153125e-02 3 1  ON 25
ci_027                 6.477101e-03 3 1  ON 26
ci_028                 6.177231e-03 3 1  ON 27
ci_029                -5.032282e-03 3 1  ON 28
ci_030                -4.114846e-03 3 1  ON 29
ci_031                 3.414701e-03 3 1  ON 30
ci_032                 4.670134e-03 3 1  ON 31
ci_033                 2.349864e-03 3 1  ON 32
ci_034                 4.108298e-03 3 1  ON 33
ci_035                 1.724140e-03 3 1  ON 34
ci_036                 2.137428e-03 3 1  ON 35
ci_037                 3.492469e-03 3 1  ON 36
ci_038                 3.699975e-03 3 1  ON 37
ci_039                 4.602763e-03 3 1  ON 38
ci_040                 4.920479e-03 3 1  ON 39
ci_041                 2.955525e-03 3 1  ON 40
ci_042                 2.734381e-03 3 1  ON 41
ci_043                 2.939018e-03 3 1  ON 42
ci_044                 3.206661e-03 3 1  ON 43
ci_045                 2.473884e-03 3 1  ON 44
ci_046                 2.735224e-03 3 1  ON 45
ci_047                -1.006280e-03 3 1  ON 46
ci_048                -8.448480e-04 3 1  ON 47
ci_049                 7.808470e-04 3 1  ON 48
ci_050                 9.952562e-04 3 1  ON 49
ci_051                -3.367495e-04 3 1  ON 50
ci_052                -1.211813e-03 3 1  ON 51
ci_053                -2.460276e-03 3 1  ON 52
ci_054                -2.689056e-03 3 1  ON 53
ci_055                -1.790888e-03 3 1  ON 54
ci_056                -1.964834e-03 3 1  ON 55
ci_057                -1.319560e-03 3 1  ON 56
ci_058                -9.966710e-04 3 1  ON 57
ci_059                -5.222470e-04 3 1  ON 58
ci_060                -7.412794e-04 3 1  ON 59
ci_061                 6.308608e-06 3 1  ON 60
ci_062                -9.070767e-04 3 1  ON 61
ci_063                -8.884867e-04 3 1  ON 62
ci_064                -5.042471e-04 3 1  ON 63
ci_065                -1.365789e-03 3 1  ON 64
ci_066                -1.881780e-03 3 1  ON 65
ci_067                -1.823713e-03 3 1  ON 66
ci_068                -1.481273e-03 3 1  ON 67
ci_069                -5.507006e-04 3 1  ON 68
ci_070                -4.211885e-04 3 1  ON 69
ci_071                -2.064426e-03 3 1  ON 70
ci_072                -1.991240e-03 3 1  ON 71
ci_073                 1.589147e-04 3 1  ON 72
ci_074                 1.766661e-04 3 1  ON 73
ci_075                 1.715503e-04 3 1  ON 74
ci_076                 7.922484e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.6233
    reference variance = 0.410486
====================================================
  Execution time = 2.8317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4511e-01
  Total weights = 1.955112056e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437310811490
                                         uncertainty =       0.002582626782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437310811490
                                         uncertainty =       0.002582626782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467594128
  error estimate for blocks of size 2^( 2) =       0.000491771211
  error estimate for blocks of size 2^( 3) =       0.000513978025
  error estimate for blocks of size 2^( 4) =       0.000530451296
  error estimate for blocks of size 2^( 5) =       0.000540249060
  error estimate for blocks of size 2^( 6) =       0.000543643448
  error estimate for blocks of size 2^( 7) =       0.000548445698

      target function =      -0.749343505120
              le_mean =     -22.661560541116
             les_mean =     513.991431928178
             stat err =       0.000540697376
             autocorr =       1.337120128076
   target nu stat err =       0.000540697376
   target dn stat err =       0.002705795838
      target stat err =       0.002320126428
              std dev =       0.661277956999
             le_variance =       0.437288536413


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266156054112e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+02, overlap shift 3.2312e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749349818356       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749349862135       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749349870005       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749349871731       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749349872270       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749349872277       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749349872402       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749349872418       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749349872468       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749349872473       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749349872473       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+02 is 5.316443e-07

solving harmonic davidson linear method for identity shift 1.2925e+03, overlap shift 1.2925e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749349818356       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749349829302       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749349831269       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749349831701       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749349831835       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749349831836       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749349831867       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749349831872       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749349831885       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749349831888       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749349831888       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+03 is 1.329235e-07

solving harmonic davidson linear method for identity shift 5.1699e+03, overlap shift 5.1699e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749349818356       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749349821092       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749349821584       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749349821692       residual = 7.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749349821723       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749349821726       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749349821734       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749349821735       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749349821740       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749349821735       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749349821738       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+03 is 3.323166e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365768 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3009e+01
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_001                -7.055659e-01 3 1  ON 0
ci_002                -7.029284e-01 3 1  ON 1
ci_003                -5.011401e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.947025e-02 3 1  ON 4
ci_006                 1.976014e-02 3 1  ON 5
ci_007                 1.473331e-02 3 1  ON 6
ci_008                 1.549356e-02 3 1  ON 7
ci_009                -1.315621e-02 3 1  ON 8
ci_010                -1.205402e-02 3 1  ON 9
ci_011                -9.848307e-03 3 1  ON 10
ci_012                -9.084893e-03 3 1  ON 11
ci_013                 8.365846e-03 3 1  ON 12
ci_014                 9.296963e-03 3 1  ON 13
ci_015                 9.499193e-03 3 1  ON 14
ci_016                 9.361238e-03 3 1  ON 15
ci_017                 8.490872e-03 3 1  ON 16
ci_018                 8.266158e-03 3 1  ON 17
ci_019                -1.264297e-03 3 1  ON 18
ci_020                -1.587434e-03 3 1  ON 19
ci_021                -1.182032e-02 3 1  ON 20
ci_022                -1.183565e-02 3 1  ON 21
ci_023                 4.842527e-03 3 1  ON 22
ci_024                 4.911395e-03 3 1  ON 23
ci_025                 1.152985e-02 3 1  ON 24
ci_026                 1.153127e-02 3 1  ON 25
ci_027                 6.477065e-03 3 1  ON 26
ci_028                 6.177247e-03 3 1  ON 27
ci_029                -5.032281e-03 3 1  ON 28
ci_030                -4.114769e-03 3 1  ON 29
ci_031                 3.414748e-03 3 1  ON 30
ci_032                 4.670144e-03 3 1  ON 31
ci_033                 2.349883e-03 3 1  ON 32
ci_034                 4.108248e-03 3 1  ON 33
ci_035                 1.724100e-03 3 1  ON 34
ci_036                 2.137414e-03 3 1  ON 35
ci_037                 3.492463e-03 3 1  ON 36
ci_038                 3.699970e-03 3 1  ON 37
ci_039                 4.602815e-03 3 1  ON 38
ci_040                 4.920466e-03 3 1  ON 39
ci_041                 2.955530e-03 3 1  ON 40
ci_042                 2.734452e-03 3 1  ON 41
ci_043                 2.939051e-03 3 1  ON 42
ci_044                 3.206623e-03 3 1  ON 43
ci_045                 2.473933e-03 3 1  ON 44
ci_046                 2.735196e-03 3 1  ON 45
ci_047                -1.006298e-03 3 1  ON 46
ci_048                -8.448680e-04 3 1  ON 47
ci_049                 7.808626e-04 3 1  ON 48
ci_050                 9.952247e-04 3 1  ON 49
ci_051                -3.367268e-04 3 1  ON 50
ci_052                -1.211768e-03 3 1  ON 51
ci_053                -2.460275e-03 3 1  ON 52
ci_054                -2.689040e-03 3 1  ON 53
ci_055                -1.790905e-03 3 1  ON 54
ci_056                -1.964770e-03 3 1  ON 55
ci_057                -1.319574e-03 3 1  ON 56
ci_058                -9.966985e-04 3 1  ON 57
ci_059                -5.222444e-04 3 1  ON 58
ci_060                -7.412431e-04 3 1  ON 59
ci_061                 6.336220e-06 3 1  ON 60
ci_062                -9.070826e-04 3 1  ON 61
ci_063                -8.885968e-04 3 1  ON 62
ci_064                -5.043306e-04 3 1  ON 63
ci_065                -1.365764e-03 3 1  ON 64
ci_066                -1.881819e-03 3 1  ON 65
ci_067                -1.823692e-03 3 1  ON 66
ci_068                -1.481290e-03 3 1  ON 67
ci_069                -5.507124e-04 3 1  ON 68
ci_070                -4.211770e-04 3 1  ON 69
ci_071                -2.064460e-03 3 1  ON 70
ci_072                -1.991232e-03 3 1  ON 71
ci_073                 1.588482e-04 3 1  ON 72
ci_074                 1.766548e-04 3 1  ON 73
ci_075                 1.715529e-04 3 1  ON 74
ci_076                 7.922629e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.6213
    reference variance = 0.397023
====================================================
  Execution time = 2.5763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4815e-01
  Total weights = 1.9552e+06
  Execution time = 4.1031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440043477769
                                         uncertainty =       0.001929494014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440043477769
                                         uncertainty =       0.001929494014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469052044
  error estimate for blocks of size 2^( 2) =       0.000493530407
  error estimate for blocks of size 2^( 3) =       0.000515650526
  error estimate for blocks of size 2^( 4) =       0.000531124187
  error estimate for blocks of size 2^( 5) =       0.000541209100
  error estimate for blocks of size 2^( 6) =       0.000546169911
  error estimate for blocks of size 2^( 7) =       0.000548432262

      target function =      -0.746843341493
              le_mean =     -22.662595100705
             les_mean =     514.041367126885
             stat err =       0.000541733865
             autocorr =       1.333920372350
   target nu stat err =       0.000541733865
   target dn stat err =       0.002576768725
      target stat err =       0.002206449534
              std dev =       0.663339761532
             le_variance =       0.440019639230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440043413073
                                         uncertainty =       0.001929492219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440043413073
                                         uncertainty =       0.001929492219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469052009
  error estimate for blocks of size 2^( 2) =       0.000493530376
  error estimate for blocks of size 2^( 3) =       0.000515650495
  error estimate for blocks of size 2^( 4) =       0.000531124151
  error estimate for blocks of size 2^( 5) =       0.000541209045
  error estimate for blocks of size 2^( 6) =       0.000546169864
  error estimate for blocks of size 2^( 7) =       0.000548432214

      target function =      -0.746842807664
              le_mean =     -22.662595099083
             les_mean =     514.041367701031
             stat err =       0.000541733819
             autocorr =       1.333920341371
   target nu stat err =       0.000541733819
   target dn stat err =       0.002576766225
      target stat err =       0.002206444492
              std dev =       0.663339712531
             le_variance =       0.440019574221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440043445411
                                         uncertainty =       0.001929493116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440043445411
                                         uncertainty =       0.001929493116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469052026
  error estimate for blocks of size 2^( 2) =       0.000493530391
  error estimate for blocks of size 2^( 3) =       0.000515650511
  error estimate for blocks of size 2^( 4) =       0.000531124169
  error estimate for blocks of size 2^( 5) =       0.000541209073
  error estimate for blocks of size 2^( 6) =       0.000546169887
  error estimate for blocks of size 2^( 7) =       0.000548432238

      target function =      -0.746843076463
              le_mean =     -22.662595099893
             les_mean =     514.041367411628
             stat err =       0.000541733842
             autocorr =       1.333920356866
   target nu stat err =       0.000541733842
   target dn stat err =       0.002576767346
      target stat err =       0.002206446921
              std dev =       0.663339737024
             le_variance =       0.440019606715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440043473724
                                         uncertainty =       0.001929493902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440043473724
                                         uncertainty =       0.001929493902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469052041
  error estimate for blocks of size 2^( 2) =       0.000493530405
  error estimate for blocks of size 2^( 3) =       0.000515650524
  error estimate for blocks of size 2^( 4) =       0.000531124185
  error estimate for blocks of size 2^( 5) =       0.000541209097
  error estimate for blocks of size 2^( 6) =       0.000546169908
  error estimate for blocks of size 2^( 7) =       0.000548432259

      target function =      -0.746843308572
              le_mean =     -22.662595100603
             les_mean =     514.041367162221
             stat err =       0.000541733862
             autocorr =       1.333920370414
   target nu stat err =       0.000541733862
   target dn stat err =       0.002576768539
      target stat err =       0.002206449197
              std dev =       0.663339758468
             le_variance =       0.440019635165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746843341493        initial  <--
     3.2312e+02     3.2312e+03             5.3164e-07        -0.746842807664
     1.2925e+03     1.2925e+04             1.3292e-07        -0.746843076463
     5.1699e+03     5.1699e+04             3.3232e-08        -0.746843308572

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3297
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_001                -7.055658e-01 3 1  ON 0
ci_002                -7.029285e-01 3 1  ON 1
ci_003                -5.011396e-02 3 1  ON 2
ci_004                -5.098556e-02 3 1  ON 3
ci_005                 1.947029e-02 3 1  ON 4
ci_006                 1.976018e-02 3 1  ON 5
ci_007                 1.473330e-02 3 1  ON 6
ci_008                 1.549354e-02 3 1  ON 7
ci_009                -1.315626e-02 3 1  ON 8
ci_010                -1.205403e-02 3 1  ON 9
ci_011                -9.848314e-03 3 1  ON 10
ci_012                -9.084904e-03 3 1  ON 11
ci_013                 8.365893e-03 3 1  ON 12
ci_014                 9.297075e-03 3 1  ON 13
ci_015                 9.499240e-03 3 1  ON 14
ci_016                 9.361223e-03 3 1  ON 15
ci_017                 8.490867e-03 3 1  ON 16
ci_018                 8.266139e-03 3 1  ON 17
ci_019                -1.264235e-03 3 1  ON 18
ci_020                -1.587301e-03 3 1  ON 19
ci_021                -1.182032e-02 3 1  ON 20
ci_022                -1.183556e-02 3 1  ON 21
ci_023                 4.842534e-03 3 1  ON 22
ci_024                 4.911379e-03 3 1  ON 23
ci_025                 1.152977e-02 3 1  ON 24
ci_026                 1.153125e-02 3 1  ON 25
ci_027                 6.477101e-03 3 1  ON 26
ci_028                 6.177231e-03 3 1  ON 27
ci_029                -5.032282e-03 3 1  ON 28
ci_030                -4.114846e-03 3 1  ON 29
ci_031                 3.414701e-03 3 1  ON 30
ci_032                 4.670134e-03 3 1  ON 31
ci_033                 2.349864e-03 3 1  ON 32
ci_034                 4.108298e-03 3 1  ON 33
ci_035                 1.724140e-03 3 1  ON 34
ci_036                 2.137428e-03 3 1  ON 35
ci_037                 3.492469e-03 3 1  ON 36
ci_038                 3.699975e-03 3 1  ON 37
ci_039                 4.602763e-03 3 1  ON 38
ci_040                 4.920479e-03 3 1  ON 39
ci_041                 2.955525e-03 3 1  ON 40
ci_042                 2.734381e-03 3 1  ON 41
ci_043                 2.939018e-03 3 1  ON 42
ci_044                 3.206661e-03 3 1  ON 43
ci_045                 2.473884e-03 3 1  ON 44
ci_046                 2.735224e-03 3 1  ON 45
ci_047                -1.006280e-03 3 1  ON 46
ci_048                -8.448480e-04 3 1  ON 47
ci_049                 7.808470e-04 3 1  ON 48
ci_050                 9.952562e-04 3 1  ON 49
ci_051                -3.367495e-04 3 1  ON 50
ci_052                -1.211813e-03 3 1  ON 51
ci_053                -2.460276e-03 3 1  ON 52
ci_054                -2.689056e-03 3 1  ON 53
ci_055                -1.790888e-03 3 1  ON 54
ci_056                -1.964834e-03 3 1  ON 55
ci_057                -1.319560e-03 3 1  ON 56
ci_058                -9.966710e-04 3 1  ON 57
ci_059                -5.222470e-04 3 1  ON 58
ci_060                -7.412794e-04 3 1  ON 59
ci_061                 6.308608e-06 3 1  ON 60
ci_062                -9.070767e-04 3 1  ON 61
ci_063                -8.884867e-04 3 1  ON 62
ci_064                -5.042471e-04 3 1  ON 63
ci_065                -1.365789e-03 3 1  ON 64
ci_066                -1.881780e-03 3 1  ON 65
ci_067                -1.823713e-03 3 1  ON 66
ci_068                -1.481273e-03 3 1  ON 67
ci_069                -5.507006e-04 3 1  ON 68
ci_070                -4.211885e-04 3 1  ON 69
ci_071                -2.064426e-03 3 1  ON 70
ci_072                -1.991240e-03 3 1  ON 71
ci_073                 1.589147e-04 3 1  ON 72
ci_074                 1.766661e-04 3 1  ON 73
ci_075                 1.715503e-04 3 1  ON 74
ci_076                 7.922484e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7758
    reference variance = 0.361786
====================================================
  Execution time = 2.6319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4909e-01
  Total weights = 1.955184679e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438863652369
                                         uncertainty =       0.002605296364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438863652369
                                         uncertainty =       0.002605296364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468479444
  error estimate for blocks of size 2^( 2) =       0.000493028451
  error estimate for blocks of size 2^( 3) =       0.000514848468
  error estimate for blocks of size 2^( 4) =       0.000530917221
  error estimate for blocks of size 2^( 5) =       0.000540116392
  error estimate for blocks of size 2^( 6) =       0.000544811589
  error estimate for blocks of size 2^( 7) =       0.000549039717

      target function =      -0.746052930160
              le_mean =     -22.661723650431
             les_mean =     514.002804432160
             stat err =       0.000541221230
             autocorr =       1.334653618983
   target nu stat err =       0.000541221230
   target dn stat err =       0.004257726020
      target stat err =       0.003547954960
              std dev =       0.662529983075
             le_variance =       0.438945978473


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266172365043e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.2312e+03, overlap shift 3.2312e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746068882652       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746068890458       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746068892052       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746068892210       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746068892197       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746068892176       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746068892182       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746068892168       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746068892173       residual = 9.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+03 is 1.054974e-07

solving harmonic davidson linear method for identity shift 1.2925e+04, overlap shift 1.2925e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746068882652       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746068884604       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746068885002       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746068885042       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746068885039       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746068885033       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746068885034       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746068885032       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746068885032       residual = 9.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+04 is 2.637458e-08

solving harmonic davidson linear method for identity shift 5.1699e+04, overlap shift 5.1699e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746068882652       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746068883140       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746068883240       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746068883250       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746068883249       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746068883248       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746068883248       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746068883125       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746068883304       residual = 9.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+04 is 6.593659e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.368922 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1034e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_001                -7.055658e-01 3 1  ON 0
ci_002                -7.029285e-01 3 1  ON 1
ci_003                -5.011395e-02 3 1  ON 2
ci_004                -5.098557e-02 3 1  ON 3
ci_005                 1.947027e-02 3 1  ON 4
ci_006                 1.976017e-02 3 1  ON 5
ci_007                 1.473330e-02 3 1  ON 6
ci_008                 1.549353e-02 3 1  ON 7
ci_009                -1.315626e-02 3 1  ON 8
ci_010                -1.205402e-02 3 1  ON 9
ci_011                -9.848317e-03 3 1  ON 10
ci_012                -9.084900e-03 3 1  ON 11
ci_013                 8.365892e-03 3 1  ON 12
ci_014                 9.297071e-03 3 1  ON 13
ci_015                 9.499234e-03 3 1  ON 14
ci_016                 9.361221e-03 3 1  ON 15
ci_017                 8.490864e-03 3 1  ON 16
ci_018                 8.266127e-03 3 1  ON 17
ci_019                -1.264262e-03 3 1  ON 18
ci_020                -1.587319e-03 3 1  ON 19
ci_021                -1.182032e-02 3 1  ON 20
ci_022                -1.183556e-02 3 1  ON 21
ci_023                 4.842536e-03 3 1  ON 22
ci_024                 4.911379e-03 3 1  ON 23
ci_025                 1.152978e-02 3 1  ON 24
ci_026                 1.153127e-02 3 1  ON 25
ci_027                 6.477101e-03 3 1  ON 26
ci_028                 6.177235e-03 3 1  ON 27
ci_029                -5.032277e-03 3 1  ON 28
ci_030                -4.114844e-03 3 1  ON 29
ci_031                 3.414712e-03 3 1  ON 30
ci_032                 4.670138e-03 3 1  ON 31
ci_033                 2.349863e-03 3 1  ON 32
ci_034                 4.108295e-03 3 1  ON 33
ci_035                 1.724138e-03 3 1  ON 34
ci_036                 2.137432e-03 3 1  ON 35
ci_037                 3.492467e-03 3 1  ON 36
ci_038                 3.699979e-03 3 1  ON 37
ci_039                 4.602763e-03 3 1  ON 38
ci_040                 4.920477e-03 3 1  ON 39
ci_041                 2.955525e-03 3 1  ON 40
ci_042                 2.734375e-03 3 1  ON 41
ci_043                 2.939018e-03 3 1  ON 42
ci_044                 3.206661e-03 3 1  ON 43
ci_045                 2.473883e-03 3 1  ON 44
ci_046                 2.735221e-03 3 1  ON 45
ci_047                -1.006274e-03 3 1  ON 46
ci_048                -8.448463e-04 3 1  ON 47
ci_049                 7.808439e-04 3 1  ON 48
ci_050                 9.952518e-04 3 1  ON 49
ci_051                -3.367490e-04 3 1  ON 50
ci_052                -1.211808e-03 3 1  ON 51
ci_053                -2.460276e-03 3 1  ON 52
ci_054                -2.689057e-03 3 1  ON 53
ci_055                -1.790887e-03 3 1  ON 54
ci_056                -1.964832e-03 3 1  ON 55
ci_057                -1.319561e-03 3 1  ON 56
ci_058                -9.966741e-04 3 1  ON 57
ci_059                -5.222418e-04 3 1  ON 58
ci_060                -7.412812e-04 3 1  ON 59
ci_061                 6.305393e-06 3 1  ON 60
ci_062                -9.070738e-04 3 1  ON 61
ci_063                -8.884897e-04 3 1  ON 62
ci_064                -5.042454e-04 3 1  ON 63
ci_065                -1.365788e-03 3 1  ON 64
ci_066                -1.881779e-03 3 1  ON 65
ci_067                -1.823706e-03 3 1  ON 66
ci_068                -1.481273e-03 3 1  ON 67
ci_069                -5.506995e-04 3 1  ON 68
ci_070                -4.211839e-04 3 1  ON 69
ci_071                -2.064428e-03 3 1  ON 70
ci_072                -1.991237e-03 3 1  ON 71
ci_073                 1.589195e-04 3 1  ON 72
ci_074                 1.766652e-04 3 1  ON 73
ci_075                 1.715537e-04 3 1  ON 74
ci_076                 7.922476e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.6444
    reference variance = 0.315744
====================================================
  Execution time = 2.5304e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5070e-01
  Total weights = 1.9551e+06
  Execution time = 3.5958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441679931877
                                         uncertainty =       0.003325985178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441679931877
                                         uncertainty =       0.003325985178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469897382
  error estimate for blocks of size 2^( 2) =       0.000493833932
  error estimate for blocks of size 2^( 3) =       0.000516172076
  error estimate for blocks of size 2^( 4) =       0.000531302665
  error estimate for blocks of size 2^( 5) =       0.000541233448
  error estimate for blocks of size 2^( 6) =       0.000547102047
  error estimate for blocks of size 2^( 7) =       0.000551363328

      target function =      -0.744737551224
              le_mean =     -22.661966526697
             les_mean =     514.015424256638
             stat err =       0.000542750372
             autocorr =       1.334117892108
   target nu stat err =       0.000542750372
   target dn stat err =       0.003757490192
      target stat err =       0.003134177445
              std dev =       0.664535250534
             le_variance =       0.441607099202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441679917999
                                         uncertainty =       0.003325986782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441679917999
                                         uncertainty =       0.003325986782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469897375
  error estimate for blocks of size 2^( 2) =       0.000493833927
  error estimate for blocks of size 2^( 3) =       0.000516172071
  error estimate for blocks of size 2^( 4) =       0.000531302660
  error estimate for blocks of size 2^( 5) =       0.000541233442
  error estimate for blocks of size 2^( 6) =       0.000547102042
  error estimate for blocks of size 2^( 7) =       0.000551363324

      target function =      -0.744737793761
              le_mean =     -22.661966526474
             les_mean =     514.015423950288
             stat err =       0.000542750367
             autocorr =       1.334117911765
   target nu stat err =       0.000542750367
   target dn stat err =       0.003757492314
      target stat err =       0.003134181153
              std dev =       0.664535240075
             le_variance =       0.441607085302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441679924938
                                         uncertainty =       0.003325985980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441679924938
                                         uncertainty =       0.003325985980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469897378
  error estimate for blocks of size 2^( 2) =       0.000493833930
  error estimate for blocks of size 2^( 3) =       0.000516172074
  error estimate for blocks of size 2^( 4) =       0.000531302663
  error estimate for blocks of size 2^( 5) =       0.000541233445
  error estimate for blocks of size 2^( 6) =       0.000547102045
  error estimate for blocks of size 2^( 7) =       0.000551363326

      target function =      -0.744737674621
              le_mean =     -22.661966526585
             les_mean =     514.015424100861
             stat err =       0.000542750370
             autocorr =       1.334117901947
   target nu stat err =       0.000542750370
   target dn stat err =       0.003757491244
      target stat err =       0.003134179309
              std dev =       0.664535245304
             le_variance =       0.441607092252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441679931010
                                         uncertainty =       0.003325985278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441679931010
                                         uncertainty =       0.003325985278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469897382
  error estimate for blocks of size 2^( 2) =       0.000493833932
  error estimate for blocks of size 2^( 3) =       0.000516172076
  error estimate for blocks of size 2^( 4) =       0.000531302664
  error estimate for blocks of size 2^( 5) =       0.000541233448
  error estimate for blocks of size 2^( 6) =       0.000547102047
  error estimate for blocks of size 2^( 7) =       0.000551363327

      target function =      -0.744737566888
              le_mean =     -22.661966526683
             les_mean =     514.015424236873
             stat err =       0.000542750372
             autocorr =       1.334117893346
   target nu stat err =       0.000542750372
   target dn stat err =       0.003757490323
      target stat err =       0.003134177679
              std dev =       0.664535249880
             le_variance =       0.441607098333


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744737551224        initial
     3.2312e+03     3.2312e+04             1.0550e-07        -0.744737793761  <--
     1.2925e+04     1.2925e+05             2.6375e-08        -0.744737674621
     5.1699e+04     5.1699e+05             6.5937e-09        -0.744737566888

*****************************************************************************
Applying the update for shift_i =   3.2312e+03     and shift_s =   3.2312e+04
*****************************************************************************

  Execution time = 4.3360e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_001                -7.055658e-01 3 1  ON 0
ci_002                -7.029285e-01 3 1  ON 1
ci_003                -5.011391e-02 3 1  ON 2
ci_004                -5.098559e-02 3 1  ON 3
ci_005                 1.947024e-02 3 1  ON 4
ci_006                 1.976015e-02 3 1  ON 5
ci_007                 1.473328e-02 3 1  ON 6
ci_008                 1.549351e-02 3 1  ON 7
ci_009                -1.315624e-02 3 1  ON 8
ci_010                -1.205401e-02 3 1  ON 9
ci_011                -9.848326e-03 3 1  ON 10
ci_012                -9.084887e-03 3 1  ON 11
ci_013                 8.365891e-03 3 1  ON 12
ci_014                 9.297061e-03 3 1  ON 13
ci_015                 9.499219e-03 3 1  ON 14
ci_016                 9.361217e-03 3 1  ON 15
ci_017                 8.490855e-03 3 1  ON 16
ci_018                 8.266089e-03 3 1  ON 17
ci_019                -1.264341e-03 3 1  ON 18
ci_020                -1.587375e-03 3 1  ON 19
ci_021                -1.182033e-02 3 1  ON 20
ci_022                -1.183559e-02 3 1  ON 21
ci_023                 4.842544e-03 3 1  ON 22
ci_024                 4.911377e-03 3 1  ON 23
ci_025                 1.152980e-02 3 1  ON 24
ci_026                 1.153131e-02 3 1  ON 25
ci_027                 6.477101e-03 3 1  ON 26
ci_028                 6.177246e-03 3 1  ON 27
ci_029                -5.032261e-03 3 1  ON 28
ci_030                -4.114839e-03 3 1  ON 29
ci_031                 3.414744e-03 3 1  ON 30
ci_032                 4.670149e-03 3 1  ON 31
ci_033                 2.349859e-03 3 1  ON 32
ci_034                 4.108285e-03 3 1  ON 33
ci_035                 1.724131e-03 3 1  ON 34
ci_036                 2.137442e-03 3 1  ON 35
ci_037                 3.492462e-03 3 1  ON 36
ci_038                 3.699992e-03 3 1  ON 37
ci_039                 4.602763e-03 3 1  ON 38
ci_040                 4.920470e-03 3 1  ON 39
ci_041                 2.955523e-03 3 1  ON 40
ci_042                 2.734357e-03 3 1  ON 41
ci_043                 2.939016e-03 3 1  ON 42
ci_044                 3.206662e-03 3 1  ON 43
ci_045                 2.473880e-03 3 1  ON 44
ci_046                 2.735209e-03 3 1  ON 45
ci_047                -1.006258e-03 3 1  ON 46
ci_048                -8.448412e-04 3 1  ON 47
ci_049                 7.808346e-04 3 1  ON 48
ci_050                 9.952386e-04 3 1  ON 49
ci_051                -3.367473e-04 3 1  ON 50
ci_052                -1.211794e-03 3 1  ON 51
ci_053                -2.460274e-03 3 1  ON 52
ci_054                -2.689061e-03 3 1  ON 53
ci_055                -1.790882e-03 3 1  ON 54
ci_056                -1.964828e-03 3 1  ON 55
ci_057                -1.319564e-03 3 1  ON 56
ci_058                -9.966833e-04 3 1  ON 57
ci_059                -5.222261e-04 3 1  ON 58
ci_060                -7.412868e-04 3 1  ON 59
ci_061                 6.295749e-06 3 1  ON 60
ci_062                -9.070651e-04 3 1  ON 61
ci_063                -8.884985e-04 3 1  ON 62
ci_064                -5.042404e-04 3 1  ON 63
ci_065                -1.365784e-03 3 1  ON 64
ci_066                -1.881778e-03 3 1  ON 65
ci_067                -1.823687e-03 3 1  ON 66
ci_068                -1.481272e-03 3 1  ON 67
ci_069                -5.506964e-04 3 1  ON 68
ci_070                -4.211700e-04 3 1  ON 69
ci_071                -2.064434e-03 3 1  ON 70
ci_072                -1.991226e-03 3 1  ON 71
ci_073                 1.589337e-04 3 1  ON 72
ci_074                 1.766625e-04 3 1  ON 73
ci_075                 1.715638e-04 3 1  ON 74
ci_076                 7.922454e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4400e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6368
    reference variance = 0.416294
====================================================
  Execution time = 2.6151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4807e-01
  Total weights = 1.955635208e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440620595954
                                         uncertainty =       0.002464258730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440620595954
                                         uncertainty =       0.002464258730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469383312
  error estimate for blocks of size 2^( 2) =       0.000493551843
  error estimate for blocks of size 2^( 3) =       0.000515594233
  error estimate for blocks of size 2^( 4) =       0.000531393889
  error estimate for blocks of size 2^( 5) =       0.000540490954
  error estimate for blocks of size 2^( 6) =       0.000543624313
  error estimate for blocks of size 2^( 7) =       0.000548451445

      target function =      -0.746905269261
              le_mean =     -22.662235596715
             les_mean =     514.024990455509
             stat err =       0.000540990151
             autocorr =       1.328383358435
   target nu stat err =       0.000540990151
   target dn stat err =       0.002845646177
      target stat err =       0.002419431218
              std dev =       0.663808245887
             le_variance =       0.440641387308


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266223559671e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.0779e+02, overlap shift 8.0779e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746912262881       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746912285915       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746912291104       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746912291462       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746912291468       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746912291580       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746912291577       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746912291545       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746912291543       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746912291548       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746912291542       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746912291544       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.0779e+02 is 2.320264e-07

solving harmonic davidson linear method for identity shift 3.2312e+03, overlap shift 3.2312e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746912262881       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746912268640       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746912269937       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746912270027       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746912270026       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746912270054       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746912270060       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746912270048       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746912270051       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746912270041       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746912270048       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746912270051       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+03 is 5.800871e-08

solving harmonic davidson linear method for identity shift 1.2925e+04, overlap shift 1.2925e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746912262881       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746912264321       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746912264645       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746912264673       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746912264664       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746912264644       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746912264687       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746912264678       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746912264674       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746912264671       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746912264670       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746912264680       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+04 is 1.450231e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.373718 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0852e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_001                -7.055659e-01 3 1  ON 0
ci_002                -7.029284e-01 3 1  ON 1
ci_003                -5.011392e-02 3 1  ON 2
ci_004                -5.098560e-02 3 1  ON 3
ci_005                 1.947022e-02 3 1  ON 4
ci_006                 1.976011e-02 3 1  ON 5
ci_007                 1.473327e-02 3 1  ON 6
ci_008                 1.549348e-02 3 1  ON 7
ci_009                -1.315625e-02 3 1  ON 8
ci_010                -1.205398e-02 3 1  ON 9
ci_011                -9.848283e-03 3 1  ON 10
ci_012                -9.084875e-03 3 1  ON 11
ci_013                 8.365875e-03 3 1  ON 12
ci_014                 9.297039e-03 3 1  ON 13
ci_015                 9.499202e-03 3 1  ON 14
ci_016                 9.361208e-03 3 1  ON 15
ci_017                 8.490878e-03 3 1  ON 16
ci_018                 8.266068e-03 3 1  ON 17
ci_019                -1.264398e-03 3 1  ON 18
ci_020                -1.587410e-03 3 1  ON 19
ci_021                -1.182035e-02 3 1  ON 20
ci_022                -1.183563e-02 3 1  ON 21
ci_023                 4.842545e-03 3 1  ON 22
ci_024                 4.911341e-03 3 1  ON 23
ci_025                 1.152984e-02 3 1  ON 24
ci_026                 1.153134e-02 3 1  ON 25
ci_027                 6.477084e-03 3 1  ON 26
ci_028                 6.177228e-03 3 1  ON 27
ci_029                -5.032267e-03 3 1  ON 28
ci_030                -4.114850e-03 3 1  ON 29
ci_031                 3.414802e-03 3 1  ON 30
ci_032                 4.670203e-03 3 1  ON 31
ci_033                 2.349866e-03 3 1  ON 32
ci_034                 4.108255e-03 3 1  ON 33
ci_035                 1.724127e-03 3 1  ON 34
ci_036                 2.137428e-03 3 1  ON 35
ci_037                 3.492458e-03 3 1  ON 36
ci_038                 3.699991e-03 3 1  ON 37
ci_039                 4.602749e-03 3 1  ON 38
ci_040                 4.920456e-03 3 1  ON 39
ci_041                 2.955526e-03 3 1  ON 40
ci_042                 2.734352e-03 3 1  ON 41
ci_043                 2.939036e-03 3 1  ON 42
ci_044                 3.206652e-03 3 1  ON 43
ci_045                 2.473856e-03 3 1  ON 44
ci_046                 2.735202e-03 3 1  ON 45
ci_047                -1.006254e-03 3 1  ON 46
ci_048                -8.448424e-04 3 1  ON 47
ci_049                 7.808411e-04 3 1  ON 48
ci_050                 9.952466e-04 3 1  ON 49
ci_051                -3.367343e-04 3 1  ON 50
ci_052                -1.211774e-03 3 1  ON 51
ci_053                -2.460294e-03 3 1  ON 52
ci_054                -2.689072e-03 3 1  ON 53
ci_055                -1.790870e-03 3 1  ON 54
ci_056                -1.964793e-03 3 1  ON 55
ci_057                -1.319563e-03 3 1  ON 56
ci_058                -9.966702e-04 3 1  ON 57
ci_059                -5.222245e-04 3 1  ON 58
ci_060                -7.412796e-04 3 1  ON 59
ci_061                 6.280295e-06 3 1  ON 60
ci_062                -9.070640e-04 3 1  ON 61
ci_063                -8.884946e-04 3 1  ON 62
ci_064                -5.042446e-04 3 1  ON 63
ci_065                -1.365777e-03 3 1  ON 64
ci_066                -1.881753e-03 3 1  ON 65
ci_067                -1.823680e-03 3 1  ON 66
ci_068                -1.481276e-03 3 1  ON 67
ci_069                -5.507016e-04 3 1  ON 68
ci_070                -4.211521e-04 3 1  ON 69
ci_071                -2.064422e-03 3 1  ON 70
ci_072                -1.991211e-03 3 1  ON 71
ci_073                 1.589470e-04 3 1  ON 72
ci_074                 1.766653e-04 3 1  ON 73
ci_075                 1.715665e-04 3 1  ON 74
ci_076                 7.922255e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6472
    reference variance = 0.303969
====================================================
  Execution time = 2.5357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5497e-01
  Total weights = 1.9549e+06
  Execution time = 3.6146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442213643676
                                         uncertainty =       0.002263409380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442213643676
                                         uncertainty =       0.002263409380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470253690
  error estimate for blocks of size 2^( 2) =       0.000493818824
  error estimate for blocks of size 2^( 3) =       0.000515893806
  error estimate for blocks of size 2^( 4) =       0.000531055501
  error estimate for blocks of size 2^( 5) =       0.000539391662
  error estimate for blocks of size 2^( 6) =       0.000545047237
  error estimate for blocks of size 2^( 7) =       0.000547676695

      target function =      -0.741255127042
              le_mean =     -22.661909681555
             les_mean =     514.017123983022
             stat err =       0.000540792774
             autocorr =       1.322505037008
   target nu stat err =       0.000540792774
   target dn stat err =       0.003253532779
      target stat err =       0.002704617598
              std dev =       0.665039146707
             le_variance =       0.442277066653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442213606510
                                         uncertainty =       0.002263404790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442213606510
                                         uncertainty =       0.002263404790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470253671
  error estimate for blocks of size 2^( 2) =       0.000493818812
  error estimate for blocks of size 2^( 3) =       0.000515893798
  error estimate for blocks of size 2^( 4) =       0.000531055496
  error estimate for blocks of size 2^( 5) =       0.000539391659
  error estimate for blocks of size 2^( 6) =       0.000545047234
  error estimate for blocks of size 2^( 7) =       0.000547676696

      target function =      -0.741261599650
              le_mean =     -22.661909682418
             les_mean =     514.017116043532
             stat err =       0.000540792771
             autocorr =       1.322505132946
   target nu stat err =       0.000540792771
   target dn stat err =       0.003253388727
      target stat err =       0.002704549683
              std dev =       0.665039119139
             le_variance =       0.442277029985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442213625091
                                         uncertainty =       0.002263407085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442213625091
                                         uncertainty =       0.002263407085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470253681
  error estimate for blocks of size 2^( 2) =       0.000493818818
  error estimate for blocks of size 2^( 3) =       0.000515893802
  error estimate for blocks of size 2^( 4) =       0.000531055499
  error estimate for blocks of size 2^( 5) =       0.000539391660
  error estimate for blocks of size 2^( 6) =       0.000545047235
  error estimate for blocks of size 2^( 7) =       0.000547676695

      target function =      -0.741258500989
              le_mean =     -22.661909681985
             les_mean =     514.017119843534
             stat err =       0.000540792772
             autocorr =       1.322505084970
   target nu stat err =       0.000540792772
   target dn stat err =       0.003253455573
      target stat err =       0.002704580522
              std dev =       0.665039132921
             le_variance =       0.442277048317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442213641353
                                         uncertainty =       0.002263409093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442213641353
                                         uncertainty =       0.002263409093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470253689
  error estimate for blocks of size 2^( 2) =       0.000493818824
  error estimate for blocks of size 2^( 3) =       0.000515893806
  error estimate for blocks of size 2^( 4) =       0.000531055501
  error estimate for blocks of size 2^( 5) =       0.000539391662
  error estimate for blocks of size 2^( 6) =       0.000545047237
  error estimate for blocks of size 2^( 7) =       0.000547676695

      target function =      -0.741255564996
              le_mean =     -22.661909681608
             les_mean =     514.017123445595
             stat err =       0.000540792774
             autocorr =       1.322505043010
   target nu stat err =       0.000540792774
   target dn stat err =       0.003253522494
      target stat err =       0.002704612577
              std dev =       0.665039144984
             le_variance =       0.442277064361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741255127042        initial
     8.0779e+02     8.0779e+03             2.3203e-07        -0.741261599650  <--
     3.2312e+03     3.2312e+04             5.8009e-08        -0.741258500989
     1.2925e+04     1.2925e+05             1.4502e-08        -0.741255564996

*****************************************************************************
Applying the update for shift_i =   8.0779e+02     and shift_s =   8.0779e+03
*****************************************************************************

  Execution time = 4.3481e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_001                -7.055659e-01 3 1  ON 0
ci_002                -7.029283e-01 3 1  ON 1
ci_003                -5.011394e-02 3 1  ON 2
ci_004                -5.098565e-02 3 1  ON 3
ci_005                 1.947015e-02 3 1  ON 4
ci_006                 1.976001e-02 3 1  ON 5
ci_007                 1.473324e-02 3 1  ON 6
ci_008                 1.549340e-02 3 1  ON 7
ci_009                -1.315627e-02 3 1  ON 8
ci_010                -1.205391e-02 3 1  ON 9
ci_011                -9.848153e-03 3 1  ON 10
ci_012                -9.084838e-03 3 1  ON 11
ci_013                 8.365828e-03 3 1  ON 12
ci_014                 9.296972e-03 3 1  ON 13
ci_015                 9.499149e-03 3 1  ON 14
ci_016                 9.361180e-03 3 1  ON 15
ci_017                 8.490947e-03 3 1  ON 16
ci_018                 8.266005e-03 3 1  ON 17
ci_019                -1.264570e-03 3 1  ON 18
ci_020                -1.587515e-03 3 1  ON 19
ci_021                -1.182040e-02 3 1  ON 20
ci_022                -1.183577e-02 3 1  ON 21
ci_023                 4.842549e-03 3 1  ON 22
ci_024                 4.911231e-03 3 1  ON 23
ci_025                 1.152996e-02 3 1  ON 24
ci_026                 1.153141e-02 3 1  ON 25
ci_027                 6.477033e-03 3 1  ON 26
ci_028                 6.177173e-03 3 1  ON 27
ci_029                -5.032286e-03 3 1  ON 28
ci_030                -4.114883e-03 3 1  ON 29
ci_031                 3.414976e-03 3 1  ON 30
ci_032                 4.670367e-03 3 1  ON 31
ci_033                 2.349885e-03 3 1  ON 32
ci_034                 4.108165e-03 3 1  ON 33
ci_035                 1.724114e-03 3 1  ON 34
ci_036                 2.137385e-03 3 1  ON 35
ci_037                 3.492445e-03 3 1  ON 36
ci_038                 3.699988e-03 3 1  ON 37
ci_039                 4.602709e-03 3 1  ON 38
ci_040                 4.920414e-03 3 1  ON 39
ci_041                 2.955533e-03 3 1  ON 40
ci_042                 2.734338e-03 3 1  ON 41
ci_043                 2.939095e-03 3 1  ON 42
ci_044                 3.206620e-03 3 1  ON 43
ci_045                 2.473785e-03 3 1  ON 44
ci_046                 2.735181e-03 3 1  ON 45
ci_047                -1.006242e-03 3 1  ON 46
ci_048                -8.448460e-04 3 1  ON 47
ci_049                 7.808608e-04 3 1  ON 48
ci_050                 9.952705e-04 3 1  ON 49
ci_051                -3.366953e-04 3 1  ON 50
ci_052                -1.211713e-03 3 1  ON 51
ci_053                -2.460357e-03 3 1  ON 52
ci_054                -2.689106e-03 3 1  ON 53
ci_055                -1.790833e-03 3 1  ON 54
ci_056                -1.964690e-03 3 1  ON 55
ci_057                -1.319560e-03 3 1  ON 56
ci_058                -9.966312e-04 3 1  ON 57
ci_059                -5.222196e-04 3 1  ON 58
ci_060                -7.412580e-04 3 1  ON 59
ci_061                 6.233933e-06 3 1  ON 60
ci_062                -9.070607e-04 3 1  ON 61
ci_063                -8.884828e-04 3 1  ON 62
ci_064                -5.042573e-04 3 1  ON 63
ci_065                -1.365756e-03 3 1  ON 64
ci_066                -1.881677e-03 3 1  ON 65
ci_067                -1.823660e-03 3 1  ON 66
ci_068                -1.481287e-03 3 1  ON 67
ci_069                -5.507174e-04 3 1  ON 68
ci_070                -4.210986e-04 3 1  ON 69
ci_071                -2.064387e-03 3 1  ON 70
ci_072                -1.991167e-03 3 1  ON 71
ci_073                 1.589867e-04 3 1  ON 72
ci_074                 1.766736e-04 3 1  ON 73
ci_075                 1.715744e-04 3 1  ON 74
ci_076                 7.921657e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4373e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.6557
    reference variance = 0.331828
====================================================
  Execution time = 2.6452e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5138e-01
  Total weights = 1.954889632e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443453925092
                                         uncertainty =       0.002904189872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443453925092
                                         uncertainty =       0.002904189872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470860400
  error estimate for blocks of size 2^( 2) =       0.000494960821
  error estimate for blocks of size 2^( 3) =       0.000516896384
  error estimate for blocks of size 2^( 4) =       0.000532537124
  error estimate for blocks of size 2^( 5) =       0.000542286744
  error estimate for blocks of size 2^( 6) =       0.000546714636
  error estimate for blocks of size 2^( 7) =       0.000548095035

      target function =      -0.744173121260
              le_mean =     -22.661483790888
             les_mean =     513.994232568739
             stat err =       0.000542408385
             autocorr =       1.326992454716
   target nu stat err =       0.000542408385
   target dn stat err =       0.003302016653
      target stat err =       0.002762786770
              std dev =       0.665897164126
             le_variance =       0.443419033191


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266148379089e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0195e+02, overlap shift 2.0195e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744182512991       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744182635604       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744182645277       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744182646380       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744182646690       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744182646661       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744182646888       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744182647088       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744182647037       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744182647018       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0195e+02 is 1.077912e-06

solving harmonic davidson linear method for identity shift 8.0779e+02, overlap shift 8.0779e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744182512991       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744182543650       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744182546068       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744182546344       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744182546422       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744182546413       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744182546471       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744182546520       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744182546508       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744182546503       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.0779e+02 is 2.695154e-07

solving harmonic davidson linear method for identity shift 3.2312e+03, overlap shift 3.2312e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744182512991       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744182520656       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744182521261       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744182521330       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744182521349       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744182521347       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744182521365       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744182521374       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744182521364       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744182521370       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.2312e+03 is 6.738119e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.377326 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1213e+01
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_001                -7.055659e-01 3 1  ON 0
ci_002                -7.029284e-01 3 1  ON 1
ci_003                -5.011393e-02 3 1  ON 2
ci_004                -5.098561e-02 3 1  ON 3
ci_005                 1.947011e-02 3 1  ON 4
ci_006                 1.976004e-02 3 1  ON 5
ci_007                 1.473315e-02 3 1  ON 6
ci_008                 1.549334e-02 3 1  ON 7
ci_009                -1.315610e-02 3 1  ON 8
ci_010                -1.205395e-02 3 1  ON 9
ci_011                -9.848151e-03 3 1  ON 10
ci_012                -9.084783e-03 3 1  ON 11
ci_013                 8.365841e-03 3 1  ON 12
ci_014                 9.296814e-03 3 1  ON 13
ci_015                 9.499128e-03 3 1  ON 14
ci_016                 9.361121e-03 3 1  ON 15
ci_017                 8.491010e-03 3 1  ON 16
ci_018                 8.265966e-03 3 1  ON 17
ci_019                -1.264750e-03 3 1  ON 18
ci_020                -1.587784e-03 3 1  ON 19
ci_021                -1.182051e-02 3 1  ON 20
ci_022                -1.183578e-02 3 1  ON 21
ci_023                 4.842571e-03 3 1  ON 22
ci_024                 4.911170e-03 3 1  ON 23
ci_025                 1.153018e-02 3 1  ON 24
ci_026                 1.153164e-02 3 1  ON 25
ci_027                 6.477011e-03 3 1  ON 26
ci_028                 6.177172e-03 3 1  ON 27
ci_029                -5.032105e-03 3 1  ON 28
ci_030                -4.114834e-03 3 1  ON 29
ci_031                 3.415103e-03 3 1  ON 30
ci_032                 4.670565e-03 3 1  ON 31
ci_033                 2.349999e-03 3 1  ON 32
ci_034                 4.108081e-03 3 1  ON 33
ci_035                 1.724134e-03 3 1  ON 34
ci_036                 2.137363e-03 3 1  ON 35
ci_037                 3.492397e-03 3 1  ON 36
ci_038                 3.699991e-03 3 1  ON 37
ci_039                 4.602684e-03 3 1  ON 38
ci_040                 4.920339e-03 3 1  ON 39
ci_041                 2.955562e-03 3 1  ON 40
ci_042                 2.734331e-03 3 1  ON 41
ci_043                 2.939205e-03 3 1  ON 42
ci_044                 3.206599e-03 3 1  ON 43
ci_045                 2.473769e-03 3 1  ON 44
ci_046                 2.735049e-03 3 1  ON 45
ci_047                -1.006238e-03 3 1  ON 46
ci_048                -8.448787e-04 3 1  ON 47
ci_049                 7.810517e-04 3 1  ON 48
ci_050                 9.951422e-04 3 1  ON 49
ci_051                -3.367113e-04 3 1  ON 50
ci_052                -1.211770e-03 3 1  ON 51
ci_053                -2.460320e-03 3 1  ON 52
ci_054                -2.689121e-03 3 1  ON 53
ci_055                -1.790679e-03 3 1  ON 54
ci_056                -1.964666e-03 3 1  ON 55
ci_057                -1.319539e-03 3 1  ON 56
ci_058                -9.966211e-04 3 1  ON 57
ci_059                -5.222165e-04 3 1  ON 58
ci_060                -7.412500e-04 3 1  ON 59
ci_061                 6.229594e-06 3 1  ON 60
ci_062                -9.070471e-04 3 1  ON 61
ci_063                -8.883216e-04 3 1  ON 62
ci_064                -5.043139e-04 3 1  ON 63
ci_065                -1.365703e-03 3 1  ON 64
ci_066                -1.881698e-03 3 1  ON 65
ci_067                -1.823738e-03 3 1  ON 66
ci_068                -1.481289e-03 3 1  ON 67
ci_069                -5.507035e-04 3 1  ON 68
ci_070                -4.210945e-04 3 1  ON 69
ci_071                -2.064384e-03 3 1  ON 70
ci_072                -1.991179e-03 3 1  ON 71
ci_073                 1.590352e-04 3 1  ON 72
ci_074                 1.766401e-04 3 1  ON 73
ci_075                 1.714635e-04 3 1  ON 74
ci_076                 7.921489e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.7108
    reference variance = 0.436757
====================================================
  Execution time = 2.5534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4352e-01
  Total weights = 1.9552e+06
  Execution time = 3.5952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434896906207
                                         uncertainty =       0.001912280325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434896906207
                                         uncertainty =       0.001912280325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466316286
  error estimate for blocks of size 2^( 2) =       0.000490581788
  error estimate for blocks of size 2^( 3) =       0.000513547015
  error estimate for blocks of size 2^( 4) =       0.000528901497
  error estimate for blocks of size 2^( 5) =       0.000536889731
  error estimate for blocks of size 2^( 6) =       0.000541969862
  error estimate for blocks of size 2^( 7) =       0.000543765904

      target function =      -0.750677085387
              le_mean =     -22.662397924790
             les_mean =     514.027800458292
             stat err =       0.000537881748
             autocorr =       1.330492556327
   target nu stat err =       0.000537881748
   target dn stat err =       0.002190492814
      target stat err =       0.001918643792
              std dev =       0.659470815868
             le_variance =       0.434901756981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434896793890
                                         uncertainty =       0.001912284186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434896793890
                                         uncertainty =       0.001912284186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466316225
  error estimate for blocks of size 2^( 2) =       0.000490581731
  error estimate for blocks of size 2^( 3) =       0.000513546956
  error estimate for blocks of size 2^( 4) =       0.000528901440
  error estimate for blocks of size 2^( 5) =       0.000536889665
  error estimate for blocks of size 2^( 6) =       0.000541969780
  error estimate for blocks of size 2^( 7) =       0.000543765805

      target function =      -0.750681938938
              le_mean =     -22.662397929605
             les_mean =     514.027794846550
             stat err =       0.000537881673
             autocorr =       1.330492531041
   target nu stat err =       0.000537881673
   target dn stat err =       0.002190482610
      target stat err =       0.001918659317
              std dev =       0.659470729316
             le_variance =       0.434901642825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434896850018
                                         uncertainty =       0.001912282256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434896850018
                                         uncertainty =       0.001912282256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466316255
  error estimate for blocks of size 2^( 2) =       0.000490581760
  error estimate for blocks of size 2^( 3) =       0.000513546985
  error estimate for blocks of size 2^( 4) =       0.000528901468
  error estimate for blocks of size 2^( 5) =       0.000536889698
  error estimate for blocks of size 2^( 6) =       0.000541969821
  error estimate for blocks of size 2^( 7) =       0.000543765854

      target function =      -0.750679778575
              le_mean =     -22.662397927204
             les_mean =     514.027797332732
             stat err =       0.000537881710
             autocorr =       1.330492543631
   target nu stat err =       0.000537881710
   target dn stat err =       0.002190484734
      target stat err =       0.001918650494
              std dev =       0.659470772569
             le_variance =       0.434901699873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434896899181
                                         uncertainty =       0.001912280567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434896899181
                                         uncertainty =       0.001912280567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466316282
  error estimate for blocks of size 2^( 2) =       0.000490581785
  error estimate for blocks of size 2^( 3) =       0.000513547011
  error estimate for blocks of size 2^( 4) =       0.000528901493
  error estimate for blocks of size 2^( 5) =       0.000536889726
  error estimate for blocks of size 2^( 6) =       0.000541969857
  error estimate for blocks of size 2^( 7) =       0.000543765898

      target function =      -0.750677458133
              le_mean =     -22.662397925092
             les_mean =     514.027800024281
             stat err =       0.000537881744
             autocorr =       1.330492554736
   target nu stat err =       0.000537881744
   target dn stat err =       0.002190491360
      target stat err =       0.001918644454
              std dev =       0.659470810453
             le_variance =       0.434901749840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750677085387        initial
     2.0195e+02     2.0195e+03             1.0779e-06        -0.750681938938  <--
     8.0779e+02     8.0779e+03             2.6952e-07        -0.750679778575
     3.2312e+03     3.2312e+04             6.7381e-08        -0.750677458133

*****************************************************************************
Applying the update for shift_i =   2.0195e+02     and shift_s =   2.0195e+03
*****************************************************************************

  Execution time = 4.3681e+01
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029287e-01 3 1  ON 1
ci_003                -5.011389e-02 3 1  ON 2
ci_004                -5.098549e-02 3 1  ON 3
ci_005                 1.946997e-02 3 1  ON 4
ci_006                 1.976015e-02 3 1  ON 5
ci_007                 1.473290e-02 3 1  ON 6
ci_008                 1.549318e-02 3 1  ON 7
ci_009                -1.315557e-02 3 1  ON 8
ci_010                -1.205409e-02 3 1  ON 9
ci_011                -9.848147e-03 3 1  ON 10
ci_012                -9.084619e-03 3 1  ON 11
ci_013                 8.365879e-03 3 1  ON 12
ci_014                 9.296342e-03 3 1  ON 13
ci_015                 9.499065e-03 3 1  ON 14
ci_016                 9.360945e-03 3 1  ON 15
ci_017                 8.491199e-03 3 1  ON 16
ci_018                 8.265850e-03 3 1  ON 17
ci_019                -1.265290e-03 3 1  ON 18
ci_020                -1.588592e-03 3 1  ON 19
ci_021                -1.182086e-02 3 1  ON 20
ci_022                -1.183580e-02 3 1  ON 21
ci_023                 4.842637e-03 3 1  ON 22
ci_024                 4.910988e-03 3 1  ON 23
ci_025                 1.153086e-02 3 1  ON 24
ci_026                 1.153233e-02 3 1  ON 25
ci_027                 6.476944e-03 3 1  ON 26
ci_028                 6.177169e-03 3 1  ON 27
ci_029                -5.031564e-03 3 1  ON 28
ci_030                -4.114686e-03 3 1  ON 29
ci_031                 3.415482e-03 3 1  ON 30
ci_032                 4.671159e-03 3 1  ON 31
ci_033                 2.350341e-03 3 1  ON 32
ci_034                 4.107830e-03 3 1  ON 33
ci_035                 1.724193e-03 3 1  ON 34
ci_036                 2.137298e-03 3 1  ON 35
ci_037                 3.492251e-03 3 1  ON 36
ci_038                 3.699999e-03 3 1  ON 37
ci_039                 4.602608e-03 3 1  ON 38
ci_040                 4.920113e-03 3 1  ON 39
ci_041                 2.955649e-03 3 1  ON 40
ci_042                 2.734312e-03 3 1  ON 41
ci_043                 2.939537e-03 3 1  ON 42
ci_044                 3.206537e-03 3 1  ON 43
ci_045                 2.473723e-03 3 1  ON 44
ci_046                 2.734653e-03 3 1  ON 45
ci_047                -1.006227e-03 3 1  ON 46
ci_048                -8.449767e-04 3 1  ON 47
ci_049                 7.816243e-04 3 1  ON 48
ci_050                 9.947571e-04 3 1  ON 49
ci_051                -3.367593e-04 3 1  ON 50
ci_052                -1.211942e-03 3 1  ON 51
ci_053                -2.460210e-03 3 1  ON 52
ci_054                -2.689166e-03 3 1  ON 53
ci_055                -1.790219e-03 3 1  ON 54
ci_056                -1.964593e-03 3 1  ON 55
ci_057                -1.319475e-03 3 1  ON 56
ci_058                -9.965908e-04 3 1  ON 57
ci_059                -5.222071e-04 3 1  ON 58
ci_060                -7.412260e-04 3 1  ON 59
ci_061                 6.216579e-06 3 1  ON 60
ci_062                -9.070062e-04 3 1  ON 61
ci_063                -8.878379e-04 3 1  ON 62
ci_064                -5.044838e-04 3 1  ON 63
ci_065                -1.365541e-03 3 1  ON 64
ci_066                -1.881760e-03 3 1  ON 65
ci_067                -1.823974e-03 3 1  ON 66
ci_068                -1.481294e-03 3 1  ON 67
ci_069                -5.506618e-04 3 1  ON 68
ci_070                -4.210823e-04 3 1  ON 69
ci_071                -2.064377e-03 3 1  ON 70
ci_072                -1.991215e-03 3 1  ON 71
ci_073                 1.591809e-04 3 1  ON 72
ci_074                 1.765394e-04 3 1  ON 73
ci_075                 1.711310e-04 3 1  ON 74
ci_076                 7.920987e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4900e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.6869
    reference variance = 0.328974
====================================================
  Execution time = 2.8228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4990e-01
  Total weights = 1.955033176e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440116670959
                                         uncertainty =       0.002271468360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440116670959
                                         uncertainty =       0.002271468360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469049254
  error estimate for blocks of size 2^( 2) =       0.000492863489
  error estimate for blocks of size 2^( 3) =       0.000515239585
  error estimate for blocks of size 2^( 4) =       0.000531429259
  error estimate for blocks of size 2^( 5) =       0.000542038059
  error estimate for blocks of size 2^( 6) =       0.000545781452
  error estimate for blocks of size 2^( 7) =       0.000549949077

      target function =      -0.745387687061
              le_mean =     -22.661470712316
             les_mean =     513.992158809653
             stat err =       0.000542299462
             autocorr =       1.336723080407
   target nu stat err =       0.000542299462
   target dn stat err =       0.002904382798
      target stat err =       0.002454218036
              std dev =       0.663335816856
             le_variance =       0.440014405925


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266147071232e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.0487e+01, overlap shift 5.0487e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745394367363       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745394717288       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745394759887       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745394763452       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745394763113       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745394764042       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745394764007       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745394764155       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745394764218       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.0487e+01 is 4.110929e-06

solving harmonic davidson linear method for identity shift 2.0195e+02, overlap shift 2.0195e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745394367363       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745394454905       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745394465558       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745394466449       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745394466364       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745394466596       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745394466587       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745394466625       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745394466640       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0195e+02 is 1.028297e-06

solving harmonic davidson linear method for identity shift 8.0779e+02, overlap shift 8.0779e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745394367363       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745394389252       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745394391916       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745394392138       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745394392118       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745394392175       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745394392172       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745394392182       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745394392186       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.0779e+02 is 2.571096e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380411 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2990e+01
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029287e-01 3 1  ON 1
ci_003                -5.011341e-02 3 1  ON 2
ci_004                -5.098592e-02 3 1  ON 3
ci_005                 1.946974e-02 3 1  ON 4
ci_006                 1.975971e-02 3 1  ON 5
ci_007                 1.473297e-02 3 1  ON 6
ci_008                 1.549302e-02 3 1  ON 7
ci_009                -1.315537e-02 3 1  ON 8
ci_010                -1.205385e-02 3 1  ON 9
ci_011                -9.848451e-03 3 1  ON 10
ci_012                -9.084309e-03 3 1  ON 11
ci_013                 8.365686e-03 3 1  ON 12
ci_014                 9.296017e-03 3 1  ON 13
ci_015                 9.499026e-03 3 1  ON 14
ci_016                 9.360709e-03 3 1  ON 15
ci_017                 8.490913e-03 3 1  ON 16
ci_018                 8.265308e-03 3 1  ON 17
ci_019                -1.266318e-03 3 1  ON 18
ci_020                -1.589613e-03 3 1  ON 19
ci_021                -1.182073e-02 3 1  ON 20
ci_022                -1.183586e-02 3 1  ON 21
ci_023                 4.842399e-03 3 1  ON 22
ci_024                 4.910800e-03 3 1  ON 23
ci_025                 1.153140e-02 3 1  ON 24
ci_026                 1.153275e-02 3 1  ON 25
ci_027                 6.476716e-03 3 1  ON 26
ci_028                 6.177366e-03 3 1  ON 27
ci_029                -5.031390e-03 3 1  ON 28
ci_030                -4.115040e-03 3 1  ON 29
ci_031                 3.415802e-03 3 1  ON 30
ci_032                 4.671226e-03 3 1  ON 31
ci_033                 2.350369e-03 3 1  ON 32
ci_034                 4.107421e-03 3 1  ON 33
ci_035                 1.724401e-03 3 1  ON 34
ci_036                 2.137382e-03 3 1  ON 35
ci_037                 3.492382e-03 3 1  ON 36
ci_038                 3.699859e-03 3 1  ON 37
ci_039                 4.602517e-03 3 1  ON 38
ci_040                 4.920196e-03 3 1  ON 39
ci_041                 2.955908e-03 3 1  ON 40
ci_042                 2.734243e-03 3 1  ON 41
ci_043                 2.939452e-03 3 1  ON 42
ci_044                 3.206317e-03 3 1  ON 43
ci_045                 2.473583e-03 3 1  ON 44
ci_046                 2.735091e-03 3 1  ON 45
ci_047                -1.006344e-03 3 1  ON 46
ci_048                -8.449915e-04 3 1  ON 47
ci_049                 7.814697e-04 3 1  ON 48
ci_050                 9.943853e-04 3 1  ON 49
ci_051                -3.369094e-04 3 1  ON 50
ci_052                -1.212195e-03 3 1  ON 51
ci_053                -2.460117e-03 3 1  ON 52
ci_054                -2.689386e-03 3 1  ON 53
ci_055                -1.789889e-03 3 1  ON 54
ci_056                -1.964632e-03 3 1  ON 55
ci_057                -1.319216e-03 3 1  ON 56
ci_058                -9.963180e-04 3 1  ON 57
ci_059                -5.222967e-04 3 1  ON 58
ci_060                -7.408977e-04 3 1  ON 59
ci_061                 6.383763e-06 3 1  ON 60
ci_062                -9.063791e-04 3 1  ON 61
ci_063                -8.876645e-04 3 1  ON 62
ci_064                -5.045097e-04 3 1  ON 63
ci_065                -1.365352e-03 3 1  ON 64
ci_066                -1.881712e-03 3 1  ON 65
ci_067                -1.823526e-03 3 1  ON 66
ci_068                -1.481420e-03 3 1  ON 67
ci_069                -5.509161e-04 3 1  ON 68
ci_070                -4.205520e-04 3 1  ON 69
ci_071                -2.064374e-03 3 1  ON 70
ci_072                -1.991216e-03 3 1  ON 71
ci_073                 1.590247e-04 3 1  ON 72
ci_074                 1.764201e-04 3 1  ON 73
ci_075                 1.714129e-04 3 1  ON 74
ci_076                 7.921914e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.6513
    reference variance = 0.425267
====================================================
  Execution time = 2.7233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5420e-01
  Total weights = 1.9553e+06
  Execution time = 3.7934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444046415178
                                         uncertainty =       0.004322854835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444046415178
                                         uncertainty =       0.004322854835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471183930
  error estimate for blocks of size 2^( 2) =       0.000494820531
  error estimate for blocks of size 2^( 3) =       0.000516537640
  error estimate for blocks of size 2^( 4) =       0.000531634946
  error estimate for blocks of size 2^( 5) =       0.000541799498
  error estimate for blocks of size 2^( 6) =       0.000546392751
  error estimate for blocks of size 2^( 7) =       0.000546707570

      target function =      -0.741867044693
              le_mean =     -22.660830220741
             les_mean =     513.967421283057
             stat err =       0.000541633691
             autocorr =       1.321388134014
   target nu stat err =       0.000541633691
   target dn stat err =       0.005039950061
      target stat err =       0.004131107069
              std dev =       0.666354703637
             le_variance =       0.444028591059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444046286265
                                         uncertainty =       0.004323171712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444046286265
                                         uncertainty =       0.004323171712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471183861
  error estimate for blocks of size 2^( 2) =       0.000494820514
  error estimate for blocks of size 2^( 3) =       0.000516537650
  error estimate for blocks of size 2^( 4) =       0.000531634999
  error estimate for blocks of size 2^( 5) =       0.000541799561
  error estimate for blocks of size 2^( 6) =       0.000546392835
  error estimate for blocks of size 2^( 7) =       0.000546707701

      target function =      -0.741864529200
              le_mean =     -22.660830210675
             les_mean =     513.967423922994
             stat err =       0.000541633774
             autocorr =       1.321388925893
   target nu stat err =       0.000541633774
   target dn stat err =       0.005040389984
      target stat err =       0.004131432494
              std dev =       0.666354605963
             le_variance =       0.444028460888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444046350421
                                         uncertainty =       0.004323013365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444046350421
                                         uncertainty =       0.004323013365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471183895
  error estimate for blocks of size 2^( 2) =       0.000494820523
  error estimate for blocks of size 2^( 3) =       0.000516537645
  error estimate for blocks of size 2^( 4) =       0.000531634973
  error estimate for blocks of size 2^( 5) =       0.000541799530
  error estimate for blocks of size 2^( 6) =       0.000546392793
  error estimate for blocks of size 2^( 7) =       0.000546707636

      target function =      -0.741865801070
              le_mean =     -22.660830215668
             les_mean =     513.967422583796
             stat err =       0.000541633733
             autocorr =       1.321388530369
   target nu stat err =       0.000541633733
   target dn stat err =       0.005040169935
      target stat err =       0.004131269868
              std dev =       0.666354654574
             le_variance =       0.444028525672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444046407053
                                         uncertainty =       0.004322874653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444046407053
                                         uncertainty =       0.004322874653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471183925
  error estimate for blocks of size 2^( 2) =       0.000494820530
  error estimate for blocks of size 2^( 3) =       0.000516537641
  error estimate for blocks of size 2^( 4) =       0.000531634950
  error estimate for blocks of size 2^( 5) =       0.000541799502
  error estimate for blocks of size 2^( 6) =       0.000546392756
  error estimate for blocks of size 2^( 7) =       0.000546707578

      target function =      -0.741866890840
              le_mean =     -22.660830220103
             les_mean =     513.967421443492
             stat err =       0.000541633697
             autocorr =       1.321388183588
   target nu stat err =       0.000541633697
   target dn stat err =       0.005039977525
      target stat err =       0.004131127421
              std dev =       0.666354697481
             le_variance =       0.444028582855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741867044693        initial  <--
     5.0487e+01     5.0487e+02             4.1109e-06        -0.741864529200
     2.0195e+02     2.0195e+03             1.0283e-06        -0.741865801070
     8.0779e+02     8.0779e+03             2.5711e-07        -0.741866890840

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.5234
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029287e-01 3 1  ON 1
ci_003                -5.011389e-02 3 1  ON 2
ci_004                -5.098549e-02 3 1  ON 3
ci_005                 1.946997e-02 3 1  ON 4
ci_006                 1.976015e-02 3 1  ON 5
ci_007                 1.473290e-02 3 1  ON 6
ci_008                 1.549318e-02 3 1  ON 7
ci_009                -1.315557e-02 3 1  ON 8
ci_010                -1.205409e-02 3 1  ON 9
ci_011                -9.848147e-03 3 1  ON 10
ci_012                -9.084619e-03 3 1  ON 11
ci_013                 8.365879e-03 3 1  ON 12
ci_014                 9.296342e-03 3 1  ON 13
ci_015                 9.499065e-03 3 1  ON 14
ci_016                 9.360945e-03 3 1  ON 15
ci_017                 8.491199e-03 3 1  ON 16
ci_018                 8.265850e-03 3 1  ON 17
ci_019                -1.265290e-03 3 1  ON 18
ci_020                -1.588592e-03 3 1  ON 19
ci_021                -1.182086e-02 3 1  ON 20
ci_022                -1.183580e-02 3 1  ON 21
ci_023                 4.842637e-03 3 1  ON 22
ci_024                 4.910988e-03 3 1  ON 23
ci_025                 1.153086e-02 3 1  ON 24
ci_026                 1.153233e-02 3 1  ON 25
ci_027                 6.476944e-03 3 1  ON 26
ci_028                 6.177169e-03 3 1  ON 27
ci_029                -5.031564e-03 3 1  ON 28
ci_030                -4.114686e-03 3 1  ON 29
ci_031                 3.415482e-03 3 1  ON 30
ci_032                 4.671159e-03 3 1  ON 31
ci_033                 2.350341e-03 3 1  ON 32
ci_034                 4.107830e-03 3 1  ON 33
ci_035                 1.724193e-03 3 1  ON 34
ci_036                 2.137298e-03 3 1  ON 35
ci_037                 3.492251e-03 3 1  ON 36
ci_038                 3.699999e-03 3 1  ON 37
ci_039                 4.602608e-03 3 1  ON 38
ci_040                 4.920113e-03 3 1  ON 39
ci_041                 2.955649e-03 3 1  ON 40
ci_042                 2.734312e-03 3 1  ON 41
ci_043                 2.939537e-03 3 1  ON 42
ci_044                 3.206537e-03 3 1  ON 43
ci_045                 2.473723e-03 3 1  ON 44
ci_046                 2.734653e-03 3 1  ON 45
ci_047                -1.006227e-03 3 1  ON 46
ci_048                -8.449767e-04 3 1  ON 47
ci_049                 7.816243e-04 3 1  ON 48
ci_050                 9.947571e-04 3 1  ON 49
ci_051                -3.367593e-04 3 1  ON 50
ci_052                -1.211942e-03 3 1  ON 51
ci_053                -2.460210e-03 3 1  ON 52
ci_054                -2.689166e-03 3 1  ON 53
ci_055                -1.790219e-03 3 1  ON 54
ci_056                -1.964593e-03 3 1  ON 55
ci_057                -1.319475e-03 3 1  ON 56
ci_058                -9.965908e-04 3 1  ON 57
ci_059                -5.222071e-04 3 1  ON 58
ci_060                -7.412260e-04 3 1  ON 59
ci_061                 6.216579e-06 3 1  ON 60
ci_062                -9.070062e-04 3 1  ON 61
ci_063                -8.878379e-04 3 1  ON 62
ci_064                -5.044838e-04 3 1  ON 63
ci_065                -1.365541e-03 3 1  ON 64
ci_066                -1.881760e-03 3 1  ON 65
ci_067                -1.823974e-03 3 1  ON 66
ci_068                -1.481294e-03 3 1  ON 67
ci_069                -5.506618e-04 3 1  ON 68
ci_070                -4.210823e-04 3 1  ON 69
ci_071                -2.064377e-03 3 1  ON 70
ci_072                -1.991215e-03 3 1  ON 71
ci_073                 1.591809e-04 3 1  ON 72
ci_074                 1.765394e-04 3 1  ON 73
ci_075                 1.711310e-04 3 1  ON 74
ci_076                 7.920987e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.7026
    reference variance = 0.381481
====================================================
  Execution time = 2.6263e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5032e-01
  Total weights = 1.955098596e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438874638737
                                         uncertainty =       0.001743226161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438874638737
                                         uncertainty =       0.001743226161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468417778
  error estimate for blocks of size 2^( 2) =       0.000492232119
  error estimate for blocks of size 2^( 3) =       0.000514241713
  error estimate for blocks of size 2^( 4) =       0.000530116459
  error estimate for blocks of size 2^( 5) =       0.000540896600
  error estimate for blocks of size 2^( 6) =       0.000548425548
  error estimate for blocks of size 2^( 7) =       0.000549664682

      target function =      -0.745050027658
              le_mean =     -22.662100833342
             les_mean =     514.021137321370
             stat err =       0.000542275822
             autocorr =       1.340212744271
   target nu stat err =       0.000542275822
   target dn stat err =       0.002977434518
      target stat err =       0.002512465204
              std dev =       0.662442774748
             le_variance =       0.438830429815


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266210083334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.0487e+02, overlap shift 5.0487e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745057568920       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745057605953       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745057613277       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745057613714       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745057613704       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745057613662       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745057613738       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745057613798       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745057613796       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745057613779       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745057613775       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.0487e+02 is 3.976109e-07

solving harmonic davidson linear method for identity shift 2.0195e+03, overlap shift 2.0195e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745057568920       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745057578179       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745057580010       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745057580119       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745057580118       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745057580109       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745057580125       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745057580139       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745057580140       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745057580140       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745057580137       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0195e+03 is 9.940852e-08

solving harmonic davidson linear method for identity shift 8.0779e+03, overlap shift 8.0779e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745057568920       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745057571235       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745057571693       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745057571720       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745057571711       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745057571717       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745057571722       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745057571725       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745057571725       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745057571714       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745057571732       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.0779e+03 is 2.485249e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.384611 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0965e+01
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029287e-01 3 1  ON 1
ci_003                -5.011388e-02 3 1  ON 2
ci_004                -5.098553e-02 3 1  ON 3
ci_005                 1.946998e-02 3 1  ON 4
ci_006                 1.976009e-02 3 1  ON 5
ci_007                 1.473290e-02 3 1  ON 6
ci_008                 1.549314e-02 3 1  ON 7
ci_009                -1.315550e-02 3 1  ON 8
ci_010                -1.205411e-02 3 1  ON 9
ci_011                -9.848161e-03 3 1  ON 10
ci_012                -9.084560e-03 3 1  ON 11
ci_013                 8.365892e-03 3 1  ON 12
ci_014                 9.296279e-03 3 1  ON 13
ci_015                 9.499034e-03 3 1  ON 14
ci_016                 9.360901e-03 3 1  ON 15
ci_017                 8.491159e-03 3 1  ON 16
ci_018                 8.265873e-03 3 1  ON 17
ci_019                -1.265275e-03 3 1  ON 18
ci_020                -1.588647e-03 3 1  ON 19
ci_021                -1.182093e-02 3 1  ON 20
ci_022                -1.183582e-02 3 1  ON 21
ci_023                 4.842630e-03 3 1  ON 22
ci_024                 4.910974e-03 3 1  ON 23
ci_025                 1.153086e-02 3 1  ON 24
ci_026                 1.153243e-02 3 1  ON 25
ci_027                 6.476934e-03 3 1  ON 26
ci_028                 6.177177e-03 3 1  ON 27
ci_029                -5.031546e-03 3 1  ON 28
ci_030                -4.114694e-03 3 1  ON 29
ci_031                 3.415567e-03 3 1  ON 30
ci_032                 4.671184e-03 3 1  ON 31
ci_033                 2.350338e-03 3 1  ON 32
ci_034                 4.107791e-03 3 1  ON 33
ci_035                 1.724195e-03 3 1  ON 34
ci_036                 2.137306e-03 3 1  ON 35
ci_037                 3.492207e-03 3 1  ON 36
ci_038                 3.699994e-03 3 1  ON 37
ci_039                 4.602594e-03 3 1  ON 38
ci_040                 4.920080e-03 3 1  ON 39
ci_041                 2.955616e-03 3 1  ON 40
ci_042                 2.734328e-03 3 1  ON 41
ci_043                 2.939525e-03 3 1  ON 42
ci_044                 3.206483e-03 3 1  ON 43
ci_045                 2.473705e-03 3 1  ON 44
ci_046                 2.734653e-03 3 1  ON 45
ci_047                -1.006202e-03 3 1  ON 46
ci_048                -8.449827e-04 3 1  ON 47
ci_049                 7.816296e-04 3 1  ON 48
ci_050                 9.947363e-04 3 1  ON 49
ci_051                -3.367609e-04 3 1  ON 50
ci_052                -1.211939e-03 3 1  ON 51
ci_053                -2.460189e-03 3 1  ON 52
ci_054                -2.689165e-03 3 1  ON 53
ci_055                -1.790200e-03 3 1  ON 54
ci_056                -1.964564e-03 3 1  ON 55
ci_057                -1.319467e-03 3 1  ON 56
ci_058                -9.965802e-04 3 1  ON 57
ci_059                -5.222035e-04 3 1  ON 58
ci_060                -7.412378e-04 3 1  ON 59
ci_061                 6.186050e-06 3 1  ON 60
ci_062                -9.070173e-04 3 1  ON 61
ci_063                -8.878348e-04 3 1  ON 62
ci_064                -5.044912e-04 3 1  ON 63
ci_065                -1.365553e-03 3 1  ON 64
ci_066                -1.881777e-03 3 1  ON 65
ci_067                -1.823981e-03 3 1  ON 66
ci_068                -1.481348e-03 3 1  ON 67
ci_069                -5.506691e-04 3 1  ON 68
ci_070                -4.210901e-04 3 1  ON 69
ci_071                -2.064341e-03 3 1  ON 70
ci_072                -1.991209e-03 3 1  ON 71
ci_073                 1.592304e-04 3 1  ON 72
ci_074                 1.765342e-04 3 1  ON 73
ci_075                 1.711548e-04 3 1  ON 74
ci_076                 7.920576e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.6091
    reference variance = 0.896909
====================================================
  Execution time = 2.5407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4837e-01
  Total weights = 1.9550e+06
  Execution time = 3.6436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439594730013
                                         uncertainty =       0.002995600546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439594730013
                                         uncertainty =       0.002995600546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468844474
  error estimate for blocks of size 2^( 2) =       0.000492718439
  error estimate for blocks of size 2^( 3) =       0.000514638241
  error estimate for blocks of size 2^( 4) =       0.000529640018
  error estimate for blocks of size 2^( 5) =       0.000539242057
  error estimate for blocks of size 2^( 6) =       0.000543696685
  error estimate for blocks of size 2^( 7) =       0.000545017149

      target function =      -0.746652155919
              le_mean =     -22.662392425004
             les_mean =     514.032404910039
             stat err =       0.000539398977
             autocorr =       1.323617906921
   target nu stat err =       0.000539398977
   target dn stat err =       0.003354242980
      target stat err =       0.002825852691
              std dev =       0.663046214150
             le_variance =       0.439630282098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439594687779
                                         uncertainty =       0.002995599565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439594687779
                                         uncertainty =       0.002995599565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468844452
  error estimate for blocks of size 2^( 2) =       0.000492718425
  error estimate for blocks of size 2^( 3) =       0.000514638233
  error estimate for blocks of size 2^( 4) =       0.000529640017
  error estimate for blocks of size 2^( 5) =       0.000539242055
  error estimate for blocks of size 2^( 6) =       0.000543696686
  error estimate for blocks of size 2^( 7) =       0.000545017145

      target function =      -0.746652400228
              le_mean =     -22.662392425330
             les_mean =     514.032404628172
             stat err =       0.000539398976
             autocorr =       1.323618026379
   target nu stat err =       0.000539398976
   target dn stat err =       0.003354241199
      target stat err =       0.002825853066
              std dev =       0.663046182635
             le_variance =       0.439630240307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439594708892
                                         uncertainty =       0.002995600055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439594708892
                                         uncertainty =       0.002995600055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468844463
  error estimate for blocks of size 2^( 2) =       0.000492718432
  error estimate for blocks of size 2^( 3) =       0.000514638237
  error estimate for blocks of size 2^( 4) =       0.000529640018
  error estimate for blocks of size 2^( 5) =       0.000539242056
  error estimate for blocks of size 2^( 6) =       0.000543696686
  error estimate for blocks of size 2^( 7) =       0.000545017147

      target function =      -0.746652278402
              le_mean =     -22.662392425167
             les_mean =     514.032404768687
             stat err =       0.000539398977
             autocorr =       1.323617966654
   target nu stat err =       0.000539398977
   target dn stat err =       0.003354242086
      target stat err =       0.002825852878
              std dev =       0.663046198389
             le_variance =       0.439630261198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439594727373
                                         uncertainty =       0.002995600485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439594727373
                                         uncertainty =       0.002995600485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468844473
  error estimate for blocks of size 2^( 2) =       0.000492718438
  error estimate for blocks of size 2^( 3) =       0.000514638241
  error estimate for blocks of size 2^( 4) =       0.000529640018
  error estimate for blocks of size 2^( 5) =       0.000539242057
  error estimate for blocks of size 2^( 6) =       0.000543696685
  error estimate for blocks of size 2^( 7) =       0.000545017149

      target function =      -0.746652171264
              le_mean =     -22.662392425024
             les_mean =     514.032404892325
             stat err =       0.000539398977
             autocorr =       1.323617914400
   target nu stat err =       0.000539398977
   target dn stat err =       0.003354242868
      target stat err =       0.002825852714
              std dev =       0.663046212179
             le_variance =       0.439630279485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746652155919        initial
     5.0487e+02     5.0487e+03             3.9761e-07        -0.746652400228  <--
     2.0195e+03     2.0195e+04             9.9409e-08        -0.746652278402
     8.0779e+03     8.0779e+04             2.4852e-08        -0.746652171264

*****************************************************************************
Applying the update for shift_i =   5.0487e+02     and shift_s =   5.0487e+03
*****************************************************************************

  Execution time = 4.3593e+01
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_001                -7.055657e-01 3 1  ON 0
ci_002                -7.029286e-01 3 1  ON 1
ci_003                -5.011384e-02 3 1  ON 2
ci_004                -5.098563e-02 3 1  ON 3
ci_005                 1.947003e-02 3 1  ON 4
ci_006                 1.975992e-02 3 1  ON 5
ci_007                 1.473290e-02 3 1  ON 6
ci_008                 1.549299e-02 3 1  ON 7
ci_009                -1.315530e-02 3 1  ON 8
ci_010                -1.205416e-02 3 1  ON 9
ci_011                -9.848204e-03 3 1  ON 10
ci_012                -9.084380e-03 3 1  ON 11
ci_013                 8.365929e-03 3 1  ON 12
ci_014                 9.296088e-03 3 1  ON 13
ci_015                 9.498940e-03 3 1  ON 14
ci_016                 9.360768e-03 3 1  ON 15
ci_017                 8.491038e-03 3 1  ON 16
ci_018                 8.265942e-03 3 1  ON 17
ci_019                -1.265231e-03 3 1  ON 18
ci_020                -1.588811e-03 3 1  ON 19
ci_021                -1.182115e-02 3 1  ON 20
ci_022                -1.183589e-02 3 1  ON 21
ci_023                 4.842608e-03 3 1  ON 22
ci_024                 4.910931e-03 3 1  ON 23
ci_025                 1.153087e-02 3 1  ON 24
ci_026                 1.153273e-02 3 1  ON 25
ci_027                 6.476904e-03 3 1  ON 26
ci_028                 6.177201e-03 3 1  ON 27
ci_029                -5.031492e-03 3 1  ON 28
ci_030                -4.114720e-03 3 1  ON 29
ci_031                 3.415820e-03 3 1  ON 30
ci_032                 4.671257e-03 3 1  ON 31
ci_033                 2.350330e-03 3 1  ON 32
ci_034                 4.107674e-03 3 1  ON 33
ci_035                 1.724201e-03 3 1  ON 34
ci_036                 2.137331e-03 3 1  ON 35
ci_037                 3.492075e-03 3 1  ON 36
ci_038                 3.699977e-03 3 1  ON 37
ci_039                 4.602553e-03 3 1  ON 38
ci_040                 4.919982e-03 3 1  ON 39
ci_041                 2.955516e-03 3 1  ON 40
ci_042                 2.734375e-03 3 1  ON 41
ci_043                 2.939488e-03 3 1  ON 42
ci_044                 3.206321e-03 3 1  ON 43
ci_045                 2.473653e-03 3 1  ON 44
ci_046                 2.734654e-03 3 1  ON 45
ci_047                -1.006126e-03 3 1  ON 46
ci_048                -8.450006e-04 3 1  ON 47
ci_049                 7.816454e-04 3 1  ON 48
ci_050                 9.946740e-04 3 1  ON 49
ci_051                -3.367656e-04 3 1  ON 50
ci_052                -1.211931e-03 3 1  ON 51
ci_053                -2.460126e-03 3 1  ON 52
ci_054                -2.689164e-03 3 1  ON 53
ci_055                -1.790143e-03 3 1  ON 54
ci_056                -1.964476e-03 3 1  ON 55
ci_057                -1.319442e-03 3 1  ON 56
ci_058                -9.965487e-04 3 1  ON 57
ci_059                -5.221927e-04 3 1  ON 58
ci_060                -7.412735e-04 3 1  ON 59
ci_061                 6.094472e-06 3 1  ON 60
ci_062                -9.070503e-04 3 1  ON 61
ci_063                -8.878257e-04 3 1  ON 62
ci_064                -5.045135e-04 3 1  ON 63
ci_065                -1.365589e-03 3 1  ON 64
ci_066                -1.881828e-03 3 1  ON 65
ci_067                -1.824002e-03 3 1  ON 66
ci_068                -1.481513e-03 3 1  ON 67
ci_069                -5.506910e-04 3 1  ON 68
ci_070                -4.211132e-04 3 1  ON 69
ci_071                -2.064236e-03 3 1  ON 70
ci_072                -1.991194e-03 3 1  ON 71
ci_073                 1.593790e-04 3 1  ON 72
ci_074                 1.765187e-04 3 1  ON 73
ci_075                 1.712261e-04 3 1  ON 74
ci_076                 7.919342e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4656e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.7233
    reference variance = 0.405252
====================================================
  Execution time = 2.6132e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5915e-01
  Total weights = 1.955581785e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446513261462
                                         uncertainty =       0.003091640615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446513261462
                                         uncertainty =       0.003091640615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472463016
  error estimate for blocks of size 2^( 2) =       0.000496458491
  error estimate for blocks of size 2^( 3) =       0.000518553447
  error estimate for blocks of size 2^( 4) =       0.000534775580
  error estimate for blocks of size 2^( 5) =       0.000543156793
  error estimate for blocks of size 2^( 6) =       0.000547143470
  error estimate for blocks of size 2^( 7) =       0.000548767399

      target function =      -0.737873446838
              le_mean =     -22.661449040277
             les_mean =     514.000424480815
             stat err =       0.000543460811
             autocorr =       1.323124858376
   target nu stat err =       0.000543460811
   target dn stat err =       0.004464632084
      target stat err =       0.003634558348
              std dev =       0.668163604700
             le_variance =       0.446442602646


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266144904028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e+02, overlap shift 1.2622e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737890278689       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737890521285       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737890562216       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737890566411       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737890566723       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737890567053       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737890568223       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737890568391       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737890568388       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737890568379       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2622e+02 is 2.758119e-06

solving harmonic davidson linear method for identity shift 5.0487e+02, overlap shift 5.0487e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737890278689       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737890339354       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737890349588       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737890350636       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737890350715       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737890350797       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737890351090       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737890351131       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737890351131       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737890351128       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.0487e+02 is 6.896832e-07

solving harmonic davidson linear method for identity shift 2.0195e+03, overlap shift 2.0195e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.737890278689       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.737890293856       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.737890296415       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.737890296670       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737890296697       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737890296717       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.737890296790       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737890296798       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737890296802       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737890296801       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0195e+03 is 1.724304e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0849e+01
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_001                -7.055660e-01 3 1  ON 0
ci_002                -7.029284e-01 3 1  ON 1
ci_003                -5.011380e-02 3 1  ON 2
ci_004                -5.098563e-02 3 1  ON 3
ci_005                 1.946988e-02 3 1  ON 4
ci_006                 1.975975e-02 3 1  ON 5
ci_007                 1.473273e-02 3 1  ON 6
ci_008                 1.549282e-02 3 1  ON 7
ci_009                -1.315496e-02 3 1  ON 8
ci_010                -1.205411e-02 3 1  ON 9
ci_011                -9.848061e-03 3 1  ON 10
ci_012                -9.084371e-03 3 1  ON 11
ci_013                 8.365676e-03 3 1  ON 12
ci_014                 9.295982e-03 3 1  ON 13
ci_015                 9.498543e-03 3 1  ON 14
ci_016                 9.360481e-03 3 1  ON 15
ci_017                 8.490794e-03 3 1  ON 16
ci_018                 8.265830e-03 3 1  ON 17
ci_019                -1.265425e-03 3 1  ON 18
ci_020                -1.589501e-03 3 1  ON 19
ci_021                -1.182118e-02 3 1  ON 20
ci_022                -1.183606e-02 3 1  ON 21
ci_023                 4.842602e-03 3 1  ON 22
ci_024                 4.910838e-03 3 1  ON 23
ci_025                 1.153105e-02 3 1  ON 24
ci_026                 1.153300e-02 3 1  ON 25
ci_027                 6.476916e-03 3 1  ON 26
ci_028                 6.177148e-03 3 1  ON 27
ci_029                -5.031155e-03 3 1  ON 28
ci_030                -4.114709e-03 3 1  ON 29
ci_031                 3.416034e-03 3 1  ON 30
ci_032                 4.671519e-03 3 1  ON 31
ci_033                 2.350241e-03 3 1  ON 32
ci_034                 4.107687e-03 3 1  ON 33
ci_035                 1.724189e-03 3 1  ON 34
ci_036                 2.137279e-03 3 1  ON 35
ci_037                 3.491821e-03 3 1  ON 36
ci_038                 3.699944e-03 3 1  ON 37
ci_039                 4.602496e-03 3 1  ON 38
ci_040                 4.919997e-03 3 1  ON 39
ci_041                 2.955410e-03 3 1  ON 40
ci_042                 2.734383e-03 3 1  ON 41
ci_043                 2.939494e-03 3 1  ON 42
ci_044                 3.206348e-03 3 1  ON 43
ci_045                 2.473391e-03 3 1  ON 44
ci_046                 2.734550e-03 3 1  ON 45
ci_047                -1.006290e-03 3 1  ON 46
ci_048                -8.449532e-04 3 1  ON 47
ci_049                 7.815934e-04 3 1  ON 48
ci_050                 9.946346e-04 3 1  ON 49
ci_051                -3.367933e-04 3 1  ON 50
ci_052                -1.211898e-03 3 1  ON 51
ci_053                -2.460129e-03 3 1  ON 52
ci_054                -2.689023e-03 3 1  ON 53
ci_055                -1.790045e-03 3 1  ON 54
ci_056                -1.964301e-03 3 1  ON 55
ci_057                -1.319402e-03 3 1  ON 56
ci_058                -9.964892e-04 3 1  ON 57
ci_059                -5.221858e-04 3 1  ON 58
ci_060                -7.412935e-04 3 1  ON 59
ci_061                 5.950979e-06 3 1  ON 60
ci_062                -9.070465e-04 3 1  ON 61
ci_063                -8.878657e-04 3 1  ON 62
ci_064                -5.045855e-04 3 1  ON 63
ci_065                -1.365697e-03 3 1  ON 64
ci_066                -1.881525e-03 3 1  ON 65
ci_067                -1.823999e-03 3 1  ON 66
ci_068                -1.481635e-03 3 1  ON 67
ci_069                -5.506303e-04 3 1  ON 68
ci_070                -4.210083e-04 3 1  ON 69
ci_071                -2.064171e-03 3 1  ON 70
ci_072                -1.991096e-03 3 1  ON 71
ci_073                 1.594083e-04 3 1  ON 72
ci_074                 1.765847e-04 3 1  ON 73
ci_075                 1.713223e-04 3 1  ON 74
ci_076                 7.918771e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.751
    reference variance = 0.471451
====================================================
  Execution time = 2.5740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4654e-01
  Total weights = 1.9553e+06
  Execution time = 3.6439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438225050320
                                         uncertainty =       0.001879864102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438225050320
                                         uncertainty =       0.001879864102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468036679
  error estimate for blocks of size 2^( 2) =       0.000491854064
  error estimate for blocks of size 2^( 3) =       0.000513689655
  error estimate for blocks of size 2^( 4) =       0.000528790681
  error estimate for blocks of size 2^( 5) =       0.000539232450
  error estimate for blocks of size 2^( 6) =       0.000543766896
  error estimate for blocks of size 2^( 7) =       0.000546830229

      target function =      -0.748175979058
              le_mean =     -22.662565031374
             les_mean =     514.038390998121
             stat err =       0.000539655064
             autocorr =       1.329452224377
   target nu stat err =       0.000539655064
   target dn stat err =       0.002352652837
      target stat err =       0.002035416276
              std dev =       0.661903819352
             le_variance =       0.438116666072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438224768524
                                         uncertainty =       0.001879889327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438224768524
                                         uncertainty =       0.001879889327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468036529
  error estimate for blocks of size 2^( 2) =       0.000491853963
  error estimate for blocks of size 2^( 3) =       0.000513689610
  error estimate for blocks of size 2^( 4) =       0.000528790675
  error estimate for blocks of size 2^( 5) =       0.000539232448
  error estimate for blocks of size 2^( 6) =       0.000543766864
  error estimate for blocks of size 2^( 7) =       0.000546830134

      target function =      -0.748155349365
              le_mean =     -22.662565037242
             les_mean =     514.038416203115
             stat err =       0.000539655030
             autocorr =       1.329452913643
   target nu stat err =       0.000539655030
   target dn stat err =       0.002353145232
      target stat err =       0.002035698243
              std dev =       0.661903606422
             le_variance =       0.438116384195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438224909306
                                         uncertainty =       0.001879876716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438224909306
                                         uncertainty =       0.001879876716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468036604
  error estimate for blocks of size 2^( 2) =       0.000491854013
  error estimate for blocks of size 2^( 3) =       0.000513689632
  error estimate for blocks of size 2^( 4) =       0.000528790678
  error estimate for blocks of size 2^( 5) =       0.000539232449
  error estimate for blocks of size 2^( 6) =       0.000543766880
  error estimate for blocks of size 2^( 7) =       0.000546830181

      target function =      -0.748167897812
              le_mean =     -22.662565034246
             les_mean =     514.038400897629
             stat err =       0.000539655047
             autocorr =       1.329452568649
   target nu stat err =       0.000539655047
   target dn stat err =       0.002352819691
      target stat err =       0.002035506148
              std dev =       0.661903712799
             le_variance =       0.438116525018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438225032683
                                         uncertainty =       0.001879865678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438225032683
                                         uncertainty =       0.001879865678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468036670
  error estimate for blocks of size 2^( 2) =       0.000491854058
  error estimate for blocks of size 2^( 3) =       0.000513689652
  error estimate for blocks of size 2^( 4) =       0.000528790681
  error estimate for blocks of size 2^( 5) =       0.000539232450
  error estimate for blocks of size 2^( 6) =       0.000543766894
  error estimate for blocks of size 2^( 7) =       0.000546830223

      target function =      -0.748175136033
              le_mean =     -22.662565031728
             les_mean =     514.038392033272
             stat err =       0.000539655062
             autocorr =       1.329452267379
   target nu stat err =       0.000539655062
   target dn stat err =       0.002352668863
      target stat err =       0.002035424560
              std dev =       0.661903806025
             le_variance =       0.438116648430


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748175979058        initial  <--
     1.2622e+02     1.2622e+03             2.7581e-06        -0.748155349365
     5.0487e+02     5.0487e+03             6.8968e-07        -0.748167897812
     2.0195e+03     2.0195e+04             1.7243e-07        -0.748175136033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8943
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_001                -7.055657e-01 3 1  ON 0
ci_002                -7.029286e-01 3 1  ON 1
ci_003                -5.011384e-02 3 1  ON 2
ci_004                -5.098563e-02 3 1  ON 3
ci_005                 1.947003e-02 3 1  ON 4
ci_006                 1.975992e-02 3 1  ON 5
ci_007                 1.473290e-02 3 1  ON 6
ci_008                 1.549299e-02 3 1  ON 7
ci_009                -1.315530e-02 3 1  ON 8
ci_010                -1.205416e-02 3 1  ON 9
ci_011                -9.848204e-03 3 1  ON 10
ci_012                -9.084380e-03 3 1  ON 11
ci_013                 8.365929e-03 3 1  ON 12
ci_014                 9.296088e-03 3 1  ON 13
ci_015                 9.498940e-03 3 1  ON 14
ci_016                 9.360768e-03 3 1  ON 15
ci_017                 8.491038e-03 3 1  ON 16
ci_018                 8.265942e-03 3 1  ON 17
ci_019                -1.265231e-03 3 1  ON 18
ci_020                -1.588811e-03 3 1  ON 19
ci_021                -1.182115e-02 3 1  ON 20
ci_022                -1.183589e-02 3 1  ON 21
ci_023                 4.842608e-03 3 1  ON 22
ci_024                 4.910931e-03 3 1  ON 23
ci_025                 1.153087e-02 3 1  ON 24
ci_026                 1.153273e-02 3 1  ON 25
ci_027                 6.476904e-03 3 1  ON 26
ci_028                 6.177201e-03 3 1  ON 27
ci_029                -5.031492e-03 3 1  ON 28
ci_030                -4.114720e-03 3 1  ON 29
ci_031                 3.415820e-03 3 1  ON 30
ci_032                 4.671257e-03 3 1  ON 31
ci_033                 2.350330e-03 3 1  ON 32
ci_034                 4.107674e-03 3 1  ON 33
ci_035                 1.724201e-03 3 1  ON 34
ci_036                 2.137331e-03 3 1  ON 35
ci_037                 3.492075e-03 3 1  ON 36
ci_038                 3.699977e-03 3 1  ON 37
ci_039                 4.602553e-03 3 1  ON 38
ci_040                 4.919982e-03 3 1  ON 39
ci_041                 2.955516e-03 3 1  ON 40
ci_042                 2.734375e-03 3 1  ON 41
ci_043                 2.939488e-03 3 1  ON 42
ci_044                 3.206321e-03 3 1  ON 43
ci_045                 2.473653e-03 3 1  ON 44
ci_046                 2.734654e-03 3 1  ON 45
ci_047                -1.006126e-03 3 1  ON 46
ci_048                -8.450006e-04 3 1  ON 47
ci_049                 7.816454e-04 3 1  ON 48
ci_050                 9.946740e-04 3 1  ON 49
ci_051                -3.367656e-04 3 1  ON 50
ci_052                -1.211931e-03 3 1  ON 51
ci_053                -2.460126e-03 3 1  ON 52
ci_054                -2.689164e-03 3 1  ON 53
ci_055                -1.790143e-03 3 1  ON 54
ci_056                -1.964476e-03 3 1  ON 55
ci_057                -1.319442e-03 3 1  ON 56
ci_058                -9.965487e-04 3 1  ON 57
ci_059                -5.221927e-04 3 1  ON 58
ci_060                -7.412735e-04 3 1  ON 59
ci_061                 6.094472e-06 3 1  ON 60
ci_062                -9.070503e-04 3 1  ON 61
ci_063                -8.878257e-04 3 1  ON 62
ci_064                -5.045135e-04 3 1  ON 63
ci_065                -1.365589e-03 3 1  ON 64
ci_066                -1.881828e-03 3 1  ON 65
ci_067                -1.824002e-03 3 1  ON 66
ci_068                -1.481513e-03 3 1  ON 67
ci_069                -5.506910e-04 3 1  ON 68
ci_070                -4.211132e-04 3 1  ON 69
ci_071                -2.064236e-03 3 1  ON 70
ci_072                -1.991194e-03 3 1  ON 71
ci_073                 1.593790e-04 3 1  ON 72
ci_074                 1.765187e-04 3 1  ON 73
ci_075                 1.712261e-04 3 1  ON 74
ci_076                 7.919342e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2670e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.6168
    reference variance = 0.46443
====================================================
  Execution time = 2.6303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4973e-01
  Total weights = 1.955109193e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440942962259
                                         uncertainty =       0.002001582657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440942962259
                                         uncertainty =       0.002001582657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469504075
  error estimate for blocks of size 2^( 2) =       0.000493579677
  error estimate for blocks of size 2^( 3) =       0.000514749591
  error estimate for blocks of size 2^( 4) =       0.000530236308
  error estimate for blocks of size 2^( 5) =       0.000539127201
  error estimate for blocks of size 2^( 6) =       0.000543482055
  error estimate for blocks of size 2^( 7) =       0.000544378392

      target function =      -0.745534157208
              le_mean =     -22.661508024095
             les_mean =     513.993673809106
             stat err =       0.000539305989
             autocorr =       1.319446407016
   target nu stat err =       0.000539305989
   target dn stat err =       0.002468046841
      target stat err =       0.002109051877
              std dev =       0.663979029867
             le_variance =       0.440868152103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266150802409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2622e+03, overlap shift 1.2622e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745539165684       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745539182267       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745539185522       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745539186150       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745539186216       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745539186225       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745539186233       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745539186248       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745539186247       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2622e+03 is 1.274056e-07

solving harmonic davidson linear method for identity shift 5.0487e+03, overlap shift 5.0487e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745539165684       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745539169830       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745539170644       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745539170801       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745539170817       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745539170815       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745539170822       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745539170830       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745539170825       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.0487e+03 is 3.185214e-08

solving harmonic davidson linear method for identity shift 2.0195e+04, overlap shift 2.0195e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745539165684       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745539166721       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745539166924       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745539166963       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745539166968       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745539166989       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745539166969       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745539166970       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745539166969       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0195e+04 is 7.963082e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1023e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_001                -7.055657e-01 3 1  ON 0
ci_002                -7.029286e-01 3 1  ON 1
ci_003                -5.011385e-02 3 1  ON 2
ci_004                -5.098564e-02 3 1  ON 3
ci_005                 1.947002e-02 3 1  ON 4
ci_006                 1.975990e-02 3 1  ON 5
ci_007                 1.473291e-02 3 1  ON 6
ci_008                 1.549298e-02 3 1  ON 7
ci_009                -1.315528e-02 3 1  ON 8
ci_010                -1.205414e-02 3 1  ON 9
ci_011                -9.848183e-03 3 1  ON 10
ci_012                -9.084369e-03 3 1  ON 11
ci_013                 8.365915e-03 3 1  ON 12
ci_014                 9.296060e-03 3 1  ON 13
ci_015                 9.498921e-03 3 1  ON 14
ci_016                 9.360742e-03 3 1  ON 15
ci_017                 8.491047e-03 3 1  ON 16
ci_018                 8.265941e-03 3 1  ON 17
ci_019                -1.265260e-03 3 1  ON 18
ci_020                -1.588835e-03 3 1  ON 19
ci_021                -1.182116e-02 3 1  ON 20
ci_022                -1.183589e-02 3 1  ON 21
ci_023                 4.842596e-03 3 1  ON 22
ci_024                 4.910931e-03 3 1  ON 23
ci_025                 1.153090e-02 3 1  ON 24
ci_026                 1.153274e-02 3 1  ON 25
ci_027                 6.476892e-03 3 1  ON 26
ci_028                 6.177206e-03 3 1  ON 27
ci_029                -5.031475e-03 3 1  ON 28
ci_030                -4.114713e-03 3 1  ON 29
ci_031                 3.415852e-03 3 1  ON 30
ci_032                 4.671279e-03 3 1  ON 31
ci_033                 2.350329e-03 3 1  ON 32
ci_034                 4.107665e-03 3 1  ON 33
ci_035                 1.724199e-03 3 1  ON 34
ci_036                 2.137329e-03 3 1  ON 35
ci_037                 3.492061e-03 3 1  ON 36
ci_038                 3.699986e-03 3 1  ON 37
ci_039                 4.602539e-03 3 1  ON 38
ci_040                 4.919975e-03 3 1  ON 39
ci_041                 2.955502e-03 3 1  ON 40
ci_042                 2.734379e-03 3 1  ON 41
ci_043                 2.939488e-03 3 1  ON 42
ci_044                 3.206323e-03 3 1  ON 43
ci_045                 2.473646e-03 3 1  ON 44
ci_046                 2.734646e-03 3 1  ON 45
ci_047                -1.006122e-03 3 1  ON 46
ci_048                -8.450053e-04 3 1  ON 47
ci_049                 7.816511e-04 3 1  ON 48
ci_050                 9.946558e-04 3 1  ON 49
ci_051                -3.367790e-04 3 1  ON 50
ci_052                -1.211931e-03 3 1  ON 51
ci_053                -2.460132e-03 3 1  ON 52
ci_054                -2.689165e-03 3 1  ON 53
ci_055                -1.790141e-03 3 1  ON 54
ci_056                -1.964454e-03 3 1  ON 55
ci_057                -1.319441e-03 3 1  ON 56
ci_058                -9.965438e-04 3 1  ON 57
ci_059                -5.221834e-04 3 1  ON 58
ci_060                -7.412781e-04 3 1  ON 59
ci_061                 6.085036e-06 3 1  ON 60
ci_062                -9.070399e-04 3 1  ON 61
ci_063                -8.878212e-04 3 1  ON 62
ci_064                -5.045189e-04 3 1  ON 63
ci_065                -1.365595e-03 3 1  ON 64
ci_066                -1.881829e-03 3 1  ON 65
ci_067                -1.823999e-03 3 1  ON 66
ci_068                -1.481500e-03 3 1  ON 67
ci_069                -5.506781e-04 3 1  ON 68
ci_070                -4.210909e-04 3 1  ON 69
ci_071                -2.064234e-03 3 1  ON 70
ci_072                -1.991190e-03 3 1  ON 71
ci_073                 1.593869e-04 3 1  ON 72
ci_074                 1.765118e-04 3 1  ON 73
ci_075                 1.712357e-04 3 1  ON 74
ci_076                 7.919303e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.6346
    reference variance = 0.33617
====================================================
  Execution time = 2.5773e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4858e-01
  Total weights = 1.9552e+06
  Execution time = 3.6526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439694050507
                                         uncertainty =       0.001719076484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439694050507
                                         uncertainty =       0.001719076484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468860908
  error estimate for blocks of size 2^( 2) =       0.000492547590
  error estimate for blocks of size 2^( 3) =       0.000514195250
  error estimate for blocks of size 2^( 4) =       0.000529747531
  error estimate for blocks of size 2^( 5) =       0.000537966687
  error estimate for blocks of size 2^( 6) =       0.000543690474
  error estimate for blocks of size 2^( 7) =       0.000547118218

      target function =      -0.746495345354
              le_mean =     -22.662772358125
             les_mean =     514.049826429556
             stat err =       0.000539630728
             autocorr =       1.324662659897
   target nu stat err =       0.000539630728
   target dn stat err =       0.002524595131
      target stat err =       0.002163071658
              std dev =       0.663069454506
             le_variance =       0.439661101499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439694027196
                                         uncertainty =       0.001719078063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439694027196
                                         uncertainty =       0.001719078063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468860895
  error estimate for blocks of size 2^( 2) =       0.000492547583
  error estimate for blocks of size 2^( 3) =       0.000514195247
  error estimate for blocks of size 2^( 4) =       0.000529747530
  error estimate for blocks of size 2^( 5) =       0.000537966687
  error estimate for blocks of size 2^( 6) =       0.000543690476
  error estimate for blocks of size 2^( 7) =       0.000547118218

      target function =      -0.746495563885
              le_mean =     -22.662772358454
             les_mean =     514.049826179176
             stat err =       0.000539630728
             autocorr =       1.324662731276
   target nu stat err =       0.000539630728
   target dn stat err =       0.002524595193
      target stat err =       0.002163072927
              std dev =       0.663069436945
             le_variance =       0.439661078210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439694038851
                                         uncertainty =       0.001719077273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439694038851
                                         uncertainty =       0.001719077273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468860901
  error estimate for blocks of size 2^( 2) =       0.000492547586
  error estimate for blocks of size 2^( 3) =       0.000514195248
  error estimate for blocks of size 2^( 4) =       0.000529747531
  error estimate for blocks of size 2^( 5) =       0.000537966687
  error estimate for blocks of size 2^( 6) =       0.000543690475
  error estimate for blocks of size 2^( 7) =       0.000547118218

      target function =      -0.746495460027
              le_mean =     -22.662772358289
             les_mean =     514.049826297802
             stat err =       0.000539630728
             autocorr =       1.324662695598
   target nu stat err =       0.000539630728
   target dn stat err =       0.002524595160
      target stat err =       0.002163072321
              std dev =       0.663069445725
             le_variance =       0.439661089854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439694049050
                                         uncertainty =       0.001719076583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439694049050
                                         uncertainty =       0.001719076583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468860907
  error estimate for blocks of size 2^( 2) =       0.000492547589
  error estimate for blocks of size 2^( 3) =       0.000514195250
  error estimate for blocks of size 2^( 4) =       0.000529747531
  error estimate for blocks of size 2^( 5) =       0.000537966687
  error estimate for blocks of size 2^( 6) =       0.000543690474
  error estimate for blocks of size 2^( 7) =       0.000547118218

      target function =      -0.746495360360
              le_mean =     -22.662772358145
             les_mean =     514.049826412272
             stat err =       0.000539630728
             autocorr =       1.324662664358
   target nu stat err =       0.000539630728
   target dn stat err =       0.002524595135
      target stat err =       0.002163071744
              std dev =       0.663069453409
             le_variance =       0.439661100044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746495345354        initial
     1.2622e+03     1.2622e+04             1.2741e-07        -0.746495563885  <--
     5.0487e+03     5.0487e+04             3.1852e-08        -0.746495460027
     2.0195e+04     2.0195e+05             7.9631e-09        -0.746495360360

*****************************************************************************
Applying the update for shift_i =   1.2622e+03     and shift_s =   1.2622e+04
*****************************************************************************

  Execution time = 4.3910e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_001                -7.055657e-01 3 1  ON 0
ci_002                -7.029287e-01 3 1  ON 1
ci_003                -5.011388e-02 3 1  ON 2
ci_004                -5.098567e-02 3 1  ON 3
ci_005                 1.946998e-02 3 1  ON 4
ci_006                 1.975985e-02 3 1  ON 5
ci_007                 1.473293e-02 3 1  ON 6
ci_008                 1.549294e-02 3 1  ON 7
ci_009                -1.315521e-02 3 1  ON 8
ci_010                -1.205406e-02 3 1  ON 9
ci_011                -9.848121e-03 3 1  ON 10
ci_012                -9.084336e-03 3 1  ON 11
ci_013                 8.365875e-03 3 1  ON 12
ci_014                 9.295977e-03 3 1  ON 13
ci_015                 9.498865e-03 3 1  ON 14
ci_016                 9.360665e-03 3 1  ON 15
ci_017                 8.491074e-03 3 1  ON 16
ci_018                 8.265939e-03 3 1  ON 17
ci_019                -1.265346e-03 3 1  ON 18
ci_020                -1.588906e-03 3 1  ON 19
ci_021                -1.182119e-02 3 1  ON 20
ci_022                -1.183588e-02 3 1  ON 21
ci_023                 4.842557e-03 3 1  ON 22
ci_024                 4.910933e-03 3 1  ON 23
ci_025                 1.153099e-02 3 1  ON 24
ci_026                 1.153278e-02 3 1  ON 25
ci_027                 6.476853e-03 3 1  ON 26
ci_028                 6.177219e-03 3 1  ON 27
ci_029                -5.031423e-03 3 1  ON 28
ci_030                -4.114691e-03 3 1  ON 29
ci_031                 3.415947e-03 3 1  ON 30
ci_032                 4.671346e-03 3 1  ON 31
ci_033                 2.350325e-03 3 1  ON 32
ci_034                 4.107638e-03 3 1  ON 33
ci_035                 1.724190e-03 3 1  ON 34
ci_036                 2.137322e-03 3 1  ON 35
ci_037                 3.492018e-03 3 1  ON 36
ci_038                 3.700012e-03 3 1  ON 37
ci_039                 4.602498e-03 3 1  ON 38
ci_040                 4.919956e-03 3 1  ON 39
ci_041                 2.955457e-03 3 1  ON 40
ci_042                 2.734389e-03 3 1  ON 41
ci_043                 2.939489e-03 3 1  ON 42
ci_044                 3.206327e-03 3 1  ON 43
ci_045                 2.473626e-03 3 1  ON 44
ci_046                 2.734623e-03 3 1  ON 45
ci_047                -1.006112e-03 3 1  ON 46
ci_048                -8.450192e-04 3 1  ON 47
ci_049                 7.816681e-04 3 1  ON 48
ci_050                 9.946014e-04 3 1  ON 49
ci_051                -3.368192e-04 3 1  ON 50
ci_052                -1.211933e-03 3 1  ON 51
ci_053                -2.460148e-03 3 1  ON 52
ci_054                -2.689171e-03 3 1  ON 53
ci_055                -1.790136e-03 3 1  ON 54
ci_056                -1.964388e-03 3 1  ON 55
ci_057                -1.319440e-03 3 1  ON 56
ci_058                -9.965292e-04 3 1  ON 57
ci_059                -5.221552e-04 3 1  ON 58
ci_060                -7.412920e-04 3 1  ON 59
ci_061                 6.056727e-06 3 1  ON 60
ci_062                -9.070086e-04 3 1  ON 61
ci_063                -8.878077e-04 3 1  ON 62
ci_064                -5.045351e-04 3 1  ON 63
ci_065                -1.365611e-03 3 1  ON 64
ci_066                -1.881830e-03 3 1  ON 65
ci_067                -1.823990e-03 3 1  ON 66
ci_068                -1.481460e-03 3 1  ON 67
ci_069                -5.506396e-04 3 1  ON 68
ci_070                -4.210238e-04 3 1  ON 69
ci_071                -2.064228e-03 3 1  ON 70
ci_072                -1.991179e-03 3 1  ON 71
ci_073                 1.594109e-04 3 1  ON 72
ci_074                 1.764911e-04 3 1  ON 73
ci_075                 1.712644e-04 3 1  ON 74
ci_076                 7.919186e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4966e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6468
    reference variance = 0.694604
====================================================
  Execution time = 2.8448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4652e-01
  Total weights = 1.955368896e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7661e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437596069269
                                         uncertainty =       0.001711468375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437596069269
                                         uncertainty =       0.001711468375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467719301
  error estimate for blocks of size 2^( 2) =       0.000491395235
  error estimate for blocks of size 2^( 3) =       0.000514217441
  error estimate for blocks of size 2^( 4) =       0.000529797505
  error estimate for blocks of size 2^( 5) =       0.000539243175
  error estimate for blocks of size 2^( 6) =       0.000545002865
  error estimate for blocks of size 2^( 7) =       0.000548932978

      target function =      -0.748180890463
              le_mean =     -22.661887668605
             les_mean =     514.007672162245
             stat err =       0.000540744131
             autocorr =       1.336635660657
   target nu stat err =       0.000540744131
   target dn stat err =       0.002335985635
      target stat err =       0.002020597737
              std dev =       0.661454979339
             le_variance =       0.437522689692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266188766861e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.1554e+02, overlap shift 3.1554e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748185402331       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748185491010       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748185499362       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748185499392       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748185499406       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748185499334       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748185499509       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748185499461       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748185499504       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748185499471       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748185499465       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.1554e+02 is 6.857871e-07

solving harmonic davidson linear method for identity shift 1.2622e+03, overlap shift 1.2622e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748185402331       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748185424504       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748185426592       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748185426599       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748185426603       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748185426585       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748185426629       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748185426617       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748185426627       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748185426619       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748185426618       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2622e+03 is 1.714686e-07

solving harmonic davidson linear method for identity shift 5.0487e+03, overlap shift 5.0487e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748185402331       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748185407875       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748185408397       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748185408399       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748185408399       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748185408395       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748185408406       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748185408396       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748185408406       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748185408404       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748185408403       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.0487e+03 is 4.286853e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395528 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3249e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029287e-01 3 1  ON 1
ci_003                -5.011384e-02 3 1  ON 2
ci_004                -5.098566e-02 3 1  ON 3
ci_005                 1.946989e-02 3 1  ON 4
ci_006                 1.975979e-02 3 1  ON 5
ci_007                 1.473295e-02 3 1  ON 6
ci_008                 1.549287e-02 3 1  ON 7
ci_009                -1.315514e-02 3 1  ON 8
ci_010                -1.205400e-02 3 1  ON 9
ci_011                -9.848128e-03 3 1  ON 10
ci_012                -9.084328e-03 3 1  ON 11
ci_013                 8.365795e-03 3 1  ON 12
ci_014                 9.295883e-03 3 1  ON 13
ci_015                 9.498830e-03 3 1  ON 14
ci_016                 9.360571e-03 3 1  ON 15
ci_017                 8.491084e-03 3 1  ON 16
ci_018                 8.265934e-03 3 1  ON 17
ci_019                -1.265472e-03 3 1  ON 18
ci_020                -1.589029e-03 3 1  ON 19
ci_021                -1.182129e-02 3 1  ON 20
ci_022                -1.183595e-02 3 1  ON 21
ci_023                 4.842572e-03 3 1  ON 22
ci_024                 4.910865e-03 3 1  ON 23
ci_025                 1.153105e-02 3 1  ON 24
ci_026                 1.153282e-02 3 1  ON 25
ci_027                 6.476825e-03 3 1  ON 26
ci_028                 6.177227e-03 3 1  ON 27
ci_029                -5.031344e-03 3 1  ON 28
ci_030                -4.114688e-03 3 1  ON 29
ci_031                 3.416014e-03 3 1  ON 30
ci_032                 4.671445e-03 3 1  ON 31
ci_033                 2.350332e-03 3 1  ON 32
ci_034                 4.107562e-03 3 1  ON 33
ci_035                 1.724196e-03 3 1  ON 34
ci_036                 2.137326e-03 3 1  ON 35
ci_037                 3.491953e-03 3 1  ON 36
ci_038                 3.699939e-03 3 1  ON 37
ci_039                 4.602460e-03 3 1  ON 38
ci_040                 4.919870e-03 3 1  ON 39
ci_041                 2.955464e-03 3 1  ON 40
ci_042                 2.734318e-03 3 1  ON 41
ci_043                 2.939571e-03 3 1  ON 42
ci_044                 3.206370e-03 3 1  ON 43
ci_045                 2.473705e-03 3 1  ON 44
ci_046                 2.734654e-03 3 1  ON 45
ci_047                -1.006112e-03 3 1  ON 46
ci_048                -8.450655e-04 3 1  ON 47
ci_049                 7.816515e-04 3 1  ON 48
ci_050                 9.945906e-04 3 1  ON 49
ci_051                -3.369110e-04 3 1  ON 50
ci_052                -1.211920e-03 3 1  ON 51
ci_053                -2.460143e-03 3 1  ON 52
ci_054                -2.689172e-03 3 1  ON 53
ci_055                -1.790087e-03 3 1  ON 54
ci_056                -1.964328e-03 3 1  ON 55
ci_057                -1.319475e-03 3 1  ON 56
ci_058                -9.963578e-04 3 1  ON 57
ci_059                -5.221516e-04 3 1  ON 58
ci_060                -7.412491e-04 3 1  ON 59
ci_061                 6.092584e-06 3 1  ON 60
ci_062                -9.069620e-04 3 1  ON 61
ci_063                -8.878427e-04 3 1  ON 62
ci_064                -5.045264e-04 3 1  ON 63
ci_065                -1.365613e-03 3 1  ON 64
ci_066                -1.881758e-03 3 1  ON 65
ci_067                -1.823973e-03 3 1  ON 66
ci_068                -1.481442e-03 3 1  ON 67
ci_069                -5.506163e-04 3 1  ON 68
ci_070                -4.210297e-04 3 1  ON 69
ci_071                -2.064190e-03 3 1  ON 70
ci_072                -1.991177e-03 3 1  ON 71
ci_073                 1.594190e-04 3 1  ON 72
ci_074                 1.764428e-04 3 1  ON 73
ci_075                 1.712541e-04 3 1  ON 74
ci_076                 7.919166e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6126
    reference variance = 0.301043
====================================================
  Execution time = 2.7711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5350e-01
  Total weights = 1.9552e+06
  Execution time = 3.6515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710133569
                                         uncertainty =       0.002077735287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710133569
                                         uncertainty =       0.002077735287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922071
  error estimate for blocks of size 2^( 2) =       0.000494158760
  error estimate for blocks of size 2^( 3) =       0.000515883630
  error estimate for blocks of size 2^( 4) =       0.000531755782
  error estimate for blocks of size 2^( 5) =       0.000540363155
  error estimate for blocks of size 2^( 6) =       0.000543342296
  error estimate for blocks of size 2^( 7) =       0.000546754917

      target function =      -0.742451352267
              le_mean =     -22.662236851437
             les_mean =     514.030483041889
             stat err =       0.000540554037
             autocorr =       1.323203208831
   target nu stat err =       0.000540554037
   target dn stat err =       0.003221588688
      target stat err =       0.002689024189
              std dev =       0.664570165483
             le_variance =       0.441653504849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710111640
                                         uncertainty =       0.002077756046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710111640
                                         uncertainty =       0.002077756046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922059
  error estimate for blocks of size 2^( 2) =       0.000494158755
  error estimate for blocks of size 2^( 3) =       0.000515883636
  error estimate for blocks of size 2^( 4) =       0.000531755791
  error estimate for blocks of size 2^( 5) =       0.000540363159
  error estimate for blocks of size 2^( 6) =       0.000543342286
  error estimate for blocks of size 2^( 7) =       0.000546754875

      target function =      -0.742452019910
              le_mean =     -22.662236851458
             les_mean =     514.030482226325
             stat err =       0.000540554028
             autocorr =       1.323203225961
   target nu stat err =       0.000540554028
   target dn stat err =       0.003221085093
      target stat err =       0.002688628977
              std dev =       0.664570149099
             le_variance =       0.441653483073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710122593
                                         uncertainty =       0.002077745667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710122593
                                         uncertainty =       0.002077745667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922065
  error estimate for blocks of size 2^( 2) =       0.000494158758
  error estimate for blocks of size 2^( 3) =       0.000515883633
  error estimate for blocks of size 2^( 4) =       0.000531755787
  error estimate for blocks of size 2^( 5) =       0.000540363157
  error estimate for blocks of size 2^( 6) =       0.000543342291
  error estimate for blocks of size 2^( 7) =       0.000546754896

      target function =      -0.742451686950
              le_mean =     -22.662236851446
             les_mean =     514.030482632973
             stat err =       0.000540554033
             autocorr =       1.323203217406
   target nu stat err =       0.000540554033
   target dn stat err =       0.003221336767
      target stat err =       0.002688826490
              std dev =       0.664570157282
             le_variance =       0.441653493949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710132196
                                         uncertainty =       0.002077736585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441710132196
                                         uncertainty =       0.002077736585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469922070
  error estimate for blocks of size 2^( 2) =       0.000494158760
  error estimate for blocks of size 2^( 3) =       0.000515883630
  error estimate for blocks of size 2^( 4) =       0.000531755782
  error estimate for blocks of size 2^( 5) =       0.000540363155
  error estimate for blocks of size 2^( 6) =       0.000543342296
  error estimate for blocks of size 2^( 7) =       0.000546754914

      target function =      -0.742451394194
              le_mean =     -22.662236851438
             les_mean =     514.030482990655
             stat err =       0.000540554037
             autocorr =       1.323203209910
   target nu stat err =       0.000540554037
   target dn stat err =       0.003221557186
      target stat err =       0.002688999468
              std dev =       0.664570164457
             le_variance =       0.441653503486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742451352267        initial
     3.1554e+02     3.1554e+03             6.8579e-07        -0.742452019910  <--
     1.2622e+03     1.2622e+04             1.7147e-07        -0.742451686950
     5.0487e+03     5.0487e+04             4.2869e-08        -0.742451394194

*****************************************************************************
Applying the update for shift_i =   3.1554e+02     and shift_s =   3.1554e+03
*****************************************************************************

  Execution time = 4.5887e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011372e-02 3 1  ON 2
ci_004                -5.098561e-02 3 1  ON 3
ci_005                 1.946964e-02 3 1  ON 4
ci_006                 1.975963e-02 3 1  ON 5
ci_007                 1.473302e-02 3 1  ON 6
ci_008                 1.549264e-02 3 1  ON 7
ci_009                -1.315493e-02 3 1  ON 8
ci_010                -1.205383e-02 3 1  ON 9
ci_011                -9.848149e-03 3 1  ON 10
ci_012                -9.084305e-03 3 1  ON 11
ci_013                 8.365554e-03 3 1  ON 12
ci_014                 9.295599e-03 3 1  ON 13
ci_015                 9.498727e-03 3 1  ON 14
ci_016                 9.360286e-03 3 1  ON 15
ci_017                 8.491114e-03 3 1  ON 16
ci_018                 8.265919e-03 3 1  ON 17
ci_019                -1.265851e-03 3 1  ON 18
ci_020                -1.589399e-03 3 1  ON 19
ci_021                -1.182160e-02 3 1  ON 20
ci_022                -1.183616e-02 3 1  ON 21
ci_023                 4.842616e-03 3 1  ON 22
ci_024                 4.910660e-03 3 1  ON 23
ci_025                 1.153124e-02 3 1  ON 24
ci_026                 1.153292e-02 3 1  ON 25
ci_027                 6.476741e-03 3 1  ON 26
ci_028                 6.177248e-03 3 1  ON 27
ci_029                -5.031109e-03 3 1  ON 28
ci_030                -4.114678e-03 3 1  ON 29
ci_031                 3.416214e-03 3 1  ON 30
ci_032                 4.671743e-03 3 1  ON 31
ci_033                 2.350352e-03 3 1  ON 32
ci_034                 4.107334e-03 3 1  ON 33
ci_035                 1.724213e-03 3 1  ON 34
ci_036                 2.137339e-03 3 1  ON 35
ci_037                 3.491757e-03 3 1  ON 36
ci_038                 3.699720e-03 3 1  ON 37
ci_039                 4.602345e-03 3 1  ON 38
ci_040                 4.919613e-03 3 1  ON 39
ci_041                 2.955486e-03 3 1  ON 40
ci_042                 2.734105e-03 3 1  ON 41
ci_043                 2.939815e-03 3 1  ON 42
ci_044                 3.206500e-03 3 1  ON 43
ci_045                 2.473944e-03 3 1  ON 44
ci_046                 2.734747e-03 3 1  ON 45
ci_047                -1.006114e-03 3 1  ON 46
ci_048                -8.452043e-04 3 1  ON 47
ci_049                 7.816016e-04 3 1  ON 48
ci_050                 9.945585e-04 3 1  ON 49
ci_051                -3.371864e-04 3 1  ON 50
ci_052                -1.211882e-03 3 1  ON 51
ci_053                -2.460127e-03 3 1  ON 52
ci_054                -2.689176e-03 3 1  ON 53
ci_055                -1.789943e-03 3 1  ON 54
ci_056                -1.964149e-03 3 1  ON 55
ci_057                -1.319581e-03 3 1  ON 56
ci_058                -9.958435e-04 3 1  ON 57
ci_059                -5.221406e-04 3 1  ON 58
ci_060                -7.411207e-04 3 1  ON 59
ci_061                 6.200139e-06 3 1  ON 60
ci_062                -9.068222e-04 3 1  ON 61
ci_063                -8.879476e-04 3 1  ON 62
ci_064                -5.045004e-04 3 1  ON 63
ci_065                -1.365619e-03 3 1  ON 64
ci_066                -1.881542e-03 3 1  ON 65
ci_067                -1.823923e-03 3 1  ON 66
ci_068                -1.481388e-03 3 1  ON 67
ci_069                -5.505466e-04 3 1  ON 68
ci_070                -4.210476e-04 3 1  ON 69
ci_071                -2.064076e-03 3 1  ON 70
ci_072                -1.991172e-03 3 1  ON 71
ci_073                 1.594433e-04 3 1  ON 72
ci_074                 1.762978e-04 3 1  ON 73
ci_075                 1.712231e-04 3 1  ON 74
ci_076                 7.919104e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9142e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2669e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.6211
    reference variance = 0.331544
====================================================
  Execution time = 2.6451e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4852e-01
  Total weights = 1.955135032e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439146120529
                                         uncertainty =       0.002258899324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439146120529
                                         uncertainty =       0.002258899324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468534022
  error estimate for blocks of size 2^( 2) =       0.000492568554
  error estimate for blocks of size 2^( 3) =       0.000514289596
  error estimate for blocks of size 2^( 4) =       0.000529976332
  error estimate for blocks of size 2^( 5) =       0.000540371818
  error estimate for blocks of size 2^( 6) =       0.000545596847
  error estimate for blocks of size 2^( 7) =       0.000547542328

      target function =      -0.746530633722
              le_mean =     -22.661679333455
             les_mean =     514.000226230037
             stat err =       0.000540871831
             autocorr =       1.332620417871
   target nu stat err =       0.000540871831
   target dn stat err =       0.002637462437
      target stat err =       0.002249528803
              std dev =       0.662607168812
             le_variance =       0.439048260160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266167933346e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 7.8886e+01, overlap shift 7.8886e+02 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746536523286       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746536765349       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746536820866       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746536829951       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746536838789       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746536845845       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746536846500       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746536846814       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746536846920       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746536846933       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746536846818       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 7.8886e+01 is 4.129373e-06

solving harmonic davidson linear method for identity shift 3.1554e+02, overlap shift 3.1554e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746536523286       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746536583830       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746536597712       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746536599983       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746536602193       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746536603957       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746536604119       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746536604198       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746536604224       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746536604228       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746536604199       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.1554e+02 is 1.032348e-06

solving harmonic davidson linear method for identity shift 1.2622e+03, overlap shift 1.2622e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746536523286       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746536538424       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746536541894       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746536542462       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746536543013       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746536543455       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746536543496       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746536543514       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746536543521       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746536543523       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746536543517       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2622e+03 is 2.580873e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1228e+01
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_001                -7.055666e-01 3 1  ON 0
ci_002                -7.029278e-01 3 1  ON 1
ci_003                -5.011346e-02 3 1  ON 2
ci_004                -5.098560e-02 3 1  ON 3
ci_005                 1.946955e-02 3 1  ON 4
ci_006                 1.975928e-02 3 1  ON 5
ci_007                 1.473292e-02 3 1  ON 6
ci_008                 1.549251e-02 3 1  ON 7
ci_009                -1.315463e-02 3 1  ON 8
ci_010                -1.205380e-02 3 1  ON 9
ci_011                -9.848059e-03 3 1  ON 10
ci_012                -9.084124e-03 3 1  ON 11
ci_013                 8.365429e-03 3 1  ON 12
ci_014                 9.295073e-03 3 1  ON 13
ci_015                 9.498273e-03 3 1  ON 14
ci_016                 9.360204e-03 3 1  ON 15
ci_017                 8.491202e-03 3 1  ON 16
ci_018                 8.265962e-03 3 1  ON 17
ci_019                -1.266414e-03 3 1  ON 18
ci_020                -1.589779e-03 3 1  ON 19
ci_021                -1.182180e-02 3 1  ON 20
ci_022                -1.183662e-02 3 1  ON 21
ci_023                 4.842569e-03 3 1  ON 22
ci_024                 4.910859e-03 3 1  ON 23
ci_025                 1.153167e-02 3 1  ON 24
ci_026                 1.153341e-02 3 1  ON 25
ci_027                 6.476677e-03 3 1  ON 26
ci_028                 6.177045e-03 3 1  ON 27
ci_029                -5.030870e-03 3 1  ON 28
ci_030                -4.114701e-03 3 1  ON 29
ci_031                 3.416676e-03 3 1  ON 30
ci_032                 4.672025e-03 3 1  ON 31
ci_033                 2.350540e-03 3 1  ON 32
ci_034                 4.107244e-03 3 1  ON 33
ci_035                 1.724111e-03 3 1  ON 34
ci_036                 2.137314e-03 3 1  ON 35
ci_037                 3.491616e-03 3 1  ON 36
ci_038                 3.699551e-03 3 1  ON 37
ci_039                 4.602288e-03 3 1  ON 38
ci_040                 4.919455e-03 3 1  ON 39
ci_041                 2.955442e-03 3 1  ON 40
ci_042                 2.734139e-03 3 1  ON 41
ci_043                 2.939751e-03 3 1  ON 42
ci_044                 3.206517e-03 3 1  ON 43
ci_045                 2.474272e-03 3 1  ON 44
ci_046                 2.734671e-03 3 1  ON 45
ci_047                -1.006129e-03 3 1  ON 46
ci_048                -8.452735e-04 3 1  ON 47
ci_049                 7.816004e-04 3 1  ON 48
ci_050                 9.943917e-04 3 1  ON 49
ci_051                -3.371961e-04 3 1  ON 50
ci_052                -1.211861e-03 3 1  ON 51
ci_053                -2.460226e-03 3 1  ON 52
ci_054                -2.689204e-03 3 1  ON 53
ci_055                -1.789918e-03 3 1  ON 54
ci_056                -1.964025e-03 3 1  ON 55
ci_057                -1.319682e-03 3 1  ON 56
ci_058                -9.961206e-04 3 1  ON 57
ci_059                -5.220108e-04 3 1  ON 58
ci_060                -7.408732e-04 3 1  ON 59
ci_061                 6.212131e-06 3 1  ON 60
ci_062                -9.063842e-04 3 1  ON 61
ci_063                -8.879826e-04 3 1  ON 62
ci_064                -5.043051e-04 3 1  ON 63
ci_065                -1.365672e-03 3 1  ON 64
ci_066                -1.881722e-03 3 1  ON 65
ci_067                -1.824050e-03 3 1  ON 66
ci_068                -1.481345e-03 3 1  ON 67
ci_069                -5.505537e-04 3 1  ON 68
ci_070                -4.209995e-04 3 1  ON 69
ci_071                -2.064003e-03 3 1  ON 70
ci_072                -1.991046e-03 3 1  ON 71
ci_073                 1.593816e-04 3 1  ON 72
ci_074                 1.762532e-04 3 1  ON 73
ci_075                 1.711559e-04 3 1  ON 74
ci_076                 7.919548e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.6109
    reference variance = 0.358771
====================================================
  Execution time = 2.6099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5649e-01
  Total weights = 1.9553e+06
  Execution time = 3.6291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444481590957
                                         uncertainty =       0.002767426377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444481590957
                                         uncertainty =       0.002767426377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471405702
  error estimate for blocks of size 2^( 2) =       0.000495547732
  error estimate for blocks of size 2^( 3) =       0.000518149125
  error estimate for blocks of size 2^( 4) =       0.000534721020
  error estimate for blocks of size 2^( 5) =       0.000543821566
  error estimate for blocks of size 2^( 6) =       0.000548007040
  error estimate for blocks of size 2^( 7) =       0.000549674779

      target function =      -0.740019321459
              le_mean =     -22.661606126877
             les_mean =     514.004881199335
             stat err =       0.000544056101
             autocorr =       1.331980009988
   target nu stat err =       0.000544056101
   target dn stat err =       0.004379738741
      target stat err =       0.003588728146
              std dev =       0.666668337573
             le_variance =       0.444446672322

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444480826704
                                         uncertainty =       0.002767404287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444480826704
                                         uncertainty =       0.002767404287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471405297
  error estimate for blocks of size 2^( 2) =       0.000495547373
  error estimate for blocks of size 2^( 3) =       0.000518148815
  error estimate for blocks of size 2^( 4) =       0.000534720725
  error estimate for blocks of size 2^( 5) =       0.000543821275
  error estimate for blocks of size 2^( 6) =       0.000548006761
  error estimate for blocks of size 2^( 7) =       0.000549674590

      target function =      -0.740018865563
              le_mean =     -22.661606120772
             les_mean =     514.004881492124
             stat err =       0.000544055838
             autocorr =       1.331981009764
   target nu stat err =       0.000544055838
   target dn stat err =       0.004379189723
      target stat err =       0.003588286152
              std dev =       0.666667764384
             le_variance =       0.444445908068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444481208484
                                         uncertainty =       0.002767415299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444481208484
                                         uncertainty =       0.002767415299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471405499
  error estimate for blocks of size 2^( 2) =       0.000495547552
  error estimate for blocks of size 2^( 3) =       0.000518148970
  error estimate for blocks of size 2^( 4) =       0.000534720872
  error estimate for blocks of size 2^( 5) =       0.000543821420
  error estimate for blocks of size 2^( 6) =       0.000548006901
  error estimate for blocks of size 2^( 7) =       0.000549674685

      target function =      -0.740019130212
              le_mean =     -22.661606123801
             les_mean =     514.004881299256
             stat err =       0.000544055970
             autocorr =       1.331980510178
   target nu stat err =       0.000544055970
   target dn stat err =       0.004379463468
      target stat err =       0.003588506890
              std dev =       0.666668050718
             le_variance =       0.444446289848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444481543123
                                         uncertainty =       0.002767424990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444481543123
                                         uncertainty =       0.002767424990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471405677
  error estimate for blocks of size 2^( 2) =       0.000495547710
  error estimate for blocks of size 2^( 3) =       0.000518149105
  error estimate for blocks of size 2^( 4) =       0.000534721002
  error estimate for blocks of size 2^( 5) =       0.000543821548
  error estimate for blocks of size 2^( 6) =       0.000548007023
  error estimate for blocks of size 2^( 7) =       0.000549674768

      target function =      -0.740019301289
              le_mean =     -22.661606126490
             les_mean =     514.004881207091
             stat err =       0.000544056085
             autocorr =       1.331980072529
   target nu stat err =       0.000544056085
   target dn stat err =       0.004379704261
      target stat err =       0.003588700468
              std dev =       0.666668301697
             le_variance =       0.444446624488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740019321459        initial  <--
     7.8886e+01     7.8886e+02             4.1294e-06        -0.740018865563
     3.1554e+02     3.1554e+03             1.0323e-06        -0.740019130212
     1.2622e+03     1.2622e+04             2.5809e-07        -0.740019301289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2653
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011372e-02 3 1  ON 2
ci_004                -5.098561e-02 3 1  ON 3
ci_005                 1.946964e-02 3 1  ON 4
ci_006                 1.975963e-02 3 1  ON 5
ci_007                 1.473302e-02 3 1  ON 6
ci_008                 1.549264e-02 3 1  ON 7
ci_009                -1.315493e-02 3 1  ON 8
ci_010                -1.205383e-02 3 1  ON 9
ci_011                -9.848149e-03 3 1  ON 10
ci_012                -9.084305e-03 3 1  ON 11
ci_013                 8.365554e-03 3 1  ON 12
ci_014                 9.295599e-03 3 1  ON 13
ci_015                 9.498727e-03 3 1  ON 14
ci_016                 9.360286e-03 3 1  ON 15
ci_017                 8.491114e-03 3 1  ON 16
ci_018                 8.265919e-03 3 1  ON 17
ci_019                -1.265851e-03 3 1  ON 18
ci_020                -1.589399e-03 3 1  ON 19
ci_021                -1.182160e-02 3 1  ON 20
ci_022                -1.183616e-02 3 1  ON 21
ci_023                 4.842616e-03 3 1  ON 22
ci_024                 4.910660e-03 3 1  ON 23
ci_025                 1.153124e-02 3 1  ON 24
ci_026                 1.153292e-02 3 1  ON 25
ci_027                 6.476741e-03 3 1  ON 26
ci_028                 6.177248e-03 3 1  ON 27
ci_029                -5.031109e-03 3 1  ON 28
ci_030                -4.114678e-03 3 1  ON 29
ci_031                 3.416214e-03 3 1  ON 30
ci_032                 4.671743e-03 3 1  ON 31
ci_033                 2.350352e-03 3 1  ON 32
ci_034                 4.107334e-03 3 1  ON 33
ci_035                 1.724213e-03 3 1  ON 34
ci_036                 2.137339e-03 3 1  ON 35
ci_037                 3.491757e-03 3 1  ON 36
ci_038                 3.699720e-03 3 1  ON 37
ci_039                 4.602345e-03 3 1  ON 38
ci_040                 4.919613e-03 3 1  ON 39
ci_041                 2.955486e-03 3 1  ON 40
ci_042                 2.734105e-03 3 1  ON 41
ci_043                 2.939815e-03 3 1  ON 42
ci_044                 3.206500e-03 3 1  ON 43
ci_045                 2.473944e-03 3 1  ON 44
ci_046                 2.734747e-03 3 1  ON 45
ci_047                -1.006114e-03 3 1  ON 46
ci_048                -8.452043e-04 3 1  ON 47
ci_049                 7.816016e-04 3 1  ON 48
ci_050                 9.945585e-04 3 1  ON 49
ci_051                -3.371864e-04 3 1  ON 50
ci_052                -1.211882e-03 3 1  ON 51
ci_053                -2.460127e-03 3 1  ON 52
ci_054                -2.689176e-03 3 1  ON 53
ci_055                -1.789943e-03 3 1  ON 54
ci_056                -1.964149e-03 3 1  ON 55
ci_057                -1.319581e-03 3 1  ON 56
ci_058                -9.958435e-04 3 1  ON 57
ci_059                -5.221406e-04 3 1  ON 58
ci_060                -7.411207e-04 3 1  ON 59
ci_061                 6.200139e-06 3 1  ON 60
ci_062                -9.068222e-04 3 1  ON 61
ci_063                -8.879476e-04 3 1  ON 62
ci_064                -5.045004e-04 3 1  ON 63
ci_065                -1.365619e-03 3 1  ON 64
ci_066                -1.881542e-03 3 1  ON 65
ci_067                -1.823923e-03 3 1  ON 66
ci_068                -1.481388e-03 3 1  ON 67
ci_069                -5.505466e-04 3 1  ON 68
ci_070                -4.210476e-04 3 1  ON 69
ci_071                -2.064076e-03 3 1  ON 70
ci_072                -1.991172e-03 3 1  ON 71
ci_073                 1.594433e-04 3 1  ON 72
ci_074                 1.762978e-04 3 1  ON 73
ci_075                 1.712231e-04 3 1  ON 74
ci_076                 7.919104e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6955
    reference variance = 0.78143
====================================================
  Execution time = 2.6760e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4901e-01
  Total weights = 1.954943749e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7525e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441563123385
                                         uncertainty =       0.002073067139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441563123385
                                         uncertainty =       0.002073067139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469908719
  error estimate for blocks of size 2^( 2) =       0.000493933165
  error estimate for blocks of size 2^( 3) =       0.000515842362
  error estimate for blocks of size 2^( 4) =       0.000531566458
  error estimate for blocks of size 2^( 5) =       0.000540214397
  error estimate for blocks of size 2^( 6) =       0.000545177389
  error estimate for blocks of size 2^( 7) =       0.000547378616

      target function =      -0.746127333267
              le_mean =     -22.661891756390
             les_mean =     514.010348677549
             stat err =       0.000541084215
             autocorr =       1.325875431156
   target nu stat err =       0.000541084215
   target dn stat err =       0.002484806813
      target stat err =       0.002127243183
              std dev =       0.664551283220
             le_variance =       0.441628408029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266189175639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 7.8886e+02, overlap shift 7.8886e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746132475104       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746132506093       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746132513023       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746132513759       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746132513842       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746132513864       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746132513883       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746132513883       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746132513880       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 7.8886e+02 is 2.266502e-07

solving harmonic davidson linear method for identity shift 3.1554e+03, overlap shift 3.1554e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746132475104       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746132482852       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746132484584       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746132484768       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746132484787       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746132484794       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746132484798       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746132484799       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746132484800       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.1554e+03 is 5.666464e-08

solving harmonic davidson linear method for identity shift 1.2622e+04, overlap shift 1.2622e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746132475104       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746132477041       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746132477474       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746132477520       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746132477525       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746132477518       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746132477529       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746132477515       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746132477508       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2622e+04 is 1.416629e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.402810 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1521e+01
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011373e-02 3 1  ON 2
ci_004                -5.098557e-02 3 1  ON 3
ci_005                 1.946959e-02 3 1  ON 4
ci_006                 1.975961e-02 3 1  ON 5
ci_007                 1.473302e-02 3 1  ON 6
ci_008                 1.549261e-02 3 1  ON 7
ci_009                -1.315493e-02 3 1  ON 8
ci_010                -1.205381e-02 3 1  ON 9
ci_011                -9.848141e-03 3 1  ON 10
ci_012                -9.084291e-03 3 1  ON 11
ci_013                 8.365547e-03 3 1  ON 12
ci_014                 9.295581e-03 3 1  ON 13
ci_015                 9.498688e-03 3 1  ON 14
ci_016                 9.360272e-03 3 1  ON 15
ci_017                 8.491143e-03 3 1  ON 16
ci_018                 8.265914e-03 3 1  ON 17
ci_019                -1.265904e-03 3 1  ON 18
ci_020                -1.589456e-03 3 1  ON 19
ci_021                -1.182157e-02 3 1  ON 20
ci_022                -1.183619e-02 3 1  ON 21
ci_023                 4.842606e-03 3 1  ON 22
ci_024                 4.910683e-03 3 1  ON 23
ci_025                 1.153129e-02 3 1  ON 24
ci_026                 1.153294e-02 3 1  ON 25
ci_027                 6.476740e-03 3 1  ON 26
ci_028                 6.177234e-03 3 1  ON 27
ci_029                -5.031134e-03 3 1  ON 28
ci_030                -4.114661e-03 3 1  ON 29
ci_031                 3.416217e-03 3 1  ON 30
ci_032                 4.671795e-03 3 1  ON 31
ci_033                 2.350370e-03 3 1  ON 32
ci_034                 4.107315e-03 3 1  ON 33
ci_035                 1.724207e-03 3 1  ON 34
ci_036                 2.137309e-03 3 1  ON 35
ci_037                 3.491748e-03 3 1  ON 36
ci_038                 3.699713e-03 3 1  ON 37
ci_039                 4.602348e-03 3 1  ON 38
ci_040                 4.919613e-03 3 1  ON 39
ci_041                 2.955488e-03 3 1  ON 40
ci_042                 2.734111e-03 3 1  ON 41
ci_043                 2.939807e-03 3 1  ON 42
ci_044                 3.206492e-03 3 1  ON 43
ci_045                 2.473950e-03 3 1  ON 44
ci_046                 2.734750e-03 3 1  ON 45
ci_047                -1.006090e-03 3 1  ON 46
ci_048                -8.452091e-04 3 1  ON 47
ci_049                 7.815709e-04 3 1  ON 48
ci_050                 9.945379e-04 3 1  ON 49
ci_051                -3.372009e-04 3 1  ON 50
ci_052                -1.211905e-03 3 1  ON 51
ci_053                -2.460127e-03 3 1  ON 52
ci_054                -2.689181e-03 3 1  ON 53
ci_055                -1.789966e-03 3 1  ON 54
ci_056                -1.964153e-03 3 1  ON 55
ci_057                -1.319586e-03 3 1  ON 56
ci_058                -9.958337e-04 3 1  ON 57
ci_059                -5.221247e-04 3 1  ON 58
ci_060                -7.411233e-04 3 1  ON 59
ci_061                 6.182954e-06 3 1  ON 60
ci_062                -9.067811e-04 3 1  ON 61
ci_063                -8.879289e-04 3 1  ON 62
ci_064                -5.045142e-04 3 1  ON 63
ci_065                -1.365603e-03 3 1  ON 64
ci_066                -1.881536e-03 3 1  ON 65
ci_067                -1.823869e-03 3 1  ON 66
ci_068                -1.481398e-03 3 1  ON 67
ci_069                -5.505432e-04 3 1  ON 68
ci_070                -4.210496e-04 3 1  ON 69
ci_071                -2.064062e-03 3 1  ON 70
ci_072                -1.991164e-03 3 1  ON 71
ci_073                 1.594230e-04 3 1  ON 72
ci_074                 1.763051e-04 3 1  ON 73
ci_075                 1.712134e-04 3 1  ON 74
ci_076                 7.919209e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6974
    reference variance = 0.400707
====================================================
  Execution time = 2.5793e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5164e-01
  Total weights = 1.9551e+06
  Execution time = 3.6537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440418830069
                                         uncertainty =       0.002126743405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440418830069
                                         uncertainty =       0.002126743405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469243978
  error estimate for blocks of size 2^( 2) =       0.000493492875
  error estimate for blocks of size 2^( 3) =       0.000516044226
  error estimate for blocks of size 2^( 4) =       0.000532276805
  error estimate for blocks of size 2^( 5) =       0.000541984810
  error estimate for blocks of size 2^( 6) =       0.000548308282
  error estimate for blocks of size 2^( 7) =       0.000548778425

      target function =      -0.743972184071
              le_mean =     -22.662270132787
             les_mean =     514.030129488414
             stat err =       0.000542837081
             autocorr =       1.338263389452
   target nu stat err =       0.000542837081
   target dn stat err =       0.002930637376
      target stat err =       0.002469036434
              std dev =       0.663611197281
             le_variance =       0.440379821157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440418750852
                                         uncertainty =       0.002126739498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440418750852
                                         uncertainty =       0.002126739498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469243936
  error estimate for blocks of size 2^( 2) =       0.000493492840
  error estimate for blocks of size 2^( 3) =       0.000516044196
  error estimate for blocks of size 2^( 4) =       0.000532276779
  error estimate for blocks of size 2^( 5) =       0.000541984780
  error estimate for blocks of size 2^( 6) =       0.000548308247
  error estimate for blocks of size 2^( 7) =       0.000548778385

      target function =      -0.743972283622
              le_mean =     -22.662270134334
             les_mean =     514.030129436802
             stat err =       0.000542837048
             autocorr =       1.338263467757
   target nu stat err =       0.000542837048
   target dn stat err =       0.002930630041
      target stat err =       0.002469031254
              std dev =       0.663611137801
             le_variance =       0.440379742214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440418790457
                                         uncertainty =       0.002126741451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440418790457
                                         uncertainty =       0.002126741451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469243957
  error estimate for blocks of size 2^( 2) =       0.000493492857
  error estimate for blocks of size 2^( 3) =       0.000516044211
  error estimate for blocks of size 2^( 4) =       0.000532276792
  error estimate for blocks of size 2^( 5) =       0.000541984795
  error estimate for blocks of size 2^( 6) =       0.000548308265
  error estimate for blocks of size 2^( 7) =       0.000548778405

      target function =      -0.743972233922
              le_mean =     -22.662270133560
             les_mean =     514.030129462508
             stat err =       0.000542837064
             autocorr =       1.338263428603
   target nu stat err =       0.000542837064
   target dn stat err =       0.002930633708
      target stat err =       0.002469033844
              std dev =       0.663611167539
             le_variance =       0.440379781682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440418825118
                                         uncertainty =       0.002126743161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440418825118
                                         uncertainty =       0.002126743161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469243975
  error estimate for blocks of size 2^( 2) =       0.000493492873
  error estimate for blocks of size 2^( 3) =       0.000516044224
  error estimate for blocks of size 2^( 4) =       0.000532276804
  error estimate for blocks of size 2^( 5) =       0.000541984808
  error estimate for blocks of size 2^( 6) =       0.000548308280
  error estimate for blocks of size 2^( 7) =       0.000548778422

      target function =      -0.743972190310
              le_mean =     -22.662270132884
             les_mean =     514.030129485165
             stat err =       0.000542837079
             autocorr =       1.338263394358
   target nu stat err =       0.000542837079
   target dn stat err =       0.002930636917
      target stat err =       0.002469036110
              std dev =       0.663611193563
             le_variance =       0.440379816222


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743972184071        initial
     7.8886e+02     7.8886e+03             2.2665e-07        -0.743972283622  <--
     3.1554e+03     3.1554e+04             5.6665e-08        -0.743972233922
     1.2622e+04     1.2622e+05             1.4166e-08        -0.743972190310

*****************************************************************************
Applying the update for shift_i =   7.8886e+02     and shift_s =   7.8886e+03
*****************************************************************************

  Execution time = 4.3969e+01
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011375e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946944e-02 3 1  ON 4
ci_006                 1.975952e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315491e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848117e-03 3 1  ON 10
ci_012                -9.084251e-03 3 1  ON 11
ci_013                 8.365525e-03 3 1  ON 12
ci_014                 9.295527e-03 3 1  ON 13
ci_015                 9.498573e-03 3 1  ON 14
ci_016                 9.360230e-03 3 1  ON 15
ci_017                 8.491232e-03 3 1  ON 16
ci_018                 8.265897e-03 3 1  ON 17
ci_019                -1.266061e-03 3 1  ON 18
ci_020                -1.589626e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183626e-02 3 1  ON 21
ci_023                 4.842576e-03 3 1  ON 22
ci_024                 4.910752e-03 3 1  ON 23
ci_025                 1.153146e-02 3 1  ON 24
ci_026                 1.153299e-02 3 1  ON 25
ci_027                 6.476738e-03 3 1  ON 26
ci_028                 6.177190e-03 3 1  ON 27
ci_029                -5.031209e-03 3 1  ON 28
ci_030                -4.114609e-03 3 1  ON 29
ci_031                 3.416225e-03 3 1  ON 30
ci_032                 4.671953e-03 3 1  ON 31
ci_033                 2.350424e-03 3 1  ON 32
ci_034                 4.107258e-03 3 1  ON 33
ci_035                 1.724188e-03 3 1  ON 34
ci_036                 2.137221e-03 3 1  ON 35
ci_037                 3.491719e-03 3 1  ON 36
ci_038                 3.699690e-03 3 1  ON 37
ci_039                 4.602356e-03 3 1  ON 38
ci_040                 4.919613e-03 3 1  ON 39
ci_041                 2.955496e-03 3 1  ON 40
ci_042                 2.734129e-03 3 1  ON 41
ci_043                 2.939781e-03 3 1  ON 42
ci_044                 3.206468e-03 3 1  ON 43
ci_045                 2.473970e-03 3 1  ON 44
ci_046                 2.734760e-03 3 1  ON 45
ci_047                -1.006019e-03 3 1  ON 46
ci_048                -8.452237e-04 3 1  ON 47
ci_049                 7.814787e-04 3 1  ON 48
ci_050                 9.944763e-04 3 1  ON 49
ci_051                -3.372441e-04 3 1  ON 50
ci_052                -1.211977e-03 3 1  ON 51
ci_053                -2.460126e-03 3 1  ON 52
ci_054                -2.689193e-03 3 1  ON 53
ci_055                -1.790037e-03 3 1  ON 54
ci_056                -1.964165e-03 3 1  ON 55
ci_057                -1.319599e-03 3 1  ON 56
ci_058                -9.958046e-04 3 1  ON 57
ci_059                -5.220772e-04 3 1  ON 58
ci_060                -7.411312e-04 3 1  ON 59
ci_061                 6.131402e-06 3 1  ON 60
ci_062                -9.066580e-04 3 1  ON 61
ci_063                -8.878729e-04 3 1  ON 62
ci_064                -5.045554e-04 3 1  ON 63
ci_065                -1.365555e-03 3 1  ON 64
ci_066                -1.881518e-03 3 1  ON 65
ci_067                -1.823707e-03 3 1  ON 66
ci_068                -1.481430e-03 3 1  ON 67
ci_069                -5.505330e-04 3 1  ON 68
ci_070                -4.210557e-04 3 1  ON 69
ci_071                -2.064021e-03 3 1  ON 70
ci_072                -1.991143e-03 3 1  ON 71
ci_073                 1.593620e-04 3 1  ON 72
ci_074                 1.763270e-04 3 1  ON 73
ci_075                 1.711843e-04 3 1  ON 74
ci_076                 7.919525e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5516e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.603
    reference variance = 0.303289
====================================================
  Execution time = 2.6658e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4728e-01
  Total weights = 1.955260642e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439971995792
                                         uncertainty =       0.002447435741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439971995792
                                         uncertainty =       0.002447435741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469032464
  error estimate for blocks of size 2^( 2) =       0.000492899029
  error estimate for blocks of size 2^( 3) =       0.000514979023
  error estimate for blocks of size 2^( 4) =       0.000531104134
  error estimate for blocks of size 2^( 5) =       0.000540309046
  error estimate for blocks of size 2^( 6) =       0.000544986615
  error estimate for blocks of size 2^( 7) =       0.000548990353

      target function =      -0.747568597216
              le_mean =     -22.662955398542
             les_mean =     514.056823884965
             stat err =       0.000541347537
             autocorr =       1.332129737469
   target nu stat err =       0.000541347537
   target dn stat err =       0.002640004621
      target stat err =       0.002261989501
              std dev =       0.663312071954
             le_variance =       0.439982904800


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266295539854e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.9722e+02, overlap shift 1.9722e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747574546976       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747574603619       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747574614456       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747574614782       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747574615619       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747574615970       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747574616082       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747574616032       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747574616102       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747574616070       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747574616113       residual = 7.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.9722e+02 is 8.140861e-07

solving harmonic davidson linear method for identity shift 7.8886e+02, overlap shift 7.8886e+03 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747574546976       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747574561139       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747574563849       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747574563930       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747574564139       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747574564226       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747574564255       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747574564243       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747574564260       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747574564252       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747574564263       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 7.8886e+02 is 2.035520e-07

solving harmonic davidson linear method for identity shift 3.1554e+03, overlap shift 3.1554e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747574546976       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747574550517       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747574551194       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747574551215       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747574551264       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747574551293       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747574551297       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747574551293       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747574551303       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747574551298       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747574551296       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.1554e+03 is 5.088992e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.407017 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1390e+01
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_001                -7.055655e-01 3 1  ON 0
ci_002                -7.029289e-01 3 1  ON 1
ci_003                -5.011391e-02 3 1  ON 2
ci_004                -5.098545e-02 3 1  ON 3
ci_005                 1.946938e-02 3 1  ON 4
ci_006                 1.975943e-02 3 1  ON 5
ci_007                 1.473296e-02 3 1  ON 6
ci_008                 1.549250e-02 3 1  ON 7
ci_009                -1.315480e-02 3 1  ON 8
ci_010                -1.205364e-02 3 1  ON 9
ci_011                -9.848019e-03 3 1  ON 10
ci_012                -9.084137e-03 3 1  ON 11
ci_013                 8.365432e-03 3 1  ON 12
ci_014                 9.295387e-03 3 1  ON 13
ci_015                 9.498480e-03 3 1  ON 14
ci_016                 9.360123e-03 3 1  ON 15
ci_017                 8.491251e-03 3 1  ON 16
ci_018                 8.265901e-03 3 1  ON 17
ci_019                -1.266250e-03 3 1  ON 18
ci_020                -1.589829e-03 3 1  ON 19
ci_021                -1.182160e-02 3 1  ON 20
ci_022                -1.183634e-02 3 1  ON 21
ci_023                 4.842602e-03 3 1  ON 22
ci_024                 4.910751e-03 3 1  ON 23
ci_025                 1.153156e-02 3 1  ON 24
ci_026                 1.153316e-02 3 1  ON 25
ci_027                 6.476647e-03 3 1  ON 26
ci_028                 6.177160e-03 3 1  ON 27
ci_029                -5.031141e-03 3 1  ON 28
ci_030                -4.114526e-03 3 1  ON 29
ci_031                 3.416294e-03 3 1  ON 30
ci_032                 4.671977e-03 3 1  ON 31
ci_033                 2.350392e-03 3 1  ON 32
ci_034                 4.107200e-03 3 1  ON 33
ci_035                 1.724200e-03 3 1  ON 34
ci_036                 2.137217e-03 3 1  ON 35
ci_037                 3.491716e-03 3 1  ON 36
ci_038                 3.699657e-03 3 1  ON 37
ci_039                 4.602400e-03 3 1  ON 38
ci_040                 4.919587e-03 3 1  ON 39
ci_041                 2.955614e-03 3 1  ON 40
ci_042                 2.734142e-03 3 1  ON 41
ci_043                 2.939803e-03 3 1  ON 42
ci_044                 3.206427e-03 3 1  ON 43
ci_045                 2.473996e-03 3 1  ON 44
ci_046                 2.734769e-03 3 1  ON 45
ci_047                -1.006057e-03 3 1  ON 46
ci_048                -8.451611e-04 3 1  ON 47
ci_049                 7.815657e-04 3 1  ON 48
ci_050                 9.944878e-04 3 1  ON 49
ci_051                -3.372429e-04 3 1  ON 50
ci_052                -1.211865e-03 3 1  ON 51
ci_053                -2.460176e-03 3 1  ON 52
ci_054                -2.689127e-03 3 1  ON 53
ci_055                -1.790045e-03 3 1  ON 54
ci_056                -1.964217e-03 3 1  ON 55
ci_057                -1.319546e-03 3 1  ON 56
ci_058                -9.958146e-04 3 1  ON 57
ci_059                -5.220805e-04 3 1  ON 58
ci_060                -7.411558e-04 3 1  ON 59
ci_061                 6.109962e-06 3 1  ON 60
ci_062                -9.066515e-04 3 1  ON 61
ci_063                -8.879003e-04 3 1  ON 62
ci_064                -5.045893e-04 3 1  ON 63
ci_065                -1.365542e-03 3 1  ON 64
ci_066                -1.881552e-03 3 1  ON 65
ci_067                -1.823708e-03 3 1  ON 66
ci_068                -1.481504e-03 3 1  ON 67
ci_069                -5.504938e-04 3 1  ON 68
ci_070                -4.210732e-04 3 1  ON 69
ci_071                -2.063968e-03 3 1  ON 70
ci_072                -1.991167e-03 3 1  ON 71
ci_073                 1.594058e-04 3 1  ON 72
ci_074                 1.763670e-04 3 1  ON 73
ci_075                 1.711705e-04 3 1  ON 74
ci_076                 7.919379e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.6064
    reference variance = 0.267598
====================================================
  Execution time = 2.5941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4992e-01
  Total weights = 1.9558e+06
  Execution time = 3.6540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439645306670
                                         uncertainty =       0.002156338626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439645306670
                                         uncertainty =       0.002156338626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468858457
  error estimate for blocks of size 2^( 2) =       0.000492981726
  error estimate for blocks of size 2^( 3) =       0.000515530605
  error estimate for blocks of size 2^( 4) =       0.000531466749
  error estimate for blocks of size 2^( 5) =       0.000540656152
  error estimate for blocks of size 2^( 6) =       0.000544458712
  error estimate for blocks of size 2^( 7) =       0.000549802788

      target function =      -0.745389449139
              le_mean =     -22.663118573699
             les_mean =     514.066865729177
             stat err =       0.000541596100
             autocorr =       1.334343206144
   target nu stat err =       0.000541596100
   target dn stat err =       0.002818051320
      target stat err =       0.002391267948
              std dev =       0.663065989090
             le_variance =       0.439656505888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439645127771
                                         uncertainty =       0.002156317657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439645127771
                                         uncertainty =       0.002156317657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468858362
  error estimate for blocks of size 2^( 2) =       0.000492981644
  error estimate for blocks of size 2^( 3) =       0.000515530534
  error estimate for blocks of size 2^( 4) =       0.000531466680
  error estimate for blocks of size 2^( 5) =       0.000540656066
  error estimate for blocks of size 2^( 6) =       0.000544458608
  error estimate for blocks of size 2^( 7) =       0.000549802648

      target function =      -0.745389122495
              le_mean =     -22.663118577537
             les_mean =     514.066866300025
             stat err =       0.000541596001
             autocorr =       1.334343257186
   target nu stat err =       0.000541596001
   target dn stat err =       0.002818162630
      target stat err =       0.002391354470
              std dev =       0.663065854318
             le_variance =       0.439656327163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439645217189
                                         uncertainty =       0.002156328139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439645217189
                                         uncertainty =       0.002156328139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468858410
  error estimate for blocks of size 2^( 2) =       0.000492981685
  error estimate for blocks of size 2^( 3) =       0.000515530569
  error estimate for blocks of size 2^( 4) =       0.000531466714
  error estimate for blocks of size 2^( 5) =       0.000540656109
  error estimate for blocks of size 2^( 6) =       0.000544458660
  error estimate for blocks of size 2^( 7) =       0.000549802718

      target function =      -0.745389288836
              le_mean =     -22.663118575617
             les_mean =     514.066866010869
             stat err =       0.000541596050
             autocorr =       1.334343231686
   target nu stat err =       0.000541596050
   target dn stat err =       0.002818106728
      target stat err =       0.002391311031
              std dev =       0.663065921680
             le_variance =       0.439656416494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439645295483
                                         uncertainty =       0.002156337315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439645295483
                                         uncertainty =       0.002156337315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468858451
  error estimate for blocks of size 2^( 2) =       0.000492981721
  error estimate for blocks of size 2^( 3) =       0.000515530600
  error estimate for blocks of size 2^( 4) =       0.000531466744
  error estimate for blocks of size 2^( 5) =       0.000540656147
  error estimate for blocks of size 2^( 6) =       0.000544458706
  error estimate for blocks of size 2^( 7) =       0.000549802779

      target function =      -0.745389429431
              le_mean =     -22.663118573939
             les_mean =     514.066865763981
             stat err =       0.000541596094
             autocorr =       1.334343209347
   target nu stat err =       0.000541596094
   target dn stat err =       0.002818058218
      target stat err =       0.002391273313
              std dev =       0.663065980662
             le_variance =       0.439656494711


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745389449139        initial  <--
     1.9722e+02     1.9722e+03             8.1409e-07        -0.745389122495
     7.8886e+02     7.8886e+03             2.0355e-07        -0.745389288836
     3.1554e+03     3.1554e+04             5.0890e-08        -0.745389429431

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 47.5082
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011375e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946944e-02 3 1  ON 4
ci_006                 1.975952e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315491e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848117e-03 3 1  ON 10
ci_012                -9.084251e-03 3 1  ON 11
ci_013                 8.365525e-03 3 1  ON 12
ci_014                 9.295527e-03 3 1  ON 13
ci_015                 9.498573e-03 3 1  ON 14
ci_016                 9.360230e-03 3 1  ON 15
ci_017                 8.491232e-03 3 1  ON 16
ci_018                 8.265897e-03 3 1  ON 17
ci_019                -1.266061e-03 3 1  ON 18
ci_020                -1.589626e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183626e-02 3 1  ON 21
ci_023                 4.842576e-03 3 1  ON 22
ci_024                 4.910752e-03 3 1  ON 23
ci_025                 1.153146e-02 3 1  ON 24
ci_026                 1.153299e-02 3 1  ON 25
ci_027                 6.476738e-03 3 1  ON 26
ci_028                 6.177190e-03 3 1  ON 27
ci_029                -5.031209e-03 3 1  ON 28
ci_030                -4.114609e-03 3 1  ON 29
ci_031                 3.416225e-03 3 1  ON 30
ci_032                 4.671953e-03 3 1  ON 31
ci_033                 2.350424e-03 3 1  ON 32
ci_034                 4.107258e-03 3 1  ON 33
ci_035                 1.724188e-03 3 1  ON 34
ci_036                 2.137221e-03 3 1  ON 35
ci_037                 3.491719e-03 3 1  ON 36
ci_038                 3.699690e-03 3 1  ON 37
ci_039                 4.602356e-03 3 1  ON 38
ci_040                 4.919613e-03 3 1  ON 39
ci_041                 2.955496e-03 3 1  ON 40
ci_042                 2.734129e-03 3 1  ON 41
ci_043                 2.939781e-03 3 1  ON 42
ci_044                 3.206468e-03 3 1  ON 43
ci_045                 2.473970e-03 3 1  ON 44
ci_046                 2.734760e-03 3 1  ON 45
ci_047                -1.006019e-03 3 1  ON 46
ci_048                -8.452237e-04 3 1  ON 47
ci_049                 7.814787e-04 3 1  ON 48
ci_050                 9.944763e-04 3 1  ON 49
ci_051                -3.372441e-04 3 1  ON 50
ci_052                -1.211977e-03 3 1  ON 51
ci_053                -2.460126e-03 3 1  ON 52
ci_054                -2.689193e-03 3 1  ON 53
ci_055                -1.790037e-03 3 1  ON 54
ci_056                -1.964165e-03 3 1  ON 55
ci_057                -1.319599e-03 3 1  ON 56
ci_058                -9.958046e-04 3 1  ON 57
ci_059                -5.220772e-04 3 1  ON 58
ci_060                -7.411312e-04 3 1  ON 59
ci_061                 6.131402e-06 3 1  ON 60
ci_062                -9.066580e-04 3 1  ON 61
ci_063                -8.878729e-04 3 1  ON 62
ci_064                -5.045554e-04 3 1  ON 63
ci_065                -1.365555e-03 3 1  ON 64
ci_066                -1.881518e-03 3 1  ON 65
ci_067                -1.823707e-03 3 1  ON 66
ci_068                -1.481430e-03 3 1  ON 67
ci_069                -5.505330e-04 3 1  ON 68
ci_070                -4.210557e-04 3 1  ON 69
ci_071                -2.064021e-03 3 1  ON 70
ci_072                -1.991143e-03 3 1  ON 71
ci_073                 1.593620e-04 3 1  ON 72
ci_074                 1.763270e-04 3 1  ON 73
ci_075                 1.711843e-04 3 1  ON 74
ci_076                 7.919525e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.8942e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.6336
    reference variance = 0.400599
====================================================
  Execution time = 2.6755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5094e-01
  Total weights = 1.955208201e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439823919238
                                         uncertainty =       0.002019502825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439823919238
                                         uncertainty =       0.002019502825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468939145
  error estimate for blocks of size 2^( 2) =       0.000492991575
  error estimate for blocks of size 2^( 3) =       0.000515492540
  error estimate for blocks of size 2^( 4) =       0.000531841723
  error estimate for blocks of size 2^( 5) =       0.000541022799
  error estimate for blocks of size 2^( 6) =       0.000545068795
  error estimate for blocks of size 2^( 7) =       0.000547070525

      target function =      -0.744545121226
              le_mean =     -22.661680395636
             les_mean =     514.002693942789
             stat err =       0.000541250961
             autocorr =       1.332184530583
   target nu stat err =       0.000541250961
   target dn stat err =       0.002820347526
      target stat err =       0.002382682505
              std dev =       0.663180098296
             le_variance =       0.439807842776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266168039564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.9722e+03, overlap shift 1.9722e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744551837423       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744551847983       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744551849579       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744551849876       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744551849957       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744551850001       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744551849983       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744551849971       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744551849980       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744551849977       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744551849979       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744551849980       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.9722e+03 is 1.184045e-07

solving harmonic davidson linear method for identity shift 7.8886e+03, overlap shift 7.8886e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744551837423       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744551840063       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744551840462       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744551840537       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744551840557       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744551840565       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744551840564       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744551840561       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744551840563       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744551840567       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744551840567       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744551840585       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 7.8886e+03 is 2.960155e-08

solving harmonic davidson linear method for identity shift 3.1554e+04, overlap shift 3.1554e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744551837423       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744551838083       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744551838183       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744551838202       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744551838207       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744551838272       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744551838206       residual = 9.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744551838220       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744551838224       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744551838177       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744551838260       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744551838208       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.1554e+04 is 7.400415e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1474e+01
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011374e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946943e-02 3 1  ON 4
ci_006                 1.975951e-02 3 1  ON 5
ci_007                 1.473302e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315490e-02 3 1  ON 8
ci_010                -1.205373e-02 3 1  ON 9
ci_011                -9.848112e-03 3 1  ON 10
ci_012                -9.084241e-03 3 1  ON 11
ci_013                 8.365508e-03 3 1  ON 12
ci_014                 9.295522e-03 3 1  ON 13
ci_015                 9.498565e-03 3 1  ON 14
ci_016                 9.360227e-03 3 1  ON 15
ci_017                 8.491232e-03 3 1  ON 16
ci_018                 8.265896e-03 3 1  ON 17
ci_019                -1.266090e-03 3 1  ON 18
ci_020                -1.589655e-03 3 1  ON 19
ci_021                -1.182150e-02 3 1  ON 20
ci_022                -1.183627e-02 3 1  ON 21
ci_023                 4.842572e-03 3 1  ON 22
ci_024                 4.910754e-03 3 1  ON 23
ci_025                 1.153148e-02 3 1  ON 24
ci_026                 1.153300e-02 3 1  ON 25
ci_027                 6.476737e-03 3 1  ON 26
ci_028                 6.177194e-03 3 1  ON 27
ci_029                -5.031205e-03 3 1  ON 28
ci_030                -4.114600e-03 3 1  ON 29
ci_031                 3.416235e-03 3 1  ON 30
ci_032                 4.671962e-03 3 1  ON 31
ci_033                 2.350423e-03 3 1  ON 32
ci_034                 4.107251e-03 3 1  ON 33
ci_035                 1.724185e-03 3 1  ON 34
ci_036                 2.137215e-03 3 1  ON 35
ci_037                 3.491707e-03 3 1  ON 36
ci_038                 3.699691e-03 3 1  ON 37
ci_039                 4.602353e-03 3 1  ON 38
ci_040                 4.919610e-03 3 1  ON 39
ci_041                 2.955492e-03 3 1  ON 40
ci_042                 2.734128e-03 3 1  ON 41
ci_043                 2.939786e-03 3 1  ON 42
ci_044                 3.206471e-03 3 1  ON 43
ci_045                 2.473972e-03 3 1  ON 44
ci_046                 2.734761e-03 3 1  ON 45
ci_047                -1.006021e-03 3 1  ON 46
ci_048                -8.452283e-04 3 1  ON 47
ci_049                 7.814841e-04 3 1  ON 48
ci_050                 9.944773e-04 3 1  ON 49
ci_051                -3.372426e-04 3 1  ON 50
ci_052                -1.211969e-03 3 1  ON 51
ci_053                -2.460137e-03 3 1  ON 52
ci_054                -2.689189e-03 3 1  ON 53
ci_055                -1.790032e-03 3 1  ON 54
ci_056                -1.964162e-03 3 1  ON 55
ci_057                -1.319596e-03 3 1  ON 56
ci_058                -9.958074e-04 3 1  ON 57
ci_059                -5.220708e-04 3 1  ON 58
ci_060                -7.411320e-04 3 1  ON 59
ci_061                 6.133524e-06 3 1  ON 60
ci_062                -9.066489e-04 3 1  ON 61
ci_063                -8.878629e-04 3 1  ON 62
ci_064                -5.045572e-04 3 1  ON 63
ci_065                -1.365550e-03 3 1  ON 64
ci_066                -1.881514e-03 3 1  ON 65
ci_067                -1.823707e-03 3 1  ON 66
ci_068                -1.481436e-03 3 1  ON 67
ci_069                -5.505332e-04 3 1  ON 68
ci_070                -4.210473e-04 3 1  ON 69
ci_071                -2.064016e-03 3 1  ON 70
ci_072                -1.991144e-03 3 1  ON 71
ci_073                 1.593566e-04 3 1  ON 72
ci_074                 1.763313e-04 3 1  ON 73
ci_075                 1.711800e-04 3 1  ON 74
ci_076                 7.919423e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.5833
    reference variance = 0.368555
====================================================
  Execution time = 2.8163e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5605e-01
  Total weights = 1.9553e+06
  Execution time = 3.6375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445274519076
                                         uncertainty =       0.002321103867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445274519076
                                         uncertainty =       0.002321103867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471877233
  error estimate for blocks of size 2^( 2) =       0.000495433772
  error estimate for blocks of size 2^( 3) =       0.000517613685
  error estimate for blocks of size 2^( 4) =       0.000533034082
  error estimate for blocks of size 2^( 5) =       0.000542988827
  error estimate for blocks of size 2^( 6) =       0.000545923607
  error estimate for blocks of size 2^( 7) =       0.000550813977

      target function =      -0.740387543815
              le_mean =     -22.662165534608
             les_mean =     514.029793637422
             stat err =       0.000543190123
             autocorr =       1.325090926446
   target nu stat err =       0.000543190123
   target dn stat err =       0.003038186969
      target stat err =       0.002530259649
              std dev =       0.667335183329
             le_variance =       0.445336246909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445274499418
                                         uncertainty =       0.002321105246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445274499418
                                         uncertainty =       0.002321105246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471877223
  error estimate for blocks of size 2^( 2) =       0.000495433763
  error estimate for blocks of size 2^( 3) =       0.000517613676
  error estimate for blocks of size 2^( 4) =       0.000533034076
  error estimate for blocks of size 2^( 5) =       0.000542988820
  error estimate for blocks of size 2^( 6) =       0.000545923599
  error estimate for blocks of size 2^( 7) =       0.000550813968

      target function =      -0.740387475535
              le_mean =     -22.662165533833
             les_mean =     514.029793686614
             stat err =       0.000543190116
             autocorr =       1.325090948949
   target nu stat err =       0.000543190116
   target dn stat err =       0.003038186586
      target stat err =       0.002530258890
              std dev =       0.667335168617
             le_variance =       0.445336227273

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445274509246
                                         uncertainty =       0.002321104557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445274509246
                                         uncertainty =       0.002321104557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471877228
  error estimate for blocks of size 2^( 2) =       0.000495433768
  error estimate for blocks of size 2^( 3) =       0.000517613681
  error estimate for blocks of size 2^( 4) =       0.000533034079
  error estimate for blocks of size 2^( 5) =       0.000542988824
  error estimate for blocks of size 2^( 6) =       0.000545923603
  error estimate for blocks of size 2^( 7) =       0.000550813972

      target function =      -0.740387510027
              le_mean =     -22.662165534220
             les_mean =     514.029793661580
             stat err =       0.000543190120
             autocorr =       1.325090937699
   target nu stat err =       0.000543190120
   target dn stat err =       0.003038186777
      target stat err =       0.002530259272
              std dev =       0.667335175973
             le_variance =       0.445336237091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445274517847
                                         uncertainty =       0.002321103953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445274517847
                                         uncertainty =       0.002321103953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471877233
  error estimate for blocks of size 2^( 2) =       0.000495433772
  error estimate for blocks of size 2^( 3) =       0.000517613684
  error estimate for blocks of size 2^( 4) =       0.000533034082
  error estimate for blocks of size 2^( 5) =       0.000542988827
  error estimate for blocks of size 2^( 6) =       0.000545923606
  error estimate for blocks of size 2^( 7) =       0.000550813976

      target function =      -0.740387539629
              le_mean =     -22.662165534560
             les_mean =     514.029793640395
             stat err =       0.000543190123
             autocorr =       1.325090927848
   target nu stat err =       0.000543190123
   target dn stat err =       0.003038186945
      target stat err =       0.002530259602
              std dev =       0.667335182410
             le_variance =       0.445336245682


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740387543815        initial  <--
     1.9722e+03     1.9722e+04             1.1840e-07        -0.740387475535
     7.8886e+03     7.8886e+04             2.9602e-08        -0.740387510027
     3.1554e+04     3.1554e+05             7.4004e-09        -0.740387539629

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.3075
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011375e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946944e-02 3 1  ON 4
ci_006                 1.975952e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315491e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848117e-03 3 1  ON 10
ci_012                -9.084251e-03 3 1  ON 11
ci_013                 8.365525e-03 3 1  ON 12
ci_014                 9.295527e-03 3 1  ON 13
ci_015                 9.498573e-03 3 1  ON 14
ci_016                 9.360230e-03 3 1  ON 15
ci_017                 8.491232e-03 3 1  ON 16
ci_018                 8.265897e-03 3 1  ON 17
ci_019                -1.266061e-03 3 1  ON 18
ci_020                -1.589626e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183626e-02 3 1  ON 21
ci_023                 4.842576e-03 3 1  ON 22
ci_024                 4.910752e-03 3 1  ON 23
ci_025                 1.153146e-02 3 1  ON 24
ci_026                 1.153299e-02 3 1  ON 25
ci_027                 6.476738e-03 3 1  ON 26
ci_028                 6.177190e-03 3 1  ON 27
ci_029                -5.031209e-03 3 1  ON 28
ci_030                -4.114609e-03 3 1  ON 29
ci_031                 3.416225e-03 3 1  ON 30
ci_032                 4.671953e-03 3 1  ON 31
ci_033                 2.350424e-03 3 1  ON 32
ci_034                 4.107258e-03 3 1  ON 33
ci_035                 1.724188e-03 3 1  ON 34
ci_036                 2.137221e-03 3 1  ON 35
ci_037                 3.491719e-03 3 1  ON 36
ci_038                 3.699690e-03 3 1  ON 37
ci_039                 4.602356e-03 3 1  ON 38
ci_040                 4.919613e-03 3 1  ON 39
ci_041                 2.955496e-03 3 1  ON 40
ci_042                 2.734129e-03 3 1  ON 41
ci_043                 2.939781e-03 3 1  ON 42
ci_044                 3.206468e-03 3 1  ON 43
ci_045                 2.473970e-03 3 1  ON 44
ci_046                 2.734760e-03 3 1  ON 45
ci_047                -1.006019e-03 3 1  ON 46
ci_048                -8.452237e-04 3 1  ON 47
ci_049                 7.814787e-04 3 1  ON 48
ci_050                 9.944763e-04 3 1  ON 49
ci_051                -3.372441e-04 3 1  ON 50
ci_052                -1.211977e-03 3 1  ON 51
ci_053                -2.460126e-03 3 1  ON 52
ci_054                -2.689193e-03 3 1  ON 53
ci_055                -1.790037e-03 3 1  ON 54
ci_056                -1.964165e-03 3 1  ON 55
ci_057                -1.319599e-03 3 1  ON 56
ci_058                -9.958046e-04 3 1  ON 57
ci_059                -5.220772e-04 3 1  ON 58
ci_060                -7.411312e-04 3 1  ON 59
ci_061                 6.131402e-06 3 1  ON 60
ci_062                -9.066580e-04 3 1  ON 61
ci_063                -8.878729e-04 3 1  ON 62
ci_064                -5.045554e-04 3 1  ON 63
ci_065                -1.365555e-03 3 1  ON 64
ci_066                -1.881518e-03 3 1  ON 65
ci_067                -1.823707e-03 3 1  ON 66
ci_068                -1.481430e-03 3 1  ON 67
ci_069                -5.505330e-04 3 1  ON 68
ci_070                -4.210557e-04 3 1  ON 69
ci_071                -2.064021e-03 3 1  ON 70
ci_072                -1.991143e-03 3 1  ON 71
ci_073                 1.593620e-04 3 1  ON 72
ci_074                 1.763270e-04 3 1  ON 73
ci_075                 1.711843e-04 3 1  ON 74
ci_076                 7.919525e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7803e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.6244
    reference variance = 0.738356
====================================================
  Execution time = 2.6687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5000e-01
  Total weights = 1.955336079e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440865711420
                                         uncertainty =       0.002134359655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440865711420
                                         uncertainty =       0.002134359655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469505942
  error estimate for blocks of size 2^( 2) =       0.000493012731
  error estimate for blocks of size 2^( 3) =       0.000514786855
  error estimate for blocks of size 2^( 4) =       0.000530844918
  error estimate for blocks of size 2^( 5) =       0.000540946365
  error estimate for blocks of size 2^( 6) =       0.000546828444
  error estimate for blocks of size 2^( 7) =       0.000549873168

      target function =      -0.745319680012
              le_mean =     -22.662071255637
             les_mean =     514.019469335753
             stat err =       0.000542123224
             autocorr =       1.333256894315
   target nu stat err =       0.000542123224
   target dn stat err =       0.002681855396
      target stat err =       0.002279280266
              std dev =       0.663981670887
             le_variance =       0.440871659274


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266207125564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.9722e+04, overlap shift 1.9722e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745325730481       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745325731471       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745325731644       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745325731654       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745325731657       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745325731673       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745325731621       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745325731617       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745325731709       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745325731631       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745325731697       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.9722e+04 is 1.088938e-08

solving harmonic davidson linear method for identity shift 7.8886e+04, overlap shift 7.8886e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745325730481       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745325730728       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745325730771       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745325730774       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745325730732       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745325730726       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745325730782       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745325730523       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745325730755       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745325730707       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745325730779       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 7.8886e+04 is 2.722348e-09

solving harmonic davidson linear method for identity shift 3.1554e+05, overlap shift 3.1554e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745325730481       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745325730543       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745325730553       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745325730554       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745325730544       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745325731122       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745325730883       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745325730450       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745325730597       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745325730670       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745325730471       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.1554e+05 is 6.805873e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1435e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011375e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946944e-02 3 1  ON 4
ci_006                 1.975952e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315491e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848116e-03 3 1  ON 10
ci_012                -9.084251e-03 3 1  ON 11
ci_013                 8.365524e-03 3 1  ON 12
ci_014                 9.295527e-03 3 1  ON 13
ci_015                 9.498573e-03 3 1  ON 14
ci_016                 9.360227e-03 3 1  ON 15
ci_017                 8.491233e-03 3 1  ON 16
ci_018                 8.265895e-03 3 1  ON 17
ci_019                -1.266063e-03 3 1  ON 18
ci_020                -1.589627e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183627e-02 3 1  ON 21
ci_023                 4.842576e-03 3 1  ON 22
ci_024                 4.910751e-03 3 1  ON 23
ci_025                 1.153146e-02 3 1  ON 24
ci_026                 1.153299e-02 3 1  ON 25
ci_027                 6.476738e-03 3 1  ON 26
ci_028                 6.177190e-03 3 1  ON 27
ci_029                -5.031208e-03 3 1  ON 28
ci_030                -4.114608e-03 3 1  ON 29
ci_031                 3.416227e-03 3 1  ON 30
ci_032                 4.671953e-03 3 1  ON 31
ci_033                 2.350424e-03 3 1  ON 32
ci_034                 4.107258e-03 3 1  ON 33
ci_035                 1.724188e-03 3 1  ON 34
ci_036                 2.137221e-03 3 1  ON 35
ci_037                 3.491718e-03 3 1  ON 36
ci_038                 3.699690e-03 3 1  ON 37
ci_039                 4.602356e-03 3 1  ON 38
ci_040                 4.919613e-03 3 1  ON 39
ci_041                 2.955496e-03 3 1  ON 40
ci_042                 2.734129e-03 3 1  ON 41
ci_043                 2.939780e-03 3 1  ON 42
ci_044                 3.206467e-03 3 1  ON 43
ci_045                 2.473971e-03 3 1  ON 44
ci_046                 2.734759e-03 3 1  ON 45
ci_047                -1.006019e-03 3 1  ON 46
ci_048                -8.452237e-04 3 1  ON 47
ci_049                 7.814781e-04 3 1  ON 48
ci_050                 9.944747e-04 3 1  ON 49
ci_051                -3.372432e-04 3 1  ON 50
ci_052                -1.211977e-03 3 1  ON 51
ci_053                -2.460125e-03 3 1  ON 52
ci_054                -2.689193e-03 3 1  ON 53
ci_055                -1.790037e-03 3 1  ON 54
ci_056                -1.964165e-03 3 1  ON 55
ci_057                -1.319599e-03 3 1  ON 56
ci_058                -9.958051e-04 3 1  ON 57
ci_059                -5.220767e-04 3 1  ON 58
ci_060                -7.411313e-04 3 1  ON 59
ci_061                 6.132672e-06 3 1  ON 60
ci_062                -9.066584e-04 3 1  ON 61
ci_063                -8.878709e-04 3 1  ON 62
ci_064                -5.045546e-04 3 1  ON 63
ci_065                -1.365556e-03 3 1  ON 64
ci_066                -1.881519e-03 3 1  ON 65
ci_067                -1.823706e-03 3 1  ON 66
ci_068                -1.481430e-03 3 1  ON 67
ci_069                -5.505326e-04 3 1  ON 68
ci_070                -4.210557e-04 3 1  ON 69
ci_071                -2.064020e-03 3 1  ON 70
ci_072                -1.991143e-03 3 1  ON 71
ci_073                 1.593619e-04 3 1  ON 72
ci_074                 1.763273e-04 3 1  ON 73
ci_075                 1.711842e-04 3 1  ON 74
ci_076                 7.919525e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.6405
    reference variance = 0.573242
====================================================
  Execution time = 2.6188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5750e-01
  Total weights = 1.9553e+06
  Execution time = 3.6553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448531978161
                                         uncertainty =       0.007257387410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448531978161
                                         uncertainty =       0.007257387410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473568807
  error estimate for blocks of size 2^( 2) =       0.000497955579
  error estimate for blocks of size 2^( 3) =       0.000519589803
  error estimate for blocks of size 2^( 4) =       0.000534927948
  error estimate for blocks of size 2^( 5) =       0.000544371269
  error estimate for blocks of size 2^( 6) =       0.000548560355
  error estimate for blocks of size 2^( 7) =       0.000550111647

      target function =      -0.739184958841
              le_mean =     -22.662690849774
             les_mean =     514.055052496494
             stat err =       0.000544492805
             autocorr =       1.321959385643
   target nu stat err =       0.000544492805
   target dn stat err =       0.006717502723
      target stat err =       0.005457463639
              std dev =       0.669727429954
             le_variance =       0.448534830433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448531975494
                                         uncertainty =       0.007257387936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448531975494
                                         uncertainty =       0.007257387936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473568806
  error estimate for blocks of size 2^( 2) =       0.000497955578
  error estimate for blocks of size 2^( 3) =       0.000519589803
  error estimate for blocks of size 2^( 4) =       0.000534927947
  error estimate for blocks of size 2^( 5) =       0.000544371268
  error estimate for blocks of size 2^( 6) =       0.000548560354
  error estimate for blocks of size 2^( 7) =       0.000550111647

      target function =      -0.739184978723
              le_mean =     -22.662690849794
             les_mean =     514.055052472766
             stat err =       0.000544492804
             autocorr =       1.321959390623
   target nu stat err =       0.000544492804
   target dn stat err =       0.006717503200
      target stat err =       0.005457464313
              std dev =       0.669727427965
             le_variance =       0.448534827768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448531976828
                                         uncertainty =       0.007257387673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448531976828
                                         uncertainty =       0.007257387673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473568807
  error estimate for blocks of size 2^( 2) =       0.000497955578
  error estimate for blocks of size 2^( 3) =       0.000519589803
  error estimate for blocks of size 2^( 4) =       0.000534927948
  error estimate for blocks of size 2^( 5) =       0.000544371269
  error estimate for blocks of size 2^( 6) =       0.000548560354
  error estimate for blocks of size 2^( 7) =       0.000550111647

      target function =      -0.739184968791
              le_mean =     -22.662690849784
             les_mean =     514.055052484619
             stat err =       0.000544492804
             autocorr =       1.321959388139
   target nu stat err =       0.000544492804
   target dn stat err =       0.006717502961
      target stat err =       0.005457463976
              std dev =       0.669727428959
             le_variance =       0.448534829100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448531977994
                                         uncertainty =       0.007257387443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448531977994
                                         uncertainty =       0.007257387443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473568807
  error estimate for blocks of size 2^( 2) =       0.000497955579
  error estimate for blocks of size 2^( 3) =       0.000519589803
  error estimate for blocks of size 2^( 4) =       0.000534927948
  error estimate for blocks of size 2^( 5) =       0.000544371269
  error estimate for blocks of size 2^( 6) =       0.000548560355
  error estimate for blocks of size 2^( 7) =       0.000550111647

      target function =      -0.739184960086
              le_mean =     -22.662690849776
             les_mean =     514.055052495008
             stat err =       0.000544492805
             autocorr =       1.321959385952
   target nu stat err =       0.000544492805
   target dn stat err =       0.006717502753
      target stat err =       0.005457463681
              std dev =       0.669727429830
             le_variance =       0.448534830266


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739184958841        initial
     1.9722e+04     1.9722e+05             1.0889e-08        -0.739184978723  <--
     7.8886e+04     7.8886e+05             2.7223e-09        -0.739184968791
     3.1554e+05     3.1554e+06             6.8059e-10        -0.739184960086

*****************************************************************************
Applying the update for shift_i =   1.9722e+04     and shift_s =   1.9722e+05
*****************************************************************************

  Execution time = 4.4388e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011376e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946943e-02 3 1  ON 4
ci_006                 1.975952e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315491e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848116e-03 3 1  ON 10
ci_012                -9.084251e-03 3 1  ON 11
ci_013                 8.365521e-03 3 1  ON 12
ci_014                 9.295524e-03 3 1  ON 13
ci_015                 9.498572e-03 3 1  ON 14
ci_016                 9.360219e-03 3 1  ON 15
ci_017                 8.491233e-03 3 1  ON 16
ci_018                 8.265892e-03 3 1  ON 17
ci_019                -1.266070e-03 3 1  ON 18
ci_020                -1.589632e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183627e-02 3 1  ON 21
ci_023                 4.842577e-03 3 1  ON 22
ci_024                 4.910749e-03 3 1  ON 23
ci_025                 1.153146e-02 3 1  ON 24
ci_026                 1.153299e-02 3 1  ON 25
ci_027                 6.476737e-03 3 1  ON 26
ci_028                 6.177190e-03 3 1  ON 27
ci_029                -5.031204e-03 3 1  ON 28
ci_030                -4.114606e-03 3 1  ON 29
ci_031                 3.416234e-03 3 1  ON 30
ci_032                 4.671953e-03 3 1  ON 31
ci_033                 2.350426e-03 3 1  ON 32
ci_034                 4.107255e-03 3 1  ON 33
ci_035                 1.724188e-03 3 1  ON 34
ci_036                 2.137221e-03 3 1  ON 35
ci_037                 3.491715e-03 3 1  ON 36
ci_038                 3.699689e-03 3 1  ON 37
ci_039                 4.602357e-03 3 1  ON 38
ci_040                 4.919611e-03 3 1  ON 39
ci_041                 2.955497e-03 3 1  ON 40
ci_042                 2.734131e-03 3 1  ON 41
ci_043                 2.939779e-03 3 1  ON 42
ci_044                 3.206467e-03 3 1  ON 43
ci_045                 2.473972e-03 3 1  ON 44
ci_046                 2.734757e-03 3 1  ON 45
ci_047                -1.006018e-03 3 1  ON 46
ci_048                -8.452237e-04 3 1  ON 47
ci_049                 7.814764e-04 3 1  ON 48
ci_050                 9.944700e-04 3 1  ON 49
ci_051                -3.372404e-04 3 1  ON 50
ci_052                -1.211978e-03 3 1  ON 51
ci_053                -2.460121e-03 3 1  ON 52
ci_054                -2.689193e-03 3 1  ON 53
ci_055                -1.790036e-03 3 1  ON 54
ci_056                -1.964166e-03 3 1  ON 55
ci_057                -1.319598e-03 3 1  ON 56
ci_058                -9.958063e-04 3 1  ON 57
ci_059                -5.220755e-04 3 1  ON 58
ci_060                -7.411316e-04 3 1  ON 59
ci_061                 6.136484e-06 3 1  ON 60
ci_062                -9.066595e-04 3 1  ON 61
ci_063                -8.878650e-04 3 1  ON 62
ci_064                -5.045525e-04 3 1  ON 63
ci_065                -1.365557e-03 3 1  ON 64
ci_066                -1.881520e-03 3 1  ON 65
ci_067                -1.823703e-03 3 1  ON 66
ci_068                -1.481431e-03 3 1  ON 67
ci_069                -5.505313e-04 3 1  ON 68
ci_070                -4.210559e-04 3 1  ON 69
ci_071                -2.064016e-03 3 1  ON 70
ci_072                -1.991145e-03 3 1  ON 71
ci_073                 1.593614e-04 3 1  ON 72
ci_074                 1.763280e-04 3 1  ON 73
ci_075                 1.711839e-04 3 1  ON 74
ci_076                 7.919524e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5858e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2667e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7649
    reference variance = 0.542047
====================================================
  Execution time = 2.6557e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5279e-01
  Total weights = 1.955246726e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439459164779
                                         uncertainty =       0.002047954800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439459164779
                                         uncertainty =       0.002047954800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468726284
  error estimate for blocks of size 2^( 2) =       0.000492716887
  error estimate for blocks of size 2^( 3) =       0.000514776917
  error estimate for blocks of size 2^( 4) =       0.000529555337
  error estimate for blocks of size 2^( 5) =       0.000540095658
  error estimate for blocks of size 2^( 6) =       0.000546923947
  error estimate for blocks of size 2^( 7) =       0.000549079892

      target function =      -0.743023712111
              le_mean =     -22.662019302567
             les_mean =     514.019909799178
             stat err =       0.000541413709
             autocorr =       1.334196758317
   target nu stat err =       0.000541413709
   target dn stat err =       0.004274557802
      target stat err =       0.003534704035
              std dev =       0.662879068028
             le_variance =       0.439408658830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266201930257e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.9304e+03, overlap shift 4.9304e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743039602142       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743039611111       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743039612452       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743039612565       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743039612597       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743039612620       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743039612630       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743039612638       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743039612640       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743039612643       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743039612648       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743039612638       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.9304e+03 is 4.837403e-08

solving harmonic davidson linear method for identity shift 1.9722e+04, overlap shift 1.9722e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743039602142       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743039604384       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743039604720       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743039604751       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743039604742       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743039604776       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743039604778       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743039604778       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743039604707       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743039604738       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743039604827       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743039604779       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.9722e+04 is 1.209358e-08

solving harmonic davidson linear method for identity shift 7.8886e+04, overlap shift 7.8886e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743039602142       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743039602703       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743039602786       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743039602793       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743039602796       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743039602672       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743039602824       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743039602777       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743039603030       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743039602597       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743039602748       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743039602774       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 7.8886e+04 is 3.023400e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1370e+01
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011375e-02 3 1  ON 2
ci_004                -5.098545e-02 3 1  ON 3
ci_005                 1.946943e-02 3 1  ON 4
ci_006                 1.975951e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315490e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848109e-03 3 1  ON 10
ci_012                -9.084248e-03 3 1  ON 11
ci_013                 8.365515e-03 3 1  ON 12
ci_014                 9.295517e-03 3 1  ON 13
ci_015                 9.498562e-03 3 1  ON 14
ci_016                 9.360210e-03 3 1  ON 15
ci_017                 8.491232e-03 3 1  ON 16
ci_018                 8.265887e-03 3 1  ON 17
ci_019                -1.266082e-03 3 1  ON 18
ci_020                -1.589638e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183627e-02 3 1  ON 21
ci_023                 4.842575e-03 3 1  ON 22
ci_024                 4.910747e-03 3 1  ON 23
ci_025                 1.153148e-02 3 1  ON 24
ci_026                 1.153300e-02 3 1  ON 25
ci_027                 6.476734e-03 3 1  ON 26
ci_028                 6.177191e-03 3 1  ON 27
ci_029                -5.031202e-03 3 1  ON 28
ci_030                -4.114604e-03 3 1  ON 29
ci_031                 3.416246e-03 3 1  ON 30
ci_032                 4.671954e-03 3 1  ON 31
ci_033                 2.350431e-03 3 1  ON 32
ci_034                 4.107253e-03 3 1  ON 33
ci_035                 1.724189e-03 3 1  ON 34
ci_036                 2.137221e-03 3 1  ON 35
ci_037                 3.491715e-03 3 1  ON 36
ci_038                 3.699685e-03 3 1  ON 37
ci_039                 4.602355e-03 3 1  ON 38
ci_040                 4.919608e-03 3 1  ON 39
ci_041                 2.955490e-03 3 1  ON 40
ci_042                 2.734132e-03 3 1  ON 41
ci_043                 2.939774e-03 3 1  ON 42
ci_044                 3.206464e-03 3 1  ON 43
ci_045                 2.473975e-03 3 1  ON 44
ci_046                 2.734760e-03 3 1  ON 45
ci_047                -1.006019e-03 3 1  ON 46
ci_048                -8.452240e-04 3 1  ON 47
ci_049                 7.814731e-04 3 1  ON 48
ci_050                 9.944753e-04 3 1  ON 49
ci_051                -3.372407e-04 3 1  ON 50
ci_052                -1.211978e-03 3 1  ON 51
ci_053                -2.460130e-03 3 1  ON 52
ci_054                -2.689192e-03 3 1  ON 53
ci_055                -1.790035e-03 3 1  ON 54
ci_056                -1.964166e-03 3 1  ON 55
ci_057                -1.319587e-03 3 1  ON 56
ci_058                -9.958044e-04 3 1  ON 57
ci_059                -5.220716e-04 3 1  ON 58
ci_060                -7.411279e-04 3 1  ON 59
ci_061                 6.138096e-06 3 1  ON 60
ci_062                -9.066553e-04 3 1  ON 61
ci_063                -8.878574e-04 3 1  ON 62
ci_064                -5.045561e-04 3 1  ON 63
ci_065                -1.365560e-03 3 1  ON 64
ci_066                -1.881520e-03 3 1  ON 65
ci_067                -1.823707e-03 3 1  ON 66
ci_068                -1.481431e-03 3 1  ON 67
ci_069                -5.505277e-04 3 1  ON 68
ci_070                -4.210577e-04 3 1  ON 69
ci_071                -2.064016e-03 3 1  ON 70
ci_072                -1.991143e-03 3 1  ON 71
ci_073                 1.593567e-04 3 1  ON 72
ci_074                 1.763285e-04 3 1  ON 73
ci_075                 1.711877e-04 3 1  ON 74
ci_076                 7.919494e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.7471
    reference variance = 0.500495
====================================================
  Execution time = 2.6058e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5269e-01
  Total weights = 1.9554e+06
  Execution time = 3.6461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439966228992
                                         uncertainty =       0.001738893975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439966228992
                                         uncertainty =       0.001738893975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469065953
  error estimate for blocks of size 2^( 2) =       0.000493372036
  error estimate for blocks of size 2^( 3) =       0.000515436860
  error estimate for blocks of size 2^( 4) =       0.000530899760
  error estimate for blocks of size 2^( 5) =       0.000541324044
  error estimate for blocks of size 2^( 6) =       0.000546518297
  error estimate for blocks of size 2^( 7) =       0.000548385703

      target function =      -0.743108911416
              le_mean =     -22.662470290994
             les_mean =     514.040254213438
             stat err =       0.000541781951
             autocorr =       1.334078067237
   target nu stat err =       0.000541781951
   target dn stat err =       0.003789607080
      target stat err =       0.003148581985
              std dev =       0.663359431758
             le_variance =       0.440045735702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439966223531
                                         uncertainty =       0.001738893252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439966223531
                                         uncertainty =       0.001738893252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469065950
  error estimate for blocks of size 2^( 2) =       0.000493372035
  error estimate for blocks of size 2^( 3) =       0.000515436859
  error estimate for blocks of size 2^( 4) =       0.000530899760
  error estimate for blocks of size 2^( 5) =       0.000541324043
  error estimate for blocks of size 2^( 6) =       0.000546518295
  error estimate for blocks of size 2^( 7) =       0.000548385700

      target function =      -0.743108876978
              le_mean =     -22.662470290550
             les_mean =     514.040254235040
             stat err =       0.000541781949
             autocorr =       1.334078076998
   target nu stat err =       0.000541781949
   target dn stat err =       0.003789663443
      target stat err =       0.003148626855
              std dev =       0.663359427602
             le_variance =       0.440045730189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439966226261
                                         uncertainty =       0.001738893614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439966226261
                                         uncertainty =       0.001738893614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469065951
  error estimate for blocks of size 2^( 2) =       0.000493372035
  error estimate for blocks of size 2^( 3) =       0.000515436860
  error estimate for blocks of size 2^( 4) =       0.000530899760
  error estimate for blocks of size 2^( 5) =       0.000541324043
  error estimate for blocks of size 2^( 6) =       0.000546518296
  error estimate for blocks of size 2^( 7) =       0.000548385701

      target function =      -0.743108894200
              le_mean =     -22.662470290772
             les_mean =     514.040254224235
             stat err =       0.000541781950
             autocorr =       1.334078072121
   target nu stat err =       0.000541781950
   target dn stat err =       0.003789635261
      target stat err =       0.003148604419
              std dev =       0.663359429680
             le_variance =       0.440045732945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439966228651
                                         uncertainty =       0.001738893930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439966228651
                                         uncertainty =       0.001738893930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469065952
  error estimate for blocks of size 2^( 2) =       0.000493372036
  error estimate for blocks of size 2^( 3) =       0.000515436860
  error estimate for blocks of size 2^( 4) =       0.000530899760
  error estimate for blocks of size 2^( 5) =       0.000541324044
  error estimate for blocks of size 2^( 6) =       0.000546518297
  error estimate for blocks of size 2^( 7) =       0.000548385702

      target function =      -0.743108909265
              le_mean =     -22.662470290967
             les_mean =     514.040254214787
             stat err =       0.000541781951
             autocorr =       1.334078067847
   target nu stat err =       0.000541781951
   target dn stat err =       0.003789610603
      target stat err =       0.003148584789
              std dev =       0.663359431498
             le_variance =       0.440045735358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743108911416        initial  <--
     4.9304e+03     4.9304e+04             4.8374e-08        -0.743108876978
     1.9722e+04     1.9722e+05             1.2094e-08        -0.743108894200
     7.8886e+04     7.8886e+05             3.0234e-09        -0.743108909265

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2215
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011376e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946943e-02 3 1  ON 4
ci_006                 1.975952e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315491e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848116e-03 3 1  ON 10
ci_012                -9.084251e-03 3 1  ON 11
ci_013                 8.365521e-03 3 1  ON 12
ci_014                 9.295524e-03 3 1  ON 13
ci_015                 9.498572e-03 3 1  ON 14
ci_016                 9.360219e-03 3 1  ON 15
ci_017                 8.491233e-03 3 1  ON 16
ci_018                 8.265892e-03 3 1  ON 17
ci_019                -1.266070e-03 3 1  ON 18
ci_020                -1.589632e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183627e-02 3 1  ON 21
ci_023                 4.842577e-03 3 1  ON 22
ci_024                 4.910749e-03 3 1  ON 23
ci_025                 1.153146e-02 3 1  ON 24
ci_026                 1.153299e-02 3 1  ON 25
ci_027                 6.476737e-03 3 1  ON 26
ci_028                 6.177190e-03 3 1  ON 27
ci_029                -5.031204e-03 3 1  ON 28
ci_030                -4.114606e-03 3 1  ON 29
ci_031                 3.416234e-03 3 1  ON 30
ci_032                 4.671953e-03 3 1  ON 31
ci_033                 2.350426e-03 3 1  ON 32
ci_034                 4.107255e-03 3 1  ON 33
ci_035                 1.724188e-03 3 1  ON 34
ci_036                 2.137221e-03 3 1  ON 35
ci_037                 3.491715e-03 3 1  ON 36
ci_038                 3.699689e-03 3 1  ON 37
ci_039                 4.602357e-03 3 1  ON 38
ci_040                 4.919611e-03 3 1  ON 39
ci_041                 2.955497e-03 3 1  ON 40
ci_042                 2.734131e-03 3 1  ON 41
ci_043                 2.939779e-03 3 1  ON 42
ci_044                 3.206467e-03 3 1  ON 43
ci_045                 2.473972e-03 3 1  ON 44
ci_046                 2.734757e-03 3 1  ON 45
ci_047                -1.006018e-03 3 1  ON 46
ci_048                -8.452237e-04 3 1  ON 47
ci_049                 7.814764e-04 3 1  ON 48
ci_050                 9.944700e-04 3 1  ON 49
ci_051                -3.372404e-04 3 1  ON 50
ci_052                -1.211978e-03 3 1  ON 51
ci_053                -2.460121e-03 3 1  ON 52
ci_054                -2.689193e-03 3 1  ON 53
ci_055                -1.790036e-03 3 1  ON 54
ci_056                -1.964166e-03 3 1  ON 55
ci_057                -1.319598e-03 3 1  ON 56
ci_058                -9.958063e-04 3 1  ON 57
ci_059                -5.220755e-04 3 1  ON 58
ci_060                -7.411316e-04 3 1  ON 59
ci_061                 6.136484e-06 3 1  ON 60
ci_062                -9.066595e-04 3 1  ON 61
ci_063                -8.878650e-04 3 1  ON 62
ci_064                -5.045525e-04 3 1  ON 63
ci_065                -1.365557e-03 3 1  ON 64
ci_066                -1.881520e-03 3 1  ON 65
ci_067                -1.823703e-03 3 1  ON 66
ci_068                -1.481431e-03 3 1  ON 67
ci_069                -5.505313e-04 3 1  ON 68
ci_070                -4.210559e-04 3 1  ON 69
ci_071                -2.064016e-03 3 1  ON 70
ci_072                -1.991145e-03 3 1  ON 71
ci_073                 1.593614e-04 3 1  ON 72
ci_074                 1.763280e-04 3 1  ON 73
ci_075                 1.711839e-04 3 1  ON 74
ci_076                 7.919524e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5666e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.7226
    reference variance = 0.726178
====================================================
  Execution time = 2.6584e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4798e-01
  Total weights = 1.955207669e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720804007
                                         uncertainty =       0.001821444857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439720804007
                                         uncertainty =       0.001821444857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468889836
  error estimate for blocks of size 2^( 2) =       0.000493066092
  error estimate for blocks of size 2^( 3) =       0.000515562934
  error estimate for blocks of size 2^( 4) =       0.000531283081
  error estimate for blocks of size 2^( 5) =       0.000540853270
  error estimate for blocks of size 2^( 6) =       0.000546347058
  error estimate for blocks of size 2^( 7) =       0.000549826170

      target function =      -0.746975981220
              le_mean =     -22.662007402141
             les_mean =     514.014560956705
             stat err =       0.000542077395
             autocorr =       1.336536910092
   target nu stat err =       0.000542077395
   target dn stat err =       0.002432762668
      target stat err =       0.002091443406
              std dev =       0.663110364952
             le_variance =       0.439715356107


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266200740214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.9304e+04, overlap shift 4.9304e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746980807345       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746980807782       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746980807842       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746980807847       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746980807796       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746980807956       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746980807896       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746980807802       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746980807782       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746980807760       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746980807849       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.9304e+04 is 5.696979e-09

solving harmonic davidson linear method for identity shift 1.9722e+05, overlap shift 1.9722e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746980807345       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746980807454       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746980807469       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746980807470       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746980807280       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746980807453       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746980807794       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746980807418       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746980806984       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746980806922       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746980807129       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.9722e+05 is 1.424246e-09

solving harmonic davidson linear method for identity shift 7.8886e+05, overlap shift 7.8886e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746980807345       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746980807372       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746980807376       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746980807376       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746980807209       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746980806995       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746980808811       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746980807824       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746980807946       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746980807626       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746980807308       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 7.8886e+05 is 3.560615e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1368e+01
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011376e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946943e-02 3 1  ON 4
ci_006                 1.975952e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315491e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848115e-03 3 1  ON 10
ci_012                -9.084251e-03 3 1  ON 11
ci_013                 8.365521e-03 3 1  ON 12
ci_014                 9.295524e-03 3 1  ON 13
ci_015                 9.498572e-03 3 1  ON 14
ci_016                 9.360218e-03 3 1  ON 15
ci_017                 8.491233e-03 3 1  ON 16
ci_018                 8.265891e-03 3 1  ON 17
ci_019                -1.266071e-03 3 1  ON 18
ci_020                -1.589633e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183627e-02 3 1  ON 21
ci_023                 4.842577e-03 3 1  ON 22
ci_024                 4.910749e-03 3 1  ON 23
ci_025                 1.153146e-02 3 1  ON 24
ci_026                 1.153299e-02 3 1  ON 25
ci_027                 6.476737e-03 3 1  ON 26
ci_028                 6.177189e-03 3 1  ON 27
ci_029                -5.031204e-03 3 1  ON 28
ci_030                -4.114606e-03 3 1  ON 29
ci_031                 3.416235e-03 3 1  ON 30
ci_032                 4.671954e-03 3 1  ON 31
ci_033                 2.350426e-03 3 1  ON 32
ci_034                 4.107255e-03 3 1  ON 33
ci_035                 1.724188e-03 3 1  ON 34
ci_036                 2.137221e-03 3 1  ON 35
ci_037                 3.491715e-03 3 1  ON 36
ci_038                 3.699689e-03 3 1  ON 37
ci_039                 4.602357e-03 3 1  ON 38
ci_040                 4.919611e-03 3 1  ON 39
ci_041                 2.955497e-03 3 1  ON 40
ci_042                 2.734131e-03 3 1  ON 41
ci_043                 2.939779e-03 3 1  ON 42
ci_044                 3.206467e-03 3 1  ON 43
ci_045                 2.473972e-03 3 1  ON 44
ci_046                 2.734757e-03 3 1  ON 45
ci_047                -1.006018e-03 3 1  ON 46
ci_048                -8.452237e-04 3 1  ON 47
ci_049                 7.814766e-04 3 1  ON 48
ci_050                 9.944697e-04 3 1  ON 49
ci_051                -3.372405e-04 3 1  ON 50
ci_052                -1.211978e-03 3 1  ON 51
ci_053                -2.460121e-03 3 1  ON 52
ci_054                -2.689193e-03 3 1  ON 53
ci_055                -1.790036e-03 3 1  ON 54
ci_056                -1.964166e-03 3 1  ON 55
ci_057                -1.319598e-03 3 1  ON 56
ci_058                -9.958066e-04 3 1  ON 57
ci_059                -5.220754e-04 3 1  ON 58
ci_060                -7.411315e-04 3 1  ON 59
ci_061                 6.136717e-06 3 1  ON 60
ci_062                -9.066594e-04 3 1  ON 61
ci_063                -8.878645e-04 3 1  ON 62
ci_064                -5.045527e-04 3 1  ON 63
ci_065                -1.365557e-03 3 1  ON 64
ci_066                -1.881520e-03 3 1  ON 65
ci_067                -1.823702e-03 3 1  ON 66
ci_068                -1.481431e-03 3 1  ON 67
ci_069                -5.505314e-04 3 1  ON 68
ci_070                -4.210559e-04 3 1  ON 69
ci_071                -2.064016e-03 3 1  ON 70
ci_072                -1.991145e-03 3 1  ON 71
ci_073                 1.593613e-04 3 1  ON 72
ci_074                 1.763280e-04 3 1  ON 73
ci_075                 1.711838e-04 3 1  ON 74
ci_076                 7.919523e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.6833
    reference variance = 0.218042
====================================================
  Execution time = 2.6098e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.6255e-01
  Total weights = 1.9553e+06
  Execution time = 3.6539e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444558040563
                                         uncertainty =       0.002627779087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444558040563
                                         uncertainty =       0.002627779087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471546214
  error estimate for blocks of size 2^( 2) =       0.000495446746
  error estimate for blocks of size 2^( 3) =       0.000516892796
  error estimate for blocks of size 2^( 4) =       0.000532716177
  error estimate for blocks of size 2^( 5) =       0.000540452557
  error estimate for blocks of size 2^( 6) =       0.000546888978
  error estimate for blocks of size 2^( 7) =       0.000547328762

      target function =      -0.735116397060
              le_mean =     -22.660805234018
             les_mean =     513.974641110271
             stat err =       0.000541846619
             autocorr =       1.320396028497
   target nu stat err =       0.000541846619
   target dn stat err =       0.008255173063
      target stat err =       0.006601562792
              std dev =       0.666867051801
             le_variance =       0.444711664777

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444558040406
                                         uncertainty =       0.002627779527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444558040406
                                         uncertainty =       0.002627779527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471546214
  error estimate for blocks of size 2^( 2) =       0.000495446746
  error estimate for blocks of size 2^( 3) =       0.000516892796
  error estimate for blocks of size 2^( 4) =       0.000532716178
  error estimate for blocks of size 2^( 5) =       0.000540452557
  error estimate for blocks of size 2^( 6) =       0.000546888978
  error estimate for blocks of size 2^( 7) =       0.000547328762

      target function =      -0.735116420229
              le_mean =     -22.660805234027
             les_mean =     513.974641081587
             stat err =       0.000541846618
             autocorr =       1.320396028720
   target nu stat err =       0.000541846618
   target dn stat err =       0.008255171792
      target stat err =       0.006601562198
              std dev =       0.666867051687
             le_variance =       0.444711664625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444558040484
                                         uncertainty =       0.002627779307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444558040484
                                         uncertainty =       0.002627779307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471546214
  error estimate for blocks of size 2^( 2) =       0.000495446746
  error estimate for blocks of size 2^( 3) =       0.000516892796
  error estimate for blocks of size 2^( 4) =       0.000532716178
  error estimate for blocks of size 2^( 5) =       0.000540452557
  error estimate for blocks of size 2^( 6) =       0.000546888978
  error estimate for blocks of size 2^( 7) =       0.000547328762

      target function =      -0.735116408645
              le_mean =     -22.660805234022
             les_mean =     513.974641095928
             stat err =       0.000541846618
             autocorr =       1.320396028608
   target nu stat err =       0.000541846618
   target dn stat err =       0.008255172427
      target stat err =       0.006601562495
              std dev =       0.666867051744
             le_variance =       0.444711664701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444558040553
                                         uncertainty =       0.002627779115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444558040553
                                         uncertainty =       0.002627779115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471546214
  error estimate for blocks of size 2^( 2) =       0.000495446746
  error estimate for blocks of size 2^( 3) =       0.000516892796
  error estimate for blocks of size 2^( 4) =       0.000532716177
  error estimate for blocks of size 2^( 5) =       0.000540452557
  error estimate for blocks of size 2^( 6) =       0.000546888978
  error estimate for blocks of size 2^( 7) =       0.000547328762

      target function =      -0.735116398508
              le_mean =     -22.660805234019
             les_mean =     513.974641108478
             stat err =       0.000541846619
             autocorr =       1.320396028510
   target nu stat err =       0.000541846619
   target dn stat err =       0.008255172984
      target stat err =       0.006601562755
              std dev =       0.666867051794
             le_variance =       0.444711664768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.735116397060        initial
     4.9304e+04     4.9304e+05             5.6970e-09        -0.735116420229  <--
     1.9722e+05     1.9722e+06             1.4242e-09        -0.735116408645
     7.8886e+05     7.8886e+06             3.5606e-10        -0.735116398508

*****************************************************************************
Applying the update for shift_i =   4.9304e+04     and shift_s =   4.9304e+05
*****************************************************************************

  Execution time = 4.6129e+01
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011375e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946943e-02 3 1  ON 4
ci_006                 1.975952e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315490e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848114e-03 3 1  ON 10
ci_012                -9.084250e-03 3 1  ON 11
ci_013                 8.365520e-03 3 1  ON 12
ci_014                 9.295524e-03 3 1  ON 13
ci_015                 9.498570e-03 3 1  ON 14
ci_016                 9.360216e-03 3 1  ON 15
ci_017                 8.491232e-03 3 1  ON 16
ci_018                 8.265891e-03 3 1  ON 17
ci_019                -1.266073e-03 3 1  ON 18
ci_020                -1.589638e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183627e-02 3 1  ON 21
ci_023                 4.842578e-03 3 1  ON 22
ci_024                 4.910750e-03 3 1  ON 23
ci_025                 1.153147e-02 3 1  ON 24
ci_026                 1.153299e-02 3 1  ON 25
ci_027                 6.476736e-03 3 1  ON 26
ci_028                 6.177188e-03 3 1  ON 27
ci_029                -5.031203e-03 3 1  ON 28
ci_030                -4.114606e-03 3 1  ON 29
ci_031                 3.416239e-03 3 1  ON 30
ci_032                 4.671955e-03 3 1  ON 31
ci_033                 2.350425e-03 3 1  ON 32
ci_034                 4.107253e-03 3 1  ON 33
ci_035                 1.724189e-03 3 1  ON 34
ci_036                 2.137221e-03 3 1  ON 35
ci_037                 3.491716e-03 3 1  ON 36
ci_038                 3.699689e-03 3 1  ON 37
ci_039                 4.602357e-03 3 1  ON 38
ci_040                 4.919612e-03 3 1  ON 39
ci_041                 2.955497e-03 3 1  ON 40
ci_042                 2.734131e-03 3 1  ON 41
ci_043                 2.939778e-03 3 1  ON 42
ci_044                 3.206467e-03 3 1  ON 43
ci_045                 2.473972e-03 3 1  ON 44
ci_046                 2.734757e-03 3 1  ON 45
ci_047                -1.006018e-03 3 1  ON 46
ci_048                -8.452237e-04 3 1  ON 47
ci_049                 7.814772e-04 3 1  ON 48
ci_050                 9.944686e-04 3 1  ON 49
ci_051                -3.372407e-04 3 1  ON 50
ci_052                -1.211977e-03 3 1  ON 51
ci_053                -2.460120e-03 3 1  ON 52
ci_054                -2.689194e-03 3 1  ON 53
ci_055                -1.790035e-03 3 1  ON 54
ci_056                -1.964165e-03 3 1  ON 55
ci_057                -1.319597e-03 3 1  ON 56
ci_058                -9.958074e-04 3 1  ON 57
ci_059                -5.220752e-04 3 1  ON 58
ci_060                -7.411309e-04 3 1  ON 59
ci_061                 6.137417e-06 3 1  ON 60
ci_062                -9.066590e-04 3 1  ON 61
ci_063                -8.878629e-04 3 1  ON 62
ci_064                -5.045534e-04 3 1  ON 63
ci_065                -1.365558e-03 3 1  ON 64
ci_066                -1.881520e-03 3 1  ON 65
ci_067                -1.823701e-03 3 1  ON 66
ci_068                -1.481432e-03 3 1  ON 67
ci_069                -5.505315e-04 3 1  ON 68
ci_070                -4.210557e-04 3 1  ON 69
ci_071                -2.064016e-03 3 1  ON 70
ci_072                -1.991145e-03 3 1  ON 71
ci_073                 1.593611e-04 3 1  ON 72
ci_074                 1.763280e-04 3 1  ON 73
ci_075                 1.711834e-04 3 1  ON 74
ci_076                 7.919517e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7527e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.748
    reference variance = 0.30706
====================================================
  Execution time = 2.6593e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4759e-01
  Total weights = 1.955474827e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439804404784
                                         uncertainty =       0.002403624531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439804404784
                                         uncertainty =       0.002403624531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468960730
  error estimate for blocks of size 2^( 2) =       0.000492901161
  error estimate for blocks of size 2^( 3) =       0.000515497768
  error estimate for blocks of size 2^( 4) =       0.000531677116
  error estimate for blocks of size 2^( 5) =       0.000541594558
  error estimate for blocks of size 2^( 6) =       0.000547122933
  error estimate for blocks of size 2^( 7) =       0.000551014556

      target function =      -0.747300550654
              le_mean =     -22.662273764250
             les_mean =     514.026240791842
             stat err =       0.000542852291
             autocorr =       1.339955558521
   target nu stat err =       0.000542852291
   target dn stat err =       0.002981677362
      target stat err =       0.002531434518
              std dev =       0.663210625204
             le_variance =       0.439848333383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266227376425e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2326e+04, overlap shift 1.2326e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747308135598       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747308137767       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747308138263       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747308138302       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747308138315       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747308138330       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747308138308       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747308138318       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747308138318       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747308138318       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2326e+04 is 2.645269e-08

solving harmonic davidson linear method for identity shift 4.9304e+04, overlap shift 4.9304e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747308135598       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747308136140       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747308136264       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747308136274       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747308136277       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747308136277       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747308136278       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747308136161       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747308136278       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747308136278       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.9304e+04 is 6.613188e-09

solving harmonic davidson linear method for identity shift 1.9722e+05, overlap shift 1.9722e+06 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747308135598       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747308135734       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747308135765       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747308135767       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747308135793       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747308135768       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747308135882       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747308135245       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747308135768       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747308135768       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.9722e+05 is 1.653298e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.428665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1358e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011375e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946943e-02 3 1  ON 4
ci_006                 1.975952e-02 3 1  ON 5
ci_007                 1.473301e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315490e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848113e-03 3 1  ON 10
ci_012                -9.084249e-03 3 1  ON 11
ci_013                 8.365519e-03 3 1  ON 12
ci_014                 9.295524e-03 3 1  ON 13
ci_015                 9.498569e-03 3 1  ON 14
ci_016                 9.360215e-03 3 1  ON 15
ci_017                 8.491231e-03 3 1  ON 16
ci_018                 8.265891e-03 3 1  ON 17
ci_019                -1.266080e-03 3 1  ON 18
ci_020                -1.589643e-03 3 1  ON 19
ci_021                -1.182149e-02 3 1  ON 20
ci_022                -1.183627e-02 3 1  ON 21
ci_023                 4.842578e-03 3 1  ON 22
ci_024                 4.910749e-03 3 1  ON 23
ci_025                 1.153147e-02 3 1  ON 24
ci_026                 1.153300e-02 3 1  ON 25
ci_027                 6.476736e-03 3 1  ON 26
ci_028                 6.177189e-03 3 1  ON 27
ci_029                -5.031202e-03 3 1  ON 28
ci_030                -4.114605e-03 3 1  ON 29
ci_031                 3.416242e-03 3 1  ON 30
ci_032                 4.671959e-03 3 1  ON 31
ci_033                 2.350427e-03 3 1  ON 32
ci_034                 4.107251e-03 3 1  ON 33
ci_035                 1.724189e-03 3 1  ON 34
ci_036                 2.137220e-03 3 1  ON 35
ci_037                 3.491714e-03 3 1  ON 36
ci_038                 3.699689e-03 3 1  ON 37
ci_039                 4.602356e-03 3 1  ON 38
ci_040                 4.919610e-03 3 1  ON 39
ci_041                 2.955497e-03 3 1  ON 40
ci_042                 2.734131e-03 3 1  ON 41
ci_043                 2.939777e-03 3 1  ON 42
ci_044                 3.206468e-03 3 1  ON 43
ci_045                 2.473972e-03 3 1  ON 44
ci_046                 2.734756e-03 3 1  ON 45
ci_047                -1.006018e-03 3 1  ON 46
ci_048                -8.452242e-04 3 1  ON 47
ci_049                 7.814766e-04 3 1  ON 48
ci_050                 9.944688e-04 3 1  ON 49
ci_051                -3.372419e-04 3 1  ON 50
ci_052                -1.211976e-03 3 1  ON 51
ci_053                -2.460120e-03 3 1  ON 52
ci_054                -2.689194e-03 3 1  ON 53
ci_055                -1.790034e-03 3 1  ON 54
ci_056                -1.964166e-03 3 1  ON 55
ci_057                -1.319597e-03 3 1  ON 56
ci_058                -9.958086e-04 3 1  ON 57
ci_059                -5.220760e-04 3 1  ON 58
ci_060                -7.411295e-04 3 1  ON 59
ci_061                 6.135658e-06 3 1  ON 60
ci_062                -9.066596e-04 3 1  ON 61
ci_063                -8.878626e-04 3 1  ON 62
ci_064                -5.045548e-04 3 1  ON 63
ci_065                -1.365558e-03 3 1  ON 64
ci_066                -1.881521e-03 3 1  ON 65
ci_067                -1.823701e-03 3 1  ON 66
ci_068                -1.481432e-03 3 1  ON 67
ci_069                -5.505317e-04 3 1  ON 68
ci_070                -4.210559e-04 3 1  ON 69
ci_071                -2.064015e-03 3 1  ON 70
ci_072                -1.991145e-03 3 1  ON 71
ci_073                 1.593602e-04 3 1  ON 72
ci_074                 1.763297e-04 3 1  ON 73
ci_075                 1.711831e-04 3 1  ON 74
ci_076                 7.919525e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.6133
    reference variance = 0.328426
====================================================
  Execution time = 2.8174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5026e-01
  Total weights = 1.9551e+06
  Execution time = 3.6529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441259351891
                                         uncertainty =       0.002134833896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441259351891
                                         uncertainty =       0.002134833896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469718588
  error estimate for blocks of size 2^( 2) =       0.000493398327
  error estimate for blocks of size 2^( 3) =       0.000515137869
  error estimate for blocks of size 2^( 4) =       0.000531077972
  error estimate for blocks of size 2^( 5) =       0.000540056566
  error estimate for blocks of size 2^( 6) =       0.000543984753
  error estimate for blocks of size 2^( 7) =       0.000546337979

      target function =      -0.745110778826
              le_mean =     -22.662772567013
             les_mean =     514.051518848650
             stat err =       0.000540364318
             autocorr =       1.323420426464
   target nu stat err =       0.000540364318
   target dn stat err =       0.002717013924
      target stat err =       0.002307766833
              std dev =       0.664282397104
             le_variance =       0.441271103102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441259347261
                                         uncertainty =       0.002134833694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441259347261
                                         uncertainty =       0.002134833694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469718585
  error estimate for blocks of size 2^( 2) =       0.000493398325
  error estimate for blocks of size 2^( 3) =       0.000515137867
  error estimate for blocks of size 2^( 4) =       0.000531077970
  error estimate for blocks of size 2^( 5) =       0.000540056564
  error estimate for blocks of size 2^( 6) =       0.000543984751
  error estimate for blocks of size 2^( 7) =       0.000546337977

      target function =      -0.745110852251
              le_mean =     -22.662772567006
             les_mean =     514.051518758874
             stat err =       0.000540364316
             autocorr =       1.323420430982
   target nu stat err =       0.000540364316
   target dn stat err =       0.002717012003
      target stat err =       0.002307765749
              std dev =       0.664282393581
             le_variance =       0.441271098422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441259349576
                                         uncertainty =       0.002134833795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441259349576
                                         uncertainty =       0.002134833795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469718586
  error estimate for blocks of size 2^( 2) =       0.000493398326
  error estimate for blocks of size 2^( 3) =       0.000515137868
  error estimate for blocks of size 2^( 4) =       0.000531077971
  error estimate for blocks of size 2^( 5) =       0.000540056565
  error estimate for blocks of size 2^( 6) =       0.000543984752
  error estimate for blocks of size 2^( 7) =       0.000546337978

      target function =      -0.745110815567
              le_mean =     -22.662772567010
             les_mean =     514.051518803727
             stat err =       0.000540364317
             autocorr =       1.323420428717
   target nu stat err =       0.000540364317
   target dn stat err =       0.002717012962
      target stat err =       0.002307766290
              std dev =       0.664282395343
             le_variance =       0.441271100762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441259351602
                                         uncertainty =       0.002134833884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441259351602
                                         uncertainty =       0.002134833884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469718587
  error estimate for blocks of size 2^( 2) =       0.000493398327
  error estimate for blocks of size 2^( 3) =       0.000515137869
  error estimate for blocks of size 2^( 4) =       0.000531077972
  error estimate for blocks of size 2^( 5) =       0.000540056566
  error estimate for blocks of size 2^( 6) =       0.000543984753
  error estimate for blocks of size 2^( 7) =       0.000546337979

      target function =      -0.745110783422
              le_mean =     -22.662772567013
             les_mean =     514.051518843030
             stat err =       0.000540364317
             autocorr =       1.323420426749
   target nu stat err =       0.000540364317
   target dn stat err =       0.002717013803
      target stat err =       0.002307766765
              std dev =       0.664282396884
             le_variance =       0.441271102810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745110778826        initial
     1.2326e+04     1.2326e+05             2.6453e-08        -0.745110852251  <--
     4.9304e+04     4.9304e+05             6.6132e-09        -0.745110815567
     1.9722e+05     1.9722e+06             1.6533e-09        -0.745110783422

*****************************************************************************
Applying the update for shift_i =   1.2326e+04     and shift_s =   1.2326e+05
*****************************************************************************

  Execution time = 4.6368e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011375e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946942e-02 3 1  ON 4
ci_006                 1.975951e-02 3 1  ON 5
ci_007                 1.473300e-02 3 1  ON 6
ci_008                 1.549252e-02 3 1  ON 7
ci_009                -1.315490e-02 3 1  ON 8
ci_010                -1.205375e-02 3 1  ON 9
ci_011                -9.848109e-03 3 1  ON 10
ci_012                -9.084247e-03 3 1  ON 11
ci_013                 8.365513e-03 3 1  ON 12
ci_014                 9.295522e-03 3 1  ON 13
ci_015                 9.498565e-03 3 1  ON 14
ci_016                 9.360211e-03 3 1  ON 15
ci_017                 8.491227e-03 3 1  ON 16
ci_018                 8.265891e-03 3 1  ON 17
ci_019                -1.266100e-03 3 1  ON 18
ci_020                -1.589658e-03 3 1  ON 19
ci_021                -1.182150e-02 3 1  ON 20
ci_022                -1.183628e-02 3 1  ON 21
ci_023                 4.842578e-03 3 1  ON 22
ci_024                 4.910749e-03 3 1  ON 23
ci_025                 1.153148e-02 3 1  ON 24
ci_026                 1.153300e-02 3 1  ON 25
ci_027                 6.476735e-03 3 1  ON 26
ci_028                 6.177191e-03 3 1  ON 27
ci_029                -5.031201e-03 3 1  ON 28
ci_030                -4.114602e-03 3 1  ON 29
ci_031                 3.416252e-03 3 1  ON 30
ci_032                 4.671970e-03 3 1  ON 31
ci_033                 2.350433e-03 3 1  ON 32
ci_034                 4.107248e-03 3 1  ON 33
ci_035                 1.724189e-03 3 1  ON 34
ci_036                 2.137217e-03 3 1  ON 35
ci_037                 3.491708e-03 3 1  ON 36
ci_038                 3.699690e-03 3 1  ON 37
ci_039                 4.602355e-03 3 1  ON 38
ci_040                 4.919604e-03 3 1  ON 39
ci_041                 2.955496e-03 3 1  ON 40
ci_042                 2.734128e-03 3 1  ON 41
ci_043                 2.939776e-03 3 1  ON 42
ci_044                 3.206472e-03 3 1  ON 43
ci_045                 2.473973e-03 3 1  ON 44
ci_046                 2.734753e-03 3 1  ON 45
ci_047                -1.006019e-03 3 1  ON 46
ci_048                -8.452255e-04 3 1  ON 47
ci_049                 7.814748e-04 3 1  ON 48
ci_050                 9.944694e-04 3 1  ON 49
ci_051                -3.372456e-04 3 1  ON 50
ci_052                -1.211974e-03 3 1  ON 51
ci_053                -2.460121e-03 3 1  ON 52
ci_054                -2.689196e-03 3 1  ON 53
ci_055                -1.790031e-03 3 1  ON 54
ci_056                -1.964170e-03 3 1  ON 55
ci_057                -1.319596e-03 3 1  ON 56
ci_058                -9.958123e-04 3 1  ON 57
ci_059                -5.220785e-04 3 1  ON 58
ci_060                -7.411251e-04 3 1  ON 59
ci_061                 6.130381e-06 3 1  ON 60
ci_062                -9.066616e-04 3 1  ON 61
ci_063                -8.878615e-04 3 1  ON 62
ci_064                -5.045591e-04 3 1  ON 63
ci_065                -1.365559e-03 3 1  ON 64
ci_066                -1.881525e-03 3 1  ON 65
ci_067                -1.823703e-03 3 1  ON 66
ci_068                -1.481431e-03 3 1  ON 67
ci_069                -5.505325e-04 3 1  ON 68
ci_070                -4.210567e-04 3 1  ON 69
ci_071                -2.064014e-03 3 1  ON 70
ci_072                -1.991147e-03 3 1  ON 71
ci_073                 1.593574e-04 3 1  ON 72
ci_074                 1.763346e-04 3 1  ON 73
ci_075                 1.711823e-04 3 1  ON 74
ci_076                 7.919547e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2668e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.5664
    reference variance = 0.298225
====================================================
  Execution time = 2.6657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4691e-01
  Total weights = 1.954824710e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437343932989
                                         uncertainty =       0.001737017942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437343932989
                                         uncertainty =       0.001737017942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467594699
  error estimate for blocks of size 2^( 2) =       0.000492065811
  error estimate for blocks of size 2^( 3) =       0.000514359672
  error estimate for blocks of size 2^( 4) =       0.000530379130
  error estimate for blocks of size 2^( 5) =       0.000539534236
  error estimate for blocks of size 2^( 6) =       0.000544147312
  error estimate for blocks of size 2^( 7) =       0.000546505078

      target function =      -0.747852972039
              le_mean =     -22.661602475148
             les_mean =     513.995136906343
             stat err =       0.000540141439
             autocorr =       1.334368669420
   target nu stat err =       0.000540141439
   target dn stat err =       0.002555515083
      target stat err =       0.002191600668
              std dev =       0.661278764704
             le_variance =       0.437289604648


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266160247515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.0815e+03, overlap shift 3.0815e+04 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747858451083       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747858458745       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747858459984       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747858460139       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747858460171       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747858460180       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747858460205       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747858460214       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747858460221       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747858460223       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747858460214       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747858460218       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.0815e+03 is 6.824207e-08

solving harmonic davidson linear method for identity shift 1.2326e+04, overlap shift 1.2326e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747858451083       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747858452998       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747858453308       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747858453347       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747858453357       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747858453346       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747858453349       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747858453358       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747858453370       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747858453366       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747858453378       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747858453414       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2326e+04 is 1.706068e-08

solving harmonic davidson linear method for identity shift 4.9304e+04, overlap shift 4.9304e+05 and omega -2.3339e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747858451083       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747858451562       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747858451639       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747858451649       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747858451633       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747858451682       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747858451669       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747858451654       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747858451568       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747858451762       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747858451654       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747858451681       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.9304e+04 is 4.265180e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.433531 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1370e+01
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_001                -7.055656e-01 3 1  ON 0
ci_002                -7.029288e-01 3 1  ON 1
ci_003                -5.011375e-02 3 1  ON 2
ci_004                -5.098546e-02 3 1  ON 3
ci_005                 1.946942e-02 3 1  ON 4
ci_006                 1.975950e-02 3 1  ON 5
ci_007                 1.473300e-02 3 1  ON 6
ci_008                 1.549252e-02 3 1  ON 7
ci_009                -1.315490e-02 3 1  ON 8
ci_010                -1.205374e-02 3 1  ON 9
ci_011                -9.848099e-03 3 1  ON 10
ci_012                -9.084237e-03 3 1  ON 11
ci_013                 8.365507e-03 3 1  ON 12
ci_014                 9.295517e-03 3 1  ON 13
ci_015                 9.498558e-03 3 1  ON 14
ci_016                 9.360197e-03 3 1  ON 15
ci_017                 8.491234e-03 3 1  ON 16
ci_018                 8.265888e-03 3 1  ON 17
ci_019                -1.266115e-03 3 1  ON 18
ci_020                -1.589668e-03 3 1  ON 19
ci_021                -1.182150e-02 3 1  ON 20
ci_022                -1.183628e-02 3 1  ON 21
ci_023                 4.842577e-03 3 1  ON 22
ci_024                 4.910753e-03 3 1  ON 23
ci_025                 1.153148e-02 3 1  ON 24
ci_026                 1.153301e-02 3 1  ON 25
ci_027                 6.476733e-03 3 1  ON 26
ci_028                 6.177194e-03 3 1  ON 27
ci_029                -5.031195e-03 3 1  ON 28
ci_030                -4.114595e-03 3 1  ON 29
ci_031                 3.416269e-03 3 1  ON 30
ci_032                 4.671973e-03 3 1  ON 31
ci_033                 2.350439e-03 3 1  ON 32
ci_034                 4.107244e-03 3 1  ON 33
ci_035                 1.724190e-03 3 1  ON 34
ci_036                 2.137215e-03 3 1  ON 35
ci_037                 3.491705e-03 3 1  ON 36
ci_038                 3.699682e-03 3 1  ON 37
ci_039                 4.602355e-03 3 1  ON 38
ci_040                 4.919601e-03 3 1  ON 39
ci_041                 2.955500e-03 3 1  ON 40
ci_042                 2.734126e-03 3 1  ON 41
ci_043                 2.939775e-03 3 1  ON 42
ci_044                 3.206465e-03 3 1  ON 43
ci_045                 2.473974e-03 3 1  ON 44
ci_046                 2.734755e-03 3 1  ON 45
ci_047                -1.006013e-03 3 1  ON 46
ci_048                -8.452273e-04 3 1  ON 47
ci_049                 7.814615e-04 3 1  ON 48
ci_050                 9.944712e-04 3 1  ON 49
ci_051                -3.372542e-04 3 1  ON 50
ci_052                -1.211971e-03 3 1  ON 51
ci_053                -2.460123e-03 3 1  ON 52
ci_054                -2.689187e-03 3 1  ON 53
ci_055                -1.790026e-03 3 1  ON 54
ci_056                -1.964164e-03 3 1  ON 55
ci_057                -1.319592e-03 3 1  ON 56
ci_058                -9.958138e-04 3 1  ON 57
ci_059                -5.220764e-04 3 1  ON 58
ci_060                -7.411168e-04 3 1  ON 59
ci_061                 6.127051e-06 3 1  ON 60
ci_062                -9.066600e-04 3 1  ON 61
ci_063                -8.878594e-04 3 1  ON 62
ci_064                -5.045607e-04 3 1  ON 63
ci_065                -1.365556e-03 3 1  ON 64
ci_066                -1.881524e-03 3 1  ON 65
ci_067                -1.823702e-03 3 1  ON 66
ci_068                -1.481435e-03 3 1  ON 67
ci_069                -5.505297e-04 3 1  ON 68
ci_070                -4.210551e-04 3 1  ON 69
ci_071                -2.064014e-03 3 1  ON 70
ci_072                -1.991149e-03 3 1  ON 71
ci_073                 1.593559e-04 3 1  ON 72
ci_074                 1.763369e-04 3 1  ON 73
ci_075                 1.711806e-04 3 1  ON 74
ci_076                 7.919561e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6586
    reference variance = 0.404218
====================================================
  Execution time = 2.5849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5376e-01
  Total weights = 1.9553e+06
  Execution time = 3.6649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441205140838
                                         uncertainty =       0.001941763145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441205140838
                                         uncertainty =       0.001941763145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469686962
  error estimate for blocks of size 2^( 2) =       0.000493487737
  error estimate for blocks of size 2^( 3) =       0.000515603163
  error estimate for blocks of size 2^( 4) =       0.000531132006
  error estimate for blocks of size 2^( 5) =       0.000540550613
  error estimate for blocks of size 2^( 6) =       0.000546492920
  error estimate for blocks of size 2^( 7) =       0.000548025960

      target function =      -0.742228203133
              le_mean =     -22.662864845782
             les_mean =     514.059205978475
             stat err =       0.000541550375
             autocorr =       1.329415416803
   target nu stat err =       0.000541550375
   target dn stat err =       0.005253745911
      target stat err =       0.004319924828
              std dev =       0.664237672344
             le_variance =       0.441211685361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441205124447
                                         uncertainty =       0.001941767794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441205124447
                                         uncertainty =       0.001941767794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469686954
  error estimate for blocks of size 2^( 2) =       0.000493487730
  error estimate for blocks of size 2^( 3) =       0.000515603156
  error estimate for blocks of size 2^( 4) =       0.000531132001
  error estimate for blocks of size 2^( 5) =       0.000540550608
  error estimate for blocks of size 2^( 6) =       0.000546492914
  error estimate for blocks of size 2^( 7) =       0.000548025953

      target function =      -0.742228280628
              le_mean =     -22.662864846248
             les_mean =     514.059205903666
             stat err =       0.000541550369
             autocorr =       1.329415439219
   target nu stat err =       0.000541550369
   target dn stat err =       0.005253813474
      target stat err =       0.004319980231
              std dev =       0.664237659873
             le_variance =       0.441211668794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441205132642
                                         uncertainty =       0.001941765469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441205132642
                                         uncertainty =       0.001941765469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469686958
  error estimate for blocks of size 2^( 2) =       0.000493487734
  error estimate for blocks of size 2^( 3) =       0.000515603159
  error estimate for blocks of size 2^( 4) =       0.000531132004
  error estimate for blocks of size 2^( 5) =       0.000540550610
  error estimate for blocks of size 2^( 6) =       0.000546492917
  error estimate for blocks of size 2^( 7) =       0.000548025956

      target function =      -0.742228241981
              le_mean =     -22.662864846015
             les_mean =     514.059205940946
             stat err =       0.000541550372
             autocorr =       1.329415428011
   target nu stat err =       0.000541550372
   target dn stat err =       0.005253779692
      target stat err =       0.004319952530
              std dev =       0.664237666109
             le_variance =       0.441211677077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441205139813
                                         uncertainty =       0.001941763436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441205139813
                                         uncertainty =       0.001941763436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469686962
  error estimate for blocks of size 2^( 2) =       0.000493487737
  error estimate for blocks of size 2^( 3) =       0.000515603162
  error estimate for blocks of size 2^( 4) =       0.000531132006
  error estimate for blocks of size 2^( 5) =       0.000540550612
  error estimate for blocks of size 2^( 6) =       0.000546492920
  error estimate for blocks of size 2^( 7) =       0.000548025959

      target function =      -0.742228208000
              le_mean =     -22.662864845811
             les_mean =     514.059205973770
             stat err =       0.000541550374
             autocorr =       1.329415418202
   target nu stat err =       0.000541550374
   target dn stat err =       0.005253750133
      target stat err =       0.004319928291
              std dev =       0.664237671565
             le_variance =       0.441211684326


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742228203133        initial
     3.0815e+03     3.0815e+04             6.8242e-08        -0.742228280628  <--
     1.2326e+04     1.2326e+05             1.7061e-08        -0.742228241981
     4.9304e+04     4.9304e+05             4.2652e-09        -0.742228208000

*****************************************************************************
Applying the update for shift_i =   3.0815e+03     and shift_s =   3.0815e+04
*****************************************************************************

  Execution time = 4.4107e+01
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_001                -7.055655e-01 3 1  ON 0
ci_002                -7.029289e-01 3 1  ON 1
ci_003                -5.011374e-02 3 1  ON 2
ci_004                -5.098548e-02 3 1  ON 3
ci_005                 1.946942e-02 3 1  ON 4
ci_006                 1.975946e-02 3 1  ON 5
ci_007                 1.473299e-02 3 1  ON 6
ci_008                 1.549253e-02 3 1  ON 7
ci_009                -1.315488e-02 3 1  ON 8
ci_010                -1.205372e-02 3 1  ON 9
ci_011                -9.848069e-03 3 1  ON 10
ci_012                -9.084207e-03 3 1  ON 11
ci_013                 8.365490e-03 3 1  ON 12
ci_014                 9.295505e-03 3 1  ON 13
ci_015                 9.498536e-03 3 1  ON 14
ci_016                 9.360155e-03 3 1  ON 15
ci_017                 8.491255e-03 3 1  ON 16
ci_018                 8.265878e-03 3 1  ON 17
ci_019                -1.266159e-03 3 1  ON 18
ci_020                -1.589696e-03 3 1  ON 19
ci_021                -1.182152e-02 3 1  ON 20
ci_022                -1.183630e-02 3 1  ON 21
ci_023                 4.842571e-03 3 1  ON 22
ci_024                 4.910766e-03 3 1  ON 23
ci_025                 1.153150e-02 3 1  ON 24
ci_026                 1.153303e-02 3 1  ON 25
ci_027                 6.476726e-03 3 1  ON 26
ci_028                 6.177202e-03 3 1  ON 27
ci_029                -5.031177e-03 3 1  ON 28
ci_030                -4.114572e-03 3 1  ON 29
ci_031                 3.416320e-03 3 1  ON 30
ci_032                 4.671983e-03 3 1  ON 31
ci_033                 2.350456e-03 3 1  ON 32
ci_034                 4.107232e-03 3 1  ON 33
ci_035                 1.724195e-03 3 1  ON 34
ci_036                 2.137211e-03 3 1  ON 35
ci_037                 3.491694e-03 3 1  ON 36
ci_038                 3.699657e-03 3 1  ON 37
ci_039                 4.602357e-03 3 1  ON 38
ci_040                 4.919591e-03 3 1  ON 39
ci_041                 2.955512e-03 3 1  ON 40
ci_042                 2.734120e-03 3 1  ON 41
ci_043                 2.939771e-03 3 1  ON 42
ci_044                 3.206444e-03 3 1  ON 43
ci_045                 2.473978e-03 3 1  ON 44
ci_046                 2.734762e-03 3 1  ON 45
ci_047                -1.005996e-03 3 1  ON 46
ci_048                -8.452326e-04 3 1  ON 47
ci_049                 7.814216e-04 3 1  ON 48
ci_050                 9.944767e-04 3 1  ON 49
ci_051                -3.372801e-04 3 1  ON 50
ci_052                -1.211960e-03 3 1  ON 51
ci_053                -2.460129e-03 3 1  ON 52
ci_054                -2.689161e-03 3 1  ON 53
ci_055                -1.790010e-03 3 1  ON 54
ci_056                -1.964145e-03 3 1  ON 55
ci_057                -1.319583e-03 3 1  ON 56
ci_058                -9.958186e-04 3 1  ON 57
ci_059                -5.220702e-04 3 1  ON 58
ci_060                -7.410918e-04 3 1  ON 59
ci_061                 6.117059e-06 3 1  ON 60
ci_062                -9.066553e-04 3 1  ON 61
ci_063                -8.878529e-04 3 1  ON 62
ci_064                -5.045655e-04 3 1  ON 63
ci_065                -1.365548e-03 3 1  ON 64
ci_066                -1.881520e-03 3 1  ON 65
ci_067                -1.823700e-03 3 1  ON 66
ci_068                -1.481445e-03 3 1  ON 67
ci_069                -5.505214e-04 3 1  ON 68
ci_070                -4.210503e-04 3 1  ON 69
ci_071                -2.064014e-03 3 1  ON 70
ci_072                -1.991155e-03 3 1  ON 71
ci_073                 1.593513e-04 3 1  ON 72
ci_074                 1.763437e-04 3 1  ON 73
ci_075                 1.711754e-04 3 1  ON 74
ci_076                 7.919602e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5500e+01 secs
  Total Execution time = 7.5352e+03 secs

=========================================================
  A new xml input file : FORM2.s099.cont.xml
