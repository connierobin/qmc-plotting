Rank =    0  Free Memory = 89810 MB
Rank =    1  Free Memory = 89810 MB
Rank =    2  Free Memory = 89810 MB
Rank =    3  Free Memory = 89810 MB
Rank =    4  Free Memory = 89810 MB
Rank =    5  Free Memory = 89810 MB
Rank =    6  Free Memory = 89810 MB
Rank =    7  Free Memory = 89810 MB
Rank =    8  Free Memory = 89810 MB
Rank =    9  Free Memory = 89810 MB
Rank =   10  Free Memory = 89810 MB
Rank =   11  Free Memory = 89810 MB
Rank =   12  Free Memory = 89810 MB
Rank =   13  Free Memory = 89810 MB
Rank =   14  Free Memory = 89809 MB
Rank =   15  Free Memory = 89794 MB
Rank =   16  Free Memory = 89794 MB
Rank =   17  Free Memory = 89794 MB
Rank =   18  Free Memory = 89794 MB
Rank =   19  Free Memory = 89794 MB
Rank =   20  Free Memory = 89794 MB
Rank =   21  Free Memory = 89794 MB
Rank =   22  Free Memory = 89794 MB
Rank =   23  Free Memory = 89794 MB
Rank =   24  Free Memory = 89794 MB
Rank =   25  Free Memory = 89794 MB
Rank =   26  Free Memory = 89794 MB
Rank =   27  Free Memory = 89794 MB
Rank =   28  Free Memory = 89794 MB
Rank =   29  Free Memory = 89794 MB
Rank =   30  Free Memory = 89794 MB
Rank =   31  Free Memory = 89794 MB
Rank =   32  Free Memory = 88760 MB
Rank =   33  Free Memory = 88760 MB
Rank =   34  Free Memory = 88760 MB
Rank =   35  Free Memory = 88760 MB
Rank =   36  Free Memory = 88760 MB
Rank =   37  Free Memory = 88760 MB
Rank =   38  Free Memory = 88760 MB
Rank =   39  Free Memory = 88760 MB
Rank =   40  Free Memory = 88760 MB
Rank =   41  Free Memory = 88760 MB
Rank =   42  Free Memory = 88759 MB
Rank =   43  Free Memory = 88759 MB
Rank =   44  Free Memory = 88759 MB
Rank =   45  Free Memory = 88759 MB
Rank =   46  Free Memory = 88759 MB
Rank =   47  Free Memory = 88759 MB
Rank =   48  Free Memory = 88759 MB
Rank =   49  Free Memory = 88759 MB
Rank =   50  Free Memory = 88759 MB
Rank =   51  Free Memory = 88759 MB
Rank =   52  Free Memory = 88759 MB
Rank =   53  Free Memory = 88759 MB
Rank =   54  Free Memory = 88759 MB
Rank =   55  Free Memory = 88759 MB
Rank =   56  Free Memory = 88759 MB
Rank =   57  Free Memory = 88759 MB
Rank =   58  Free Memory = 88759 MB
Rank =   59  Free Memory = 88759 MB
Rank =   60  Free Memory = 88759 MB
Rank =   61  Free Memory = 88759 MB
Rank =   62  Free Memory = 88759 MB
Rank =   63  Free Memory = 88759 MB
Rank =   64  Free Memory = 87773 MB
Rank =   65  Free Memory = 87773 MB
Rank =   66  Free Memory = 87773 MB
Rank =   67  Free Memory = 87773 MB
Rank =   68  Free Memory = 87773 MB
Rank =   69  Free Memory = 87773 MB
Rank =   70  Free Memory = 87773 MB
Rank =   71  Free Memory = 87773 MB
Rank =   72  Free Memory = 87773 MB
Rank =   73  Free Memory = 87773 MB
Rank =   74  Free Memory = 87772 MB
Rank =   75  Free Memory = 87772 MB
Rank =   76  Free Memory = 87772 MB
Rank =   77  Free Memory = 87772 MB
Rank =   78  Free Memory = 87772 MB
Rank =   79  Free Memory = 87772 MB
Rank =   80  Free Memory = 87772 MB
Rank =   81  Free Memory = 87772 MB
Rank =   82  Free Memory = 87772 MB
Rank =   83  Free Memory = 87772 MB
Rank =   84  Free Memory = 87772 MB
Rank =   85  Free Memory = 87772 MB
Rank =   86  Free Memory = 87772 MB
Rank =   87  Free Memory = 87772 MB
Rank =   88  Free Memory = 87772 MB
Rank =   89  Free Memory = 87772 MB
Rank =   90  Free Memory = 87772 MB
Rank =   91  Free Memory = 87772 MB
Rank =   92  Free Memory = 87772 MB
Rank =   93  Free Memory = 87772 MB
Rank =   94  Free Memory = 87772 MB
Rank =   95  Free Memory = 87772 MB
Rank =   96  Free Memory = 78278 MB
Rank =   97  Free Memory = 78278 MB
Rank =   98  Free Memory = 78278 MB
Rank =   99  Free Memory = 78278 MB
Rank =  100  Free Memory = 78278 MB
Rank =  101  Free Memory = 78278 MB
Rank =  102  Free Memory = 78278 MB
Rank =  103  Free Memory = 78278 MB
Rank =  104  Free Memory = 78278 MB
Rank =  105  Free Memory = 78278 MB
Rank =  106  Free Memory = 78278 MB
Rank =  107  Free Memory = 78278 MB
Rank =  108  Free Memory = 78278 MB
Rank =  109  Free Memory = 78278 MB
Rank =  110  Free Memory = 78278 MB
Rank =  111  Free Memory = 78278 MB
Rank =  112  Free Memory = 78278 MB
Rank =  113  Free Memory = 78278 MB
Rank =  114  Free Memory = 78278 MB
Rank =  115  Free Memory = 78278 MB
Rank =  116  Free Memory = 78278 MB
Rank =  117  Free Memory = 78278 MB
Rank =  118  Free Memory = 78278 MB
Rank =  119  Free Memory = 78278 MB
Rank =  120  Free Memory = 78278 MB
Rank =  121  Free Memory = 78278 MB
Rank =  122  Free Memory = 78278 MB
Rank =  123  Free Memory = 78278 MB
Rank =  124  Free Memory = 78278 MB
Rank =  125  Free Memory = 78278 MB
Rank =  126  Free Memory = 78278 MB
Rank =  127  Free Memory = 78278 MB
  Input file(s): opt_form_n2pistar_tett_run002c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_n2pistar_tett_run002c.xml

  Project = FORM2
  date    = 2023-02-22 21:30:28 PST
  host    = n0049.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 500

  Range of prime numbers to use as seeds over processors and threads = 3583-4657


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.812062e-01    1         1 OFF
     uu_1                 1.204241e-01    1         1 OFF
     uu_2                 1.996111e-02    1         1 OFF
     uu_3                -4.172278e-02    1         1 OFF
     uu_4                -8.068798e-02    1         1 OFF
     uu_5                -1.071294e-01    1         1 OFF
     uu_6                -1.262082e-01    1         1 OFF
     uu_7                -1.355364e-01    1         1 OFF
     uu_8                -1.350278e-01    1         1 OFF
     uu_9                -1.084844e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.455538e-01    1         1 OFF
     ud_1                 1.050922e-01    1         1 OFF
     ud_2                -1.476829e-02    1         1 OFF
     ud_3                -7.784977e-02    1         1 OFF
     ud_4                -1.145451e-01    1         1 OFF
     ud_5                -1.364624e-01    1         1 OFF
     ud_6                -1.484001e-01    1         1 OFF
     ud_7                -1.502057e-01    1         1 OFF
     ud_8                -1.408753e-01    1         1 OFF
     ud_9                -1.071149e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.063370e-01    1         1 OFF
     eC_1                -3.851417e-01    1         1 OFF
     eC_2                -1.728949e-01    1         1 OFF
     eC_3                -4.787447e-02    1         1 OFF
     eC_4                 3.017075e-03    1         1 OFF
     eC_5                 1.178982e-01    1         1 OFF
     eC_6                 2.513973e-01    1         1 OFF
     eC_7                 3.667055e-01    1         1 OFF
     eC_8                 2.868186e-01    1         1 OFF
     eC_9                 8.095394e-02    1         1 OFF

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.041864e+00    1         1 OFF
     eO_1                -7.383832e-01    1         1 OFF
     eO_2                -3.310735e-01    1         1 OFF
     eO_3                -2.889482e-02    1         1 OFF
     eO_4                 1.689615e-01    1         1 OFF
     eO_5                 3.306834e-01    1         1 OFF
     eO_6                 3.884682e-01    1         1 OFF
     eO_7                 4.055642e-01    1         1 OFF
     eO_8                 3.979452e-01    1         1 OFF
     eO_9                 3.113543e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.155436e-01    1         1 OFF
     eH1_1                -1.153399e-01    1         1 OFF
     eH1_2                -7.431472e-02    1         1 OFF
     eH1_3                -5.488576e-02    1         1 OFF
     eH1_4                 1.321955e-02    1         1 OFF
     eH1_5                 6.669359e-02    1         1 OFF
     eH1_6                 9.518356e-02    1         1 OFF
     eH1_7                 5.385289e-02    1         1 OFF
     eH1_8                 7.950128e-03    1         1 OFF
     eH1_9                 4.741213e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.111316e-01    1         1 OFF
     eH2_1                -1.113235e-01    1         1 OFF
     eH2_2                -7.107357e-02    1         1 OFF
     eH2_3                -5.160393e-02    1         1 OFF
     eH2_4                 1.514944e-02    1         1 OFF
     eH2_5                 6.728119e-02    1         1 OFF
     eH2_6                 9.566953e-02    1         1 OFF
     eH2_7                 6.015831e-02    1         1 OFF
     eH2_8                 1.937916e-02    1         1 OFF
     eH2_9                 5.520858e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 77 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.000083e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 24 unique up determinants.
Found 24 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.5544e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u -1.8061669018e+00  2.7837752017e-01 -8.9374600273e-01
    u  6.2204767277e-01 -3.1767951129e-01 -1.6068917470e+00
    u  2.7844543642e-02 -4.6711695757e-01  1.3769739340e+00
    u  5.3613352983e-01 -1.0346031641e-01  1.1931174682e+00
    u  6.6915801034e-01  1.1573235719e+00  1.2719505344e+00
    u  1.8470266426e-02  1.4117662795e+00 -1.6695285925e+00
    d -9.6293909260e-01  1.0337145637e+00 -8.9962839053e-01
    d  1.0744417758e+00  1.1605479134e+00 -1.8930392030e+00
    d  1.2380477230e+00  4.9285421082e-01  8.7082227944e-01
    d  8.1730014770e-01 -3.7289888410e-01  2.8378529985e+00
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM2.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 76
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.6772
    reference variance = 0.575381
====================================================
  Execution time = 2.7369e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4862e-01
  Total weights = 1.955203260e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439709383325
                                         uncertainty =       0.002102337220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439709383325
                                         uncertainty =       0.002102337220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468959358
  error estimate for blocks of size 2^( 2) =       0.000492748915
  error estimate for blocks of size 2^( 3) =       0.000514719123
  error estimate for blocks of size 2^( 4) =       0.000529886792
  error estimate for blocks of size 2^( 5) =       0.000539324465
  error estimate for blocks of size 2^( 6) =       0.000543407198
  error estimate for blocks of size 2^( 7) =       0.000546261606

      target function =      -0.746470278485
              le_mean =     -22.661962997735
             les_mean =     514.013182095648
             stat err =       0.000539720015
             autocorr =       1.324544748252
   target nu stat err =       0.000539720015
   target dn stat err =       0.002335346967
      target stat err =       0.002015469712
              std dev =       0.663208684316
             le_variance =       0.439845758952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.266196299774e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746474758021       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746703212062       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746760586440       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746766973108       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746767911423       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746767839575       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746767701962       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746767569438       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746767557735       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746767628716       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746767669302       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746767685383       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746767681336       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.386829e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746474758021       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746539701385       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746555121306       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746556782378       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746557005494       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746556980940       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746556944808       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746556914921       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746556913801       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746556931338       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746556939279       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746556941648       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.853650e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746474758021       residual = 6.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746491569816       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746495495500       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746495914342       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746495969059       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746495962451       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746495953343       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746495946132       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746495945974       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746495950319       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746495952147       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746495952652       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 9.910748e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.008223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2157e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_001 -7.045721e-01                3 1 ON  0
ci_002 -7.027288e-01                3 1 ON  1
ci_003 -5.358590e-02                3 1 ON  2
ci_004 -5.391598e-02                3 1 ON  3
ci_005 2.303302e-02                 3 1 ON  4
ci_006 2.311723e-02                 3 1 ON  5
ci_007 1.839942e-02                 3 1 ON  6
ci_008 1.879040e-02                 3 1 ON  7
ci_009 -1.476554e-02                3 1 ON  8
ci_010 -1.453287e-02                3 1 ON  9
ci_011 -1.239645e-02                3 1 ON  10
ci_012 -1.188762e-02                3 1 ON  11
ci_013 1.103503e-02                 3 1 ON  12
ci_014 1.087909e-02                 3 1 ON  13
ci_015 1.241802e-02                 3 1 ON  14
ci_016 1.215992e-02                 3 1 ON  15
ci_017 1.042452e-02                 3 1 ON  16
ci_018 1.029825e-02                 3 1 ON  17
ci_019 2.916339e-03                 3 1 ON  18
ci_020 3.178209e-03                 3 1 ON  19
ci_021 -8.333096e-03                3 1 ON  20
ci_022 -8.481338e-03                3 1 ON  21
ci_023 6.151304e-03                 3 1 ON  22
ci_024 6.301030e-03                 3 1 ON  23
ci_025 9.303495e-03                 3 1 ON  24
ci_026 9.112886e-03                 3 1 ON  25
ci_027 6.522969e-03                 3 1 ON  26
ci_028 6.638286e-03                 3 1 ON  27
ci_029 -5.091738e-03                3 1 ON  28
ci_030 -5.145224e-03                3 1 ON  29
ci_031 -1.426530e-03                3 1 ON  30
ci_032 -1.326980e-03                3 1 ON  31
ci_033 4.237521e-03                 3 1 ON  32
ci_034 4.195574e-03                 3 1 ON  33
ci_035 2.663895e-03                 3 1 ON  34
ci_036 2.710241e-03                 3 1 ON  35
ci_037 4.645712e-03                 3 1 ON  36
ci_038 4.510561e-03                 3 1 ON  37
ci_039 4.544398e-03                 3 1 ON  38
ci_040 4.622980e-03                 3 1 ON  39
ci_041 3.670429e-03                 3 1 ON  40
ci_042 3.501792e-03                 3 1 ON  41
ci_043 3.868715e-03                 3 1 ON  42
ci_044 4.017356e-03                 3 1 ON  43
ci_045 3.216147e-03                 3 1 ON  44
ci_046 3.076871e-03                 3 1 ON  45
ci_047 -1.566443e-03                3 1 ON  46
ci_048 -1.692856e-03                3 1 ON  47
ci_049 1.337070e-03                 3 1 ON  48
ci_050 1.460831e-03                 3 1 ON  49
ci_051 -2.153505e-03                3 1 ON  50
ci_052 -2.045363e-03                3 1 ON  51
ci_053 -2.201639e-03                3 1 ON  52
ci_054 -2.411090e-03                3 1 ON  53
ci_055 -1.130364e-03                3 1 ON  54
ci_056 -1.661862e-03                3 1 ON  55
ci_057 -1.243049e-03                3 1 ON  56
ci_058 -1.427973e-03                3 1 ON  57
ci_059 -7.928233e-04                3 1 ON  58
ci_060 -6.443965e-04                3 1 ON  59
ci_061 -9.549412e-04                3 1 ON  60
ci_062 -6.920236e-04                3 1 ON  61
ci_063 -5.705941e-04                3 1 ON  62
ci_064 -7.863425e-04                3 1 ON  63
ci_065 -1.938416e-03                3 1 ON  64
ci_066 -2.104999e-03                3 1 ON  65
ci_067 -1.437656e-03                3 1 ON  66
ci_068 -1.111895e-03                3 1 ON  67
ci_069 -4.708000e-05                3 1 ON  68
ci_070 1.927958e-04                 3 1 ON  69
ci_071 -1.834148e-03                3 1 ON  70
ci_072 -1.732675e-03                3 1 ON  71
ci_073 4.721128e-04                 3 1 ON  72
ci_074 4.668993e-04                 3 1 ON  73
ci_075 -8.429930e-05                3 1 ON  74
ci_076 -6.960069e-05                3 1 ON  75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.5471
    reference variance = 0.331579
====================================================
  Execution time = 2.6570e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4903e-01
  Total weights = 1.9551e+06
  Execution time = 3.6219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440504425492
                                         uncertainty =       0.001898309046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440504425492
                                         uncertainty =       0.001898309046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469323967
  error estimate for blocks of size 2^( 2) =       0.000493186743
  error estimate for blocks of size 2^( 3) =       0.000514978779
  error estimate for blocks of size 2^( 4) =       0.000530331935
  error estimate for blocks of size 2^( 5) =       0.000539801039
  error estimate for blocks of size 2^( 6) =       0.000543155672
  error estimate for blocks of size 2^( 7) =       0.000547105180

      target function =      -0.744717164427
              le_mean =     -22.663078955826
             les_mean =     514.065902216113
             stat err =       0.000540098456
             autocorr =       1.324342775081
   target nu stat err =       0.000540098456
   target dn stat err =       0.002514942687
      target stat err =       0.002151287651
              std dev =       0.663724318935
             le_variance =       0.440529971546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439873546461
                                         uncertainty =       0.001887347719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439873546461
                                         uncertainty =       0.001887347719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468986096
  error estimate for blocks of size 2^( 2) =       0.000492876596
  error estimate for blocks of size 2^( 3) =       0.000514682983
  error estimate for blocks of size 2^( 4) =       0.000530038884
  error estimate for blocks of size 2^( 5) =       0.000539514272
  error estimate for blocks of size 2^( 6) =       0.000542812745
  error estimate for blocks of size 2^( 7) =       0.000546720336

      target function =      -0.722286025195
              le_mean =     -22.663087670278
             les_mean =     514.093625049379
             stat err =       0.000539771559
             autocorr =       1.324646693287
   target nu stat err =       0.000539771559
   target dn stat err =       0.027645557540
      target stat err =       0.021400638410
              std dev =       0.663246498122
             le_variance =       0.439895917271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440083194949
                                         uncertainty =       0.001886990940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440083194949
                                         uncertainty =       0.001886990940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469098507
  error estimate for blocks of size 2^( 2) =       0.000492976002
  error estimate for blocks of size 2^( 3) =       0.000514779182
  error estimate for blocks of size 2^( 4) =       0.000530132743
  error estimate for blocks of size 2^( 5) =       0.000539604978
  error estimate for blocks of size 2^( 6) =       0.000542938525
  error estimate for blocks of size 2^( 7) =       0.000546863557

      target function =      -0.744947475451
              le_mean =     -22.663081279551
             les_mean =     514.065727534824
             stat err =       0.000539884951
             autocorr =       1.324568256415
   target nu stat err =       0.000539884951
   target dn stat err =       0.002496151468
      target stat err =       0.002137663543
              std dev =       0.663405470046
             le_variance =       0.440106817686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440543176535
                                         uncertainty =       0.001885586914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440543176535
                                         uncertainty =       0.001885586914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469344081
  error estimate for blocks of size 2^( 2) =       0.000493197240
  error estimate for blocks of size 2^( 3) =       0.000514990954
  error estimate for blocks of size 2^( 4) =       0.000530336118
  error estimate for blocks of size 2^( 5) =       0.000539817211
  error estimate for blocks of size 2^( 6) =       0.000543134447
  error estimate for blocks of size 2^( 7) =       0.000547071332

      target function =      -0.637224527233
              le_mean =     -22.663071428045
             les_mean =     514.200580557481
             stat err =       0.000540089777
             autocorr =       1.324186705928
   target nu stat err =       0.000540089777
   target dn stat err =       0.136337158570
      target stat err =       0.083448427589
              std dev =       0.663752764912
             le_variance =       0.440567732928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744717164427        initial
     2.5000e-01     2.5000e+00             1.3868e-03        -0.722286025195
     1.0000e+00     1.0000e+01             3.8537e-04        -0.744947475451  <--
     4.0000e+00     4.0000e+01             9.9107e-05        -0.637224527233

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.4766e+01
  </log>
  <optVariables href="FORM2.s000.opt.xml">
ci_001                -7.045721e-01 3 1  ON 0
ci_002                -7.027288e-01 3 1  ON 1
ci_003                -5.358590e-02 3 1  ON 2
ci_004                -5.391598e-02 3 1  ON 3
ci_005                 2.303302e-02 3 1  ON 4
ci_006                 2.311723e-02 3 1  ON 5
ci_007                 1.839942e-02 3 1  ON 6
ci_008                 1.879040e-02 3 1  ON 7
ci_009                -1.476554e-02 3 1  ON 8
ci_010                -1.453287e-02 3 1  ON 9
ci_011                -1.239645e-02 3 1  ON 10
ci_012                -1.188762e-02 3 1  ON 11
ci_013                 1.103503e-02 3 1  ON 12
ci_014                 1.087909e-02 3 1  ON 13
ci_015                 1.241802e-02 3 1  ON 14
ci_016                 1.215992e-02 3 1  ON 15
ci_017                 1.042452e-02 3 1  ON 16
ci_018                 1.029825e-02 3 1  ON 17
ci_019                 2.916339e-03 3 1  ON 18
ci_020                 3.178209e-03 3 1  ON 19
ci_021                -8.333096e-03 3 1  ON 20
ci_022                -8.481338e-03 3 1  ON 21
ci_023                 6.151304e-03 3 1  ON 22
ci_024                 6.301030e-03 3 1  ON 23
ci_025                 9.303495e-03 3 1  ON 24
ci_026                 9.112886e-03 3 1  ON 25
ci_027                 6.522969e-03 3 1  ON 26
ci_028                 6.638286e-03 3 1  ON 27
ci_029                -5.091738e-03 3 1  ON 28
ci_030                -5.145224e-03 3 1  ON 29
ci_031                -1.426530e-03 3 1  ON 30
ci_032                -1.326980e-03 3 1  ON 31
ci_033                 4.237521e-03 3 1  ON 32
ci_034                 4.195574e-03 3 1  ON 33
ci_035                 2.663895e-03 3 1  ON 34
ci_036                 2.710241e-03 3 1  ON 35
ci_037                 4.645712e-03 3 1  ON 36
ci_038                 4.510561e-03 3 1  ON 37
ci_039                 4.544398e-03 3 1  ON 38
ci_040                 4.622980e-03 3 1  ON 39
ci_041                 3.670429e-03 3 1  ON 40
ci_042                 3.501792e-03 3 1  ON 41
ci_043                 3.868715e-03 3 1  ON 42
ci_044                 4.017356e-03 3 1  ON 43
ci_045                 3.216147e-03 3 1  ON 44
ci_046                 3.076871e-03 3 1  ON 45
ci_047                -1.566443e-03 3 1  ON 46
ci_048                -1.692856e-03 3 1  ON 47
ci_049                 1.337070e-03 3 1  ON 48
ci_050                 1.460831e-03 3 1  ON 49
ci_051                -2.153505e-03 3 1  ON 50
ci_052                -2.045363e-03 3 1  ON 51
ci_053                -2.201639e-03 3 1  ON 52
ci_054                -2.411090e-03 3 1  ON 53
ci_055                -1.130364e-03 3 1  ON 54
ci_056                -1.661862e-03 3 1  ON 55
ci_057                -1.243049e-03 3 1  ON 56
ci_058                -1.427973e-03 3 1  ON 57
ci_059                -7.928233e-04 3 1  ON 58
ci_060                -6.443965e-04 3 1  ON 59
ci_061                -9.549412e-04 3 1  ON 60
ci_062                -6.920236e-04 3 1  ON 61
ci_063                -5.705941e-04 3 1  ON 62
ci_064                -7.863425e-04 3 1  ON 63
ci_065                -1.938416e-03 3 1  ON 64
ci_066                -2.104999e-03 3 1  ON 65
ci_067                -1.437656e-03 3 1  ON 66
ci_068                -1.111895e-03 3 1  ON 67
ci_069                -4.708000e-05 3 1  ON 68
ci_070                 1.927958e-04 3 1  ON 69
ci_071                -1.834148e-03 3 1  ON 70
ci_072                -1.732675e-03 3 1  ON 71
ci_073                 4.721128e-04 3 1  ON 72
ci_074                 4.668993e-04 3 1  ON 73
ci_075                -8.429930e-05 3 1  ON 74
ci_076                -6.960069e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6930e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2612e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6145
    reference variance = 0.405097
====================================================
  Execution time = 2.6678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5501e-01
  Total weights = 1.955075832e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445657605425
                                         uncertainty =       0.002826665348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445657605425
                                         uncertainty =       0.002826665348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472080181
  error estimate for blocks of size 2^( 2) =       0.000495935288
  error estimate for blocks of size 2^( 3) =       0.000517912598
  error estimate for blocks of size 2^( 4) =       0.000533608022
  error estimate for blocks of size 2^( 5) =       0.000541683218
  error estimate for blocks of size 2^( 6) =       0.000545223448
  error estimate for blocks of size 2^( 7) =       0.000550645180

      target function =      -0.741228349343
              le_mean =     -22.662149447887
             les_mean =     514.028031337026
             stat err =       0.000542789967
             autocorr =       1.322001920165
   target nu stat err =       0.000542789967
   target dn stat err =       0.003224883010
      target stat err =       0.002688941098
              std dev =       0.667622194741
             le_variance =       0.445719394911


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266214944789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741237023342       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741431032719       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741478199687       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741482559353       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741484037810       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741484518871       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741484785603       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741484903137       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741484951471       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741484942763       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741484930549       residual = 8.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741484971656       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741484966070       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.135347e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741237023342       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741292138996       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741304831383       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741305951306       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741306324585       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741306448622       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741306508318       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741306528543       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741306537841       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741306535020       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741306532471       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741306540425       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.148673e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741237023342       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741251288341       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741254520984       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741254802364       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741254895685       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741254926897       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741254941270       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741254945728       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741254947885       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741254947148       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741254946553       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741254948396       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 8.092341e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.013320 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1402e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_001                -7.047252e-01 3 1  ON 0
ci_002                -7.026387e-01 3 1  ON 1
ci_003                -5.349497e-02 3 1  ON 2
ci_004                -5.382107e-02 3 1  ON 3
ci_005                 2.276949e-02 3 1  ON 4
ci_006                 2.293054e-02 3 1  ON 5
ci_007                 1.823074e-02 3 1  ON 6
ci_008                 1.862024e-02 3 1  ON 7
ci_009                -1.464052e-02 3 1  ON 8
ci_010                -1.439179e-02 3 1  ON 9
ci_011                -1.220565e-02 3 1  ON 10
ci_012                -1.179913e-02 3 1  ON 11
ci_013                 1.083525e-02 3 1  ON 12
ci_014                 1.069939e-02 3 1  ON 13
ci_015                 1.224055e-02 3 1  ON 14
ci_016                 1.191990e-02 3 1  ON 15
ci_017                 1.036142e-02 3 1  ON 16
ci_018                 1.021319e-02 3 1  ON 17
ci_019                 2.601472e-03 3 1  ON 18
ci_020                 2.868897e-03 3 1  ON 19
ci_021                -8.514728e-03 3 1  ON 20
ci_022                -8.632405e-03 3 1  ON 21
ci_023                 6.059802e-03 3 1  ON 22
ci_024                 6.303062e-03 3 1  ON 23
ci_025                 9.509678e-03 3 1  ON 24
ci_026                 9.401445e-03 3 1  ON 25
ci_027                 6.474322e-03 3 1  ON 26
ci_028                 6.607180e-03 3 1  ON 27
ci_029                -5.044444e-03 3 1  ON 28
ci_030                -5.077925e-03 3 1  ON 29
ci_031                -1.165569e-03 3 1  ON 30
ci_032                -1.100130e-03 3 1  ON 31
ci_033                 4.203753e-03 3 1  ON 32
ci_034                 4.178812e-03 3 1  ON 33
ci_035                 2.597938e-03 3 1  ON 34
ci_036                 2.654511e-03 3 1  ON 35
ci_037                 4.555906e-03 3 1  ON 36
ci_038                 4.486640e-03 3 1  ON 37
ci_039                 4.535567e-03 3 1  ON 38
ci_040                 4.627312e-03 3 1  ON 39
ci_041                 3.649729e-03 3 1  ON 40
ci_042                 3.475687e-03 3 1  ON 41
ci_043                 3.817636e-03 3 1  ON 42
ci_044                 3.965165e-03 3 1  ON 43
ci_045                 3.172720e-03 3 1  ON 44
ci_046                 3.025351e-03 3 1  ON 45
ci_047                -1.547805e-03 3 1  ON 46
ci_048                -1.617860e-03 3 1  ON 47
ci_049                 1.294271e-03 3 1  ON 48
ci_050                 1.458591e-03 3 1  ON 49
ci_051                -2.123246e-03 3 1  ON 50
ci_052                -1.992252e-03 3 1  ON 51
ci_053                -2.185796e-03 3 1  ON 52
ci_054                -2.416890e-03 3 1  ON 53
ci_055                -1.113806e-03 3 1  ON 54
ci_056                -1.661631e-03 3 1  ON 55
ci_057                -1.232692e-03 3 1  ON 56
ci_058                -1.398966e-03 3 1  ON 57
ci_059                -7.665849e-04 3 1  ON 58
ci_060                -6.573176e-04 3 1  ON 59
ci_061                -8.536349e-04 3 1  ON 60
ci_062                -6.720648e-04 3 1  ON 61
ci_063                -5.349729e-04 3 1  ON 62
ci_064                -7.934024e-04 3 1  ON 63
ci_065                -1.903180e-03 3 1  ON 64
ci_066                -2.066748e-03 3 1  ON 65
ci_067                -1.412963e-03 3 1  ON 66
ci_068                -1.014472e-03 3 1  ON 67
ci_069                -8.200694e-05 3 1  ON 68
ci_070                 1.899517e-04 3 1  ON 69
ci_071                -1.787618e-03 3 1  ON 70
ci_072                -1.764349e-03 3 1  ON 71
ci_073                 4.734506e-04 3 1  ON 72
ci_074                 4.590866e-04 3 1  ON 73
ci_075                -7.380616e-05 3 1  ON 74
ci_076                -5.825256e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.6008
    reference variance = 0.441031
====================================================
  Execution time = 2.6226e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6325e-01
  Total weights = 1.9550e+06
  Execution time = 3.6248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445036925614
                                         uncertainty =       0.002696164588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445036925614
                                         uncertainty =       0.002696164588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471743647
  error estimate for blocks of size 2^( 2) =       0.000495370664
  error estimate for blocks of size 2^( 3) =       0.000517255613
  error estimate for blocks of size 2^( 4) =       0.000532346503
  error estimate for blocks of size 2^( 5) =       0.000541429788
  error estimate for blocks of size 2^( 6) =       0.000545568284
  error estimate for blocks of size 2^( 7) =       0.000549058263

      target function =      -0.734574310131
              le_mean =     -22.662473181164
             les_mean =     514.050933483725
             stat err =       0.000542100710
             autocorr =       1.320528661200
   target nu stat err =       0.000542100710
   target dn stat err =       0.005772937946
      target stat err =       0.004650011243
              std dev =       0.667146263110
             le_variance =       0.445084136381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444850940042
                                         uncertainty =       0.002730880567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444850940042
                                         uncertainty =       0.002730880567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471644695
  error estimate for blocks of size 2^( 2) =       0.000495286906
  error estimate for blocks of size 2^( 3) =       0.000517182528
  error estimate for blocks of size 2^( 4) =       0.000532275313
  error estimate for blocks of size 2^( 5) =       0.000541365811
  error estimate for blocks of size 2^( 6) =       0.000545514078
  error estimate for blocks of size 2^( 7) =       0.000549040611

      target function =      -0.731108482619
              le_mean =     -22.662484581702
             les_mean =     514.055774908782
             stat err =       0.000542048953
             autocorr =       1.320830569520
   target nu stat err =       0.000542048953
   target dn stat err =       0.008026776508
      target stat err =       0.006380260761
              std dev =       0.667006324996
             le_variance =       0.444897437584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444861434923
                                         uncertainty =       0.002709469066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444861434923
                                         uncertainty =       0.002709469066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471650468
  error estimate for blocks of size 2^( 2) =       0.000495287371
  error estimate for blocks of size 2^( 3) =       0.000517178346
  error estimate for blocks of size 2^( 4) =       0.000532269926
  error estimate for blocks of size 2^( 5) =       0.000541357214
  error estimate for blocks of size 2^( 6) =       0.000545500164
  error estimate for blocks of size 2^( 7) =       0.000549009669

      target function =      -0.734045423581
              le_mean =     -22.662475166640
             les_mean =     514.051674318919
             stat err =       0.000542034243
             autocorr =       1.320726553199
   target nu stat err =       0.000542034243
   target dn stat err =       0.006629771630
      target stat err =       0.005322236703
              std dev =       0.667014488308
             le_variance =       0.444908327612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445006192972
                                         uncertainty =       0.002697343703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445006192972
                                         uncertainty =       0.002697343703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471727343
  error estimate for blocks of size 2^( 2) =       0.000495355662
  error estimate for blocks of size 2^( 3) =       0.000517241397
  error estimate for blocks of size 2^( 4) =       0.000532332439
  error estimate for blocks of size 2^( 5) =       0.000541416208
  error estimate for blocks of size 2^( 6) =       0.000545555364
  error estimate for blocks of size 2^( 7) =       0.000549047493

      target function =      -0.734688972713
              le_mean =     -22.662472692177
             les_mean =     514.050766916291
             stat err =       0.000542087876
             autocorr =       1.320557416406
   target nu stat err =       0.000542087876
   target dn stat err =       0.005844412974
      target stat err =       0.004708120642
              std dev =       0.667123205672
             le_variance =       0.445053371546


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.734574310131        initial
     2.5000e-01     2.5000e+00             1.1353e-03        -0.731108482619
     1.0000e+00     1.0000e+01             3.1487e-04        -0.734045423581
     4.0000e+00     4.0000e+01             8.0923e-05        -0.734688972713  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 4.4402e+01
  </log>
  <optVariables href="FORM2.s001.opt.xml">
ci_001                -7.046107e-01 3 1  ON 0
ci_002                -7.027064e-01 3 1  ON 1
ci_003                -5.356280e-02 3 1  ON 2
ci_004                -5.389195e-02 3 1  ON 3
ci_005                 2.296464e-02 3 1  ON 4
ci_006                 2.306885e-02 3 1  ON 5
ci_007                 1.835586e-02 3 1  ON 6
ci_008                 1.874654e-02 3 1  ON 7
ci_009                -1.473322e-02 3 1  ON 8
ci_010                -1.449648e-02 3 1  ON 9
ci_011                -1.234725e-02 3 1  ON 10
ci_012                -1.186480e-02 3 1  ON 11
ci_013                 1.098347e-02 3 1  ON 12
ci_014                 1.083279e-02 3 1  ON 13
ci_015                 1.237237e-02 3 1  ON 14
ci_016                 1.209826e-02 3 1  ON 15
ci_017                 1.040817e-02 3 1  ON 16
ci_018                 1.027628e-02 3 1  ON 17
ci_019                 2.835416e-03 3 1  ON 18
ci_020                 3.098723e-03 3 1  ON 19
ci_021                -8.379744e-03 3 1  ON 20
ci_022                -8.520189e-03 3 1  ON 21
ci_023                 6.127617e-03 3 1  ON 22
ci_024                 6.301563e-03 3 1  ON 23
ci_025                 9.356403e-03 3 1  ON 24
ci_026                 9.187039e-03 3 1  ON 25
ci_027                 6.510338e-03 3 1  ON 26
ci_028                 6.630239e-03 3 1  ON 27
ci_029                -5.079539e-03 3 1  ON 28
ci_030                -5.127898e-03 3 1  ON 29
ci_031                -1.359448e-03 3 1  ON 30
ci_032                -1.268600e-03 3 1  ON 31
ci_033                 4.228801e-03 3 1  ON 32
ci_034                 4.191267e-03 3 1  ON 33
ci_035                 2.646812e-03 3 1  ON 34
ci_036                 2.695805e-03 3 1  ON 35
ci_037                 4.622579e-03 3 1  ON 36
ci_038                 4.504450e-03 3 1  ON 37
ci_039                 4.542065e-03 3 1  ON 38
ci_040                 4.624092e-03 3 1  ON 39
ci_041                 3.665037e-03 3 1  ON 40
ci_042                 3.495012e-03 3 1  ON 41
ci_043                 3.855583e-03 3 1  ON 42
ci_044                 4.003985e-03 3 1  ON 43
ci_045                 3.204937e-03 3 1  ON 44
ci_046                 3.063565e-03 3 1  ON 45
ci_047                -1.561624e-03 3 1  ON 46
ci_048                -1.673408e-03 3 1  ON 47
ci_049                 1.326002e-03 3 1  ON 48
ci_050                 1.460232e-03 3 1  ON 49
ci_051                -2.145723e-03 3 1  ON 50
ci_052                -2.031738e-03 3 1  ON 51
ci_053                -2.197490e-03 3 1  ON 52
ci_054                -2.412585e-03 3 1  ON 53
ci_055                -1.126118e-03 3 1  ON 54
ci_056                -1.661811e-03 3 1  ON 55
ci_057                -1.240368e-03 3 1  ON 56
ci_058                -1.420485e-03 3 1  ON 57
ci_059                -7.860432e-04 3 1  ON 58
ci_060                -6.477718e-04 3 1  ON 59
ci_061                -9.288505e-04 3 1  ON 60
ci_062                -6.868845e-04 3 1  ON 61
ci_063                -5.613599e-04 3 1  ON 62
ci_064                -7.881224e-04 3 1  ON 63
ci_065                -1.929335e-03 3 1  ON 64
ci_066                -2.095150e-03 3 1  ON 65
ci_067                -1.431239e-03 3 1  ON 66
ci_068                -1.086771e-03 3 1  ON 67
ci_069                -5.608063e-05 3 1  ON 68
ci_070                 1.920647e-04 3 1  ON 69
ci_071                -1.822172e-03 3 1  ON 70
ci_072                -1.740895e-03 3 1  ON 71
ci_073                 4.725123e-04 3 1  ON 72
ci_074                 4.649148e-04 3 1  ON 73
ci_075                -8.160883e-05 3 1  ON 74
ci_076                -6.668820e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5811e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2610e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6353
    reference variance = 0.570806
====================================================
  Execution time = 2.6619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5408e-01
  Total weights = 1.954878132e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445717463040
                                         uncertainty =       0.003743119456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445717463040
                                         uncertainty =       0.003743119456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472068731
  error estimate for blocks of size 2^( 2) =       0.000495662760
  error estimate for blocks of size 2^( 3) =       0.000517678885
  error estimate for blocks of size 2^( 4) =       0.000533468471
  error estimate for blocks of size 2^( 5) =       0.000543229099
  error estimate for blocks of size 2^( 6) =       0.000547710499
  error estimate for blocks of size 2^( 7) =       0.000551139435

      target function =      -0.741988437402
              le_mean =     -22.662908330741
             les_mean =     514.061491643755
             stat err =       0.000543886876
             autocorr =       1.327414906747
   target nu stat err =       0.000543886876
   target dn stat err =       0.003783796525
      target stat err =       0.003143823361
              std dev =       0.667606001217
             le_variance =       0.445697772861


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266290833074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742000794563       residual = 6.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742069157403       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742082252339       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742083621634       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742083980473       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742083952972       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742083882804       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742083877158       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742083910922       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742083903589       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742083876199       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742083880201       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.411231e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742000794563       residual = 6.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742018481420       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742021813714       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742022156479       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742022245080       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742022236970       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742022219034       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742022217726       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742022226064       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742022224029       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742022217601       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742022218549       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 8.762839e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742000794563       residual = 6.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742005255170       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742006091934       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742006177636       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742006199710       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742006197603       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742006193095       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742006192775       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742006194853       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742006194331       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742006192751       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742006192985       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.6000e+01 is 2.205886e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1365e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_001                -7.046522e-01 3 1  ON 0
ci_002                -7.026841e-01 3 1  ON 1
ci_003                -5.350372e-02 3 1  ON 2
ci_004                -5.388123e-02 3 1  ON 3
ci_005                 2.290964e-02 3 1  ON 4
ci_006                 2.301174e-02 3 1  ON 5
ci_007                 1.831715e-02 3 1  ON 6
ci_008                 1.869251e-02 3 1  ON 7
ci_009                -1.468514e-02 3 1  ON 8
ci_010                -1.446493e-02 3 1  ON 9
ci_011                -1.231400e-02 3 1  ON 10
ci_012                -1.182367e-02 3 1  ON 11
ci_013                 1.095148e-02 3 1  ON 12
ci_014                 1.078469e-02 3 1  ON 13
ci_015                 1.230036e-02 3 1  ON 14
ci_016                 1.203573e-02 3 1  ON 15
ci_017                 1.034758e-02 3 1  ON 16
ci_018                 1.027492e-02 3 1  ON 17
ci_019                 2.800564e-03 3 1  ON 18
ci_020                 3.020585e-03 3 1  ON 19
ci_021                -8.443596e-03 3 1  ON 20
ci_022                -8.535479e-03 3 1  ON 21
ci_023                 6.111590e-03 3 1  ON 22
ci_024                 6.285035e-03 3 1  ON 23
ci_025                 9.397534e-03 3 1  ON 24
ci_026                 9.229831e-03 3 1  ON 25
ci_027                 6.501182e-03 3 1  ON 26
ci_028                 6.626095e-03 3 1  ON 27
ci_029                -5.055227e-03 3 1  ON 28
ci_030                -5.122501e-03 3 1  ON 29
ci_031                -1.271819e-03 3 1  ON 30
ci_032                -1.225506e-03 3 1  ON 31
ci_033                 4.220022e-03 3 1  ON 32
ci_034                 4.169665e-03 3 1  ON 33
ci_035                 2.630883e-03 3 1  ON 34
ci_036                 2.684185e-03 3 1  ON 35
ci_037                 4.601113e-03 3 1  ON 36
ci_038                 4.494500e-03 3 1  ON 37
ci_039                 4.549925e-03 3 1  ON 38
ci_040                 4.618792e-03 3 1  ON 39
ci_041                 3.655440e-03 3 1  ON 40
ci_042                 3.481419e-03 3 1  ON 41
ci_043                 3.851780e-03 3 1  ON 42
ci_044                 4.001928e-03 3 1  ON 43
ci_045                 3.179869e-03 3 1  ON 44
ci_046                 3.064923e-03 3 1  ON 45
ci_047                -1.548921e-03 3 1  ON 46
ci_048                -1.664582e-03 3 1  ON 47
ci_049                 1.325834e-03 3 1  ON 48
ci_050                 1.461633e-03 3 1  ON 49
ci_051                -2.125277e-03 3 1  ON 50
ci_052                -2.030764e-03 3 1  ON 51
ci_053                -2.197935e-03 3 1  ON 52
ci_054                -2.417575e-03 3 1  ON 53
ci_055                -1.122349e-03 3 1  ON 54
ci_056                -1.633235e-03 3 1  ON 55
ci_057                -1.238920e-03 3 1  ON 56
ci_058                -1.405590e-03 3 1  ON 57
ci_059                -7.796674e-04 3 1  ON 58
ci_060                -6.451228e-04 3 1  ON 59
ci_061                -9.045256e-04 3 1  ON 60
ci_062                -6.934679e-04 3 1  ON 61
ci_063                -5.560031e-04 3 1  ON 62
ci_064                -7.851085e-04 3 1  ON 63
ci_065                -1.895347e-03 3 1  ON 64
ci_066                -2.106645e-03 3 1  ON 65
ci_067                -1.432781e-03 3 1  ON 66
ci_068                -1.053040e-03 3 1  ON 67
ci_069                -5.032853e-05 3 1  ON 68
ci_070                 1.949793e-04 3 1  ON 69
ci_071                -1.810131e-03 3 1  ON 70
ci_072                -1.743291e-03 3 1  ON 71
ci_073                 4.649971e-04 3 1  ON 72
ci_074                 4.515470e-04 3 1  ON 73
ci_075                -8.041809e-05 3 1  ON 74
ci_076                -6.755733e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.6565
    reference variance = 0.263606
====================================================
  Execution time = 2.5808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5722e-01
  Total weights = 1.9548e+06
  Execution time = 3.6311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445732813325
                                         uncertainty =       0.003215258148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445732813325
                                         uncertainty =       0.003215258148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472034019
  error estimate for blocks of size 2^( 2) =       0.000495564011
  error estimate for blocks of size 2^( 3) =       0.000517187992
  error estimate for blocks of size 2^( 4) =       0.000533644505
  error estimate for blocks of size 2^( 5) =       0.000542415754
  error estimate for blocks of size 2^( 6) =       0.000547203490
  error estimate for blocks of size 2^( 7) =       0.000553978346

      target function =      -0.739229147709
              le_mean =     -22.662212331291
             les_mean =     514.033333733006
             stat err =       0.000544310524
             autocorr =       1.329679164714
   target nu stat err =       0.000544310524
   target dn stat err =       0.004709716374
      target stat err =       0.003855574467
              std dev =       0.667556912143
             le_variance =       0.445632230949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445419249729
                                         uncertainty =       0.003198290263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445419249729
                                         uncertainty =       0.003198290263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471868138
  error estimate for blocks of size 2^( 2) =       0.000495410800
  error estimate for blocks of size 2^( 3) =       0.000517048289
  error estimate for blocks of size 2^( 4) =       0.000533504580
  error estimate for blocks of size 2^( 5) =       0.000542277239
  error estimate for blocks of size 2^( 6) =       0.000547073443
  error estimate for blocks of size 2^( 7) =       0.000553850451

      target function =      -0.739545347946
              le_mean =     -22.662213793661
             les_mean =     514.033012579566
             stat err =       0.000544176428
             autocorr =       1.329958667276
   target nu stat err =       0.000544176428
   target dn stat err =       0.004368717250
      target stat err =       0.003586325881
              std dev =       0.667322321031
             le_variance =       0.445319080147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445564323213
                                         uncertainty =       0.003205199518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445564323213
                                         uncertainty =       0.003205199518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471944892
  error estimate for blocks of size 2^( 2) =       0.000495481489
  error estimate for blocks of size 2^( 3) =       0.000517112504
  error estimate for blocks of size 2^( 4) =       0.000533568889
  error estimate for blocks of size 2^( 5) =       0.000542340821
  error estimate for blocks of size 2^( 6) =       0.000547133293
  error estimate for blocks of size 2^( 7) =       0.000553909710

      target function =      -0.739524117815
              le_mean =     -22.662212766157
             les_mean =     514.032990854385
             stat err =       0.000544238178
             autocorr =       1.329827864994
   target nu stat err =       0.000544238178
   target dn stat err =       0.004512279293
      target stat err =       0.003700777828
              std dev =       0.667430866764
             le_variance =       0.445463961910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445710595396
                                         uncertainty =       0.003213782089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445710595396
                                         uncertainty =       0.003213782089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472022268
  error estimate for blocks of size 2^( 2) =       0.000495553112
  error estimate for blocks of size 2^( 3) =       0.000517177998
  error estimate for blocks of size 2^( 4) =       0.000533634529
  error estimate for blocks of size 2^( 5) =       0.000542405857
  error estimate for blocks of size 2^( 6) =       0.000547194187
  error estimate for blocks of size 2^( 7) =       0.000553969258

      target function =      -0.739279692428
              le_mean =     -22.662212336843
             les_mean =     514.033271778170
             stat err =       0.000544300958
             autocorr =       1.329698635245
   target nu stat err =       0.000544300958
   target dn stat err =       0.004681823770
      target stat err =       0.003833801902
              std dev =       0.667540292528
             le_variance =       0.445610042149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739229147709        initial
     1.0000e+00     1.0000e+01             3.4112e-04        -0.739545347946  <--
     4.0000e+00     4.0000e+01             8.7628e-05        -0.739524117815
     1.6000e+01     1.6000e+02             2.2059e-05        -0.739279692428

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 4.4019e+01
  </log>
  <optVariables href="FORM2.s002.opt.xml">
ci_001                -7.047754e-01 3 1  ON 0
ci_002                -7.026165e-01 3 1  ON 1
ci_003                -5.332907e-02 3 1  ON 2
ci_004                -5.384989e-02 3 1  ON 3
ci_005                 2.275270e-02 3 1  ON 4
ci_006                 2.284855e-02 3 1  ON 5
ci_007                 1.820605e-02 3 1  ON 6
ci_008                 1.853698e-02 3 1  ON 7
ci_009                -1.454687e-02 3 1  ON 8
ci_010                -1.437441e-02 3 1  ON 9
ci_011                -1.221854e-02 3 1  ON 10
ci_012                -1.170538e-02 3 1  ON 11
ci_013                 1.085947e-02 3 1  ON 12
ci_014                 1.064619e-02 3 1  ON 13
ci_015                 1.209201e-02 3 1  ON 14
ci_016                 1.185561e-02 3 1  ON 15
ci_017                 1.017333e-02 3 1  ON 16
ci_018                 1.027153e-02 3 1  ON 17
ci_019                 2.699956e-03 3 1  ON 18
ci_020                 2.794649e-03 3 1  ON 19
ci_021                -8.628588e-03 3 1  ON 20
ci_022                -8.579581e-03 3 1  ON 21
ci_023                 6.065733e-03 3 1  ON 22
ci_024                 6.237555e-03 3 1  ON 23
ci_025                 9.516566e-03 3 1  ON 24
ci_026                 9.353711e-03 3 1  ON 25
ci_027                 6.475144e-03 3 1  ON 26
ci_028                 6.614274e-03 3 1  ON 27
ci_029                -4.985274e-03 3 1  ON 28
ci_030                -5.106665e-03 3 1  ON 29
ci_031                -1.018325e-03 3 1  ON 30
ci_032                -1.101109e-03 3 1  ON 31
ci_033                 4.194733e-03 3 1  ON 32
ci_034                 4.107311e-03 3 1  ON 33
ci_035                 2.585250e-03 3 1  ON 34
ci_036                 2.650961e-03 3 1  ON 35
ci_037                 4.539258e-03 3 1  ON 36
ci_038                 4.465699e-03 3 1  ON 37
ci_039                 4.572444e-03 3 1  ON 38
ci_040                 4.603711e-03 3 1  ON 39
ci_041                 3.628064e-03 3 1  ON 40
ci_042                 3.442558e-03 3 1  ON 41
ci_043                 3.840818e-03 3 1  ON 42
ci_044                 3.995858e-03 3 1  ON 43
ci_045                 3.107790e-03 3 1  ON 44
ci_046                 3.069006e-03 3 1  ON 45
ci_047                -1.512596e-03 3 1  ON 46
ci_048                -1.639263e-03 3 1  ON 47
ci_049                 1.325183e-03 3 1  ON 48
ci_050                 1.465606e-03 3 1  ON 49
ci_051                -2.066424e-03 3 1  ON 50
ci_052                -2.027612e-03 3 1  ON 51
ci_053                -2.199576e-03 3 1  ON 52
ci_054                -2.432391e-03 3 1  ON 53
ci_055                -1.111502e-03 3 1  ON 54
ci_056                -1.551044e-03 3 1  ON 55
ci_057                -1.234725e-03 3 1  ON 56
ci_058                -1.362869e-03 3 1  ON 57
ci_059                -7.614128e-04 3 1  ON 58
ci_060                -6.374225e-04 3 1  ON 59
ci_061                -8.345621e-04 3 1  ON 60
ci_062                -7.124052e-04 3 1  ON 61
ci_063                -5.407408e-04 3 1  ON 62
ci_064                -7.765951e-04 3 1  ON 63
ci_065                -1.797622e-03 3 1  ON 64
ci_066                -2.139468e-03 3 1  ON 65
ci_067                -1.437229e-03 3 1  ON 66
ci_068                -9.560736e-04 3 1  ON 67
ci_069                -3.388074e-05 3 1  ON 68
ci_070                 2.034729e-04 3 1  ON 69
ci_071                -1.775516e-03 3 1  ON 70
ci_072                -1.749967e-03 3 1  ON 71
ci_073                 4.435194e-04 3 1  ON 72
ci_074                 4.133202e-04 3 1  ON 73
ci_075                -7.703574e-05 3 1  ON 74
ci_076                -7.008976e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2622e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.7321
    reference variance = 0.538619
====================================================
  Execution time = 2.6610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5322e-01
  Total weights = 1.954791660e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442672214357
                                         uncertainty =       0.002104255116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442672214357
                                         uncertainty =       0.002104255116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470511926
  error estimate for blocks of size 2^( 2) =       0.000493874230
  error estimate for blocks of size 2^( 3) =       0.000515258704
  error estimate for blocks of size 2^( 4) =       0.000531064432
  error estimate for blocks of size 2^( 5) =       0.000540365092
  error estimate for blocks of size 2^( 6) =       0.000545640754
  error estimate for blocks of size 2^( 7) =       0.000549153832

      target function =      -0.742690919945
              le_mean =     -22.661991201516
             les_mean =     514.019065390760
             stat err =       0.000541556028
             autocorr =       1.324785349920
   target nu stat err =       0.000541556028
   target dn stat err =       0.002819361466
      target stat err =       0.002376676069
              std dev =       0.665404346463
             le_variance =       0.442762944292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266199120152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742697620771       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742896732930       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742943537844       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742949216073       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742950412759       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742951569196       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742952000463       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742951963325       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742952092921       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742952120810       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742952110351       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742952120505       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.281956e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742697620771       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742754171255       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742766749780       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742768221316       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742768507095       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742768777830       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742768849993       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742768831983       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742768859563       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742768864827       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742768862443       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 3.336055e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742697620771       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742712256001       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742715458287       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742715828955       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742715899130       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742715965283       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742715981032       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742715976141       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742715982726       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742715983932       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742715983356       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+00 is 8.585280e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1394e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_001                -7.044993e-01 3 1  ON 0
ci_002                -7.029396e-01 3 1  ON 1
ci_003                -5.332284e-02 3 1  ON 2
ci_004                -5.388551e-02 3 1  ON 3
ci_005                 2.251667e-02 3 1  ON 4
ci_006                 2.267782e-02 3 1  ON 5
ci_007                 1.795208e-02 3 1  ON 6
ci_008                 1.832250e-02 3 1  ON 7
ci_009                -1.438983e-02 3 1  ON 8
ci_010                -1.422501e-02 3 1  ON 9
ci_011                -1.207399e-02 3 1  ON 10
ci_012                -1.158836e-02 3 1  ON 11
ci_013                 1.073337e-02 3 1  ON 12
ci_014                 1.061711e-02 3 1  ON 13
ci_015                 1.184643e-02 3 1  ON 14
ci_016                 1.172805e-02 3 1  ON 15
ci_017                 1.017707e-02 3 1  ON 16
ci_018                 1.008441e-02 3 1  ON 17
ci_019                 2.366350e-03 3 1  ON 18
ci_020                 2.476477e-03 3 1  ON 19
ci_021                -8.769143e-03 3 1  ON 20
ci_022                -8.740988e-03 3 1  ON 21
ci_023                 6.011416e-03 3 1  ON 22
ci_024                 6.179727e-03 3 1  ON 23
ci_025                 9.622246e-03 3 1  ON 24
ci_026                 9.540522e-03 3 1  ON 25
ci_027                 6.488129e-03 3 1  ON 26
ci_028                 6.605616e-03 3 1  ON 27
ci_029                -4.935297e-03 3 1  ON 28
ci_030                -5.056309e-03 3 1  ON 29
ci_031                -7.677954e-04 3 1  ON 30
ci_032                -8.275762e-04 3 1  ON 31
ci_033                 4.130594e-03 3 1  ON 32
ci_034                 4.025285e-03 3 1  ON 33
ci_035                 2.532553e-03 3 1  ON 34
ci_036                 2.579409e-03 3 1  ON 35
ci_037                 4.459972e-03 3 1  ON 36
ci_038                 4.470198e-03 3 1  ON 37
ci_039                 4.599826e-03 3 1  ON 38
ci_040                 4.631116e-03 3 1  ON 39
ci_041                 3.621698e-03 3 1  ON 40
ci_042                 3.428797e-03 3 1  ON 41
ci_043                 3.844739e-03 3 1  ON 42
ci_044                 3.943691e-03 3 1  ON 43
ci_045                 3.014822e-03 3 1  ON 44
ci_046                 3.041677e-03 3 1  ON 45
ci_047                -1.466102e-03 3 1  ON 46
ci_048                -1.581477e-03 3 1  ON 47
ci_049                 1.268528e-03 3 1  ON 48
ci_050                 1.376622e-03 3 1  ON 49
ci_051                -2.016956e-03 3 1  ON 50
ci_052                -1.998163e-03 3 1  ON 51
ci_053                -2.272083e-03 3 1  ON 52
ci_054                -2.342604e-03 3 1  ON 53
ci_055                -1.176320e-03 3 1  ON 54
ci_056                -1.553390e-03 3 1  ON 55
ci_057                -1.230567e-03 3 1  ON 56
ci_058                -1.406617e-03 3 1  ON 57
ci_059                -7.440370e-04 3 1  ON 58
ci_060                -5.914196e-04 3 1  ON 59
ci_061                -7.890770e-04 3 1  ON 60
ci_062                -6.577222e-04 3 1  ON 61
ci_063                -5.361384e-04 3 1  ON 62
ci_064                -7.456459e-04 3 1  ON 63
ci_065                -1.785907e-03 3 1  ON 64
ci_066                -2.064549e-03 3 1  ON 65
ci_067                -1.439042e-03 3 1  ON 66
ci_068                -1.045262e-03 3 1  ON 67
ci_069                -7.831207e-05 3 1  ON 68
ci_070                 2.438964e-04 3 1  ON 69
ci_071                -1.767450e-03 3 1  ON 70
ci_072                -1.719765e-03 3 1  ON 71
ci_073                 4.301071e-04 3 1  ON 72
ci_074                 3.633993e-04 3 1  ON 73
ci_075                -4.518232e-05 3 1  ON 74
ci_076                -5.150963e-05 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.6573
    reference variance = 0.570816
====================================================
  Execution time = 2.5723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5086e-01
  Total weights = 1.9551e+06
  Execution time = 3.6234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443539014858
                                         uncertainty =       0.004056986209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443539014858
                                         uncertainty =       0.004056986209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470882056
  error estimate for blocks of size 2^( 2) =       0.000494720486
  error estimate for blocks of size 2^( 3) =       0.000516004692
  error estimate for blocks of size 2^( 4) =       0.000531635504
  error estimate for blocks of size 2^( 5) =       0.000540818148
  error estimate for blocks of size 2^( 6) =       0.000546001098
  error estimate for blocks of size 2^( 7) =       0.000545977393

      target function =      -0.742843128499
              le_mean =     -22.662681496270
             les_mean =     514.050156075611
             stat err =       0.000541108036
             autocorr =       1.320516053735
   target nu stat err =       0.000541108036
   target dn stat err =       0.004485512223
      target stat err =       0.003714085992
              std dev =       0.665927789437
             le_variance =       0.443459820744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442874003477
                                         uncertainty =       0.003959606424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442874003477
                                         uncertainty =       0.003959606424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470528613
  error estimate for blocks of size 2^( 2) =       0.000494398775
  error estimate for blocks of size 2^( 3) =       0.000515711122
  error estimate for blocks of size 2^( 4) =       0.000531332526
  error estimate for blocks of size 2^( 5) =       0.000540522690
  error estimate for blocks of size 2^( 6) =       0.000545704220
  error estimate for blocks of size 2^( 7) =       0.000545665443

      target function =      -0.743460625476
              le_mean =     -22.662676853768
             les_mean =     514.049193981344
             stat err =       0.000540806220
             autocorr =       1.321025736372
   target nu stat err =       0.000540806220
   target dn stat err =       0.004140176939
      target stat err =       0.003441322409
              std dev =       0.665427946400
             le_variance =       0.442794351851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443143258157
                                         uncertainty =       0.004001819212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443143258157
                                         uncertainty =       0.004001819212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470671771
  error estimate for blocks of size 2^( 2) =       0.000494528700
  error estimate for blocks of size 2^( 3) =       0.000515828104
  error estimate for blocks of size 2^( 4) =       0.000531455489
  error estimate for blocks of size 2^( 5) =       0.000540641675
  error estimate for blocks of size 2^( 6) =       0.000545820037
  error estimate for blocks of size 2^( 7) =       0.000545783147

      target function =      -0.731102705376
              le_mean =     -22.662676276543
             les_mean =     514.064213240299
             stat err =       0.000540925087
             autocorr =       1.320802683715
   target nu stat err =       0.000540925087
   target dn stat err =       0.017306577967
      target stat err =       0.013718171828
              std dev =       0.665630402607
             le_variance =       0.443063832875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443484476453
                                         uncertainty =       0.004049575813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443484476453
                                         uncertainty =       0.004049575813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470853087
  error estimate for blocks of size 2^( 2) =       0.000494694864
  error estimate for blocks of size 2^( 3) =       0.000515981144
  error estimate for blocks of size 2^( 4) =       0.000531610575
  error estimate for blocks of size 2^( 5) =       0.000540797489
  error estimate for blocks of size 2^( 6) =       0.000545980370
  error estimate for blocks of size 2^( 7) =       0.000545948230

      target function =      -0.727620556235
              le_mean =     -22.662680815532
             les_mean =     514.068713323002
             stat err =       0.000541084166
             autocorr =       1.320562033574
   target nu stat err =       0.000541084166
   target dn stat err =       0.020420744940
      target stat err =       0.016031044066
              std dev =       0.665886821033
             le_variance =       0.443405258426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742843128499        initial
     2.5000e-01     2.5000e+00             1.2820e-03        -0.743460625476  <--
     1.0000e+00     1.0000e+01             3.3361e-04        -0.731102705376
     4.0000e+00     4.0000e+01             8.5853e-05        -0.727620556235

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.5839e+01
  </log>
  <optVariables href="FORM2.s003.opt.xml">
ci_001                -7.036597e-01 3 1  ON 0
ci_002                -7.038984e-01 3 1  ON 1
ci_003                -5.330691e-02 3 1  ON 2
ci_004                -5.398853e-02 3 1  ON 3
ci_005                 2.192616e-02 3 1  ON 4
ci_006                 2.225382e-02 3 1  ON 5
ci_007                 1.729923e-02 3 1  ON 6
ci_008                 1.777496e-02 3 1  ON 7
ci_009                -1.398911e-02 3 1  ON 8
ci_010                -1.384584e-02 3 1  ON 9
ci_011                -1.169950e-02 3 1  ON 10
ci_012                -1.128836e-02 3 1  ON 11
ci_013                 1.040739e-02 3 1  ON 12
ci_014                 1.054544e-02 3 1  ON 13
ci_015                 1.120801e-02 3 1  ON 14
ci_016                 1.139519e-02 3 1  ON 15
ci_017                 1.018964e-02 3 1  ON 16
ci_018                 9.605956e-03 3 1  ON 17
ci_019                 1.501917e-03 3 1  ON 18
ci_020                 1.645359e-03 3 1  ON 19
ci_021                -9.128152e-03 3 1  ON 20
ci_022                -9.164516e-03 3 1  ON 21
ci_023                 5.873543e-03 3 1  ON 22
ci_024                 6.034778e-03 3 1  ON 23
ci_025                 9.900948e-03 3 1  ON 24
ci_026                 1.003474e-02 3 1  ON 25
ci_027                 6.520083e-03 3 1  ON 26
ci_028                 6.586219e-03 3 1  ON 27
ci_029                -4.805388e-03 3 1  ON 28
ci_030                -4.928422e-03 3 1  ON 29
ci_031                -1.192589e-04 3 1  ON 30
ci_032                -1.136904e-04 3 1  ON 31
ci_033                 3.966454e-03 3 1  ON 32
ci_034                 3.815094e-03 3 1  ON 33
ci_035                 2.401567e-03 3 1  ON 34
ci_036                 2.402756e-03 3 1  ON 35
ci_037                 4.254718e-03 3 1  ON 36
ci_038                 4.483152e-03 3 1  ON 37
ci_039                 4.667038e-03 3 1  ON 38
ci_040                 4.700661e-03 3 1  ON 39
ci_041                 3.605162e-03 3 1  ON 40
ci_042                 3.395487e-03 3 1  ON 41
ci_043                 3.852606e-03 3 1  ON 42
ci_044                 3.807239e-03 3 1  ON 43
ci_045                 2.776256e-03 3 1  ON 44
ci_046                 2.974643e-03 3 1  ON 45
ci_047                -1.349340e-03 3 1  ON 46
ci_048                -1.437109e-03 3 1  ON 47
ci_049                 1.123521e-03 3 1  ON 48
ci_050                 1.148814e-03 3 1  ON 49
ci_051                -1.884191e-03 3 1  ON 50
ci_052                -1.917998e-03 3 1  ON 51
ci_053                -2.460375e-03 3 1  ON 52
ci_054                -2.116641e-03 3 1  ON 53
ci_055                -1.343178e-03 3 1  ON 54
ci_056                -1.560190e-03 3 1  ON 55
ci_057                -1.219258e-03 3 1  ON 56
ci_058                -1.517154e-03 3 1  ON 57
ci_059                -6.991529e-04 3 1  ON 58
ci_060                -4.753328e-04 3 1  ON 59
ci_061                -6.720504e-04 3 1  ON 60
ci_062                -5.156236e-04 3 1  ON 61
ci_063                -5.277525e-04 3 1  ON 62
ci_064                -6.686599e-04 3 1  ON 63
ci_065                -1.754101e-03 3 1  ON 64
ci_066                -1.871388e-03 3 1  ON 65
ci_067                -1.443327e-03 3 1  ON 66
ci_068                -1.276356e-03 3 1  ON 67
ci_069                -1.920017e-04 3 1  ON 68
ci_070                 3.460349e-04 3 1  ON 69
ci_071                -1.743799e-03 3 1  ON 70
ci_072                -1.639604e-03 3 1  ON 71
ci_073                 3.965879e-04 3 1  ON 72
ci_074                 2.367013e-04 3 1  ON 73
ci_075                 3.642955e-05 3 1  ON 74
ci_076                -3.324126e-06 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2640e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6447
    reference variance = 0.298282
====================================================
  Execution time = 2.6498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5291e-01
  Total weights = 1.955073748e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444897630904
                                         uncertainty =       0.002313175667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444897630904
                                         uncertainty =       0.002313175667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471654646
  error estimate for blocks of size 2^( 2) =       0.000495422857
  error estimate for blocks of size 2^( 3) =       0.000517171920
  error estimate for blocks of size 2^( 4) =       0.000532828570
  error estimate for blocks of size 2^( 5) =       0.000541650427
  error estimate for blocks of size 2^( 6) =       0.000546798961
  error estimate for blocks of size 2^( 7) =       0.000545351831

      target function =      -0.742939912395
              le_mean =     -22.662041260469
             les_mean =     514.021028992881
             stat err =       0.000541657448
             autocorr =       1.318867616050
   target nu stat err =       0.000541657448
   target dn stat err =       0.002915625011
      target stat err =       0.002454622654
              std dev =       0.667020396856
             le_variance =       0.444916209822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266204126047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742947081574       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743516329516       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743609643257       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743624761217       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743632439972       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743635468635       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743636833067       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743636952080       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743637189044       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743637361987       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743637572573       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743637669704       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743637680981       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743637683587       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 5.074784e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742947081574       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743159454455       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743190241079       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743194397462       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743196492057       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743197034537       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743197225574       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743197223776       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743197276933       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743197325408       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743197360039       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743197357553       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.517438e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742947081574       residual = 5.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743007619144       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743015947638       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743016982969       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743017507137       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743017619631       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743017655442       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743017653968       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743017666791       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743017678910       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743017685017       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743017683473       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 4.004450e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028058 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1251e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_001                -7.039610e-01 3 1  ON 0
ci_002                -7.038201e-01 3 1  ON 1
ci_003                -5.333280e-02 3 1  ON 2
ci_004                -5.247109e-02 3 1  ON 3
ci_005                 2.120440e-02 3 1  ON 4
ci_006                 2.169333e-02 3 1  ON 5
ci_007                 1.675103e-02 3 1  ON 6
ci_008                 1.721831e-02 3 1  ON 7
ci_009                -1.387381e-02 3 1  ON 8
ci_010                -1.356146e-02 3 1  ON 9
ci_011                -1.136046e-02 3 1  ON 10
ci_012                -1.087119e-02 3 1  ON 11
ci_013                 9.409101e-03 3 1  ON 12
ci_014                 1.051656e-02 3 1  ON 13
ci_015                 1.089211e-02 3 1  ON 14
ci_016                 1.076383e-02 3 1  ON 15
ci_017                 9.757132e-03 3 1  ON 16
ci_018                 9.490025e-03 3 1  ON 17
ci_019                 8.059003e-04 3 1  ON 18
ci_020                 8.573817e-04 3 1  ON 19
ci_021                -9.822420e-03 3 1  ON 20
ci_022                -9.758014e-03 3 1  ON 21
ci_023                 5.621256e-03 3 1  ON 22
ci_024                 5.870758e-03 3 1  ON 23
ci_025                 1.046020e-02 3 1  ON 24
ci_026                 1.072800e-02 3 1  ON 25
ci_027                 6.436680e-03 3 1  ON 26
ci_028                 6.649474e-03 3 1  ON 27
ci_029                -4.731470e-03 3 1  ON 28
ci_030                -4.849106e-03 3 1  ON 29
ci_031                 4.337800e-04 3 1  ON 30
ci_032                 1.039496e-03 3 1  ON 31
ci_033                 3.919415e-03 3 1  ON 32
ci_034                 3.782726e-03 3 1  ON 33
ci_035                 2.311241e-03 3 1  ON 34
ci_036                 2.367750e-03 3 1  ON 35
ci_037                 4.302582e-03 3 1  ON 36
ci_038                 4.359762e-03 3 1  ON 37
ci_039                 4.496037e-03 3 1  ON 38
ci_040                 4.805823e-03 3 1  ON 39
ci_041                 3.608591e-03 3 1  ON 40
ci_042                 3.401652e-03 3 1  ON 41
ci_043                 3.684589e-03 3 1  ON 42
ci_044                 3.519749e-03 3 1  ON 43
ci_045                 2.591466e-03 3 1  ON 44
ci_046                 3.009454e-03 3 1  ON 45
ci_047                -1.293835e-03 3 1  ON 46
ci_048                -1.228952e-03 3 1  ON 47
ci_049                 1.201531e-03 3 1  ON 48
ci_050                 1.074822e-03 3 1  ON 49
ci_051                -1.822725e-03 3 1  ON 50
ci_052                -2.019771e-03 3 1  ON 51
ci_053                -2.356101e-03 3 1  ON 52
ci_054                -1.999250e-03 3 1  ON 53
ci_055                -1.509772e-03 3 1  ON 54
ci_056                -1.495293e-03 3 1  ON 55
ci_057                -1.073879e-03 3 1  ON 56
ci_058                -1.424857e-03 3 1  ON 57
ci_059                -6.275962e-04 3 1  ON 58
ci_060                -4.177002e-04 3 1  ON 59
ci_061                -4.672563e-04 3 1  ON 60
ci_062                -4.871964e-04 3 1  ON 61
ci_063                -5.635838e-04 3 1  ON 62
ci_064                -6.212185e-04 3 1  ON 63
ci_065                -1.583357e-03 3 1  ON 64
ci_066                -1.741375e-03 3 1  ON 65
ci_067                -1.458213e-03 3 1  ON 66
ci_068                -1.272885e-03 3 1  ON 67
ci_069                -3.281183e-04 3 1  ON 68
ci_070                -3.930324e-04 3 1  ON 69
ci_071                -1.662434e-03 3 1  ON 70
ci_072                -1.400264e-03 3 1  ON 71
ci_073                 3.665698e-04 3 1  ON 72
ci_074                 4.298561e-04 3 1  ON 73
ci_075                -1.395108e-04 3 1  ON 74
ci_076                 1.041937e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.6769
    reference variance = 0.302447
====================================================
  Execution time = 2.6054e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5233e-01
  Total weights = 1.9556e+06
  Execution time = 3.6101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450992571688
                                         uncertainty =       0.008133225743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.450992571688
                                         uncertainty =       0.008133225743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000474843256
  error estimate for blocks of size 2^( 2) =       0.000498262511
  error estimate for blocks of size 2^( 3) =       0.000520106481
  error estimate for blocks of size 2^( 4) =       0.000535087981
  error estimate for blocks of size 2^( 5) =       0.000544946379
  error estimate for blocks of size 2^( 6) =       0.000549434464
  error estimate for blocks of size 2^( 7) =       0.000553704442

      target function =      -0.346482801167
              le_mean =     -22.661603130027
             les_mean =     514.725258657227
             stat err =       0.000545793317
             autocorr =       1.321161403543
   target nu stat err =       0.000545793317
   target dn stat err =       0.720535182497
      target stat err =       0.152756587472
              std dev =       0.671529772877
             le_variance =       0.450952235860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444290312716
                                         uncertainty =       0.002552008671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444290312716
                                         uncertainty =       0.002552008671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471299754
  error estimate for blocks of size 2^( 2) =       0.000494934058
  error estimate for blocks of size 2^( 3) =       0.000516984007
  error estimate for blocks of size 2^( 4) =       0.000532164719
  error estimate for blocks of size 2^( 5) =       0.000541998390
  error estimate for blocks of size 2^( 6) =       0.000546776690
  error estimate for blocks of size 2^( 7) =       0.000551018747

      target function =      -0.684779182904
              le_mean =     -22.661562300549
             les_mean =     514.073828137684
             stat err =       0.000542989636
             autocorr =       1.327359785948
   target nu stat err =       0.000542989636
   target dn stat err =       0.052643068040
      target stat err =       0.036609505468
              std dev =       0.666518503398
             le_variance =       0.444246915371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442769079547
                                         uncertainty =       0.002139586143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442769079547
                                         uncertainty =       0.002139586143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470494042
  error estimate for blocks of size 2^( 2) =       0.000494157383
  error estimate for blocks of size 2^( 3) =       0.000516217573
  error estimate for blocks of size 2^( 4) =       0.000531438378
  error estimate for blocks of size 2^( 5) =       0.000541323273
  error estimate for blocks of size 2^( 6) =       0.000546179940
  error estimate for blocks of size 2^( 7) =       0.000550427255

      target function =      -0.713389548892
              le_mean =     -22.661506233765
             les_mean =     514.033259359706
             stat err =       0.000542342212
             autocorr =       1.328735564857
   target nu stat err =       0.000542342212
   target dn stat err =       0.034237580433
      target stat err =       0.025802242069
              std dev =       0.665379054917
             le_variance =       0.442729286723

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443548313672
                                         uncertainty =       0.002233899087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443548313672
                                         uncertainty =       0.002233899087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470907698
  error estimate for blocks of size 2^( 2) =       0.000494542930
  error estimate for blocks of size 2^( 3) =       0.000516552535
  error estimate for blocks of size 2^( 4) =       0.000531711720
  error estimate for blocks of size 2^( 5) =       0.000541597897
  error estimate for blocks of size 2^( 6) =       0.000546341564
  error estimate for blocks of size 2^( 7) =       0.000550560997

      target function =      -0.271233622036
              le_mean =     -22.661516178172
             les_mean =     515.032675486046
             stat err =       0.000542553045
             autocorr =       1.327433671423
   target nu stat err =       0.000542553045
   target dn stat err =       1.032891698704
      target stat err =       0.143979669585
              std dev =       0.665964053227
             le_variance =       0.443508120191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.346482801167        initial
     6.2500e-02     6.2500e-01             5.0748e-03        -0.684779182904
     2.5000e-01     2.5000e+00             1.5174e-03        -0.713389548892  <--
     1.0000e+00     1.0000e+01             4.0044e-04        -0.271233622036

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.4217e+01
  </log>
  <optVariables href="FORM2.s004.opt.xml">
ci_001                -7.039610e-01 3 1  ON 0
ci_002                -7.038201e-01 3 1  ON 1
ci_003                -5.333280e-02 3 1  ON 2
ci_004                -5.247109e-02 3 1  ON 3
ci_005                 2.120440e-02 3 1  ON 4
ci_006                 2.169333e-02 3 1  ON 5
ci_007                 1.675103e-02 3 1  ON 6
ci_008                 1.721831e-02 3 1  ON 7
ci_009                -1.387381e-02 3 1  ON 8
ci_010                -1.356146e-02 3 1  ON 9
ci_011                -1.136046e-02 3 1  ON 10
ci_012                -1.087119e-02 3 1  ON 11
ci_013                 9.409101e-03 3 1  ON 12
ci_014                 1.051656e-02 3 1  ON 13
ci_015                 1.089211e-02 3 1  ON 14
ci_016                 1.076383e-02 3 1  ON 15
ci_017                 9.757132e-03 3 1  ON 16
ci_018                 9.490025e-03 3 1  ON 17
ci_019                 8.059003e-04 3 1  ON 18
ci_020                 8.573817e-04 3 1  ON 19
ci_021                -9.822420e-03 3 1  ON 20
ci_022                -9.758014e-03 3 1  ON 21
ci_023                 5.621256e-03 3 1  ON 22
ci_024                 5.870758e-03 3 1  ON 23
ci_025                 1.046020e-02 3 1  ON 24
ci_026                 1.072800e-02 3 1  ON 25
ci_027                 6.436680e-03 3 1  ON 26
ci_028                 6.649474e-03 3 1  ON 27
ci_029                -4.731470e-03 3 1  ON 28
ci_030                -4.849106e-03 3 1  ON 29
ci_031                 4.337800e-04 3 1  ON 30
ci_032                 1.039496e-03 3 1  ON 31
ci_033                 3.919415e-03 3 1  ON 32
ci_034                 3.782726e-03 3 1  ON 33
ci_035                 2.311241e-03 3 1  ON 34
ci_036                 2.367750e-03 3 1  ON 35
ci_037                 4.302582e-03 3 1  ON 36
ci_038                 4.359762e-03 3 1  ON 37
ci_039                 4.496037e-03 3 1  ON 38
ci_040                 4.805823e-03 3 1  ON 39
ci_041                 3.608591e-03 3 1  ON 40
ci_042                 3.401652e-03 3 1  ON 41
ci_043                 3.684589e-03 3 1  ON 42
ci_044                 3.519749e-03 3 1  ON 43
ci_045                 2.591466e-03 3 1  ON 44
ci_046                 3.009454e-03 3 1  ON 45
ci_047                -1.293835e-03 3 1  ON 46
ci_048                -1.228952e-03 3 1  ON 47
ci_049                 1.201531e-03 3 1  ON 48
ci_050                 1.074822e-03 3 1  ON 49
ci_051                -1.822725e-03 3 1  ON 50
ci_052                -2.019771e-03 3 1  ON 51
ci_053                -2.356101e-03 3 1  ON 52
ci_054                -1.999250e-03 3 1  ON 53
ci_055                -1.509772e-03 3 1  ON 54
ci_056                -1.495293e-03 3 1  ON 55
ci_057                -1.073879e-03 3 1  ON 56
ci_058                -1.424857e-03 3 1  ON 57
ci_059                -6.275962e-04 3 1  ON 58
ci_060                -4.177002e-04 3 1  ON 59
ci_061                -4.672563e-04 3 1  ON 60
ci_062                -4.871964e-04 3 1  ON 61
ci_063                -5.635838e-04 3 1  ON 62
ci_064                -6.212185e-04 3 1  ON 63
ci_065                -1.583357e-03 3 1  ON 64
ci_066                -1.741375e-03 3 1  ON 65
ci_067                -1.458213e-03 3 1  ON 66
ci_068                -1.272885e-03 3 1  ON 67
ci_069                -3.281183e-04 3 1  ON 68
ci_070                -3.930324e-04 3 1  ON 69
ci_071                -1.662434e-03 3 1  ON 70
ci_072                -1.400264e-03 3 1  ON 71
ci_073                 3.665698e-04 3 1  ON 72
ci_074                 4.298561e-04 3 1  ON 73
ci_075                -1.395108e-04 3 1  ON 74
ci_076                 1.041937e-03 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5475e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2644e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6759
    reference variance = 0.303619
====================================================
  Execution time = 2.6568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4992e-01
  Total weights = 1.955205934e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439766680881
                                         uncertainty =       0.002053872653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439766680881
                                         uncertainty =       0.002053872653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468923110
  error estimate for blocks of size 2^( 2) =       0.000493005226
  error estimate for blocks of size 2^( 3) =       0.000514803712
  error estimate for blocks of size 2^( 4) =       0.000529620781
  error estimate for blocks of size 2^( 5) =       0.000539395400
  error estimate for blocks of size 2^( 6) =       0.000545914556
  error estimate for blocks of size 2^( 7) =       0.000547769491

      target function =      -0.745391496127
              le_mean =     -22.661404575308
             les_mean =     513.989176105978
             stat err =       0.000540675057
             autocorr =       1.329442001752
   target nu stat err =       0.000540675057
   target dn stat err =       0.002482246829
      target stat err =       0.002124086731
              std dev =       0.663157422368
             le_variance =       0.439777766842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266140457531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745396636986       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745751452910       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745829786182       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745839378143       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745844451617       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745845991666       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745847555557       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745847472923       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745847868861       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745847465235       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745847381053       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745847658166       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745847640031       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 3.443040e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745396636986       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745527939615       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745553360043       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745556113982       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745557456113       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745557646825       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745557944095       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745557876084       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745557958217       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745557853857       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745557855226       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745557892491       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 1.029359e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745396636986       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745433938530       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745440762982       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745441464810       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745441795628       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745441824150       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745441889870       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745441870075       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745441888760       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745441864404       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745441865940       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745441873017       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.862357e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.033210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1317e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_001                -7.045158e-01 3 1  ON 0
ci_002                -7.034825e-01 3 1  ON 1
ci_003                -5.231220e-02 3 1  ON 2
ci_004                -5.203465e-02 3 1  ON 3
ci_005                 2.061775e-02 3 1  ON 4
ci_006                 2.120484e-02 3 1  ON 5
ci_007                 1.592978e-02 3 1  ON 6
ci_008                 1.679171e-02 3 1  ON 7
ci_009                -1.373773e-02 3 1  ON 8
ci_010                -1.308241e-02 3 1  ON 9
ci_011                -1.111013e-02 3 1  ON 10
ci_012                -1.042281e-02 3 1  ON 11
ci_013                 9.151190e-03 3 1  ON 12
ci_014                 1.025050e-02 3 1  ON 13
ci_015                 1.058536e-02 3 1  ON 14
ci_016                 1.044746e-02 3 1  ON 15
ci_017                 9.383263e-03 3 1  ON 16
ci_018                 9.139189e-03 3 1  ON 17
ci_019                 4.012559e-04 3 1  ON 18
ci_020                 1.688103e-04 3 1  ON 19
ci_021                -1.038914e-02 3 1  ON 20
ci_022                -1.025641e-02 3 1  ON 21
ci_023                 5.359423e-03 3 1  ON 22
ci_024                 5.617731e-03 3 1  ON 23
ci_025                 1.065363e-02 3 1  ON 24
ci_026                 1.093242e-02 3 1  ON 25
ci_027                 6.481468e-03 3 1  ON 26
ci_028                 6.507035e-03 3 1  ON 27
ci_029                -4.910853e-03 3 1  ON 28
ci_030                -4.700326e-03 3 1  ON 29
ci_031                 1.244915e-03 3 1  ON 30
ci_032                 2.068855e-03 3 1  ON 31
ci_033                 3.410850e-03 3 1  ON 32
ci_034                 3.890562e-03 3 1  ON 33
ci_035                 2.161447e-03 3 1  ON 34
ci_036                 2.355253e-03 3 1  ON 35
ci_037                 4.085095e-03 3 1  ON 36
ci_038                 4.139712e-03 3 1  ON 37
ci_039                 4.524310e-03 3 1  ON 38
ci_040                 4.912097e-03 3 1  ON 39
ci_041                 3.355955e-03 3 1  ON 40
ci_042                 3.137893e-03 3 1  ON 41
ci_043                 3.393165e-03 3 1  ON 42
ci_044                 3.363081e-03 3 1  ON 43
ci_045                 2.480473e-03 3 1  ON 44
ci_046                 2.880846e-03 3 1  ON 45
ci_047                -1.171273e-03 3 1  ON 46
ci_048                -1.109835e-03 3 1  ON 47
ci_049                 1.088112e-03 3 1  ON 48
ci_050                 1.077227e-03 3 1  ON 49
ci_051                -1.201471e-03 3 1  ON 50
ci_052                -1.746945e-03 3 1  ON 51
ci_053                -2.288448e-03 3 1  ON 52
ci_054                -2.199651e-03 3 1  ON 53
ci_055                -1.729077e-03 3 1  ON 54
ci_056                -1.674771e-03 3 1  ON 55
ci_057                -1.232100e-03 3 1  ON 56
ci_058                -1.267085e-03 3 1  ON 57
ci_059                -6.703856e-04 3 1  ON 58
ci_060                -5.987853e-04 3 1  ON 59
ci_061                -3.487835e-04 3 1  ON 60
ci_062                -5.725068e-04 3 1  ON 61
ci_063                -6.831746e-04 3 1  ON 62
ci_064                -6.118761e-04 3 1  ON 63
ci_065                -1.551598e-03 3 1  ON 64
ci_066                -1.745951e-03 3 1  ON 65
ci_067                -1.434277e-03 3 1  ON 66
ci_068                -1.330795e-03 3 1  ON 67
ci_069                -4.308465e-04 3 1  ON 68
ci_070                -4.474642e-04 3 1  ON 69
ci_071                -1.822634e-03 3 1  ON 70
ci_072                -1.621932e-03 3 1  ON 71
ci_073                 2.991767e-04 3 1  ON 72
ci_074                 3.430966e-04 3 1  ON 73
ci_075                 1.857237e-05 3 1  ON 74
ci_076                 9.656702e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.6619
    reference variance = 0.451507
====================================================
  Execution time = 2.6008e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4820e-01
  Total weights = 1.9553e+06
  Execution time = 3.6046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437811158982
                                         uncertainty =       0.001833244524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437811158982
                                         uncertainty =       0.001833244524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467863295
  error estimate for blocks of size 2^( 2) =       0.000491610471
  error estimate for blocks of size 2^( 3) =       0.000512787027
  error estimate for blocks of size 2^( 4) =       0.000528082469
  error estimate for blocks of size 2^( 5) =       0.000537316468
  error estimate for blocks of size 2^( 6) =       0.000541940472
  error estimate for blocks of size 2^( 7) =       0.000543943921

      target function =      -0.706597077200
              le_mean =     -22.662410767229
             les_mean =     514.082233897643
             stat err =       0.000537820833
             autocorr =       1.321409095546
   target nu stat err =       0.000537820833
   target dn stat err =       0.047007560589
      target stat err =       0.034836123580
              std dev =       0.661658616784
             le_variance =       0.437792125165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436887900632
                                         uncertainty =       0.001816782736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436887900632
                                         uncertainty =       0.001816782736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467370314
  error estimate for blocks of size 2^( 2) =       0.000491197970
  error estimate for blocks of size 2^( 3) =       0.000512448122
  error estimate for blocks of size 2^( 4) =       0.000527801466
  error estimate for blocks of size 2^( 5) =       0.000537041639
  error estimate for blocks of size 2^( 6) =       0.000541655539
  error estimate for blocks of size 2^( 7) =       0.000543576226

      target function =      -0.745561477112
              le_mean =     -22.662463267536
             les_mean =     514.036959697976
             stat err =       0.000537518717
             autocorr =       1.322710912438
   target nu stat err =       0.000537518717
   target dn stat err =       0.003238341521
      target stat err =       0.002730498616
              std dev =       0.660961436169
             le_variance =       0.436870020103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437006679429
                                         uncertainty =       0.001816408324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437006679429
                                         uncertainty =       0.001816408324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467433752
  error estimate for blocks of size 2^( 2) =       0.000491243496
  error estimate for blocks of size 2^( 3) =       0.000512476386
  error estimate for blocks of size 2^( 4) =       0.000527818155
  error estimate for blocks of size 2^( 5) =       0.000537057799
  error estimate for blocks of size 2^( 6) =       0.000541682795
  error estimate for blocks of size 2^( 7) =       0.000543624339

      target function =      -0.744077158038
              le_mean =     -22.662432586851
             les_mean =     514.037371897545
             stat err =       0.000537545772
             autocorr =       1.322485027665
   target nu stat err =       0.000537545772
   target dn stat err =       0.003769886505
      target stat err =       0.003146484028
              std dev =       0.661051151431
             le_variance =       0.436988624808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437655855483
                                         uncertainty =       0.001829289034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437655855483
                                         uncertainty =       0.001829289034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467780400
  error estimate for blocks of size 2^( 2) =       0.000491536642
  error estimate for blocks of size 2^( 3) =       0.000512721291
  error estimate for blocks of size 2^( 4) =       0.000528023437
  error estimate for blocks of size 2^( 5) =       0.000537252833
  error estimate for blocks of size 2^( 6) =       0.000541877848
  error estimate for blocks of size 2^( 7) =       0.000543871500

      target function =      -0.744044510823
              le_mean =     -22.662410111681
             les_mean =     514.036393998680
             stat err =       0.000537756404
             autocorr =       1.321560776448
   target nu stat err =       0.000537756404
   target dn stat err =       0.003644124468
      target stat err =       0.003044976319
              std dev =       0.661541386156
             le_variance =       0.437637005597


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.706597077200        initial
     6.2500e-02     6.2500e-01             3.4430e-03        -0.745561477112  <--
     2.5000e-01     2.5000e+00             1.0294e-03        -0.744077158038
     1.0000e+00     1.0000e+01             2.8624e-04        -0.744044510823

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 4.4123e+01
  </log>
  <optVariables href="FORM2.s005.opt.xml">
ci_001                -7.060612e-01 3 1  ON 0
ci_002                -7.023777e-01 3 1  ON 1
ci_003                -4.988976e-02 3 1  ON 2
ci_004                -5.101904e-02 3 1  ON 3
ci_005                 1.966433e-02 3 1  ON 4
ci_006                 2.038909e-02 3 1  ON 5
ci_007                 1.448309e-02 3 1  ON 6
ci_008                 1.603038e-02 3 1  ON 7
ci_009                -1.354652e-02 3 1  ON 8
ci_010                -1.224196e-02 3 1  ON 9
ci_011                -1.069723e-02 3 1  ON 10
ci_012                -9.619864e-03 3 1  ON 11
ci_013                 8.718599e-03 3 1  ON 12
ci_014                 9.792656e-03 3 1  ON 13
ci_015                 1.001499e-02 3 1  ON 14
ci_016                 9.847664e-03 3 1  ON 15
ci_017                 8.726777e-03 3 1  ON 16
ci_018                 8.521474e-03 3 1  ON 17
ci_019                -3.664645e-04 3 1  ON 18
ci_020                -1.100442e-03 3 1  ON 19
ci_021                -1.146184e-02 3 1  ON 20
ci_022                -1.118209e-02 3 1  ON 21
ci_023                 4.916092e-03 3 1  ON 22
ci_024                 5.190673e-03 3 1  ON 23
ci_025                 1.103459e-02 3 1  ON 24
ci_026                 1.132555e-02 3 1  ON 25
ci_027                 6.560688e-03 3 1  ON 26
ci_028                 6.265344e-03 3 1  ON 27
ci_029                -5.237421e-03 3 1  ON 28
ci_030                -4.425087e-03 3 1  ON 29
ci_031                 2.770851e-03 3 1  ON 30
ci_032                 3.971112e-03 3 1  ON 31
ci_033                 2.520712e-03 3 1  ON 32
ci_034                 4.087170e-03 3 1  ON 33
ci_035                 1.896448e-03 3 1  ON 34
ci_036                 2.322545e-03 3 1  ON 35
ci_037                 3.701011e-03 3 1  ON 36
ci_038                 3.741080e-03 3 1  ON 37
ci_039                 4.581390e-03 3 1  ON 38
ci_040                 5.085759e-03 3 1  ON 39
ci_041                 2.934293e-03 3 1  ON 40
ci_042                 2.685417e-03 3 1  ON 41
ci_043                 2.895450e-03 3 1  ON 42
ci_044                 3.079632e-03 3 1  ON 43
ci_045                 2.298092e-03 3 1  ON 44
ci_046                 2.646895e-03 3 1  ON 45
ci_047                -9.693438e-04 3 1  ON 46
ci_048                -9.103820e-04 3 1  ON 47
ci_049                 8.976939e-04 3 1  ON 48
ci_050                 1.091572e-03 3 1  ON 49
ci_051                -5.962331e-05 3 1  ON 50
ci_052                -1.232560e-03 3 1  ON 51
ci_053                -2.190395e-03 3 1  ON 52
ci_054                -2.572124e-03 3 1  ON 53
ci_055                -2.137376e-03 3 1  ON 54
ci_056                -1.995658e-03 3 1  ON 55
ci_057                -1.500700e-03 3 1  ON 56
ci_058                -9.959406e-04 3 1  ON 57
ci_059                -7.300754e-04 3 1  ON 58
ci_060                -8.856578e-04 3 1  ON 59
ci_061                -1.342308e-04 3 1  ON 60
ci_062                -7.111361e-04 3 1  ON 61
ci_063                -9.022207e-04 3 1  ON 62
ci_064                -5.940719e-04 3 1  ON 63
ci_065                -1.485379e-03 3 1  ON 64
ci_066                -1.730382e-03 3 1  ON 65
ci_067                -1.402520e-03 3 1  ON 66
ci_068                -1.433649e-03 3 1  ON 67
ci_069                -6.089704e-04 3 1  ON 68
ci_070                -5.373088e-04 3 1  ON 69
ci_071                -2.101265e-03 3 1  ON 70
ci_072                -2.009778e-03 3 1  ON 71
ci_073                 1.756913e-04 3 1  ON 72
ci_074                 2.016779e-04 3 1  ON 73
ci_075                 2.927532e-04 3 1  ON 74
ci_076                 8.343065e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2648e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.6859
    reference variance = 0.389562
====================================================
  Execution time = 2.6610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4803e-01
  Total weights = 1.955185707e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440105714256
                                         uncertainty =       0.002204820404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440105714256
                                         uncertainty =       0.002204820404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469142623
  error estimate for blocks of size 2^( 2) =       0.000492750098
  error estimate for blocks of size 2^( 3) =       0.000514109937
  error estimate for blocks of size 2^( 4) =       0.000530066157
  error estimate for blocks of size 2^( 5) =       0.000539314914
  error estimate for blocks of size 2^( 6) =       0.000546493110
  error estimate for blocks of size 2^( 7) =       0.000548373268

      target function =      -0.746948443553
              le_mean =     -22.661875351149
             les_mean =     514.008627913675
             stat err =       0.000541061862
             autocorr =       1.330099294217
   target nu stat err =       0.000541061862
   target dn stat err =       0.002501639580
      target stat err =       0.002149595179
              std dev =       0.663467859598
             le_variance =       0.440189600720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266187535115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746953688671       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747218723741       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747289606062       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747301173811       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747308570780       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747315076345       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747329369409       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747343427271       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747348142768       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747349031574       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747349075115       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747349447967       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747349609322       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747349690621       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747349658978       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e-02 is 1.080996e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746953688671       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747105985588       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747141364563       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747146774178       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747150155650       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747152599795       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747155672976       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747157114224       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747157563342       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747157610385       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747157589487       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747157581258       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747157608824       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 2.810846e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746953688671       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747010057327       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747021626784       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747023315806       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747024350400       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747024963930       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747025497796       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747025661844       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747025722702       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747025721068       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747025717691       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747025714507       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 7.300994e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1406e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_001                -7.033491e-01 3 1  ON 0
ci_002                -7.051886e-01 3 1  ON 1
ci_003                -5.019377e-02 3 1  ON 2
ci_004                -5.108970e-02 3 1  ON 3
ci_005                 1.940918e-02 3 1  ON 4
ci_006                 1.930908e-02 3 1  ON 5
ci_007                 1.523742e-02 3 1  ON 6
ci_008                 1.520364e-02 3 1  ON 7
ci_009                -1.300793e-02 3 1  ON 8
ci_010                -1.199097e-02 3 1  ON 9
ci_011                -8.662864e-03 3 1  ON 10
ci_012                -8.300387e-03 3 1  ON 11
ci_013                 8.072657e-03 3 1  ON 12
ci_014                 8.885858e-03 3 1  ON 13
ci_015                 8.857819e-03 3 1  ON 14
ci_016                 8.979392e-03 3 1  ON 15
ci_017                 8.276805e-03 3 1  ON 16
ci_018                 8.203525e-03 3 1  ON 17
ci_019                -2.071548e-03 3 1  ON 18
ci_020                -1.444963e-03 3 1  ON 19
ci_021                -1.221101e-02 3 1  ON 20
ci_022                -1.254469e-02 3 1  ON 21
ci_023                 4.687522e-03 3 1  ON 22
ci_024                 4.563329e-03 3 1  ON 23
ci_025                 1.179719e-02 3 1  ON 24
ci_026                 1.146823e-02 3 1  ON 25
ci_027                 6.508481e-03 3 1  ON 26
ci_028                 6.339453e-03 3 1  ON 27
ci_029                -5.243536e-03 3 1  ON 28
ci_030                -3.774700e-03 3 1  ON 29
ci_031                 3.910072e-03 3 1  ON 30
ci_032                 5.092751e-03 3 1  ON 31
ci_033                 2.077547e-03 3 1  ON 32
ci_034                 4.482249e-03 3 1  ON 33
ci_035                 1.496713e-03 3 1  ON 34
ci_036                 2.070514e-03 3 1  ON 35
ci_037                 3.304078e-03 3 1  ON 36
ci_038                 3.630280e-03 3 1  ON 37
ci_039                 4.746053e-03 3 1  ON 38
ci_040                 4.889981e-03 3 1  ON 39
ci_041                 3.066876e-03 3 1  ON 40
ci_042                 2.827473e-03 3 1  ON 41
ci_043                 3.215480e-03 3 1  ON 42
ci_044                 3.395423e-03 3 1  ON 43
ci_045                 2.700245e-03 3 1  ON 44
ci_046                 2.742074e-03 3 1  ON 45
ci_047                -1.067225e-03 3 1  ON 46
ci_048                -7.171506e-04 3 1  ON 47
ci_049                 5.265150e-04 3 1  ON 48
ci_050                 1.079258e-03 3 1  ON 49
ci_051                -6.169601e-04 3 1  ON 50
ci_052                -1.197752e-03 3 1  ON 51
ci_053                -2.855799e-03 3 1  ON 52
ci_054                -2.815351e-03 3 1  ON 53
ci_055                -1.364812e-03 3 1  ON 54
ci_056                -1.839610e-03 3 1  ON 55
ci_057                -1.019932e-03 3 1  ON 56
ci_058                -8.919193e-04 3 1  ON 57
ci_059                -2.920315e-04 3 1  ON 58
ci_060                -6.954196e-04 3 1  ON 59
ci_061                 8.487877e-05 3 1  ON 60
ci_062                -1.391307e-03 3 1  ON 61
ci_063                -8.961603e-04 3 1  ON 62
ci_064                -2.590787e-04 3 1  ON 63
ci_065                -1.067744e-03 3 1  ON 64
ci_066                -2.287792e-03 3 1  ON 65
ci_067                -2.529535e-03 3 1  ON 66
ci_068                -1.887976e-03 3 1  ON 67
ci_069                -5.309976e-04 3 1  ON 68
ci_070                -2.280973e-04 3 1  ON 69
ci_071                -2.109382e-03 3 1  ON 70
ci_072                -2.094912e-03 3 1  ON 71
ci_073                 1.447509e-04 3 1  ON 72
ci_074                 2.528743e-04 3 1  ON 73
ci_075                -8.286577e-05 3 1  ON 74
ci_076                 8.343866e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7286
    reference variance = 0.353299
====================================================
  Execution time = 2.5854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5012e-01
  Total weights = 1.9553e+06
  Execution time = 3.6129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442335530588
                                         uncertainty =       0.002186079108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442335530588
                                         uncertainty =       0.002186079108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470282525
  error estimate for blocks of size 2^( 2) =       0.000494300012
  error estimate for blocks of size 2^( 3) =       0.000516425766
  error estimate for blocks of size 2^( 4) =       0.000532191258
  error estimate for blocks of size 2^( 5) =       0.000541438559
  error estimate for blocks of size 2^( 6) =       0.000545975380
  error estimate for blocks of size 2^( 7) =       0.000548131620

      target function =      -0.599782953889
              le_mean =     -22.662939196859
             les_mean =     514.260354886928
             stat err =       0.000541934204
             autocorr =       1.327930793092
   target nu stat err =       0.000541934204
   target dn stat err =       0.142070325467
      target stat err =       0.076972612462
              std dev =       0.665079925362
             le_variance =       0.442331307119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443259130969
                                         uncertainty =       0.002641695258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443259130969
                                         uncertainty =       0.002641695258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470770823
  error estimate for blocks of size 2^( 2) =       0.000494837401
  error estimate for blocks of size 2^( 3) =       0.000516990048
  error estimate for blocks of size 2^( 4) =       0.000532767951
  error estimate for blocks of size 2^( 5) =       0.000542057778
  error estimate for blocks of size 2^( 6) =       0.000546689744
  error estimate for blocks of size 2^( 7) =       0.000548912830

      target function =      -0.721585115344
              le_mean =     -22.662901332968
             les_mean =     514.086588989730
             stat err =       0.000542607076
             autocorr =       1.328470234993
   target nu stat err =       0.000542607076
   target dn stat err =       0.017389475199
      target stat err =       0.013432007830
              std dev =       0.665770482743
             le_variance =       0.443250335692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441975768922
                                         uncertainty =       0.002324411569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441975768922
                                         uncertainty =       0.002324411569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470089777
  error estimate for blocks of size 2^( 2) =       0.000494186177
  error estimate for blocks of size 2^( 3) =       0.000516356768
  error estimate for blocks of size 2^( 4) =       0.000532174101
  error estimate for blocks of size 2^( 5) =       0.000541487461
  error estimate for blocks of size 2^( 6) =       0.000545956129
  error estimate for blocks of size 2^( 7) =       0.000548156514

      target function =      -0.653478925110
              le_mean =     -22.662940360586
             les_mean =     514.181559789605
             stat err =       0.000541943551
             autocorr =       1.329065830448
   target nu stat err =       0.000541943551
   target dn stat err =       0.068809808509
      target stat err =       0.043735351635
              std dev =       0.664807337624
             le_variance =       0.441968796159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441895530103
                                         uncertainty =       0.002168651286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441895530103
                                         uncertainty =       0.002168651286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470048597
  error estimate for blocks of size 2^( 2) =       0.000494091744
  error estimate for blocks of size 2^( 3) =       0.000516224264
  error estimate for blocks of size 2^( 4) =       0.000532001762
  error estimate for blocks of size 2^( 5) =       0.000541223748
  error estimate for blocks of size 2^( 6) =       0.000545766886
  error estimate for blocks of size 2^( 7) =       0.000547968743

      target function =      -0.744076460895
              le_mean =     -22.662916678051
             les_mean =     514.059324193928
             stat err =       0.000541740285
             autocorr =       1.328301738323
   target nu stat err =       0.000541740285
   target dn stat err =       0.002828737928
      target stat err =       0.002396043630
              std dev =       0.664749101437
             le_variance =       0.441891367862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.599782953889        initial
     1.5625e-02     1.5625e-01             1.0810e-02        -0.721585115344
     6.2500e-02     6.2500e-01             2.8108e-03        -0.653478925110
     2.5000e-01     2.5000e+00             7.3010e-04        -0.744076460895  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.4024e+01
  </log>
  <optVariables href="FORM2.s006.opt.xml">
ci_001                -7.053800e-01 3 1  ON 0
ci_002                -7.030965e-01 3 1  ON 1
ci_003                -4.998508e-02 3 1  ON 2
ci_004                -5.102201e-02 3 1  ON 3
ci_005                 1.958006e-02 3 1  ON 4
ci_006                 1.997213e-02 3 1  ON 5
ci_007                 1.475713e-02 3 1  ON 6
ci_008                 1.572775e-02 3 1  ON 7
ci_009                -1.336016e-02 3 1  ON 8
ci_010                -1.214488e-02 3 1  ON 9
ci_011                -9.967128e-03 3 1  ON 10
ci_012                -9.144748e-03 3 1  ON 11
ci_013                 8.487769e-03 3 1  ON 12
ci_014                 9.461215e-03 3 1  ON 13
ci_015                 9.611080e-03 3 1  ON 14
ci_016                 9.544309e-03 3 1  ON 15
ci_017                 8.562349e-03 3 1  ON 16
ci_018                 8.400981e-03 3 1  ON 17
ci_019                -9.651444e-04 3 1  ON 18
ci_020                -1.221966e-03 3 1  ON 19
ci_021                -1.173715e-02 3 1  ON 20
ci_022                -1.165167e-02 3 1  ON 21
ci_023                 4.833081e-03 3 1  ON 22
ci_024                 4.955668e-03 3 1  ON 23
ci_025                 1.130158e-02 3 1  ON 24
ci_026                 1.137079e-02 3 1  ON 25
ci_027                 6.542496e-03 3 1  ON 26
ci_028                 6.290365e-03 3 1  ON 27
ci_029                -5.243404e-03 3 1  ON 28
ci_030                -4.193850e-03 3 1  ON 29
ci_031                 3.174915e-03 3 1  ON 30
ci_032                 4.360761e-03 3 1  ON 31
ci_033                 2.365190e-03 3 1  ON 32
ci_034                 4.232628e-03 3 1  ON 33
ci_035                 1.744303e-03 3 1  ON 34
ci_036                 2.226155e-03 3 1  ON 35
ci_037                 3.563694e-03 3 1  ON 36
ci_038                 3.704560e-03 3 1  ON 37
ci_039                 4.649234e-03 3 1  ON 38
ci_040                 5.008412e-03 3 1  ON 39
ci_041                 2.984286e-03 3 1  ON 40
ci_042                 2.736045e-03 3 1  ON 41
ci_043                 3.013895e-03 3 1  ON 42
ci_044                 3.195417e-03 3 1  ON 43
ci_045                 2.439140e-03 3 1  ON 44
ci_046                 2.678238e-03 3 1  ON 45
ci_047                -1.006365e-03 3 1  ON 46
ci_048                -8.372800e-04 3 1  ON 47
ci_049                 7.626128e-04 3 1  ON 48
ci_050                 1.088532e-03 3 1  ON 49
ci_051                -2.546165e-04 3 1  ON 50
ci_052                -1.224314e-03 3 1  ON 51
ci_053                -2.428379e-03 3 1  ON 52
ci_054                -2.651943e-03 3 1  ON 53
ci_055                -1.869393e-03 3 1  ON 54
ci_056                -1.940156e-03 3 1  ON 55
ci_057                -1.321652e-03 3 1  ON 56
ci_058                -9.583711e-04 3 1  ON 57
ci_059                -5.633245e-04 3 1  ON 58
ci_060                -8.157722e-04 3 1  ON 59
ci_061                -5.478962e-05 3 1  ON 60
ci_062                -9.511027e-04 3 1  ON 61
ci_063                -8.987575e-04 3 1  ON 62
ci_064                -4.684488e-04 3 1  ON 63
ci_065                -1.334193e-03 3 1  ON 64
ci_066                -1.929164e-03 3 1  ON 65
ci_067                -1.805890e-03 3 1  ON 66
ci_068                -1.594640e-03 3 1  ON 67
ci_069                -5.836586e-04 3 1  ON 68
ci_070                -4.247637e-04 3 1  ON 69
ci_071                -2.107351e-03 3 1  ON 70
ci_072                -2.044757e-03 3 1  ON 71
ci_073                 1.648098e-04 3 1  ON 72
ci_074                 2.215119e-04 3 1  ON 73
ci_075                 1.568232e-04 3 1  ON 74
ci_076                 8.355922e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5437e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6381
    reference variance = 0.93286
====================================================
  Execution time = 2.5663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5292e-01
  Total weights = 1.955484009e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439893344082
                                         uncertainty =       0.001854492070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439893344082
                                         uncertainty =       0.001854492070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469029482
  error estimate for blocks of size 2^( 2) =       0.000493100379
  error estimate for blocks of size 2^( 3) =       0.000515228291
  error estimate for blocks of size 2^( 4) =       0.000531313785
  error estimate for blocks of size 2^( 5) =       0.000540872628
  error estimate for blocks of size 2^( 6) =       0.000547559813
  error estimate for blocks of size 2^( 7) =       0.000551505864

      target function =      -0.742933405446
              le_mean =     -22.662242765770
             les_mean =     514.030167426708
             stat err =       0.000542813023
             autocorr =       1.339368968492
   target nu stat err =       0.000542813023
   target dn stat err =       0.003460221431
      target stat err =       0.002889231210
              std dev =       0.663307854275
             le_variance =       0.439977309543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266224276577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742943604033       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743091069751       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743141477426       residual = 6.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743148160917       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743151593187       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743155503022       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743159633935       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743160412684       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743160563758       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743160576192       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743160764577       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743161026408       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743161183976       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-02 is 3.662351e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742943604033       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742998354754       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743014820033       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743016775552       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743017748363       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743018666348       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743019345042       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743019374943       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743019388860       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743019394492       residual = 2.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743019430783       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743019464686       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e-01 is 9.197181e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742943604033       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742959180342       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742963612424       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742964115039       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742964362530       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742964578175       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742964718917       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742964718431       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742964720761       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742964722444       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742964730309       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+00 is 2.302459e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0467e+01
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_001                -7.044797e-01 3 1  ON 0
ci_002                -7.040162e-01 3 1  ON 1
ci_003                -4.989932e-02 3 1  ON 2
ci_004                -5.116528e-02 3 1  ON 3
ci_005                 1.924711e-02 3 1  ON 4
ci_006                 1.994074e-02 3 1  ON 5
ci_007                 1.478784e-02 3 1  ON 6
ci_008                 1.542044e-02 3 1  ON 7
ci_009                -1.303067e-02 3 1  ON 8
ci_010                -1.205550e-02 3 1  ON 9
ci_011                -9.841168e-03 3 1  ON 10
ci_012                -8.937874e-03 3 1  ON 11
ci_013                 8.141684e-03 3 1  ON 12
ci_014                 9.484685e-03 3 1  ON 13
ci_015                 9.504881e-03 3 1  ON 14
ci_016                 9.210917e-03 3 1  ON 15
ci_017                 8.403946e-03 3 1  ON 16
ci_018                 8.607958e-03 3 1  ON 17
ci_019                -1.559336e-03 3 1  ON 18
ci_020                -1.760912e-03 3 1  ON 19
ci_021                -1.186063e-02 3 1  ON 20
ci_022                -1.196845e-02 3 1  ON 21
ci_023                 4.805357e-03 3 1  ON 22
ci_024                 4.867543e-03 3 1  ON 23
ci_025                 1.166347e-02 3 1  ON 24
ci_026                 1.194615e-02 3 1  ON 25
ci_027                 6.697761e-03 3 1  ON 26
ci_028                 6.313494e-03 3 1  ON 27
ci_029                -5.248992e-03 3 1  ON 28
ci_030                -4.065975e-03 3 1  ON 29
ci_031                 3.652871e-03 3 1  ON 30
ci_032                 4.515238e-03 3 1  ON 31
ci_033                 2.591172e-03 3 1  ON 32
ci_034                 3.899086e-03 3 1  ON 33
ci_035                 1.733560e-03 3 1  ON 34
ci_036                 2.482957e-03 3 1  ON 35
ci_037                 3.391469e-03 3 1  ON 36
ci_038                 3.496877e-03 3 1  ON 37
ci_039                 4.534127e-03 3 1  ON 38
ci_040                 4.947506e-03 3 1  ON 39
ci_041                 2.905841e-03 3 1  ON 40
ci_042                 2.536840e-03 3 1  ON 41
ci_043                 2.827596e-03 3 1  ON 42
ci_044                 2.867666e-03 3 1  ON 43
ci_045                 2.493462e-03 3 1  ON 44
ci_046                 2.598328e-03 3 1  ON 45
ci_047                -8.768107e-04 3 1  ON 46
ci_048                -8.061003e-04 3 1  ON 47
ci_049                 5.695558e-04 3 1  ON 48
ci_050                 1.026075e-03 3 1  ON 49
ci_051                -4.873519e-04 3 1  ON 50
ci_052                -1.135540e-03 3 1  ON 51
ci_053                -2.553911e-03 3 1  ON 52
ci_054                -2.283576e-03 3 1  ON 53
ci_055                -1.483382e-03 3 1  ON 54
ci_056                -1.885981e-03 3 1  ON 55
ci_057                -1.154187e-03 3 1  ON 56
ci_058                -9.900179e-04 3 1  ON 57
ci_059                -5.426027e-04 3 1  ON 58
ci_060                -7.031926e-04 3 1  ON 59
ci_061                -2.582817e-06 3 1  ON 60
ci_062                -8.263459e-04 3 1  ON 61
ci_063                -1.075634e-03 3 1  ON 62
ci_064                -5.547816e-04 3 1  ON 63
ci_065                -1.138100e-03 3 1  ON 64
ci_066                -1.827286e-03 3 1  ON 65
ci_067                -1.939397e-03 3 1  ON 66
ci_068                -1.869971e-03 3 1  ON 67
ci_069                -5.508262e-04 3 1  ON 68
ci_070                -5.136391e-04 3 1  ON 69
ci_071                -2.003708e-03 3 1  ON 70
ci_072                -1.990068e-03 3 1  ON 71
ci_073                 7.926196e-05 3 1  ON 72
ci_074                 2.005730e-04 3 1  ON 73
ci_075                 3.230803e-04 3 1  ON 74
ci_076                 8.700296e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.6751
    reference variance = 0.350297
====================================================
  Execution time = 2.4868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4924e-01
  Total weights = 1.9552e+06
  Execution time = 3.6107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439339518955
                                         uncertainty =       0.003081559387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439339518955
                                         uncertainty =       0.003081559387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468670313
  error estimate for blocks of size 2^( 2) =       0.000492866654
  error estimate for blocks of size 2^( 3) =       0.000514925573
  error estimate for blocks of size 2^( 4) =       0.000531120764
  error estimate for blocks of size 2^( 5) =       0.000541639110
  error estimate for blocks of size 2^( 6) =       0.000547456314
  error estimate for blocks of size 2^( 7) =       0.000550135661

      target function =      -0.745437726208
              le_mean =     -22.661782151385
             les_mean =     514.006228544468
             stat err =       0.000542587962
             autocorr =       1.340310495724
   target nu stat err =       0.000542587962
   target dn stat err =       0.003703981118
      target stat err =       0.003102636907
              std dev =       0.662799913259
             le_variance =       0.439303725016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369471715
                                         uncertainty =       0.003114446350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369471715
                                         uncertainty =       0.003114446350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468686722
  error estimate for blocks of size 2^( 2) =       0.000492919074
  error estimate for blocks of size 2^( 3) =       0.000514994565
  error estimate for blocks of size 2^( 4) =       0.000531195735
  error estimate for blocks of size 2^( 5) =       0.000541730437
  error estimate for blocks of size 2^( 6) =       0.000547544860
  error estimate for blocks of size 2^( 7) =       0.000550249479

      target function =      -0.729728402732
              le_mean =     -22.661788977469
             les_mean =     514.025772931630
             stat err =       0.000542680128
             autocorr =       1.340671997222
   target nu stat err =       0.000542680128
   target dn stat err =       0.016796678617
      target stat err =       0.013247159570
              std dev =       0.662823118225
             le_variance =       0.439334486054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439259815444
                                         uncertainty =       0.003101298057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439259815444
                                         uncertainty =       0.003101298057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468628129
  error estimate for blocks of size 2^( 2) =       0.000492853607
  error estimate for blocks of size 2^( 3) =       0.000514929671
  error estimate for blocks of size 2^( 4) =       0.000531131226
  error estimate for blocks of size 2^( 5) =       0.000541664197
  error estimate for blocks of size 2^( 6) =       0.000547477113
  error estimate for blocks of size 2^( 7) =       0.000550179822

      target function =      -0.745312259420
              le_mean =     -22.661778802815
             les_mean =     514.006228532483
             stat err =       0.000542613089
             autocorr =       1.340675968905
   target nu stat err =       0.000542613089
   target dn stat err =       0.003810200883
      target stat err =       0.003187286260
              std dev =       0.662740256306
             le_variance =       0.439224647328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439312063729
                                         uncertainty =       0.003084037738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439312063729
                                         uncertainty =       0.003084037738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468655723
  error estimate for blocks of size 2^( 2) =       0.000492857252
  error estimate for blocks of size 2^( 3) =       0.000514918082
  error estimate for blocks of size 2^( 4) =       0.000531113231
  error estimate for blocks of size 2^( 5) =       0.000541632378
  error estimate for blocks of size 2^( 6) =       0.000547449410
  error estimate for blocks of size 2^( 7) =       0.000550132949

      target function =      -0.745116139871
              le_mean =     -22.661778630707
             les_mean =     514.006460062869
             stat err =       0.000542581992
             autocorr =       1.340364455604
   target nu stat err =       0.000542581992
   target dn stat err =       0.003742681636
      target stat err =       0.003131184441
              std dev =       0.662779278843
             le_variance =       0.439276372464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745437726208        initial  <--
     6.2500e-02     6.2500e-01             3.6624e-03        -0.729728402732
     2.5000e-01     2.5000e+00             9.1972e-04        -0.745312259420
     1.0000e+00     1.0000e+01             2.3025e-04        -0.745116139871

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.6583
  </log>
  <optVariables href="FORM2.s007.opt.xml">
ci_001                -7.053800e-01 3 1  ON 0
ci_002                -7.030965e-01 3 1  ON 1
ci_003                -4.998508e-02 3 1  ON 2
ci_004                -5.102201e-02 3 1  ON 3
ci_005                 1.958006e-02 3 1  ON 4
ci_006                 1.997213e-02 3 1  ON 5
ci_007                 1.475713e-02 3 1  ON 6
ci_008                 1.572775e-02 3 1  ON 7
ci_009                -1.336016e-02 3 1  ON 8
ci_010                -1.214488e-02 3 1  ON 9
ci_011                -9.967128e-03 3 1  ON 10
ci_012                -9.144748e-03 3 1  ON 11
ci_013                 8.487769e-03 3 1  ON 12
ci_014                 9.461215e-03 3 1  ON 13
ci_015                 9.611080e-03 3 1  ON 14
ci_016                 9.544309e-03 3 1  ON 15
ci_017                 8.562349e-03 3 1  ON 16
ci_018                 8.400981e-03 3 1  ON 17
ci_019                -9.651444e-04 3 1  ON 18
ci_020                -1.221966e-03 3 1  ON 19
ci_021                -1.173715e-02 3 1  ON 20
ci_022                -1.165167e-02 3 1  ON 21
ci_023                 4.833081e-03 3 1  ON 22
ci_024                 4.955668e-03 3 1  ON 23
ci_025                 1.130158e-02 3 1  ON 24
ci_026                 1.137079e-02 3 1  ON 25
ci_027                 6.542496e-03 3 1  ON 26
ci_028                 6.290365e-03 3 1  ON 27
ci_029                -5.243404e-03 3 1  ON 28
ci_030                -4.193850e-03 3 1  ON 29
ci_031                 3.174915e-03 3 1  ON 30
ci_032                 4.360761e-03 3 1  ON 31
ci_033                 2.365190e-03 3 1  ON 32
ci_034                 4.232628e-03 3 1  ON 33
ci_035                 1.744303e-03 3 1  ON 34
ci_036                 2.226155e-03 3 1  ON 35
ci_037                 3.563694e-03 3 1  ON 36
ci_038                 3.704560e-03 3 1  ON 37
ci_039                 4.649234e-03 3 1  ON 38
ci_040                 5.008412e-03 3 1  ON 39
ci_041                 2.984286e-03 3 1  ON 40
ci_042                 2.736045e-03 3 1  ON 41
ci_043                 3.013895e-03 3 1  ON 42
ci_044                 3.195417e-03 3 1  ON 43
ci_045                 2.439140e-03 3 1  ON 44
ci_046                 2.678238e-03 3 1  ON 45
ci_047                -1.006365e-03 3 1  ON 46
ci_048                -8.372800e-04 3 1  ON 47
ci_049                 7.626128e-04 3 1  ON 48
ci_050                 1.088532e-03 3 1  ON 49
ci_051                -2.546165e-04 3 1  ON 50
ci_052                -1.224314e-03 3 1  ON 51
ci_053                -2.428379e-03 3 1  ON 52
ci_054                -2.651943e-03 3 1  ON 53
ci_055                -1.869393e-03 3 1  ON 54
ci_056                -1.940156e-03 3 1  ON 55
ci_057                -1.321652e-03 3 1  ON 56
ci_058                -9.583711e-04 3 1  ON 57
ci_059                -5.633245e-04 3 1  ON 58
ci_060                -8.157722e-04 3 1  ON 59
ci_061                -5.478962e-05 3 1  ON 60
ci_062                -9.511027e-04 3 1  ON 61
ci_063                -8.987575e-04 3 1  ON 62
ci_064                -4.684488e-04 3 1  ON 63
ci_065                -1.334193e-03 3 1  ON 64
ci_066                -1.929164e-03 3 1  ON 65
ci_067                -1.805890e-03 3 1  ON 66
ci_068                -1.594640e-03 3 1  ON 67
ci_069                -5.836586e-04 3 1  ON 68
ci_070                -4.247637e-04 3 1  ON 69
ci_071                -2.107351e-03 3 1  ON 70
ci_072                -2.044757e-03 3 1  ON 71
ci_073                 1.648098e-04 3 1  ON 72
ci_074                 2.215119e-04 3 1  ON 73
ci_075                 1.568232e-04 3 1  ON 74
ci_076                 8.355922e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.6901
    reference variance = 0.257489
====================================================
  Execution time = 2.6750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5316e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4912e-01
  Total weights = 1.955251862e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439644264582
                                         uncertainty =       0.002098432032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439644264582
                                         uncertainty =       0.002098432032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468779884
  error estimate for blocks of size 2^( 2) =       0.000492721742
  error estimate for blocks of size 2^( 3) =       0.000514784269
  error estimate for blocks of size 2^( 4) =       0.000530858376
  error estimate for blocks of size 2^( 5) =       0.000540733635
  error estimate for blocks of size 2^( 6) =       0.000544654799
  error estimate for blocks of size 2^( 7) =       0.000547869256

      target function =      -0.746043619378
              le_mean =     -22.661147217052
             les_mean =     513.976712844077
             stat err =       0.000541029017
             autocorr =       1.331996800586
   target nu stat err =       0.000541029017
   target dn stat err =       0.002913091850
      target stat err =       0.002469111336
              std dev =       0.662954869520
             le_variance =       0.439509159021


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266114721705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746050889483       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746092559532       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746100111806       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746101670719       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746102408499       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746103392627       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746103844299       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746103828867       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746103845179       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746103861006       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746103861271       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746103874119       residual = 1.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 5.045533e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746050889483       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746061900704       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746063840638       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746064238791       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746064424288       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746064661167       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746064763481       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746064758007       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746064761844       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746064765622       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746064765673       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.263661e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746050889483       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746053682074       residual = 4.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746054170323       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746054270385       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746054316807       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746054375401       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746054400311       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746054398849       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746054399795       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746054400728       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746054400739       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 3.160789e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048515 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1505e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_001                -7.055064e-01 3 1  ON 0
ci_002                -7.029769e-01 3 1  ON 1
ci_003                -4.996727e-02 3 1  ON 2
ci_004                -5.101420e-02 3 1  ON 3
ci_005                 1.956691e-02 3 1  ON 4
ci_006                 1.993680e-02 3 1  ON 5
ci_007                 1.475635e-02 3 1  ON 6
ci_008                 1.566415e-02 3 1  ON 7
ci_009                -1.331220e-02 3 1  ON 8
ci_010                -1.215282e-02 3 1  ON 9
ci_011                -9.954029e-03 3 1  ON 10
ci_012                -9.133370e-03 3 1  ON 11
ci_013                 8.483430e-03 3 1  ON 12
ci_014                 9.387338e-03 3 1  ON 13
ci_015                 9.575813e-03 3 1  ON 14
ci_016                 9.535438e-03 3 1  ON 15
ci_017                 8.545985e-03 3 1  ON 16
ci_018                 8.365879e-03 3 1  ON 17
ci_019                -1.023840e-03 3 1  ON 18
ci_020                -1.263093e-03 3 1  ON 19
ci_021                -1.172398e-02 3 1  ON 20
ci_022                -1.165814e-02 3 1  ON 21
ci_023                 4.854197e-03 3 1  ON 22
ci_024                 4.947340e-03 3 1  ON 23
ci_025                 1.132031e-02 3 1  ON 24
ci_026                 1.142239e-02 3 1  ON 25
ci_027                 6.545249e-03 3 1  ON 26
ci_028                 6.274331e-03 3 1  ON 27
ci_029                -5.194686e-03 3 1  ON 28
ci_030                -4.249783e-03 3 1  ON 29
ci_031                 3.237527e-03 3 1  ON 30
ci_032                 4.375041e-03 3 1  ON 31
ci_033                 2.382841e-03 3 1  ON 32
ci_034                 4.182970e-03 3 1  ON 33
ci_035                 1.758398e-03 3 1  ON 34
ci_036                 2.196025e-03 3 1  ON 35
ci_037                 3.556697e-03 3 1  ON 36
ci_038                 3.705904e-03 3 1  ON 37
ci_039                 4.665211e-03 3 1  ON 38
ci_040                 4.970761e-03 3 1  ON 39
ci_041                 2.991265e-03 3 1  ON 40
ci_042                 2.737104e-03 3 1  ON 41
ci_043                 3.016895e-03 3 1  ON 42
ci_044                 3.224813e-03 3 1  ON 43
ci_045                 2.424140e-03 3 1  ON 44
ci_046                 2.646732e-03 3 1  ON 45
ci_047                -1.017114e-03 3 1  ON 46
ci_048                -8.165784e-04 3 1  ON 47
ci_049                 7.497417e-04 3 1  ON 48
ci_050                 1.111885e-03 3 1  ON 49
ci_051                -2.292316e-04 3 1  ON 50
ci_052                -1.240736e-03 3 1  ON 51
ci_053                -2.409570e-03 3 1  ON 52
ci_054                -2.656306e-03 3 1  ON 53
ci_055                -1.820361e-03 3 1  ON 54
ci_056                -1.929201e-03 3 1  ON 55
ci_057                -1.314932e-03 3 1  ON 56
ci_058                -9.475944e-04 3 1  ON 57
ci_059                -5.766141e-04 3 1  ON 58
ci_060                -8.017459e-04 3 1  ON 59
ci_061                -7.125552e-05 3 1  ON 60
ci_062                -9.565800e-04 3 1  ON 61
ci_063                -8.863064e-04 3 1  ON 62
ci_064                -4.905597e-04 3 1  ON 63
ci_065                -1.353892e-03 3 1  ON 64
ci_066                -1.892310e-03 3 1  ON 65
ci_067                -1.878275e-03 3 1  ON 66
ci_068                -1.618822e-03 3 1  ON 67
ci_069                -5.759255e-04 3 1  ON 68
ci_070                -4.007359e-04 3 1  ON 69
ci_071                -2.070856e-03 3 1  ON 70
ci_072                -2.045342e-03 3 1  ON 71
ci_073                 1.608129e-04 3 1  ON 72
ci_074                 2.503016e-04 3 1  ON 73
ci_075                 1.573966e-04 3 1  ON 74
ci_076                 8.192850e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.7532
    reference variance = 0.470312
====================================================
  Execution time = 2.5643e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4747e-01
  Total weights = 1.9550e+06
  Execution time = 3.6127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437898891100
                                         uncertainty =       0.001708284129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437898891100
                                         uncertainty =       0.001708284129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467866692
  error estimate for blocks of size 2^( 2) =       0.000491835814
  error estimate for blocks of size 2^( 3) =       0.000514008100
  error estimate for blocks of size 2^( 4) =       0.000529887574
  error estimate for blocks of size 2^( 5) =       0.000540446029
  error estimate for blocks of size 2^( 6) =       0.000545778991
  error estimate for blocks of size 2^( 7) =       0.000547585391

      target function =      -0.747394310027
              le_mean =     -22.661276749410
             les_mean =     513.980948919637
             stat err =       0.000540924496
             autocorr =       1.336684901320
   target nu stat err =       0.000540924496
   target dn stat err =       0.002499464198
      target stat err =       0.002148391174
              std dev =       0.661663420981
             le_variance =       0.437798482664

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437840366740
                                         uncertainty =       0.001707473729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437840366740
                                         uncertainty =       0.001707473729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467835447
  error estimate for blocks of size 2^( 2) =       0.000491811967
  error estimate for blocks of size 2^( 3) =       0.000513985943
  error estimate for blocks of size 2^( 4) =       0.000529868540
  error estimate for blocks of size 2^( 5) =       0.000540422096
  error estimate for blocks of size 2^( 6) =       0.000545747846
  error estimate for blocks of size 2^( 7) =       0.000547553466

      target function =      -0.746998178254
              le_mean =     -22.661276896999
             les_mean =     513.981435394790
             stat err =       0.000540897987
             autocorr =       1.336732418939
   target nu stat err =       0.000540897987
   target dn stat err =       0.002548459767
      target stat err =       0.002185037547
              std dev =       0.661619234757
             le_variance =       0.437740011800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437865738806
                                         uncertainty =       0.001707776821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437865738806
                                         uncertainty =       0.001707776821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467848993
  error estimate for blocks of size 2^( 2) =       0.000491822027
  error estimate for blocks of size 2^( 3) =       0.000513995352
  error estimate for blocks of size 2^( 4) =       0.000529876406
  error estimate for blocks of size 2^( 5) =       0.000540432399
  error estimate for blocks of size 2^( 6) =       0.000545762031
  error estimate for blocks of size 2^( 7) =       0.000547567749

      target function =      -0.747397410917
              le_mean =     -22.661276507800
             les_mean =     513.980934131671
             stat err =       0.000540909646
             autocorr =       1.336712642664
   target nu stat err =       0.000540909646
   target dn stat err =       0.002513439924
      target stat err =       0.002159489076
              std dev =       0.661638390421
             le_variance =       0.437765359679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437894373915
                                         uncertainty =       0.001708204872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437894373915
                                         uncertainty =       0.001708204872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467864280
  error estimate for blocks of size 2^( 2) =       0.000491833902
  error estimate for blocks of size 2^( 3) =       0.000514006321
  error estimate for blocks of size 2^( 4) =       0.000529885991
  error estimate for blocks of size 2^( 5) =       0.000540444143
  error estimate for blocks of size 2^( 6) =       0.000545776673
  error estimate for blocks of size 2^( 7) =       0.000547582972

      target function =      -0.747401826244
              le_mean =     -22.661276674909
             les_mean =     513.980936430195
             stat err =       0.000540922445
             autocorr =       1.336688541273
   target nu stat err =       0.000540922445
   target dn stat err =       0.002500900662
      target stat err =       0.002149571099
              std dev =       0.661660010501
             le_variance =       0.437793969497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747394310027        initial
     6.2500e-01     6.2500e+00             5.0455e-04        -0.746998178254
     2.5000e+00     2.5000e+01             1.2637e-04        -0.747397410917
     1.0000e+01     1.0000e+02             3.1608e-05        -0.747401826244  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.3823e+01
  </log>
  <optVariables href="FORM2.s008.opt.xml">
ci_001                -7.054116e-01 3 1  ON 0
ci_002                -7.030666e-01 3 1  ON 1
ci_003                -4.998060e-02 3 1  ON 2
ci_004                -5.102007e-02 3 1  ON 3
ci_005                 1.957671e-02 3 1  ON 4
ci_006                 1.996317e-02 3 1  ON 5
ci_007                 1.475692e-02 3 1  ON 6
ci_008                 1.571165e-02 3 1  ON 7
ci_009                -1.334802e-02 3 1  ON 8
ci_010                -1.214689e-02 3 1  ON 9
ci_011                -9.963794e-03 3 1  ON 10
ci_012                -9.141860e-03 3 1  ON 11
ci_013                 8.486661e-03 3 1  ON 12
ci_014                 9.442518e-03 3 1  ON 13
ci_015                 9.602156e-03 3 1  ON 14
ci_016                 9.542066e-03 3 1  ON 15
ci_017                 8.558205e-03 3 1  ON 16
ci_018                 8.392097e-03 3 1  ON 17
ci_019                -9.799789e-04 3 1  ON 18
ci_020                -1.232356e-03 3 1  ON 19
ci_021                -1.173381e-02 3 1  ON 20
ci_022                -1.165332e-02 3 1  ON 21
ci_023                 4.838429e-03 3 1  ON 22
ci_024                 4.953558e-03 3 1  ON 23
ci_025                 1.130630e-02 3 1  ON 24
ci_026                 1.138385e-02 3 1  ON 25
ci_027                 6.543191e-03 3 1  ON 26
ci_028                 6.286297e-03 3 1  ON 27
ci_029                -5.231081e-03 3 1  ON 28
ci_030                -4.208010e-03 3 1  ON 29
ci_031                 3.190745e-03 3 1  ON 30
ci_032                 4.364380e-03 3 1  ON 31
ci_033                 2.369654e-03 3 1  ON 32
ci_034                 4.220051e-03 3 1  ON 33
ci_035                 1.747884e-03 3 1  ON 34
ci_036                 2.218502e-03 3 1  ON 35
ci_037                 3.561921e-03 3 1  ON 36
ci_038                 3.704906e-03 3 1  ON 37
ci_039                 4.653289e-03 3 1  ON 38
ci_040                 4.998850e-03 3 1  ON 39
ci_041                 2.986053e-03 3 1  ON 40
ci_042                 2.736314e-03 3 1  ON 41
ci_043                 3.014645e-03 3 1  ON 42
ci_044                 3.202856e-03 3 1  ON 43
ci_045                 2.435342e-03 3 1  ON 44
ci_046                 2.670252e-03 3 1  ON 45
ci_047                -1.009096e-03 3 1  ON 46
ci_048                -8.320228e-04 3 1  ON 47
ci_049                 7.593510e-04 3 1  ON 48
ci_050                 1.094456e-03 3 1  ON 49
ci_051                -2.481837e-04 3 1  ON 50
ci_052                -1.228483e-03 3 1  ON 51
ci_053                -2.423610e-03 3 1  ON 52
ci_054                -2.653044e-03 3 1  ON 53
ci_055                -1.856991e-03 3 1  ON 54
ci_056                -1.937387e-03 3 1  ON 55
ci_057                -1.319949e-03 3 1  ON 56
ci_058                -9.556387e-04 3 1  ON 57
ci_059                -5.666979e-04 3 1  ON 58
ci_060                -8.122084e-04 3 1  ON 59
ci_061                -5.895225e-05 3 1  ON 60
ci_062                -9.524858e-04 3 1  ON 61
ci_063                -8.956076e-04 3 1  ON 62
ci_064                -4.740330e-04 3 1  ON 63
ci_065                -1.339175e-03 3 1  ON 64
ci_066                -1.919834e-03 3 1  ON 65
ci_067                -1.824205e-03 3 1  ON 66
ci_068                -1.600761e-03 3 1  ON 67
ci_069                -5.817011e-04 3 1  ON 68
ci_070                -4.186791e-04 3 1  ON 69
ci_071                -2.098109e-03 3 1  ON 70
ci_072                -2.044912e-03 3 1  ON 71
ci_073                 1.637929e-04 3 1  ON 72
ci_074                 2.288270e-04 3 1  ON 73
ci_075                 1.569684e-04 3 1  ON 74
ci_076                 8.314627e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5336e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.5942
    reference variance = 0.377877
====================================================
  Execution time = 2.6344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5259e-01
  Total weights = 1.955106988e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443124530762
                                         uncertainty =       0.002239259611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443124530762
                                         uncertainty =       0.002239259611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470680008
  error estimate for blocks of size 2^( 2) =       0.000494676942
  error estimate for blocks of size 2^( 3) =       0.000516045324
  error estimate for blocks of size 2^( 4) =       0.000531711743
  error estimate for blocks of size 2^( 5) =       0.000542414075
  error estimate for blocks of size 2^( 6) =       0.000547654678
  error estimate for blocks of size 2^( 7) =       0.000547198917

      target function =      -0.743208269468
              le_mean =     -22.662300028758
             les_mean =     514.032431295944
             stat err =       0.000542244853
             autocorr =       1.327209168341
   target nu stat err =       0.000542244853
   target dn stat err =       0.002806285725
      target stat err =       0.002370812994
              std dev =       0.665642050528
             le_variance =       0.443079339432


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266230002876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743214839521       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743223897828       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743225183917       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743225360272       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743225383523       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743225419408       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743225474279       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743225498208       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743225510042       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743225515059       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743225518404       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743225518453       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 1.054354e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743214839521       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743217136661       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743217460079       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743217504264       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743217509979       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743217518938       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743217532532       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743217538419       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743217541321       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743217542538       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743217543332       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743217543340       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.666500e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743214839521       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743215415878       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743215496851       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743215507903       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743215509325       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743215511564       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743215514955       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743215516420       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743215517142       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743215517444       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743215517640       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743215517642       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 6.685657e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053341 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1141e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_001                -7.054259e-01 3 1  ON 0
ci_002                -7.030551e-01 3 1  ON 1
ci_003                -4.997552e-02 3 1  ON 2
ci_004                -5.101027e-02 3 1  ON 3
ci_005                 1.956924e-02 3 1  ON 4
ci_006                 1.995190e-02 3 1  ON 5
ci_007                 1.475188e-02 3 1  ON 6
ci_008                 1.569783e-02 3 1  ON 7
ci_009                -1.334203e-02 3 1  ON 8
ci_010                -1.214704e-02 3 1  ON 9
ci_011                -9.965538e-03 3 1  ON 10
ci_012                -9.132755e-03 3 1  ON 11
ci_013                 8.476822e-03 3 1  ON 12
ci_014                 9.445735e-03 3 1  ON 13
ci_015                 9.595885e-03 3 1  ON 14
ci_016                 9.535527e-03 3 1  ON 15
ci_017                 8.554624e-03 3 1  ON 16
ci_018                 8.384875e-03 3 1  ON 17
ci_019                -9.930964e-04 3 1  ON 18
ci_020                -1.259021e-03 3 1  ON 19
ci_021                -1.173424e-02 3 1  ON 20
ci_022                -1.166004e-02 3 1  ON 21
ci_023                 4.836962e-03 3 1  ON 22
ci_024                 4.950058e-03 3 1  ON 23
ci_025                 1.130514e-02 3 1  ON 24
ci_026                 1.138859e-02 3 1  ON 25
ci_027                 6.534510e-03 3 1  ON 26
ci_028                 6.275996e-03 3 1  ON 27
ci_029                -5.217846e-03 3 1  ON 28
ci_030                -4.211452e-03 3 1  ON 29
ci_031                 3.202859e-03 3 1  ON 30
ci_032                 4.367958e-03 3 1  ON 31
ci_033                 2.361976e-03 3 1  ON 32
ci_034                 4.210073e-03 3 1  ON 33
ci_035                 1.744787e-03 3 1  ON 34
ci_036                 2.213036e-03 3 1  ON 35
ci_037                 3.569631e-03 3 1  ON 36
ci_038                 3.704178e-03 3 1  ON 37
ci_039                 4.651961e-03 3 1  ON 38
ci_040                 4.997389e-03 3 1  ON 39
ci_041                 2.984522e-03 3 1  ON 40
ci_042                 2.736855e-03 3 1  ON 41
ci_043                 3.013691e-03 3 1  ON 42
ci_044                 3.201708e-03 3 1  ON 43
ci_045                 2.438308e-03 3 1  ON 44
ci_046                 2.673965e-03 3 1  ON 45
ci_047                -1.007226e-03 3 1  ON 46
ci_048                -8.334131e-04 3 1  ON 47
ci_049                 7.549981e-04 3 1  ON 48
ci_050                 1.091526e-03 3 1  ON 49
ci_051                -2.558795e-04 3 1  ON 50
ci_052                -1.224472e-03 3 1  ON 51
ci_053                -2.422034e-03 3 1  ON 52
ci_054                -2.649461e-03 3 1  ON 53
ci_055                -1.850882e-03 3 1  ON 54
ci_056                -1.942680e-03 3 1  ON 55
ci_057                -1.320937e-03 3 1  ON 56
ci_058                -9.616082e-04 3 1  ON 57
ci_059                -5.683486e-04 3 1  ON 58
ci_060                -8.038857e-04 3 1  ON 59
ci_061                -6.291390e-05 3 1  ON 60
ci_062                -9.537421e-04 3 1  ON 61
ci_063                -8.908243e-04 3 1  ON 62
ci_064                -4.824302e-04 3 1  ON 63
ci_065                -1.338830e-03 3 1  ON 64
ci_066                -1.922270e-03 3 1  ON 65
ci_067                -1.818873e-03 3 1  ON 66
ci_068                -1.596277e-03 3 1  ON 67
ci_069                -5.812848e-04 3 1  ON 68
ci_070                -4.239878e-04 3 1  ON 69
ci_071                -2.094628e-03 3 1  ON 70
ci_072                -2.033741e-03 3 1  ON 71
ci_073                 1.630978e-04 3 1  ON 72
ci_074                 2.226485e-04 3 1  ON 73
ci_075                 1.534707e-04 3 1  ON 74
ci_076                 8.307423e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.6384
    reference variance = 0.378607
====================================================
  Execution time = 2.5650e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4806e-01
  Total weights = 1.9551e+06
  Execution time = 3.6112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439559995220
                                         uncertainty =       0.002098236236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439559995220
                                         uncertainty =       0.002098236236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468874804
  error estimate for blocks of size 2^( 2) =       0.000493013747
  error estimate for blocks of size 2^( 3) =       0.000514639942
  error estimate for blocks of size 2^( 4) =       0.000530028476
  error estimate for blocks of size 2^( 5) =       0.000539646012
  error estimate for blocks of size 2^( 6) =       0.000544859904
  error estimate for blocks of size 2^( 7) =       0.000551025253

      target function =      -0.746913151508
              le_mean =     -22.662240448580
             les_mean =     514.025223271793
             stat err =       0.000541389911
             autocorr =       1.333234443900
   target nu stat err =       0.000541389911
   target dn stat err =       0.002455491016
      target stat err =       0.002114087190
              std dev =       0.663089107216
             le_variance =       0.439687164108

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439537375200
                                         uncertainty =       0.002097289812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439537375200
                                         uncertainty =       0.002097289812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468862853
  error estimate for blocks of size 2^( 2) =       0.000493004289
  error estimate for blocks of size 2^( 3) =       0.000514632660
  error estimate for blocks of size 2^( 4) =       0.000530022114
  error estimate for blocks of size 2^( 5) =       0.000539641346
  error estimate for blocks of size 2^( 6) =       0.000544854150
  error estimate for blocks of size 2^( 7) =       0.000551018313

      target function =      -0.746947389119
              le_mean =     -22.662240813777
             les_mean =     514.025198382905
             stat err =       0.000541383981
             autocorr =       1.333273201395
   target nu stat err =       0.000541383981
   target dn stat err =       0.002452548482
      target stat err =       0.002111942026
              std dev =       0.663072205845
             le_variance =       0.439664750165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439548402887
                                         uncertainty =       0.002097756510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439548402887
                                         uncertainty =       0.002097756510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468868679
  error estimate for blocks of size 2^( 2) =       0.000493008885
  error estimate for blocks of size 2^( 3) =       0.000514636182
  error estimate for blocks of size 2^( 4) =       0.000530025181
  error estimate for blocks of size 2^( 5) =       0.000539643576
  error estimate for blocks of size 2^( 6) =       0.000544856929
  error estimate for blocks of size 2^( 7) =       0.000551021685

      target function =      -0.746936501303
              le_mean =     -22.662240614627
             les_mean =     514.025202531859
             stat err =       0.000541386842
             autocorr =       1.333254164906
   target nu stat err =       0.000541386842
   target dn stat err =       0.002453826765
      target stat err =       0.002112895552
              std dev =       0.663080444718
             le_variance =       0.439675676167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439558525807
                                         uncertainty =       0.002098176053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439558525807
                                         uncertainty =       0.002098176053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468874028
  error estimate for blocks of size 2^( 2) =       0.000493013129
  error estimate for blocks of size 2^( 3) =       0.000514639462
  error estimate for blocks of size 2^( 4) =       0.000530028054
  error estimate for blocks of size 2^( 5) =       0.000539645697
  error estimate for blocks of size 2^( 6) =       0.000544859523
  error estimate for blocks of size 2^( 7) =       0.000551024799

      target function =      -0.746916904168
              le_mean =     -22.662240467275
             les_mean =     514.025219575993
             stat err =       0.000541389518
             autocorr =       1.333236925208
   target nu stat err =       0.000541389518
   target dn stat err =       0.002455261274
      target stat err =       0.002113925568
              std dev =       0.663088009083
             le_variance =       0.439685707789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746913151508        initial
     2.5000e+00     2.5000e+01             1.0544e-04        -0.746947389119  <--
     1.0000e+01     1.0000e+02             2.6665e-05        -0.746936501303
     4.0000e+01     4.0000e+02             6.6857e-06        -0.746916904168

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 4.3786e+01
  </log>
  <optVariables href="FORM2.s009.opt.xml">
ci_001                -7.054685e-01 3 1  ON 0
ci_002                -7.030204e-01 3 1  ON 1
ci_003                -4.996040e-02 3 1  ON 2
ci_004                -5.098102e-02 3 1  ON 3
ci_005                 1.954729e-02 3 1  ON 4
ci_006                 1.991874e-02 3 1  ON 5
ci_007                 1.473707e-02 3 1  ON 6
ci_008                 1.565703e-02 3 1  ON 7
ci_009                -1.332436e-02 3 1  ON 8
ci_010                -1.214754e-02 3 1  ON 9
ci_011                -9.970729e-03 3 1  ON 10
ci_012                -9.105879e-03 3 1  ON 11
ci_013                 8.447829e-03 3 1  ON 12
ci_014                 9.455225e-03 3 1  ON 13
ci_015                 9.577353e-03 3 1  ON 14
ci_016                 9.516224e-03 3 1  ON 15
ci_017                 8.544076e-03 3 1  ON 16
ci_018                 8.363583e-03 3 1  ON 17
ci_019                -1.031857e-03 3 1  ON 18
ci_020                -1.337791e-03 3 1  ON 19
ci_021                -1.173552e-02 3 1  ON 20
ci_022                -1.167986e-02 3 1  ON 21
ci_023                 4.832658e-03 3 1  ON 22
ci_024                 4.939754e-03 3 1  ON 23
ci_025                 1.130177e-02 3 1  ON 24
ci_026                 1.140264e-02 3 1  ON 25
ci_027                 6.509009e-03 3 1  ON 26
ci_028                 6.245717e-03 3 1  ON 27
ci_029                -5.178774e-03 3 1  ON 28
ci_030                -4.221612e-03 3 1  ON 29
ci_031                 3.238622e-03 3 1  ON 30
ci_032                 4.378543e-03 3 1  ON 31
ci_033                 2.339315e-03 3 1  ON 32
ci_034                 4.180607e-03 3 1  ON 33
ci_035                 1.735680e-03 3 1  ON 34
ci_036                 2.196964e-03 3 1  ON 35
ci_037                 3.592350e-03 3 1  ON 36
ci_038                 3.702045e-03 3 1  ON 37
ci_039                 4.648070e-03 3 1  ON 38
ci_040                 4.993100e-03 3 1  ON 39
ci_041                 2.980018e-03 3 1  ON 40
ci_042                 2.738449e-03 3 1  ON 41
ci_043                 3.010889e-03 3 1  ON 42
ci_044                 3.198286e-03 3 1  ON 43
ci_045                 2.447081e-03 3 1  ON 44
ci_046                 2.684952e-03 3 1  ON 45
ci_047                -1.001726e-03 3 1  ON 46
ci_048                -8.374900e-04 3 1  ON 47
ci_049                 7.421772e-04 3 1  ON 48
ci_050                 1.082900e-03 3 1  ON 49
ci_051                -2.785878e-04 3 1  ON 50
ci_052                -1.212635e-03 3 1  ON 51
ci_053                -2.417404e-03 3 1  ON 52
ci_054                -2.638905e-03 3 1  ON 53
ci_055                -1.832847e-03 3 1  ON 54
ci_056                -1.958307e-03 3 1  ON 55
ci_057                -1.323839e-03 3 1  ON 56
ci_058                -9.791867e-04 3 1  ON 57
ci_059                -5.731871e-04 3 1  ON 58
ci_060                -7.794136e-04 3 1  ON 59
ci_061                -7.458641e-05 3 1  ON 60
ci_062                -9.574520e-04 3 1  ON 61
ci_063                -8.767256e-04 3 1  ON 62
ci_064                -5.072075e-04 3 1  ON 63
ci_065                -1.337826e-03 3 1  ON 64
ci_066                -1.929447e-03 3 1  ON 65
ci_067                -1.803153e-03 3 1  ON 66
ci_068                -1.583036e-03 3 1  ON 67
ci_069                -5.800584e-04 3 1  ON 68
ci_070                -4.396361e-04 3 1  ON 69
ci_071                -2.084347e-03 3 1  ON 70
ci_072                -2.000804e-03 3 1  ON 71
ci_073                 1.610387e-04 3 1  ON 72
ci_074                 2.044728e-04 3 1  ON 73
ci_075                 1.431569e-04 3 1  ON 74
ci_076                 8.286268e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4960e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.6741
    reference variance = 0.517847
====================================================
  Execution time = 2.6610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4790e-01
  Total weights = 1.955192520e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8015e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552345254
                                         uncertainty =       0.001781316684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435552345254
                                         uncertainty =       0.001781316684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466690775
  error estimate for blocks of size 2^( 2) =       0.000491058478
  error estimate for blocks of size 2^( 3) =       0.000512723904
  error estimate for blocks of size 2^( 4) =       0.000527882794
  error estimate for blocks of size 2^( 5) =       0.000536870480
  error estimate for blocks of size 2^( 6) =       0.000541452565
  error estimate for blocks of size 2^( 7) =       0.000542935776

      target function =      -0.747056935489
              le_mean =     -22.662133539798
             les_mean =     514.020196305349
             stat err =       0.000537285404
             autocorr =       1.325414301782
   target nu stat err =       0.000537285404
   target dn stat err =       0.003380162037
      target stat err =       0.002854275024
              std dev =       0.660000422958
             le_variance =       0.435600558305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266213353980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747066900253       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747095195566       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747099508208       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747099794267       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747099864352       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747099911993       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747099981135       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747100028323       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747100035061       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747100037736       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747100022978       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e-01 is 2.661415e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747066900253       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747074391227       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747075494281       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747075562581       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747075579514       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747075591581       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747075607679       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747075619034       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747075620145       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747075620702       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747075617245       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 6.958604e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747066900253       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747068801017       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747069078306       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747069095152       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747069099344       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747069102371       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747069106315       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747069109125       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747069109369       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747069109498       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747069108651       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 1.759827e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1428e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_001                -7.054913e-01 3 1  ON 0
ci_002                -7.029982e-01 3 1  ON 1
ci_003                -4.998587e-02 3 1  ON 2
ci_004                -5.097803e-02 3 1  ON 3
ci_005                 1.955604e-02 3 1  ON 4
ci_006                 1.988717e-02 3 1  ON 5
ci_007                 1.473989e-02 3 1  ON 6
ci_008                 1.561120e-02 3 1  ON 7
ci_009                -1.329636e-02 3 1  ON 8
ci_010                -1.211327e-02 3 1  ON 9
ci_011                -9.917560e-03 3 1  ON 10
ci_012                -9.114765e-03 3 1  ON 11
ci_013                 8.411076e-03 3 1  ON 12
ci_014                 9.425823e-03 3 1  ON 13
ci_015                 9.574502e-03 3 1  ON 14
ci_016                 9.500361e-03 3 1  ON 15
ci_017                 8.523184e-03 3 1  ON 16
ci_018                 8.370012e-03 3 1  ON 17
ci_019                -1.059656e-03 3 1  ON 18
ci_020                -1.343249e-03 3 1  ON 19
ci_021                -1.175969e-02 3 1  ON 20
ci_022                -1.172506e-02 3 1  ON 21
ci_023                 4.874929e-03 3 1  ON 22
ci_024                 4.959280e-03 3 1  ON 23
ci_025                 1.137136e-02 3 1  ON 24
ci_026                 1.144952e-02 3 1  ON 25
ci_027                 6.474592e-03 3 1  ON 26
ci_028                 6.245167e-03 3 1  ON 27
ci_029                -5.147025e-03 3 1  ON 28
ci_030                -4.206959e-03 3 1  ON 29
ci_031                 3.258406e-03 3 1  ON 30
ci_032                 4.434479e-03 3 1  ON 31
ci_033                 2.361915e-03 3 1  ON 32
ci_034                 4.161586e-03 3 1  ON 33
ci_035                 1.731277e-03 3 1  ON 34
ci_036                 2.184769e-03 3 1  ON 35
ci_037                 3.576770e-03 3 1  ON 36
ci_038                 3.706029e-03 3 1  ON 37
ci_039                 4.647319e-03 3 1  ON 38
ci_040                 4.974544e-03 3 1  ON 39
ci_041                 2.966597e-03 3 1  ON 40
ci_042                 2.726990e-03 3 1  ON 41
ci_043                 2.974265e-03 3 1  ON 42
ci_044                 3.198398e-03 3 1  ON 43
ci_045                 2.436910e-03 3 1  ON 44
ci_046                 2.684054e-03 3 1  ON 45
ci_047                -9.935966e-04 3 1  ON 46
ci_048                -8.371089e-04 3 1  ON 47
ci_049                 7.383379e-04 3 1  ON 48
ci_050                 1.050472e-03 3 1  ON 49
ci_051                -2.745150e-04 3 1  ON 50
ci_052                -1.195772e-03 3 1  ON 51
ci_053                -2.429519e-03 3 1  ON 52
ci_054                -2.641788e-03 3 1  ON 53
ci_055                -1.808380e-03 3 1  ON 54
ci_056                -1.967083e-03 3 1  ON 55
ci_057                -1.288948e-03 3 1  ON 56
ci_058                -9.783227e-04 3 1  ON 57
ci_059                -5.598241e-04 3 1  ON 58
ci_060                -7.684982e-04 3 1  ON 59
ci_061                -5.393716e-05 3 1  ON 60
ci_062                -9.176521e-04 3 1  ON 61
ci_063                -9.113130e-04 3 1  ON 62
ci_064                -5.369117e-04 3 1  ON 63
ci_065                -1.323519e-03 3 1  ON 64
ci_066                -1.943632e-03 3 1  ON 65
ci_067                -1.812454e-03 3 1  ON 66
ci_068                -1.555802e-03 3 1  ON 67
ci_069                -5.530264e-04 3 1  ON 68
ci_070                -4.432833e-04 3 1  ON 69
ci_071                -2.058417e-03 3 1  ON 70
ci_072                -1.980409e-03 3 1  ON 71
ci_073                 1.574778e-04 3 1  ON 72
ci_074                 1.941215e-04 3 1  ON 73
ci_075                 1.776058e-04 3 1  ON 74
ci_076                 8.413313e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7472
    reference variance = 0.503605
====================================================
  Execution time = 2.5860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4878e-01
  Total weights = 1.9553e+06
  Execution time = 3.6223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439877305361
                                         uncertainty =       0.002068294563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439877305361
                                         uncertainty =       0.002068294563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468941711
  error estimate for blocks of size 2^( 2) =       0.000493122718
  error estimate for blocks of size 2^( 3) =       0.000515252650
  error estimate for blocks of size 2^( 4) =       0.000530639553
  error estimate for blocks of size 2^( 5) =       0.000538793538
  error estimate for blocks of size 2^( 6) =       0.000543428652
  error estimate for blocks of size 2^( 7) =       0.000545265454

      target function =      -0.746178931678
              le_mean =     -22.662459848698
             les_mean =     514.036058849460
             stat err =       0.000539531799
             autocorr =       1.323720716177
   target nu stat err =       0.000539531799
   target dn stat err =       0.002643552028
      target stat err =       0.002259351785
              std dev =       0.663183727797
             le_variance =       0.439812656814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439861003784
                                         uncertainty =       0.002069115930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439861003784
                                         uncertainty =       0.002069115930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468933416
  error estimate for blocks of size 2^( 2) =       0.000493118994
  error estimate for blocks of size 2^( 3) =       0.000515253039
  error estimate for blocks of size 2^( 4) =       0.000530640555
  error estimate for blocks of size 2^( 5) =       0.000538794368
  error estimate for blocks of size 2^( 6) =       0.000543438920
  error estimate for blocks of size 2^( 7) =       0.000545276368

      target function =      -0.746230823419
              le_mean =     -22.662459691821
             les_mean =     514.035988796374
             stat err =       0.000539537553
             autocorr =       1.323795781222
   target nu stat err =       0.000539537553
   target dn stat err =       0.002642742061
      target stat err =       0.002259012103
              std dev =       0.663171996747
             le_variance =       0.439797097269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439866995655
                                         uncertainty =       0.002068716233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439866995655
                                         uncertainty =       0.002068716233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468936398
  error estimate for blocks of size 2^( 2) =       0.000493119816
  error estimate for blocks of size 2^( 3) =       0.000515251894
  error estimate for blocks of size 2^( 4) =       0.000530639061
  error estimate for blocks of size 2^( 5) =       0.000538793001
  error estimate for blocks of size 2^( 6) =       0.000543432978
  error estimate for blocks of size 2^( 7) =       0.000545270080

      target function =      -0.745947132727
              le_mean =     -22.662459533866
             les_mean =     514.036325654427
             stat err =       0.000539533780
             autocorr =       1.323760428771
   target nu stat err =       0.000539533780
   target dn stat err =       0.002675254042
      target stat err =       0.002283199985
              std dev =       0.663176214536
             le_variance =       0.439802691526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439875775898
                                         uncertainty =       0.002068345392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439875775898
                                         uncertainty =       0.002068345392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468940917
  error estimate for blocks of size 2^( 2) =       0.000493122232
  error estimate for blocks of size 2^( 3) =       0.000515252425
  error estimate for blocks of size 2^( 4) =       0.000530639318
  error estimate for blocks of size 2^( 5) =       0.000538793298
  error estimate for blocks of size 2^( 6) =       0.000543429048
  error estimate for blocks of size 2^( 7) =       0.000545265934

      target function =      -0.746262782592
              le_mean =     -22.662459797490
             les_mean =     514.035954878323
             stat err =       0.000539531900
             autocorr =       1.323725694176
   target nu stat err =       0.000539531900
   target dn stat err =       0.002634108490
      target stat err =       0.002252331565
              std dev =       0.663182604135
             le_variance =       0.439811166427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746178931678        initial
     6.2500e-01     6.2500e+00             2.6614e-04        -0.746230823419
     2.5000e+00     2.5000e+01             6.9586e-05        -0.745947132727
     1.0000e+01     1.0000e+02             1.7598e-05        -0.746262782592  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+01     and shift_s =   1.0000e+02
*****************************************************************************

  Execution time = 4.4046e+01
  </log>
  <optVariables href="FORM2.s010.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996677e-02 3 1  ON 2
ci_004                -5.098027e-02 3 1  ON 3
ci_005                 1.954951e-02 3 1  ON 4
ci_006                 1.991073e-02 3 1  ON 5
ci_007                 1.473778e-02 3 1  ON 6
ci_008                 1.564543e-02 3 1  ON 7
ci_009                -1.331728e-02 3 1  ON 8
ci_010                -1.213886e-02 3 1  ON 9
ci_011                -9.957275e-03 3 1  ON 10
ci_012                -9.108125e-03 3 1  ON 11
ci_013                 8.438529e-03 3 1  ON 12
ci_014                 9.447788e-03 3 1  ON 13
ci_015                 9.576638e-03 3 1  ON 14
ci_016                 9.512213e-03 3 1  ON 15
ci_017                 8.538784e-03 3 1  ON 16
ci_018                 8.365227e-03 3 1  ON 17
ci_019                -1.038880e-03 3 1  ON 18
ci_020                -1.339170e-03 3 1  ON 19
ci_021                -1.174163e-02 3 1  ON 20
ci_022                -1.169129e-02 3 1  ON 21
ci_023                 4.843376e-03 3 1  ON 22
ci_024                 4.944703e-03 3 1  ON 23
ci_025                 1.131937e-02 3 1  ON 24
ci_026                 1.141451e-02 3 1  ON 25
ci_027                 6.500269e-03 3 1  ON 26
ci_028                 6.245577e-03 3 1  ON 27
ci_029                -5.170734e-03 3 1  ON 28
ci_030                -4.217909e-03 3 1  ON 29
ci_031                 3.243634e-03 3 1  ON 30
ci_032                 4.392688e-03 3 1  ON 31
ci_033                 2.345031e-03 3 1  ON 32
ci_034                 4.175793e-03 3 1  ON 33
ci_035                 1.734559e-03 3 1  ON 34
ci_036                 2.193867e-03 3 1  ON 35
ci_037                 3.588405e-03 3 1  ON 36
ci_038                 3.703038e-03 3 1  ON 37
ci_039                 4.647875e-03 3 1  ON 38
ci_040                 4.988388e-03 3 1  ON 39
ci_041                 2.976616e-03 3 1  ON 40
ci_042                 2.735538e-03 3 1  ON 41
ci_043                 3.001598e-03 3 1  ON 42
ci_044                 3.198316e-03 3 1  ON 43
ci_045                 2.444510e-03 3 1  ON 44
ci_046                 2.684727e-03 3 1  ON 45
ci_047                -9.996614e-04 3 1  ON 46
ci_048                -8.373945e-04 3 1  ON 47
ci_049                 7.412050e-04 3 1  ON 48
ci_050                 1.074674e-03 3 1  ON 49
ci_051                -2.775505e-04 3 1  ON 50
ci_052                -1.208366e-03 3 1  ON 51
ci_053                -2.420451e-03 3 1  ON 52
ci_054                -2.639635e-03 3 1  ON 53
ci_055                -1.826650e-03 3 1  ON 54
ci_056                -1.960518e-03 3 1  ON 55
ci_057                -1.314990e-03 3 1  ON 56
ci_058                -9.789677e-04 3 1  ON 57
ci_059                -5.697959e-04 3 1  ON 58
ci_060                -7.766425e-04 3 1  ON 59
ci_061                -6.936427e-05 3 1  ON 60
ci_062                -9.473347e-04 3 1  ON 61
ci_063                -8.854746e-04 3 1  ON 62
ci_064                -5.147163e-04 3 1  ON 63
ci_065                -1.334197e-03 3 1  ON 64
ci_066                -1.933041e-03 3 1  ON 65
ci_067                -1.805522e-03 3 1  ON 66
ci_068                -1.576141e-03 3 1  ON 67
ci_069                -5.732001e-04 3 1  ON 68
ci_070                -4.405583e-04 3 1  ON 69
ci_071                -2.077781e-03 3 1  ON 70
ci_072                -1.995642e-03 3 1  ON 71
ci_073                 1.601278e-04 3 1  ON 72
ci_074                 2.018448e-04 3 1  ON 73
ci_075                 1.518694e-04 3 1  ON 74
ci_076                 8.318432e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2664e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.6374
    reference variance = 0.450723
====================================================
  Execution time = 2.6301e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5626e-01
  Total weights = 1.955080310e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7082e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443156220641
                                         uncertainty =       0.002145816375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443156220641
                                         uncertainty =       0.002145816375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470961372
  error estimate for blocks of size 2^( 2) =       0.000494822345
  error estimate for blocks of size 2^( 3) =       0.000516495570
  error estimate for blocks of size 2^( 4) =       0.000531614818
  error estimate for blocks of size 2^( 5) =       0.000540424082
  error estimate for blocks of size 2^( 6) =       0.000545247063
  error estimate for blocks of size 2^( 7) =       0.000548633775

      target function =      -0.740211901454
              le_mean =     -22.662366507291
             les_mean =     514.039119085244
             stat err =       0.000541479935
             autocorr =       1.321886477672
   target nu stat err =       0.000541479935
   target dn stat err =       0.003484248658
      target stat err =       0.002887848263
              std dev =       0.666039959732
             le_variance =       0.443609227960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266236650729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740222352517       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740230798902       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740232274094       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740232511117       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740232609666       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740232642065       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740232676147       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740232677456       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740232676540       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740232677972       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740232680335       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740232680203       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+00 is 9.207328e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740222352517       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740224493483       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740224864699       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740224924217       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740224948895       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740224956946       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740224965381       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740224965659       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740224965429       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740224965790       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740224966364       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740224966325       residual = 1.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+01 is 2.327688e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740222352517       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740222889626       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740222982581       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740222997477       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740223003649       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740223005659       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740223007762       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740223007828       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740223007771       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740223007861       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740223008004       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740223007994       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+01 is 5.835605e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1020e+01
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_001                -7.054794e-01 3 1  ON 0
ci_002                -7.030114e-01 3 1  ON 1
ci_003                -4.995658e-02 3 1  ON 2
ci_004                -5.097942e-02 3 1  ON 3
ci_005                 1.954165e-02 3 1  ON 4
ci_006                 1.990004e-02 3 1  ON 5
ci_007                 1.473473e-02 3 1  ON 6
ci_008                 1.563696e-02 3 1  ON 7
ci_009                -1.330946e-02 3 1  ON 8
ci_010                -1.213625e-02 3 1  ON 9
ci_011                -9.950632e-03 3 1  ON 10
ci_012                -9.114092e-03 3 1  ON 11
ci_013                 8.432466e-03 3 1  ON 12
ci_014                 9.434571e-03 3 1  ON 13
ci_015                 9.578819e-03 3 1  ON 14
ci_016                 9.488937e-03 3 1  ON 15
ci_017                 8.536532e-03 3 1  ON 16
ci_018                 8.361584e-03 3 1  ON 17
ci_019                -1.053089e-03 3 1  ON 18
ci_020                -1.357210e-03 3 1  ON 19
ci_021                -1.173852e-02 3 1  ON 20
ci_022                -1.170010e-02 3 1  ON 21
ci_023                 4.837661e-03 3 1  ON 22
ci_024                 4.942277e-03 3 1  ON 23
ci_025                 1.133047e-02 3 1  ON 24
ci_026                 1.142874e-02 3 1  ON 25
ci_027                 6.499799e-03 3 1  ON 26
ci_028                 6.250315e-03 3 1  ON 27
ci_029                -5.167224e-03 3 1  ON 28
ci_030                -4.216280e-03 3 1  ON 29
ci_031                 3.261202e-03 3 1  ON 30
ci_032                 4.405860e-03 3 1  ON 31
ci_033                 2.353363e-03 3 1  ON 32
ci_034                 4.169002e-03 3 1  ON 33
ci_035                 1.736247e-03 3 1  ON 34
ci_036                 2.189336e-03 3 1  ON 35
ci_037                 3.589336e-03 3 1  ON 36
ci_038                 3.699190e-03 3 1  ON 37
ci_039                 4.644536e-03 3 1  ON 38
ci_040                 4.989966e-03 3 1  ON 39
ci_041                 2.977067e-03 3 1  ON 40
ci_042                 2.736704e-03 3 1  ON 41
ci_043                 3.002200e-03 3 1  ON 42
ci_044                 3.199360e-03 3 1  ON 43
ci_045                 2.457509e-03 3 1  ON 44
ci_046                 2.689098e-03 3 1  ON 45
ci_047                -9.975663e-04 3 1  ON 46
ci_048                -8.356437e-04 3 1  ON 47
ci_049                 7.352273e-04 3 1  ON 48
ci_050                 1.076399e-03 3 1  ON 49
ci_051                -2.815953e-04 3 1  ON 50
ci_052                -1.204465e-03 3 1  ON 51
ci_053                -2.423746e-03 3 1  ON 52
ci_054                -2.640398e-03 3 1  ON 53
ci_055                -1.821411e-03 3 1  ON 54
ci_056                -1.949978e-03 3 1  ON 55
ci_057                -1.312627e-03 3 1  ON 56
ci_058                -9.904768e-04 3 1  ON 57
ci_059                -5.646947e-04 3 1  ON 58
ci_060                -7.721666e-04 3 1  ON 59
ci_061                -6.991777e-05 3 1  ON 60
ci_062                -9.418100e-04 3 1  ON 61
ci_063                -8.949439e-04 3 1  ON 62
ci_064                -5.184781e-04 3 1  ON 63
ci_065                -1.336249e-03 3 1  ON 64
ci_066                -1.935074e-03 3 1  ON 65
ci_067                -1.800181e-03 3 1  ON 66
ci_068                -1.571697e-03 3 1  ON 67
ci_069                -5.715554e-04 3 1  ON 68
ci_070                -4.392692e-04 3 1  ON 69
ci_071                -2.082946e-03 3 1  ON 70
ci_072                -1.997275e-03 3 1  ON 71
ci_073                 1.569116e-04 3 1  ON 72
ci_074                 1.997865e-04 3 1  ON 73
ci_075                 1.552635e-04 3 1  ON 74
ci_076                 8.292820e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.5192
    reference variance = 0.366618
====================================================
  Execution time = 2.5869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4805e-01
  Total weights = 1.9555e+06
  Execution time = 3.9534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439457600009
                                         uncertainty =       0.001994269185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439457600009
                                         uncertainty =       0.001994269185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468801338
  error estimate for blocks of size 2^( 2) =       0.000492890317
  error estimate for blocks of size 2^( 3) =       0.000515088852
  error estimate for blocks of size 2^( 4) =       0.000531050999
  error estimate for blocks of size 2^( 5) =       0.000540067091
  error estimate for blocks of size 2^( 6) =       0.000544801265
  error estimate for blocks of size 2^( 7) =       0.000545899178

      target function =      -0.746938827378
              le_mean =     -22.661204198070
             les_mean =     513.978210766376
             stat err =       0.000540454633
             autocorr =       1.329048422218
   target nu stat err =       0.000540454633
   target dn stat err =       0.002637711962
      target stat err =       0.002255219147
              std dev =       0.662985209993
             le_variance =       0.439549388669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439444882956
                                         uncertainty =       0.001994021899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439444882956
                                         uncertainty =       0.001994021899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468794566
  error estimate for blocks of size 2^( 2) =       0.000492885448
  error estimate for blocks of size 2^( 3) =       0.000515084770
  error estimate for blocks of size 2^( 4) =       0.000531046638
  error estimate for blocks of size 2^( 5) =       0.000540062602
  error estimate for blocks of size 2^( 6) =       0.000544797352
  error estimate for blocks of size 2^( 7) =       0.000545897188

      target function =      -0.742130359536
              le_mean =     -22.661204396369
             les_mean =     513.984064836421
             stat err =       0.000540450945
             autocorr =       1.329068678738
   target nu stat err =       0.000540450945
   target dn stat err =       0.005415865507
      target stat err =       0.004448034676
              std dev =       0.662975632819
             le_variance =       0.439536689711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439450898938
                                         uncertainty =       0.001994149848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439450898938
                                         uncertainty =       0.001994149848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468797769
  error estimate for blocks of size 2^( 2) =       0.000492887719
  error estimate for blocks of size 2^( 3) =       0.000515086703
  error estimate for blocks of size 2^( 4) =       0.000531048725
  error estimate for blocks of size 2^( 5) =       0.000540065154
  error estimate for blocks of size 2^( 6) =       0.000544799724
  error estimate for blocks of size 2^( 7) =       0.000545898586

      target function =      -0.746879096652
              le_mean =     -22.661204477504
             les_mean =     513.978295835972
             stat err =       0.000540453047
             autocorr =       1.329060853510
   target nu stat err =       0.000540453047
   target dn stat err =       0.002645849426
      target stat err =       0.002261341868
              std dev =       0.662980163390
             le_variance =       0.439542697049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439456743847
                                         uncertainty =       0.001994254060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439456743847
                                         uncertainty =       0.001994254060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468800882
  error estimate for blocks of size 2^( 2) =       0.000492889983
  error estimate for blocks of size 2^( 3) =       0.000515088574
  error estimate for blocks of size 2^( 4) =       0.000531050705
  error estimate for blocks of size 2^( 5) =       0.000540066836
  error estimate for blocks of size 2^( 6) =       0.000544801059
  error estimate for blocks of size 2^( 7) =       0.000545899091

      target function =      -0.746935849827
              le_mean =     -22.661204229237
             les_mean =     513.978215785319
             stat err =       0.000540454423
             autocorr =       1.329049972368
   target nu stat err =       0.000540454423
   target dn stat err =       0.002638622986
      target stat err =       0.002255926262
              std dev =       0.662984565209
             le_variance =       0.439548533705


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746938827378        initial  <--
     2.5000e+00     2.5000e+01             9.2073e-05        -0.742130359536
     1.0000e+01     1.0000e+02             2.3277e-05        -0.746879096652
     4.0000e+01     4.0000e+02             5.8356e-06        -0.746935849827

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.7910
  </log>
  <optVariables href="FORM2.s011.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996677e-02 3 1  ON 2
ci_004                -5.098027e-02 3 1  ON 3
ci_005                 1.954951e-02 3 1  ON 4
ci_006                 1.991073e-02 3 1  ON 5
ci_007                 1.473778e-02 3 1  ON 6
ci_008                 1.564543e-02 3 1  ON 7
ci_009                -1.331728e-02 3 1  ON 8
ci_010                -1.213886e-02 3 1  ON 9
ci_011                -9.957275e-03 3 1  ON 10
ci_012                -9.108125e-03 3 1  ON 11
ci_013                 8.438529e-03 3 1  ON 12
ci_014                 9.447788e-03 3 1  ON 13
ci_015                 9.576638e-03 3 1  ON 14
ci_016                 9.512213e-03 3 1  ON 15
ci_017                 8.538784e-03 3 1  ON 16
ci_018                 8.365227e-03 3 1  ON 17
ci_019                -1.038880e-03 3 1  ON 18
ci_020                -1.339170e-03 3 1  ON 19
ci_021                -1.174163e-02 3 1  ON 20
ci_022                -1.169129e-02 3 1  ON 21
ci_023                 4.843376e-03 3 1  ON 22
ci_024                 4.944703e-03 3 1  ON 23
ci_025                 1.131937e-02 3 1  ON 24
ci_026                 1.141451e-02 3 1  ON 25
ci_027                 6.500269e-03 3 1  ON 26
ci_028                 6.245577e-03 3 1  ON 27
ci_029                -5.170734e-03 3 1  ON 28
ci_030                -4.217909e-03 3 1  ON 29
ci_031                 3.243634e-03 3 1  ON 30
ci_032                 4.392688e-03 3 1  ON 31
ci_033                 2.345031e-03 3 1  ON 32
ci_034                 4.175793e-03 3 1  ON 33
ci_035                 1.734559e-03 3 1  ON 34
ci_036                 2.193867e-03 3 1  ON 35
ci_037                 3.588405e-03 3 1  ON 36
ci_038                 3.703038e-03 3 1  ON 37
ci_039                 4.647875e-03 3 1  ON 38
ci_040                 4.988388e-03 3 1  ON 39
ci_041                 2.976616e-03 3 1  ON 40
ci_042                 2.735538e-03 3 1  ON 41
ci_043                 3.001598e-03 3 1  ON 42
ci_044                 3.198316e-03 3 1  ON 43
ci_045                 2.444510e-03 3 1  ON 44
ci_046                 2.684727e-03 3 1  ON 45
ci_047                -9.996614e-04 3 1  ON 46
ci_048                -8.373945e-04 3 1  ON 47
ci_049                 7.412050e-04 3 1  ON 48
ci_050                 1.074674e-03 3 1  ON 49
ci_051                -2.775505e-04 3 1  ON 50
ci_052                -1.208366e-03 3 1  ON 51
ci_053                -2.420451e-03 3 1  ON 52
ci_054                -2.639635e-03 3 1  ON 53
ci_055                -1.826650e-03 3 1  ON 54
ci_056                -1.960518e-03 3 1  ON 55
ci_057                -1.314990e-03 3 1  ON 56
ci_058                -9.789677e-04 3 1  ON 57
ci_059                -5.697959e-04 3 1  ON 58
ci_060                -7.766425e-04 3 1  ON 59
ci_061                -6.936427e-05 3 1  ON 60
ci_062                -9.473347e-04 3 1  ON 61
ci_063                -8.854746e-04 3 1  ON 62
ci_064                -5.147163e-04 3 1  ON 63
ci_065                -1.334197e-03 3 1  ON 64
ci_066                -1.933041e-03 3 1  ON 65
ci_067                -1.805522e-03 3 1  ON 66
ci_068                -1.576141e-03 3 1  ON 67
ci_069                -5.732001e-04 3 1  ON 68
ci_070                -4.405583e-04 3 1  ON 69
ci_071                -2.077781e-03 3 1  ON 70
ci_072                -1.995642e-03 3 1  ON 71
ci_073                 1.601278e-04 3 1  ON 72
ci_074                 2.018448e-04 3 1  ON 73
ci_075                 1.518694e-04 3 1  ON 74
ci_076                 8.318432e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.5972
    reference variance = 0.311662
====================================================
  Execution time = 2.6424e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5634e-01
  Total weights = 1.955330164e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441245443903
                                         uncertainty =       0.005009012513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441245443903
                                         uncertainty =       0.005009012513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469765292
  error estimate for blocks of size 2^( 2) =       0.000493832019
  error estimate for blocks of size 2^( 3) =       0.000516092523
  error estimate for blocks of size 2^( 4) =       0.000531392449
  error estimate for blocks of size 2^( 5) =       0.000540726722
  error estimate for blocks of size 2^( 6) =       0.000545633293
  error estimate for blocks of size 2^( 7) =       0.000544907695

      target function =      -0.740107275295
              le_mean =     -22.662582580839
             les_mean =     514.048990242185
             stat err =       0.000540665040
             autocorr =       1.324630417964
   target nu stat err =       0.000540665040
   target dn stat err =       0.007311898278
      target stat err =       0.005961093487
              std dev =       0.664348447215
             le_variance =       0.441358859317


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266258258084e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740159331646       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740163831729       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740164275007       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740164333583       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740164334876       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740164340575       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740164338614       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740164336776       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740164337928       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740164337187       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740164336878       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740164336815       residual = 3.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+01 is 3.312586e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740159331646       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740160458267       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740160569176       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740160583822       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740160584145       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740160585569       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740160585079       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740160584619       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740160584907       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740160584722       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740160584645       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740160584629       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+02 is 8.292449e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740159331646       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740159613401       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740159641134       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740159644796       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740159644877       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740159645233       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740159645110       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740159644995       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740159645066       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740159645021       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740159645002       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740159644998       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+02 is 2.073800e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067138 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1138e+01
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_001                -7.054730e-01 3 1  ON 0
ci_002                -7.030161e-01 3 1  ON 1
ci_003                -4.996654e-02 3 1  ON 2
ci_004                -5.097941e-02 3 1  ON 3
ci_005                 1.954883e-02 3 1  ON 4
ci_006                 1.990942e-02 3 1  ON 5
ci_007                 1.473664e-02 3 1  ON 6
ci_008                 1.564382e-02 3 1  ON 7
ci_009                -1.331691e-02 3 1  ON 8
ci_010                -1.213969e-02 3 1  ON 9
ci_011                -9.957414e-03 3 1  ON 10
ci_012                -9.107511e-03 3 1  ON 11
ci_013                 8.437297e-03 3 1  ON 12
ci_014                 9.446322e-03 3 1  ON 13
ci_015                 9.575539e-03 3 1  ON 14
ci_016                 9.512071e-03 3 1  ON 15
ci_017                 8.538742e-03 3 1  ON 16
ci_018                 8.364607e-03 3 1  ON 17
ci_019                -1.044702e-03 3 1  ON 18
ci_020                -1.339671e-03 3 1  ON 19
ci_021                -1.174054e-02 3 1  ON 20
ci_022                -1.169348e-02 3 1  ON 21
ci_023                 4.843251e-03 3 1  ON 22
ci_024                 4.944026e-03 3 1  ON 23
ci_025                 1.132767e-02 3 1  ON 24
ci_026                 1.141525e-02 3 1  ON 25
ci_027                 6.501518e-03 3 1  ON 26
ci_028                 6.245947e-03 3 1  ON 27
ci_029                -5.170418e-03 3 1  ON 28
ci_030                -4.217978e-03 3 1  ON 29
ci_031                 3.244606e-03 3 1  ON 30
ci_032                 4.393714e-03 3 1  ON 31
ci_033                 2.344737e-03 3 1  ON 32
ci_034                 4.175960e-03 3 1  ON 33
ci_035                 1.734378e-03 3 1  ON 34
ci_036                 2.193425e-03 3 1  ON 35
ci_037                 3.589186e-03 3 1  ON 36
ci_038                 3.702564e-03 3 1  ON 37
ci_039                 4.647697e-03 3 1  ON 38
ci_040                 4.988082e-03 3 1  ON 39
ci_041                 2.976010e-03 3 1  ON 40
ci_042                 2.735849e-03 3 1  ON 41
ci_043                 3.001892e-03 3 1  ON 42
ci_044                 3.197719e-03 3 1  ON 43
ci_045                 2.446468e-03 3 1  ON 44
ci_046                 2.684157e-03 3 1  ON 45
ci_047                -9.998752e-04 3 1  ON 46
ci_048                -8.381762e-04 3 1  ON 47
ci_049                 7.404818e-04 3 1  ON 48
ci_050                 1.074983e-03 3 1  ON 49
ci_051                -2.769324e-04 3 1  ON 50
ci_052                -1.207795e-03 3 1  ON 51
ci_053                -2.420201e-03 3 1  ON 52
ci_054                -2.641247e-03 3 1  ON 53
ci_055                -1.825865e-03 3 1  ON 54
ci_056                -1.960619e-03 3 1  ON 55
ci_057                -1.315273e-03 3 1  ON 56
ci_058                -9.789620e-04 3 1  ON 57
ci_059                -5.697203e-04 3 1  ON 58
ci_060                -7.762440e-04 3 1  ON 59
ci_061                -6.883931e-05 3 1  ON 60
ci_062                -9.468426e-04 3 1  ON 61
ci_063                -8.825713e-04 3 1  ON 62
ci_064                -5.155450e-04 3 1  ON 63
ci_065                -1.334075e-03 3 1  ON 64
ci_066                -1.933503e-03 3 1  ON 65
ci_067                -1.804836e-03 3 1  ON 66
ci_068                -1.576703e-03 3 1  ON 67
ci_069                -5.723217e-04 3 1  ON 68
ci_070                -4.379226e-04 3 1  ON 69
ci_071                -2.075467e-03 3 1  ON 70
ci_072                -1.995572e-03 3 1  ON 71
ci_073                 1.595080e-04 3 1  ON 72
ci_074                 2.018082e-04 3 1  ON 73
ci_075                 1.530255e-04 3 1  ON 74
ci_076                 8.329172e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.6594
    reference variance = 0.374812
====================================================
  Execution time = 2.5847e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4722e-01
  Total weights = 1.9551e+06
  Execution time = 3.6116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438862321421
                                         uncertainty =       0.002336695875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438862321421
                                         uncertainty =       0.002336695875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468420481
  error estimate for blocks of size 2^( 2) =       0.000492279306
  error estimate for blocks of size 2^( 3) =       0.000514454995
  error estimate for blocks of size 2^( 4) =       0.000530579187
  error estimate for blocks of size 2^( 5) =       0.000539523829
  error estimate for blocks of size 2^( 6) =       0.000545198860
  error estimate for blocks of size 2^( 7) =       0.000549057549

      target function =      -0.747626248206
              le_mean =     -22.662167227786
             les_mean =     514.021038616734
             stat err =       0.000541089856
             autocorr =       1.334341625969
   target nu stat err =       0.000541089856
   target dn stat err =       0.002812795842
      target stat err =       0.002402613247
              std dev =       0.662446596523
             le_variance =       0.438835493245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438860041110
                                         uncertainty =       0.002337055135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438860041110
                                         uncertainty =       0.002337055135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468419289
  error estimate for blocks of size 2^( 2) =       0.000492278277
  error estimate for blocks of size 2^( 3) =       0.000514454089
  error estimate for blocks of size 2^( 4) =       0.000530578153
  error estimate for blocks of size 2^( 5) =       0.000539522747
  error estimate for blocks of size 2^( 6) =       0.000545198007
  error estimate for blocks of size 2^( 7) =       0.000549056408

      target function =      -0.747608918684
              le_mean =     -22.662167318946
             les_mean =     514.021063678741
             stat err =       0.000541088829
             autocorr =       1.334343345402
   target nu stat err =       0.000541088829
   target dn stat err =       0.002816113519
      target stat err =       0.002405163291
              std dev =       0.662444911652
             le_variance =       0.438833260973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438861172934
                                         uncertainty =       0.002336875627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438861172934
                                         uncertainty =       0.002336875627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468419880
  error estimate for blocks of size 2^( 2) =       0.000492278787
  error estimate for blocks of size 2^( 3) =       0.000514454538
  error estimate for blocks of size 2^( 4) =       0.000530578666
  error estimate for blocks of size 2^( 5) =       0.000539523284
  error estimate for blocks of size 2^( 6) =       0.000545198429
  error estimate for blocks of size 2^( 7) =       0.000549056974

      target function =      -0.747619415495
              le_mean =     -22.662167272530
             les_mean =     514.021048895017
             stat err =       0.000541089338
             autocorr =       1.334342489706
   target nu stat err =       0.000541089338
   target dn stat err =       0.002814442286
      target stat err =       0.002403889758
              std dev =       0.662445747818
             le_variance =       0.438834368802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438862177048
                                         uncertainty =       0.002336718336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438862177048
                                         uncertainty =       0.002336718336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468420405
  error estimate for blocks of size 2^( 2) =       0.000492279241
  error estimate for blocks of size 2^( 3) =       0.000514454938
  error estimate for blocks of size 2^( 4) =       0.000530579122
  error estimate for blocks of size 2^( 5) =       0.000539523761
  error estimate for blocks of size 2^( 6) =       0.000545198806
  error estimate for blocks of size 2^( 7) =       0.000549057477

      target function =      -0.747625488687
              le_mean =     -22.662167233288
             les_mean =     514.021039783062
             stat err =       0.000541089791
             autocorr =       1.334341734395
   target nu stat err =       0.000541089791
   target dn stat err =       0.002813000465
      target stat err =       0.002402772452
              std dev =       0.662446489821
             le_variance =       0.438835351877


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747626248206        initial  <--
     2.5000e+01     2.5000e+02             3.3126e-05        -0.747608918684
     1.0000e+02     1.0000e+03             8.2924e-06        -0.747619415495
     4.0000e+02     4.0000e+03             2.0738e-06        -0.747625488687

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9524
  </log>
  <optVariables href="FORM2.s012.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996677e-02 3 1  ON 2
ci_004                -5.098027e-02 3 1  ON 3
ci_005                 1.954951e-02 3 1  ON 4
ci_006                 1.991073e-02 3 1  ON 5
ci_007                 1.473778e-02 3 1  ON 6
ci_008                 1.564543e-02 3 1  ON 7
ci_009                -1.331728e-02 3 1  ON 8
ci_010                -1.213886e-02 3 1  ON 9
ci_011                -9.957275e-03 3 1  ON 10
ci_012                -9.108125e-03 3 1  ON 11
ci_013                 8.438529e-03 3 1  ON 12
ci_014                 9.447788e-03 3 1  ON 13
ci_015                 9.576638e-03 3 1  ON 14
ci_016                 9.512213e-03 3 1  ON 15
ci_017                 8.538784e-03 3 1  ON 16
ci_018                 8.365227e-03 3 1  ON 17
ci_019                -1.038880e-03 3 1  ON 18
ci_020                -1.339170e-03 3 1  ON 19
ci_021                -1.174163e-02 3 1  ON 20
ci_022                -1.169129e-02 3 1  ON 21
ci_023                 4.843376e-03 3 1  ON 22
ci_024                 4.944703e-03 3 1  ON 23
ci_025                 1.131937e-02 3 1  ON 24
ci_026                 1.141451e-02 3 1  ON 25
ci_027                 6.500269e-03 3 1  ON 26
ci_028                 6.245577e-03 3 1  ON 27
ci_029                -5.170734e-03 3 1  ON 28
ci_030                -4.217909e-03 3 1  ON 29
ci_031                 3.243634e-03 3 1  ON 30
ci_032                 4.392688e-03 3 1  ON 31
ci_033                 2.345031e-03 3 1  ON 32
ci_034                 4.175793e-03 3 1  ON 33
ci_035                 1.734559e-03 3 1  ON 34
ci_036                 2.193867e-03 3 1  ON 35
ci_037                 3.588405e-03 3 1  ON 36
ci_038                 3.703038e-03 3 1  ON 37
ci_039                 4.647875e-03 3 1  ON 38
ci_040                 4.988388e-03 3 1  ON 39
ci_041                 2.976616e-03 3 1  ON 40
ci_042                 2.735538e-03 3 1  ON 41
ci_043                 3.001598e-03 3 1  ON 42
ci_044                 3.198316e-03 3 1  ON 43
ci_045                 2.444510e-03 3 1  ON 44
ci_046                 2.684727e-03 3 1  ON 45
ci_047                -9.996614e-04 3 1  ON 46
ci_048                -8.373945e-04 3 1  ON 47
ci_049                 7.412050e-04 3 1  ON 48
ci_050                 1.074674e-03 3 1  ON 49
ci_051                -2.775505e-04 3 1  ON 50
ci_052                -1.208366e-03 3 1  ON 51
ci_053                -2.420451e-03 3 1  ON 52
ci_054                -2.639635e-03 3 1  ON 53
ci_055                -1.826650e-03 3 1  ON 54
ci_056                -1.960518e-03 3 1  ON 55
ci_057                -1.314990e-03 3 1  ON 56
ci_058                -9.789677e-04 3 1  ON 57
ci_059                -5.697959e-04 3 1  ON 58
ci_060                -7.766425e-04 3 1  ON 59
ci_061                -6.936427e-05 3 1  ON 60
ci_062                -9.473347e-04 3 1  ON 61
ci_063                -8.854746e-04 3 1  ON 62
ci_064                -5.147163e-04 3 1  ON 63
ci_065                -1.334197e-03 3 1  ON 64
ci_066                -1.933041e-03 3 1  ON 65
ci_067                -1.805522e-03 3 1  ON 66
ci_068                -1.576141e-03 3 1  ON 67
ci_069                -5.732001e-04 3 1  ON 68
ci_070                -4.405583e-04 3 1  ON 69
ci_071                -2.077781e-03 3 1  ON 70
ci_072                -1.995642e-03 3 1  ON 71
ci_073                 1.601278e-04 3 1  ON 72
ci_074                 2.018448e-04 3 1  ON 73
ci_075                 1.518694e-04 3 1  ON 74
ci_076                 8.318432e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5098e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6995
    reference variance = 0.27319
====================================================
  Execution time = 2.6532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5053e-01
  Total weights = 1.954942957e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437278571830
                                         uncertainty =       0.001783346514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437278571830
                                         uncertainty =       0.001783346514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467577960
  error estimate for blocks of size 2^( 2) =       0.000491514243
  error estimate for blocks of size 2^( 3) =       0.000513288600
  error estimate for blocks of size 2^( 4) =       0.000529405805
  error estimate for blocks of size 2^( 5) =       0.000538323512
  error estimate for blocks of size 2^( 6) =       0.000543278954
  error estimate for blocks of size 2^( 7) =       0.000545300020

      target function =      -0.744888362073
              le_mean =     -22.662727251139
             les_mean =     514.049735807244
             stat err =       0.000539077073
             autocorr =       1.329210180767
   target nu stat err =       0.000539077073
   target dn stat err =       0.004425514492
      target stat err =       0.003685521377
              std dev =       0.661255092800
             le_variance =       0.437258297754


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266272725114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744905379067       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744905452861       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744905465448       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744905467033       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744905468306       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744905468885       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744905468760       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744905468767       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744905468886       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744905468900       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744905468866       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+02 is 9.955129e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744905379067       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744905397518       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744905400665       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744905401061       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744905401380       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744905401524       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744905401493       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744905401495       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744905401525       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744905401528       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744905401520       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+03 is 2.489072e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744905379067       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744905383680       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744905384467       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744905384566       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744905384645       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744905384684       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744905384675       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744905384670       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744905384682       residual = 8.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744905384679       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744905384678       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+03 is 6.222860e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071298 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1313e+01
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_001                -7.054740e-01 3 1  ON 0
ci_002                -7.030151e-01 3 1  ON 1
ci_003                -4.996678e-02 3 1  ON 2
ci_004                -5.098036e-02 3 1  ON 3
ci_005                 1.954947e-02 3 1  ON 4
ci_006                 1.991064e-02 3 1  ON 5
ci_007                 1.473784e-02 3 1  ON 6
ci_008                 1.564540e-02 3 1  ON 7
ci_009                -1.331721e-02 3 1  ON 8
ci_010                -1.213898e-02 3 1  ON 9
ci_011                -9.957104e-03 3 1  ON 10
ci_012                -9.108159e-03 3 1  ON 11
ci_013                 8.438576e-03 3 1  ON 12
ci_014                 9.447651e-03 3 1  ON 13
ci_015                 9.576798e-03 3 1  ON 14
ci_016                 9.512189e-03 3 1  ON 15
ci_017                 8.538728e-03 3 1  ON 16
ci_018                 8.365240e-03 3 1  ON 17
ci_019                -1.039128e-03 3 1  ON 18
ci_020                -1.339339e-03 3 1  ON 19
ci_021                -1.174163e-02 3 1  ON 20
ci_022                -1.169141e-02 3 1  ON 21
ci_023                 4.843430e-03 3 1  ON 22
ci_024                 4.944741e-03 3 1  ON 23
ci_025                 1.131948e-02 3 1  ON 24
ci_026                 1.141461e-02 3 1  ON 25
ci_027                 6.500294e-03 3 1  ON 26
ci_028                 6.245641e-03 3 1  ON 27
ci_029                -5.170695e-03 3 1  ON 28
ci_030                -4.217873e-03 3 1  ON 29
ci_031                 3.243645e-03 3 1  ON 30
ci_032                 4.392733e-03 3 1  ON 31
ci_033                 2.345058e-03 3 1  ON 32
ci_034                 4.175824e-03 3 1  ON 33
ci_035                 1.734541e-03 3 1  ON 34
ci_036                 2.193852e-03 3 1  ON 35
ci_037                 3.588451e-03 3 1  ON 36
ci_038                 3.703019e-03 3 1  ON 37
ci_039                 4.647907e-03 3 1  ON 38
ci_040                 4.988359e-03 3 1  ON 39
ci_041                 2.976588e-03 3 1  ON 40
ci_042                 2.735536e-03 3 1  ON 41
ci_043                 3.001508e-03 3 1  ON 42
ci_044                 3.198278e-03 3 1  ON 43
ci_045                 2.444537e-03 3 1  ON 44
ci_046                 2.684642e-03 3 1  ON 45
ci_047                -9.996687e-04 3 1  ON 46
ci_048                -8.374041e-04 3 1  ON 47
ci_049                 7.412094e-04 3 1  ON 48
ci_050                 1.074660e-03 3 1  ON 49
ci_051                -2.776142e-04 3 1  ON 50
ci_052                -1.208366e-03 3 1  ON 51
ci_053                -2.420519e-03 3 1  ON 52
ci_054                -2.639594e-03 3 1  ON 53
ci_055                -1.826630e-03 3 1  ON 54
ci_056                -1.960495e-03 3 1  ON 55
ci_057                -1.314952e-03 3 1  ON 56
ci_058                -9.789929e-04 3 1  ON 57
ci_059                -5.697223e-04 3 1  ON 58
ci_060                -7.766149e-04 3 1  ON 59
ci_061                -6.932285e-05 3 1  ON 60
ci_062                -9.473693e-04 3 1  ON 61
ci_063                -8.854483e-04 3 1  ON 62
ci_064                -5.146498e-04 3 1  ON 63
ci_065                -1.334252e-03 3 1  ON 64
ci_066                -1.933064e-03 3 1  ON 65
ci_067                -1.805482e-03 3 1  ON 66
ci_068                -1.576182e-03 3 1  ON 67
ci_069                -5.731913e-04 3 1  ON 68
ci_070                -4.405217e-04 3 1  ON 69
ci_071                -2.077799e-03 3 1  ON 70
ci_072                -1.995668e-03 3 1  ON 71
ci_073                 1.600405e-04 3 1  ON 72
ci_074                 2.018379e-04 3 1  ON 73
ci_075                 1.518184e-04 3 1  ON 74
ci_076                 8.318352e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.6907
    reference variance = 0.500563
====================================================
  Execution time = 2.5827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5244e-01
  Total weights = 1.9554e+06
  Execution time = 3.6123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442003272010
                                         uncertainty =       0.003895898498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442003272010
                                         uncertainty =       0.003895898498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470145910
  error estimate for blocks of size 2^( 2) =       0.000493871789
  error estimate for blocks of size 2^( 3) =       0.000516238401
  error estimate for blocks of size 2^( 4) =       0.000532738896
  error estimate for blocks of size 2^( 5) =       0.000542515267
  error estimate for blocks of size 2^( 6) =       0.000547816626
  error estimate for blocks of size 2^( 7) =       0.000551604949

      target function =      -0.743313508993
              le_mean =     -22.662725201113
             les_mean =     514.051553887571
             stat err =       0.000543668934
             autocorr =       1.337222608329
   target nu stat err =       0.000543668934
   target dn stat err =       0.005242862233
      target stat err =       0.004332347204
              std dev =       0.664886722558
             le_variance =       0.442074353833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442003331674
                                         uncertainty =       0.003896056101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442003331674
                                         uncertainty =       0.003896056101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470145942
  error estimate for blocks of size 2^( 2) =       0.000493871824
  error estimate for blocks of size 2^( 3) =       0.000516238435
  error estimate for blocks of size 2^( 4) =       0.000532738929
  error estimate for blocks of size 2^( 5) =       0.000542515300
  error estimate for blocks of size 2^( 6) =       0.000547816649
  error estimate for blocks of size 2^( 7) =       0.000551604978

      target function =      -0.743313269252
              le_mean =     -22.662725204089
             les_mean =     514.051554313110
             stat err =       0.000543668964
             autocorr =       1.337222576480
   target nu stat err =       0.000543668964
   target dn stat err =       0.005243061135
      target stat err =       0.004332505693
              std dev =       0.664886766798
             le_variance =       0.442074412663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442003301834
                                         uncertainty =       0.003895977308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442003301834
                                         uncertainty =       0.003895977308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470145926
  error estimate for blocks of size 2^( 2) =       0.000493871807
  error estimate for blocks of size 2^( 3) =       0.000516238418
  error estimate for blocks of size 2^( 4) =       0.000532738913
  error estimate for blocks of size 2^( 5) =       0.000542515284
  error estimate for blocks of size 2^( 6) =       0.000547816638
  error estimate for blocks of size 2^( 7) =       0.000551604963

      target function =      -0.743313389735
              le_mean =     -22.662725202600
             les_mean =     514.051554099519
             stat err =       0.000543668949
             autocorr =       1.337222592407
   target nu stat err =       0.000543668949
   target dn stat err =       0.005242961691
      target stat err =       0.004332426461
              std dev =       0.664886744672
             le_variance =       0.442074383241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442003275737
                                         uncertainty =       0.003895908349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442003275737
                                         uncertainty =       0.003895908349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470145912
  error estimate for blocks of size 2^( 2) =       0.000493871792
  error estimate for blocks of size 2^( 3) =       0.000516238403
  error estimate for blocks of size 2^( 4) =       0.000532738898
  error estimate for blocks of size 2^( 5) =       0.000542515269
  error estimate for blocks of size 2^( 6) =       0.000547816627
  error estimate for blocks of size 2^( 7) =       0.000551604950

      target function =      -0.743313494153
              le_mean =     -22.662725201299
             les_mean =     514.051553913973
             stat err =       0.000543668936
             autocorr =       1.337222606347
   target nu stat err =       0.000543668936
   target dn stat err =       0.005242874665
      target stat err =       0.004332357112
              std dev =       0.664886725321
             le_variance =       0.442074357508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743313508993        initial  <--
     2.5000e+02     2.5000e+03             9.9551e-07        -0.743313269252
     1.0000e+03     1.0000e+04             2.4891e-07        -0.743313389735
     4.0000e+03     4.0000e+04             6.2229e-08        -0.743313494153

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9761
  </log>
  <optVariables href="FORM2.s013.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996677e-02 3 1  ON 2
ci_004                -5.098027e-02 3 1  ON 3
ci_005                 1.954951e-02 3 1  ON 4
ci_006                 1.991073e-02 3 1  ON 5
ci_007                 1.473778e-02 3 1  ON 6
ci_008                 1.564543e-02 3 1  ON 7
ci_009                -1.331728e-02 3 1  ON 8
ci_010                -1.213886e-02 3 1  ON 9
ci_011                -9.957275e-03 3 1  ON 10
ci_012                -9.108125e-03 3 1  ON 11
ci_013                 8.438529e-03 3 1  ON 12
ci_014                 9.447788e-03 3 1  ON 13
ci_015                 9.576638e-03 3 1  ON 14
ci_016                 9.512213e-03 3 1  ON 15
ci_017                 8.538784e-03 3 1  ON 16
ci_018                 8.365227e-03 3 1  ON 17
ci_019                -1.038880e-03 3 1  ON 18
ci_020                -1.339170e-03 3 1  ON 19
ci_021                -1.174163e-02 3 1  ON 20
ci_022                -1.169129e-02 3 1  ON 21
ci_023                 4.843376e-03 3 1  ON 22
ci_024                 4.944703e-03 3 1  ON 23
ci_025                 1.131937e-02 3 1  ON 24
ci_026                 1.141451e-02 3 1  ON 25
ci_027                 6.500269e-03 3 1  ON 26
ci_028                 6.245577e-03 3 1  ON 27
ci_029                -5.170734e-03 3 1  ON 28
ci_030                -4.217909e-03 3 1  ON 29
ci_031                 3.243634e-03 3 1  ON 30
ci_032                 4.392688e-03 3 1  ON 31
ci_033                 2.345031e-03 3 1  ON 32
ci_034                 4.175793e-03 3 1  ON 33
ci_035                 1.734559e-03 3 1  ON 34
ci_036                 2.193867e-03 3 1  ON 35
ci_037                 3.588405e-03 3 1  ON 36
ci_038                 3.703038e-03 3 1  ON 37
ci_039                 4.647875e-03 3 1  ON 38
ci_040                 4.988388e-03 3 1  ON 39
ci_041                 2.976616e-03 3 1  ON 40
ci_042                 2.735538e-03 3 1  ON 41
ci_043                 3.001598e-03 3 1  ON 42
ci_044                 3.198316e-03 3 1  ON 43
ci_045                 2.444510e-03 3 1  ON 44
ci_046                 2.684727e-03 3 1  ON 45
ci_047                -9.996614e-04 3 1  ON 46
ci_048                -8.373945e-04 3 1  ON 47
ci_049                 7.412050e-04 3 1  ON 48
ci_050                 1.074674e-03 3 1  ON 49
ci_051                -2.775505e-04 3 1  ON 50
ci_052                -1.208366e-03 3 1  ON 51
ci_053                -2.420451e-03 3 1  ON 52
ci_054                -2.639635e-03 3 1  ON 53
ci_055                -1.826650e-03 3 1  ON 54
ci_056                -1.960518e-03 3 1  ON 55
ci_057                -1.314990e-03 3 1  ON 56
ci_058                -9.789677e-04 3 1  ON 57
ci_059                -5.697959e-04 3 1  ON 58
ci_060                -7.766425e-04 3 1  ON 59
ci_061                -6.936427e-05 3 1  ON 60
ci_062                -9.473347e-04 3 1  ON 61
ci_063                -8.854746e-04 3 1  ON 62
ci_064                -5.147163e-04 3 1  ON 63
ci_065                -1.334197e-03 3 1  ON 64
ci_066                -1.933041e-03 3 1  ON 65
ci_067                -1.805522e-03 3 1  ON 66
ci_068                -1.576141e-03 3 1  ON 67
ci_069                -5.732001e-04 3 1  ON 68
ci_070                -4.405583e-04 3 1  ON 69
ci_071                -2.077781e-03 3 1  ON 70
ci_072                -1.995642e-03 3 1  ON 71
ci_073                 1.601278e-04 3 1  ON 72
ci_074                 2.018448e-04 3 1  ON 73
ci_075                 1.518694e-04 3 1  ON 74
ci_076                 8.318432e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.6374
    reference variance = 0.439714
====================================================
  Execution time = 2.6408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5194e-01
  Total weights = 1.954997242e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442189563713
                                         uncertainty =       0.002655186966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442189563713
                                         uncertainty =       0.002655186966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470169426
  error estimate for blocks of size 2^( 2) =       0.000494281927
  error estimate for blocks of size 2^( 3) =       0.000516885405
  error estimate for blocks of size 2^( 4) =       0.000531937823
  error estimate for blocks of size 2^( 5) =       0.000542064612
  error estimate for blocks of size 2^( 6) =       0.000545456843
  error estimate for blocks of size 2^( 7) =       0.000549059686

      target function =      -0.743736904541
              le_mean =     -22.662203004773
             les_mean =     514.027386059918
             stat err =       0.000542129741
             autocorr =       1.329528639482
   target nu stat err =       0.000542129741
   target dn stat err =       0.002940005266
      target stat err =       0.002479820840
              std dev =       0.664919979064
             le_variance =       0.442118578559


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266220300477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743744255594       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743744264646       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743744266740       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743744266930       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743744266954       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743744267010       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743744267016       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743744267030       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743744267036       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743744267028       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743744267029       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743744267027       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+03 is 7.604089e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743744255594       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743744257857       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743744258381       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743744258431       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743744258434       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743744258430       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743744258439       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743744258451       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743744258450       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743744258447       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743744258468       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743744258472       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+04 is 1.901044e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743744255594       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743744256160       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743744256291       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743744256303       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743744256304       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743744256283       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743744256231       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743744256309       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743744256332       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743744256429       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743744256290       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743744256301       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 4.0000e+04 is 4.752623e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076032 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1147e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996677e-02 3 1  ON 2
ci_004                -5.098026e-02 3 1  ON 3
ci_005                 1.954949e-02 3 1  ON 4
ci_006                 1.991072e-02 3 1  ON 5
ci_007                 1.473777e-02 3 1  ON 6
ci_008                 1.564542e-02 3 1  ON 7
ci_009                -1.331727e-02 3 1  ON 8
ci_010                -1.213886e-02 3 1  ON 9
ci_011                -9.957272e-03 3 1  ON 10
ci_012                -9.108113e-03 3 1  ON 11
ci_013                 8.438521e-03 3 1  ON 12
ci_014                 9.447778e-03 3 1  ON 13
ci_015                 9.576625e-03 3 1  ON 14
ci_016                 9.512194e-03 3 1  ON 15
ci_017                 8.538783e-03 3 1  ON 16
ci_018                 8.365218e-03 3 1  ON 17
ci_019                -1.038888e-03 3 1  ON 18
ci_020                -1.339186e-03 3 1  ON 19
ci_021                -1.174165e-02 3 1  ON 20
ci_022                -1.169129e-02 3 1  ON 21
ci_023                 4.843367e-03 3 1  ON 22
ci_024                 4.944705e-03 3 1  ON 23
ci_025                 1.131938e-02 3 1  ON 24
ci_026                 1.141451e-02 3 1  ON 25
ci_027                 6.500266e-03 3 1  ON 26
ci_028                 6.245580e-03 3 1  ON 27
ci_029                -5.170720e-03 3 1  ON 28
ci_030                -4.217904e-03 3 1  ON 29
ci_031                 3.243653e-03 3 1  ON 30
ci_032                 4.392687e-03 3 1  ON 31
ci_033                 2.345035e-03 3 1  ON 32
ci_034                 4.175788e-03 3 1  ON 33
ci_035                 1.734560e-03 3 1  ON 34
ci_036                 2.193862e-03 3 1  ON 35
ci_037                 3.588397e-03 3 1  ON 36
ci_038                 3.703044e-03 3 1  ON 37
ci_039                 4.647874e-03 3 1  ON 38
ci_040                 4.988387e-03 3 1  ON 39
ci_041                 2.976606e-03 3 1  ON 40
ci_042                 2.735541e-03 3 1  ON 41
ci_043                 3.001592e-03 3 1  ON 42
ci_044                 3.198310e-03 3 1  ON 43
ci_045                 2.444508e-03 3 1  ON 44
ci_046                 2.684718e-03 3 1  ON 45
ci_047                -9.996556e-04 3 1  ON 46
ci_048                -8.373956e-04 3 1  ON 47
ci_049                 7.412167e-04 3 1  ON 48
ci_050                 1.074669e-03 3 1  ON 49
ci_051                -2.775506e-04 3 1  ON 50
ci_052                -1.208371e-03 3 1  ON 51
ci_053                -2.420451e-03 3 1  ON 52
ci_054                -2.639638e-03 3 1  ON 53
ci_055                -1.826647e-03 3 1  ON 54
ci_056                -1.960514e-03 3 1  ON 55
ci_057                -1.314990e-03 3 1  ON 56
ci_058                -9.789634e-04 3 1  ON 57
ci_059                -5.697898e-04 3 1  ON 58
ci_060                -7.766409e-04 3 1  ON 59
ci_061                -6.936969e-05 3 1  ON 60
ci_062                -9.473280e-04 3 1  ON 61
ci_063                -8.854663e-04 3 1  ON 62
ci_064                -5.147252e-04 3 1  ON 63
ci_065                -1.334209e-03 3 1  ON 64
ci_066                -1.933045e-03 3 1  ON 65
ci_067                -1.805527e-03 3 1  ON 66
ci_068                -1.576138e-03 3 1  ON 67
ci_069                -5.732012e-04 3 1  ON 68
ci_070                -4.405603e-04 3 1  ON 69
ci_071                -2.077780e-03 3 1  ON 70
ci_072                -1.995640e-03 3 1  ON 71
ci_073                 1.601246e-04 3 1  ON 72
ci_074                 2.018411e-04 3 1  ON 73
ci_075                 1.518755e-04 3 1  ON 74
ci_076                 8.318422e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7679
    reference variance = 0.320512
====================================================
  Execution time = 2.5823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5195e-01
  Total weights = 1.9550e+06
  Execution time = 3.6170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441732283901
                                         uncertainty =       0.002225630775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441732283901
                                         uncertainty =       0.002225630775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470168151
  error estimate for blocks of size 2^( 2) =       0.000494555145
  error estimate for blocks of size 2^( 3) =       0.000516470745
  error estimate for blocks of size 2^( 4) =       0.000531839164
  error estimate for blocks of size 2^( 5) =       0.000541398532
  error estimate for blocks of size 2^( 6) =       0.000545122859
  error estimate for blocks of size 2^( 7) =       0.000547906635

      target function =      -0.743735843744
              le_mean =     -22.662565135564
             les_mean =     514.043803939526
             stat err =       0.000541566797
             autocorr =       1.326776120920
   target nu stat err =       0.000541566797
   target dn stat err =       0.002807485074
      target stat err =       0.002375769201
              std dev =       0.664918176379
             le_variance =       0.442116181279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441732268649
                                         uncertainty =       0.002225630399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441732268649
                                         uncertainty =       0.002225630399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470168143
  error estimate for blocks of size 2^( 2) =       0.000494555139
  error estimate for blocks of size 2^( 3) =       0.000516470741
  error estimate for blocks of size 2^( 4) =       0.000531839160
  error estimate for blocks of size 2^( 5) =       0.000541398529
  error estimate for blocks of size 2^( 6) =       0.000545122858
  error estimate for blocks of size 2^( 7) =       0.000547906634

      target function =      -0.743735967548
              le_mean =     -22.662565135627
             les_mean =     514.043803791207
             stat err =       0.000541566795
             autocorr =       1.326776155212
   target nu stat err =       0.000541566795
   target dn stat err =       0.002807486616
      target stat err =       0.002375771189
              std dev =       0.664918164999
             le_variance =       0.442116166145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441732276275
                                         uncertainty =       0.002225630587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441732276275
                                         uncertainty =       0.002225630587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470168147
  error estimate for blocks of size 2^( 2) =       0.000494555142
  error estimate for blocks of size 2^( 3) =       0.000516470743
  error estimate for blocks of size 2^( 4) =       0.000531839162
  error estimate for blocks of size 2^( 5) =       0.000541398530
  error estimate for blocks of size 2^( 6) =       0.000545122858
  error estimate for blocks of size 2^( 7) =       0.000547906634

      target function =      -0.743735905677
              le_mean =     -22.662565135596
             les_mean =     514.043803865328
             stat err =       0.000541566796
             autocorr =       1.326776138069
   target nu stat err =       0.000541566796
   target dn stat err =       0.002807485844
      target stat err =       0.002375770195
              std dev =       0.664918170688
             le_variance =       0.442116173711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441732282948
                                         uncertainty =       0.002225630751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441732282948
                                         uncertainty =       0.002225630751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470168151
  error estimate for blocks of size 2^( 2) =       0.000494555144
  error estimate for blocks of size 2^( 3) =       0.000516470745
  error estimate for blocks of size 2^( 4) =       0.000531839163
  error estimate for blocks of size 2^( 5) =       0.000541398531
  error estimate for blocks of size 2^( 6) =       0.000545122859
  error estimate for blocks of size 2^( 7) =       0.000547906635

      target function =      -0.743735851489
              le_mean =     -22.662565135568
             les_mean =     514.043803930247
             stat err =       0.000541566797
             autocorr =       1.326776123060
   target nu stat err =       0.000541566797
   target dn stat err =       0.002807485171
      target stat err =       0.002375769325
              std dev =       0.664918175667
             le_variance =       0.442116180332


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743735843744        initial
     2.5000e+03     2.5000e+04             7.6041e-08        -0.743735967548  <--
     1.0000e+04     1.0000e+05             1.9010e-08        -0.743735905677
     4.0000e+04     4.0000e+05             4.7526e-09        -0.743735851489

*****************************************************************************
Applying the update for shift_i =   2.5000e+03     and shift_s =   2.5000e+04
*****************************************************************************

  Execution time = 4.3985e+01
  </log>
  <optVariables href="FORM2.s014.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996675e-02 3 1  ON 2
ci_004                -5.098023e-02 3 1  ON 3
ci_005                 1.954945e-02 3 1  ON 4
ci_006                 1.991071e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564542e-02 3 1  ON 7
ci_009                -1.331725e-02 3 1  ON 8
ci_010                -1.213886e-02 3 1  ON 9
ci_011                -9.957261e-03 3 1  ON 10
ci_012                -9.108079e-03 3 1  ON 11
ci_013                 8.438498e-03 3 1  ON 12
ci_014                 9.447749e-03 3 1  ON 13
ci_015                 9.576587e-03 3 1  ON 14
ci_016                 9.512137e-03 3 1  ON 15
ci_017                 8.538779e-03 3 1  ON 16
ci_018                 8.365192e-03 3 1  ON 17
ci_019                -1.038914e-03 3 1  ON 18
ci_020                -1.339232e-03 3 1  ON 19
ci_021                -1.174169e-02 3 1  ON 20
ci_022                -1.169130e-02 3 1  ON 21
ci_023                 4.843340e-03 3 1  ON 22
ci_024                 4.944711e-03 3 1  ON 23
ci_025                 1.131942e-02 3 1  ON 24
ci_026                 1.141452e-02 3 1  ON 25
ci_027                 6.500255e-03 3 1  ON 26
ci_028                 6.245587e-03 3 1  ON 27
ci_029                -5.170680e-03 3 1  ON 28
ci_030                -4.217888e-03 3 1  ON 29
ci_031                 3.243709e-03 3 1  ON 30
ci_032                 4.392686e-03 3 1  ON 31
ci_033                 2.345048e-03 3 1  ON 32
ci_034                 4.175771e-03 3 1  ON 33
ci_035                 1.734564e-03 3 1  ON 34
ci_036                 2.193846e-03 3 1  ON 35
ci_037                 3.588373e-03 3 1  ON 36
ci_038                 3.703061e-03 3 1  ON 37
ci_039                 4.647872e-03 3 1  ON 38
ci_040                 4.988385e-03 3 1  ON 39
ci_041                 2.976577e-03 3 1  ON 40
ci_042                 2.735550e-03 3 1  ON 41
ci_043                 3.001577e-03 3 1  ON 42
ci_044                 3.198294e-03 3 1  ON 43
ci_045                 2.444501e-03 3 1  ON 44
ci_046                 2.684694e-03 3 1  ON 45
ci_047                -9.996383e-04 3 1  ON 46
ci_048                -8.373990e-04 3 1  ON 47
ci_049                 7.412520e-04 3 1  ON 48
ci_050                 1.074655e-03 3 1  ON 49
ci_051                -2.775509e-04 3 1  ON 50
ci_052                -1.208387e-03 3 1  ON 51
ci_053                -2.420451e-03 3 1  ON 52
ci_054                -2.639646e-03 3 1  ON 53
ci_055                -1.826636e-03 3 1  ON 54
ci_056                -1.960502e-03 3 1  ON 55
ci_057                -1.314990e-03 3 1  ON 56
ci_058                -9.789502e-04 3 1  ON 57
ci_059                -5.697716e-04 3 1  ON 58
ci_060                -7.766363e-04 3 1  ON 59
ci_061                -6.938596e-05 3 1  ON 60
ci_062                -9.473081e-04 3 1  ON 61
ci_063                -8.854415e-04 3 1  ON 62
ci_064                -5.147519e-04 3 1  ON 63
ci_065                -1.334244e-03 3 1  ON 64
ci_066                -1.933059e-03 3 1  ON 65
ci_067                -1.805542e-03 3 1  ON 66
ci_068                -1.576128e-03 3 1  ON 67
ci_069                -5.732047e-04 3 1  ON 68
ci_070                -4.405664e-04 3 1  ON 69
ci_071                -2.077777e-03 3 1  ON 70
ci_072                -1.995631e-03 3 1  ON 71
ci_073                 1.601150e-04 3 1  ON 72
ci_074                 2.018300e-04 3 1  ON 73
ci_075                 1.518936e-04 3 1  ON 74
ci_076                 8.318392e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.6395
    reference variance = 0.305987
====================================================
  Execution time = 2.6757e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.9109e-01
  Total weights = 1.955301267e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446022424213
                                         uncertainty =       0.003059480937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446022424213
                                         uncertainty =       0.003059480937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472229767
  error estimate for blocks of size 2^( 2) =       0.000495973552
  error estimate for blocks of size 2^( 3) =       0.000518484106
  error estimate for blocks of size 2^( 4) =       0.000534507677
  error estimate for blocks of size 2^( 5) =       0.000542850517
  error estimate for blocks of size 2^( 6) =       0.000548153149
  error estimate for blocks of size 2^( 7) =       0.000551434706

      target function =      -0.712249221000
              le_mean =     -22.662455738899
             les_mean =     514.077986153674
             stat err =       0.000544236512
             autocorr =       1.328215763255
   target nu stat err =       0.000544236512
   target dn stat err =       0.030987328488
      target stat err =       0.023306745358
              std dev =       0.667833741301
             le_variance =       0.446001906021


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266245573890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713010493816       residual = 7.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713011721514       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713011823320       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713011882310       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713011893706       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713011896855       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713011897611       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713011897836       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713011898002       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713011897905       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713011897809       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.713011897820       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.713011897819       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+02 is 4.465350e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713010493816       residual = 7.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713010800759       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713010826211       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713010840959       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713010843812       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713010844595       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713010844787       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713010844845       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713010844874       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713010844859       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713010844830       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.713010844840       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.713010844836       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+03 is 1.116378e-06

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.713010493816       residual = 7.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.713010570553       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.713010576916       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.713010580603       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.713010581329       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.713010581517       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.713010581555       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.713010581575       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.713010581585       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.713010581586       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.713010581576       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.713010581574       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.713010581576       residual = 5.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+04 is 2.790969e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1485e+01
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_001                -7.054744e-01 3 1  ON 0
ci_002                -7.030147e-01 3 1  ON 1
ci_003                -4.996689e-02 3 1  ON 2
ci_004                -5.097912e-02 3 1  ON 3
ci_005                 1.954943e-02 3 1  ON 4
ci_006                 1.991069e-02 3 1  ON 5
ci_007                 1.473773e-02 3 1  ON 6
ci_008                 1.564545e-02 3 1  ON 7
ci_009                -1.331723e-02 3 1  ON 8
ci_010                -1.213883e-02 3 1  ON 9
ci_011                -9.957165e-03 3 1  ON 10
ci_012                -9.108043e-03 3 1  ON 11
ci_013                 8.438419e-03 3 1  ON 12
ci_014                 9.447749e-03 3 1  ON 13
ci_015                 9.576552e-03 3 1  ON 14
ci_016                 9.512136e-03 3 1  ON 15
ci_017                 8.538818e-03 3 1  ON 16
ci_018                 8.365229e-03 3 1  ON 17
ci_019                -1.038973e-03 3 1  ON 18
ci_020                -1.339327e-03 3 1  ON 19
ci_021                -1.174174e-02 3 1  ON 20
ci_022                -1.169130e-02 3 1  ON 21
ci_023                 4.843377e-03 3 1  ON 22
ci_024                 4.944704e-03 3 1  ON 23
ci_025                 1.131947e-02 3 1  ON 24
ci_026                 1.141472e-02 3 1  ON 25
ci_027                 6.500259e-03 3 1  ON 26
ci_028                 6.245504e-03 3 1  ON 27
ci_029                -5.170600e-03 3 1  ON 28
ci_030                -4.217637e-03 3 1  ON 29
ci_031                 3.243795e-03 3 1  ON 30
ci_032                 4.392599e-03 3 1  ON 31
ci_033                 2.345066e-03 3 1  ON 32
ci_034                 4.175762e-03 3 1  ON 33
ci_035                 1.734573e-03 3 1  ON 34
ci_036                 2.193808e-03 3 1  ON 35
ci_037                 3.588306e-03 3 1  ON 36
ci_038                 3.702975e-03 3 1  ON 37
ci_039                 4.647805e-03 3 1  ON 38
ci_040                 4.988221e-03 3 1  ON 39
ci_041                 2.976639e-03 3 1  ON 40
ci_042                 2.735572e-03 3 1  ON 41
ci_043                 3.001447e-03 3 1  ON 42
ci_044                 3.198560e-03 3 1  ON 43
ci_045                 2.444412e-03 3 1  ON 44
ci_046                 2.684725e-03 3 1  ON 45
ci_047                -9.996705e-04 3 1  ON 46
ci_048                -8.373963e-04 3 1  ON 47
ci_049                 7.412998e-04 3 1  ON 48
ci_050                 1.074680e-03 3 1  ON 49
ci_051                -2.775842e-04 3 1  ON 50
ci_052                -1.208587e-03 3 1  ON 51
ci_053                -2.420457e-03 3 1  ON 52
ci_054                -2.639824e-03 3 1  ON 53
ci_055                -1.826502e-03 3 1  ON 54
ci_056                -1.960519e-03 3 1  ON 55
ci_057                -1.314977e-03 3 1  ON 56
ci_058                -9.789592e-04 3 1  ON 57
ci_059                -5.697578e-04 3 1  ON 58
ci_060                -7.766049e-04 3 1  ON 59
ci_061                -6.934399e-05 3 1  ON 60
ci_062                -9.473766e-04 3 1  ON 61
ci_063                -8.854710e-04 3 1  ON 62
ci_064                -5.145880e-04 3 1  ON 63
ci_065                -1.334275e-03 3 1  ON 64
ci_066                -1.933194e-03 3 1  ON 65
ci_067                -1.805614e-03 3 1  ON 66
ci_068                -1.576144e-03 3 1  ON 67
ci_069                -5.731770e-04 3 1  ON 68
ci_070                -4.402713e-04 3 1  ON 69
ci_071                -2.077736e-03 3 1  ON 70
ci_072                -1.995447e-03 3 1  ON 71
ci_073                 1.601070e-04 3 1  ON 72
ci_074                 2.018077e-04 3 1  ON 73
ci_075                 1.518021e-04 3 1  ON 74
ci_076                 8.314016e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.5155
    reference variance = 0.324259
====================================================
  Execution time = 2.6346e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5895e-01
  Total weights = 1.9556e+06
  Execution time = 4.0114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443358603875
                                         uncertainty =       0.002556217086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443358603875
                                         uncertainty =       0.002556217086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470788722
  error estimate for blocks of size 2^( 2) =       0.000494657031
  error estimate for blocks of size 2^( 3) =       0.000517103234
  error estimate for blocks of size 2^( 4) =       0.000532027017
  error estimate for blocks of size 2^( 5) =       0.000541912603
  error estimate for blocks of size 2^( 6) =       0.000548313162
  error estimate for blocks of size 2^( 7) =       0.000550607953

      target function =      -0.738034814425
              le_mean =     -22.661580598814
             les_mean =     514.006176249652
             stat err =       0.000543215184
             autocorr =       1.331348336540
   target nu stat err =       0.000543215184
   target dn stat err =       0.005271525046
      target stat err =       0.004287180435
              std dev =       0.665795795629
             le_variance =       0.443284041478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443358670251
                                         uncertainty =       0.002556225014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443358670251
                                         uncertainty =       0.002556225014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470788757
  error estimate for blocks of size 2^( 2) =       0.000494657055
  error estimate for blocks of size 2^( 3) =       0.000517103222
  error estimate for blocks of size 2^( 4) =       0.000532027008
  error estimate for blocks of size 2^( 5) =       0.000541912600
  error estimate for blocks of size 2^( 6) =       0.000548313106
  error estimate for blocks of size 2^( 7) =       0.000550607830

      target function =      -0.737996317486
              le_mean =     -22.661580590028
             les_mean =     514.006223227685
             stat err =       0.000543215136
             autocorr =       1.331347904704
   target nu stat err =       0.000543215136
   target dn stat err =       0.005308309850
      target stat err =       0.004316082221
              std dev =       0.665795845381
             le_variance =       0.443284107727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443358636957
                                         uncertainty =       0.002556221050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443358636957
                                         uncertainty =       0.002556221050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470788740
  error estimate for blocks of size 2^( 2) =       0.000494657043
  error estimate for blocks of size 2^( 3) =       0.000517103228
  error estimate for blocks of size 2^( 4) =       0.000532027012
  error estimate for blocks of size 2^( 5) =       0.000541912601
  error estimate for blocks of size 2^( 6) =       0.000548313134
  error estimate for blocks of size 2^( 7) =       0.000550607891

      target function =      -0.738015640255
              le_mean =     -22.661580594423
             les_mean =     514.006199647222
             stat err =       0.000543215160
             autocorr =       1.331348120662
   target nu stat err =       0.000543215160
   target dn stat err =       0.005289831162
      target stat err =       0.004301563628
              std dev =       0.665795820426
             le_variance =       0.443284074496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443358607998
                                         uncertainty =       0.002556217581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443358607998
                                         uncertainty =       0.002556217581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470788724
  error estimate for blocks of size 2^( 2) =       0.000494657033
  error estimate for blocks of size 2^( 3) =       0.000517103233
  error estimate for blocks of size 2^( 4) =       0.000532027016
  error estimate for blocks of size 2^( 5) =       0.000541912603
  error estimate for blocks of size 2^( 6) =       0.000548313158
  error estimate for blocks of size 2^( 7) =       0.000550607945

      target function =      -0.738032425803
              le_mean =     -22.661580598266
             les_mean =     514.006179164319
             stat err =       0.000543215181
             autocorr =       1.331348309555
   target nu stat err =       0.000543215181
   target dn stat err =       0.005273803865
      target stat err =       0.004288970923
              std dev =       0.665795798720
             le_variance =       0.443284045593


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738034814425        initial  <--
     6.2500e+02     6.2500e+03             4.4654e-06        -0.737996317486
     2.5000e+03     2.5000e+04             1.1164e-06        -0.738015640255
     1.0000e+04     1.0000e+05             2.7910e-07        -0.738032425803

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.8151
  </log>
  <optVariables href="FORM2.s015.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996675e-02 3 1  ON 2
ci_004                -5.098023e-02 3 1  ON 3
ci_005                 1.954945e-02 3 1  ON 4
ci_006                 1.991071e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564542e-02 3 1  ON 7
ci_009                -1.331725e-02 3 1  ON 8
ci_010                -1.213886e-02 3 1  ON 9
ci_011                -9.957261e-03 3 1  ON 10
ci_012                -9.108079e-03 3 1  ON 11
ci_013                 8.438498e-03 3 1  ON 12
ci_014                 9.447749e-03 3 1  ON 13
ci_015                 9.576587e-03 3 1  ON 14
ci_016                 9.512137e-03 3 1  ON 15
ci_017                 8.538779e-03 3 1  ON 16
ci_018                 8.365192e-03 3 1  ON 17
ci_019                -1.038914e-03 3 1  ON 18
ci_020                -1.339232e-03 3 1  ON 19
ci_021                -1.174169e-02 3 1  ON 20
ci_022                -1.169130e-02 3 1  ON 21
ci_023                 4.843340e-03 3 1  ON 22
ci_024                 4.944711e-03 3 1  ON 23
ci_025                 1.131942e-02 3 1  ON 24
ci_026                 1.141452e-02 3 1  ON 25
ci_027                 6.500255e-03 3 1  ON 26
ci_028                 6.245587e-03 3 1  ON 27
ci_029                -5.170680e-03 3 1  ON 28
ci_030                -4.217888e-03 3 1  ON 29
ci_031                 3.243709e-03 3 1  ON 30
ci_032                 4.392686e-03 3 1  ON 31
ci_033                 2.345048e-03 3 1  ON 32
ci_034                 4.175771e-03 3 1  ON 33
ci_035                 1.734564e-03 3 1  ON 34
ci_036                 2.193846e-03 3 1  ON 35
ci_037                 3.588373e-03 3 1  ON 36
ci_038                 3.703061e-03 3 1  ON 37
ci_039                 4.647872e-03 3 1  ON 38
ci_040                 4.988385e-03 3 1  ON 39
ci_041                 2.976577e-03 3 1  ON 40
ci_042                 2.735550e-03 3 1  ON 41
ci_043                 3.001577e-03 3 1  ON 42
ci_044                 3.198294e-03 3 1  ON 43
ci_045                 2.444501e-03 3 1  ON 44
ci_046                 2.684694e-03 3 1  ON 45
ci_047                -9.996383e-04 3 1  ON 46
ci_048                -8.373990e-04 3 1  ON 47
ci_049                 7.412520e-04 3 1  ON 48
ci_050                 1.074655e-03 3 1  ON 49
ci_051                -2.775509e-04 3 1  ON 50
ci_052                -1.208387e-03 3 1  ON 51
ci_053                -2.420451e-03 3 1  ON 52
ci_054                -2.639646e-03 3 1  ON 53
ci_055                -1.826636e-03 3 1  ON 54
ci_056                -1.960502e-03 3 1  ON 55
ci_057                -1.314990e-03 3 1  ON 56
ci_058                -9.789502e-04 3 1  ON 57
ci_059                -5.697716e-04 3 1  ON 58
ci_060                -7.766363e-04 3 1  ON 59
ci_061                -6.938596e-05 3 1  ON 60
ci_062                -9.473081e-04 3 1  ON 61
ci_063                -8.854415e-04 3 1  ON 62
ci_064                -5.147519e-04 3 1  ON 63
ci_065                -1.334244e-03 3 1  ON 64
ci_066                -1.933059e-03 3 1  ON 65
ci_067                -1.805542e-03 3 1  ON 66
ci_068                -1.576128e-03 3 1  ON 67
ci_069                -5.732047e-04 3 1  ON 68
ci_070                -4.405664e-04 3 1  ON 69
ci_071                -2.077777e-03 3 1  ON 70
ci_072                -1.995631e-03 3 1  ON 71
ci_073                 1.601150e-04 3 1  ON 72
ci_074                 2.018300e-04 3 1  ON 73
ci_075                 1.518936e-04 3 1  ON 74
ci_076                 8.318392e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6307e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6061
    reference variance = 0.315972
====================================================
  Execution time = 2.6489e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5040e-01
  Total weights = 1.955184244e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439238179954
                                         uncertainty =       0.002248203740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439238179954
                                         uncertainty =       0.002248203740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468590840
  error estimate for blocks of size 2^( 2) =       0.000492685864
  error estimate for blocks of size 2^( 3) =       0.000514227226
  error estimate for blocks of size 2^( 4) =       0.000529226950
  error estimate for blocks of size 2^( 5) =       0.000538446794
  error estimate for blocks of size 2^( 6) =       0.000543909978
  error estimate for blocks of size 2^( 7) =       0.000546016750

      target function =      -0.745004198958
              le_mean =     -22.662993291655
             les_mean =     514.061665890193
             stat err =       0.000539400118
             autocorr =       1.325056765459
   target nu stat err =       0.000539400118
   target dn stat err =       0.003118391257
      target stat err =       0.002632918763
              std dev =       0.662687521652
             le_variance =       0.439154751353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266299329165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745012613633       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745012616076       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745012616493       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745012616522       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745012616522       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745012616522       residual = 7.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745012616521       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745012616507       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745012616517       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745012616506       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745012616490       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+03 is 3.169301e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745012613633       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745012614244       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745012614348       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745012614356       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745012614356       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745012614350       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745012614353       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745012614351       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745012614351       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745012614366       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745012614352       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+04 is 7.923289e-09

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745012613633       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745012613786       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745012613812       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745012613814       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745012613817       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745012613648       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745012613642       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745012614161       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745012613894       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745012613663       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745012613872       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.0000e+05 is 1.980825e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085703 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1201e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996675e-02 3 1  ON 2
ci_004                -5.098023e-02 3 1  ON 3
ci_005                 1.954944e-02 3 1  ON 4
ci_006                 1.991070e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564541e-02 3 1  ON 7
ci_009                -1.331725e-02 3 1  ON 8
ci_010                -1.213886e-02 3 1  ON 9
ci_011                -9.957258e-03 3 1  ON 10
ci_012                -9.108076e-03 3 1  ON 11
ci_013                 8.438494e-03 3 1  ON 12
ci_014                 9.447745e-03 3 1  ON 13
ci_015                 9.576586e-03 3 1  ON 14
ci_016                 9.512135e-03 3 1  ON 15
ci_017                 8.538780e-03 3 1  ON 16
ci_018                 8.365189e-03 3 1  ON 17
ci_019                -1.038920e-03 3 1  ON 18
ci_020                -1.339237e-03 3 1  ON 19
ci_021                -1.174169e-02 3 1  ON 20
ci_022                -1.169130e-02 3 1  ON 21
ci_023                 4.843342e-03 3 1  ON 22
ci_024                 4.944709e-03 3 1  ON 23
ci_025                 1.131942e-02 3 1  ON 24
ci_026                 1.141452e-02 3 1  ON 25
ci_027                 6.500253e-03 3 1  ON 26
ci_028                 6.245588e-03 3 1  ON 27
ci_029                -5.170677e-03 3 1  ON 28
ci_030                -4.217889e-03 3 1  ON 29
ci_031                 3.243717e-03 3 1  ON 30
ci_032                 4.392693e-03 3 1  ON 31
ci_033                 2.345048e-03 3 1  ON 32
ci_034                 4.175771e-03 3 1  ON 33
ci_035                 1.734564e-03 3 1  ON 34
ci_036                 2.193846e-03 3 1  ON 35
ci_037                 3.588369e-03 3 1  ON 36
ci_038                 3.703060e-03 3 1  ON 37
ci_039                 4.647872e-03 3 1  ON 38
ci_040                 4.988384e-03 3 1  ON 39
ci_041                 2.976574e-03 3 1  ON 40
ci_042                 2.735550e-03 3 1  ON 41
ci_043                 3.001578e-03 3 1  ON 42
ci_044                 3.198293e-03 3 1  ON 43
ci_045                 2.444502e-03 3 1  ON 44
ci_046                 2.684694e-03 3 1  ON 45
ci_047                -9.996379e-04 3 1  ON 46
ci_048                -8.373981e-04 3 1  ON 47
ci_049                 7.412543e-04 3 1  ON 48
ci_050                 1.074653e-03 3 1  ON 49
ci_051                -2.775516e-04 3 1  ON 50
ci_052                -1.208385e-03 3 1  ON 51
ci_053                -2.420450e-03 3 1  ON 52
ci_054                -2.639645e-03 3 1  ON 53
ci_055                -1.826635e-03 3 1  ON 54
ci_056                -1.960500e-03 3 1  ON 55
ci_057                -1.314988e-03 3 1  ON 56
ci_058                -9.789492e-04 3 1  ON 57
ci_059                -5.697724e-04 3 1  ON 58
ci_060                -7.766343e-04 3 1  ON 59
ci_061                -6.938632e-05 3 1  ON 60
ci_062                -9.473100e-04 3 1  ON 61
ci_063                -8.854430e-04 3 1  ON 62
ci_064                -5.147541e-04 3 1  ON 63
ci_065                -1.334243e-03 3 1  ON 64
ci_066                -1.933060e-03 3 1  ON 65
ci_067                -1.805542e-03 3 1  ON 66
ci_068                -1.576130e-03 3 1  ON 67
ci_069                -5.732015e-04 3 1  ON 68
ci_070                -4.405662e-04 3 1  ON 69
ci_071                -2.077776e-03 3 1  ON 70
ci_072                -1.995631e-03 3 1  ON 71
ci_073                 1.601149e-04 3 1  ON 72
ci_074                 2.018293e-04 3 1  ON 73
ci_075                 1.518948e-04 3 1  ON 74
ci_076                 8.318385e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.6467
    reference variance = 0.374168
====================================================
  Execution time = 2.6059e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4866e-01
  Total weights = 1.9555e+06
  Execution time = 3.6067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439610036084
                                         uncertainty =       0.002056021359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439610036084
                                         uncertainty =       0.002056021359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468820926
  error estimate for blocks of size 2^( 2) =       0.000492451625
  error estimate for blocks of size 2^( 3) =       0.000514188536
  error estimate for blocks of size 2^( 4) =       0.000529950041
  error estimate for blocks of size 2^( 5) =       0.000538097346
  error estimate for blocks of size 2^( 6) =       0.000542493589
  error estimate for blocks of size 2^( 7) =       0.000545768283

      target function =      -0.746438714845
              le_mean =     -22.662765563458
             les_mean =     514.049604552079
             stat err =       0.000539077315
             autocorr =       1.322172550812
   target nu stat err =       0.000539077315
   target dn stat err =       0.002509268957
      target stat err =       0.002155047525
              std dev =       0.663012911229
             le_variance =       0.439586120457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439610027682
                                         uncertainty =       0.002056021340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439610027682
                                         uncertainty =       0.002056021340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468820921
  error estimate for blocks of size 2^( 2) =       0.000492451622
  error estimate for blocks of size 2^( 3) =       0.000514188533
  error estimate for blocks of size 2^( 4) =       0.000529950037
  error estimate for blocks of size 2^( 5) =       0.000538097343
  error estimate for blocks of size 2^( 6) =       0.000542493585
  error estimate for blocks of size 2^( 7) =       0.000545768279

      target function =      -0.746438736711
              le_mean =     -22.662765563390
             les_mean =     514.049604522550
             stat err =       0.000539077311
             autocorr =       1.322172557831
   target nu stat err =       0.000539077311
   target dn stat err =       0.002509265882
      target stat err =       0.002155045206
              std dev =       0.663012904899
             le_variance =       0.439586112063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439610031883
                                         uncertainty =       0.002056021350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439610031883
                                         uncertainty =       0.002056021350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468820923
  error estimate for blocks of size 2^( 2) =       0.000492451623
  error estimate for blocks of size 2^( 3) =       0.000514188535
  error estimate for blocks of size 2^( 4) =       0.000529950039
  error estimate for blocks of size 2^( 5) =       0.000538097345
  error estimate for blocks of size 2^( 6) =       0.000542493587
  error estimate for blocks of size 2^( 7) =       0.000545768281

      target function =      -0.746438725779
              le_mean =     -22.662765563424
             les_mean =     514.049604537313
             stat err =       0.000539077313
             autocorr =       1.322172554319
   target nu stat err =       0.000539077313
   target dn stat err =       0.002509267419
      target stat err =       0.002155046366
              std dev =       0.663012908064
             le_variance =       0.439586116260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439610035559
                                         uncertainty =       0.002056021358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439610035559
                                         uncertainty =       0.002056021358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468820925
  error estimate for blocks of size 2^( 2) =       0.000492451625
  error estimate for blocks of size 2^( 3) =       0.000514188536
  error estimate for blocks of size 2^( 4) =       0.000529950040
  error estimate for blocks of size 2^( 5) =       0.000538097346
  error estimate for blocks of size 2^( 6) =       0.000542493588
  error estimate for blocks of size 2^( 7) =       0.000545768282

      target function =      -0.746438716212
              le_mean =     -22.662765563453
             les_mean =     514.049604550233
             stat err =       0.000539077314
             autocorr =       1.322172551244
   target nu stat err =       0.000539077314
   target dn stat err =       0.002509268765
      target stat err =       0.002155047380
              std dev =       0.663012910834
             le_variance =       0.439586119932


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746438714845        initial
     6.2500e+03     6.2500e+04             3.1693e-08        -0.746438736711  <--
     2.5000e+04     2.5000e+05             7.9233e-09        -0.746438725779
     1.0000e+05     1.0000e+06             1.9808e-09        -0.746438716212

*****************************************************************************
Applying the update for shift_i =   6.2500e+03     and shift_s =   6.2500e+04
*****************************************************************************

  Execution time = 4.4111e+01
  </log>
  <optVariables href="FORM2.s016.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996673e-02 3 1  ON 2
ci_004                -5.098023e-02 3 1  ON 3
ci_005                 1.954943e-02 3 1  ON 4
ci_006                 1.991069e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564540e-02 3 1  ON 7
ci_009                -1.331723e-02 3 1  ON 8
ci_010                -1.213885e-02 3 1  ON 9
ci_011                -9.957249e-03 3 1  ON 10
ci_012                -9.108067e-03 3 1  ON 11
ci_013                 8.438483e-03 3 1  ON 12
ci_014                 9.447731e-03 3 1  ON 13
ci_015                 9.576584e-03 3 1  ON 14
ci_016                 9.512126e-03 3 1  ON 15
ci_017                 8.538782e-03 3 1  ON 16
ci_018                 8.365182e-03 3 1  ON 17
ci_019                -1.038937e-03 3 1  ON 18
ci_020                -1.339255e-03 3 1  ON 19
ci_021                -1.174170e-02 3 1  ON 20
ci_022                -1.169132e-02 3 1  ON 21
ci_023                 4.843347e-03 3 1  ON 22
ci_024                 4.944703e-03 3 1  ON 23
ci_025                 1.131944e-02 3 1  ON 24
ci_026                 1.141453e-02 3 1  ON 25
ci_027                 6.500246e-03 3 1  ON 26
ci_028                 6.245590e-03 3 1  ON 27
ci_029                -5.170667e-03 3 1  ON 28
ci_030                -4.217892e-03 3 1  ON 29
ci_031                 3.243741e-03 3 1  ON 30
ci_032                 4.392713e-03 3 1  ON 31
ci_033                 2.345047e-03 3 1  ON 32
ci_034                 4.175772e-03 3 1  ON 33
ci_035                 1.734564e-03 3 1  ON 34
ci_036                 2.193846e-03 3 1  ON 35
ci_037                 3.588358e-03 3 1  ON 36
ci_038                 3.703060e-03 3 1  ON 37
ci_039                 4.647873e-03 3 1  ON 38
ci_040                 4.988384e-03 3 1  ON 39
ci_041                 2.976564e-03 3 1  ON 40
ci_042                 2.735550e-03 3 1  ON 41
ci_043                 3.001580e-03 3 1  ON 42
ci_044                 3.198291e-03 3 1  ON 43
ci_045                 2.444504e-03 3 1  ON 44
ci_046                 2.684693e-03 3 1  ON 45
ci_047                -9.996369e-04 3 1  ON 46
ci_048                -8.373954e-04 3 1  ON 47
ci_049                 7.412612e-04 3 1  ON 48
ci_050                 1.074648e-03 3 1  ON 49
ci_051                -2.775536e-04 3 1  ON 50
ci_052                -1.208379e-03 3 1  ON 51
ci_053                -2.420449e-03 3 1  ON 52
ci_054                -2.639642e-03 3 1  ON 53
ci_055                -1.826633e-03 3 1  ON 54
ci_056                -1.960496e-03 3 1  ON 55
ci_057                -1.314984e-03 3 1  ON 56
ci_058                -9.789464e-04 3 1  ON 57
ci_059                -5.697749e-04 3 1  ON 58
ci_060                -7.766284e-04 3 1  ON 59
ci_061                -6.938738e-05 3 1  ON 60
ci_062                -9.473156e-04 3 1  ON 61
ci_063                -8.854473e-04 3 1  ON 62
ci_064                -5.147606e-04 3 1  ON 63
ci_065                -1.334242e-03 3 1  ON 64
ci_066                -1.933064e-03 3 1  ON 65
ci_067                -1.805542e-03 3 1  ON 66
ci_068                -1.576136e-03 3 1  ON 67
ci_069                -5.731921e-04 3 1  ON 68
ci_070                -4.405656e-04 3 1  ON 69
ci_071                -2.077772e-03 3 1  ON 70
ci_072                -1.995630e-03 3 1  ON 71
ci_073                 1.601143e-04 3 1  ON 72
ci_074                 2.018272e-04 3 1  ON 73
ci_075                 1.518982e-04 3 1  ON 74
ci_076                 8.318365e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5319e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6648
    reference variance = 0.47799
====================================================
  Execution time = 2.6714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5314e-01
  Total weights = 1.955136022e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442664571561
                                         uncertainty =       0.002295116388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442664571561
                                         uncertainty =       0.002295116388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470432195
  error estimate for blocks of size 2^( 2) =       0.000494397174
  error estimate for blocks of size 2^( 3) =       0.000516856199
  error estimate for blocks of size 2^( 4) =       0.000531785042
  error estimate for blocks of size 2^( 5) =       0.000540682887
  error estimate for blocks of size 2^( 6) =       0.000544472017
  error estimate for blocks of size 2^( 7) =       0.000548431943

      target function =      -0.742753724689
              le_mean =     -22.662225365813
             les_mean =     514.029602421500
             stat err =       0.000541342972
             autocorr =       1.324191925367
   target nu stat err =       0.000541342972
   target dn stat err =       0.002904540352
      target stat err =       0.002445233298
              std dev =       0.665291589659
             le_variance =       0.442612899271


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266222536581e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742760871258       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742760884695       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742760887802       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742760888148       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742760888192       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742760888340       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742760888520       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742760888520       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742760888517       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742760888523       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742760888525       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+03 is 1.163259e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742760871258       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742760874618       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742760875394       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742760875481       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742760875505       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742760875521       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742760875572       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742760875583       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742760875579       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742760875547       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742760875573       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+03 is 2.908202e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742760871258       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742760872098       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742760872292       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742760872303       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742760872302       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742760872347       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742760872384       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742760872339       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742760872302       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742760872365       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742760872240       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+04 is 7.270540e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1454e+01
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996674e-02 3 1  ON 2
ci_004                -5.098022e-02 3 1  ON 3
ci_005                 1.954943e-02 3 1  ON 4
ci_006                 1.991067e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564540e-02 3 1  ON 7
ci_009                -1.331721e-02 3 1  ON 8
ci_010                -1.213886e-02 3 1  ON 9
ci_011                -9.957245e-03 3 1  ON 10
ci_012                -9.108075e-03 3 1  ON 11
ci_013                 8.438473e-03 3 1  ON 12
ci_014                 9.447714e-03 3 1  ON 13
ci_015                 9.576567e-03 3 1  ON 14
ci_016                 9.512112e-03 3 1  ON 15
ci_017                 8.538780e-03 3 1  ON 16
ci_018                 8.365177e-03 3 1  ON 17
ci_019                -1.038963e-03 3 1  ON 18
ci_020                -1.339284e-03 3 1  ON 19
ci_021                -1.174171e-02 3 1  ON 20
ci_022                -1.169133e-02 3 1  ON 21
ci_023                 4.843345e-03 3 1  ON 22
ci_024                 4.944689e-03 3 1  ON 23
ci_025                 1.131946e-02 3 1  ON 24
ci_026                 1.141455e-02 3 1  ON 25
ci_027                 6.500247e-03 3 1  ON 26
ci_028                 6.245582e-03 3 1  ON 27
ci_029                -5.170669e-03 3 1  ON 28
ci_030                -4.217895e-03 3 1  ON 29
ci_031                 3.243768e-03 3 1  ON 30
ci_032                 4.392732e-03 3 1  ON 31
ci_033                 2.345055e-03 3 1  ON 32
ci_034                 4.175775e-03 3 1  ON 33
ci_035                 1.734574e-03 3 1  ON 34
ci_036                 2.193835e-03 3 1  ON 35
ci_037                 3.588355e-03 3 1  ON 36
ci_038                 3.703044e-03 3 1  ON 37
ci_039                 4.647878e-03 3 1  ON 38
ci_040                 4.988375e-03 3 1  ON 39
ci_041                 2.976563e-03 3 1  ON 40
ci_042                 2.735536e-03 3 1  ON 41
ci_043                 3.001585e-03 3 1  ON 42
ci_044                 3.198293e-03 3 1  ON 43
ci_045                 2.444519e-03 3 1  ON 44
ci_046                 2.684696e-03 3 1  ON 45
ci_047                -9.996352e-04 3 1  ON 46
ci_048                -8.373936e-04 3 1  ON 47
ci_049                 7.412638e-04 3 1  ON 48
ci_050                 1.074643e-03 3 1  ON 49
ci_051                -2.775578e-04 3 1  ON 50
ci_052                -1.208378e-03 3 1  ON 51
ci_053                -2.420455e-03 3 1  ON 52
ci_054                -2.639641e-03 3 1  ON 53
ci_055                -1.826618e-03 3 1  ON 54
ci_056                -1.960488e-03 3 1  ON 55
ci_057                -1.314988e-03 3 1  ON 56
ci_058                -9.789378e-04 3 1  ON 57
ci_059                -5.697762e-04 3 1  ON 58
ci_060                -7.766235e-04 3 1  ON 59
ci_061                -6.938919e-05 3 1  ON 60
ci_062                -9.473253e-04 3 1  ON 61
ci_063                -8.854599e-04 3 1  ON 62
ci_064                -5.147538e-04 3 1  ON 63
ci_065                -1.334242e-03 3 1  ON 64
ci_066                -1.933071e-03 3 1  ON 65
ci_067                -1.805549e-03 3 1  ON 66
ci_068                -1.576138e-03 3 1  ON 67
ci_069                -5.731809e-04 3 1  ON 68
ci_070                -4.405611e-04 3 1  ON 69
ci_071                -2.077766e-03 3 1  ON 70
ci_072                -1.995621e-03 3 1  ON 71
ci_073                 1.601029e-04 3 1  ON 72
ci_074                 2.018297e-04 3 1  ON 73
ci_075                 1.518948e-04 3 1  ON 74
ci_076                 8.318433e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.6184
    reference variance = 0.483846
====================================================
  Execution time = 2.5989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5202e-01
  Total weights = 1.9550e+06
  Execution time = 3.6197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442575472908
                                         uncertainty =       0.002310978907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442575472908
                                         uncertainty =       0.002310978907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470361544
  error estimate for blocks of size 2^( 2) =       0.000494617347
  error estimate for blocks of size 2^( 3) =       0.000517003034
  error estimate for blocks of size 2^( 4) =       0.000532008414
  error estimate for blocks of size 2^( 5) =       0.000542094378
  error estimate for blocks of size 2^( 6) =       0.000547869092
  error estimate for blocks of size 2^( 7) =       0.000549727654

      target function =      -0.743673599118
              le_mean =     -22.662833229762
             les_mean =     514.056032825658
             stat err =       0.000542924884
             autocorr =       1.332342496992
   target nu stat err =       0.000542924884
   target dn stat err =       0.002849123210
      target stat err =       0.002409735749
              std dev =       0.665191674427
             le_variance =       0.442479963727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442575449346
                                         uncertainty =       0.002310979457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442575449346
                                         uncertainty =       0.002310979457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470361531
  error estimate for blocks of size 2^( 2) =       0.000494617338
  error estimate for blocks of size 2^( 3) =       0.000517003028
  error estimate for blocks of size 2^( 4) =       0.000532008409
  error estimate for blocks of size 2^( 5) =       0.000542094374
  error estimate for blocks of size 2^( 6) =       0.000547869087
  error estimate for blocks of size 2^( 7) =       0.000549727649

      target function =      -0.743673551256
              le_mean =     -22.662833230163
             les_mean =     514.056032902252
             stat err =       0.000542924880
             autocorr =       1.332342545554
   target nu stat err =       0.000542924880
   target dn stat err =       0.002849123384
      target stat err =       0.002409735587
              std dev =       0.665191656779
             le_variance =       0.442479940248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442575461126
                                         uncertainty =       0.002310979182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442575461126
                                         uncertainty =       0.002310979182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470361538
  error estimate for blocks of size 2^( 2) =       0.000494617343
  error estimate for blocks of size 2^( 3) =       0.000517003031
  error estimate for blocks of size 2^( 4) =       0.000532008411
  error estimate for blocks of size 2^( 5) =       0.000542094376
  error estimate for blocks of size 2^( 6) =       0.000547869089
  error estimate for blocks of size 2^( 7) =       0.000549727651

      target function =      -0.743673577667
              le_mean =     -22.662833229963
             les_mean =     514.056032860932
             stat err =       0.000542924882
             autocorr =       1.332342521272
   target nu stat err =       0.000542924882
   target dn stat err =       0.002849123296
      target stat err =       0.002409735683
              std dev =       0.665191665603
             le_variance =       0.442479951987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442575471435
                                         uncertainty =       0.002310978942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442575471435
                                         uncertainty =       0.002310978942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470361543
  error estimate for blocks of size 2^( 2) =       0.000494617347
  error estimate for blocks of size 2^( 3) =       0.000517003034
  error estimate for blocks of size 2^( 4) =       0.000532008413
  error estimate for blocks of size 2^( 5) =       0.000542094378
  error estimate for blocks of size 2^( 6) =       0.000547869091
  error estimate for blocks of size 2^( 7) =       0.000549727653

      target function =      -0.743673596664
              le_mean =     -22.662833229787
             les_mean =     514.056032829790
             stat err =       0.000542924884
             autocorr =       1.332342500029
   target nu stat err =       0.000542924884
   target dn stat err =       0.002849123220
      target stat err =       0.002409735742
              std dev =       0.665191673324
             le_variance =       0.442479962259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743673599118        initial  <--
     1.5625e+03     1.5625e+04             1.1633e-07        -0.743673551256
     6.2500e+03     6.2500e+04             2.9082e-08        -0.743673577667
     2.5000e+04     2.5000e+05             7.2705e-09        -0.743673596664

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1704
  </log>
  <optVariables href="FORM2.s017.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996673e-02 3 1  ON 2
ci_004                -5.098023e-02 3 1  ON 3
ci_005                 1.954943e-02 3 1  ON 4
ci_006                 1.991069e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564540e-02 3 1  ON 7
ci_009                -1.331723e-02 3 1  ON 8
ci_010                -1.213885e-02 3 1  ON 9
ci_011                -9.957249e-03 3 1  ON 10
ci_012                -9.108067e-03 3 1  ON 11
ci_013                 8.438483e-03 3 1  ON 12
ci_014                 9.447731e-03 3 1  ON 13
ci_015                 9.576584e-03 3 1  ON 14
ci_016                 9.512126e-03 3 1  ON 15
ci_017                 8.538782e-03 3 1  ON 16
ci_018                 8.365182e-03 3 1  ON 17
ci_019                -1.038937e-03 3 1  ON 18
ci_020                -1.339255e-03 3 1  ON 19
ci_021                -1.174170e-02 3 1  ON 20
ci_022                -1.169132e-02 3 1  ON 21
ci_023                 4.843347e-03 3 1  ON 22
ci_024                 4.944703e-03 3 1  ON 23
ci_025                 1.131944e-02 3 1  ON 24
ci_026                 1.141453e-02 3 1  ON 25
ci_027                 6.500246e-03 3 1  ON 26
ci_028                 6.245590e-03 3 1  ON 27
ci_029                -5.170667e-03 3 1  ON 28
ci_030                -4.217892e-03 3 1  ON 29
ci_031                 3.243741e-03 3 1  ON 30
ci_032                 4.392713e-03 3 1  ON 31
ci_033                 2.345047e-03 3 1  ON 32
ci_034                 4.175772e-03 3 1  ON 33
ci_035                 1.734564e-03 3 1  ON 34
ci_036                 2.193846e-03 3 1  ON 35
ci_037                 3.588358e-03 3 1  ON 36
ci_038                 3.703060e-03 3 1  ON 37
ci_039                 4.647873e-03 3 1  ON 38
ci_040                 4.988384e-03 3 1  ON 39
ci_041                 2.976564e-03 3 1  ON 40
ci_042                 2.735550e-03 3 1  ON 41
ci_043                 3.001580e-03 3 1  ON 42
ci_044                 3.198291e-03 3 1  ON 43
ci_045                 2.444504e-03 3 1  ON 44
ci_046                 2.684693e-03 3 1  ON 45
ci_047                -9.996369e-04 3 1  ON 46
ci_048                -8.373954e-04 3 1  ON 47
ci_049                 7.412612e-04 3 1  ON 48
ci_050                 1.074648e-03 3 1  ON 49
ci_051                -2.775536e-04 3 1  ON 50
ci_052                -1.208379e-03 3 1  ON 51
ci_053                -2.420449e-03 3 1  ON 52
ci_054                -2.639642e-03 3 1  ON 53
ci_055                -1.826633e-03 3 1  ON 54
ci_056                -1.960496e-03 3 1  ON 55
ci_057                -1.314984e-03 3 1  ON 56
ci_058                -9.789464e-04 3 1  ON 57
ci_059                -5.697749e-04 3 1  ON 58
ci_060                -7.766284e-04 3 1  ON 59
ci_061                -6.938738e-05 3 1  ON 60
ci_062                -9.473156e-04 3 1  ON 61
ci_063                -8.854473e-04 3 1  ON 62
ci_064                -5.147606e-04 3 1  ON 63
ci_065                -1.334242e-03 3 1  ON 64
ci_066                -1.933064e-03 3 1  ON 65
ci_067                -1.805542e-03 3 1  ON 66
ci_068                -1.576136e-03 3 1  ON 67
ci_069                -5.731921e-04 3 1  ON 68
ci_070                -4.405656e-04 3 1  ON 69
ci_071                -2.077772e-03 3 1  ON 70
ci_072                -1.995630e-03 3 1  ON 71
ci_073                 1.601143e-04 3 1  ON 72
ci_074                 2.018272e-04 3 1  ON 73
ci_075                 1.518982e-04 3 1  ON 74
ci_076                 8.318365e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5631e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6875
    reference variance = 0.480486
====================================================
  Execution time = 2.6696e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5031e-01
  Total weights = 1.954791399e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487600964
                                         uncertainty =       0.002053047489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440487600964
                                         uncertainty =       0.002053047489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469294599
  error estimate for blocks of size 2^( 2) =       0.000493521713
  error estimate for blocks of size 2^( 3) =       0.000515928347
  error estimate for blocks of size 2^( 4) =       0.000531993738
  error estimate for blocks of size 2^( 5) =       0.000541461011
  error estimate for blocks of size 2^( 6) =       0.000545168493
  error estimate for blocks of size 2^( 7) =       0.000548607419

      target function =      -0.745077872410
              le_mean =     -22.662490404142
             les_mean =     514.038781870666
             stat err =       0.000541807665
             autocorr =       1.332904942232
   target nu stat err =       0.000541807665
   target dn stat err =       0.002615691145
      target stat err =       0.002231613822
              std dev =       0.663682786463
             le_variance =       0.440474841048


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266249040414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745083620347       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745083621191       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745083621389       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745083621394       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745083621399       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745083621389       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745083621402       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745083621414       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745083621371       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745083621374       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745083621376       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+04 is 1.053209e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745083620347       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745083620558       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745083620607       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745083620608       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745083620608       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745083620652       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745083620685       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745083620452       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745083620676       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745083620605       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745083620661       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+04 is 2.633027e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745083620347       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745083620400       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745083620412       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745083620412       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745083620391       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745083620386       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745083619260       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745083620307       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745083619941       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745083619615       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745083620981       residual = 9.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.5000e+05 is 6.582571e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1423e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996673e-02 3 1  ON 2
ci_004                -5.098023e-02 3 1  ON 3
ci_005                 1.954943e-02 3 1  ON 4
ci_006                 1.991069e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564540e-02 3 1  ON 7
ci_009                -1.331723e-02 3 1  ON 8
ci_010                -1.213885e-02 3 1  ON 9
ci_011                -9.957249e-03 3 1  ON 10
ci_012                -9.108068e-03 3 1  ON 11
ci_013                 8.438482e-03 3 1  ON 12
ci_014                 9.447731e-03 3 1  ON 13
ci_015                 9.576583e-03 3 1  ON 14
ci_016                 9.512125e-03 3 1  ON 15
ci_017                 8.538781e-03 3 1  ON 16
ci_018                 8.365182e-03 3 1  ON 17
ci_019                -1.038939e-03 3 1  ON 18
ci_020                -1.339257e-03 3 1  ON 19
ci_021                -1.174170e-02 3 1  ON 20
ci_022                -1.169132e-02 3 1  ON 21
ci_023                 4.843347e-03 3 1  ON 22
ci_024                 4.944703e-03 3 1  ON 23
ci_025                 1.131944e-02 3 1  ON 24
ci_026                 1.141453e-02 3 1  ON 25
ci_027                 6.500246e-03 3 1  ON 26
ci_028                 6.245589e-03 3 1  ON 27
ci_029                -5.170665e-03 3 1  ON 28
ci_030                -4.217891e-03 3 1  ON 29
ci_031                 3.243742e-03 3 1  ON 30
ci_032                 4.392713e-03 3 1  ON 31
ci_033                 2.345048e-03 3 1  ON 32
ci_034                 4.175771e-03 3 1  ON 33
ci_035                 1.734564e-03 3 1  ON 34
ci_036                 2.193845e-03 3 1  ON 35
ci_037                 3.588358e-03 3 1  ON 36
ci_038                 3.703058e-03 3 1  ON 37
ci_039                 4.647873e-03 3 1  ON 38
ci_040                 4.988383e-03 3 1  ON 39
ci_041                 2.976564e-03 3 1  ON 40
ci_042                 2.735550e-03 3 1  ON 41
ci_043                 3.001579e-03 3 1  ON 42
ci_044                 3.198291e-03 3 1  ON 43
ci_045                 2.444504e-03 3 1  ON 44
ci_046                 2.684694e-03 3 1  ON 45
ci_047                -9.996376e-04 3 1  ON 46
ci_048                -8.373960e-04 3 1  ON 47
ci_049                 7.412614e-04 3 1  ON 48
ci_050                 1.074648e-03 3 1  ON 49
ci_051                -2.775554e-04 3 1  ON 50
ci_052                -1.208377e-03 3 1  ON 51
ci_053                -2.420449e-03 3 1  ON 52
ci_054                -2.639641e-03 3 1  ON 53
ci_055                -1.826632e-03 3 1  ON 54
ci_056                -1.960496e-03 3 1  ON 55
ci_057                -1.314983e-03 3 1  ON 56
ci_058                -9.789465e-04 3 1  ON 57
ci_059                -5.697745e-04 3 1  ON 58
ci_060                -7.766284e-04 3 1  ON 59
ci_061                -6.938751e-05 3 1  ON 60
ci_062                -9.473156e-04 3 1  ON 61
ci_063                -8.854461e-04 3 1  ON 62
ci_064                -5.147607e-04 3 1  ON 63
ci_065                -1.334242e-03 3 1  ON 64
ci_066                -1.933065e-03 3 1  ON 65
ci_067                -1.805541e-03 3 1  ON 66
ci_068                -1.576137e-03 3 1  ON 67
ci_069                -5.731922e-04 3 1  ON 68
ci_070                -4.405663e-04 3 1  ON 69
ci_071                -2.077772e-03 3 1  ON 70
ci_072                -1.995630e-03 3 1  ON 71
ci_073                 1.601139e-04 3 1  ON 72
ci_074                 2.018279e-04 3 1  ON 73
ci_075                 1.518980e-04 3 1  ON 74
ci_076                 8.318372e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.6932
    reference variance = 0.384392
====================================================
  Execution time = 2.6074e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5381e-01
  Total weights = 1.9552e+06
  Execution time = 3.6037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439732893512
                                         uncertainty =       0.002109833650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439732893512
                                         uncertainty =       0.002109833650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468949982
  error estimate for blocks of size 2^( 2) =       0.000492905275
  error estimate for blocks of size 2^( 3) =       0.000515133651
  error estimate for blocks of size 2^( 4) =       0.000530677467
  error estimate for blocks of size 2^( 5) =       0.000540148526
  error estimate for blocks of size 2^( 6) =       0.000545441836
  error estimate for blocks of size 2^( 7) =       0.000548323702

      target function =      -0.742209424650
              le_mean =     -22.662028182971
             les_mean =     514.021328884812
             stat err =       0.000541147883
             autocorr =       1.331615618704
   target nu stat err =       0.000541147883
   target dn stat err =       0.003305648523
      target stat err =       0.002759260435
              std dev =       0.663195424568
             le_variance =       0.439828171168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439732891025
                                         uncertainty =       0.002109833581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439732891025
                                         uncertainty =       0.002109833581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468949981
  error estimate for blocks of size 2^( 2) =       0.000492905274
  error estimate for blocks of size 2^( 3) =       0.000515133650
  error estimate for blocks of size 2^( 4) =       0.000530677466
  error estimate for blocks of size 2^( 5) =       0.000540148525
  error estimate for blocks of size 2^( 6) =       0.000545441836
  error estimate for blocks of size 2^( 7) =       0.000548323702

      target function =      -0.742209430958
              le_mean =     -22.662028182963
             les_mean =     514.021328876767
             stat err =       0.000541147882
             autocorr =       1.331615623278
   target nu stat err =       0.000541147882
   target dn stat err =       0.003305646399
      target stat err =       0.002759258791
              std dev =       0.663195422684
             le_variance =       0.439828168669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439732892268
                                         uncertainty =       0.002109833615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439732892268
                                         uncertainty =       0.002109833615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468949981
  error estimate for blocks of size 2^( 2) =       0.000492905275
  error estimate for blocks of size 2^( 3) =       0.000515133651
  error estimate for blocks of size 2^( 4) =       0.000530677466
  error estimate for blocks of size 2^( 5) =       0.000540148526
  error estimate for blocks of size 2^( 6) =       0.000545441836
  error estimate for blocks of size 2^( 7) =       0.000548323702

      target function =      -0.742209427806
              le_mean =     -22.662028182967
             les_mean =     514.021328880788
             stat err =       0.000541147883
             autocorr =       1.331615620992
   target nu stat err =       0.000541147883
   target dn stat err =       0.003305647461
      target stat err =       0.002759259613
              std dev =       0.663195423626
             le_variance =       0.439828169918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439732893356
                                         uncertainty =       0.002109833646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439732893356
                                         uncertainty =       0.002109833646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468949982
  error estimate for blocks of size 2^( 2) =       0.000492905275
  error estimate for blocks of size 2^( 3) =       0.000515133651
  error estimate for blocks of size 2^( 4) =       0.000530677467
  error estimate for blocks of size 2^( 5) =       0.000540148526
  error estimate for blocks of size 2^( 6) =       0.000545441836
  error estimate for blocks of size 2^( 7) =       0.000548323702

      target function =      -0.742209425044
              le_mean =     -22.662028182970
             les_mean =     514.021328884309
             stat err =       0.000541147883
             autocorr =       1.331615618988
   target nu stat err =       0.000541147883
   target dn stat err =       0.003305648390
      target stat err =       0.002759260332
              std dev =       0.663195424450
             le_variance =       0.439828171012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742209424650        initial
     1.5625e+04     1.5625e+05             1.0532e-08        -0.742209430958  <--
     6.2500e+04     6.2500e+05             2.6330e-09        -0.742209427806
     2.5000e+05     2.5000e+06             6.5826e-10        -0.742209425044

*****************************************************************************
Applying the update for shift_i =   1.5625e+04     and shift_s =   1.5625e+05
*****************************************************************************

  Execution time = 4.4177e+01
  </log>
  <optVariables href="FORM2.s018.opt.xml">
ci_001                -7.054742e-01 3 1  ON 0
ci_002                -7.030149e-01 3 1  ON 1
ci_003                -4.996673e-02 3 1  ON 2
ci_004                -5.098022e-02 3 1  ON 3
ci_005                 1.954943e-02 3 1  ON 4
ci_006                 1.991069e-02 3 1  ON 5
ci_007                 1.473775e-02 3 1  ON 6
ci_008                 1.564540e-02 3 1  ON 7
ci_009                -1.331723e-02 3 1  ON 8
ci_010                -1.213885e-02 3 1  ON 9
ci_011                -9.957248e-03 3 1  ON 10
ci_012                -9.108070e-03 3 1  ON 11
ci_013                 8.438480e-03 3 1  ON 12
ci_014                 9.447730e-03 3 1  ON 13
ci_015                 9.576579e-03 3 1  ON 14
ci_016                 9.512120e-03 3 1  ON 15
ci_017                 8.538779e-03 3 1  ON 16
ci_018                 8.365182e-03 3 1  ON 17
ci_019                -1.038946e-03 3 1  ON 18
ci_020                -1.339265e-03 3 1  ON 19
ci_021                -1.174170e-02 3 1  ON 20
ci_022                -1.169132e-02 3 1  ON 21
ci_023                 4.843347e-03 3 1  ON 22
ci_024                 4.944703e-03 3 1  ON 23
ci_025                 1.131945e-02 3 1  ON 24
ci_026                 1.141454e-02 3 1  ON 25
ci_027                 6.500244e-03 3 1  ON 26
ci_028                 6.245588e-03 3 1  ON 27
ci_029                -5.170660e-03 3 1  ON 28
ci_030                -4.217889e-03 3 1  ON 29
ci_031                 3.243745e-03 3 1  ON 30
ci_032                 4.392714e-03 3 1  ON 31
ci_033                 2.345050e-03 3 1  ON 32
ci_034                 4.175768e-03 3 1  ON 33
ci_035                 1.734564e-03 3 1  ON 34
ci_036                 2.193844e-03 3 1  ON 35
ci_037                 3.588358e-03 3 1  ON 36
ci_038                 3.703053e-03 3 1  ON 37
ci_039                 4.647873e-03 3 1  ON 38
ci_040                 4.988381e-03 3 1  ON 39
ci_041                 2.976563e-03 3 1  ON 40
ci_042                 2.735550e-03 3 1  ON 41
ci_043                 3.001575e-03 3 1  ON 42
ci_044                 3.198291e-03 3 1  ON 43
ci_045                 2.444503e-03 3 1  ON 44
ci_046                 2.684695e-03 3 1  ON 45
ci_047                -9.996397e-04 3 1  ON 46
ci_048                -8.373977e-04 3 1  ON 47
ci_049                 7.412622e-04 3 1  ON 48
ci_050                 1.074651e-03 3 1  ON 49
ci_051                -2.775607e-04 3 1  ON 50
ci_052                -1.208372e-03 3 1  ON 51
ci_053                -2.420449e-03 3 1  ON 52
ci_054                -2.639636e-03 3 1  ON 53
ci_055                -1.826630e-03 3 1  ON 54
ci_056                -1.960497e-03 3 1  ON 55
ci_057                -1.314981e-03 3 1  ON 56
ci_058                -9.789469e-04 3 1  ON 57
ci_059                -5.697731e-04 3 1  ON 58
ci_060                -7.766283e-04 3 1  ON 59
ci_061                -6.938790e-05 3 1  ON 60
ci_062                -9.473154e-04 3 1  ON 61
ci_063                -8.854425e-04 3 1  ON 62
ci_064                -5.147608e-04 3 1  ON 63
ci_065                -1.334241e-03 3 1  ON 64
ci_066                -1.933068e-03 3 1  ON 65
ci_067                -1.805538e-03 3 1  ON 66
ci_068                -1.576138e-03 3 1  ON 67
ci_069                -5.731924e-04 3 1  ON 68
ci_070                -4.405683e-04 3 1  ON 69
ci_071                -2.077770e-03 3 1  ON 70
ci_072                -1.995630e-03 3 1  ON 71
ci_073                 1.601126e-04 3 1  ON 72
ci_074                 2.018298e-04 3 1  ON 73
ci_075                 1.518973e-04 3 1  ON 74
ci_076                 8.318394e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.5493
    reference variance = 0.548229
====================================================
  Execution time = 2.6615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6765e-01
  Total weights = 1.955299824e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455259312789
                                         uncertainty =       0.016663206576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.455259312789
                                         uncertainty =       0.016663206576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000477094807
  error estimate for blocks of size 2^( 2) =       0.000500622962
  error estimate for blocks of size 2^( 3) =       0.000522746847
  error estimate for blocks of size 2^( 4) =       0.000538813376
  error estimate for blocks of size 2^( 5) =       0.000547270181
  error estimate for blocks of size 2^( 6) =       0.000553399139
  error estimate for blocks of size 2^( 7) =       0.000554491419

      target function =      -0.730714543045
              le_mean =     -22.661724022103
             les_mean =     514.021388528835
             stat err =       0.000548493529
             autocorr =       1.321702273774
   target nu stat err =       0.000548493529
   target dn stat err =       0.021359456613
      target stat err =       0.016887039239
              std dev =       0.674713946907
             le_variance =       0.455238910150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266172402210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731105785461       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731105957689       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731105960466       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731105958106       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731105958207       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731105958517       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731105958463       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731105958519       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731105958522       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731105958484       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.731105958465       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.731105958466       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.731105958483       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+03 is 1.733833e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731105785461       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731105828519       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731105829213       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731105828623       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731105828649       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731105828726       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731105828705       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731105828719       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731105828732       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731105828712       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.731105828727       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.731105828712       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.731105828733       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+04 is 4.334624e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.731105785461       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.731105796226       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.731105796399       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.731105796238       residual = 8.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.731105796295       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.731105796228       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.731105796230       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.731105796277       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.731105796404       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.731105796112       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.731105796258       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.731105796274       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.731105796226       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.2500e+04 is 1.083659e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1360e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_001                -7.054741e-01 3 1  ON 0
ci_002                -7.030150e-01 3 1  ON 1
ci_003                -4.996670e-02 3 1  ON 2
ci_004                -5.098023e-02 3 1  ON 3
ci_005                 1.954941e-02 3 1  ON 4
ci_006                 1.991069e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564539e-02 3 1  ON 7
ci_009                -1.331722e-02 3 1  ON 8
ci_010                -1.213885e-02 3 1  ON 9
ci_011                -9.957249e-03 3 1  ON 10
ci_012                -9.108066e-03 3 1  ON 11
ci_013                 8.438474e-03 3 1  ON 12
ci_014                 9.447725e-03 3 1  ON 13
ci_015                 9.576540e-03 3 1  ON 14
ci_016                 9.512114e-03 3 1  ON 15
ci_017                 8.538774e-03 3 1  ON 16
ci_018                 8.365188e-03 3 1  ON 17
ci_019                -1.038949e-03 3 1  ON 18
ci_020                -1.339271e-03 3 1  ON 19
ci_021                -1.174172e-02 3 1  ON 20
ci_022                -1.169132e-02 3 1  ON 21
ci_023                 4.843339e-03 3 1  ON 22
ci_024                 4.944706e-03 3 1  ON 23
ci_025                 1.131946e-02 3 1  ON 24
ci_026                 1.141456e-02 3 1  ON 25
ci_027                 6.500239e-03 3 1  ON 26
ci_028                 6.245590e-03 3 1  ON 27
ci_029                -5.170637e-03 3 1  ON 28
ci_030                -4.217890e-03 3 1  ON 29
ci_031                 3.243735e-03 3 1  ON 30
ci_032                 4.392715e-03 3 1  ON 31
ci_033                 2.345049e-03 3 1  ON 32
ci_034                 4.175754e-03 3 1  ON 33
ci_035                 1.734561e-03 3 1  ON 34
ci_036                 2.193847e-03 3 1  ON 35
ci_037                 3.588357e-03 3 1  ON 36
ci_038                 3.703059e-03 3 1  ON 37
ci_039                 4.647857e-03 3 1  ON 38
ci_040                 4.988387e-03 3 1  ON 39
ci_041                 2.976561e-03 3 1  ON 40
ci_042                 2.735550e-03 3 1  ON 41
ci_043                 3.001566e-03 3 1  ON 42
ci_044                 3.198287e-03 3 1  ON 43
ci_045                 2.444515e-03 3 1  ON 44
ci_046                 2.684694e-03 3 1  ON 45
ci_047                -9.996359e-04 3 1  ON 46
ci_048                -8.373869e-04 3 1  ON 47
ci_049                 7.412620e-04 3 1  ON 48
ci_050                 1.074652e-03 3 1  ON 49
ci_051                -2.775585e-04 3 1  ON 50
ci_052                -1.208416e-03 3 1  ON 51
ci_053                -2.420448e-03 3 1  ON 52
ci_054                -2.639633e-03 3 1  ON 53
ci_055                -1.826630e-03 3 1  ON 54
ci_056                -1.960491e-03 3 1  ON 55
ci_057                -1.314982e-03 3 1  ON 56
ci_058                -9.789442e-04 3 1  ON 57
ci_059                -5.697641e-04 3 1  ON 58
ci_060                -7.766282e-04 3 1  ON 59
ci_061                -6.938768e-05 3 1  ON 60
ci_062                -9.473029e-04 3 1  ON 61
ci_063                -8.854436e-04 3 1  ON 62
ci_064                -5.147617e-04 3 1  ON 63
ci_065                -1.334255e-03 3 1  ON 64
ci_066                -1.933065e-03 3 1  ON 65
ci_067                -1.805527e-03 3 1  ON 66
ci_068                -1.576140e-03 3 1  ON 67
ci_069                -5.732024e-04 3 1  ON 68
ci_070                -4.405639e-04 3 1  ON 69
ci_071                -2.077768e-03 3 1  ON 70
ci_072                -1.995609e-03 3 1  ON 71
ci_073                 1.601201e-04 3 1  ON 72
ci_074                 2.018283e-04 3 1  ON 73
ci_075                 1.519137e-04 3 1  ON 74
ci_076                 8.318353e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.6156
    reference variance = 0.402275
====================================================
  Execution time = 2.7811e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5336e-01
  Total weights = 1.9552e+06
  Execution time = 3.6055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443193219060
                                         uncertainty =       0.002244140178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443193219060
                                         uncertainty =       0.002244140178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470736109
  error estimate for blocks of size 2^( 2) =       0.000494229849
  error estimate for blocks of size 2^( 3) =       0.000516445841
  error estimate for blocks of size 2^( 4) =       0.000532884072
  error estimate for blocks of size 2^( 5) =       0.000542220866
  error estimate for blocks of size 2^( 6) =       0.000545759420
  error estimate for blocks of size 2^( 7) =       0.000547925981

      target function =      -0.742576684706
              le_mean =     -22.661679241553
             les_mean =     514.005062488533
             stat err =       0.000542197585
             autocorr =       1.326661513268
   target nu stat err =       0.000542197585
   target dn stat err =       0.003149430632
      target stat err =       0.002636493467
              std dev =       0.665721390284
             le_variance =       0.443184969482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443193217057
                                         uncertainty =       0.002244141354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443193217057
                                         uncertainty =       0.002244141354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470736108
  error estimate for blocks of size 2^( 2) =       0.000494229850
  error estimate for blocks of size 2^( 3) =       0.000516445843
  error estimate for blocks of size 2^( 4) =       0.000532884075
  error estimate for blocks of size 2^( 5) =       0.000542220870
  error estimate for blocks of size 2^( 6) =       0.000545759427
  error estimate for blocks of size 2^( 7) =       0.000547925989

      target function =      -0.742576698157
              le_mean =     -22.661679240656
             les_mean =     514.005062431303
             stat err =       0.000542197590
             autocorr =       1.326661545982
   target nu stat err =       0.000542197590
   target dn stat err =       0.003149445241
      target stat err =       0.002636505164
              std dev =       0.665721388732
             le_variance =       0.443184967415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443193218058
                                         uncertainty =       0.002244140766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443193218058
                                         uncertainty =       0.002244140766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470736109
  error estimate for blocks of size 2^( 2) =       0.000494229850
  error estimate for blocks of size 2^( 3) =       0.000516445842
  error estimate for blocks of size 2^( 4) =       0.000532884074
  error estimate for blocks of size 2^( 5) =       0.000542220868
  error estimate for blocks of size 2^( 6) =       0.000545759423
  error estimate for blocks of size 2^( 7) =       0.000547925985

      target function =      -0.742576691476
              le_mean =     -22.661679241105
             les_mean =     514.005062459861
             stat err =       0.000542197588
             autocorr =       1.326661529625
   target nu stat err =       0.000542197588
   target dn stat err =       0.003149437936
      target stat err =       0.002636499315
              std dev =       0.665721389508
             le_variance =       0.443184968448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443193218935
                                         uncertainty =       0.002244140252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443193218935
                                         uncertainty =       0.002244140252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470736109
  error estimate for blocks of size 2^( 2) =       0.000494229849
  error estimate for blocks of size 2^( 3) =       0.000516445841
  error estimate for blocks of size 2^( 4) =       0.000532884073
  error estimate for blocks of size 2^( 5) =       0.000542220866
  error estimate for blocks of size 2^( 6) =       0.000545759421
  error estimate for blocks of size 2^( 7) =       0.000547925982

      target function =      -0.742576685557
              le_mean =     -22.661679241497
             les_mean =     514.005062484943
             stat err =       0.000542197585
             autocorr =       1.326661515304
   target nu stat err =       0.000542197585
   target dn stat err =       0.003149431545
      target stat err =       0.002636494198
              std dev =       0.665721390188
             le_variance =       0.443184969353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742576684706        initial
     3.9062e+03     3.9062e+04             1.7338e-07        -0.742576698157  <--
     1.5625e+04     1.5625e+05             4.3346e-08        -0.742576691476
     6.2500e+04     6.2500e+05             1.0837e-08        -0.742576685557

*****************************************************************************
Applying the update for shift_i =   3.9062e+03     and shift_s =   3.9062e+04
*****************************************************************************

  Execution time = 4.5928e+01
  </log>
  <optVariables href="FORM2.s019.opt.xml">
ci_001                -7.054741e-01 3 1  ON 0
ci_002                -7.030150e-01 3 1  ON 1
ci_003                -4.996663e-02 3 1  ON 2
ci_004                -5.098026e-02 3 1  ON 3
ci_005                 1.954934e-02 3 1  ON 4
ci_006                 1.991068e-02 3 1  ON 5
ci_007                 1.473779e-02 3 1  ON 6
ci_008                 1.564537e-02 3 1  ON 7
ci_009                -1.331719e-02 3 1  ON 8
ci_010                -1.213883e-02 3 1  ON 9
ci_011                -9.957254e-03 3 1  ON 10
ci_012                -9.108056e-03 3 1  ON 11
ci_013                 8.438456e-03 3 1  ON 12
ci_014                 9.447710e-03 3 1  ON 13
ci_015                 9.576424e-03 3 1  ON 14
ci_016                 9.512097e-03 3 1  ON 15
ci_017                 8.538760e-03 3 1  ON 16
ci_018                 8.365207e-03 3 1  ON 17
ci_019                -1.038956e-03 3 1  ON 18
ci_020                -1.339287e-03 3 1  ON 19
ci_021                -1.174178e-02 3 1  ON 20
ci_022                -1.169132e-02 3 1  ON 21
ci_023                 4.843316e-03 3 1  ON 22
ci_024                 4.944712e-03 3 1  ON 23
ci_025                 1.131950e-02 3 1  ON 24
ci_026                 1.141461e-02 3 1  ON 25
ci_027                 6.500221e-03 3 1  ON 26
ci_028                 6.245597e-03 3 1  ON 27
ci_029                -5.170567e-03 3 1  ON 28
ci_030                -4.217891e-03 3 1  ON 29
ci_031                 3.243704e-03 3 1  ON 30
ci_032                 4.392718e-03 3 1  ON 31
ci_033                 2.345044e-03 3 1  ON 32
ci_034                 4.175712e-03 3 1  ON 33
ci_035                 1.734553e-03 3 1  ON 34
ci_036                 2.193857e-03 3 1  ON 35
ci_037                 3.588355e-03 3 1  ON 36
ci_038                 3.703076e-03 3 1  ON 37
ci_039                 4.647807e-03 3 1  ON 38
ci_040                 4.988404e-03 3 1  ON 39
ci_041                 2.976556e-03 3 1  ON 40
ci_042                 2.735548e-03 3 1  ON 41
ci_043                 3.001542e-03 3 1  ON 42
ci_044                 3.198276e-03 3 1  ON 43
ci_045                 2.444551e-03 3 1  ON 44
ci_046                 2.684692e-03 3 1  ON 45
ci_047                -9.996247e-04 3 1  ON 46
ci_048                -8.373546e-04 3 1  ON 47
ci_049                 7.412615e-04 3 1  ON 48
ci_050                 1.074657e-03 3 1  ON 49
ci_051                -2.775521e-04 3 1  ON 50
ci_052                -1.208546e-03 3 1  ON 51
ci_053                -2.420444e-03 3 1  ON 52
ci_054                -2.639623e-03 3 1  ON 53
ci_055                -1.826628e-03 3 1  ON 54
ci_056                -1.960471e-03 3 1  ON 55
ci_057                -1.314985e-03 3 1  ON 56
ci_058                -9.789360e-04 3 1  ON 57
ci_059                -5.697373e-04 3 1  ON 58
ci_060                -7.766280e-04 3 1  ON 59
ci_061                -6.938700e-05 3 1  ON 60
ci_062                -9.472655e-04 3 1  ON 61
ci_063                -8.854470e-04 3 1  ON 62
ci_064                -5.147644e-04 3 1  ON 63
ci_065                -1.334297e-03 3 1  ON 64
ci_066                -1.933057e-03 3 1  ON 65
ci_067                -1.805493e-03 3 1  ON 66
ci_068                -1.576147e-03 3 1  ON 67
ci_069                -5.732323e-04 3 1  ON 68
ci_070                -4.405507e-04 3 1  ON 69
ci_071                -2.077763e-03 3 1  ON 70
ci_072                -1.995548e-03 3 1  ON 71
ci_073                 1.601427e-04 3 1  ON 72
ci_074                 2.018236e-04 3 1  ON 73
ci_075                 1.519628e-04 3 1  ON 74
ci_076                 8.318230e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2651e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.6864
    reference variance = 0.466998
====================================================
  Execution time = 2.6709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6064e-01
  Total weights = 1.955440269e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448830045215
                                         uncertainty =       0.003893777139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448830045215
                                         uncertainty =       0.003893777139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473686574
  error estimate for blocks of size 2^( 2) =       0.000497126549
  error estimate for blocks of size 2^( 3) =       0.000518732590
  error estimate for blocks of size 2^( 4) =       0.000534329754
  error estimate for blocks of size 2^( 5) =       0.000544885461
  error estimate for blocks of size 2^( 6) =       0.000550222044
  error estimate for blocks of size 2^( 7) =       0.000555757565

      target function =      -0.736665931952
              le_mean =     -22.662232620071
             les_mean =     514.037422806577
             stat err =       0.000546298706
             autocorr =       1.330081316108
   target nu stat err =       0.000546298706
   target dn stat err =       0.005690285020
      target stat err =       0.004609382349
              std dev =       0.669893977085
             le_variance =       0.448757940534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266223262007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736693477008       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736693506221       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736693510398       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736693510663       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736693510704       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736693510724       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736693510718       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736693510724       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736693510719       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736693510712       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736693510718       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+02 is 2.709403e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736693477008       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736693484312       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736693485356       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736693485422       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736693485433       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736693485447       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736693485439       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736693485446       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736693485436       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736693485432       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736693485439       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+03 is 6.773709e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736693477008       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736693478834       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736693479095       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736693479112       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736693479107       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736693479154       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736693479110       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736693479135       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736693479067       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736693479082       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736693479119       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5625e+04 is 1.693440e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1443e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_001                -7.054741e-01 3 1  ON 0
ci_002                -7.030150e-01 3 1  ON 1
ci_003                -4.996666e-02 3 1  ON 2
ci_004                -5.098026e-02 3 1  ON 3
ci_005                 1.954933e-02 3 1  ON 4
ci_006                 1.991064e-02 3 1  ON 5
ci_007                 1.473778e-02 3 1  ON 6
ci_008                 1.564535e-02 3 1  ON 7
ci_009                -1.331717e-02 3 1  ON 8
ci_010                -1.213883e-02 3 1  ON 9
ci_011                -9.957242e-03 3 1  ON 10
ci_012                -9.108016e-03 3 1  ON 11
ci_013                 8.438426e-03 3 1  ON 12
ci_014                 9.447679e-03 3 1  ON 13
ci_015                 9.576409e-03 3 1  ON 14
ci_016                 9.512064e-03 3 1  ON 15
ci_017                 8.538742e-03 3 1  ON 16
ci_018                 8.365203e-03 3 1  ON 17
ci_019                -1.039010e-03 3 1  ON 18
ci_020                -1.339355e-03 3 1  ON 19
ci_021                -1.174179e-02 3 1  ON 20
ci_022                -1.169129e-02 3 1  ON 21
ci_023                 4.843309e-03 3 1  ON 22
ci_024                 4.944721e-03 3 1  ON 23
ci_025                 1.131954e-02 3 1  ON 24
ci_026                 1.141465e-02 3 1  ON 25
ci_027                 6.500213e-03 3 1  ON 26
ci_028                 6.245590e-03 3 1  ON 27
ci_029                -5.170580e-03 3 1  ON 28
ci_030                -4.217889e-03 3 1  ON 29
ci_031                 3.243772e-03 3 1  ON 30
ci_032                 4.392709e-03 3 1  ON 31
ci_033                 2.345037e-03 3 1  ON 32
ci_034                 4.175692e-03 3 1  ON 33
ci_035                 1.734563e-03 3 1  ON 34
ci_036                 2.193850e-03 3 1  ON 35
ci_037                 3.588371e-03 3 1  ON 36
ci_038                 3.703063e-03 3 1  ON 37
ci_039                 4.647794e-03 3 1  ON 38
ci_040                 4.988406e-03 3 1  ON 39
ci_041                 2.976555e-03 3 1  ON 40
ci_042                 2.735553e-03 3 1  ON 41
ci_043                 3.001526e-03 3 1  ON 42
ci_044                 3.198239e-03 3 1  ON 43
ci_045                 2.444528e-03 3 1  ON 44
ci_046                 2.684706e-03 3 1  ON 45
ci_047                -9.996189e-04 3 1  ON 46
ci_048                -8.373485e-04 3 1  ON 47
ci_049                 7.412569e-04 3 1  ON 48
ci_050                 1.074630e-03 3 1  ON 49
ci_051                -2.775313e-04 3 1  ON 50
ci_052                -1.208538e-03 3 1  ON 51
ci_053                -2.420461e-03 3 1  ON 52
ci_054                -2.639605e-03 3 1  ON 53
ci_055                -1.826614e-03 3 1  ON 54
ci_056                -1.960451e-03 3 1  ON 55
ci_057                -1.314970e-03 3 1  ON 56
ci_058                -9.789310e-04 3 1  ON 57
ci_059                -5.697532e-04 3 1  ON 58
ci_060                -7.766235e-04 3 1  ON 59
ci_061                -6.937611e-05 3 1  ON 60
ci_062                -9.472545e-04 3 1  ON 61
ci_063                -8.854336e-04 3 1  ON 62
ci_064                -5.147617e-04 3 1  ON 63
ci_065                -1.334296e-03 3 1  ON 64
ci_066                -1.933060e-03 3 1  ON 65
ci_067                -1.805489e-03 3 1  ON 66
ci_068                -1.576148e-03 3 1  ON 67
ci_069                -5.732492e-04 3 1  ON 68
ci_070                -4.405253e-04 3 1  ON 69
ci_071                -2.077776e-03 3 1  ON 70
ci_072                -1.995549e-03 3 1  ON 71
ci_073                 1.601505e-04 3 1  ON 72
ci_074                 2.018088e-04 3 1  ON 73
ci_075                 1.519839e-04 3 1  ON 74
ci_076                 8.318160e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.72
    reference variance = 0.314311
====================================================
  Execution time = 2.5892e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5000e-01
  Total weights = 1.9553e+06
  Execution time = 3.6045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441962797285
                                         uncertainty =       0.001810866206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441962797285
                                         uncertainty =       0.001810866206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470081073
  error estimate for blocks of size 2^( 2) =       0.000494014631
  error estimate for blocks of size 2^( 3) =       0.000515419160
  error estimate for blocks of size 2^( 4) =       0.000531319750
  error estimate for blocks of size 2^( 5) =       0.000539528994
  error estimate for blocks of size 2^( 6) =       0.000545264919
  error estimate for blocks of size 2^( 7) =       0.000547470542

      target function =      -0.745331733508
              le_mean =     -22.662229451328
             les_mean =     514.026644870175
             stat err =       0.000540896051
             autocorr =       1.323982028276
   target nu stat err =       0.000540896051
   target dn stat err =       0.002300032246
      target stat err =       0.001983061444
              std dev =       0.664795029429
             le_variance =       0.441952431154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441962750199
                                         uncertainty =       0.001810862477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441962750199
                                         uncertainty =       0.001810862477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470081048
  error estimate for blocks of size 2^( 2) =       0.000494014612
  error estimate for blocks of size 2^( 3) =       0.000515419146
  error estimate for blocks of size 2^( 4) =       0.000531319739
  error estimate for blocks of size 2^( 5) =       0.000539528985
  error estimate for blocks of size 2^( 6) =       0.000545264905
  error estimate for blocks of size 2^( 7) =       0.000547470521

      target function =      -0.745331886317
              le_mean =     -22.662229451840
             les_mean =     514.026644707568
             stat err =       0.000540896037
             autocorr =       1.323982101902
   target nu stat err =       0.000540896037
   target dn stat err =       0.002300024456
      target stat err =       0.001983056108
              std dev =       0.664794993904
             le_variance =       0.441952383920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441962773740
                                         uncertainty =       0.001810864342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441962773740
                                         uncertainty =       0.001810864342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470081061
  error estimate for blocks of size 2^( 2) =       0.000494014621
  error estimate for blocks of size 2^( 3) =       0.000515419153
  error estimate for blocks of size 2^( 4) =       0.000531319744
  error estimate for blocks of size 2^( 5) =       0.000539528990
  error estimate for blocks of size 2^( 6) =       0.000545264912
  error estimate for blocks of size 2^( 7) =       0.000547470531

      target function =      -0.745331810125
              le_mean =     -22.662229451584
             les_mean =     514.026644788604
             stat err =       0.000540896044
             autocorr =       1.323982065095
   target nu stat err =       0.000540896044
   target dn stat err =       0.002300028341
      target stat err =       0.001983058770
              std dev =       0.664795011665
             le_variance =       0.441952407535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441962794342
                                         uncertainty =       0.001810865973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441962794342
                                         uncertainty =       0.001810865973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470081072
  error estimate for blocks of size 2^( 2) =       0.000494014629
  error estimate for blocks of size 2^( 3) =       0.000515419159
  error estimate for blocks of size 2^( 4) =       0.000531319749
  error estimate for blocks of size 2^( 5) =       0.000539528994
  error estimate for blocks of size 2^( 6) =       0.000545264918
  error estimate for blocks of size 2^( 7) =       0.000547470540

      target function =      -0.745331743108
              le_mean =     -22.662229451360
             les_mean =     514.026644859949
             stat err =       0.000540896050
             autocorr =       1.323982032877
   target nu stat err =       0.000540896050
   target dn stat err =       0.002300031757
      target stat err =       0.001983061109
              std dev =       0.664795027209
             le_variance =       0.441952428201


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745331733508        initial
     9.7656e+02     9.7656e+03             2.7094e-07        -0.745331886317  <--
     3.9062e+03     3.9062e+04             6.7737e-08        -0.745331810125
     1.5625e+04     1.5625e+05             1.6934e-08        -0.745331743108

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 4.4002e+01
  </log>
  <optVariables href="FORM2.s020.opt.xml">
ci_001                -7.054741e-01 3 1  ON 0
ci_002                -7.030150e-01 3 1  ON 1
ci_003                -4.996676e-02 3 1  ON 2
ci_004                -5.098026e-02 3 1  ON 3
ci_005                 1.954928e-02 3 1  ON 4
ci_006                 1.991054e-02 3 1  ON 5
ci_007                 1.473777e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331711e-02 3 1  ON 8
ci_010                -1.213884e-02 3 1  ON 9
ci_011                -9.957205e-03 3 1  ON 10
ci_012                -9.107894e-03 3 1  ON 11
ci_013                 8.438337e-03 3 1  ON 12
ci_014                 9.447583e-03 3 1  ON 13
ci_015                 9.576364e-03 3 1  ON 14
ci_016                 9.511965e-03 3 1  ON 15
ci_017                 8.538689e-03 3 1  ON 16
ci_018                 8.365189e-03 3 1  ON 17
ci_019                -1.039171e-03 3 1  ON 18
ci_020                -1.339558e-03 3 1  ON 19
ci_021                -1.174182e-02 3 1  ON 20
ci_022                -1.169118e-02 3 1  ON 21
ci_023                 4.843287e-03 3 1  ON 22
ci_024                 4.944750e-03 3 1  ON 23
ci_025                 1.131969e-02 3 1  ON 24
ci_026                 1.141476e-02 3 1  ON 25
ci_027                 6.500188e-03 3 1  ON 26
ci_028                 6.245567e-03 3 1  ON 27
ci_029                -5.170621e-03 3 1  ON 28
ci_030                -4.217881e-03 3 1  ON 29
ci_031                 3.243975e-03 3 1  ON 30
ci_032                 4.392685e-03 3 1  ON 31
ci_033                 2.345018e-03 3 1  ON 32
ci_034                 4.175632e-03 3 1  ON 33
ci_035                 1.734593e-03 3 1  ON 34
ci_036                 2.193828e-03 3 1  ON 35
ci_037                 3.588420e-03 3 1  ON 36
ci_038                 3.703022e-03 3 1  ON 37
ci_039                 4.647757e-03 3 1  ON 38
ci_040                 4.988413e-03 3 1  ON 39
ci_041                 2.976551e-03 3 1  ON 40
ci_042                 2.735567e-03 3 1  ON 41
ci_043                 3.001479e-03 3 1  ON 42
ci_044                 3.198127e-03 3 1  ON 43
ci_045                 2.444458e-03 3 1  ON 44
ci_046                 2.684749e-03 3 1  ON 45
ci_047                -9.996017e-04 3 1  ON 46
ci_048                -8.373302e-04 3 1  ON 47
ci_049                 7.412432e-04 3 1  ON 48
ci_050                 1.074549e-03 3 1  ON 49
ci_051                -2.774691e-04 3 1  ON 50
ci_052                -1.208514e-03 3 1  ON 51
ci_053                -2.420512e-03 3 1  ON 52
ci_054                -2.639552e-03 3 1  ON 53
ci_055                -1.826571e-03 3 1  ON 54
ci_056                -1.960391e-03 3 1  ON 55
ci_057                -1.314925e-03 3 1  ON 56
ci_058                -9.789158e-04 3 1  ON 57
ci_059                -5.698009e-04 3 1  ON 58
ci_060                -7.766101e-04 3 1  ON 59
ci_061                -6.934342e-05 3 1  ON 60
ci_062                -9.472217e-04 3 1  ON 61
ci_063                -8.853935e-04 3 1  ON 62
ci_064                -5.147534e-04 3 1  ON 63
ci_065                -1.334295e-03 3 1  ON 64
ci_066                -1.933070e-03 3 1  ON 65
ci_067                -1.805477e-03 3 1  ON 66
ci_068                -1.576154e-03 3 1  ON 67
ci_069                -5.732999e-04 3 1  ON 68
ci_070                -4.404492e-04 3 1  ON 69
ci_071                -2.077814e-03 3 1  ON 70
ci_072                -1.995551e-03 3 1  ON 71
ci_073                 1.601740e-04 3 1  ON 72
ci_074                 2.017641e-04 3 1  ON 73
ci_075                 1.520470e-04 3 1  ON 74
ci_076                 8.317951e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.67
    reference variance = 0.435724
====================================================
  Execution time = 2.6670e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5201e-01
  Total weights = 1.955129000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442645963089
                                         uncertainty =       0.002444978053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442645963089
                                         uncertainty =       0.002444978053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470417123
  error estimate for blocks of size 2^( 2) =       0.000494643149
  error estimate for blocks of size 2^( 3) =       0.000515914970
  error estimate for blocks of size 2^( 4) =       0.000530993167
  error estimate for blocks of size 2^( 5) =       0.000539120051
  error estimate for blocks of size 2^( 6) =       0.000543836714
  error estimate for blocks of size 2^( 7) =       0.000545915818

      target function =      -0.743683086283
              le_mean =     -22.662331582866
             les_mean =     514.033281851322
             stat err =       0.000539966437
             autocorr =       1.317550562019
   target nu stat err =       0.000539966437
   target dn stat err =       0.002705121705
      target stat err =       0.002293136207
              std dev =       0.665270274636
             le_variance =       0.442584538314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266233158287e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743689235889       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743689394082       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743689394820       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743689399993       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743689400479       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743689401628       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743689402320       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743689402719       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743689402573       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743689402559       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743689402611       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743689402658       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+02 is 1.011350e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743689235889       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743689275443       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743689275627       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743689276920       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743689277041       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743689277330       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743689277503       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743689277604       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743689277565       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743689277563       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743689277578       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743689277588       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+02 is 2.528428e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743689235889       residual = 4.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743689245778       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743689245824       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743689246147       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743689246173       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743689246251       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743689246288       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743689246320       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743689246311       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743689246303       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743689246316       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743689246307       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+03 is 6.321104e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108380 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1410e+01
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_001                -7.054739e-01 3 1  ON 0
ci_002                -7.030153e-01 3 1  ON 1
ci_003                -4.996683e-02 3 1  ON 2
ci_004                -5.098021e-02 3 1  ON 3
ci_005                 1.954910e-02 3 1  ON 4
ci_006                 1.991050e-02 3 1  ON 5
ci_007                 1.473775e-02 3 1  ON 6
ci_008                 1.564527e-02 3 1  ON 7
ci_009                -1.331702e-02 3 1  ON 8
ci_010                -1.213884e-02 3 1  ON 9
ci_011                -9.957078e-03 3 1  ON 10
ci_012                -9.107976e-03 3 1  ON 11
ci_013                 8.438198e-03 3 1  ON 12
ci_014                 9.447418e-03 3 1  ON 13
ci_015                 9.576363e-03 3 1  ON 14
ci_016                 9.511901e-03 3 1  ON 15
ci_017                 8.538654e-03 3 1  ON 16
ci_018                 8.365181e-03 3 1  ON 17
ci_019                -1.039396e-03 3 1  ON 18
ci_020                -1.339633e-03 3 1  ON 19
ci_021                -1.174189e-02 3 1  ON 20
ci_022                -1.169126e-02 3 1  ON 21
ci_023                 4.843182e-03 3 1  ON 22
ci_024                 4.944672e-03 3 1  ON 23
ci_025                 1.131976e-02 3 1  ON 24
ci_026                 1.141486e-02 3 1  ON 25
ci_027                 6.500108e-03 3 1  ON 26
ci_028                 6.245592e-03 3 1  ON 27
ci_029                -5.170715e-03 3 1  ON 28
ci_030                -4.217855e-03 3 1  ON 29
ci_031                 3.244208e-03 3 1  ON 30
ci_032                 4.392729e-03 3 1  ON 31
ci_033                 2.345050e-03 3 1  ON 32
ci_034                 4.175568e-03 3 1  ON 33
ci_035                 1.734582e-03 3 1  ON 34
ci_036                 2.193788e-03 3 1  ON 35
ci_037                 3.588377e-03 3 1  ON 36
ci_038                 3.703033e-03 3 1  ON 37
ci_039                 4.647676e-03 3 1  ON 38
ci_040                 4.988392e-03 3 1  ON 39
ci_041                 2.976441e-03 3 1  ON 40
ci_042                 2.735471e-03 3 1  ON 41
ci_043                 3.001418e-03 3 1  ON 42
ci_044                 3.198231e-03 3 1  ON 43
ci_045                 2.444401e-03 3 1  ON 44
ci_046                 2.684798e-03 3 1  ON 45
ci_047                -9.995713e-04 3 1  ON 46
ci_048                -8.372756e-04 3 1  ON 47
ci_049                 7.411795e-04 3 1  ON 48
ci_050                 1.074498e-03 3 1  ON 49
ci_051                -2.774628e-04 3 1  ON 50
ci_052                -1.208527e-03 3 1  ON 51
ci_053                -2.420581e-03 3 1  ON 52
ci_054                -2.639478e-03 3 1  ON 53
ci_055                -1.826440e-03 3 1  ON 54
ci_056                -1.960310e-03 3 1  ON 55
ci_057                -1.314862e-03 3 1  ON 56
ci_058                -9.789235e-04 3 1  ON 57
ci_059                -5.697198e-04 3 1  ON 58
ci_060                -7.766086e-04 3 1  ON 59
ci_061                -6.929000e-05 3 1  ON 60
ci_062                -9.472114e-04 3 1  ON 61
ci_063                -8.853690e-04 3 1  ON 62
ci_064                -5.148015e-04 3 1  ON 63
ci_065                -1.334235e-03 3 1  ON 64
ci_066                -1.933049e-03 3 1  ON 65
ci_067                -1.805434e-03 3 1  ON 66
ci_068                -1.576204e-03 3 1  ON 67
ci_069                -5.733566e-04 3 1  ON 68
ci_070                -4.404071e-04 3 1  ON 69
ci_071                -2.077862e-03 3 1  ON 70
ci_072                -1.995493e-03 3 1  ON 71
ci_073                 1.600264e-04 3 1  ON 72
ci_074                 2.017346e-04 3 1  ON 73
ci_075                 1.522057e-04 3 1  ON 74
ci_076                 8.318514e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.6286
    reference variance = 0.322067
====================================================
  Execution time = 2.5738e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4699e-01
  Total weights = 1.9553e+06
  Execution time = 3.6214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438990578466
                                         uncertainty =       0.002262906989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438990578466
                                         uncertainty =       0.002262906989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468547747
  error estimate for blocks of size 2^( 2) =       0.000492457786
  error estimate for blocks of size 2^( 3) =       0.000514613844
  error estimate for blocks of size 2^( 4) =       0.000531289764
  error estimate for blocks of size 2^( 5) =       0.000540917420
  error estimate for blocks of size 2^( 6) =       0.000545106398
  error estimate for blocks of size 2^( 7) =       0.000550705411

      target function =      -0.747824622590
              le_mean =     -22.662739949215
             les_mean =     514.046767495226
             stat err =       0.000542004748
             autocorr =       1.338130517741
   target nu stat err =       0.000542004748
   target dn stat err =       0.002428766444
      target stat err =       0.002099580626
              std dev =       0.662626577826
             le_variance =       0.439073981642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438990619976
                                         uncertainty =       0.002262934179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438990619976
                                         uncertainty =       0.002262934179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468547767
  error estimate for blocks of size 2^( 2) =       0.000492457827
  error estimate for blocks of size 2^( 3) =       0.000514613906
  error estimate for blocks of size 2^( 4) =       0.000531289843
  error estimate for blocks of size 2^( 5) =       0.000540917503
  error estimate for blocks of size 2^( 6) =       0.000545106469
  error estimate for blocks of size 2^( 7) =       0.000550705465

      target function =      -0.747824374926
              le_mean =     -22.662739945826
             les_mean =     514.046767640219
             stat err =       0.000542004820
             autocorr =       1.338130756269
   target nu stat err =       0.000542004820
   target dn stat err =       0.002428826752
      target stat err =       0.002099627176
              std dev =       0.662626606347
             le_variance =       0.439074019438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438990599197
                                         uncertainty =       0.002262920584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438990599197
                                         uncertainty =       0.002262920584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468547757
  error estimate for blocks of size 2^( 2) =       0.000492457806
  error estimate for blocks of size 2^( 3) =       0.000514613875
  error estimate for blocks of size 2^( 4) =       0.000531289803
  error estimate for blocks of size 2^( 5) =       0.000540917462
  error estimate for blocks of size 2^( 6) =       0.000545106434
  error estimate for blocks of size 2^( 7) =       0.000550705438

      target function =      -0.747824499983
              le_mean =     -22.662739947517
             les_mean =     514.046767566085
             stat err =       0.000542004784
             autocorr =       1.338130637035
   target nu stat err =       0.000542004784
   target dn stat err =       0.002428796592
      target stat err =       0.002099603903
              std dev =       0.662626592068
             le_variance =       0.439074000515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438990581055
                                         uncertainty =       0.002262908689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438990581055
                                         uncertainty =       0.002262908689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468547748
  error estimate for blocks of size 2^( 2) =       0.000492457788
  error estimate for blocks of size 2^( 3) =       0.000514613848
  error estimate for blocks of size 2^( 4) =       0.000531289769
  error estimate for blocks of size 2^( 5) =       0.000540917426
  error estimate for blocks of size 2^( 6) =       0.000545106402
  error estimate for blocks of size 2^( 7) =       0.000550705414

      target function =      -0.747824607401
              le_mean =     -22.662739949003
             les_mean =     514.046767503902
             stat err =       0.000542004753
             autocorr =       1.338130532649
   target nu stat err =       0.000542004753
   target dn stat err =       0.002428770212
      target stat err =       0.002099583535
              std dev =       0.662626579605
             le_variance =       0.439073983998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747824622590        initial  <--
     2.4414e+02     2.4414e+03             1.0113e-06        -0.747824374926
     9.7656e+02     9.7656e+03             2.5284e-07        -0.747824499983
     3.9062e+03     3.9062e+04             6.3211e-08        -0.747824607401

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9242
  </log>
  <optVariables href="FORM2.s021.opt.xml">
ci_001                -7.054741e-01 3 1  ON 0
ci_002                -7.030150e-01 3 1  ON 1
ci_003                -4.996676e-02 3 1  ON 2
ci_004                -5.098026e-02 3 1  ON 3
ci_005                 1.954928e-02 3 1  ON 4
ci_006                 1.991054e-02 3 1  ON 5
ci_007                 1.473777e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331711e-02 3 1  ON 8
ci_010                -1.213884e-02 3 1  ON 9
ci_011                -9.957205e-03 3 1  ON 10
ci_012                -9.107894e-03 3 1  ON 11
ci_013                 8.438337e-03 3 1  ON 12
ci_014                 9.447583e-03 3 1  ON 13
ci_015                 9.576364e-03 3 1  ON 14
ci_016                 9.511965e-03 3 1  ON 15
ci_017                 8.538689e-03 3 1  ON 16
ci_018                 8.365189e-03 3 1  ON 17
ci_019                -1.039171e-03 3 1  ON 18
ci_020                -1.339558e-03 3 1  ON 19
ci_021                -1.174182e-02 3 1  ON 20
ci_022                -1.169118e-02 3 1  ON 21
ci_023                 4.843287e-03 3 1  ON 22
ci_024                 4.944750e-03 3 1  ON 23
ci_025                 1.131969e-02 3 1  ON 24
ci_026                 1.141476e-02 3 1  ON 25
ci_027                 6.500188e-03 3 1  ON 26
ci_028                 6.245567e-03 3 1  ON 27
ci_029                -5.170621e-03 3 1  ON 28
ci_030                -4.217881e-03 3 1  ON 29
ci_031                 3.243975e-03 3 1  ON 30
ci_032                 4.392685e-03 3 1  ON 31
ci_033                 2.345018e-03 3 1  ON 32
ci_034                 4.175632e-03 3 1  ON 33
ci_035                 1.734593e-03 3 1  ON 34
ci_036                 2.193828e-03 3 1  ON 35
ci_037                 3.588420e-03 3 1  ON 36
ci_038                 3.703022e-03 3 1  ON 37
ci_039                 4.647757e-03 3 1  ON 38
ci_040                 4.988413e-03 3 1  ON 39
ci_041                 2.976551e-03 3 1  ON 40
ci_042                 2.735567e-03 3 1  ON 41
ci_043                 3.001479e-03 3 1  ON 42
ci_044                 3.198127e-03 3 1  ON 43
ci_045                 2.444458e-03 3 1  ON 44
ci_046                 2.684749e-03 3 1  ON 45
ci_047                -9.996017e-04 3 1  ON 46
ci_048                -8.373302e-04 3 1  ON 47
ci_049                 7.412432e-04 3 1  ON 48
ci_050                 1.074549e-03 3 1  ON 49
ci_051                -2.774691e-04 3 1  ON 50
ci_052                -1.208514e-03 3 1  ON 51
ci_053                -2.420512e-03 3 1  ON 52
ci_054                -2.639552e-03 3 1  ON 53
ci_055                -1.826571e-03 3 1  ON 54
ci_056                -1.960391e-03 3 1  ON 55
ci_057                -1.314925e-03 3 1  ON 56
ci_058                -9.789158e-04 3 1  ON 57
ci_059                -5.698009e-04 3 1  ON 58
ci_060                -7.766101e-04 3 1  ON 59
ci_061                -6.934342e-05 3 1  ON 60
ci_062                -9.472217e-04 3 1  ON 61
ci_063                -8.853935e-04 3 1  ON 62
ci_064                -5.147534e-04 3 1  ON 63
ci_065                -1.334295e-03 3 1  ON 64
ci_066                -1.933070e-03 3 1  ON 65
ci_067                -1.805477e-03 3 1  ON 66
ci_068                -1.576154e-03 3 1  ON 67
ci_069                -5.732999e-04 3 1  ON 68
ci_070                -4.404492e-04 3 1  ON 69
ci_071                -2.077814e-03 3 1  ON 70
ci_072                -1.995551e-03 3 1  ON 71
ci_073                 1.601740e-04 3 1  ON 72
ci_074                 2.017641e-04 3 1  ON 73
ci_075                 1.520470e-04 3 1  ON 74
ci_076                 8.317951e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6193
    reference variance = 0.412444
====================================================
  Execution time = 2.6901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5071e-01
  Total weights = 1.955198166e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442644973181
                                         uncertainty =       0.002078844975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442644973181
                                         uncertainty =       0.002078844975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470486359
  error estimate for blocks of size 2^( 2) =       0.000494295175
  error estimate for blocks of size 2^( 3) =       0.000515884011
  error estimate for blocks of size 2^( 4) =       0.000531129102
  error estimate for blocks of size 2^( 5) =       0.000539927695
  error estimate for blocks of size 2^( 6) =       0.000546359895
  error estimate for blocks of size 2^( 7) =       0.000548656631

      target function =      -0.744752063294
              le_mean =     -22.662827609750
             les_mean =     514.054464309305
             stat err =       0.000541518331
             autocorr =       1.324744886987
   target nu stat err =       0.000541518331
   target dn stat err =       0.002725027327
      target stat err =       0.002317444886
              std dev =       0.665368190363
             le_variance =       0.442714828747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266282760975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744758336516       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744758343496       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744758344932       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744758345132       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744758345195       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744758345307       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744758345307       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744758345323       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744758345317       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744758345312       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744758345309       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+03 is 9.632694e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744758336516       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744758338261       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744758338620       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744758338670       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744758338687       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744758338710       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744758338721       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744758338716       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744758338695       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744758338697       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744758338686       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+03 is 2.408184e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744758336516       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744758336952       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744758337042       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744758337055       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744758337035       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744758337137       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744758337113       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744758337006       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744758337106       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744758337059       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744758337111       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.9062e+04 is 6.020468e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1615e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_001                -7.054741e-01 3 1  ON 0
ci_002                -7.030150e-01 3 1  ON 1
ci_003                -4.996677e-02 3 1  ON 2
ci_004                -5.098024e-02 3 1  ON 3
ci_005                 1.954927e-02 3 1  ON 4
ci_006                 1.991053e-02 3 1  ON 5
ci_007                 1.473777e-02 3 1  ON 6
ci_008                 1.564527e-02 3 1  ON 7
ci_009                -1.331710e-02 3 1  ON 8
ci_010                -1.213882e-02 3 1  ON 9
ci_011                -9.957192e-03 3 1  ON 10
ci_012                -9.107899e-03 3 1  ON 11
ci_013                 8.438334e-03 3 1  ON 12
ci_014                 9.447573e-03 3 1  ON 13
ci_015                 9.576361e-03 3 1  ON 14
ci_016                 9.511955e-03 3 1  ON 15
ci_017                 8.538691e-03 3 1  ON 16
ci_018                 8.365199e-03 3 1  ON 17
ci_019                -1.039179e-03 3 1  ON 18
ci_020                -1.339569e-03 3 1  ON 19
ci_021                -1.174182e-02 3 1  ON 20
ci_022                -1.169118e-02 3 1  ON 21
ci_023                 4.843286e-03 3 1  ON 22
ci_024                 4.944747e-03 3 1  ON 23
ci_025                 1.131970e-02 3 1  ON 24
ci_026                 1.141477e-02 3 1  ON 25
ci_027                 6.500189e-03 3 1  ON 26
ci_028                 6.245567e-03 3 1  ON 27
ci_029                -5.170616e-03 3 1  ON 28
ci_030                -4.217872e-03 3 1  ON 29
ci_031                 3.243982e-03 3 1  ON 30
ci_032                 4.392700e-03 3 1  ON 31
ci_033                 2.345023e-03 3 1  ON 32
ci_034                 4.175633e-03 3 1  ON 33
ci_035                 1.734596e-03 3 1  ON 34
ci_036                 2.193818e-03 3 1  ON 35
ci_037                 3.588417e-03 3 1  ON 36
ci_038                 3.703021e-03 3 1  ON 37
ci_039                 4.647754e-03 3 1  ON 38
ci_040                 4.988410e-03 3 1  ON 39
ci_041                 2.976560e-03 3 1  ON 40
ci_042                 2.735568e-03 3 1  ON 41
ci_043                 3.001477e-03 3 1  ON 42
ci_044                 3.198132e-03 3 1  ON 43
ci_045                 2.444454e-03 3 1  ON 44
ci_046                 2.684748e-03 3 1  ON 45
ci_047                -9.995973e-04 3 1  ON 46
ci_048                -8.373319e-04 3 1  ON 47
ci_049                 7.412455e-04 3 1  ON 48
ci_050                 1.074542e-03 3 1  ON 49
ci_051                -2.774754e-04 3 1  ON 50
ci_052                -1.208515e-03 3 1  ON 51
ci_053                -2.420512e-03 3 1  ON 52
ci_054                -2.639548e-03 3 1  ON 53
ci_055                -1.826565e-03 3 1  ON 54
ci_056                -1.960387e-03 3 1  ON 55
ci_057                -1.314919e-03 3 1  ON 56
ci_058                -9.789187e-04 3 1  ON 57
ci_059                -5.697991e-04 3 1  ON 58
ci_060                -7.766086e-04 3 1  ON 59
ci_061                -6.933490e-05 3 1  ON 60
ci_062                -9.472142e-04 3 1  ON 61
ci_063                -8.853956e-04 3 1  ON 62
ci_064                -5.147632e-04 3 1  ON 63
ci_065                -1.334295e-03 3 1  ON 64
ci_066                -1.933074e-03 3 1  ON 65
ci_067                -1.805476e-03 3 1  ON 66
ci_068                -1.576165e-03 3 1  ON 67
ci_069                -5.733023e-04 3 1  ON 68
ci_070                -4.404394e-04 3 1  ON 69
ci_071                -2.077813e-03 3 1  ON 70
ci_072                -1.995547e-03 3 1  ON 71
ci_073                 1.601750e-04 3 1  ON 72
ci_074                 2.017628e-04 3 1  ON 73
ci_075                 1.520485e-04 3 1  ON 74
ci_076                 8.318019e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.6625
    reference variance = 0.367245
====================================================
  Execution time = 2.6030e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5389e-01
  Total weights = 1.9552e+06
  Execution time = 3.6109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445328685686
                                         uncertainty =       0.003856245590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445328685686
                                         uncertainty =       0.003856245590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471874038
  error estimate for blocks of size 2^( 2) =       0.000495452538
  error estimate for blocks of size 2^( 3) =       0.000517318077
  error estimate for blocks of size 2^( 4) =       0.000532854084
  error estimate for blocks of size 2^( 5) =       0.000542827990
  error estimate for blocks of size 2^( 6) =       0.000546880629
  error estimate for blocks of size 2^( 7) =       0.000548569118

      target function =      -0.742136933923
              le_mean =     -22.662479915796
             les_mean =     514.041890331842
             stat err =       0.000542782955
             autocorr =       1.323123050651
   target nu stat err =       0.000542782955
   target dn stat err =       0.003768946090
      target stat err =       0.003130943871
              std dev =       0.667330664112
             le_variance =       0.445330215264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445328674860
                                         uncertainty =       0.003856248888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445328674860
                                         uncertainty =       0.003856248888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471874032
  error estimate for blocks of size 2^( 2) =       0.000495452533
  error estimate for blocks of size 2^( 3) =       0.000517318073
  error estimate for blocks of size 2^( 4) =       0.000532854080
  error estimate for blocks of size 2^( 5) =       0.000542827987
  error estimate for blocks of size 2^( 6) =       0.000546880627
  error estimate for blocks of size 2^( 7) =       0.000548569117

      target function =      -0.742136951233
              le_mean =     -22.662479916389
             les_mean =     514.041890337482
             stat err =       0.000542782953
             autocorr =       1.323123070317
   target nu stat err =       0.000542782953
   target dn stat err =       0.003768947700
      target stat err =       0.003130945306
              std dev =       0.667330656078
             le_variance =       0.445330204541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445328680273
                                         uncertainty =       0.003856247239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445328680273
                                         uncertainty =       0.003856247239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471874035
  error estimate for blocks of size 2^( 2) =       0.000495452535
  error estimate for blocks of size 2^( 3) =       0.000517318075
  error estimate for blocks of size 2^( 4) =       0.000532854082
  error estimate for blocks of size 2^( 5) =       0.000542827988
  error estimate for blocks of size 2^( 6) =       0.000546880628
  error estimate for blocks of size 2^( 7) =       0.000548569117

      target function =      -0.742136942589
              le_mean =     -22.662479916093
             les_mean =     514.041890334647
             stat err =       0.000542782954
             autocorr =       1.323123060488
   target nu stat err =       0.000542782954
   target dn stat err =       0.003768946895
      target stat err =       0.003130944588
              std dev =       0.667330660095
             le_variance =       0.445330209902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445328685009
                                         uncertainty =       0.003856245796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445328685009
                                         uncertainty =       0.003856245796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471874038
  error estimate for blocks of size 2^( 2) =       0.000495452537
  error estimate for blocks of size 2^( 3) =       0.000517318077
  error estimate for blocks of size 2^( 4) =       0.000532854084
  error estimate for blocks of size 2^( 5) =       0.000542827990
  error estimate for blocks of size 2^( 6) =       0.000546880629
  error estimate for blocks of size 2^( 7) =       0.000548569118

      target function =      -0.742136935008
              le_mean =     -22.662479915833
             les_mean =     514.041890332191
             stat err =       0.000542782955
             autocorr =       1.323123051884
   target nu stat err =       0.000542782955
   target dn stat err =       0.003768946190
      target stat err =       0.003130943960
              std dev =       0.667330663609
             le_variance =       0.445330214593


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742136933923        initial
     2.4414e+03     2.4414e+04             9.6327e-08        -0.742136951233  <--
     9.7656e+03     9.7656e+04             2.4082e-08        -0.742136942589
     3.9062e+04     3.9062e+05             6.0205e-09        -0.742136935008

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 4.4163e+01
  </log>
  <optVariables href="FORM2.s022.opt.xml">
ci_001                -7.054741e-01 3 1  ON 0
ci_002                -7.030150e-01 3 1  ON 1
ci_003                -4.996681e-02 3 1  ON 2
ci_004                -5.098017e-02 3 1  ON 3
ci_005                 1.954926e-02 3 1  ON 4
ci_006                 1.991051e-02 3 1  ON 5
ci_007                 1.473779e-02 3 1  ON 6
ci_008                 1.564525e-02 3 1  ON 7
ci_009                -1.331709e-02 3 1  ON 8
ci_010                -1.213879e-02 3 1  ON 9
ci_011                -9.957153e-03 3 1  ON 10
ci_012                -9.107914e-03 3 1  ON 11
ci_013                 8.438327e-03 3 1  ON 12
ci_014                 9.447543e-03 3 1  ON 13
ci_015                 9.576351e-03 3 1  ON 14
ci_016                 9.511923e-03 3 1  ON 15
ci_017                 8.538695e-03 3 1  ON 16
ci_018                 8.365228e-03 3 1  ON 17
ci_019                -1.039205e-03 3 1  ON 18
ci_020                -1.339603e-03 3 1  ON 19
ci_021                -1.174182e-02 3 1  ON 20
ci_022                -1.169121e-02 3 1  ON 21
ci_023                 4.843285e-03 3 1  ON 22
ci_024                 4.944739e-03 3 1  ON 23
ci_025                 1.131975e-02 3 1  ON 24
ci_026                 1.141481e-02 3 1  ON 25
ci_027                 6.500195e-03 3 1  ON 26
ci_028                 6.245566e-03 3 1  ON 27
ci_029                -5.170602e-03 3 1  ON 28
ci_030                -4.217846e-03 3 1  ON 29
ci_031                 3.244003e-03 3 1  ON 30
ci_032                 4.392747e-03 3 1  ON 31
ci_033                 2.345035e-03 3 1  ON 32
ci_034                 4.175635e-03 3 1  ON 33
ci_035                 1.734608e-03 3 1  ON 34
ci_036                 2.193786e-03 3 1  ON 35
ci_037                 3.588406e-03 3 1  ON 36
ci_038                 3.703018e-03 3 1  ON 37
ci_039                 4.647742e-03 3 1  ON 38
ci_040                 4.988403e-03 3 1  ON 39
ci_041                 2.976587e-03 3 1  ON 40
ci_042                 2.735572e-03 3 1  ON 41
ci_043                 3.001473e-03 3 1  ON 42
ci_044                 3.198147e-03 3 1  ON 43
ci_045                 2.444442e-03 3 1  ON 44
ci_046                 2.684745e-03 3 1  ON 45
ci_047                -9.995839e-04 3 1  ON 46
ci_048                -8.373370e-04 3 1  ON 47
ci_049                 7.412522e-04 3 1  ON 48
ci_050                 1.074519e-03 3 1  ON 49
ci_051                -2.774942e-04 3 1  ON 50
ci_052                -1.208516e-03 3 1  ON 51
ci_053                -2.420513e-03 3 1  ON 52
ci_054                -2.639534e-03 3 1  ON 53
ci_055                -1.826545e-03 3 1  ON 54
ci_056                -1.960374e-03 3 1  ON 55
ci_057                -1.314901e-03 3 1  ON 56
ci_058                -9.789275e-04 3 1  ON 57
ci_059                -5.697940e-04 3 1  ON 58
ci_060                -7.766040e-04 3 1  ON 59
ci_061                -6.930934e-05 3 1  ON 60
ci_062                -9.471917e-04 3 1  ON 61
ci_063                -8.854019e-04 3 1  ON 62
ci_064                -5.147929e-04 3 1  ON 63
ci_065                -1.334298e-03 3 1  ON 64
ci_066                -1.933086e-03 3 1  ON 65
ci_067                -1.805472e-03 3 1  ON 66
ci_068                -1.576198e-03 3 1  ON 67
ci_069                -5.733094e-04 3 1  ON 68
ci_070                -4.404099e-04 3 1  ON 69
ci_071                -2.077810e-03 3 1  ON 70
ci_072                -1.995535e-03 3 1  ON 71
ci_073                 1.601778e-04 3 1  ON 72
ci_074                 2.017589e-04 3 1  ON 73
ci_075                 1.520531e-04 3 1  ON 74
ci_076                 8.318223e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2653e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.6979
    reference variance = 0.367708
====================================================
  Execution time = 2.6568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5343e-01
  Total weights = 1.955277636e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442087220727
                                         uncertainty =       0.002197587522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442087220727
                                         uncertainty =       0.002197587522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470155442
  error estimate for blocks of size 2^( 2) =       0.000493961958
  error estimate for blocks of size 2^( 3) =       0.000516389694
  error estimate for blocks of size 2^( 4) =       0.000531539709
  error estimate for blocks of size 2^( 5) =       0.000540573175
  error estimate for blocks of size 2^( 6) =       0.000545638647
  error estimate for blocks of size 2^( 7) =       0.000549616885

      target function =      -0.742517584040
              le_mean =     -22.661731580784
             les_mean =     514.007503548941
             stat err =       0.000541842104
             autocorr =       1.328197206755
   target nu stat err =       0.000541842104
   target dn stat err =       0.003667432096
      target stat err =       0.003049200660
              std dev =       0.664900203051
             le_variance =       0.442092280017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266173158078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742529128275       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742529180197       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742529191108       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742529192655       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742529192850       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742529193289       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742529193588       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742529193563       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742529193585       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742529193571       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742529193586       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+02 is 3.715113e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742529128275       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742529141256       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742529143984       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742529144371       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742529144419       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742529144529       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742529144604       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742529144598       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742529144603       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742529144597       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742529144604       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+03 is 9.287816e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742529128275       residual = 3.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742529131520       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742529132202       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742529132299       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742529132311       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742529132338       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742529132357       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742529132356       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742529132357       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742529132356       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742529132357       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.7656e+03 is 2.321956e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1287e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_001                -7.054740e-01 3 1  ON 0
ci_002                -7.030151e-01 3 1  ON 1
ci_003                -4.996676e-02 3 1  ON 2
ci_004                -5.098014e-02 3 1  ON 3
ci_005                 1.954925e-02 3 1  ON 4
ci_006                 1.991047e-02 3 1  ON 5
ci_007                 1.473778e-02 3 1  ON 6
ci_008                 1.564526e-02 3 1  ON 7
ci_009                -1.331706e-02 3 1  ON 8
ci_010                -1.213877e-02 3 1  ON 9
ci_011                -9.957062e-03 3 1  ON 10
ci_012                -9.107905e-03 3 1  ON 11
ci_013                 8.438271e-03 3 1  ON 12
ci_014                 9.447491e-03 3 1  ON 13
ci_015                 9.576288e-03 3 1  ON 14
ci_016                 9.511877e-03 3 1  ON 15
ci_017                 8.538623e-03 3 1  ON 16
ci_018                 8.365228e-03 3 1  ON 17
ci_019                -1.039270e-03 3 1  ON 18
ci_020                -1.339659e-03 3 1  ON 19
ci_021                -1.174188e-02 3 1  ON 20
ci_022                -1.169121e-02 3 1  ON 21
ci_023                 4.843292e-03 3 1  ON 22
ci_024                 4.944729e-03 3 1  ON 23
ci_025                 1.131982e-02 3 1  ON 24
ci_026                 1.141489e-02 3 1  ON 25
ci_027                 6.500164e-03 3 1  ON 26
ci_028                 6.245542e-03 3 1  ON 27
ci_029                -5.170562e-03 3 1  ON 28
ci_030                -4.217845e-03 3 1  ON 29
ci_031                 3.244031e-03 3 1  ON 30
ci_032                 4.392774e-03 3 1  ON 31
ci_033                 2.345009e-03 3 1  ON 32
ci_034                 4.175602e-03 3 1  ON 33
ci_035                 1.734637e-03 3 1  ON 34
ci_036                 2.193783e-03 3 1  ON 35
ci_037                 3.588371e-03 3 1  ON 36
ci_038                 3.703004e-03 3 1  ON 37
ci_039                 4.647738e-03 3 1  ON 38
ci_040                 4.988378e-03 3 1  ON 39
ci_041                 2.976533e-03 3 1  ON 40
ci_042                 2.735562e-03 3 1  ON 41
ci_043                 3.001484e-03 3 1  ON 42
ci_044                 3.198112e-03 3 1  ON 43
ci_045                 2.444426e-03 3 1  ON 44
ci_046                 2.684756e-03 3 1  ON 45
ci_047                -9.995708e-04 3 1  ON 46
ci_048                -8.373528e-04 3 1  ON 47
ci_049                 7.412600e-04 3 1  ON 48
ci_050                 1.074512e-03 3 1  ON 49
ci_051                -2.775152e-04 3 1  ON 50
ci_052                -1.208510e-03 3 1  ON 51
ci_053                -2.420516e-03 3 1  ON 52
ci_054                -2.639553e-03 3 1  ON 53
ci_055                -1.826518e-03 3 1  ON 54
ci_056                -1.960367e-03 3 1  ON 55
ci_057                -1.314828e-03 3 1  ON 56
ci_058                -9.789301e-04 3 1  ON 57
ci_059                -5.697663e-04 3 1  ON 58
ci_060                -7.765858e-04 3 1  ON 59
ci_061                -6.927172e-05 3 1  ON 60
ci_062                -9.472018e-04 3 1  ON 61
ci_063                -8.854041e-04 3 1  ON 62
ci_064                -5.147811e-04 3 1  ON 63
ci_065                -1.334321e-03 3 1  ON 64
ci_066                -1.933071e-03 3 1  ON 65
ci_067                -1.805471e-03 3 1  ON 66
ci_068                -1.576155e-03 3 1  ON 67
ci_069                -5.732853e-04 3 1  ON 68
ci_070                -4.403948e-04 3 1  ON 69
ci_071                -2.077789e-03 3 1  ON 70
ci_072                -1.995509e-03 3 1  ON 71
ci_073                 1.601945e-04 3 1  ON 72
ci_074                 2.017657e-04 3 1  ON 73
ci_075                 1.520253e-04 3 1  ON 74
ci_076                 8.317973e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.7524
    reference variance = 0.424689
====================================================
  Execution time = 2.7587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5476e-01
  Total weights = 1.9549e+06
  Execution time = 3.6210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444499702766
                                         uncertainty =       0.002864901638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444499702766
                                         uncertainty =       0.002864901638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471403686
  error estimate for blocks of size 2^( 2) =       0.000495477368
  error estimate for blocks of size 2^( 3) =       0.000516946278
  error estimate for blocks of size 2^( 4) =       0.000532722666
  error estimate for blocks of size 2^( 5) =       0.000541325554
  error estimate for blocks of size 2^( 6) =       0.000545623845
  error estimate for blocks of size 2^( 7) =       0.000547583521

      target function =      -0.741434661517
              le_mean =     -22.663238640759
             les_mean =     514.077143546827
             stat err =       0.000541813896
             autocorr =       1.321035023714
   target nu stat err =       0.000541813896
   target dn stat err =       0.003686618723
      target stat err =       0.003062604820
              std dev =       0.666665485541
             le_variance =       0.444442869611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444499644553
                                         uncertainty =       0.002864926979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444499644553
                                         uncertainty =       0.002864926979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471403655
  error estimate for blocks of size 2^( 2) =       0.000495477345
  error estimate for blocks of size 2^( 3) =       0.000516946257
  error estimate for blocks of size 2^( 4) =       0.000532722649
  error estimate for blocks of size 2^( 5) =       0.000541325532
  error estimate for blocks of size 2^( 6) =       0.000545623815
  error estimate for blocks of size 2^( 7) =       0.000547583485

      target function =      -0.741435695199
              le_mean =     -22.663238639972
             les_mean =     514.077142242439
             stat err =       0.000541813870
             autocorr =       1.321035069556
   target nu stat err =       0.000541813870
   target dn stat err =       0.003686635023
      target stat err =       0.003062626219
              std dev =       0.666665441993
             le_variance =       0.444442811548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444499673654
                                         uncertainty =       0.002864914309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444499673654
                                         uncertainty =       0.002864914309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471403670
  error estimate for blocks of size 2^( 2) =       0.000495477356
  error estimate for blocks of size 2^( 3) =       0.000516946267
  error estimate for blocks of size 2^( 4) =       0.000532722657
  error estimate for blocks of size 2^( 5) =       0.000541325543
  error estimate for blocks of size 2^( 6) =       0.000545623830
  error estimate for blocks of size 2^( 7) =       0.000547583503

      target function =      -0.741435185848
              le_mean =     -22.663238640365
             les_mean =     514.077142885409
             stat err =       0.000541813883
             autocorr =       1.321035046639
   target nu stat err =       0.000541813883
   target dn stat err =       0.003686626814
      target stat err =       0.003062615533
              std dev =       0.666665463763
             le_variance =       0.444442840574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444499699126
                                         uncertainty =       0.002864903222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444499699126
                                         uncertainty =       0.002864903222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471403684
  error estimate for blocks of size 2^( 2) =       0.000495477367
  error estimate for blocks of size 2^( 3) =       0.000516946276
  error estimate for blocks of size 2^( 4) =       0.000532722665
  error estimate for blocks of size 2^( 5) =       0.000541325553
  error estimate for blocks of size 2^( 6) =       0.000545623843
  error estimate for blocks of size 2^( 7) =       0.000547583519

      target function =      -0.741434727904
              le_mean =     -22.663238640710
             les_mean =     514.077143463108
             stat err =       0.000541813895
             autocorr =       1.321035026589
   target nu stat err =       0.000541813895
   target dn stat err =       0.003686619727
      target stat err =       0.003062606161
              std dev =       0.666665482818
             le_variance =       0.444442865981


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741434661517        initial
     6.1035e+02     6.1035e+03             3.7151e-07        -0.741435695199  <--
     2.4414e+03     2.4414e+04             9.2878e-08        -0.741435185848
     9.7656e+03     9.7656e+04             2.3220e-08        -0.741434727904

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 4.5758e+01
  </log>
  <optVariables href="FORM2.s023.opt.xml">
ci_001                -7.054738e-01 3 1  ON 0
ci_002                -7.030154e-01 3 1  ON 1
ci_003                -4.996662e-02 3 1  ON 2
ci_004                -5.098005e-02 3 1  ON 3
ci_005                 1.954923e-02 3 1  ON 4
ci_006                 1.991036e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564530e-02 3 1  ON 7
ci_009                -1.331699e-02 3 1  ON 8
ci_010                -1.213871e-02 3 1  ON 9
ci_011                -9.956789e-03 3 1  ON 10
ci_012                -9.107881e-03 3 1  ON 11
ci_013                 8.438102e-03 3 1  ON 12
ci_014                 9.447335e-03 3 1  ON 13
ci_015                 9.576098e-03 3 1  ON 14
ci_016                 9.511736e-03 3 1  ON 15
ci_017                 8.538408e-03 3 1  ON 16
ci_018                 8.365231e-03 3 1  ON 17
ci_019                -1.039463e-03 3 1  ON 18
ci_020                -1.339827e-03 3 1  ON 19
ci_021                -1.174205e-02 3 1  ON 20
ci_022                -1.169123e-02 3 1  ON 21
ci_023                 4.843314e-03 3 1  ON 22
ci_024                 4.944700e-03 3 1  ON 23
ci_025                 1.132002e-02 3 1  ON 24
ci_026                 1.141515e-02 3 1  ON 25
ci_027                 6.500074e-03 3 1  ON 26
ci_028                 6.245471e-03 3 1  ON 27
ci_029                -5.170442e-03 3 1  ON 28
ci_030                -4.217843e-03 3 1  ON 29
ci_031                 3.244117e-03 3 1  ON 30
ci_032                 4.392855e-03 3 1  ON 31
ci_033                 2.344929e-03 3 1  ON 32
ci_034                 4.175502e-03 3 1  ON 33
ci_035                 1.734726e-03 3 1  ON 34
ci_036                 2.193775e-03 3 1  ON 35
ci_037                 3.588267e-03 3 1  ON 36
ci_038                 3.702961e-03 3 1  ON 37
ci_039                 4.647726e-03 3 1  ON 38
ci_040                 4.988303e-03 3 1  ON 39
ci_041                 2.976369e-03 3 1  ON 40
ci_042                 2.735534e-03 3 1  ON 41
ci_043                 3.001516e-03 3 1  ON 42
ci_044                 3.198005e-03 3 1  ON 43
ci_045                 2.444378e-03 3 1  ON 44
ci_046                 2.684788e-03 3 1  ON 45
ci_047                -9.995313e-04 3 1  ON 46
ci_048                -8.374002e-04 3 1  ON 47
ci_049                 7.412837e-04 3 1  ON 48
ci_050                 1.074489e-03 3 1  ON 49
ci_051                -2.775781e-04 3 1  ON 50
ci_052                -1.208489e-03 3 1  ON 51
ci_053                -2.420523e-03 3 1  ON 52
ci_054                -2.639610e-03 3 1  ON 53
ci_055                -1.826439e-03 3 1  ON 54
ci_056                -1.960344e-03 3 1  ON 55
ci_057                -1.314609e-03 3 1  ON 56
ci_058                -9.789381e-04 3 1  ON 57
ci_059                -5.696833e-04 3 1  ON 58
ci_060                -7.765312e-04 3 1  ON 59
ci_061                -6.915890e-05 3 1  ON 60
ci_062                -9.472321e-04 3 1  ON 61
ci_063                -8.854108e-04 3 1  ON 62
ci_064                -5.147456e-04 3 1  ON 63
ci_065                -1.334392e-03 3 1  ON 64
ci_066                -1.933025e-03 3 1  ON 65
ci_067                -1.805468e-03 3 1  ON 66
ci_068                -1.576023e-03 3 1  ON 67
ci_069                -5.732130e-04 3 1  ON 68
ci_070                -4.403496e-04 3 1  ON 69
ci_071                -2.077725e-03 3 1  ON 70
ci_072                -1.995433e-03 3 1  ON 71
ci_073                 1.602445e-04 3 1  ON 72
ci_074                 2.017862e-04 3 1  ON 73
ci_075                 1.519418e-04 3 1  ON 74
ci_076                 8.317226e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7052e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7246
    reference variance = 0.315637
====================================================
  Execution time = 2.6839e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4921e-01
  Total weights = 1.955245611e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592871009
                                         uncertainty =       0.002182300178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439592871009
                                         uncertainty =       0.002182300178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468839921
  error estimate for blocks of size 2^( 2) =       0.000492313893
  error estimate for blocks of size 2^( 3) =       0.000514192127
  error estimate for blocks of size 2^( 4) =       0.000529887537
  error estimate for blocks of size 2^( 5) =       0.000539335812
  error estimate for blocks of size 2^( 6) =       0.000544711211
  error estimate for blocks of size 2^( 7) =       0.000549404565

      target function =      -0.745978155377
              le_mean =     -22.661579806617
             les_mean =     513.996406564620
             stat err =       0.000540834781
             autocorr =       1.330699699289
   target nu stat err =       0.000540834781
   target dn stat err =       0.002494308824
      target stat err =       0.002137429764
              std dev =       0.663039774871
             le_variance =       0.439621743061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266157980662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745983298641       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745983398497       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745983423907       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745983425724       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745983425880       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745983426120       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745983426088       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745983426029       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745983426201       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745983426205       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745983426183       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+02 is 1.048266e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745983298641       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745983323610       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745983329964       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745983330418       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745983330457       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745983330517       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745983330509       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745983330494       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745983330537       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745983330538       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745983330533       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+02 is 2.621166e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745983298641       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745983304883       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745983306472       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745983306585       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745983306595       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745983306610       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745983306608       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745983306605       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745983306615       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745983306616       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745983306614       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+03 is 6.553229e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1538e+01
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_001                -7.054736e-01 3 1  ON 0
ci_002                -7.030155e-01 3 1  ON 1
ci_003                -4.996674e-02 3 1  ON 2
ci_004                -5.097999e-02 3 1  ON 3
ci_005                 1.954913e-02 3 1  ON 4
ci_006                 1.991025e-02 3 1  ON 5
ci_007                 1.473781e-02 3 1  ON 6
ci_008                 1.564520e-02 3 1  ON 7
ci_009                -1.331676e-02 3 1  ON 8
ci_010                -1.213858e-02 3 1  ON 9
ci_011                -9.956542e-03 3 1  ON 10
ci_012                -9.107972e-03 3 1  ON 11
ci_013                 8.438003e-03 3 1  ON 12
ci_014                 9.447189e-03 3 1  ON 13
ci_015                 9.576011e-03 3 1  ON 14
ci_016                 9.511586e-03 3 1  ON 15
ci_017                 8.538432e-03 3 1  ON 16
ci_018                 8.365291e-03 3 1  ON 17
ci_019                -1.039654e-03 3 1  ON 18
ci_020                -1.340089e-03 3 1  ON 19
ci_021                -1.174224e-02 3 1  ON 20
ci_022                -1.169143e-02 3 1  ON 21
ci_023                 4.843370e-03 3 1  ON 22
ci_024                 4.944543e-03 3 1  ON 23
ci_025                 1.132006e-02 3 1  ON 24
ci_026                 1.141526e-02 3 1  ON 25
ci_027                 6.499995e-03 3 1  ON 26
ci_028                 6.245458e-03 3 1  ON 27
ci_029                -5.170273e-03 3 1  ON 28
ci_030                -4.217709e-03 3 1  ON 29
ci_031                 3.244347e-03 3 1  ON 30
ci_032                 4.392925e-03 3 1  ON 31
ci_033                 2.345017e-03 3 1  ON 32
ci_034                 4.175372e-03 3 1  ON 33
ci_035                 1.734666e-03 3 1  ON 34
ci_036                 2.193770e-03 3 1  ON 35
ci_037                 3.588289e-03 3 1  ON 36
ci_038                 3.702940e-03 3 1  ON 37
ci_039                 4.647704e-03 3 1  ON 38
ci_040                 4.988213e-03 3 1  ON 39
ci_041                 2.976358e-03 3 1  ON 40
ci_042                 2.735550e-03 3 1  ON 41
ci_043                 3.001512e-03 3 1  ON 42
ci_044                 3.197959e-03 3 1  ON 43
ci_045                 2.444322e-03 3 1  ON 44
ci_046                 2.684736e-03 3 1  ON 45
ci_047                -9.994550e-04 3 1  ON 46
ci_048                -8.373581e-04 3 1  ON 47
ci_049                 7.412124e-04 3 1  ON 48
ci_050                 1.074494e-03 3 1  ON 49
ci_051                -2.775895e-04 3 1  ON 50
ci_052                -1.208552e-03 3 1  ON 51
ci_053                -2.420474e-03 3 1  ON 52
ci_054                -2.639527e-03 3 1  ON 53
ci_055                -1.826344e-03 3 1  ON 54
ci_056                -1.960263e-03 3 1  ON 55
ci_057                -1.314594e-03 3 1  ON 56
ci_058                -9.789014e-04 3 1  ON 57
ci_059                -5.695930e-04 3 1  ON 58
ci_060                -7.765220e-04 3 1  ON 59
ci_061                -6.918526e-05 3 1  ON 60
ci_062                -9.471259e-04 3 1  ON 61
ci_063                -8.855083e-04 3 1  ON 62
ci_064                -5.147979e-04 3 1  ON 63
ci_065                -1.334394e-03 3 1  ON 64
ci_066                -1.933052e-03 3 1  ON 65
ci_067                -1.805461e-03 3 1  ON 66
ci_068                -1.576082e-03 3 1  ON 67
ci_069                -5.732490e-04 3 1  ON 68
ci_070                -4.403315e-04 3 1  ON 69
ci_071                -2.077688e-03 3 1  ON 70
ci_072                -1.995427e-03 3 1  ON 71
ci_073                 1.602595e-04 3 1  ON 72
ci_074                 2.017588e-04 3 1  ON 73
ci_075                 1.519737e-04 3 1  ON 74
ci_076                 8.316953e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7651
    reference variance = 0.409398
====================================================
  Execution time = 2.6206e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5428e-01
  Total weights = 1.9549e+06
  Execution time = 3.6105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187970911
                                         uncertainty =       0.002136736826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187970911
                                         uncertainty =       0.002136736826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469143914
  error estimate for blocks of size 2^( 2) =       0.000493172017
  error estimate for blocks of size 2^( 3) =       0.000515815064
  error estimate for blocks of size 2^( 4) =       0.000530914161
  error estimate for blocks of size 2^( 5) =       0.000540650834
  error estimate for blocks of size 2^( 6) =       0.000545103315
  error estimate for blocks of size 2^( 7) =       0.000548518458

      target function =      -0.741824046106
              le_mean =     -22.662693558285
             les_mean =     514.051956920050
             stat err =       0.000541296692
             autocorr =       1.331246785353
   target nu stat err =       0.000541296692
   target dn stat err =       0.003914902362
      target stat err =       0.003245911399
              std dev =       0.663469686222
             le_variance =       0.440192024536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187564341
                                         uncertainty =       0.002136709777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187564341
                                         uncertainty =       0.002136709777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469143698
  error estimate for blocks of size 2^( 2) =       0.000493171825
  error estimate for blocks of size 2^( 3) =       0.000515814896
  error estimate for blocks of size 2^( 4) =       0.000530914006
  error estimate for blocks of size 2^( 5) =       0.000540650675
  error estimate for blocks of size 2^( 6) =       0.000545103189
  error estimate for blocks of size 2^( 7) =       0.000548518321

      target function =      -0.741820971420
              le_mean =     -22.662693542060
             les_mean =     514.051959955012
             stat err =       0.000541296548
             autocorr =       1.331247305430
   target nu stat err =       0.000541296548
   target dn stat err =       0.003915131445
      target stat err =       0.003246068402
              std dev =       0.663469379777
             le_variance =       0.440191617902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187767557
                                         uncertainty =       0.002136723298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187767557
                                         uncertainty =       0.002136723298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469143806
  error estimate for blocks of size 2^( 2) =       0.000493171921
  error estimate for blocks of size 2^( 3) =       0.000515814980
  error estimate for blocks of size 2^( 4) =       0.000530914083
  error estimate for blocks of size 2^( 5) =       0.000540650755
  error estimate for blocks of size 2^( 6) =       0.000545103252
  error estimate for blocks of size 2^( 7) =       0.000548518390

      target function =      -0.741822800328
              le_mean =     -22.662693550158
             les_mean =     514.051958079147
             stat err =       0.000541296620
             autocorr =       1.331247045309
   target nu stat err =       0.000541296620
   target dn stat err =       0.003915016384
      target stat err =       0.003245991993
              std dev =       0.663469532948
             le_variance =       0.440191821150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187945487
                                         uncertainty =       0.002136735135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440187945487
                                         uncertainty =       0.002136735135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469143901
  error estimate for blocks of size 2^( 2) =       0.000493172005
  error estimate for blocks of size 2^( 3) =       0.000515815053
  error estimate for blocks of size 2^( 4) =       0.000530914151
  error estimate for blocks of size 2^( 5) =       0.000540650824
  error estimate for blocks of size 2^( 6) =       0.000545103307
  error estimate for blocks of size 2^( 7) =       0.000548518450

      target function =      -0.741823911592
              le_mean =     -22.662693557268
             les_mean =     514.051957038861
             stat err =       0.000541296683
             autocorr =       1.331246817829
   target nu stat err =       0.000541296683
   target dn stat err =       0.003914916573
      target stat err =       0.003245921622
              std dev =       0.663469667060
             le_variance =       0.440191999108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741824046106        initial  <--
     1.5259e+02     1.5259e+03             1.0483e-06        -0.741820971420
     6.1035e+02     6.1035e+03             2.6212e-07        -0.741822800328
     2.4414e+03     2.4414e+04             6.5532e-08        -0.741823911592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.4671
  </log>
  <optVariables href="FORM2.s024.opt.xml">
ci_001                -7.054738e-01 3 1  ON 0
ci_002                -7.030154e-01 3 1  ON 1
ci_003                -4.996662e-02 3 1  ON 2
ci_004                -5.098005e-02 3 1  ON 3
ci_005                 1.954923e-02 3 1  ON 4
ci_006                 1.991036e-02 3 1  ON 5
ci_007                 1.473776e-02 3 1  ON 6
ci_008                 1.564530e-02 3 1  ON 7
ci_009                -1.331699e-02 3 1  ON 8
ci_010                -1.213871e-02 3 1  ON 9
ci_011                -9.956789e-03 3 1  ON 10
ci_012                -9.107881e-03 3 1  ON 11
ci_013                 8.438102e-03 3 1  ON 12
ci_014                 9.447335e-03 3 1  ON 13
ci_015                 9.576098e-03 3 1  ON 14
ci_016                 9.511736e-03 3 1  ON 15
ci_017                 8.538408e-03 3 1  ON 16
ci_018                 8.365231e-03 3 1  ON 17
ci_019                -1.039463e-03 3 1  ON 18
ci_020                -1.339827e-03 3 1  ON 19
ci_021                -1.174205e-02 3 1  ON 20
ci_022                -1.169123e-02 3 1  ON 21
ci_023                 4.843314e-03 3 1  ON 22
ci_024                 4.944700e-03 3 1  ON 23
ci_025                 1.132002e-02 3 1  ON 24
ci_026                 1.141515e-02 3 1  ON 25
ci_027                 6.500074e-03 3 1  ON 26
ci_028                 6.245471e-03 3 1  ON 27
ci_029                -5.170442e-03 3 1  ON 28
ci_030                -4.217843e-03 3 1  ON 29
ci_031                 3.244117e-03 3 1  ON 30
ci_032                 4.392855e-03 3 1  ON 31
ci_033                 2.344929e-03 3 1  ON 32
ci_034                 4.175502e-03 3 1  ON 33
ci_035                 1.734726e-03 3 1  ON 34
ci_036                 2.193775e-03 3 1  ON 35
ci_037                 3.588267e-03 3 1  ON 36
ci_038                 3.702961e-03 3 1  ON 37
ci_039                 4.647726e-03 3 1  ON 38
ci_040                 4.988303e-03 3 1  ON 39
ci_041                 2.976369e-03 3 1  ON 40
ci_042                 2.735534e-03 3 1  ON 41
ci_043                 3.001516e-03 3 1  ON 42
ci_044                 3.198005e-03 3 1  ON 43
ci_045                 2.444378e-03 3 1  ON 44
ci_046                 2.684788e-03 3 1  ON 45
ci_047                -9.995313e-04 3 1  ON 46
ci_048                -8.374002e-04 3 1  ON 47
ci_049                 7.412837e-04 3 1  ON 48
ci_050                 1.074489e-03 3 1  ON 49
ci_051                -2.775781e-04 3 1  ON 50
ci_052                -1.208489e-03 3 1  ON 51
ci_053                -2.420523e-03 3 1  ON 52
ci_054                -2.639610e-03 3 1  ON 53
ci_055                -1.826439e-03 3 1  ON 54
ci_056                -1.960344e-03 3 1  ON 55
ci_057                -1.314609e-03 3 1  ON 56
ci_058                -9.789381e-04 3 1  ON 57
ci_059                -5.696833e-04 3 1  ON 58
ci_060                -7.765312e-04 3 1  ON 59
ci_061                -6.915890e-05 3 1  ON 60
ci_062                -9.472321e-04 3 1  ON 61
ci_063                -8.854108e-04 3 1  ON 62
ci_064                -5.147456e-04 3 1  ON 63
ci_065                -1.334392e-03 3 1  ON 64
ci_066                -1.933025e-03 3 1  ON 65
ci_067                -1.805468e-03 3 1  ON 66
ci_068                -1.576023e-03 3 1  ON 67
ci_069                -5.732130e-04 3 1  ON 68
ci_070                -4.403496e-04 3 1  ON 69
ci_071                -2.077725e-03 3 1  ON 70
ci_072                -1.995433e-03 3 1  ON 71
ci_073                 1.602445e-04 3 1  ON 72
ci_074                 2.017862e-04 3 1  ON 73
ci_075                 1.519418e-04 3 1  ON 74
ci_076                 8.317226e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2660e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.5934
    reference variance = 0.34069
====================================================
  Execution time = 2.6552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5294e-01
  Total weights = 1.955231731e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441436180544
                                         uncertainty =       0.002200154691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441436180544
                                         uncertainty =       0.002200154691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469799311
  error estimate for blocks of size 2^( 2) =       0.000493827458
  error estimate for blocks of size 2^( 3) =       0.000516404901
  error estimate for blocks of size 2^( 4) =       0.000532033210
  error estimate for blocks of size 2^( 5) =       0.000541629605
  error estimate for blocks of size 2^( 6) =       0.000546824842
  error estimate for blocks of size 2^( 7) =       0.000548174347

      target function =      -0.742918958437
              le_mean =     -22.661623755542
             les_mean =     514.002126336875
             stat err =       0.000542165501
             autocorr =       1.331799988106
   target nu stat err =       0.000542165501
   target dn stat err =       0.003334573134
      target stat err =       0.002786062168
              std dev =       0.664396557888
             le_variance =       0.441422786134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266162375554e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742928529829       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742928544113       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742928546913       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742928547241       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742928547328       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742928547369       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742928547376       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742928547365       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742928547364       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742928547372       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742928547365       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742928547365       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+03 is 1.383559e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742928529829       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742928533400       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742928534100       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742928534182       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742928534205       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742928534214       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742928534216       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742928534214       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742928534212       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742928534215       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742928534213       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742928534213       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+03 is 3.458963e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742928529829       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742928530722       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742928530897       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742928530917       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742928530918       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742928530925       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742928530947       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742928530925       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742928530908       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742928530994       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742928530936       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742928530962       residual = 1.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.4414e+04 is 8.647448e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1298e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_001                -7.054737e-01 3 1  ON 0
ci_002                -7.030154e-01 3 1  ON 1
ci_003                -4.996660e-02 3 1  ON 2
ci_004                -5.098003e-02 3 1  ON 3
ci_005                 1.954922e-02 3 1  ON 4
ci_006                 1.991034e-02 3 1  ON 5
ci_007                 1.473775e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331698e-02 3 1  ON 8
ci_010                -1.213870e-02 3 1  ON 9
ci_011                -9.956783e-03 3 1  ON 10
ci_012                -9.107874e-03 3 1  ON 11
ci_013                 8.438091e-03 3 1  ON 12
ci_014                 9.447312e-03 3 1  ON 13
ci_015                 9.576084e-03 3 1  ON 14
ci_016                 9.511731e-03 3 1  ON 15
ci_017                 8.538399e-03 3 1  ON 16
ci_018                 8.365203e-03 3 1  ON 17
ci_019                -1.039486e-03 3 1  ON 18
ci_020                -1.339844e-03 3 1  ON 19
ci_021                -1.174207e-02 3 1  ON 20
ci_022                -1.169125e-02 3 1  ON 21
ci_023                 4.843311e-03 3 1  ON 22
ci_024                 4.944690e-03 3 1  ON 23
ci_025                 1.132006e-02 3 1  ON 24
ci_026                 1.141514e-02 3 1  ON 25
ci_027                 6.500057e-03 3 1  ON 26
ci_028                 6.245464e-03 3 1  ON 27
ci_029                -5.170448e-03 3 1  ON 28
ci_030                -4.217839e-03 3 1  ON 29
ci_031                 3.244137e-03 3 1  ON 30
ci_032                 4.392870e-03 3 1  ON 31
ci_033                 2.344932e-03 3 1  ON 32
ci_034                 4.175494e-03 3 1  ON 33
ci_035                 1.734722e-03 3 1  ON 34
ci_036                 2.193775e-03 3 1  ON 35
ci_037                 3.588263e-03 3 1  ON 36
ci_038                 3.702950e-03 3 1  ON 37
ci_039                 4.647713e-03 3 1  ON 38
ci_040                 4.988295e-03 3 1  ON 39
ci_041                 2.976372e-03 3 1  ON 40
ci_042                 2.735538e-03 3 1  ON 41
ci_043                 3.001522e-03 3 1  ON 42
ci_044                 3.198001e-03 3 1  ON 43
ci_045                 2.444364e-03 3 1  ON 44
ci_046                 2.684781e-03 3 1  ON 45
ci_047                -9.995324e-04 3 1  ON 46
ci_048                -8.374164e-04 3 1  ON 47
ci_049                 7.412899e-04 3 1  ON 48
ci_050                 1.074496e-03 3 1  ON 49
ci_051                -2.775726e-04 3 1  ON 50
ci_052                -1.208477e-03 3 1  ON 51
ci_053                -2.420533e-03 3 1  ON 52
ci_054                -2.639614e-03 3 1  ON 53
ci_055                -1.826446e-03 3 1  ON 54
ci_056                -1.960341e-03 3 1  ON 55
ci_057                -1.314618e-03 3 1  ON 56
ci_058                -9.789282e-04 3 1  ON 57
ci_059                -5.696799e-04 3 1  ON 58
ci_060                -7.765335e-04 3 1  ON 59
ci_061                -6.915638e-05 3 1  ON 60
ci_062                -9.472189e-04 3 1  ON 61
ci_063                -8.854045e-04 3 1  ON 62
ci_064                -5.147535e-04 3 1  ON 63
ci_065                -1.334393e-03 3 1  ON 64
ci_066                -1.933031e-03 3 1  ON 65
ci_067                -1.805445e-03 3 1  ON 66
ci_068                -1.576014e-03 3 1  ON 67
ci_069                -5.732118e-04 3 1  ON 68
ci_070                -4.403586e-04 3 1  ON 69
ci_071                -2.077716e-03 3 1  ON 70
ci_072                -1.995432e-03 3 1  ON 71
ci_073                 1.602450e-04 3 1  ON 72
ci_074                 2.017807e-04 3 1  ON 73
ci_075                 1.519492e-04 3 1  ON 74
ci_076                 8.317136e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.7049
    reference variance = 0.299617
====================================================
  Execution time = 2.5826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5471e-01
  Total weights = 1.9554e+06
  Execution time = 3.6283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442923902639
                                         uncertainty =       0.002559978766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442923902639
                                         uncertainty =       0.002559978766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470560061
  error estimate for blocks of size 2^( 2) =       0.000493919670
  error estimate for blocks of size 2^( 3) =       0.000515280080
  error estimate for blocks of size 2^( 4) =       0.000530475695
  error estimate for blocks of size 2^( 5) =       0.000539014686
  error estimate for blocks of size 2^( 6) =       0.000544664494
  error estimate for blocks of size 2^( 7) =       0.000547359690

      target function =      -0.741473087293
              le_mean =     -22.661825203424
             les_mean =     514.013028602379
             stat err =       0.000540378641
             autocorr =       1.318761388328
   target nu stat err =       0.000540378641
   target dn stat err =       0.003805846533
      target stat err =       0.003151388161
              std dev =       0.665472420078
             le_variance =       0.442853541885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442923883678
                                         uncertainty =       0.002559979051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442923883678
                                         uncertainty =       0.002559979051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470560051
  error estimate for blocks of size 2^( 2) =       0.000493919663
  error estimate for blocks of size 2^( 3) =       0.000515280076
  error estimate for blocks of size 2^( 4) =       0.000530475690
  error estimate for blocks of size 2^( 5) =       0.000539014682
  error estimate for blocks of size 2^( 6) =       0.000544664485
  error estimate for blocks of size 2^( 7) =       0.000547359681

      target function =      -0.741473173055
              le_mean =     -22.661825202054
             les_mean =     514.013028434765
             stat err =       0.000540378635
             autocorr =       1.318761412243
   target nu stat err =       0.000540378635
   target dn stat err =       0.003805850701
      target stat err =       0.003151392198
              std dev =       0.665472405867
             le_variance =       0.442853522971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442923893158
                                         uncertainty =       0.002559978908

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442923893158
                                         uncertainty =       0.002559978908

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470560056
  error estimate for blocks of size 2^( 2) =       0.000493919667
  error estimate for blocks of size 2^( 3) =       0.000515280078
  error estimate for blocks of size 2^( 4) =       0.000530475693
  error estimate for blocks of size 2^( 5) =       0.000539014684
  error estimate for blocks of size 2^( 6) =       0.000544664489
  error estimate for blocks of size 2^( 7) =       0.000547359685

      target function =      -0.741473130220
              le_mean =     -22.661825202739
             les_mean =     514.013028518513
             stat err =       0.000540378638
             autocorr =       1.318761400290
   target nu stat err =       0.000540378638
   target dn stat err =       0.003805848617
      target stat err =       0.003151390179
              std dev =       0.665472412972
             le_variance =       0.442853532427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442923901453
                                         uncertainty =       0.002559978784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442923901453
                                         uncertainty =       0.002559978784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470560060
  error estimate for blocks of size 2^( 2) =       0.000493919670
  error estimate for blocks of size 2^( 3) =       0.000515280080
  error estimate for blocks of size 2^( 4) =       0.000530475695
  error estimate for blocks of size 2^( 5) =       0.000539014686
  error estimate for blocks of size 2^( 6) =       0.000544664493
  error estimate for blocks of size 2^( 7) =       0.000547359689

      target function =      -0.741473092664
              le_mean =     -22.661825203339
             les_mean =     514.013028591890
             stat err =       0.000540378641
             autocorr =       1.318761389828
   target nu stat err =       0.000540378641
   target dn stat err =       0.003805846794
      target stat err =       0.003151388413
              std dev =       0.665472419190
             le_variance =       0.442853540703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741473087293        initial
     1.5259e+03     1.5259e+04             1.3836e-07        -0.741473173055  <--
     6.1035e+03     6.1035e+04             3.4590e-08        -0.741473130220
     2.4414e+04     2.4414e+05             8.6474e-09        -0.741473092664

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 4.3981e+01
  </log>
  <optVariables href="FORM2.s025.opt.xml">
ci_001                -7.054737e-01 3 1  ON 0
ci_002                -7.030155e-01 3 1  ON 1
ci_003                -4.996654e-02 3 1  ON 2
ci_004                -5.097996e-02 3 1  ON 3
ci_005                 1.954919e-02 3 1  ON 4
ci_006                 1.991031e-02 3 1  ON 5
ci_007                 1.473771e-02 3 1  ON 6
ci_008                 1.564523e-02 3 1  ON 7
ci_009                -1.331695e-02 3 1  ON 8
ci_010                -1.213867e-02 3 1  ON 9
ci_011                -9.956764e-03 3 1  ON 10
ci_012                -9.107853e-03 3 1  ON 11
ci_013                 8.438057e-03 3 1  ON 12
ci_014                 9.447243e-03 3 1  ON 13
ci_015                 9.576042e-03 3 1  ON 14
ci_016                 9.511714e-03 3 1  ON 15
ci_017                 8.538373e-03 3 1  ON 16
ci_018                 8.365120e-03 3 1  ON 17
ci_019                -1.039555e-03 3 1  ON 18
ci_020                -1.339896e-03 3 1  ON 19
ci_021                -1.174210e-02 3 1  ON 20
ci_022                -1.169131e-02 3 1  ON 21
ci_023                 4.843303e-03 3 1  ON 22
ci_024                 4.944659e-03 3 1  ON 23
ci_025                 1.132016e-02 3 1  ON 24
ci_026                 1.141513e-02 3 1  ON 25
ci_027                 6.500006e-03 3 1  ON 26
ci_028                 6.245445e-03 3 1  ON 27
ci_029                -5.170464e-03 3 1  ON 28
ci_030                -4.217828e-03 3 1  ON 29
ci_031                 3.244196e-03 3 1  ON 30
ci_032                 4.392918e-03 3 1  ON 31
ci_033                 2.344944e-03 3 1  ON 32
ci_034                 4.175472e-03 3 1  ON 33
ci_035                 1.734710e-03 3 1  ON 34
ci_036                 2.193773e-03 3 1  ON 35
ci_037                 3.588250e-03 3 1  ON 36
ci_038                 3.702917e-03 3 1  ON 37
ci_039                 4.647675e-03 3 1  ON 38
ci_040                 4.988272e-03 3 1  ON 39
ci_041                 2.976380e-03 3 1  ON 40
ci_042                 2.735551e-03 3 1  ON 41
ci_043                 3.001541e-03 3 1  ON 42
ci_044                 3.197991e-03 3 1  ON 43
ci_045                 2.444322e-03 3 1  ON 44
ci_046                 2.684763e-03 3 1  ON 45
ci_047                -9.995359e-04 3 1  ON 46
ci_048                -8.374647e-04 3 1  ON 47
ci_049                 7.413084e-04 3 1  ON 48
ci_050                 1.074517e-03 3 1  ON 49
ci_051                -2.775561e-04 3 1  ON 50
ci_052                -1.208440e-03 3 1  ON 51
ci_053                -2.420563e-03 3 1  ON 52
ci_054                -2.639627e-03 3 1  ON 53
ci_055                -1.826468e-03 3 1  ON 54
ci_056                -1.960331e-03 3 1  ON 55
ci_057                -1.314643e-03 3 1  ON 56
ci_058                -9.788988e-04 3 1  ON 57
ci_059                -5.696699e-04 3 1  ON 58
ci_060                -7.765405e-04 3 1  ON 59
ci_061                -6.914884e-05 3 1  ON 60
ci_062                -9.471795e-04 3 1  ON 61
ci_063                -8.853857e-04 3 1  ON 62
ci_064                -5.147774e-04 3 1  ON 63
ci_065                -1.334396e-03 3 1  ON 64
ci_066                -1.933051e-03 3 1  ON 65
ci_067                -1.805376e-03 3 1  ON 66
ci_068                -1.575989e-03 3 1  ON 67
ci_069                -5.732084e-04 3 1  ON 68
ci_070                -4.403855e-04 3 1  ON 69
ci_071                -2.077687e-03 3 1  ON 70
ci_072                -1.995430e-03 3 1  ON 71
ci_073                 1.602468e-04 3 1  ON 72
ci_074                 2.017641e-04 3 1  ON 73
ci_075                 1.519715e-04 3 1  ON 74
ci_076                 8.316866e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6632
    reference variance = 0.49864
====================================================
  Execution time = 2.6672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5117e-01
  Total weights = 1.955358852e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440158471652
                                         uncertainty =       0.002446810190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440158471652
                                         uncertainty =       0.002446810190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469095888
  error estimate for blocks of size 2^( 2) =       0.000493072944
  error estimate for blocks of size 2^( 3) =       0.000514911099
  error estimate for blocks of size 2^( 4) =       0.000531075393
  error estimate for blocks of size 2^( 5) =       0.000539649755
  error estimate for blocks of size 2^( 6) =       0.000541862244
  error estimate for blocks of size 2^( 7) =       0.000547655703

      target function =      -0.744373952532
              le_mean =     -22.663259482096
             les_mean =     514.074497815741
             stat err =       0.000540060774
             autocorr =       1.325445932653
   target nu stat err =       0.000540060774
   target dn stat err =       0.003421262830
      target stat err =       0.002872641797
              std dev =       0.663401767017
             le_variance =       0.440101904482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266325948210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744384054801       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744384113930       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744384125521       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744384126584       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744384126737       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744384126715       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744384126904       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744384126992       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744384127045       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744384127073       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744384127063       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+02 is 4.254581e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744384054801       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744384069585       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744384072483       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744384072748       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744384072786       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744384072784       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744384072827       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744384072851       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744384072865       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744384072875       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744384072867       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+03 is 1.063652e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744384054801       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744384058497       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744384059221       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744384059288       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744384059296       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744384059297       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744384059309       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744384059313       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744384059318       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744384059329       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744384059311       residual = 9.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 6.1035e+03 is 2.659134e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129732 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1390e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_001                -7.054736e-01 3 1  ON 0
ci_002                -7.030156e-01 3 1  ON 1
ci_003                -4.996654e-02 3 1  ON 2
ci_004                -5.097991e-02 3 1  ON 3
ci_005                 1.954910e-02 3 1  ON 4
ci_006                 1.991024e-02 3 1  ON 5
ci_007                 1.473769e-02 3 1  ON 6
ci_008                 1.564524e-02 3 1  ON 7
ci_009                -1.331688e-02 3 1  ON 8
ci_010                -1.213863e-02 3 1  ON 9
ci_011                -9.956764e-03 3 1  ON 10
ci_012                -9.107820e-03 3 1  ON 11
ci_013                 8.438040e-03 3 1  ON 12
ci_014                 9.447190e-03 3 1  ON 13
ci_015                 9.575961e-03 3 1  ON 14
ci_016                 9.511708e-03 3 1  ON 15
ci_017                 8.538331e-03 3 1  ON 16
ci_018                 8.365066e-03 3 1  ON 17
ci_019                -1.039645e-03 3 1  ON 18
ci_020                -1.339996e-03 3 1  ON 19
ci_021                -1.174218e-02 3 1  ON 20
ci_022                -1.169140e-02 3 1  ON 21
ci_023                 4.843320e-03 3 1  ON 22
ci_024                 4.944661e-03 3 1  ON 23
ci_025                 1.132024e-02 3 1  ON 24
ci_026                 1.141519e-02 3 1  ON 25
ci_027                 6.499960e-03 3 1  ON 26
ci_028                 6.245442e-03 3 1  ON 27
ci_029                -5.170490e-03 3 1  ON 28
ci_030                -4.217750e-03 3 1  ON 29
ci_031                 3.244176e-03 3 1  ON 30
ci_032                 4.392935e-03 3 1  ON 31
ci_033                 2.344999e-03 3 1  ON 32
ci_034                 4.175433e-03 3 1  ON 33
ci_035                 1.734715e-03 3 1  ON 34
ci_036                 2.193770e-03 3 1  ON 35
ci_037                 3.588255e-03 3 1  ON 36
ci_038                 3.702879e-03 3 1  ON 37
ci_039                 4.647662e-03 3 1  ON 38
ci_040                 4.988222e-03 3 1  ON 39
ci_041                 2.976368e-03 3 1  ON 40
ci_042                 2.735547e-03 3 1  ON 41
ci_043                 3.001521e-03 3 1  ON 42
ci_044                 3.197970e-03 3 1  ON 43
ci_045                 2.444283e-03 3 1  ON 44
ci_046                 2.684782e-03 3 1  ON 45
ci_047                -9.995172e-04 3 1  ON 46
ci_048                -8.374779e-04 3 1  ON 47
ci_049                 7.413337e-04 3 1  ON 48
ci_050                 1.074541e-03 3 1  ON 49
ci_051                -2.775589e-04 3 1  ON 50
ci_052                -1.208407e-03 3 1  ON 51
ci_053                -2.420539e-03 3 1  ON 52
ci_054                -2.639598e-03 3 1  ON 53
ci_055                -1.826502e-03 3 1  ON 54
ci_056                -1.960285e-03 3 1  ON 55
ci_057                -1.314601e-03 3 1  ON 56
ci_058                -9.789322e-04 3 1  ON 57
ci_059                -5.696072e-04 3 1  ON 58
ci_060                -7.765455e-04 3 1  ON 59
ci_061                -6.911723e-05 3 1  ON 60
ci_062                -9.471403e-04 3 1  ON 61
ci_063                -8.853749e-04 3 1  ON 62
ci_064                -5.148087e-04 3 1  ON 63
ci_065                -1.334401e-03 3 1  ON 64
ci_066                -1.933004e-03 3 1  ON 65
ci_067                -1.805351e-03 3 1  ON 66
ci_068                -1.576001e-03 3 1  ON 67
ci_069                -5.732176e-04 3 1  ON 68
ci_070                -4.403380e-04 3 1  ON 69
ci_071                -2.077661e-03 3 1  ON 70
ci_072                -1.995367e-03 3 1  ON 71
ci_073                 1.602532e-04 3 1  ON 72
ci_074                 2.017554e-04 3 1  ON 73
ci_075                 1.519932e-04 3 1  ON 74
ci_076                 8.316464e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.6571
    reference variance = 0.317343
====================================================
  Execution time = 2.5982e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5140e-01
  Total weights = 1.9552e+06
  Execution time = 3.6188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440780911490
                                         uncertainty =       0.002134857135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440780911490
                                         uncertainty =       0.002134857135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469437883
  error estimate for blocks of size 2^( 2) =       0.000493333410
  error estimate for blocks of size 2^( 3) =       0.000515444769
  error estimate for blocks of size 2^( 4) =       0.000531279944
  error estimate for blocks of size 2^( 5) =       0.000540729372
  error estimate for blocks of size 2^( 6) =       0.000545094356
  error estimate for blocks of size 2^( 7) =       0.000548137054

      target function =      -0.744178853658
              le_mean =     -22.662569659081
             les_mean =     514.043468493420
             stat err =       0.000541310182
             autocorr =       1.329646286916
   target nu stat err =       0.000541310182
   target dn stat err =       0.002817472259
      target stat err =       0.002386385707
              std dev =       0.663885420214
             le_variance =       0.440743851173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440780845214
                                         uncertainty =       0.002134853584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440780845214
                                         uncertainty =       0.002134853584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469437847
  error estimate for blocks of size 2^( 2) =       0.000493333386
  error estimate for blocks of size 2^( 3) =       0.000515444756
  error estimate for blocks of size 2^( 4) =       0.000531279934
  error estimate for blocks of size 2^( 5) =       0.000540729364
  error estimate for blocks of size 2^( 6) =       0.000545094350
  error estimate for blocks of size 2^( 7) =       0.000548137066

      target function =      -0.744179076525
              le_mean =     -22.662569659647
             les_mean =     514.043468247225
             stat err =       0.000541310179
             autocorr =       1.329646472303
   target nu stat err =       0.000541310179
   target dn stat err =       0.002817485686
      target stat err =       0.002386397755
              std dev =       0.663885370312
             le_variance =       0.440743784914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440780878343
                                         uncertainty =       0.002134855359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440780878343
                                         uncertainty =       0.002134855359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469437865
  error estimate for blocks of size 2^( 2) =       0.000493333398
  error estimate for blocks of size 2^( 3) =       0.000515444762
  error estimate for blocks of size 2^( 4) =       0.000531279939
  error estimate for blocks of size 2^( 5) =       0.000540729368
  error estimate for blocks of size 2^( 6) =       0.000545094353
  error estimate for blocks of size 2^( 7) =       0.000548137060

      target function =      -0.744178966016
              le_mean =     -22.662569659363
             les_mean =     514.043468369164
             stat err =       0.000541310180
             autocorr =       1.329646379619
   target nu stat err =       0.000541310180
   target dn stat err =       0.002817478953
      target stat err =       0.002386391722
              std dev =       0.663885395256
             le_variance =       0.440743818035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440780907346
                                         uncertainty =       0.002134856913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440780907346
                                         uncertainty =       0.002134856913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469437880
  error estimate for blocks of size 2^( 2) =       0.000493333409
  error estimate for blocks of size 2^( 3) =       0.000515444768
  error estimate for blocks of size 2^( 4) =       0.000531279943
  error estimate for blocks of size 2^( 5) =       0.000540729371
  error estimate for blocks of size 2^( 6) =       0.000545094356
  error estimate for blocks of size 2^( 7) =       0.000548137055

      target function =      -0.744178867804
              le_mean =     -22.662569659116
             les_mean =     514.043468477761
             stat err =       0.000541310181
             autocorr =       1.329646298506
   target nu stat err =       0.000541310181
   target dn stat err =       0.002817473093
      target stat err =       0.002386386458
              std dev =       0.663885417094
             le_variance =       0.440743847030


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744178853658        initial
     3.8147e+02     3.8147e+03             4.2546e-07        -0.744179076525  <--
     1.5259e+03     1.5259e+04             1.0637e-07        -0.744178966016
     6.1035e+03     6.1035e+04             2.6591e-08        -0.744178867804

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 4.4157e+01
  </log>
  <optVariables href="FORM2.s026.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030159e-01 3 1  ON 1
ci_003                -4.996654e-02 3 1  ON 2
ci_004                -5.097978e-02 3 1  ON 3
ci_005                 1.954882e-02 3 1  ON 4
ci_006                 1.991002e-02 3 1  ON 5
ci_007                 1.473761e-02 3 1  ON 6
ci_008                 1.564525e-02 3 1  ON 7
ci_009                -1.331668e-02 3 1  ON 8
ci_010                -1.213851e-02 3 1  ON 9
ci_011                -9.956761e-03 3 1  ON 10
ci_012                -9.107720e-03 3 1  ON 11
ci_013                 8.437989e-03 3 1  ON 12
ci_014                 9.447029e-03 3 1  ON 13
ci_015                 9.575718e-03 3 1  ON 14
ci_016                 9.511688e-03 3 1  ON 15
ci_017                 8.538208e-03 3 1  ON 16
ci_018                 8.364902e-03 3 1  ON 17
ci_019                -1.039915e-03 3 1  ON 18
ci_020                -1.340295e-03 3 1  ON 19
ci_021                -1.174243e-02 3 1  ON 20
ci_022                -1.169168e-02 3 1  ON 21
ci_023                 4.843373e-03 3 1  ON 22
ci_024                 4.944667e-03 3 1  ON 23
ci_025                 1.132049e-02 3 1  ON 24
ci_026                 1.141538e-02 3 1  ON 25
ci_027                 6.499824e-03 3 1  ON 26
ci_028                 6.245433e-03 3 1  ON 27
ci_029                -5.170569e-03 3 1  ON 28
ci_030                -4.217516e-03 3 1  ON 29
ci_031                 3.244116e-03 3 1  ON 30
ci_032                 4.392989e-03 3 1  ON 31
ci_033                 2.345167e-03 3 1  ON 32
ci_034                 4.175316e-03 3 1  ON 33
ci_035                 1.734731e-03 3 1  ON 34
ci_036                 2.193760e-03 3 1  ON 35
ci_037                 3.588269e-03 3 1  ON 36
ci_038                 3.702764e-03 3 1  ON 37
ci_039                 4.647623e-03 3 1  ON 38
ci_040                 4.988072e-03 3 1  ON 39
ci_041                 2.976334e-03 3 1  ON 40
ci_042                 2.735535e-03 3 1  ON 41
ci_043                 3.001463e-03 3 1  ON 42
ci_044                 3.197904e-03 3 1  ON 43
ci_045                 2.444167e-03 3 1  ON 44
ci_046                 2.684838e-03 3 1  ON 45
ci_047                -9.994613e-04 3 1  ON 46
ci_048                -8.375173e-04 3 1  ON 47
ci_049                 7.414094e-04 3 1  ON 48
ci_050                 1.074613e-03 3 1  ON 49
ci_051                -2.775670e-04 3 1  ON 50
ci_052                -1.208308e-03 3 1  ON 51
ci_053                -2.420470e-03 3 1  ON 52
ci_054                -2.639512e-03 3 1  ON 53
ci_055                -1.826602e-03 3 1  ON 54
ci_056                -1.960148e-03 3 1  ON 55
ci_057                -1.314474e-03 3 1  ON 56
ci_058                -9.790323e-04 3 1  ON 57
ci_059                -5.694189e-04 3 1  ON 58
ci_060                -7.765606e-04 3 1  ON 59
ci_061                -6.902243e-05 3 1  ON 60
ci_062                -9.470228e-04 3 1  ON 61
ci_063                -8.853426e-04 3 1  ON 62
ci_064                -5.149026e-04 3 1  ON 63
ci_065                -1.334419e-03 3 1  ON 64
ci_066                -1.932862e-03 3 1  ON 65
ci_067                -1.805277e-03 3 1  ON 66
ci_068                -1.576035e-03 3 1  ON 67
ci_069                -5.732451e-04 3 1  ON 68
ci_070                -4.401957e-04 3 1  ON 69
ci_071                -2.077583e-03 3 1  ON 70
ci_072                -1.995178e-03 3 1  ON 71
ci_073                 1.602725e-04 3 1  ON 72
ci_074                 2.017294e-04 3 1  ON 73
ci_075                 1.520581e-04 3 1  ON 74
ci_076                 8.315259e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5554e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.745
    reference variance = 0.430902
====================================================
  Execution time = 2.6480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5019e-01
  Total weights = 1.955341308e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441407535527
                                         uncertainty =       0.001971937721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441407535527
                                         uncertainty =       0.001971937721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469846181
  error estimate for blocks of size 2^( 2) =       0.000493965684
  error estimate for blocks of size 2^( 3) =       0.000515906420
  error estimate for blocks of size 2^( 4) =       0.000531365656
  error estimate for blocks of size 2^( 5) =       0.000540152675
  error estimate for blocks of size 2^( 6) =       0.000544564239
  error estimate for blocks of size 2^( 7) =       0.000547833676

      target function =      -0.745179075574
              le_mean =     -22.662481074454
             les_mean =     514.038236841267
             stat err =       0.000540979061
             autocorr =       1.325712984793
   target nu stat err =       0.000540979061
   target dn stat err =       0.002444472825
      target stat err =       0.002096610169
              std dev =       0.664462841185
             le_variance =       0.441510867316


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266248107445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745183983383       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745184145457       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745184179593       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745184182661       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745184185377       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745184186960       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745184186214       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745184186281       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745184186284       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745184186397       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745184186421       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+01 is 2.534232e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745183983383       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745184023916       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745184032452       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745184033219       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745184033898       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745184034294       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745184034107       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745184034124       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745184034124       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745184034153       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745184034159       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+02 is 6.337440e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745183983383       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745183993517       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745183995651       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745183995843       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745183996012       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745183996111       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745183996065       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745183996070       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745183996067       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745183996077       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745183996073       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+03 is 1.584476e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1174e+01
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_001                -7.054739e-01 3 1  ON 0
ci_002                -7.030153e-01 3 1  ON 1
ci_003                -4.996680e-02 3 1  ON 2
ci_004                -5.097944e-02 3 1  ON 3
ci_005                 1.954869e-02 3 1  ON 4
ci_006                 1.990971e-02 3 1  ON 5
ci_007                 1.473750e-02 3 1  ON 6
ci_008                 1.564504e-02 3 1  ON 7
ci_009                -1.331650e-02 3 1  ON 8
ci_010                -1.213824e-02 3 1  ON 9
ci_011                -9.956723e-03 3 1  ON 10
ci_012                -9.107782e-03 3 1  ON 11
ci_013                 8.437846e-03 3 1  ON 12
ci_014                 9.446893e-03 3 1  ON 13
ci_015                 9.575572e-03 3 1  ON 14
ci_016                 9.511674e-03 3 1  ON 15
ci_017                 8.538313e-03 3 1  ON 16
ci_018                 8.364959e-03 3 1  ON 17
ci_019                -1.040549e-03 3 1  ON 18
ci_020                -1.340698e-03 3 1  ON 19
ci_021                -1.174247e-02 3 1  ON 20
ci_022                -1.169174e-02 3 1  ON 21
ci_023                 4.843367e-03 3 1  ON 22
ci_024                 4.944725e-03 3 1  ON 23
ci_025                 1.132083e-02 3 1  ON 24
ci_026                 1.141548e-02 3 1  ON 25
ci_027                 6.499785e-03 3 1  ON 26
ci_028                 6.245483e-03 3 1  ON 27
ci_029                -5.170205e-03 3 1  ON 28
ci_030                -4.217450e-03 3 1  ON 29
ci_031                 3.244230e-03 3 1  ON 30
ci_032                 4.393302e-03 3 1  ON 31
ci_033                 2.345334e-03 3 1  ON 32
ci_034                 4.175192e-03 3 1  ON 33
ci_035                 1.734764e-03 3 1  ON 34
ci_036                 2.193708e-03 3 1  ON 35
ci_037                 3.588255e-03 3 1  ON 36
ci_038                 3.702764e-03 3 1  ON 37
ci_039                 4.647634e-03 3 1  ON 38
ci_040                 4.987844e-03 3 1  ON 39
ci_041                 2.976480e-03 3 1  ON 40
ci_042                 2.735520e-03 3 1  ON 41
ci_043                 3.001453e-03 3 1  ON 42
ci_044                 3.197725e-03 3 1  ON 43
ci_045                 2.444159e-03 3 1  ON 44
ci_046                 2.684906e-03 3 1  ON 45
ci_047                -9.995122e-04 3 1  ON 46
ci_048                -8.375142e-04 3 1  ON 47
ci_049                 7.413859e-04 3 1  ON 48
ci_050                 1.074496e-03 3 1  ON 49
ci_051                -2.777268e-04 3 1  ON 50
ci_052                -1.208220e-03 3 1  ON 51
ci_053                -2.420528e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826643e-03 3 1  ON 54
ci_056                -1.960133e-03 3 1  ON 55
ci_057                -1.314463e-03 3 1  ON 56
ci_058                -9.789734e-04 3 1  ON 57
ci_059                -5.692829e-04 3 1  ON 58
ci_060                -7.764256e-04 3 1  ON 59
ci_061                -6.904495e-05 3 1  ON 60
ci_062                -9.469387e-04 3 1  ON 61
ci_063                -8.850907e-04 3 1  ON 62
ci_064                -5.146620e-04 3 1  ON 63
ci_065                -1.334602e-03 3 1  ON 64
ci_066                -1.932781e-03 3 1  ON 65
ci_067                -1.805094e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732697e-04 3 1  ON 68
ci_070                -4.400284e-04 3 1  ON 69
ci_071                -2.077726e-03 3 1  ON 70
ci_072                -1.995086e-03 3 1  ON 71
ci_073                 1.602340e-04 3 1  ON 72
ci_074                 2.017065e-04 3 1  ON 73
ci_075                 1.518973e-04 3 1  ON 74
ci_076                 8.315552e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7468
    reference variance = 0.367099
====================================================
  Execution time = 2.7500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5197e-01
  Total weights = 1.9555e+06
  Execution time = 3.6072e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441428487814
                                         uncertainty =       0.002389254194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441428487814
                                         uncertainty =       0.002389254194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469865163
  error estimate for blocks of size 2^( 2) =       0.000493799897
  error estimate for blocks of size 2^( 3) =       0.000515992619
  error estimate for blocks of size 2^( 4) =       0.000532283240
  error estimate for blocks of size 2^( 5) =       0.000539603545
  error estimate for blocks of size 2^( 6) =       0.000544020545
  error estimate for blocks of size 2^( 7) =       0.000545592781

      target function =      -0.743712012787
              le_mean =     -22.662944000832
             les_mean =     514.061004968199
             stat err =       0.000540375028
             autocorr =       1.322647298852
   target nu stat err =       0.000540375028
   target dn stat err =       0.003188571701
      target stat err =       0.002680126248
              std dev =       0.664489685715
             le_variance =       0.441546542421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441428082656
                                         uncertainty =       0.002389245671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441428082656
                                         uncertainty =       0.002389245671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469864949
  error estimate for blocks of size 2^( 2) =       0.000493799738
  error estimate for blocks of size 2^( 3) =       0.000515992507
  error estimate for blocks of size 2^( 4) =       0.000532283114
  error estimate for blocks of size 2^( 5) =       0.000539603402
  error estimate for blocks of size 2^( 6) =       0.000544020362
  error estimate for blocks of size 2^( 7) =       0.000545592605

      target function =      -0.743710918608
              le_mean =     -22.662944004404
             les_mean =     514.061006467493
             stat err =       0.000540374871
             autocorr =       1.322647730107
   target nu stat err =       0.000540374871
   target dn stat err =       0.003188259797
      target stat err =       0.002679869300
              std dev =       0.664489383796
             le_variance =       0.441546141177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441428285068
                                         uncertainty =       0.002389249932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441428285068
                                         uncertainty =       0.002389249932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469865056
  error estimate for blocks of size 2^( 2) =       0.000493799817
  error estimate for blocks of size 2^( 3) =       0.000515992563
  error estimate for blocks of size 2^( 4) =       0.000532283177
  error estimate for blocks of size 2^( 5) =       0.000539603473
  error estimate for blocks of size 2^( 6) =       0.000544020453
  error estimate for blocks of size 2^( 7) =       0.000545592693

      target function =      -0.743711470842
              le_mean =     -22.662944002608
             les_mean =     514.061005711095
             stat err =       0.000540374949
             autocorr =       1.322647514630
   target nu stat err =       0.000540374949
   target dn stat err =       0.003188415374
      target stat err =       0.002679997510
              std dev =       0.664489534630
             le_variance =       0.441546341633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441428462458
                                         uncertainty =       0.002389253661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441428462458
                                         uncertainty =       0.002389253661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469865149
  error estimate for blocks of size 2^( 2) =       0.000493799887
  error estimate for blocks of size 2^( 3) =       0.000515992612
  error estimate for blocks of size 2^( 4) =       0.000532283233
  error estimate for blocks of size 2^( 5) =       0.000539603536
  error estimate for blocks of size 2^( 6) =       0.000544020534
  error estimate for blocks of size 2^( 7) =       0.000545592770

      target function =      -0.743711945609
              le_mean =     -22.662944001053
             les_mean =     514.061005060317
             stat err =       0.000540375018
             autocorr =       1.322647325828
   target nu stat err =       0.000540375018
   target dn stat err =       0.003188552125
      target stat err =       0.002680110131
              std dev =       0.664489666819
             le_variance =       0.441546517309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743712012787        initial  <--
     9.5367e+01     9.5367e+02             2.5342e-06        -0.743710918608
     3.8147e+02     3.8147e+03             6.3374e-07        -0.743711470842
     1.5259e+03     1.5259e+04             1.5845e-07        -0.743711945609

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 45.6109
  </log>
  <optVariables href="FORM2.s027.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030159e-01 3 1  ON 1
ci_003                -4.996654e-02 3 1  ON 2
ci_004                -5.097978e-02 3 1  ON 3
ci_005                 1.954882e-02 3 1  ON 4
ci_006                 1.991002e-02 3 1  ON 5
ci_007                 1.473761e-02 3 1  ON 6
ci_008                 1.564525e-02 3 1  ON 7
ci_009                -1.331668e-02 3 1  ON 8
ci_010                -1.213851e-02 3 1  ON 9
ci_011                -9.956761e-03 3 1  ON 10
ci_012                -9.107720e-03 3 1  ON 11
ci_013                 8.437989e-03 3 1  ON 12
ci_014                 9.447029e-03 3 1  ON 13
ci_015                 9.575718e-03 3 1  ON 14
ci_016                 9.511688e-03 3 1  ON 15
ci_017                 8.538208e-03 3 1  ON 16
ci_018                 8.364902e-03 3 1  ON 17
ci_019                -1.039915e-03 3 1  ON 18
ci_020                -1.340295e-03 3 1  ON 19
ci_021                -1.174243e-02 3 1  ON 20
ci_022                -1.169168e-02 3 1  ON 21
ci_023                 4.843373e-03 3 1  ON 22
ci_024                 4.944667e-03 3 1  ON 23
ci_025                 1.132049e-02 3 1  ON 24
ci_026                 1.141538e-02 3 1  ON 25
ci_027                 6.499824e-03 3 1  ON 26
ci_028                 6.245433e-03 3 1  ON 27
ci_029                -5.170569e-03 3 1  ON 28
ci_030                -4.217516e-03 3 1  ON 29
ci_031                 3.244116e-03 3 1  ON 30
ci_032                 4.392989e-03 3 1  ON 31
ci_033                 2.345167e-03 3 1  ON 32
ci_034                 4.175316e-03 3 1  ON 33
ci_035                 1.734731e-03 3 1  ON 34
ci_036                 2.193760e-03 3 1  ON 35
ci_037                 3.588269e-03 3 1  ON 36
ci_038                 3.702764e-03 3 1  ON 37
ci_039                 4.647623e-03 3 1  ON 38
ci_040                 4.988072e-03 3 1  ON 39
ci_041                 2.976334e-03 3 1  ON 40
ci_042                 2.735535e-03 3 1  ON 41
ci_043                 3.001463e-03 3 1  ON 42
ci_044                 3.197904e-03 3 1  ON 43
ci_045                 2.444167e-03 3 1  ON 44
ci_046                 2.684838e-03 3 1  ON 45
ci_047                -9.994613e-04 3 1  ON 46
ci_048                -8.375173e-04 3 1  ON 47
ci_049                 7.414094e-04 3 1  ON 48
ci_050                 1.074613e-03 3 1  ON 49
ci_051                -2.775670e-04 3 1  ON 50
ci_052                -1.208308e-03 3 1  ON 51
ci_053                -2.420470e-03 3 1  ON 52
ci_054                -2.639512e-03 3 1  ON 53
ci_055                -1.826602e-03 3 1  ON 54
ci_056                -1.960148e-03 3 1  ON 55
ci_057                -1.314474e-03 3 1  ON 56
ci_058                -9.790323e-04 3 1  ON 57
ci_059                -5.694189e-04 3 1  ON 58
ci_060                -7.765606e-04 3 1  ON 59
ci_061                -6.902243e-05 3 1  ON 60
ci_062                -9.470228e-04 3 1  ON 61
ci_063                -8.853426e-04 3 1  ON 62
ci_064                -5.149026e-04 3 1  ON 63
ci_065                -1.334419e-03 3 1  ON 64
ci_066                -1.932862e-03 3 1  ON 65
ci_067                -1.805277e-03 3 1  ON 66
ci_068                -1.576035e-03 3 1  ON 67
ci_069                -5.732451e-04 3 1  ON 68
ci_070                -4.401957e-04 3 1  ON 69
ci_071                -2.077583e-03 3 1  ON 70
ci_072                -1.995178e-03 3 1  ON 71
ci_073                 1.602725e-04 3 1  ON 72
ci_074                 2.017294e-04 3 1  ON 73
ci_075                 1.520581e-04 3 1  ON 74
ci_076                 8.315259e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6792e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7119
    reference variance = 0.420561
====================================================
  Execution time = 2.6694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4819e-01
  Total weights = 1.955279244e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438080005230
                                         uncertainty =       0.001900273205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438080005230
                                         uncertainty =       0.001900273205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467984196
  error estimate for blocks of size 2^( 2) =       0.000491948046
  error estimate for blocks of size 2^( 3) =       0.000514483667
  error estimate for blocks of size 2^( 4) =       0.000529660523
  error estimate for blocks of size 2^( 5) =       0.000540171254
  error estimate for blocks of size 2^( 6) =       0.000545326192
  error estimate for blocks of size 2^( 7) =       0.000548408448

      target function =      -0.746820997498
              le_mean =     -22.662052866308
             les_mean =     514.016830383572
             stat err =       0.000540891604
             autocorr =       1.335851265834
   target nu stat err =       0.000540891604
   target dn stat err =       0.002499557589
      target stat err =       0.002147751577
              std dev =       0.661829597154
             le_variance =       0.438018415669


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266205286631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746826175842       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746826194339       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746826196565       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746826197198       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746826197261       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746826197310       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746826197285       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746826197299       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746826197301       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746826197314       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746826197310       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746826197297       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+02 is 1.986070e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746826175842       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746826180466       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746826181023       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746826181181       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746826181197       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746826181209       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746826181203       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746826181206       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746826181207       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746826181210       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746826181209       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746826181206       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+03 is 4.965349e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746826175842       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746826176998       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746826177137       residual = 5.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746826177176       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746826177180       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746826177222       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746826177182       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746826177183       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746826177198       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746826177184       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746826177170       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746826177181       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.5259e+04 is 1.241348e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1406e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030159e-01 3 1  ON 1
ci_003                -4.996654e-02 3 1  ON 2
ci_004                -5.097976e-02 3 1  ON 3
ci_005                 1.954881e-02 3 1  ON 4
ci_006                 1.991000e-02 3 1  ON 5
ci_007                 1.473758e-02 3 1  ON 6
ci_008                 1.564526e-02 3 1  ON 7
ci_009                -1.331667e-02 3 1  ON 8
ci_010                -1.213849e-02 3 1  ON 9
ci_011                -9.956758e-03 3 1  ON 10
ci_012                -9.107703e-03 3 1  ON 11
ci_013                 8.437996e-03 3 1  ON 12
ci_014                 9.447010e-03 3 1  ON 13
ci_015                 9.575698e-03 3 1  ON 14
ci_016                 9.511675e-03 3 1  ON 15
ci_017                 8.538195e-03 3 1  ON 16
ci_018                 8.364872e-03 3 1  ON 17
ci_019                -1.039949e-03 3 1  ON 18
ci_020                -1.340336e-03 3 1  ON 19
ci_021                -1.174244e-02 3 1  ON 20
ci_022                -1.169170e-02 3 1  ON 21
ci_023                 4.843376e-03 3 1  ON 22
ci_024                 4.944669e-03 3 1  ON 23
ci_025                 1.132052e-02 3 1  ON 24
ci_026                 1.141541e-02 3 1  ON 25
ci_027                 6.499823e-03 3 1  ON 26
ci_028                 6.245442e-03 3 1  ON 27
ci_029                -5.170543e-03 3 1  ON 28
ci_030                -4.217507e-03 3 1  ON 29
ci_031                 3.244146e-03 3 1  ON 30
ci_032                 4.393022e-03 3 1  ON 31
ci_033                 2.345177e-03 3 1  ON 32
ci_034                 4.175296e-03 3 1  ON 33
ci_035                 1.734741e-03 3 1  ON 34
ci_036                 2.193751e-03 3 1  ON 35
ci_037                 3.588251e-03 3 1  ON 36
ci_038                 3.702741e-03 3 1  ON 37
ci_039                 4.647584e-03 3 1  ON 38
ci_040                 4.988066e-03 3 1  ON 39
ci_041                 2.976335e-03 3 1  ON 40
ci_042                 2.735543e-03 3 1  ON 41
ci_043                 3.001486e-03 3 1  ON 42
ci_044                 3.197902e-03 3 1  ON 43
ci_045                 2.444169e-03 3 1  ON 44
ci_046                 2.684846e-03 3 1  ON 45
ci_047                -9.994621e-04 3 1  ON 46
ci_048                -8.375198e-04 3 1  ON 47
ci_049                 7.413921e-04 3 1  ON 48
ci_050                 1.074607e-03 3 1  ON 49
ci_051                -2.775623e-04 3 1  ON 50
ci_052                -1.208311e-03 3 1  ON 51
ci_053                -2.420420e-03 3 1  ON 52
ci_054                -2.639501e-03 3 1  ON 53
ci_055                -1.826597e-03 3 1  ON 54
ci_056                -1.960134e-03 3 1  ON 55
ci_057                -1.314471e-03 3 1  ON 56
ci_058                -9.790479e-04 3 1  ON 57
ci_059                -5.694076e-04 3 1  ON 58
ci_060                -7.765563e-04 3 1  ON 59
ci_061                -6.902203e-05 3 1  ON 60
ci_062                -9.470082e-04 3 1  ON 61
ci_063                -8.853260e-04 3 1  ON 62
ci_064                -5.148876e-04 3 1  ON 63
ci_065                -1.334432e-03 3 1  ON 64
ci_066                -1.932863e-03 3 1  ON 65
ci_067                -1.805282e-03 3 1  ON 66
ci_068                -1.576049e-03 3 1  ON 67
ci_069                -5.732381e-04 3 1  ON 68
ci_070                -4.401942e-04 3 1  ON 69
ci_071                -2.077568e-03 3 1  ON 70
ci_072                -1.995174e-03 3 1  ON 71
ci_073                 1.602637e-04 3 1  ON 72
ci_074                 2.017327e-04 3 1  ON 73
ci_075                 1.520701e-04 3 1  ON 74
ci_076                 8.315073e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.584
    reference variance = 0.270628
====================================================
  Execution time = 2.6385e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4814e-01
  Total weights = 1.9548e+06
  Execution time = 3.6123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805172441
                                         uncertainty =       0.002175527436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805172441
                                         uncertainty =       0.002175527436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468385093
  error estimate for blocks of size 2^( 2) =       0.000492347106
  error estimate for blocks of size 2^( 3) =       0.000514373370
  error estimate for blocks of size 2^( 4) =       0.000530083037
  error estimate for blocks of size 2^( 5) =       0.000540013591
  error estimate for blocks of size 2^( 6) =       0.000544334823
  error estimate for blocks of size 2^( 7) =       0.000544996330

      target function =      -0.746850138292
              le_mean =     -22.661196014598
             les_mean =     513.977948066320
             stat err =       0.000539856945
             autocorr =       1.328468486790
   target nu stat err =       0.000539856945
   target dn stat err =       0.002535904989
      target stat err =       0.002173674193
              std dev =       0.662396551148
             le_variance =       0.438769190972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805141252
                                         uncertainty =       0.002175528694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805141252
                                         uncertainty =       0.002175528694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468385077
  error estimate for blocks of size 2^( 2) =       0.000492347094
  error estimate for blocks of size 2^( 3) =       0.000514373362
  error estimate for blocks of size 2^( 4) =       0.000530083034
  error estimate for blocks of size 2^( 5) =       0.000540013589
  error estimate for blocks of size 2^( 6) =       0.000544334820
  error estimate for blocks of size 2^( 7) =       0.000544996331

      target function =      -0.746850162941
              le_mean =     -22.661196014686
             les_mean =     513.977948040366
             stat err =       0.000539856943
             autocorr =       1.328468570171
   target nu stat err =       0.000539856943
   target dn stat err =       0.002535906393
      target stat err =       0.002173675443
              std dev =       0.662396527702
             le_variance =       0.438769159911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805156845
                                         uncertainty =       0.002175528065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805156845
                                         uncertainty =       0.002175528065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468385085
  error estimate for blocks of size 2^( 2) =       0.000492347100
  error estimate for blocks of size 2^( 3) =       0.000514373366
  error estimate for blocks of size 2^( 4) =       0.000530083036
  error estimate for blocks of size 2^( 5) =       0.000540013590
  error estimate for blocks of size 2^( 6) =       0.000544334822
  error estimate for blocks of size 2^( 7) =       0.000544996330

      target function =      -0.746850150703
              le_mean =     -22.661196014642
             les_mean =     513.977948053232
             stat err =       0.000539856944
             autocorr =       1.328468528472
   target nu stat err =       0.000539856944
   target dn stat err =       0.002535905690
      target stat err =       0.002173674817
              std dev =       0.662396539423
             le_variance =       0.438769175440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805170491
                                         uncertainty =       0.002175527515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438805170491
                                         uncertainty =       0.002175527515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468385092
  error estimate for blocks of size 2^( 2) =       0.000492347105
  error estimate for blocks of size 2^( 3) =       0.000514373369
  error estimate for blocks of size 2^( 4) =       0.000530083037
  error estimate for blocks of size 2^( 5) =       0.000540013591
  error estimate for blocks of size 2^( 6) =       0.000544334823
  error estimate for blocks of size 2^( 7) =       0.000544996330

      target function =      -0.746850139853
              le_mean =     -22.661196014604
             les_mean =     513.977948064672
             stat err =       0.000539856945
             autocorr =       1.328468492004
   target nu stat err =       0.000539856945
   target dn stat err =       0.002535905077
      target stat err =       0.002173674271
              std dev =       0.662396549682
             le_variance =       0.438769189031


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746850138292        initial
     9.5367e+02     9.5367e+03             1.9861e-07        -0.746850162941  <--
     3.8147e+03     3.8147e+04             4.9653e-08        -0.746850150703
     1.5259e+04     1.5259e+05             1.2413e-08        -0.746850139853

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 4.4541e+01
  </log>
  <optVariables href="FORM2.s028.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996656e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954876e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331663e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956748e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438015e-03 3 1  ON 12
ci_014                 9.446954e-03 3 1  ON 13
ci_015                 9.575637e-03 3 1  ON 14
ci_016                 9.511635e-03 3 1  ON 15
ci_017                 8.538156e-03 3 1  ON 16
ci_018                 8.364781e-03 3 1  ON 17
ci_019                -1.040050e-03 3 1  ON 18
ci_020                -1.340459e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944676e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141548e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170463e-03 3 1  ON 28
ci_030                -4.217480e-03 3 1  ON 29
ci_031                 3.244236e-03 3 1  ON 30
ci_032                 4.393120e-03 3 1  ON 31
ci_033                 2.345209e-03 3 1  ON 32
ci_034                 4.175236e-03 3 1  ON 33
ci_035                 1.734774e-03 3 1  ON 34
ci_036                 2.193726e-03 3 1  ON 35
ci_037                 3.588196e-03 3 1  ON 36
ci_038                 3.702671e-03 3 1  ON 37
ci_039                 4.647470e-03 3 1  ON 38
ci_040                 4.988046e-03 3 1  ON 39
ci_041                 2.976339e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001557e-03 3 1  ON 42
ci_044                 3.197897e-03 3 1  ON 43
ci_045                 2.444173e-03 3 1  ON 44
ci_046                 2.684873e-03 3 1  ON 45
ci_047                -9.994646e-04 3 1  ON 46
ci_048                -8.375270e-04 3 1  ON 47
ci_049                 7.413399e-04 3 1  ON 48
ci_050                 1.074587e-03 3 1  ON 49
ci_051                -2.775481e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826582e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314461e-03 3 1  ON 56
ci_058                -9.790946e-04 3 1  ON 57
ci_059                -5.693734e-04 3 1  ON 58
ci_060                -7.765434e-04 3 1  ON 59
ci_061                -6.902086e-05 3 1  ON 60
ci_062                -9.469645e-04 3 1  ON 61
ci_063                -8.852762e-04 3 1  ON 62
ci_064                -5.148426e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932865e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576091e-03 3 1  ON 67
ci_069                -5.732172e-04 3 1  ON 68
ci_070                -4.401898e-04 3 1  ON 69
ci_071                -2.077524e-03 3 1  ON 70
ci_072                -1.995159e-03 3 1  ON 71
ci_073                 1.602371e-04 3 1  ON 72
ci_074                 2.017427e-04 3 1  ON 73
ci_075                 1.521059e-04 3 1  ON 74
ci_076                 8.314515e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5954e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.759
    reference variance = 0.417413
====================================================
  Execution time = 2.7070e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4826e-01
  Total weights = 1.955342017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438902106843
                                         uncertainty =       0.001935953808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438902106843
                                         uncertainty =       0.001935953808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468498295
  error estimate for blocks of size 2^( 2) =       0.000492438344
  error estimate for blocks of size 2^( 3) =       0.000514082787
  error estimate for blocks of size 2^( 4) =       0.000528740396
  error estimate for blocks of size 2^( 5) =       0.000537777229
  error estimate for blocks of size 2^( 6) =       0.000541437032
  error estimate for blocks of size 2^( 7) =       0.000546769600

      target function =      -0.746753773964
              le_mean =     -22.661637886309
             les_mean =     513.998095847957
             stat err =       0.000538681064
             autocorr =       1.322048507025
   target nu stat err =       0.000538681064
   target dn stat err =       0.002846706734
      target stat err =       0.002421742623
              std dev =       0.662556642319
             le_variance =       0.438981304282


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266163788631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746760779500       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746760865066       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746760875185       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746760876344       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746760876183       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746760876135       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746760876270       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746760876385       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746760876424       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746760876416       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746760876426       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+02 is 9.975793e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746760779500       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746760800894       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746760803424       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746760803714       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746760803674       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746760803662       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746760803694       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746760803723       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746760803736       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746760803732       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746760803732       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+02 is 2.494252e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746760779500       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746760784848       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746760785481       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746760785553       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746760785542       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746760785549       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746760785553       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746760785560       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746760785563       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746760785552       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746760785558       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+03 is 6.235819e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142828 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1851e+01
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_001                -7.054732e-01 3 1  ON 0
ci_002                -7.030161e-01 3 1  ON 1
ci_003                -4.996655e-02 3 1  ON 2
ci_004                -5.097965e-02 3 1  ON 3
ci_005                 1.954870e-02 3 1  ON 4
ci_006                 1.990985e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564524e-02 3 1  ON 7
ci_009                -1.331644e-02 3 1  ON 8
ci_010                -1.213837e-02 3 1  ON 9
ci_011                -9.956622e-03 3 1  ON 10
ci_012                -9.107622e-03 3 1  ON 11
ci_013                 8.437954e-03 3 1  ON 12
ci_014                 9.446835e-03 3 1  ON 13
ci_015                 9.575474e-03 3 1  ON 14
ci_016                 9.511550e-03 3 1  ON 15
ci_017                 8.538109e-03 3 1  ON 16
ci_018                 8.364698e-03 3 1  ON 17
ci_019                -1.040227e-03 3 1  ON 18
ci_020                -1.340567e-03 3 1  ON 19
ci_021                -1.174260e-02 3 1  ON 20
ci_022                -1.169204e-02 3 1  ON 21
ci_023                 4.843369e-03 3 1  ON 22
ci_024                 4.944663e-03 3 1  ON 23
ci_025                 1.132079e-02 3 1  ON 24
ci_026                 1.141547e-02 3 1  ON 25
ci_027                 6.499840e-03 3 1  ON 26
ci_028                 6.245459e-03 3 1  ON 27
ci_029                -5.170398e-03 3 1  ON 28
ci_030                -4.217453e-03 3 1  ON 29
ci_031                 3.244352e-03 3 1  ON 30
ci_032                 4.393273e-03 3 1  ON 31
ci_033                 2.345238e-03 3 1  ON 32
ci_034                 4.175181e-03 3 1  ON 33
ci_035                 1.734761e-03 3 1  ON 34
ci_036                 2.193723e-03 3 1  ON 35
ci_037                 3.588210e-03 3 1  ON 36
ci_038                 3.702582e-03 3 1  ON 37
ci_039                 4.647441e-03 3 1  ON 38
ci_040                 4.987982e-03 3 1  ON 39
ci_041                 2.976334e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001494e-03 3 1  ON 42
ci_044                 3.197889e-03 3 1  ON 43
ci_045                 2.444186e-03 3 1  ON 44
ci_046                 2.684935e-03 3 1  ON 45
ci_047                -9.994711e-04 3 1  ON 46
ci_048                -8.375504e-04 3 1  ON 47
ci_049                 7.414074e-04 3 1  ON 48
ci_050                 1.074541e-03 3 1  ON 49
ci_051                -2.776687e-04 3 1  ON 50
ci_052                -1.208287e-03 3 1  ON 51
ci_053                -2.420284e-03 3 1  ON 52
ci_054                -2.639451e-03 3 1  ON 53
ci_055                -1.826537e-03 3 1  ON 54
ci_056                -1.960011e-03 3 1  ON 55
ci_057                -1.314490e-03 3 1  ON 56
ci_058                -9.791027e-04 3 1  ON 57
ci_059                -5.694043e-04 3 1  ON 58
ci_060                -7.765013e-04 3 1  ON 59
ci_061                -6.906618e-05 3 1  ON 60
ci_062                -9.468998e-04 3 1  ON 61
ci_063                -8.852699e-04 3 1  ON 62
ci_064                -5.148498e-04 3 1  ON 63
ci_065                -1.334434e-03 3 1  ON 64
ci_066                -1.932896e-03 3 1  ON 65
ci_067                -1.805289e-03 3 1  ON 66
ci_068                -1.576095e-03 3 1  ON 67
ci_069                -5.731753e-04 3 1  ON 68
ci_070                -4.401533e-04 3 1  ON 69
ci_071                -2.077501e-03 3 1  ON 70
ci_072                -1.995210e-03 3 1  ON 71
ci_073                 1.602103e-04 3 1  ON 72
ci_074                 2.017264e-04 3 1  ON 73
ci_075                 1.520623e-04 3 1  ON 74
ci_076                 8.314625e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.593
    reference variance = 0.473953
====================================================
  Execution time = 2.6187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5497e-01
  Total weights = 1.9551e+06
  Execution time = 3.7079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441833354679
                                         uncertainty =       0.002261611589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441833354679
                                         uncertainty =       0.002261611589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470016564
  error estimate for blocks of size 2^( 2) =       0.000494079697
  error estimate for blocks of size 2^( 3) =       0.000516061804
  error estimate for blocks of size 2^( 4) =       0.000531785091
  error estimate for blocks of size 2^( 5) =       0.000540123110
  error estimate for blocks of size 2^( 6) =       0.000544021547
  error estimate for blocks of size 2^( 7) =       0.000546561397

      target function =      -0.741262096199
              le_mean =     -22.661792775550
             les_mean =     514.011816335126
             stat err =       0.000540622786
             autocorr =       1.323007684789
   target nu stat err =       0.000540622786
   target dn stat err =       0.004042516275
      target stat err =       0.003338647472
              std dev =       0.664703799020
             le_variance =       0.441831140432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441832885113
                                         uncertainty =       0.002261526911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441832885113
                                         uncertainty =       0.002261526911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470016314
  error estimate for blocks of size 2^( 2) =       0.000494079473
  error estimate for blocks of size 2^( 3) =       0.000516061604
  error estimate for blocks of size 2^( 4) =       0.000531784912
  error estimate for blocks of size 2^( 5) =       0.000540122952
  error estimate for blocks of size 2^( 6) =       0.000544021377
  error estimate for blocks of size 2^( 7) =       0.000546561228

      target function =      -0.741260557101
              le_mean =     -22.661792762806
             les_mean =     514.011817640008
             stat err =       0.000540622617
             autocorr =       1.323008261850
   target nu stat err =       0.000540622617
   target dn stat err =       0.004043783339
      target stat err =       0.003339647232
              std dev =       0.664703446354
             le_variance =       0.441830671596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441833119822
                                         uncertainty =       0.002261569232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441833119822
                                         uncertainty =       0.002261569232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470016439
  error estimate for blocks of size 2^( 2) =       0.000494079585
  error estimate for blocks of size 2^( 3) =       0.000516061704
  error estimate for blocks of size 2^( 4) =       0.000531785002
  error estimate for blocks of size 2^( 5) =       0.000540123031
  error estimate for blocks of size 2^( 6) =       0.000544021462
  error estimate for blocks of size 2^( 7) =       0.000546561313

      target function =      -0.741261327479
              le_mean =     -22.661792769174
             les_mean =     514.011816986387
             stat err =       0.000540622702
             autocorr =       1.323007973396
   target nu stat err =       0.000540622702
   target dn stat err =       0.004043149712
      target stat err =       0.003339147283
              std dev =       0.664703622632
             le_variance =       0.441830905940

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441833325316
                                         uncertainty =       0.002261606293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441833325316
                                         uncertainty =       0.002261606293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470016548
  error estimate for blocks of size 2^( 2) =       0.000494079683
  error estimate for blocks of size 2^( 3) =       0.000516061792
  error estimate for blocks of size 2^( 4) =       0.000531785080
  error estimate for blocks of size 2^( 5) =       0.000540123100
  error estimate for blocks of size 2^( 6) =       0.000544021536
  error estimate for blocks of size 2^( 7) =       0.000546561387

      target function =      -0.741262000211
              le_mean =     -22.661792774752
             les_mean =     514.011816416394
             stat err =       0.000540622776
             autocorr =       1.323007720860
   target nu stat err =       0.000540622776
   target dn stat err =       0.004042595434
      target stat err =       0.003338709933
              std dev =       0.664703776967
             le_variance =       0.441831111115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741262096199        initial  <--
     2.3842e+02     2.3842e+03             9.9758e-07        -0.741260557101
     9.5367e+02     9.5367e+03             2.4943e-07        -0.741261327479
     3.8147e+03     3.8147e+04             6.2358e-08        -0.741262000211

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3858
  </log>
  <optVariables href="FORM2.s029.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996656e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954876e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331663e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956748e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438015e-03 3 1  ON 12
ci_014                 9.446954e-03 3 1  ON 13
ci_015                 9.575637e-03 3 1  ON 14
ci_016                 9.511635e-03 3 1  ON 15
ci_017                 8.538156e-03 3 1  ON 16
ci_018                 8.364781e-03 3 1  ON 17
ci_019                -1.040050e-03 3 1  ON 18
ci_020                -1.340459e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944676e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141548e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170463e-03 3 1  ON 28
ci_030                -4.217480e-03 3 1  ON 29
ci_031                 3.244236e-03 3 1  ON 30
ci_032                 4.393120e-03 3 1  ON 31
ci_033                 2.345209e-03 3 1  ON 32
ci_034                 4.175236e-03 3 1  ON 33
ci_035                 1.734774e-03 3 1  ON 34
ci_036                 2.193726e-03 3 1  ON 35
ci_037                 3.588196e-03 3 1  ON 36
ci_038                 3.702671e-03 3 1  ON 37
ci_039                 4.647470e-03 3 1  ON 38
ci_040                 4.988046e-03 3 1  ON 39
ci_041                 2.976339e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001557e-03 3 1  ON 42
ci_044                 3.197897e-03 3 1  ON 43
ci_045                 2.444173e-03 3 1  ON 44
ci_046                 2.684873e-03 3 1  ON 45
ci_047                -9.994646e-04 3 1  ON 46
ci_048                -8.375270e-04 3 1  ON 47
ci_049                 7.413399e-04 3 1  ON 48
ci_050                 1.074587e-03 3 1  ON 49
ci_051                -2.775481e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826582e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314461e-03 3 1  ON 56
ci_058                -9.790946e-04 3 1  ON 57
ci_059                -5.693734e-04 3 1  ON 58
ci_060                -7.765434e-04 3 1  ON 59
ci_061                -6.902086e-05 3 1  ON 60
ci_062                -9.469645e-04 3 1  ON 61
ci_063                -8.852762e-04 3 1  ON 62
ci_064                -5.148426e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932865e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576091e-03 3 1  ON 67
ci_069                -5.732172e-04 3 1  ON 68
ci_070                -4.401898e-04 3 1  ON 69
ci_071                -2.077524e-03 3 1  ON 70
ci_072                -1.995159e-03 3 1  ON 71
ci_073                 1.602371e-04 3 1  ON 72
ci_074                 2.017427e-04 3 1  ON 73
ci_075                 1.521059e-04 3 1  ON 74
ci_076                 8.314515e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6253
    reference variance = 0.437745
====================================================
  Execution time = 2.6719e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4945e-01
  Total weights = 1.955518802e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440403870417
                                         uncertainty =       0.002354498967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440403870417
                                         uncertainty =       0.002354498967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469224655
  error estimate for blocks of size 2^( 2) =       0.000493023139
  error estimate for blocks of size 2^( 3) =       0.000514840297
  error estimate for blocks of size 2^( 4) =       0.000531051606
  error estimate for blocks of size 2^( 5) =       0.000540018915
  error estimate for blocks of size 2^( 6) =       0.000544078533
  error estimate for blocks of size 2^( 7) =       0.000547720995

      target function =      -0.745779851530
              le_mean =     -22.661970928838
             les_mean =     514.014377049500
             stat err =       0.000540717512
             autocorr =       1.327942353713
   target nu stat err =       0.000540717512
   target dn stat err =       0.002818114663
      target stat err =       0.002394569914
              std dev =       0.663583871332
             le_variance =       0.440343554292


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266197092884e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745786668972       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745786675667       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745786676663       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745786676845       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745786676833       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745786676830       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745786676828       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745786676828       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745786676834       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+03 is 1.073859e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745786668972       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745786670645       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745786670895       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745786670940       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745786670945       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745786670945       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745786670937       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745786670947       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745786670895       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+03 is 2.684679e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745786668972       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745786669390       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745786669452       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745786669468       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745786669463       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745786669449       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745786669462       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745786669551       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745786669414       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+04 is 6.711719e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1449e+01
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996656e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564527e-02 3 1  ON 7
ci_009                -1.331661e-02 3 1  ON 8
ci_010                -1.213845e-02 3 1  ON 9
ci_011                -9.956749e-03 3 1  ON 10
ci_012                -9.107644e-03 3 1  ON 11
ci_013                 8.438004e-03 3 1  ON 12
ci_014                 9.446940e-03 3 1  ON 13
ci_015                 9.575627e-03 3 1  ON 14
ci_016                 9.511631e-03 3 1  ON 15
ci_017                 8.538156e-03 3 1  ON 16
ci_018                 8.364778e-03 3 1  ON 17
ci_019                -1.040059e-03 3 1  ON 18
ci_020                -1.340486e-03 3 1  ON 19
ci_021                -1.174247e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843388e-03 3 1  ON 22
ci_024                 4.944671e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499820e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170457e-03 3 1  ON 28
ci_030                -4.217480e-03 3 1  ON 29
ci_031                 3.244246e-03 3 1  ON 30
ci_032                 4.393126e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175230e-03 3 1  ON 33
ci_035                 1.734775e-03 3 1  ON 34
ci_036                 2.193718e-03 3 1  ON 35
ci_037                 3.588186e-03 3 1  ON 36
ci_038                 3.702668e-03 3 1  ON 37
ci_039                 4.647464e-03 3 1  ON 38
ci_040                 4.988039e-03 3 1  ON 39
ci_041                 2.976337e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001553e-03 3 1  ON 42
ci_044                 3.197895e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684867e-03 3 1  ON 45
ci_047                -9.994665e-04 3 1  ON 46
ci_048                -8.375318e-04 3 1  ON 47
ci_049                 7.413474e-04 3 1  ON 48
ci_050                 1.074582e-03 3 1  ON 49
ci_051                -2.775475e-04 3 1  ON 50
ci_052                -1.208314e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639460e-03 3 1  ON 53
ci_055                -1.826579e-03 3 1  ON 54
ci_056                -1.960087e-03 3 1  ON 55
ci_057                -1.314459e-03 3 1  ON 56
ci_058                -9.790961e-04 3 1  ON 57
ci_059                -5.693728e-04 3 1  ON 58
ci_060                -7.765439e-04 3 1  ON 59
ci_061                -6.902346e-05 3 1  ON 60
ci_062                -9.469662e-04 3 1  ON 61
ci_063                -8.852806e-04 3 1  ON 62
ci_064                -5.148384e-04 3 1  ON 63
ci_065                -1.334473e-03 3 1  ON 64
ci_066                -1.932864e-03 3 1  ON 65
ci_067                -1.805292e-03 3 1  ON 66
ci_068                -1.576092e-03 3 1  ON 67
ci_069                -5.732218e-04 3 1  ON 68
ci_070                -4.401850e-04 3 1  ON 69
ci_071                -2.077522e-03 3 1  ON 70
ci_072                -1.995165e-03 3 1  ON 71
ci_073                 1.602322e-04 3 1  ON 72
ci_074                 2.017454e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314493e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.6728
    reference variance = 0.348843
====================================================
  Execution time = 2.5837e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5109e-01
  Total weights = 1.9555e+06
  Execution time = 3.6084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440005409117
                                         uncertainty =       0.002154518025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440005409117
                                         uncertainty =       0.002154518025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469061562
  error estimate for blocks of size 2^( 2) =       0.000493396920
  error estimate for blocks of size 2^( 3) =       0.000515772848
  error estimate for blocks of size 2^( 4) =       0.000532495791
  error estimate for blocks of size 2^( 5) =       0.000542305169
  error estimate for blocks of size 2^( 6) =       0.000544475205
  error estimate for blocks of size 2^( 7) =       0.000546272720

      target function =      -0.744437845935
              le_mean =     -22.662873650632
             les_mean =     514.056933185685
             stat err =       0.000541387221
             autocorr =       1.332159757759
   target nu stat err =       0.000541387221
   target dn stat err =       0.002871159470
      target stat err =       0.002431798333
              std dev =       0.663353222331
             le_variance =       0.440037497576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440005397012
                                         uncertainty =       0.002154519621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440005397012
                                         uncertainty =       0.002154519621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469061555
  error estimate for blocks of size 2^( 2) =       0.000493396915
  error estimate for blocks of size 2^( 3) =       0.000515772845
  error estimate for blocks of size 2^( 4) =       0.000532495789
  error estimate for blocks of size 2^( 5) =       0.000542305169
  error estimate for blocks of size 2^( 6) =       0.000544475202
  error estimate for blocks of size 2^( 7) =       0.000546272718

      target function =      -0.744437759550
              le_mean =     -22.662873649544
             les_mean =     514.056933241355
             stat err =       0.000541387219
             autocorr =       1.332159786254
   target nu stat err =       0.000541387219
   target dn stat err =       0.002871192421
      target stat err =       0.002431824008
              std dev =       0.663353213173
             le_variance =       0.440037485426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440005403064
                                         uncertainty =       0.002154518823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440005403064
                                         uncertainty =       0.002154518823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469061559
  error estimate for blocks of size 2^( 2) =       0.000493396918
  error estimate for blocks of size 2^( 3) =       0.000515772847
  error estimate for blocks of size 2^( 4) =       0.000532495790
  error estimate for blocks of size 2^( 5) =       0.000542305169
  error estimate for blocks of size 2^( 6) =       0.000544475203
  error estimate for blocks of size 2^( 7) =       0.000546272719

      target function =      -0.744437802779
              le_mean =     -22.662873650088
             les_mean =     514.056933213475
             stat err =       0.000541387220
             autocorr =       1.332159772006
   target nu stat err =       0.000541387220
   target dn stat err =       0.002871175945
      target stat err =       0.002431811171
              std dev =       0.663353217752
             le_variance =       0.440037491501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440005408360
                                         uncertainty =       0.002154518125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440005408360
                                         uncertainty =       0.002154518125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469061561
  error estimate for blocks of size 2^( 2) =       0.000493396919
  error estimate for blocks of size 2^( 3) =       0.000515772848
  error estimate for blocks of size 2^( 4) =       0.000532495791
  error estimate for blocks of size 2^( 5) =       0.000542305169
  error estimate for blocks of size 2^( 6) =       0.000544475204
  error estimate for blocks of size 2^( 7) =       0.000546272719

      target function =      -0.744437840545
              le_mean =     -22.662873650564
             les_mean =     514.056933189154
             stat err =       0.000541387221
             autocorr =       1.332159759543
   target nu stat err =       0.000541387221
   target dn stat err =       0.002871161529
      target stat err =       0.002431799938
              std dev =       0.663353221758
             le_variance =       0.440037496817


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744437845935        initial  <--
     2.3842e+03     2.3842e+04             1.0739e-07        -0.744437759550
     9.5367e+03     9.5367e+04             2.6847e-08        -0.744437802779
     3.8147e+04     3.8147e+05             6.7117e-09        -0.744437840545

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0719
  </log>
  <optVariables href="FORM2.s030.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996656e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954876e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331663e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956748e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438015e-03 3 1  ON 12
ci_014                 9.446954e-03 3 1  ON 13
ci_015                 9.575637e-03 3 1  ON 14
ci_016                 9.511635e-03 3 1  ON 15
ci_017                 8.538156e-03 3 1  ON 16
ci_018                 8.364781e-03 3 1  ON 17
ci_019                -1.040050e-03 3 1  ON 18
ci_020                -1.340459e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944676e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141548e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170463e-03 3 1  ON 28
ci_030                -4.217480e-03 3 1  ON 29
ci_031                 3.244236e-03 3 1  ON 30
ci_032                 4.393120e-03 3 1  ON 31
ci_033                 2.345209e-03 3 1  ON 32
ci_034                 4.175236e-03 3 1  ON 33
ci_035                 1.734774e-03 3 1  ON 34
ci_036                 2.193726e-03 3 1  ON 35
ci_037                 3.588196e-03 3 1  ON 36
ci_038                 3.702671e-03 3 1  ON 37
ci_039                 4.647470e-03 3 1  ON 38
ci_040                 4.988046e-03 3 1  ON 39
ci_041                 2.976339e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001557e-03 3 1  ON 42
ci_044                 3.197897e-03 3 1  ON 43
ci_045                 2.444173e-03 3 1  ON 44
ci_046                 2.684873e-03 3 1  ON 45
ci_047                -9.994646e-04 3 1  ON 46
ci_048                -8.375270e-04 3 1  ON 47
ci_049                 7.413399e-04 3 1  ON 48
ci_050                 1.074587e-03 3 1  ON 49
ci_051                -2.775481e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826582e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314461e-03 3 1  ON 56
ci_058                -9.790946e-04 3 1  ON 57
ci_059                -5.693734e-04 3 1  ON 58
ci_060                -7.765434e-04 3 1  ON 59
ci_061                -6.902086e-05 3 1  ON 60
ci_062                -9.469645e-04 3 1  ON 61
ci_063                -8.852762e-04 3 1  ON 62
ci_064                -5.148426e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932865e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576091e-03 3 1  ON 67
ci_069                -5.732172e-04 3 1  ON 68
ci_070                -4.401898e-04 3 1  ON 69
ci_071                -2.077524e-03 3 1  ON 70
ci_072                -1.995159e-03 3 1  ON 71
ci_073                 1.602371e-04 3 1  ON 72
ci_074                 2.017427e-04 3 1  ON 73
ci_075                 1.521059e-04 3 1  ON 74
ci_076                 8.314515e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5528e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2662e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.5737
    reference variance = 0.407865
====================================================
  Execution time = 2.6595e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5025e-01
  Total weights = 1.954974015e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441757994375
                                         uncertainty =       0.002555797985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441757994375
                                         uncertainty =       0.002555797985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469962626
  error estimate for blocks of size 2^( 2) =       0.000493715166
  error estimate for blocks of size 2^( 3) =       0.000515932493
  error estimate for blocks of size 2^( 4) =       0.000531820648
  error estimate for blocks of size 2^( 5) =       0.000540353747
  error estimate for blocks of size 2^( 6) =       0.000544470987
  error estimate for blocks of size 2^( 7) =       0.000547494056

      target function =      -0.745116987862
              le_mean =     -22.661744266082
             les_mean =     514.004904618442
             stat err =       0.000541034859
             autocorr =       1.325329462470
   target nu stat err =       0.000541034859
   target dn stat err =       0.003292618928
      target stat err =       0.002768775488
              std dev =       0.664627519110
             le_variance =       0.441729739158


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266174426608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745126435070       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745126435884       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745126436015       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745126436026       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745126436027       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745126436037       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745126436029       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745126435995       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745126436022       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745126436029       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745126436000       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+04 is 9.675748e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745126435070       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745126435273       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745126435306       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745126435233       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745126435306       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745126435223       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745126435526       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745126435147       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745126435359       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745126435463       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745126435436       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+04 is 2.418940e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745126435070       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745126435121       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745126435129       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745126435130       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745126435020       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745126434495       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745126435015       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745126435524       residual = 7.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745126434372       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745126434622       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745126434328       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.8147e+05 is 6.047351e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1314e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996656e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954876e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331663e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956746e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438014e-03 3 1  ON 12
ci_014                 9.446954e-03 3 1  ON 13
ci_015                 9.575637e-03 3 1  ON 14
ci_016                 9.511634e-03 3 1  ON 15
ci_017                 8.538157e-03 3 1  ON 16
ci_018                 8.364780e-03 3 1  ON 17
ci_019                -1.040053e-03 3 1  ON 18
ci_020                -1.340460e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944676e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141548e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170462e-03 3 1  ON 28
ci_030                -4.217479e-03 3 1  ON 29
ci_031                 3.244237e-03 3 1  ON 30
ci_032                 4.393120e-03 3 1  ON 31
ci_033                 2.345209e-03 3 1  ON 32
ci_034                 4.175235e-03 3 1  ON 33
ci_035                 1.734774e-03 3 1  ON 34
ci_036                 2.193726e-03 3 1  ON 35
ci_037                 3.588197e-03 3 1  ON 36
ci_038                 3.702671e-03 3 1  ON 37
ci_039                 4.647469e-03 3 1  ON 38
ci_040                 4.988045e-03 3 1  ON 39
ci_041                 2.976338e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001556e-03 3 1  ON 42
ci_044                 3.197896e-03 3 1  ON 43
ci_045                 2.444173e-03 3 1  ON 44
ci_046                 2.684873e-03 3 1  ON 45
ci_047                -9.994639e-04 3 1  ON 46
ci_048                -8.375269e-04 3 1  ON 47
ci_049                 7.413394e-04 3 1  ON 48
ci_050                 1.074587e-03 3 1  ON 49
ci_051                -2.775483e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826581e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314461e-03 3 1  ON 56
ci_058                -9.790942e-04 3 1  ON 57
ci_059                -5.693731e-04 3 1  ON 58
ci_060                -7.765434e-04 3 1  ON 59
ci_061                -6.902055e-05 3 1  ON 60
ci_062                -9.469636e-04 3 1  ON 61
ci_063                -8.852759e-04 3 1  ON 62
ci_064                -5.148429e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932865e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732172e-04 3 1  ON 68
ci_070                -4.401894e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995160e-03 3 1  ON 71
ci_073                 1.602367e-04 3 1  ON 72
ci_074                 2.017431e-04 3 1  ON 73
ci_075                 1.521056e-04 3 1  ON 74
ci_076                 8.314510e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.5999
    reference variance = 0.61637
====================================================
  Execution time = 2.7751e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4584e-01
  Total weights = 1.9554e+06
  Execution time = 3.6077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437269553470
                                         uncertainty =       0.002342364103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437269553470
                                         uncertainty =       0.002342364103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467630311
  error estimate for blocks of size 2^( 2) =       0.000491715462
  error estimate for blocks of size 2^( 3) =       0.000514046654
  error estimate for blocks of size 2^( 4) =       0.000530219550
  error estimate for blocks of size 2^( 5) =       0.000539711391
  error estimate for blocks of size 2^( 6) =       0.000545090537
  error estimate for blocks of size 2^( 7) =       0.000545748839

      target function =      -0.748759773396
              le_mean =     -22.661865703526
             les_mean =     514.006000966488
             stat err =       0.000540192579
             autocorr =       1.334418087261
   target nu stat err =       0.000540192579
   target dn stat err =       0.002529338226
      target stat err =       0.002181414334
              std dev =       0.661329128462
             le_variance =       0.437356216152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437269551007
                                         uncertainty =       0.002342363933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437269551007
                                         uncertainty =       0.002342363933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467630310
  error estimate for blocks of size 2^( 2) =       0.000491715461
  error estimate for blocks of size 2^( 3) =       0.000514046653
  error estimate for blocks of size 2^( 4) =       0.000530219549
  error estimate for blocks of size 2^( 5) =       0.000539711390
  error estimate for blocks of size 2^( 6) =       0.000545090536
  error estimate for blocks of size 2^( 7) =       0.000545748838

      target function =      -0.748759776387
              le_mean =     -22.661865703515
             les_mean =     514.006000962380
             stat err =       0.000540192578
             autocorr =       1.334418089520
   target nu stat err =       0.000540192578
   target dn stat err =       0.002529337336
      target stat err =       0.002181413641
              std dev =       0.661329126598
             le_variance =       0.437356213687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437269552238
                                         uncertainty =       0.002342364018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437269552238
                                         uncertainty =       0.002342364018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467630311
  error estimate for blocks of size 2^( 2) =       0.000491715461
  error estimate for blocks of size 2^( 3) =       0.000514046653
  error estimate for blocks of size 2^( 4) =       0.000530219550
  error estimate for blocks of size 2^( 5) =       0.000539711390
  error estimate for blocks of size 2^( 6) =       0.000545090536
  error estimate for blocks of size 2^( 7) =       0.000545748838

      target function =      -0.748759774892
              le_mean =     -22.661865703520
             les_mean =     514.006000964434
             stat err =       0.000540192579
             autocorr =       1.334418088400
   target nu stat err =       0.000540192579
   target dn stat err =       0.002529337781
      target stat err =       0.002181413987
              std dev =       0.661329127530
             le_variance =       0.437356214920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437269553316
                                         uncertainty =       0.002342364093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437269553316
                                         uncertainty =       0.002342364093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467630311
  error estimate for blocks of size 2^( 2) =       0.000491715462
  error estimate for blocks of size 2^( 3) =       0.000514046654
  error estimate for blocks of size 2^( 4) =       0.000530219550
  error estimate for blocks of size 2^( 5) =       0.000539711391
  error estimate for blocks of size 2^( 6) =       0.000545090537
  error estimate for blocks of size 2^( 7) =       0.000545748839

      target function =      -0.748759773583
              le_mean =     -22.661865703525
             les_mean =     514.006000966231
             stat err =       0.000540192579
             autocorr =       1.334418087396
   target nu stat err =       0.000540192579
   target dn stat err =       0.002529338170
      target stat err =       0.002181414291
              std dev =       0.661329128346
             le_variance =       0.437356215998


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748759773396        initial
     2.3842e+04     2.3842e+05             9.6757e-09        -0.748759776387  <--
     9.5367e+04     9.5367e+05             2.4189e-09        -0.748759774892
     3.8147e+05     3.8147e+06             6.0474e-10        -0.748759773583

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 4.5867e+01
  </log>
  <optVariables href="FORM2.s031.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438013e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244241e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420272e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901965e-05 3 1  ON 60
ci_062                -9.469610e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401883e-04 3 1  ON 69
ci_071                -2.077526e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314495e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7188e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6422
    reference variance = 0.429725
====================================================
  Execution time = 2.6815e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5258e-01
  Total weights = 1.955448818e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443400463162
                                         uncertainty =       0.002550452445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443400463162
                                         uncertainty =       0.002550452445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470811737
  error estimate for blocks of size 2^( 2) =       0.000494795613
  error estimate for blocks of size 2^( 3) =       0.000517146961
  error estimate for blocks of size 2^( 4) =       0.000532840177
  error estimate for blocks of size 2^( 5) =       0.000542983257
  error estimate for blocks of size 2^( 6) =       0.000546633228
  error estimate for blocks of size 2^( 7) =       0.000550660989

      target function =      -0.743203809473
              le_mean =     -22.661058763974
             les_mean =     513.976165340053
             stat err =       0.000543279413
             autocorr =       1.331532998910
   target nu stat err =       0.000543279413
   target dn stat err =       0.003493166620
      target stat err =       0.002912650596
              std dev =       0.665828344339
             le_variance =       0.443327384125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266105876397e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743214157355       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743214160471       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743214160809       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743214160878       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743214160887       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743214160902       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743214160891       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743214160902       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743214160904       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743214160908       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743214160885       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+03 is 3.472509e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743214157355       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743214158134       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743214158218       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743214158236       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743214158237       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743214158241       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743214158240       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743214158207       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743214158263       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743214158260       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743214158232       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+04 is 8.681317e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743214157355       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743214157550       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743214157571       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743214157575       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743214157596       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743214157538       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743214157399       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743214157542       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743214157577       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743214157577       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743214157600       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+04 is 2.170332e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154198 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1536e+01
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213845e-02 3 1  ON 9
ci_011                -9.956733e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438013e-03 3 1  ON 12
ci_014                 9.446949e-03 3 1  ON 13
ci_015                 9.575634e-03 3 1  ON 14
ci_016                 9.511629e-03 3 1  ON 15
ci_017                 8.538156e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040066e-03 3 1  ON 18
ci_020                -1.340470e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843384e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141550e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245470e-03 3 1  ON 27
ci_029                -5.170461e-03 3 1  ON 28
ci_030                -4.217479e-03 3 1  ON 29
ci_031                 3.244247e-03 3 1  ON 30
ci_032                 4.393124e-03 3 1  ON 31
ci_033                 2.345207e-03 3 1  ON 32
ci_034                 4.175232e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193724e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702669e-03 3 1  ON 37
ci_039                 4.647464e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976333e-03 3 1  ON 40
ci_042                 2.735571e-03 3 1  ON 41
ci_043                 3.001554e-03 3 1  ON 42
ci_044                 3.197893e-03 3 1  ON 43
ci_045                 2.444173e-03 3 1  ON 44
ci_046                 2.684871e-03 3 1  ON 45
ci_047                -9.994614e-04 3 1  ON 46
ci_048                -8.375249e-04 3 1  ON 47
ci_049                 7.413378e-04 3 1  ON 48
ci_050                 1.074587e-03 3 1  ON 49
ci_051                -2.775512e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420276e-03 3 1  ON 52
ci_054                -2.639464e-03 3 1  ON 53
ci_055                -1.826581e-03 3 1  ON 54
ci_056                -1.960093e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693706e-04 3 1  ON 58
ci_060                -7.765436e-04 3 1  ON 59
ci_061                -6.902053e-05 3 1  ON 60
ci_062                -9.469625e-04 3 1  ON 61
ci_063                -8.852734e-04 3 1  ON 62
ci_064                -5.148408e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805296e-03 3 1  ON 66
ci_068                -1.576089e-03 3 1  ON 67
ci_069                -5.732132e-04 3 1  ON 68
ci_070                -4.401900e-04 3 1  ON 69
ci_071                -2.077522e-03 3 1  ON 70
ci_072                -1.995159e-03 3 1  ON 71
ci_073                 1.602348e-04 3 1  ON 72
ci_074                 2.017429e-04 3 1  ON 73
ci_075                 1.521043e-04 3 1  ON 74
ci_076                 8.314504e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.6348
    reference variance = 0.43887
====================================================
  Execution time = 2.5715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5228e-01
  Total weights = 1.9555e+06
  Execution time = 3.6162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443209213086
                                         uncertainty =       0.002740870274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443209213086
                                         uncertainty =       0.002740870274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470735473
  error estimate for blocks of size 2^( 2) =       0.000494800978
  error estimate for blocks of size 2^( 3) =       0.000517544700
  error estimate for blocks of size 2^( 4) =       0.000533424602
  error estimate for blocks of size 2^( 5) =       0.000541980238
  error estimate for blocks of size 2^( 6) =       0.000545603259
  error estimate for blocks of size 2^( 7) =       0.000547567565

      target function =      -0.743455346373
              le_mean =     -22.662062621976
             les_mean =     514.021366240498
             stat err =       0.000542143916
             autocorr =       1.326402474442
   target nu stat err =       0.000542143916
   target dn stat err =       0.002981944972
      target stat err =       0.002510794704
              std dev =       0.665720490679
             le_variance =       0.443183771710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443209203894
                                         uncertainty =       0.002740869399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443209203894
                                         uncertainty =       0.002740869399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470735468
  error estimate for blocks of size 2^( 2) =       0.000494800974
  error estimate for blocks of size 2^( 3) =       0.000517544697
  error estimate for blocks of size 2^( 4) =       0.000533424599
  error estimate for blocks of size 2^( 5) =       0.000541980236
  error estimate for blocks of size 2^( 6) =       0.000545603257
  error estimate for blocks of size 2^( 7) =       0.000547567564

      target function =      -0.743455240009
              le_mean =     -22.662062622069
             les_mean =     514.021366374773
             stat err =       0.000542143914
             autocorr =       1.326402490474
   target nu stat err =       0.000542143914
   target dn stat err =       0.002981944228
      target stat err =       0.002510793414
              std dev =       0.665720483800
             le_variance =       0.443183762551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443209208490
                                         uncertainty =       0.002740869837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443209208490
                                         uncertainty =       0.002740869837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470735471
  error estimate for blocks of size 2^( 2) =       0.000494800976
  error estimate for blocks of size 2^( 3) =       0.000517544699
  error estimate for blocks of size 2^( 4) =       0.000533424600
  error estimate for blocks of size 2^( 5) =       0.000541980237
  error estimate for blocks of size 2^( 6) =       0.000545603258
  error estimate for blocks of size 2^( 7) =       0.000547567564

      target function =      -0.743455293272
              le_mean =     -22.662062622022
             les_mean =     514.021366307536
             stat err =       0.000542143915
             autocorr =       1.326402482460
   target nu stat err =       0.000542143915
   target dn stat err =       0.002981944599
      target stat err =       0.002510794058
              std dev =       0.665720487239
             le_variance =       0.443183767130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443209212511
                                         uncertainty =       0.002740870220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443209212511
                                         uncertainty =       0.002740870220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470735473
  error estimate for blocks of size 2^( 2) =       0.000494800978
  error estimate for blocks of size 2^( 3) =       0.000517544700
  error estimate for blocks of size 2^( 4) =       0.000533424601
  error estimate for blocks of size 2^( 5) =       0.000541980238
  error estimate for blocks of size 2^( 6) =       0.000545603259
  error estimate for blocks of size 2^( 7) =       0.000547567565

      target function =      -0.743455339744
              le_mean =     -22.662062621982
             les_mean =     514.021366248867
             stat err =       0.000542143916
             autocorr =       1.326402475450
   target nu stat err =       0.000542143916
   target dn stat err =       0.002981944926
      target stat err =       0.002510794623
              std dev =       0.665720490249
             le_variance =       0.443183771137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743455346373        initial  <--
     5.9605e+03     5.9605e+04             3.4725e-08        -0.743455240009
     2.3842e+04     2.3842e+05             8.6813e-09        -0.743455293272
     9.5367e+04     9.5367e+05             2.1703e-09        -0.743455339744

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.9132
  </log>
  <optVariables href="FORM2.s032.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438013e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244241e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420272e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901965e-05 3 1  ON 60
ci_062                -9.469610e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401883e-04 3 1  ON 69
ci_071                -2.077526e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314495e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.5913
    reference variance = 0.270228
====================================================
  Execution time = 2.6894e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5480e-01
  Total weights = 1.955331132e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442209168979
                                         uncertainty =       0.002386837858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442209168979
                                         uncertainty =       0.002386837858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470237508
  error estimate for blocks of size 2^( 2) =       0.000494157770
  error estimate for blocks of size 2^( 3) =       0.000516030056
  error estimate for blocks of size 2^( 4) =       0.000531888849
  error estimate for blocks of size 2^( 5) =       0.000542129222
  error estimate for blocks of size 2^( 6) =       0.000548007072
  error estimate for blocks of size 2^( 7) =       0.000550428205

      target function =      -0.741401558340
              le_mean =     -22.662057538529
             les_mean =     514.023650436335
             stat err =       0.000543113337
             autocorr =       1.333971037829
   target nu stat err =       0.000543113337
   target dn stat err =       0.003480357063
      target stat err =       0.002892887625
              std dev =       0.665016261769
             le_variance =       0.442246628417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266205753853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741411828219       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741411828577       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741411828641       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741411828656       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741411828660       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741411828602       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741411828486       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741411828577       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741411828667       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741411828652       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741411828709       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+04 is 5.399685e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741411828219       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741411828308       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741411828324       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741411828551       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741411828331       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741411828656       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741411828176       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741411828511       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741411828329       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741411828002       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741411829245       residual = 9.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+05 is 1.349922e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741411828219       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741411828241       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741411828245       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741411827822       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741411828415       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741411827917       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741411824308       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741411828595       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741411828560       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741411828183       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741411827772       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+05 is 3.374805e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1616e+01
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956741e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511631e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364774e-03 3 1  ON 17
ci_019                -1.040061e-03 3 1  ON 18
ci_020                -1.340466e-03 3 1  ON 19
ci_021                -1.174247e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245467e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345207e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702671e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001554e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684873e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413374e-04 3 1  ON 48
ci_050                 1.074587e-03 3 1  ON 49
ci_051                -2.775490e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790932e-04 3 1  ON 57
ci_059                -5.693720e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901953e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852749e-04 3 1  ON 62
ci_064                -5.148440e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732175e-04 3 1  ON 68
ci_070                -4.401882e-04 3 1  ON 69
ci_071                -2.077526e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602355e-04 3 1  ON 72
ci_074                 2.017443e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314492e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.5796
    reference variance = 0.337111
====================================================
  Execution time = 2.5834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4513e-01
  Total weights = 1.9550e+06
  Execution time = 3.6178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435534132583
                                         uncertainty =       0.001982895419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435534132583
                                         uncertainty =       0.001982895419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466625176
  error estimate for blocks of size 2^( 2) =       0.000490878657
  error estimate for blocks of size 2^( 3) =       0.000513182344
  error estimate for blocks of size 2^( 4) =       0.000529647861
  error estimate for blocks of size 2^( 5) =       0.000539346886
  error estimate for blocks of size 2^( 6) =       0.000544838658
  error estimate for blocks of size 2^( 7) =       0.000550041044

      target function =      -0.749370606952
              le_mean =     -22.663136037966
             les_mean =     514.062862349026
             stat err =       0.000540968612
             autocorr =       1.344026406610
   target nu stat err =       0.000540968612
   target dn stat err =       0.002765524303
      target stat err =       0.002378831968
              std dev =       0.659907652528
             le_variance =       0.435478109865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435534131593
                                         uncertainty =       0.001982895341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435534131593
                                         uncertainty =       0.001982895341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466625176
  error estimate for blocks of size 2^( 2) =       0.000490878657
  error estimate for blocks of size 2^( 3) =       0.000513182344
  error estimate for blocks of size 2^( 4) =       0.000529647861
  error estimate for blocks of size 2^( 5) =       0.000539346885
  error estimate for blocks of size 2^( 6) =       0.000544838658
  error estimate for blocks of size 2^( 7) =       0.000550041044

      target function =      -0.749370600783
              le_mean =     -22.663136037983
             les_mean =     514.062862357169
             stat err =       0.000540968612
             autocorr =       1.344026407974
   target nu stat err =       0.000540968612
   target dn stat err =       0.002765524723
      target stat err =       0.002378832268
              std dev =       0.659907651778
             le_variance =       0.435478108875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435534132088
                                         uncertainty =       0.001982895380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435534132088
                                         uncertainty =       0.001982895380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466625176
  error estimate for blocks of size 2^( 2) =       0.000490878657
  error estimate for blocks of size 2^( 3) =       0.000513182344
  error estimate for blocks of size 2^( 4) =       0.000529647861
  error estimate for blocks of size 2^( 5) =       0.000539346885
  error estimate for blocks of size 2^( 6) =       0.000544838658
  error estimate for blocks of size 2^( 7) =       0.000550041044

      target function =      -0.749370603867
              le_mean =     -22.663136037974
             les_mean =     514.062862353097
             stat err =       0.000540968612
             autocorr =       1.344026407288
   target nu stat err =       0.000540968612
   target dn stat err =       0.002765524513
      target stat err =       0.002378832118
              std dev =       0.659907652153
             le_variance =       0.435478109370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435534132521
                                         uncertainty =       0.001982895414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.435534132521
                                         uncertainty =       0.001982895414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466625176
  error estimate for blocks of size 2^( 2) =       0.000490878657
  error estimate for blocks of size 2^( 3) =       0.000513182344
  error estimate for blocks of size 2^( 4) =       0.000529647861
  error estimate for blocks of size 2^( 5) =       0.000539346886
  error estimate for blocks of size 2^( 6) =       0.000544838658
  error estimate for blocks of size 2^( 7) =       0.000550041044

      target function =      -0.749370606566
              le_mean =     -22.663136037967
             les_mean =     514.062862349534
             stat err =       0.000540968612
             autocorr =       1.344026406686
   target nu stat err =       0.000540968612
   target dn stat err =       0.002765524329
      target stat err =       0.002378831987
              std dev =       0.659907652481
             le_variance =       0.435478109803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749370606952        initial  <--
     5.9605e+04     5.9605e+05             5.3997e-09        -0.749370600783
     2.3842e+05     2.3842e+06             1.3499e-09        -0.749370603867
     9.5367e+05     9.5367e+06             3.3748e-10        -0.749370606566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0000
  </log>
  <optVariables href="FORM2.s033.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438013e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244241e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420272e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901965e-05 3 1  ON 60
ci_062                -9.469610e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401883e-04 3 1  ON 69
ci_071                -2.077526e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314495e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5622e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6976
    reference variance = 0.310051
====================================================
  Execution time = 2.6667e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4934e-01
  Total weights = 1.955467943e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440889783711
                                         uncertainty =       0.002003115158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440889783711
                                         uncertainty =       0.002003115158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469544402
  error estimate for blocks of size 2^( 2) =       0.000493179852
  error estimate for blocks of size 2^( 3) =       0.000515609506
  error estimate for blocks of size 2^( 4) =       0.000530997654
  error estimate for blocks of size 2^( 5) =       0.000541012428
  error estimate for blocks of size 2^( 6) =       0.000543889973
  error estimate for blocks of size 2^( 7) =       0.000546369465

      target function =      -0.745873903828
              le_mean =     -22.662186530049
             les_mean =     514.024038094825
             stat err =       0.000540567380
             autocorr =       1.325398073703
   target nu stat err =       0.000540567380
   target dn stat err =       0.002651877360
      target stat err =       0.002263569709
              std dev =       0.664036061701
             le_variance =       0.440943891239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266218653005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745879867153       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745879867189       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745879867198       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745879867198       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745879867198       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745879867198       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745879867198       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745879866761       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745879867198       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745879867151       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745879865577       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+05 is 3.970231e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745879867153       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745879867162       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745879867164       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745879866987       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745879867166       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745879867796       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745879865325       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745879869065       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745879867527       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745879869531       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745879872453       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+06 is 9.925575e-11

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745879867153       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745879867155       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745879867156       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745879867156       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745879868121       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745879866611       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745879867156       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745879849142       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745879883894       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745879867867       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745879872327       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+06 is 2.481395e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1382e+01
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413376e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420272e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469610e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401883e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314495e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.6517
    reference variance = 0.378755
====================================================
  Execution time = 2.6244e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4890e-01
  Total weights = 1.9548e+06
  Execution time = 3.6107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439974439050
                                         uncertainty =       0.002035254328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439974439050
                                         uncertainty =       0.002035254328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469019640
  error estimate for blocks of size 2^( 2) =       0.000493209178
  error estimate for blocks of size 2^( 3) =       0.000515470517
  error estimate for blocks of size 2^( 4) =       0.000531571765
  error estimate for blocks of size 2^( 5) =       0.000541416585
  error estimate for blocks of size 2^( 6) =       0.000544519188
  error estimate for blocks of size 2^( 7) =       0.000546756873

      target function =      -0.746239977341
              le_mean =     -22.662716784561
             les_mean =     514.047633275111
             stat err =       0.000541066103
             autocorr =       1.330817785971
   target nu stat err =       0.000541066103
   target dn stat err =       0.002642673064
      target stat err =       0.002260317134
              std dev =       0.663293935319
             le_variance =       0.439958844631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439974438973
                                         uncertainty =       0.002035254327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439974438973
                                         uncertainty =       0.002035254327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469019640
  error estimate for blocks of size 2^( 2) =       0.000493209178
  error estimate for blocks of size 2^( 3) =       0.000515470517
  error estimate for blocks of size 2^( 4) =       0.000531571765
  error estimate for blocks of size 2^( 5) =       0.000541416585
  error estimate for blocks of size 2^( 6) =       0.000544519188
  error estimate for blocks of size 2^( 7) =       0.000546756873

      target function =      -0.746239977264
              le_mean =     -22.662716784560
             les_mean =     514.047633275156
             stat err =       0.000541066103
             autocorr =       1.330817786149
   target nu stat err =       0.000541066103
   target dn stat err =       0.002642673078
      target stat err =       0.002260317144
              std dev =       0.663293935261
             le_variance =       0.439958844555

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439974439011
                                         uncertainty =       0.002035254327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439974439011
                                         uncertainty =       0.002035254327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469019640
  error estimate for blocks of size 2^( 2) =       0.000493209178
  error estimate for blocks of size 2^( 3) =       0.000515470517
  error estimate for blocks of size 2^( 4) =       0.000531571765
  error estimate for blocks of size 2^( 5) =       0.000541416585
  error estimate for blocks of size 2^( 6) =       0.000544519188
  error estimate for blocks of size 2^( 7) =       0.000546756873

      target function =      -0.746239977302
              le_mean =     -22.662716784561
             les_mean =     514.047633275133
             stat err =       0.000541066103
             autocorr =       1.330817786055
   target nu stat err =       0.000541066103
   target dn stat err =       0.002642673071
      target stat err =       0.002260317139
              std dev =       0.663293935290
             le_variance =       0.439958844593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439974439045
                                         uncertainty =       0.002035254328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439974439045
                                         uncertainty =       0.002035254328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469019640
  error estimate for blocks of size 2^( 2) =       0.000493209178
  error estimate for blocks of size 2^( 3) =       0.000515470517
  error estimate for blocks of size 2^( 4) =       0.000531571765
  error estimate for blocks of size 2^( 5) =       0.000541416585
  error estimate for blocks of size 2^( 6) =       0.000544519188
  error estimate for blocks of size 2^( 7) =       0.000546756873

      target function =      -0.746239977336
              le_mean =     -22.662716784561
             les_mean =     514.047633275114
             stat err =       0.000541066103
             autocorr =       1.330817785972
   target nu stat err =       0.000541066103
   target dn stat err =       0.002642673065
      target stat err =       0.002260317134
              std dev =       0.663293935316
             le_variance =       0.439958844627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746239977341        initial  <--
     5.9605e+05     5.9605e+06             3.9702e-10        -0.746239977264
     2.3842e+06     2.3842e+07             9.9256e-11        -0.746239977302
     9.5367e+06     9.5367e+07             2.4814e-11        -0.746239977336

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.3774
  </log>
  <optVariables href="FORM2.s034.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438013e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244241e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420272e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901965e-05 3 1  ON 60
ci_062                -9.469610e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401883e-04 3 1  ON 69
ci_071                -2.077526e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314495e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5767e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.6091
    reference variance = 0.396998
====================================================
  Execution time = 2.6749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5394e-01
  Total weights = 1.955269942e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442740994355
                                         uncertainty =       0.003087809193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442740994355
                                         uncertainty =       0.003087809193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470513784
  error estimate for blocks of size 2^( 2) =       0.000494303832
  error estimate for blocks of size 2^( 3) =       0.000516262589
  error estimate for blocks of size 2^( 4) =       0.000531276926
  error estimate for blocks of size 2^( 5) =       0.000540673504
  error estimate for blocks of size 2^( 6) =       0.000544518184
  error estimate for blocks of size 2^( 7) =       0.000549925391

      target function =      -0.742101004145
              le_mean =     -22.662145675824
             les_mean =     514.026783306257
             stat err =       0.000541598501
             autocorr =       1.324982696705
   target nu stat err =       0.000541598501
   target dn stat err =       0.003822596495
      target stat err =       0.003171792052
              std dev =       0.665406974236
             le_variance =       0.442766441361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266214567582e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742113830424       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742113830427       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742113830427       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742113830427       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742113830427       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742113830395       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742113825574       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742113824312       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742113842356       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742113843075       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742113830661       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+06 is 4.556531e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742113830424       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742113830425       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742113830425       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742113832370       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742113830071       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742113839315       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742113807403       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742113806609       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742113794367       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742113829531       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742113832001       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+07 is 1.139138e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742113830424       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742113830424       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742113830424       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742113830424       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742113830424       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742113830426       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742113690364       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742113940165       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742113876223       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742113846249       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742113812249       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.5367e+07 is 2.847906e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166546 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1483e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438013e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420272e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901965e-05 3 1  ON 60
ci_062                -9.469610e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401883e-04 3 1  ON 69
ci_071                -2.077526e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314495e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.6705
    reference variance = 0.35873
====================================================
  Execution time = 2.7534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4973e-01
  Total weights = 1.9553e+06
  Execution time = 3.6177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439907158422
                                         uncertainty =       0.001990878951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439907158422
                                         uncertainty =       0.001990878951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469000855
  error estimate for blocks of size 2^( 2) =       0.000492858426
  error estimate for blocks of size 2^( 3) =       0.000514384615
  error estimate for blocks of size 2^( 4) =       0.000530232216
  error estimate for blocks of size 2^( 5) =       0.000540335594
  error estimate for blocks of size 2^( 6) =       0.000544506219
  error estimate for blocks of size 2^( 7) =       0.000548179468

      target function =      -0.745558397611
              le_mean =     -22.662414160499
             les_mean =     514.034740966510
             stat err =       0.000540813374
             autocorr =       1.329681351265
   target nu stat err =       0.000540813374
   target dn stat err =       0.002666717373
      target stat err =       0.002274337702
              std dev =       0.663267369311
             le_variance =       0.439923603193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439907158415
                                         uncertainty =       0.001990878951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439907158415
                                         uncertainty =       0.001990878951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469000855
  error estimate for blocks of size 2^( 2) =       0.000492858426
  error estimate for blocks of size 2^( 3) =       0.000514384615
  error estimate for blocks of size 2^( 4) =       0.000530232216
  error estimate for blocks of size 2^( 5) =       0.000540335594
  error estimate for blocks of size 2^( 6) =       0.000544506219
  error estimate for blocks of size 2^( 7) =       0.000548179468

      target function =      -0.745558397634
              le_mean =     -22.662414160499
             les_mean =     514.034740966483
             stat err =       0.000540813374
             autocorr =       1.329681351280
   target nu stat err =       0.000540813374
   target dn stat err =       0.002666717374
      target stat err =       0.002274337703
              std dev =       0.663267369306
             le_variance =       0.439923603187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439907158419
                                         uncertainty =       0.001990878951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439907158419
                                         uncertainty =       0.001990878951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469000855
  error estimate for blocks of size 2^( 2) =       0.000492858426
  error estimate for blocks of size 2^( 3) =       0.000514384615
  error estimate for blocks of size 2^( 4) =       0.000530232216
  error estimate for blocks of size 2^( 5) =       0.000540335594
  error estimate for blocks of size 2^( 6) =       0.000544506219
  error estimate for blocks of size 2^( 7) =       0.000548179468

      target function =      -0.745558397623
              le_mean =     -22.662414160499
             les_mean =     514.034740966497
             stat err =       0.000540813374
             autocorr =       1.329681351273
   target nu stat err =       0.000540813374
   target dn stat err =       0.002666717373
      target stat err =       0.002274337703
              std dev =       0.663267369309
             le_variance =       0.439923603190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439907158421
                                         uncertainty =       0.001990878951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439907158421
                                         uncertainty =       0.001990878951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469000855
  error estimate for blocks of size 2^( 2) =       0.000492858426
  error estimate for blocks of size 2^( 3) =       0.000514384615
  error estimate for blocks of size 2^( 4) =       0.000530232216
  error estimate for blocks of size 2^( 5) =       0.000540335594
  error estimate for blocks of size 2^( 6) =       0.000544506219
  error estimate for blocks of size 2^( 7) =       0.000548179468

      target function =      -0.745558397613
              le_mean =     -22.662414160499
             les_mean =     514.034740966508
             stat err =       0.000540813374
             autocorr =       1.329681351280
   target nu stat err =       0.000540813374
   target dn stat err =       0.002666717373
      target stat err =       0.002274337702
              std dev =       0.663267369311
             le_variance =       0.439923603192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745558397611        initial
     5.9605e+06     5.9605e+07             4.5565e-11        -0.745558397634  <--
     2.3842e+07     2.3842e+08             1.1391e-11        -0.745558397623
     9.5367e+07     9.5367e+08             2.8479e-12        -0.745558397613

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 4.5701e+01
  </log>
  <optVariables href="FORM2.s035.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438013e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413376e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420272e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901965e-05 3 1  ON 60
ci_062                -9.469610e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805298e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401883e-04 3 1  ON 69
ci_071                -2.077526e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314495e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7190e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.5968
    reference variance = 0.328042
====================================================
  Execution time = 2.6929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5032e-01
  Total weights = 1.955322041e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440638913525
                                         uncertainty =       0.002224824137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440638913525
                                         uncertainty =       0.002224824137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469373199
  error estimate for blocks of size 2^( 2) =       0.000493083675
  error estimate for blocks of size 2^( 3) =       0.000515226235
  error estimate for blocks of size 2^( 4) =       0.000530485369
  error estimate for blocks of size 2^( 5) =       0.000539768555
  error estimate for blocks of size 2^( 6) =       0.000544341302
  error estimate for blocks of size 2^( 7) =       0.000547347281

      target function =      -0.745067266309
              le_mean =     -22.662408296932
             les_mean =     514.035070580288
             stat err =       0.000540485627
             autocorr =       1.325963967943
   target nu stat err =       0.000540485627
   target dn stat err =       0.002940969310
      target stat err =       0.002489533774
              std dev =       0.663793943459
             le_variance =       0.440622399372


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266240829693e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745074642389       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745074642404       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745074642406       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745074642406       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745074642406       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745074640546       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745074643490       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745074642406       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745074640049       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+06 is 1.681294e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745074642389       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745074642393       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745074642393       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745074642393       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745074642393       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745074642393       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745074634968       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745074642393       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745074642393       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+06 is 4.203249e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745074642389       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745074642390       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745074642390       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745074642390       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745074642390       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745074642390       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745074642390       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745074642390       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745074642390       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3842e+07 is 1.050812e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169630 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1642e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438013e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208323e-03 3 1  ON 51
ci_053                -2.420272e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901965e-05 3 1  ON 60
ci_062                -9.469610e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401883e-04 3 1  ON 69
ci_071                -2.077526e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7282
    reference variance = 0.476663
====================================================
  Execution time = 2.6087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5329e-01
  Total weights = 1.9552e+06
  Execution time = 3.6162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442602406177
                                         uncertainty =       0.002137168660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442602406177
                                         uncertainty =       0.002137168660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470444652
  error estimate for blocks of size 2^( 2) =       0.000493971324
  error estimate for blocks of size 2^( 3) =       0.000516653228
  error estimate for blocks of size 2^( 4) =       0.000531617866
  error estimate for blocks of size 2^( 5) =       0.000541025414
  error estimate for blocks of size 2^( 6) =       0.000545510364
  error estimate for blocks of size 2^( 7) =       0.000548357345

      target function =      -0.742627107736
              le_mean =     -22.661337411612
             les_mean =     513.989507142809
             stat err =       0.000541627747
             autocorr =       1.325515279195
   target nu stat err =       0.000541627747
   target dn stat err =       0.002951707657
      target stat err =       0.002478603334
              std dev =       0.665309207246
             le_variance =       0.442636341246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442602406140
                                         uncertainty =       0.002137168661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442602406140
                                         uncertainty =       0.002137168661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470444652
  error estimate for blocks of size 2^( 2) =       0.000493971324
  error estimate for blocks of size 2^( 3) =       0.000516653228
  error estimate for blocks of size 2^( 4) =       0.000531617866
  error estimate for blocks of size 2^( 5) =       0.000541025414
  error estimate for blocks of size 2^( 6) =       0.000545510364
  error estimate for blocks of size 2^( 7) =       0.000548357345

      target function =      -0.742627107835
              le_mean =     -22.661337411612
             les_mean =     513.989507142704
             stat err =       0.000541627747
             autocorr =       1.325515279245
   target nu stat err =       0.000541627747
   target dn stat err =       0.002951707626
      target stat err =       0.002478603310
              std dev =       0.665309207219
             le_variance =       0.442636341210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442602406158
                                         uncertainty =       0.002137168660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442602406158
                                         uncertainty =       0.002137168660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470444652
  error estimate for blocks of size 2^( 2) =       0.000493971324
  error estimate for blocks of size 2^( 3) =       0.000516653228
  error estimate for blocks of size 2^( 4) =       0.000531617866
  error estimate for blocks of size 2^( 5) =       0.000541025414
  error estimate for blocks of size 2^( 6) =       0.000545510364
  error estimate for blocks of size 2^( 7) =       0.000548357345

      target function =      -0.742627107786
              le_mean =     -22.661337411612
             les_mean =     513.989507142757
             stat err =       0.000541627747
             autocorr =       1.325515279215
   target nu stat err =       0.000541627747
   target dn stat err =       0.002951707641
      target stat err =       0.002478603322
              std dev =       0.665309207232
             le_variance =       0.442636341228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442602406174
                                         uncertainty =       0.002137168660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442602406174
                                         uncertainty =       0.002137168660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470444652
  error estimate for blocks of size 2^( 2) =       0.000493971324
  error estimate for blocks of size 2^( 3) =       0.000516653228
  error estimate for blocks of size 2^( 4) =       0.000531617866
  error estimate for blocks of size 2^( 5) =       0.000541025414
  error estimate for blocks of size 2^( 6) =       0.000545510364
  error estimate for blocks of size 2^( 7) =       0.000548357345

      target function =      -0.742627107742
              le_mean =     -22.661337411612
             les_mean =     513.989507142803
             stat err =       0.000541627747
             autocorr =       1.325515279201
   target nu stat err =       0.000541627747
   target dn stat err =       0.002951707655
      target stat err =       0.002478603333
              std dev =       0.665309207244
             le_variance =       0.442636341244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742627107736        initial
     1.4901e+06     1.4901e+07             1.6813e-10        -0.742627107835  <--
     5.9605e+06     5.9605e+07             4.2032e-11        -0.742627107786
     2.3842e+07     2.3842e+08             1.0508e-11        -0.742627107742

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 4.4265e+01
  </log>
  <optVariables href="FORM2.s036.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074587e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901966e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6234
    reference variance = 0.428337
====================================================
  Execution time = 2.6823e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4656e-01
  Total weights = 1.955258290e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438253025403
                                         uncertainty =       0.001912974134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438253025403
                                         uncertainty =       0.001912974134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468074211
  error estimate for blocks of size 2^( 2) =       0.000492042929
  error estimate for blocks of size 2^( 3) =       0.000514154557
  error estimate for blocks of size 2^( 4) =       0.000529345985
  error estimate for blocks of size 2^( 5) =       0.000539008398
  error estimate for blocks of size 2^( 6) =       0.000542004846
  error estimate for blocks of size 2^( 7) =       0.000543750618

      target function =      -0.748168276909
              le_mean =     -22.662159469459
             les_mean =     514.020034096581
             stat err =       0.000538527462
             autocorr =       1.323689979481
   target nu stat err =       0.000538527462
   target dn stat err =       0.002481190333
      target stat err =       0.002140204221
              std dev =       0.661956897659
             le_variance =       0.438186934358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266215946946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748173514814       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748173514853       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748173514858       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748173514859       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748173514871       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748173515064       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748173514165       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748173515074       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748173514592       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748173514869       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+05 is 5.251364e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748173514814       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748173514823       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748173514825       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748173514823       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748173514825       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748173515164       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748173514169       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748173513351       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748173514268       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748173515658       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+06 is 1.312841e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748173514814       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748173514816       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748173514816       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748173514816       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748173512971       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748173509961       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748173518896       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748173519554       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748173516231       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.748173510279       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+06 is 3.282103e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173152 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1542e+01
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511631e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684873e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901966e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401883e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.6228
    reference variance = 0.418967
====================================================
  Execution time = 2.6022e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5597e-01
  Total weights = 1.9554e+06
  Execution time = 3.6085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861095850
                                         uncertainty =       0.002967373550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861095850
                                         uncertainty =       0.002967373550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470569841
  error estimate for blocks of size 2^( 2) =       0.000494024786
  error estimate for blocks of size 2^( 3) =       0.000515788879
  error estimate for blocks of size 2^( 4) =       0.000531390463
  error estimate for blocks of size 2^( 5) =       0.000541066477
  error estimate for blocks of size 2^( 6) =       0.000546149166
  error estimate for blocks of size 2^( 7) =       0.000547989856

      target function =      -0.740443056037
              le_mean =     -22.661797744757
             les_mean =     514.013051371287
             stat err =       0.000541648991
             autocorr =       1.324914021853
   target nu stat err =       0.000541648991
   target dn stat err =       0.003916488026
      target stat err =       0.003231089978
              std dev =       0.665486251683
             le_variance =       0.442871951179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861095737
                                         uncertainty =       0.002967373560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861095737
                                         uncertainty =       0.002967373560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470569841
  error estimate for blocks of size 2^( 2) =       0.000494024785
  error estimate for blocks of size 2^( 3) =       0.000515788879
  error estimate for blocks of size 2^( 4) =       0.000531390463
  error estimate for blocks of size 2^( 5) =       0.000541066477
  error estimate for blocks of size 2^( 6) =       0.000546149166
  error estimate for blocks of size 2^( 7) =       0.000547989856

      target function =      -0.740443055957
              le_mean =     -22.661797744761
             les_mean =     514.013051371577
             stat err =       0.000541648991
             autocorr =       1.324914022063
   target nu stat err =       0.000541648991
   target dn stat err =       0.003916488145
      target stat err =       0.003231090073
              std dev =       0.665486251598
             le_variance =       0.442871951066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861095793
                                         uncertainty =       0.002967373555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861095793
                                         uncertainty =       0.002967373555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470569841
  error estimate for blocks of size 2^( 2) =       0.000494024786
  error estimate for blocks of size 2^( 3) =       0.000515788879
  error estimate for blocks of size 2^( 4) =       0.000531390463
  error estimate for blocks of size 2^( 5) =       0.000541066477
  error estimate for blocks of size 2^( 6) =       0.000546149166
  error estimate for blocks of size 2^( 7) =       0.000547989856

      target function =      -0.740443055997
              le_mean =     -22.661797744759
             les_mean =     514.013051371432
             stat err =       0.000541648991
             autocorr =       1.324914021955
   target nu stat err =       0.000541648991
   target dn stat err =       0.003916488085
      target stat err =       0.003231090025
              std dev =       0.665486251640
             le_variance =       0.442871951122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861095843
                                         uncertainty =       0.002967373551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442861095843
                                         uncertainty =       0.002967373551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470569841
  error estimate for blocks of size 2^( 2) =       0.000494024786
  error estimate for blocks of size 2^( 3) =       0.000515788879
  error estimate for blocks of size 2^( 4) =       0.000531390463
  error estimate for blocks of size 2^( 5) =       0.000541066477
  error estimate for blocks of size 2^( 6) =       0.000546149166
  error estimate for blocks of size 2^( 7) =       0.000547989856

      target function =      -0.740443056032
              le_mean =     -22.661797744757
             les_mean =     514.013051371305
             stat err =       0.000541648991
             autocorr =       1.324914021871
   target nu stat err =       0.000541648991
   target dn stat err =       0.003916488033
      target stat err =       0.003231089984
              std dev =       0.665486251678
             le_variance =       0.442871951172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740443056037        initial  <--
     3.7253e+05     3.7253e+06             5.2514e-10        -0.740443055957
     1.4901e+06     1.4901e+07             1.3128e-10        -0.740443055997
     5.9605e+06     5.9605e+07             3.2821e-11        -0.740443056032

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1452
  </log>
  <optVariables href="FORM2.s037.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074587e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901966e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5694e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6242
    reference variance = 0.489179
====================================================
  Execution time = 2.6763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5173e-01
  Total weights = 1.955058335e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442768523846
                                         uncertainty =       0.001838530642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442768523846
                                         uncertainty =       0.001838530642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470498921
  error estimate for blocks of size 2^( 2) =       0.000494835143
  error estimate for blocks of size 2^( 3) =       0.000517560683
  error estimate for blocks of size 2^( 4) =       0.000533036820
  error estimate for blocks of size 2^( 5) =       0.000542354285
  error estimate for blocks of size 2^( 6) =       0.000547338449
  error estimate for blocks of size 2^( 7) =       0.000549841359

      target function =      -0.743908949170
              le_mean =     -22.661900255568
             les_mean =     514.013453275663
             stat err =       0.000543142728
             autocorr =       1.332633345720
   target nu stat err =       0.000543142728
   target dn stat err =       0.002717331842
      target stat err =       0.002303579530
              std dev =       0.665385954609
             le_variance =       0.442738468590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266190025557e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743915170207       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743915170214       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743915170215       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743915168740       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743915170428       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743915162621       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743915174853       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743915166551       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743915166186       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743915167416       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743915167673       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+06 is 5.818075e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743915170207       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743915170209       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743915170209       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743915170204       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743915170257       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743915173649       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743915175445       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743915168545       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743915147232       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743915170209       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743915151501       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+07 is 1.454521e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743915170207       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743915170208       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743915170208       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743915170208       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743915202181       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743915168735       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743915213560       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743915146182       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743915067405       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743915058221       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743915064789       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.9605e+07 is 3.636236e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177319 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1490e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074587e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901967e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.5902
    reference variance = 0.495542
====================================================
  Execution time = 2.5890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6328e-01
  Total weights = 1.9549e+06
  Execution time = 3.6055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447537630018
                                         uncertainty =       0.003048797602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447537630018
                                         uncertainty =       0.003048797602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472990063
  error estimate for blocks of size 2^( 2) =       0.000497279207
  error estimate for blocks of size 2^( 3) =       0.000519340363
  error estimate for blocks of size 2^( 4) =       0.000534572210
  error estimate for blocks of size 2^( 5) =       0.000544012010
  error estimate for blocks of size 2^( 6) =       0.000548113361
  error estimate for blocks of size 2^( 7) =       0.000552162429

      target function =      -0.734534933039
              le_mean =     -22.662048261914
             les_mean =     514.031708170112
             stat err =       0.000544715002
             autocorr =       1.326278226486
   target nu stat err =       0.000544715002
   target dn stat err =       0.007188874402
      target stat err =       0.005770138343
              std dev =       0.668908961813
             le_variance =       0.447439199193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447537630007
                                         uncertainty =       0.003048797602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447537630007
                                         uncertainty =       0.003048797602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472990063
  error estimate for blocks of size 2^( 2) =       0.000497279207
  error estimate for blocks of size 2^( 3) =       0.000519340363
  error estimate for blocks of size 2^( 4) =       0.000534572210
  error estimate for blocks of size 2^( 5) =       0.000544012010
  error estimate for blocks of size 2^( 6) =       0.000548113361
  error estimate for blocks of size 2^( 7) =       0.000552162429

      target function =      -0.734534933678
              le_mean =     -22.662048261915
             les_mean =     514.031708169341
             stat err =       0.000544715002
             autocorr =       1.326278226506
   target nu stat err =       0.000544715002
   target dn stat err =       0.007188873710
      target stat err =       0.005770137804
              std dev =       0.668908961804
             le_variance =       0.447439199182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447537630012
                                         uncertainty =       0.003048797602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447537630012
                                         uncertainty =       0.003048797602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472990063
  error estimate for blocks of size 2^( 2) =       0.000497279207
  error estimate for blocks of size 2^( 3) =       0.000519340363
  error estimate for blocks of size 2^( 4) =       0.000534572210
  error estimate for blocks of size 2^( 5) =       0.000544012010
  error estimate for blocks of size 2^( 6) =       0.000548113361
  error estimate for blocks of size 2^( 7) =       0.000552162429

      target function =      -0.734534933358
              le_mean =     -22.662048261914
             les_mean =     514.031708169726
             stat err =       0.000544715002
             autocorr =       1.326278226488
   target nu stat err =       0.000544715002
   target dn stat err =       0.007188874056
      target stat err =       0.005770138074
              std dev =       0.668908961808
             le_variance =       0.447439199187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447537630017
                                         uncertainty =       0.003048797602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447537630017
                                         uncertainty =       0.003048797602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472990063
  error estimate for blocks of size 2^( 2) =       0.000497279207
  error estimate for blocks of size 2^( 3) =       0.000519340363
  error estimate for blocks of size 2^( 4) =       0.000534572210
  error estimate for blocks of size 2^( 5) =       0.000544012010
  error estimate for blocks of size 2^( 6) =       0.000548113361
  error estimate for blocks of size 2^( 7) =       0.000552162429

      target function =      -0.734534933079
              le_mean =     -22.662048261914
             les_mean =     514.031708170063
             stat err =       0.000544715002
             autocorr =       1.326278226471
   target nu stat err =       0.000544715002
   target dn stat err =       0.007188874359
      target stat err =       0.005770138310
              std dev =       0.668908961812
             le_variance =       0.447439199192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.734534933039        initial
     3.7253e+06     3.7253e+07             5.8181e-11        -0.734534933678  <--
     1.4901e+07     1.4901e+08             1.4545e-11        -0.734534933358
     5.9605e+07     5.9605e+08             3.6362e-12        -0.734534933079

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 4.3975e+01
  </log>
  <optVariables href="FORM2.s038.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5472e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.6095
    reference variance = 0.302158
====================================================
  Execution time = 2.6763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5425e-01
  Total weights = 1.955037595e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441223528229
                                         uncertainty =       0.002327845870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441223528229
                                         uncertainty =       0.002327845870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469650812
  error estimate for blocks of size 2^( 2) =       0.000493648865
  error estimate for blocks of size 2^( 3) =       0.000515448429
  error estimate for blocks of size 2^( 4) =       0.000531512376
  error estimate for blocks of size 2^( 5) =       0.000541165889
  error estimate for blocks of size 2^( 6) =       0.000544127484
  error estimate for blocks of size 2^( 7) =       0.000547413791

      target function =      -0.741845062667
              le_mean =     -22.661781890218
             les_mean =     514.010604707023
             stat err =       0.000541054885
             autocorr =       1.327188134847
   target nu stat err =       0.000541054885
   target dn stat err =       0.004207263836
      target stat err =       0.003475914088
              std dev =       0.664186547542
             le_variance =       0.441143769936


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266178189022e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741860450832       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741860450858       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741860450861       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741860450851       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741860450138       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741860450164       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741860451748       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741860451677       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741860450441       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741860450863       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741860450863       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741860451658       residual = 9.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+05 is 2.927430e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741860450832       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741860450839       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741860450840       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741860450840       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741860450840       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741860450790       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741860451551       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741860443445       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741860452971       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741860459493       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741860452842       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741860447794       residual = 9.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+06 is 7.318570e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741860450832       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741860450834       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741860450834       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741860450834       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741860450834       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741860450690       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741860425808       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741860485262       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741860457085       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741860473334       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741860525135       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741860420464       residual = 9.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+07 is 1.829645e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1502e+01
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901966e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.667
    reference variance = 0.418018
====================================================
  Execution time = 2.7987e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5146e-01
  Total weights = 1.9554e+06
  Execution time = 3.6018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439234650437
                                         uncertainty =       0.001996368243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439234650437
                                         uncertainty =       0.001996368243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468683277
  error estimate for blocks of size 2^( 2) =       0.000492651129
  error estimate for blocks of size 2^( 3) =       0.000514571570
  error estimate for blocks of size 2^( 4) =       0.000530215457
  error estimate for blocks of size 2^( 5) =       0.000540830893
  error estimate for blocks of size 2^( 6) =       0.000545672917
  error estimate for blocks of size 2^( 7) =       0.000545346057

      target function =      -0.744129809248
              le_mean =     -22.662218644275
             les_mean =     514.027613173289
             stat err =       0.000540516331
             autocorr =       1.330021694942
   target nu stat err =       0.000540516331
   target dn stat err =       0.003265681369
      target stat err =       0.002741873892
              std dev =       0.662818246418
             le_variance =       0.439328027784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439234650388
                                         uncertainty =       0.001996368240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439234650388
                                         uncertainty =       0.001996368240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468683277
  error estimate for blocks of size 2^( 2) =       0.000492651129
  error estimate for blocks of size 2^( 3) =       0.000514571570
  error estimate for blocks of size 2^( 4) =       0.000530215457
  error estimate for blocks of size 2^( 5) =       0.000540830893
  error estimate for blocks of size 2^( 6) =       0.000545672917
  error estimate for blocks of size 2^( 7) =       0.000545346057

      target function =      -0.744129809010
              le_mean =     -22.662218644274
             les_mean =     514.027613173526
             stat err =       0.000540516331
             autocorr =       1.330021695018
   target nu stat err =       0.000540516331
   target dn stat err =       0.003265681293
      target stat err =       0.002741873830
              std dev =       0.662818246381
             le_variance =       0.439328027736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439234650413
                                         uncertainty =       0.001996368242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439234650413
                                         uncertainty =       0.001996368242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468683277
  error estimate for blocks of size 2^( 2) =       0.000492651129
  error estimate for blocks of size 2^( 3) =       0.000514571570
  error estimate for blocks of size 2^( 4) =       0.000530215457
  error estimate for blocks of size 2^( 5) =       0.000540830893
  error estimate for blocks of size 2^( 6) =       0.000545672917
  error estimate for blocks of size 2^( 7) =       0.000545346057

      target function =      -0.744129809129
              le_mean =     -22.662218644274
             les_mean =     514.027613173407
             stat err =       0.000540516331
             autocorr =       1.330021694984
   target nu stat err =       0.000540516331
   target dn stat err =       0.003265681331
      target stat err =       0.002741873861
              std dev =       0.662818246400
             le_variance =       0.439328027760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439234650434
                                         uncertainty =       0.001996368243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439234650434
                                         uncertainty =       0.001996368243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468683277
  error estimate for blocks of size 2^( 2) =       0.000492651129
  error estimate for blocks of size 2^( 3) =       0.000514571570
  error estimate for blocks of size 2^( 4) =       0.000530215457
  error estimate for blocks of size 2^( 5) =       0.000540830893
  error estimate for blocks of size 2^( 6) =       0.000545672917
  error estimate for blocks of size 2^( 7) =       0.000545346057

      target function =      -0.744129809233
              le_mean =     -22.662218644275
             les_mean =     514.027613173304
             stat err =       0.000540516331
             autocorr =       1.330021694947
   target nu stat err =       0.000540516331
   target dn stat err =       0.003265681364
      target stat err =       0.002741873888
              std dev =       0.662818246416
             le_variance =       0.439328027781


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744129809248        initial  <--
     9.3132e+05     9.3132e+06             2.9274e-10        -0.744129809010
     3.7253e+06     3.7253e+07             7.3186e-11        -0.744129809129
     1.4901e+07     1.4901e+08             1.8296e-11        -0.744129809233

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 46.0938
  </log>
  <optVariables href="FORM2.s039.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7602e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2654e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.6401
    reference variance = 0.486571
====================================================
  Execution time = 2.6923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4819e-01
  Total weights = 1.955484327e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440563844536
                                         uncertainty =       0.002095224035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440563844536
                                         uncertainty =       0.002095224035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469308883
  error estimate for blocks of size 2^( 2) =       0.000493345499
  error estimate for blocks of size 2^( 3) =       0.000515815427
  error estimate for blocks of size 2^( 4) =       0.000531358531
  error estimate for blocks of size 2^( 5) =       0.000540878087
  error estimate for blocks of size 2^( 6) =       0.000544933894
  error estimate for blocks of size 2^( 7) =       0.000546807213

      target function =      -0.746831946061
              le_mean =     -22.663098969775
             les_mean =     514.064243492414
             stat err =       0.000540994431
             autocorr =       1.328825767383
   target nu stat err =       0.000540994431
   target dn stat err =       0.002579776153
      target stat err =       0.002214940616
              std dev =       0.663702986780
             le_variance =       0.440501654660


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266309896977e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746837572509       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746837572511       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746837572511       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746837572511       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746837571465       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746837583318       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746837578321       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746837558944       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746837562929       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746837601241       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+06 is 1.982556e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746837572509       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746837572510       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746837572510       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746837572509       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746837572513       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746837552247       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746837499331       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746837602208       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746837590058       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746837526505       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+07 is 4.956393e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746837572509       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746837572509       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746837572509       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746837572509       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746837572509       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746837547284       residual = 8.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746837400548       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746837448556       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746837501771       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746837572509       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+08 is 1.239102e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1628e+01
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -22.7514
    reference variance = 0.278942
====================================================
  Execution time = 2.5977e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4689e-01
  Total weights = 1.9554e+06
  Execution time = 3.6125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438563866362
                                         uncertainty =       0.001578650479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438563866362
                                         uncertainty =       0.001578650479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468236046
  error estimate for blocks of size 2^( 2) =       0.000492093379
  error estimate for blocks of size 2^( 3) =       0.000514342326
  error estimate for blocks of size 2^( 4) =       0.000530080244
  error estimate for blocks of size 2^( 5) =       0.000540348721
  error estimate for blocks of size 2^( 6) =       0.000546868507
  error estimate for blocks of size 2^( 7) =       0.000550479049

      target function =      -0.747899356990
              le_mean =     -22.662019623588
             les_mean =     514.014020250659
             stat err =       0.000541944130
             autocorr =       1.339612980205
   target nu stat err =       0.000541944130
   target dn stat err =       0.002249675526
      target stat err =       0.001956143900
              std dev =       0.662185766124
             le_variance =       0.438489988857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438563866357
                                         uncertainty =       0.001578650479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438563866357
                                         uncertainty =       0.001578650479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468236046
  error estimate for blocks of size 2^( 2) =       0.000492093379
  error estimate for blocks of size 2^( 3) =       0.000514342326
  error estimate for blocks of size 2^( 4) =       0.000530080244
  error estimate for blocks of size 2^( 5) =       0.000540348721
  error estimate for blocks of size 2^( 6) =       0.000546868507
  error estimate for blocks of size 2^( 7) =       0.000550479049

      target function =      -0.747899356990
              le_mean =     -22.662019623588
             les_mean =     514.014020250657
             stat err =       0.000541944130
             autocorr =       1.339612980221
   target nu stat err =       0.000541944130
   target dn stat err =       0.002249675526
      target stat err =       0.001956143899
              std dev =       0.662185766120
             le_variance =       0.438489988852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438563866360
                                         uncertainty =       0.001578650479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438563866360
                                         uncertainty =       0.001578650479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468236046
  error estimate for blocks of size 2^( 2) =       0.000492093379
  error estimate for blocks of size 2^( 3) =       0.000514342326
  error estimate for blocks of size 2^( 4) =       0.000530080244
  error estimate for blocks of size 2^( 5) =       0.000540348721
  error estimate for blocks of size 2^( 6) =       0.000546868507
  error estimate for blocks of size 2^( 7) =       0.000550479049

      target function =      -0.747899356990
              le_mean =     -22.662019623588
             les_mean =     514.014020250658
             stat err =       0.000541944130
             autocorr =       1.339612980206
   target nu stat err =       0.000541944130
   target dn stat err =       0.002249675526
      target stat err =       0.001956143900
              std dev =       0.662185766122
             le_variance =       0.438489988854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438563866362
                                         uncertainty =       0.001578650479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438563866362
                                         uncertainty =       0.001578650479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468236046
  error estimate for blocks of size 2^( 2) =       0.000492093379
  error estimate for blocks of size 2^( 3) =       0.000514342326
  error estimate for blocks of size 2^( 4) =       0.000530080244
  error estimate for blocks of size 2^( 5) =       0.000540348721
  error estimate for blocks of size 2^( 6) =       0.000546868507
  error estimate for blocks of size 2^( 7) =       0.000550479049

      target function =      -0.747899356990
              le_mean =     -22.662019623588
             les_mean =     514.014020250659
             stat err =       0.000541944130
             autocorr =       1.339612980208
   target nu stat err =       0.000541944130
   target dn stat err =       0.002249675526
      target stat err =       0.001956143900
              std dev =       0.662185766123
             le_variance =       0.438489988856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747899356990        initial  <--
     9.3132e+06     9.3132e+07             1.9826e-11        -0.747899356990
     3.7253e+07     3.7253e+08             4.9564e-12        -0.747899356990
     1.4901e+08     1.4901e+09             1.2391e-12        -0.747899356990

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.1034
  </log>
  <optVariables href="FORM2.s040.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.7409
    reference variance = 0.356198
====================================================
  Execution time = 2.7064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4794e-01
  Total weights = 1.955411531e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439318907876
                                         uncertainty =       0.002017243785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439318907876
                                         uncertainty =       0.002017243785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468640783
  error estimate for blocks of size 2^( 2) =       0.000492122988
  error estimate for blocks of size 2^( 3) =       0.000514104891
  error estimate for blocks of size 2^( 4) =       0.000530309022
  error estimate for blocks of size 2^( 5) =       0.000540868105
  error estimate for blocks of size 2^( 6) =       0.000546552433
  error estimate for blocks of size 2^( 7) =       0.000548143643

      target function =      -0.747021935335
              le_mean =     -22.661936668419
             les_mean =     514.011318516138
             stat err =       0.000541468301
             autocorr =       1.334952806530
   target nu stat err =       0.000541468301
   target dn stat err =       0.002563440084
      target stat err =       0.002199375731
              std dev =       0.662758151747
             le_variance =       0.439248367707


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266193666842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747027437474       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747027437474       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747027437474       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747027437745       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747027437474       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747027437474       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747027437474       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747027462013       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747027090111       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747027437474       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747027437474       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+07 is 2.051904e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747027437474       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747027437474       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747027437474       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747027408212       residual = 8.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747027708311       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747027374375       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747027633030       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747027437474       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747027233410       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747027437474       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747027437474       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+08 is 5.129759e-13

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747027437474       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747027437474       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747027437474       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747027437474       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747027437474       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747027437474       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747027437474       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747027437474       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747028725877       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747027437474       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747027630704       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+09 is 1.282861e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1780e+01
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -22.5406
    reference variance = 0.313702
====================================================
  Execution time = 2.5882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4612e-01
  Total weights = 1.9553e+06
  Execution time = 3.6070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437780634649
                                         uncertainty =       0.001796208140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437780634649
                                         uncertainty =       0.001796208140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467872867
  error estimate for blocks of size 2^( 2) =       0.000491514540
  error estimate for blocks of size 2^( 3) =       0.000513573813
  error estimate for blocks of size 2^( 4) =       0.000529520486
  error estimate for blocks of size 2^( 5) =       0.000539349554
  error estimate for blocks of size 2^( 6) =       0.000544027409
  error estimate for blocks of size 2^( 7) =       0.000542757725

      target function =      -0.748531549943
              le_mean =     -22.661767270251
             les_mean =     514.001814712732
             stat err =       0.000538913794
             autocorr =       1.326731005604
   target nu stat err =       0.000538913794
   target dn stat err =       0.002292276797
      target stat err =       0.001991196157
              std dev =       0.661672154114
             le_variance =       0.437810039530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437780634649
                                         uncertainty =       0.001796208140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437780634649
                                         uncertainty =       0.001796208140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467872867
  error estimate for blocks of size 2^( 2) =       0.000491514540
  error estimate for blocks of size 2^( 3) =       0.000513573813
  error estimate for blocks of size 2^( 4) =       0.000529520486
  error estimate for blocks of size 2^( 5) =       0.000539349554
  error estimate for blocks of size 2^( 6) =       0.000544027409
  error estimate for blocks of size 2^( 7) =       0.000542757725

      target function =      -0.748531549942
              le_mean =     -22.661767270251
             les_mean =     514.001814712733
             stat err =       0.000538913794
             autocorr =       1.326731005599
   target nu stat err =       0.000538913794
   target dn stat err =       0.002292276797
      target stat err =       0.001991196157
              std dev =       0.661672154114
             le_variance =       0.437810039530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437780634649
                                         uncertainty =       0.001796208140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437780634649
                                         uncertainty =       0.001796208140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467872867
  error estimate for blocks of size 2^( 2) =       0.000491514540
  error estimate for blocks of size 2^( 3) =       0.000513573813
  error estimate for blocks of size 2^( 4) =       0.000529520486
  error estimate for blocks of size 2^( 5) =       0.000539349554
  error estimate for blocks of size 2^( 6) =       0.000544027409
  error estimate for blocks of size 2^( 7) =       0.000542757725

      target function =      -0.748531549943
              le_mean =     -22.661767270251
             les_mean =     514.001814712733
             stat err =       0.000538913794
             autocorr =       1.326731005596
   target nu stat err =       0.000538913794
   target dn stat err =       0.002292276797
      target stat err =       0.001991196157
              std dev =       0.661672154114
             le_variance =       0.437810039530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437780634649
                                         uncertainty =       0.001796208140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437780634649
                                         uncertainty =       0.001796208140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467872867
  error estimate for blocks of size 2^( 2) =       0.000491514540
  error estimate for blocks of size 2^( 3) =       0.000513573813
  error estimate for blocks of size 2^( 4) =       0.000529520486
  error estimate for blocks of size 2^( 5) =       0.000539349554
  error estimate for blocks of size 2^( 6) =       0.000544027409
  error estimate for blocks of size 2^( 7) =       0.000542757725

      target function =      -0.748531549943
              le_mean =     -22.661767270251
             les_mean =     514.001814712732
             stat err =       0.000538913794
             autocorr =       1.326731005604
   target nu stat err =       0.000538913794
   target dn stat err =       0.002292276797
      target stat err =       0.001991196157
              std dev =       0.661672154114
             le_variance =       0.437810039530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748531549943        initial  <--
     9.3132e+07     9.3132e+08             2.0519e-12        -0.748531549942
     3.7253e+08     3.7253e+09             5.1298e-13        -0.748531549943
     1.4901e+09     1.4901e+10             1.2829e-13        -0.748531549943

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0143
  </log>
  <optVariables href="FORM2.s041.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.7557
    reference variance = 0.489788
====================================================
  Execution time = 2.6748e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5135e-01
  Total weights = 1.955309280e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441677617445
                                         uncertainty =       0.002553857436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441677617445
                                         uncertainty =       0.002553857436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469909834
  error estimate for blocks of size 2^( 2) =       0.000493772520
  error estimate for blocks of size 2^( 3) =       0.000516182803
  error estimate for blocks of size 2^( 4) =       0.000532667601
  error estimate for blocks of size 2^( 5) =       0.000542441404
  error estimate for blocks of size 2^( 6) =       0.000545623479
  error estimate for blocks of size 2^( 7) =       0.000546886718

      target function =      -0.744218675284
              le_mean =     -22.661857250917
             les_mean =     514.011121305953
             stat err =       0.000541904800
             autocorr =       1.329893698664
   target nu stat err =       0.000541904800
   target dn stat err =       0.003358227276
      target stat err =       0.002815438487
              std dev =       0.664552860784
             le_variance =       0.441630504777


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266185725092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744228441107       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744228441107       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744228441107       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744228441107       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744228441107       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744228441107       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744228441107       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744228441107       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744228441107       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+08 is 1.729317e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744228441107       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744228441107       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744228441107       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744228441107       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744228598614       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744228439019       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744228873462       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744230908634       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744231038882       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+09 is 4.317547e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744228441107       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744228441107       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744228441107       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744228441107       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744228441107       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744228441107       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744228441107       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744228441107       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744228441107       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+10 is 1.080796e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1476e+01
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -22.6296
    reference variance = 0.307843
====================================================
  Execution time = 2.5716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4980e-01
  Total weights = 1.9555e+06
  Execution time = 3.6108e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439965698661
                                         uncertainty =       0.002175387574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439965698661
                                         uncertainty =       0.002175387574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469052303
  error estimate for blocks of size 2^( 2) =       0.000492946869
  error estimate for blocks of size 2^( 3) =       0.000514872955
  error estimate for blocks of size 2^( 4) =       0.000530278134
  error estimate for blocks of size 2^( 5) =       0.000540136976
  error estimate for blocks of size 2^( 6) =       0.000543004134
  error estimate for blocks of size 2^( 7) =       0.000546731621

      target function =      -0.745499527764
              le_mean =     -22.663227305824
             les_mean =     514.071674152169
             stat err =       0.000540037716
             autocorr =       1.325579073766
   target nu stat err =       0.000540037716
   target dn stat err =       0.002939385537
      target stat err =       0.002493980916
              std dev =       0.663340127680
             le_variance =       0.440020124990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439965698661
                                         uncertainty =       0.002175387574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439965698661
                                         uncertainty =       0.002175387574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469052303
  error estimate for blocks of size 2^( 2) =       0.000492946869
  error estimate for blocks of size 2^( 3) =       0.000514872955
  error estimate for blocks of size 2^( 4) =       0.000530278134
  error estimate for blocks of size 2^( 5) =       0.000540136976
  error estimate for blocks of size 2^( 6) =       0.000543004134
  error estimate for blocks of size 2^( 7) =       0.000546731621

      target function =      -0.745499527764
              le_mean =     -22.663227305824
             les_mean =     514.071674152169
             stat err =       0.000540037716
             autocorr =       1.325579073767
   target nu stat err =       0.000540037716
   target dn stat err =       0.002939385537
      target stat err =       0.002493980916
              std dev =       0.663340127680
             le_variance =       0.440020124990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439965698661
                                         uncertainty =       0.002175387574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439965698661
                                         uncertainty =       0.002175387574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469052303
  error estimate for blocks of size 2^( 2) =       0.000492946869
  error estimate for blocks of size 2^( 3) =       0.000514872955
  error estimate for blocks of size 2^( 4) =       0.000530278134
  error estimate for blocks of size 2^( 5) =       0.000540136976
  error estimate for blocks of size 2^( 6) =       0.000543004134
  error estimate for blocks of size 2^( 7) =       0.000546731621

      target function =      -0.745499527764
              le_mean =     -22.663227305824
             les_mean =     514.071674152169
             stat err =       0.000540037716
             autocorr =       1.325579073771
   target nu stat err =       0.000540037716
   target dn stat err =       0.002939385537
      target stat err =       0.002493980916
              std dev =       0.663340127680
             le_variance =       0.440020124990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439965698661
                                         uncertainty =       0.002175387574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439965698661
                                         uncertainty =       0.002175387574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469052303
  error estimate for blocks of size 2^( 2) =       0.000492946869
  error estimate for blocks of size 2^( 3) =       0.000514872955
  error estimate for blocks of size 2^( 4) =       0.000530278134
  error estimate for blocks of size 2^( 5) =       0.000540136976
  error estimate for blocks of size 2^( 6) =       0.000543004134
  error estimate for blocks of size 2^( 7) =       0.000546731621

      target function =      -0.745499527764
              le_mean =     -22.663227305824
             les_mean =     514.071674152169
             stat err =       0.000540037716
             autocorr =       1.325579073769
   target nu stat err =       0.000540037716
   target dn stat err =       0.002939385537
      target stat err =       0.002493980916
              std dev =       0.663340127680
             le_variance =       0.440020124990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745499527764        initial  <--
     9.3132e+08     9.3132e+09             1.7293e-13        -0.745499527764
     3.7253e+09     3.7253e+10             4.3175e-14        -0.745499527764
     1.4901e+10     1.4901e+11             1.0808e-14        -0.745499527764

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8746
  </log>
  <optVariables href="FORM2.s042.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5358e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.6103
    reference variance = 0.271167
====================================================
  Execution time = 2.6665e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5148e-01
  Total weights = 1.954955786e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.1445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441911103862
                                         uncertainty =       0.002134217267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441911103862
                                         uncertainty =       0.002134217267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470018019
  error estimate for blocks of size 2^( 2) =       0.000493561534
  error estimate for blocks of size 2^( 3) =       0.000515506701
  error estimate for blocks of size 2^( 4) =       0.000531210606
  error estimate for blocks of size 2^( 5) =       0.000540042261
  error estimate for blocks of size 2^( 6) =       0.000543767539
  error estimate for blocks of size 2^( 7) =       0.000547979938

      target function =      -0.744117438103
              le_mean =     -22.662596516410
             les_mean =     514.044761566491
             stat err =       0.000540750086
             autocorr =       1.323622617886
   target nu stat err =       0.000540750086
   target dn stat err =       0.002713346977
      target stat err =       0.002303364656
              std dev =       0.664705856325
             le_variance =       0.441833875433


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266259651641e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744123590995       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744123590995       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744123590995       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744130030386       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744123590995       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744121145880       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744129886327       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744125899045       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744145221127       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744113053458       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744124238664       residual = 8.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+09 is 2.411300e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744123590995       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744123590995       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744123590995       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744123590995       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744123591008       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744123590995       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744120671125       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744126132652       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744177676150       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744121713744       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744226261408       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744150864905       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744152762786       residual = 7.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744113851982       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744100574012       residual = 8.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744191058036       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744101316138       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744175433722       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744028035629       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744219364809       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743885580132       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742106364138       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.736602986025       residual = 7.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743206944453       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740858803885       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742942638947       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.735006915305       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742524834995       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743958474648       residual = 5.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.719502101940       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743088808601       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744453563321       residual = 9.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746859988236       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745595333706       residual = 2.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.200909179597       residual = 4.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.044016042081       residual = 7.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.570604028264       residual = 1.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       0.235412599361       residual = 1.58e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       0.839605775029       residual = 7.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.110826155941       residual = 5.18e+04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =       0.053983297994       residual = 1.47e+04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =       7.344252028480       residual = 3.92e+06           smallest_sin_value = 9.99e-01
davidson iteration   42 stopping due to too large eigenvalue change
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+10 is 6.031515e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744123590995       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744123590995       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744123590995       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744117291320       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744214060481       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744087726576       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744041784617       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744215488418       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744234865339       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743819683873       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744098987169       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743927076770       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744471583627       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743748058460       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744271825060       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744612336026       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746146983226       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739154868261       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749341734789       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.737845813471       residual = 4.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.761443101679       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.734783667950       residual = 3.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743665002513       residual = 6.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748046001351       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743979781022       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740390612766       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749037047385       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736440314158       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.744113566802       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741187032571       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742903171352       residual = 9.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.741544084107       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.733317670602       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.722644874796       residual = 3.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.748333270388       residual = 9.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.718694113935       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.756465733151       residual = 1.12e-01           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.715353821814       residual = 3.64e-01           smallest_sin_value = 9.98e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.731537693742       residual = 2.86e-02           smallest_sin_value = 9.92e-01
davidson iteration   39 stopping due to small subspace S singular value of 9.54e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4901e+11 is 1.503711e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.251143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3518e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -22.7203
    reference variance = 0.458201
====================================================
  Execution time = 2.5919e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5381e-01
  Total weights = 1.9553e+06
  Execution time = 3.6048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294293091
                                         uncertainty =       0.003567049256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294293091
                                         uncertainty =       0.003567049256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470307884
  error estimate for blocks of size 2^( 2) =       0.000494383901
  error estimate for blocks of size 2^( 3) =       0.000516546754
  error estimate for blocks of size 2^( 4) =       0.000531932965
  error estimate for blocks of size 2^( 5) =       0.000541113638
  error estimate for blocks of size 2^( 6) =       0.000547560396
  error estimate for blocks of size 2^( 7) =       0.000548690891

      target function =      -0.742199418435
              le_mean =     -22.661645545150
             les_mean =     514.003991065180
             stat err =       0.000542324473
             autocorr =       1.329700668101
   target nu stat err =       0.000542324473
   target dn stat err =       0.004020311703
      target stat err =       0.003328766380
              std dev =       0.665115788016
             le_variance =       0.442379011469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294293091
                                         uncertainty =       0.003567049256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294293091
                                         uncertainty =       0.003567049256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470307884
  error estimate for blocks of size 2^( 2) =       0.000494383901
  error estimate for blocks of size 2^( 3) =       0.000516546754
  error estimate for blocks of size 2^( 4) =       0.000531932965
  error estimate for blocks of size 2^( 5) =       0.000541113638
  error estimate for blocks of size 2^( 6) =       0.000547560396
  error estimate for blocks of size 2^( 7) =       0.000548690891

      target function =      -0.742199418435
              le_mean =     -22.661645545150
             les_mean =     514.003991065180
             stat err =       0.000542324473
             autocorr =       1.329700668102
   target nu stat err =       0.000542324473
   target dn stat err =       0.004020311703
      target stat err =       0.003328766380
              std dev =       0.665115788016
             le_variance =       0.442379011469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294293091
                                         uncertainty =       0.003567049256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294293091
                                         uncertainty =       0.003567049256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470307884
  error estimate for blocks of size 2^( 2) =       0.000494383901
  error estimate for blocks of size 2^( 3) =       0.000516546754
  error estimate for blocks of size 2^( 4) =       0.000531932965
  error estimate for blocks of size 2^( 5) =       0.000541113638
  error estimate for blocks of size 2^( 6) =       0.000547560396
  error estimate for blocks of size 2^( 7) =       0.000548690891

      target function =      -0.742199418435
              le_mean =     -22.661645545150
             les_mean =     514.003991065180
             stat err =       0.000542324473
             autocorr =       1.329700668103
   target nu stat err =       0.000542324473
   target dn stat err =       0.004020311703
      target stat err =       0.003328766380
              std dev =       0.665115788016
             le_variance =       0.442379011469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294293091
                                         uncertainty =       0.003567049256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442294293091
                                         uncertainty =       0.003567049256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470307884
  error estimate for blocks of size 2^( 2) =       0.000494383901
  error estimate for blocks of size 2^( 3) =       0.000516546754
  error estimate for blocks of size 2^( 4) =       0.000531932965
  error estimate for blocks of size 2^( 5) =       0.000541113638
  error estimate for blocks of size 2^( 6) =       0.000547560396
  error estimate for blocks of size 2^( 7) =       0.000548690891

      target function =      -0.742199418435
              le_mean =     -22.661645545150
             les_mean =     514.003991065180
             stat err =       0.000542324473
             autocorr =       1.329700668101
   target nu stat err =       0.000542324473
   target dn stat err =       0.004020311703
      target stat err =       0.003328766380
              std dev =       0.665115788016
             le_variance =       0.442379011469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742199418435        initial
     9.3132e+09     9.3132e+10             2.4113e-14        -0.742199418435  <--
     3.7253e+10     3.7253e+11             6.0315e-15        -0.742199418435
     1.4901e+11     1.4901e+12             1.5037e-15        -0.742199418435

*****************************************************************************
Applying the update for shift_i =   9.3132e+09     and shift_s =   9.3132e+10
*****************************************************************************

  Execution time = 4.3960e+01
  </log>
  <optVariables href="FORM2.s043.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.5915
    reference variance = 0.338415
====================================================
  Execution time = 2.6798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5475e-01
  Total weights = 1.954724585e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441572482207
                                         uncertainty =       0.003036399241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441572482207
                                         uncertainty =       0.003036399241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469871390
  error estimate for blocks of size 2^( 2) =       0.000493741094
  error estimate for blocks of size 2^( 3) =       0.000515332190
  error estimate for blocks of size 2^( 4) =       0.000531069102
  error estimate for blocks of size 2^( 5) =       0.000539493550
  error estimate for blocks of size 2^( 6) =       0.000546019551
  error estimate for blocks of size 2^( 7) =       0.000548720484

      target function =      -0.741425960493
              le_mean =     -22.662539092501
             les_mean =     514.045429106117
             stat err =       0.000541325672
             autocorr =       1.327269891363
   target nu stat err =       0.000541325672
   target dn stat err =       0.005402940084
      target stat err =       0.004438144074
              std dev =       0.664498492260
             le_variance =       0.441558246215


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266253909250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741451467825       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741451467825       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741451467825       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741451467825       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741451089063       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741451314044       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741451467825       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741451783742       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741454804024       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741452061908       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741445253382       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741451760317       residual = 5.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+09 is 2.269793e-13

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741451467825       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741451467825       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741451467825       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741451467825       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741459083851       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741456670465       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741440137106       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741448907419       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741465232913       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741460483213       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741446139111       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741453960002       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741452649799       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741490889846       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741442870867       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741453241132       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741438299356       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741460319021       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741443700348       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741346028234       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741445327030       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741658508273       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741627938246       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741324155152       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739505253697       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.732925326084       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.751194743348       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741091219208       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736792991524       residual = 4.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.738032753001       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.758215749415       residual = 3.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.733232191866       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745677189382       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.742641408669       residual = 5.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.553591235000       residual = 5.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.224031863617       residual = 4.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.163139273719       residual = 1.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.765000068834       residual = 2.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       0.880316308514       residual = 1.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   39 stopping due to too large eigenvalue change
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+09 is 5.671495e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741451467825       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741451467825       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741451467825       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741451467825       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741422390023       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741462852312       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741450319750       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741426526502       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741401917702       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741529186417       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741510093147       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741500382608       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741442845447       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741472221350       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741467737934       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741559422881       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740946418697       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741089994936       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741106321237       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742132142914       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738981117247       residual = 6.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742557856601       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740170141413       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741349901852       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743361675042       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741972552550       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739063269327       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749236785847       residual = 5.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.737677998121       residual = 8.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.690539037682       residual = 2.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.737192126182       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.737497768195       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744077320758       residual = 5.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.337592992780       residual = 4.27e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.568421409265       residual = 6.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.989312246908       residual = 5.97e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.377066532791       residual = 1.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.862636315805       residual = 1.12e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.771520376580       residual = 2.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       2.025153142137       residual = 1.82e+04           smallest_sin_value = 1.00e+00
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+10 is 1.416335e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302598 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1620e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -22.648
    reference variance = 0.340004
====================================================
  Execution time = 2.5894e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4959e-01
  Total weights = 1.9550e+06
  Execution time = 3.6119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440886547623
                                         uncertainty =       0.002136615578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440886547623
                                         uncertainty =       0.002136615578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469512554
  error estimate for blocks of size 2^( 2) =       0.000493491297
  error estimate for blocks of size 2^( 3) =       0.000516003181
  error estimate for blocks of size 2^( 4) =       0.000531440040
  error estimate for blocks of size 2^( 5) =       0.000539985701
  error estimate for blocks of size 2^( 6) =       0.000544010099
  error estimate for blocks of size 2^( 7) =       0.000545733216

      target function =      -0.745663263054
              le_mean =     -22.661581565469
             les_mean =     513.996868881614
             stat err =       0.000540292264
             autocorr =       1.324228957656
   target nu stat err =       0.000540292264
   target dn stat err =       0.002533272438
      target stat err =       0.002166316764
              std dev =       0.663991021341
             le_variance =       0.440884076421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440886547623
                                         uncertainty =       0.002136615578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440886547623
                                         uncertainty =       0.002136615578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469512554
  error estimate for blocks of size 2^( 2) =       0.000493491297
  error estimate for blocks of size 2^( 3) =       0.000516003181
  error estimate for blocks of size 2^( 4) =       0.000531440040
  error estimate for blocks of size 2^( 5) =       0.000539985701
  error estimate for blocks of size 2^( 6) =       0.000544010099
  error estimate for blocks of size 2^( 7) =       0.000545733216

      target function =      -0.745663263054
              le_mean =     -22.661581565469
             les_mean =     513.996868881614
             stat err =       0.000540292264
             autocorr =       1.324228957659
   target nu stat err =       0.000540292264
   target dn stat err =       0.002533272438
      target stat err =       0.002166316764
              std dev =       0.663991021341
             le_variance =       0.440884076421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440886547623
                                         uncertainty =       0.002136615578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440886547623
                                         uncertainty =       0.002136615578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469512554
  error estimate for blocks of size 2^( 2) =       0.000493491297
  error estimate for blocks of size 2^( 3) =       0.000516003181
  error estimate for blocks of size 2^( 4) =       0.000531440040
  error estimate for blocks of size 2^( 5) =       0.000539985701
  error estimate for blocks of size 2^( 6) =       0.000544010099
  error estimate for blocks of size 2^( 7) =       0.000545733216

      target function =      -0.745663263054
              le_mean =     -22.661581565469
             les_mean =     513.996868881614
             stat err =       0.000540292264
             autocorr =       1.324228957660
   target nu stat err =       0.000540292264
   target dn stat err =       0.002533272438
      target stat err =       0.002166316764
              std dev =       0.663991021341
             le_variance =       0.440884076421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440886547623
                                         uncertainty =       0.002136615578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440886547623
                                         uncertainty =       0.002136615578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469512554
  error estimate for blocks of size 2^( 2) =       0.000493491297
  error estimate for blocks of size 2^( 3) =       0.000516003181
  error estimate for blocks of size 2^( 4) =       0.000531440040
  error estimate for blocks of size 2^( 5) =       0.000539985701
  error estimate for blocks of size 2^( 6) =       0.000544010099
  error estimate for blocks of size 2^( 7) =       0.000545733216

      target function =      -0.745663263054
              le_mean =     -22.661581565469
             les_mean =     513.996868881614
             stat err =       0.000540292264
             autocorr =       1.324228957659
   target nu stat err =       0.000540292264
   target dn stat err =       0.002533272438
      target stat err =       0.002166316764
              std dev =       0.663991021341
             le_variance =       0.440884076421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745663263054        initial
     2.3283e+09     2.3283e+10             2.2698e-13        -0.745663263054  <--
     9.3132e+09     9.3132e+10             5.6715e-14        -0.745663263054
     3.7253e+10     3.7253e+11             1.4163e-14        -0.745663263054

*****************************************************************************
Applying the update for shift_i =   2.3283e+09     and shift_s =   2.3283e+10
*****************************************************************************

  Execution time = 4.3972e+01
  </log>
  <optVariables href="FORM2.s044.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5599e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.6219
    reference variance = 0.328812
====================================================
  Execution time = 2.6580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5226e-01
  Total weights = 1.955327669e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442513292135
                                         uncertainty =       0.002369435415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442513292135
                                         uncertainty =       0.002369435415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470466662
  error estimate for blocks of size 2^( 2) =       0.000494550676
  error estimate for blocks of size 2^( 3) =       0.000516621887
  error estimate for blocks of size 2^( 4) =       0.000532513331
  error estimate for blocks of size 2^( 5) =       0.000543524796
  error estimate for blocks of size 2^( 6) =       0.000549682183
  error estimate for blocks of size 2^( 7) =       0.000554134030

      target function =      -0.743466313181
              le_mean =     -22.661233612277
             les_mean =     513.983772270173
             stat err =       0.000544963585
             autocorr =       1.341767469608
   target nu stat err =       0.000544963585
   target dn stat err =       0.003127157563
      target stat err =       0.002623881451
              std dev =       0.665340333779
             le_variance =       0.442677759753


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266123361228e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743474650145       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743474650145       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743474650145       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743474650145       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743474650142       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743474650144       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743474583583       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743475162905       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743474428403       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743473689092       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743475688048       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+08 is 5.113978e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743474650145       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743474650145       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743474650145       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743474650145       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743474650141       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743474649970       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743474818757       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743475396231       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743476862099       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743471613451       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743473311870       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+09 is 1.278202e-13

solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743474650145       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743474650145       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743474650145       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743474400610       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743474733672       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743474210772       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743483187309       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743466501191       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743455374009       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743473248388       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743476084104       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743459519528       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743451520424       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743441545169       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743475676057       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+09 is 3.224005e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1303e+01
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -22.7123
    reference variance = 0.597133
====================================================
  Execution time = 2.5766e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5131e-01
  Total weights = 1.9550e+06
  Execution time = 3.5910e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442933652854
                                         uncertainty =       0.003006032825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442933652854
                                         uncertainty =       0.003006032825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470775820
  error estimate for blocks of size 2^( 2) =       0.000494163156
  error estimate for blocks of size 2^( 3) =       0.000516151183
  error estimate for blocks of size 2^( 4) =       0.000532080141
  error estimate for blocks of size 2^( 5) =       0.000540503466
  error estimate for blocks of size 2^( 6) =       0.000545056335
  error estimate for blocks of size 2^( 7) =       0.000547403627

      target function =      -0.744250411564
              le_mean =     -22.662299232243
             les_mean =     514.031117650424
             stat err =       0.000541260892
             autocorr =       1.321858601839
   target nu stat err =       0.000541260892
   target dn stat err =       0.003450269681
      target stat err =       0.002891171255
              std dev =       0.665777548961
             le_variance =       0.443259744701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442933652854
                                         uncertainty =       0.003006032825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442933652854
                                         uncertainty =       0.003006032825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470775820
  error estimate for blocks of size 2^( 2) =       0.000494163156
  error estimate for blocks of size 2^( 3) =       0.000516151183
  error estimate for blocks of size 2^( 4) =       0.000532080141
  error estimate for blocks of size 2^( 5) =       0.000540503466
  error estimate for blocks of size 2^( 6) =       0.000545056335
  error estimate for blocks of size 2^( 7) =       0.000547403627

      target function =      -0.744250411564
              le_mean =     -22.662299232243
             les_mean =     514.031117650424
             stat err =       0.000541260892
             autocorr =       1.321858601839
   target nu stat err =       0.000541260892
   target dn stat err =       0.003450269681
      target stat err =       0.002891171255
              std dev =       0.665777548961
             le_variance =       0.443259744701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442933652854
                                         uncertainty =       0.003006032825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442933652854
                                         uncertainty =       0.003006032825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470775820
  error estimate for blocks of size 2^( 2) =       0.000494163156
  error estimate for blocks of size 2^( 3) =       0.000516151183
  error estimate for blocks of size 2^( 4) =       0.000532080141
  error estimate for blocks of size 2^( 5) =       0.000540503466
  error estimate for blocks of size 2^( 6) =       0.000545056335
  error estimate for blocks of size 2^( 7) =       0.000547403627

      target function =      -0.744250411564
              le_mean =     -22.662299232243
             les_mean =     514.031117650424
             stat err =       0.000541260892
             autocorr =       1.321858601839
   target nu stat err =       0.000541260892
   target dn stat err =       0.003450269681
      target stat err =       0.002891171255
              std dev =       0.665777548961
             le_variance =       0.443259744701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442933652854
                                         uncertainty =       0.003006032825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442933652854
                                         uncertainty =       0.003006032825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470775820
  error estimate for blocks of size 2^( 2) =       0.000494163156
  error estimate for blocks of size 2^( 3) =       0.000516151183
  error estimate for blocks of size 2^( 4) =       0.000532080141
  error estimate for blocks of size 2^( 5) =       0.000540503466
  error estimate for blocks of size 2^( 6) =       0.000545056335
  error estimate for blocks of size 2^( 7) =       0.000547403627

      target function =      -0.744250411564
              le_mean =     -22.662299232243
             les_mean =     514.031117650424
             stat err =       0.000541260892
             autocorr =       1.321858601839
   target nu stat err =       0.000541260892
   target dn stat err =       0.003450269681
      target stat err =       0.002891171255
              std dev =       0.665777548961
             le_variance =       0.443259744701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744250411564        initial  <--
     5.8208e+08     5.8208e+09             5.1140e-13        -0.744250411564
     2.3283e+09     2.3283e+10             1.2782e-13        -0.744250411564
     9.3132e+09     9.3132e+10             3.2240e-14        -0.744250411564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.7755
  </log>
  <optVariables href="FORM2.s045.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5085e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.6602
    reference variance = 0.58677
====================================================
  Execution time = 2.6702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5649e-01
  Total weights = 1.955191980e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443395219852
                                         uncertainty =       0.002606772001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443395219852
                                         uncertainty =       0.002606772001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470855896
  error estimate for blocks of size 2^( 2) =       0.000495015187
  error estimate for blocks of size 2^( 3) =       0.000517065361
  error estimate for blocks of size 2^( 4) =       0.000532756890
  error estimate for blocks of size 2^( 5) =       0.000540927888
  error estimate for blocks of size 2^( 6) =       0.000544367948
  error estimate for blocks of size 2^( 7) =       0.000549177230

      target function =      -0.740013131444
              le_mean =     -22.662027931370
             les_mean =     514.024002108823
             stat err =       0.000541807489
             autocorr =       1.324079252449
   target nu stat err =       0.000541807489
   target dn stat err =       0.005231522776
      target stat err =       0.004280509785
              std dev =       0.665890794587
             le_variance =       0.443410550315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266202793137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740036818772       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740036818772       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740036818772       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740036818772       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740036818772       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740040090962       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740034914052       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740022734494       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740053671813       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740041876147       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740040765089       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740029622728       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740036818772       residual = 8.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+09 is 5.387465e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740036818772       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740036818772       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740036818772       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740036818772       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740035331721       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740037629553       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740036299201       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740055567897       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740045924967       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739994826580       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740061347699       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739944479460       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740008188531       residual = 9.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740018937135       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740095077955       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740022757537       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740324636023       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740085923758       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739816189603       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740094155887       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740062570544       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740464547482       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745110302141       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740739689006       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.738136041603       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.731783687776       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747636068422       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.732845332542       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.673326683017       residual = 1.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.722736275232       residual = 9.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.730055031382       residual = 7.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.726049151739       residual = 3.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.561011118027       residual = 7.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       0.051702714902       residual = 1.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.003254051359       residual = 1.37e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -5.605168237701       residual = 5.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       3.416957486087       residual = 7.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   37 stopping due to too large eigenvalue change
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+10 is 1.351605e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740036818772       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740036818772       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740036818772       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740036818772       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740036818772       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740036818772       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740036818772       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740026565254       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740036818772       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740036818772       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740036818772       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740036818772       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740036818772       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739753125988       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740095951077       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740107595279       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739836275711       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739962947513       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739909285526       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739975968927       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738864592930       residual = 2.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741507996768       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740016772879       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740193332452       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742603668147       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741177951426       residual = 3.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.731680540412       residual = 2.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736082759284       residual = 8.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736960338938       residual = 2.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747222109316       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747370810998       residual = 8.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.709721717397       residual = 1.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.147763089567       residual = 9.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.086443894746       residual = 2.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.500727261439       residual = 6.67e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -9.798321134171       residual = 2.58e+05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.299980036328       residual = 2.59e+05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       0.570546294360       residual = 4.98e+04           smallest_sin_value = 1.00e+00
davidson iteration   38 stopping due to too large eigenvalue change
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+10 is 3.408774e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1482e+01
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -22.651
    reference variance = 0.42063
====================================================
  Execution time = 2.5881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5005e-01
  Total weights = 1.9555e+06
  Execution time = 3.5885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440895699377
                                         uncertainty =       0.002025267854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440895699377
                                         uncertainty =       0.002025267854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469523937
  error estimate for blocks of size 2^( 2) =       0.000493359168
  error estimate for blocks of size 2^( 3) =       0.000514672090
  error estimate for blocks of size 2^( 4) =       0.000530450650
  error estimate for blocks of size 2^( 5) =       0.000540419568
  error estimate for blocks of size 2^( 6) =       0.000544806375
  error estimate for blocks of size 2^( 7) =       0.000549793039

      target function =      -0.745289524743
              le_mean =     -22.662536366710
             les_mean =     514.040607026680
             stat err =       0.000541367408
             autocorr =       1.329439981957
   target nu stat err =       0.000541367408
   target dn stat err =       0.002791330057
      target stat err =       0.002372373673
              std dev =       0.664007120056
             le_variance =       0.440905455485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440895699377
                                         uncertainty =       0.002025267854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440895699377
                                         uncertainty =       0.002025267854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469523937
  error estimate for blocks of size 2^( 2) =       0.000493359168
  error estimate for blocks of size 2^( 3) =       0.000514672090
  error estimate for blocks of size 2^( 4) =       0.000530450650
  error estimate for blocks of size 2^( 5) =       0.000540419568
  error estimate for blocks of size 2^( 6) =       0.000544806375
  error estimate for blocks of size 2^( 7) =       0.000549793039

      target function =      -0.745289524743
              le_mean =     -22.662536366710
             les_mean =     514.040607026680
             stat err =       0.000541367408
             autocorr =       1.329439981961
   target nu stat err =       0.000541367408
   target dn stat err =       0.002791330057
      target stat err =       0.002372373673
              std dev =       0.664007120056
             le_variance =       0.440905455485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440895699377
                                         uncertainty =       0.002025267854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440895699377
                                         uncertainty =       0.002025267854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469523937
  error estimate for blocks of size 2^( 2) =       0.000493359168
  error estimate for blocks of size 2^( 3) =       0.000514672090
  error estimate for blocks of size 2^( 4) =       0.000530450650
  error estimate for blocks of size 2^( 5) =       0.000540419568
  error estimate for blocks of size 2^( 6) =       0.000544806375
  error estimate for blocks of size 2^( 7) =       0.000549793039

      target function =      -0.745289524743
              le_mean =     -22.662536366710
             les_mean =     514.040607026680
             stat err =       0.000541367408
             autocorr =       1.329439981958
   target nu stat err =       0.000541367408
   target dn stat err =       0.002791330057
      target stat err =       0.002372373673
              std dev =       0.664007120056
             le_variance =       0.440905455485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440895699377
                                         uncertainty =       0.002025267854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440895699377
                                         uncertainty =       0.002025267854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469523937
  error estimate for blocks of size 2^( 2) =       0.000493359168
  error estimate for blocks of size 2^( 3) =       0.000514672090
  error estimate for blocks of size 2^( 4) =       0.000530450650
  error estimate for blocks of size 2^( 5) =       0.000540419568
  error estimate for blocks of size 2^( 6) =       0.000544806375
  error estimate for blocks of size 2^( 7) =       0.000549793039

      target function =      -0.745289524743
              le_mean =     -22.662536366710
             les_mean =     514.040607026680
             stat err =       0.000541367408
             autocorr =       1.329439981960
   target nu stat err =       0.000541367408
   target dn stat err =       0.002791330057
      target stat err =       0.002372373673
              std dev =       0.664007120056
             le_variance =       0.440905455485


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745289524743        initial  <--
     5.8208e+09     5.8208e+10             5.3875e-14        -0.745289524743
     2.3283e+10     2.3283e+11             1.3516e-14        -0.745289524743
     9.3132e+10     9.3132e+11             3.4088e-15        -0.745289524743

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.8278
  </log>
  <optVariables href="FORM2.s046.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6629
    reference variance = 0.310595
====================================================
  Execution time = 2.8249e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5013e-01
  Total weights = 1.955409542e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442256815553
                                         uncertainty =       0.002398120431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442256815553
                                         uncertainty =       0.002398120431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470260228
  error estimate for blocks of size 2^( 2) =       0.000494427262
  error estimate for blocks of size 2^( 3) =       0.000516256460
  error estimate for blocks of size 2^( 4) =       0.000532214102
  error estimate for blocks of size 2^( 5) =       0.000540867032
  error estimate for blocks of size 2^( 6) =       0.000544435923
  error estimate for blocks of size 2^( 7) =       0.000546312803

      target function =      -0.745221366070
              le_mean =     -22.661842583270
             les_mean =     514.009239011469
             stat err =       0.000540957465
             autocorr =       1.323273870447
   target nu stat err =       0.000540957465
   target dn stat err =       0.002638824986
      target stat err =       0.002248371292
              std dev =       0.665048391776
             le_variance =       0.442289363404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266184258327e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745227210643       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745227210643       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745227210643       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745227210643       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745202273152       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745243399683       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745223936143       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745202927077       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745112343860       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745321682069       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745163045864       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745330759173       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745156219654       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745141589102       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745299295245       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745291915209       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745430254306       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745704239204       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745547742734       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746470471736       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743936774440       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743539302194       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744682072923       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.745445420031       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744951740218       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745646233761       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741121394805       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745737019998       residual = 8.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747182605727       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.746662284198       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747416742807       residual = 8.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744673457709       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.741676006863       residual = 7.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.109286258225       residual = 6.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.944261160175       residual = 7.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       2.555697223924       residual = 5.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -9.042336845036       residual = 2.46e+05           smallest_sin_value = 1.00e+00
davidson iteration   37 stopping due to too large eigenvalue change
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+10 is 3.058045e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745227210643       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745227210643       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745227210643       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745227210643       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745227210643       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745227210643       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745227212634       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745225975859       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745326117278       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745380222583       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745358174469       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745145335653       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745421449691       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745032367495       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745843573817       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745179432624       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745473052263       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745045515988       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745381122029       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745610795261       residual = 3.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.752891406063       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748673621281       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.899397992365       residual = 5.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.612732610030       residual = 4.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.966716391119       residual = 3.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.891706877741       residual = 8.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.774124387404       residual = 3.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -2.340857418974       residual = 2.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.050273400122       residual = 2.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.099133996815       residual = 3.21e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       1.164357522514       residual = 2.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.779977846833       residual = 8.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+11 is 7.783825e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745227210643       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745227210643       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745227210643       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745149019702       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745227210643       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745227210643       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745227682962       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744789205470       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744585055370       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746848834395       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745643126150       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745835683249       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745165537192       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744638396750       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745959842842       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.755725508862       residual = 2.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739273258861       residual = 1.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744427511680       residual = 8.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.752218325748       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.732417571415       residual = 7.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.664666053580       residual = 3.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.630624703677       residual = 3.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       0.082150452213       residual = 2.33e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.920537296211       residual = 8.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.226563505524       residual = 1.97e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.093411755305       residual = 3.17e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.601668814733       residual = 9.10e+04           smallest_sin_value = 1.00e+00
davidson iteration   27 stopping due to too large eigenvalue change
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+11 is 1.953408e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.396190 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3163e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -22.6842
    reference variance = 0.516977
====================================================
  Execution time = 2.6021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5493e-01
  Total weights = 1.9551e+06
  Execution time = 3.5940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444905629826
                                         uncertainty =       0.005502465744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444905629826
                                         uncertainty =       0.005502465744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471636778
  error estimate for blocks of size 2^( 2) =       0.000495221206
  error estimate for blocks of size 2^( 3) =       0.000516462453
  error estimate for blocks of size 2^( 4) =       0.000532148895
  error estimate for blocks of size 2^( 5) =       0.000541056109
  error estimate for blocks of size 2^( 6) =       0.000544138758
  error estimate for blocks of size 2^( 7) =       0.000546996765

      target function =      -0.741266185347
              le_mean =     -22.661815099925
             les_mean =     514.012797439770
             stat err =       0.000541085132
             autocorr =       1.316181773184
   target nu stat err =       0.000541085132
   target dn stat err =       0.006293391115
      target stat err =       0.005149692142
              std dev =       0.666995128540
             le_variance =       0.444882501496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444905629826
                                         uncertainty =       0.005502465744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444905629826
                                         uncertainty =       0.005502465744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471636778
  error estimate for blocks of size 2^( 2) =       0.000495221206
  error estimate for blocks of size 2^( 3) =       0.000516462453
  error estimate for blocks of size 2^( 4) =       0.000532148895
  error estimate for blocks of size 2^( 5) =       0.000541056109
  error estimate for blocks of size 2^( 6) =       0.000544138758
  error estimate for blocks of size 2^( 7) =       0.000546996765

      target function =      -0.741266185347
              le_mean =     -22.661815099925
             les_mean =     514.012797439770
             stat err =       0.000541085132
             autocorr =       1.316181773186
   target nu stat err =       0.000541085132
   target dn stat err =       0.006293391115
      target stat err =       0.005149692142
              std dev =       0.666995128540
             le_variance =       0.444882501496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444905629826
                                         uncertainty =       0.005502465744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444905629826
                                         uncertainty =       0.005502465744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471636778
  error estimate for blocks of size 2^( 2) =       0.000495221206
  error estimate for blocks of size 2^( 3) =       0.000516462453
  error estimate for blocks of size 2^( 4) =       0.000532148895
  error estimate for blocks of size 2^( 5) =       0.000541056109
  error estimate for blocks of size 2^( 6) =       0.000544138758
  error estimate for blocks of size 2^( 7) =       0.000546996765

      target function =      -0.741266185347
              le_mean =     -22.661815099925
             les_mean =     514.012797439770
             stat err =       0.000541085132
             autocorr =       1.316181773186
   target nu stat err =       0.000541085132
   target dn stat err =       0.006293391115
      target stat err =       0.005149692142
              std dev =       0.666995128540
             le_variance =       0.444882501496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444905629826
                                         uncertainty =       0.005502465744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444905629826
                                         uncertainty =       0.005502465744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471636778
  error estimate for blocks of size 2^( 2) =       0.000495221206
  error estimate for blocks of size 2^( 3) =       0.000516462453
  error estimate for blocks of size 2^( 4) =       0.000532148895
  error estimate for blocks of size 2^( 5) =       0.000541056109
  error estimate for blocks of size 2^( 6) =       0.000544138758
  error estimate for blocks of size 2^( 7) =       0.000546996765

      target function =      -0.741266185347
              le_mean =     -22.661815099925
             les_mean =     514.012797439770
             stat err =       0.000541085132
             autocorr =       1.316181773186
   target nu stat err =       0.000541085132
   target dn stat err =       0.006293391115
      target stat err =       0.005149692142
              std dev =       0.666995128540
             le_variance =       0.444882501496


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741266185347        initial
     5.8208e+10     5.8208e+11             3.0580e-15        -0.741266185347
     2.3283e+11     2.3283e+12             7.7838e-16        -0.741266185347
     9.3132e+11     9.3132e+12             1.9534e-16        -0.741266185347  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+11     and shift_s =   9.3132e+12
*****************************************************************************

  Execution time = 4.4049e+01
  </log>
  <optVariables href="FORM2.s047.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6202
    reference variance = 0.272501
====================================================
  Execution time = 2.6616e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4641e-01
  Total weights = 1.955769291e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437506733248
                                         uncertainty =       0.001770358246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437506733248
                                         uncertainty =       0.001770358246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467782718
  error estimate for blocks of size 2^( 2) =       0.000492108895
  error estimate for blocks of size 2^( 3) =       0.000513482942
  error estimate for blocks of size 2^( 4) =       0.000529779900
  error estimate for blocks of size 2^( 5) =       0.000537760962
  error estimate for blocks of size 2^( 6) =       0.000543004555
  error estimate for blocks of size 2^( 7) =       0.000548117216

      target function =      -0.748297384133
              le_mean =     -22.662426112268
             les_mean =     514.031968540621
             stat err =       0.000539665658
             autocorr =       1.330948400057
   target nu stat err =       0.000539665658
   target dn stat err =       0.002323292153
      target stat err =       0.002016740129
              std dev =       0.661544664396
             le_variance =       0.437641342990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266242611227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748301916738       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748301916738       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748301916738       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748301916738       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748301916740       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748301917285       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748299402734       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748323456312       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.748021641539       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747605954147       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748430241406       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747817984467       residual = 8.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748479240938       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748021386185       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748464665633       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746468718413       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749280033089       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.754588640527       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.729212760838       residual = 4.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.763617290451       residual = 2.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.445233357167       residual = 1.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.861397444567       residual = 1.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.378982181908       residual = 7.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.206409843847       residual = 3.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.171810869683       residual = 2.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.682506058768       residual = 2.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.722399644303       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.292425735913       residual = 3.92e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.769102726454       residual = 9.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.306524771265       residual = 3.33e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.857205252554       residual = 6.82e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       4.384739790813       residual = 1.94e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.258247914418       residual = 2.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+11 is 7.581077e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748301916738       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748301916738       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748301916738       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748301916738       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748301916738       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748301916738       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748302306377       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748298762858       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747307447822       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749638027236       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749763116121       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748250999601       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748783459231       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749506302600       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746410666997       residual = 6.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748687205500       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747881195086       residual = 2.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750864567050       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749150792632       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.752834957512       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746790106663       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.751463744561       residual = 5.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743643583448       residual = 2.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.735514598224       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.713481637460       residual = 1.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749321901565       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.854889145587       residual = 4.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739030997290       residual = 3.92e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.561442294491       residual = 1.10e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.966927208859       residual = 1.40e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -4.449496240712       residual = 2.61e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.774765436260       residual = 3.55e+04           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+11 is 1.913043e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.748301916738       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.748301916738       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.748301916738       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.748301916738       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.748301916735       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748301915889       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.748302028981       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748312004420       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.750671456076       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744075813610       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738214615124       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747350384893       residual = 2.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.758259126800       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.752239680457       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743927971144       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.756869025167       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.763788417646       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.752456043674       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.766117317409       residual = 6.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748953494297       residual = 2.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.772464446594       residual = 8.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748076755017       residual = 4.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.225636324765       residual = 1.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       3.383914715646       residual = 1.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+12 is 4.843314e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.431848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1364e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -22.6605
    reference variance = 0.340423
====================================================
  Execution time = 2.5965e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4970e-01
  Total weights = 1.9549e+06
  Execution time = 3.6078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364123530
                                         uncertainty =       0.001945709401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364123530
                                         uncertainty =       0.001945709401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468697030
  error estimate for blocks of size 2^( 2) =       0.000492871867
  error estimate for blocks of size 2^( 3) =       0.000514792943
  error estimate for blocks of size 2^( 4) =       0.000529997679
  error estimate for blocks of size 2^( 5) =       0.000538822543
  error estimate for blocks of size 2^( 6) =       0.000544004033
  error estimate for blocks of size 2^( 7) =       0.000546922831

      target function =      -0.745571408837
              le_mean =     -22.661977838628
             les_mean =     514.014944087863
             stat err =       0.000539936772
             autocorr =       1.327093152558
   target nu stat err =       0.000539936772
   target dn stat err =       0.002778185877
      target stat err =       0.002361289888
              std dev =       0.662837696309
             le_variance =       0.439353811649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364123530
                                         uncertainty =       0.001945709401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364123530
                                         uncertainty =       0.001945709401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468697030
  error estimate for blocks of size 2^( 2) =       0.000492871867
  error estimate for blocks of size 2^( 3) =       0.000514792943
  error estimate for blocks of size 2^( 4) =       0.000529997679
  error estimate for blocks of size 2^( 5) =       0.000538822543
  error estimate for blocks of size 2^( 6) =       0.000544004033
  error estimate for blocks of size 2^( 7) =       0.000546922831

      target function =      -0.745571408837
              le_mean =     -22.661977838628
             les_mean =     514.014944087863
             stat err =       0.000539936772
             autocorr =       1.327093152556
   target nu stat err =       0.000539936772
   target dn stat err =       0.002778185877
      target stat err =       0.002361289888
              std dev =       0.662837696309
             le_variance =       0.439353811649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364123530
                                         uncertainty =       0.001945709401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364123530
                                         uncertainty =       0.001945709401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468697030
  error estimate for blocks of size 2^( 2) =       0.000492871867
  error estimate for blocks of size 2^( 3) =       0.000514792943
  error estimate for blocks of size 2^( 4) =       0.000529997679
  error estimate for blocks of size 2^( 5) =       0.000538822543
  error estimate for blocks of size 2^( 6) =       0.000544004033
  error estimate for blocks of size 2^( 7) =       0.000546922831

      target function =      -0.745571408837
              le_mean =     -22.661977838628
             les_mean =     514.014944087863
             stat err =       0.000539936772
             autocorr =       1.327093152558
   target nu stat err =       0.000539936772
   target dn stat err =       0.002778185877
      target stat err =       0.002361289888
              std dev =       0.662837696309
             le_variance =       0.439353811649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364123530
                                         uncertainty =       0.001945709401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439364123530
                                         uncertainty =       0.001945709401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468697030
  error estimate for blocks of size 2^( 2) =       0.000492871867
  error estimate for blocks of size 2^( 3) =       0.000514792943
  error estimate for blocks of size 2^( 4) =       0.000529997679
  error estimate for blocks of size 2^( 5) =       0.000538822543
  error estimate for blocks of size 2^( 6) =       0.000544004033
  error estimate for blocks of size 2^( 7) =       0.000546922831

      target function =      -0.745571408837
              le_mean =     -22.661977838628
             les_mean =     514.014944087863
             stat err =       0.000539936772
             autocorr =       1.327093152558
   target nu stat err =       0.000539936772
   target dn stat err =       0.002778185877
      target stat err =       0.002361289888
              std dev =       0.662837696309
             le_variance =       0.439353811649


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745571408837        initial
     2.3283e+11     2.3283e+12             7.5811e-16        -0.745571408837  <--
     9.3132e+11     9.3132e+12             1.9130e-16        -0.745571408837
     3.7253e+12     3.7253e+13             4.8433e-17        -0.745571408837

*****************************************************************************
Applying the update for shift_i =   2.3283e+11     and shift_s =   2.3283e+12
*****************************************************************************

  Execution time = 4.4060e+01
  </log>
  <optVariables href="FORM2.s048.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.692
    reference variance = 0.347709
====================================================
  Execution time = 2.6641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5507e-01
  Total weights = 1.955240628e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442237614134
                                         uncertainty =       0.003166042917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442237614134
                                         uncertainty =       0.003166042917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470207264
  error estimate for blocks of size 2^( 2) =       0.000494268508
  error estimate for blocks of size 2^( 3) =       0.000517049171
  error estimate for blocks of size 2^( 4) =       0.000532846339
  error estimate for blocks of size 2^( 5) =       0.000540437444
  error estimate for blocks of size 2^( 6) =       0.000544513529
  error estimate for blocks of size 2^( 7) =       0.000547521617

      target function =      -0.741166886761
              le_mean =     -22.662023911720
             les_mean =     514.022395276593
             stat err =       0.000541329732
             autocorr =       1.325394288093
   target nu stat err =       0.000541329732
   target dn stat err =       0.005477161076
      target stat err =       0.004491488271
              std dev =       0.664973489452
             le_variance =       0.442189741674


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266202391172e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741193067599       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741193067599       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741193067599       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741202062272       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741224379069       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741193055399       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741178522305       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741139292542       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741238392075       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741206842905       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741235303095       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741238785741       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741186505527       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741174677996       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741015328088       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741002146864       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741309103030       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741169676712       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740421321829       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740070631428       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741325018890       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740111150399       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739050881248       residual = 7.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750991091940       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734297849580       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748289541461       residual = 9.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.727516906387       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743892268163       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.737635405644       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.763390365338       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.732028787987       residual = 5.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.247056120800       residual = 4.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.803771462297       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.422800085653       residual = 2.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       2.922356164265       residual = 3.61e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.319656960643       residual = 1.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+10 is 4.938832e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741193067599       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741193067599       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741193067599       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741193067599       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741245860074       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741193068069       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741193830609       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741184614632       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742085627187       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741805570047       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741150140866       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741065094490       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741308980674       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741675208567       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741059667342       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741248026831       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740413610934       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740779919718       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741457710861       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741599217887       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741762043168       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741524662119       residual = 6.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744045014652       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.718902642461       residual = 2.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.637820627818       residual = 7.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       0.878500082550       residual = 3.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.122597699593       residual = 1.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   27 stopping due to too large eigenvalue change
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+11 is 1.229809e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741193067599       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741193067599       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741193067599       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741193067599       residual = 7.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741193067513       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741193068018       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741194552826       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741092268503       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741247040219       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738326393104       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743360290142       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741486272200       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740938722321       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741548679504       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742478089035       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739183325969       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740577560967       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740150517314       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744829073168       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740909538708       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742323459674       residual = 6.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.745217963033       residual = 1.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744271681549       residual = 1.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744540643425       residual = 1.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.742864755389       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742354672757       residual = 3.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.728199065708       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.718970751807       residual = 3.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.701004118975       residual = 1.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741797146864       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.724397604564       residual = 3.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.728925670244       residual = 5.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.687258492709       residual = 4.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.763898019005       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.811358132265       residual = 1.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.641024628710       residual = 3.91e+04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.520016032427       residual = 3.58e+05           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.512358485934       residual = 5.57e+04           smallest_sin_value = 9.98e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -2.378619328136       residual = 1.27e+06           smallest_sin_value = 9.92e-01
davidson iteration   39 stopping due to small subspace S singular value of 9.74e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+11 is 3.093603e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.484549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1415e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -22.6086
    reference variance = 0.368125
====================================================
  Execution time = 2.5940e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5218e-01
  Total weights = 1.9555e+06
  Execution time = 3.6012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439982064149
                                         uncertainty =       0.002397585492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439982064149
                                         uncertainty =       0.002397585492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469091702
  error estimate for blocks of size 2^( 2) =       0.000493265822
  error estimate for blocks of size 2^( 3) =       0.000514747646
  error estimate for blocks of size 2^( 4) =       0.000531254744
  error estimate for blocks of size 2^( 5) =       0.000541556776
  error estimate for blocks of size 2^( 6) =       0.000549024645
  error estimate for blocks of size 2^( 7) =       0.000551057302

      target function =      -0.743540721329
              le_mean =     -22.662353995884
             les_mean =     514.034464397510
             stat err =       0.000543223367
             autocorr =       1.341038927214
   target nu stat err =       0.000543223367
   target dn stat err =       0.003731042150
      target stat err =       0.003111640477
              std dev =       0.663395846914
             le_variance =       0.440094049703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439982064149
                                         uncertainty =       0.002397585492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439982064149
                                         uncertainty =       0.002397585492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469091702
  error estimate for blocks of size 2^( 2) =       0.000493265822
  error estimate for blocks of size 2^( 3) =       0.000514747646
  error estimate for blocks of size 2^( 4) =       0.000531254744
  error estimate for blocks of size 2^( 5) =       0.000541556776
  error estimate for blocks of size 2^( 6) =       0.000549024645
  error estimate for blocks of size 2^( 7) =       0.000551057302

      target function =      -0.743540721329
              le_mean =     -22.662353995884
             les_mean =     514.034464397510
             stat err =       0.000543223367
             autocorr =       1.341038927213
   target nu stat err =       0.000543223367
   target dn stat err =       0.003731042150
      target stat err =       0.003111640477
              std dev =       0.663395846914
             le_variance =       0.440094049703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439982064149
                                         uncertainty =       0.002397585492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439982064149
                                         uncertainty =       0.002397585492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469091702
  error estimate for blocks of size 2^( 2) =       0.000493265822
  error estimate for blocks of size 2^( 3) =       0.000514747646
  error estimate for blocks of size 2^( 4) =       0.000531254744
  error estimate for blocks of size 2^( 5) =       0.000541556776
  error estimate for blocks of size 2^( 6) =       0.000549024645
  error estimate for blocks of size 2^( 7) =       0.000551057302

      target function =      -0.743540721329
              le_mean =     -22.662353995884
             les_mean =     514.034464397510
             stat err =       0.000543223367
             autocorr =       1.341038927214
   target nu stat err =       0.000543223367
   target dn stat err =       0.003731042150
      target stat err =       0.003111640477
              std dev =       0.663395846914
             le_variance =       0.440094049703

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439982064149
                                         uncertainty =       0.002397585492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439982064149
                                         uncertainty =       0.002397585492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469091702
  error estimate for blocks of size 2^( 2) =       0.000493265822
  error estimate for blocks of size 2^( 3) =       0.000514747646
  error estimate for blocks of size 2^( 4) =       0.000531254744
  error estimate for blocks of size 2^( 5) =       0.000541556776
  error estimate for blocks of size 2^( 6) =       0.000549024645
  error estimate for blocks of size 2^( 7) =       0.000551057302

      target function =      -0.743540721329
              le_mean =     -22.662353995884
             les_mean =     514.034464397510
             stat err =       0.000543223367
             autocorr =       1.341038927213
   target nu stat err =       0.000543223367
   target dn stat err =       0.003731042150
      target stat err =       0.003111640477
              std dev =       0.663395846914
             le_variance =       0.440094049703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743540721329        initial
     5.8208e+10     5.8208e+11             4.9388e-15        -0.743540721329
     2.3283e+11     2.3283e+12             1.2298e-15        -0.743540721329  <--
     9.3132e+11     9.3132e+12             3.0936e-16        -0.743540721329

*****************************************************************************
Applying the update for shift_i =   2.3283e+11     and shift_s =   2.3283e+12
*****************************************************************************

  Execution time = 4.4012e+01
  </log>
  <optVariables href="FORM2.s049.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.6644
    reference variance = 0.264092
====================================================
  Execution time = 2.6732e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5166e-01
  Total weights = 1.955213365e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.8000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441562313296
                                         uncertainty =       0.002251855535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441562313296
                                         uncertainty =       0.002251855535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469854192
  error estimate for blocks of size 2^( 2) =       0.000493706044
  error estimate for blocks of size 2^( 3) =       0.000515866580
  error estimate for blocks of size 2^( 4) =       0.000531595140
  error estimate for blocks of size 2^( 5) =       0.000540350391
  error estimate for blocks of size 2^( 6) =       0.000545256380
  error estimate for blocks of size 2^( 7) =       0.000547722182

      target function =      -0.743965797594
              le_mean =     -22.662288127334
             les_mean =     514.030966106280
             stat err =       0.000541231023
             autocorr =       1.326902926035
   target nu stat err =       0.000541231023
   target dn stat err =       0.002812569195
      target stat err =       0.002380157091
              std dev =       0.664474171330
             le_variance =       0.441525924364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266228812733e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743972490913       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743972490913       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743972490913       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743972490913       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744000382894       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743972491727       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743974527870       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743974426082       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743878470859       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743816120756       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744192639218       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744146368177       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744117236561       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743987619239       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743916381393       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743958362254       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743507113873       residual = 7.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743055203450       residual = 6.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744714958160       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745194720346       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742882523457       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747112363301       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746328012139       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.728679475539       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748210637438       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.720297451073       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742075723977       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745335725681       residual = 6.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.722417271930       residual = 5.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.082486398616       residual = 8.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.658791673777       residual = 8.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+10 is 2.499454e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743972490913       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743972490913       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743972490913       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743972490913       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743972490913       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743972490849       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743972869289       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743979215806       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743841969302       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743857262118       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744148888010       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743978346764       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743888831423       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743801332758       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743841206300       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744144648845       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745491842399       residual = 2.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743706708680       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744099539632       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744775368654       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744286662333       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743880256189       residual = 6.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743973685642       residual = 5.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.764707438686       residual = 3.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.796479830590       residual = 4.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.826755411685       residual = 1.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.881937351064       residual = 3.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.732019049232       residual = 9.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.777580054029       residual = 3.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.805108706393       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.604904655060       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.763780734865       residual = 6.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.765636584686       residual = 1.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.718804338348       residual = 2.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       1.185372320939       residual = 3.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.598609657012       residual = 5.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.431123692496       residual = 1.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   37 stopping due to too large eigenvalue change
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+11 is 6.285049e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743972490913       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743972490913       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743972490913       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743972490913       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743972490913       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744131020323       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743972044371       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744013650641       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744792266992       residual = 4.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745070975165       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745207131010       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744105046273       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743579866301       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744026433680       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747298477120       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748919257691       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.760870310226       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.716123280445       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.760726141328       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746233180097       residual = 5.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749650885433       residual = 2.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.672518453969       residual = 4.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.976681879033       residual = 7.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.305350944101       residual = 6.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.445837714245       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.451178361666       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.298181582536       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.647667001547       residual = 8.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -2.089407903477       residual = 5.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.344833507298       residual = 4.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -2.790594952909       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.382008743342       residual = 4.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.463288025137       residual = 7.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+11 is 1.548548e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.532460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1586e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -22.5913
    reference variance = 0.350343
====================================================
  Execution time = 2.6022e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5000e-01
  Total weights = 1.9553e+06
  Execution time = 3.5879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438694589959
                                         uncertainty =       0.001731099310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438694589959
                                         uncertainty =       0.001731099310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468312155
  error estimate for blocks of size 2^( 2) =       0.000492484716
  error estimate for blocks of size 2^( 3) =       0.000514829827
  error estimate for blocks of size 2^( 4) =       0.000530431697
  error estimate for blocks of size 2^( 5) =       0.000539221596
  error estimate for blocks of size 2^( 6) =       0.000542478864
  error estimate for blocks of size 2^( 7) =       0.000542477426

      target function =      -0.745324618193
              le_mean =     -22.661600912711
             les_mean =     513.998156436418
             stat err =       0.000538652396
             autocorr =       1.322958834257
   target nu stat err =       0.000538652396
   target dn stat err =       0.002806556437
      target stat err =       0.002380666914
              std dev =       0.662293401408
             le_variance =       0.438632549549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438694589959
                                         uncertainty =       0.001731099310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438694589959
                                         uncertainty =       0.001731099310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468312155
  error estimate for blocks of size 2^( 2) =       0.000492484716
  error estimate for blocks of size 2^( 3) =       0.000514829827
  error estimate for blocks of size 2^( 4) =       0.000530431697
  error estimate for blocks of size 2^( 5) =       0.000539221596
  error estimate for blocks of size 2^( 6) =       0.000542478864
  error estimate for blocks of size 2^( 7) =       0.000542477426

      target function =      -0.745324618193
              le_mean =     -22.661600912711
             les_mean =     513.998156436418
             stat err =       0.000538652396
             autocorr =       1.322958834256
   target nu stat err =       0.000538652396
   target dn stat err =       0.002806556437
      target stat err =       0.002380666914
              std dev =       0.662293401408
             le_variance =       0.438632549549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438694589959
                                         uncertainty =       0.001731099310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438694589959
                                         uncertainty =       0.001731099310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468312155
  error estimate for blocks of size 2^( 2) =       0.000492484716
  error estimate for blocks of size 2^( 3) =       0.000514829827
  error estimate for blocks of size 2^( 4) =       0.000530431697
  error estimate for blocks of size 2^( 5) =       0.000539221596
  error estimate for blocks of size 2^( 6) =       0.000542478864
  error estimate for blocks of size 2^( 7) =       0.000542477426

      target function =      -0.745324618193
              le_mean =     -22.661600912711
             les_mean =     513.998156436418
             stat err =       0.000538652396
             autocorr =       1.322958834260
   target nu stat err =       0.000538652396
   target dn stat err =       0.002806556437
      target stat err =       0.002380666914
              std dev =       0.662293401408
             le_variance =       0.438632549549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438694589959
                                         uncertainty =       0.001731099310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438694589959
                                         uncertainty =       0.001731099310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468312155
  error estimate for blocks of size 2^( 2) =       0.000492484716
  error estimate for blocks of size 2^( 3) =       0.000514829827
  error estimate for blocks of size 2^( 4) =       0.000530431697
  error estimate for blocks of size 2^( 5) =       0.000539221596
  error estimate for blocks of size 2^( 6) =       0.000542478864
  error estimate for blocks of size 2^( 7) =       0.000542477426

      target function =      -0.745324618193
              le_mean =     -22.661600912711
             les_mean =     513.998156436418
             stat err =       0.000538652396
             autocorr =       1.322958834257
   target nu stat err =       0.000538652396
   target dn stat err =       0.002806556437
      target stat err =       0.002380666914
              std dev =       0.662293401408
             le_variance =       0.438632549549


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745324618193        initial
     5.8208e+10     5.8208e+11             2.4995e-15        -0.745324618193
     2.3283e+11     2.3283e+12             6.2850e-16        -0.745324618193
     9.3132e+11     9.3132e+12             1.5485e-16        -0.745324618193  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+11     and shift_s =   9.3132e+12
*****************************************************************************

  Execution time = 4.4025e+01
  </log>
  <optVariables href="FORM2.s050.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5617e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.7252
    reference variance = 0.333839
====================================================
  Execution time = 2.8538e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5703e-01
  Total weights = 1.955224639e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442673742231
                                         uncertainty =       0.002180322799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442673742231
                                         uncertainty =       0.002180322799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470477575
  error estimate for blocks of size 2^( 2) =       0.000494408067
  error estimate for blocks of size 2^( 3) =       0.000516287209
  error estimate for blocks of size 2^( 4) =       0.000531529452
  error estimate for blocks of size 2^( 5) =       0.000540837093
  error estimate for blocks of size 2^( 6) =       0.000545294037
  error estimate for blocks of size 2^( 7) =       0.000547512368

      target function =      -0.739573644745
              le_mean =     -22.661916466268
             les_mean =     514.019489129532
             stat err =       0.000541293237
             autocorr =       1.323693228947
   target nu stat err =       0.000541293237
   target dn stat err =       0.005534337903
      target stat err =       0.004517519697
              std dev =       0.665355766791
             le_variance =       0.442698296402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266191646627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739600280897       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739600280897       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739600280897       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739600280897       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739600280897       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739600280897       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739665770454       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739600280897       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739686391335       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739652045359       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740170304805       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739688261144       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740379727621       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739293130482       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739593169448       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739831366650       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740271264785       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739692376408       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739850157621       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740197110367       residual = 4.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740762189976       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740069531506       residual = 6.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.739013375156       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740437996006       residual = 3.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740792249130       residual = 5.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.782273891621       residual = 3.70e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.657980934309       residual = 9.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.589438158502       residual = 5.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.738213642523       residual = 6.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.758521519574       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.803444703835       residual = 1.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.677428055417       residual = 4.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.717123267630       residual = 2.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+11 is 2.059136e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739600280897       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739600280897       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739600280897       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739600280897       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739600280897       residual = 9.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739895940997       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739600280897       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739600280897       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739342288407       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.737080691458       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740757194314       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738696606307       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739735416503       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740716802342       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739409955744       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739388657449       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736520141602       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.737401647206       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.726918194643       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.726850281541       residual = 5.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742665138181       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.733318371717       residual = 4.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.769377561046       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.722313141486       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.779985852018       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.734234963934       residual = 8.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.977984589899       residual = 4.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.781352560375       residual = 5.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940158904154       residual = 9.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.772459756625       residual = 3.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.023832933626       residual = 1.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.672943276020       residual = 2.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.136351632956       residual = 2.39e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -2.490400102771       residual = 3.99e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.456851007112       residual = 3.90e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.482105958348       residual = 1.34e+03           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+11 is 5.147782e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739600280897       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739600280897       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739600280897       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739600280897       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739148409302       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739632348246       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740815879135       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739568473866       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741525501335       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745020270495       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744224694985       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.733547287847       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739630045115       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.750931424533       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.728392139349       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749189181845       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745982966631       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.729229113273       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.750726744123       residual = 3.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.760891464874       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736393467576       residual = 9.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.778391222994       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.044511006016       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.806753139309       residual = 4.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.719410573826       residual = 1.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.158790914281       residual = 3.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.718374765361       residual = 3.02e+04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -5.063771569966       residual = 6.32e+04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.884929194262       residual = 1.55e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.442028179726       residual = 2.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -3.219773070069       residual = 1.08e+06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       3.726839711376       residual = 4.74e+06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -5.661414167078       residual = 6.19e+06           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.7253e+12 is 1.273750e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.581068 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3310e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -22.6918
    reference variance = 0.364607
====================================================
  Execution time = 2.5864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5098e-01
  Total weights = 1.9552e+06
  Execution time = 3.5864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441973506556
                                         uncertainty =       0.001924142870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441973506556
                                         uncertainty =       0.001924142870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470040218
  error estimate for blocks of size 2^( 2) =       0.000493679123
  error estimate for blocks of size 2^( 3) =       0.000515915795
  error estimate for blocks of size 2^( 4) =       0.000531158393
  error estimate for blocks of size 2^( 5) =       0.000540072839
  error estimate for blocks of size 2^( 6) =       0.000546026295
  error estimate for blocks of size 2^( 7) =       0.000549346928

      target function =      -0.744532413169
              le_mean =     -22.662679533030
             les_mean =     514.048019352967
             stat err =       0.000541651114
             autocorr =       1.327911839517
   target nu stat err =       0.000541651114
   target dn stat err =       0.002667778576
      target stat err =       0.002270273099
              std dev =       0.664737251146
             le_variance =       0.441875613062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441973506556
                                         uncertainty =       0.001924142870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441973506556
                                         uncertainty =       0.001924142870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470040218
  error estimate for blocks of size 2^( 2) =       0.000493679123
  error estimate for blocks of size 2^( 3) =       0.000515915795
  error estimate for blocks of size 2^( 4) =       0.000531158393
  error estimate for blocks of size 2^( 5) =       0.000540072839
  error estimate for blocks of size 2^( 6) =       0.000546026295
  error estimate for blocks of size 2^( 7) =       0.000549346928

      target function =      -0.744532413169
              le_mean =     -22.662679533030
             les_mean =     514.048019352967
             stat err =       0.000541651114
             autocorr =       1.327911839517
   target nu stat err =       0.000541651114
   target dn stat err =       0.002667778576
      target stat err =       0.002270273099
              std dev =       0.664737251146
             le_variance =       0.441875613062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441973506556
                                         uncertainty =       0.001924142870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441973506556
                                         uncertainty =       0.001924142870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470040218
  error estimate for blocks of size 2^( 2) =       0.000493679123
  error estimate for blocks of size 2^( 3) =       0.000515915795
  error estimate for blocks of size 2^( 4) =       0.000531158393
  error estimate for blocks of size 2^( 5) =       0.000540072839
  error estimate for blocks of size 2^( 6) =       0.000546026295
  error estimate for blocks of size 2^( 7) =       0.000549346928

      target function =      -0.744532413169
              le_mean =     -22.662679533030
             les_mean =     514.048019352967
             stat err =       0.000541651114
             autocorr =       1.327911839517
   target nu stat err =       0.000541651114
   target dn stat err =       0.002667778576
      target stat err =       0.002270273099
              std dev =       0.664737251146
             le_variance =       0.441875613062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441973506556
                                         uncertainty =       0.001924142870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441973506556
                                         uncertainty =       0.001924142870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470040218
  error estimate for blocks of size 2^( 2) =       0.000493679123
  error estimate for blocks of size 2^( 3) =       0.000515915795
  error estimate for blocks of size 2^( 4) =       0.000531158393
  error estimate for blocks of size 2^( 5) =       0.000540072839
  error estimate for blocks of size 2^( 6) =       0.000546026295
  error estimate for blocks of size 2^( 7) =       0.000549346928

      target function =      -0.744532413169
              le_mean =     -22.662679533030
             les_mean =     514.048019352967
             stat err =       0.000541651114
             autocorr =       1.327911839517
   target nu stat err =       0.000541651114
   target dn stat err =       0.002667778576
      target stat err =       0.002270273099
              std dev =       0.664737251146
             le_variance =       0.441875613062


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744532413169        initial
     2.3283e+11     2.3283e+12             2.0591e-15        -0.744532413169  <--
     9.3132e+11     9.3132e+12             5.1478e-16        -0.744532413169
     3.7253e+12     3.7253e+13             1.2737e-16        -0.744532413169

*****************************************************************************
Applying the update for shift_i =   2.3283e+11     and shift_s =   2.3283e+12
*****************************************************************************

  Execution time = 4.3882e+01
  </log>
  <optVariables href="FORM2.s051.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6498
    reference variance = 0.454165
====================================================
  Execution time = 2.6512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5125e-01
  Total weights = 1.954983513e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442124522036
                                         uncertainty =       0.002165245156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442124522036
                                         uncertainty =       0.002165245156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470122517
  error estimate for blocks of size 2^( 2) =       0.000494375382
  error estimate for blocks of size 2^( 3) =       0.000516214172
  error estimate for blocks of size 2^( 4) =       0.000531955048
  error estimate for blocks of size 2^( 5) =       0.000542192979
  error estimate for blocks of size 2^( 6) =       0.000548935259
  error estimate for blocks of size 2^( 7) =       0.000551801158

      target function =      -0.744308084474
              le_mean =     -22.662247114448
             les_mean =     514.028689723891
             stat err =       0.000543721111
             autocorr =       1.337612399502
   target nu stat err =       0.000543721111
   target dn stat err =       0.002748025229
      target stat err =       0.002331633204
              std dev =       0.664853639447
             le_variance =       0.442030361886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266224711445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744314443183       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744314443183       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744314443183       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744296595642       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744357025480       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744345352137       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744287547241       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744301771334       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744268943630       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744329194631       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744255325254       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744278427586       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744147214250       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744332033220       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744316115923       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744221748428       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743839171177       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744208271201       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743580402338       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744848480850       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741165876811       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740803030014       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.757479257381       residual = 6.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.703068914626       residual = 4.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.767646690224       residual = 2.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.845917643957       residual = 1.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.692429594113       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.762015142440       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736351155961       residual = 7.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.760934692223       residual = 9.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934280630876       residual = 7.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.845241456587       residual = 3.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.720896096834       residual = 1.63e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.312383583236       residual = 6.30e+04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.340472906342       residual = 2.54e+04           smallest_sin_value = 1.00e+00
davidson iteration   35 stopping due to too large eigenvalue change
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+10 is 3.047022e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744314443183       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744314443183       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744314443183       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744317468975       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744399450369       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744323566457       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744314443183       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743938107608       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743914383867       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744704223696       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744690436756       residual = 8.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744490450680       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744721989661       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744917066309       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743605400149       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744333066622       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744075863576       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744320750170       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745248588184       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745400012173       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744664581261       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.702288756334       residual = 9.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749841406759       residual = 8.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.763371090799       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.760964554222       residual = 8.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.759831905076       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736790684818       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.834248838752       residual = 2.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.755234030209       residual = 3.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.739247362009       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.728598739719       residual = 1.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745639877529       residual = 9.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.780075856129       residual = 2.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.630232150103       residual = 1.69e+04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.099503092683       residual = 1.45e+04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.961027764982       residual = 2.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.273039456066       residual = 5.48e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.814969126646       residual = 2.86e+04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.312851558642       residual = 5.79e+03           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.274308249366       residual = 3.69e+04           smallest_sin_value = 9.93e-01
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+11 is 7.766726e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744314443183       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744314443183       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744314443183       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744314443183       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744314443171       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743954700247       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744142824893       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744548383396       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742385294126       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742915807273       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746513633395       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745657561237       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741820009998       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745539970527       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744585119400       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743923931291       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.750664236945       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751353770289       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.744778861336       residual = 2.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.756786182304       residual = 5.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.798031872679       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.778006047631       residual = 8.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.680196310188       residual = 2.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.486847142837       residual = 7.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.504710940355       residual = 1.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.494359422454       residual = 4.78e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.667901213578       residual = 1.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.736509632024       residual = 2.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.663464145381       residual = 9.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.441508761405       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.931348726941       residual = 4.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       1.603927734495       residual = 3.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.153848745005       residual = 1.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       0.739057957774       residual = 7.13e+04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       2.352392171074       residual = 2.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -3.166818782356       residual = 6.03e+04           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+11 is 1.867789e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.643713 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1295e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -22.6372
    reference variance = 0.329926
====================================================
  Execution time = 2.5760e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4776e-01
  Total weights = 1.9554e+06
  Execution time = 3.6123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439105626019
                                         uncertainty =       0.002312583966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439105626019
                                         uncertainty =       0.002312583966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468537215
  error estimate for blocks of size 2^( 2) =       0.000493403257
  error estimate for blocks of size 2^( 3) =       0.000515307967
  error estimate for blocks of size 2^( 4) =       0.000531077510
  error estimate for blocks of size 2^( 5) =       0.000540088818
  error estimate for blocks of size 2^( 6) =       0.000546589618
  error estimate for blocks of size 2^( 7) =       0.000549307656

      target function =      -0.747184281569
              le_mean =     -22.662921055957
             les_mean =     514.055749626794
             stat err =       0.000541765901
             autocorr =       1.337011519336
   target nu stat err =       0.000541765901
   target dn stat err =       0.002855661511
      target stat err =       0.002437080113
              std dev =       0.662611684199
             le_variance =       0.439054244037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439105626019
                                         uncertainty =       0.002312583966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439105626019
                                         uncertainty =       0.002312583966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468537215
  error estimate for blocks of size 2^( 2) =       0.000493403257
  error estimate for blocks of size 2^( 3) =       0.000515307967
  error estimate for blocks of size 2^( 4) =       0.000531077510
  error estimate for blocks of size 2^( 5) =       0.000540088818
  error estimate for blocks of size 2^( 6) =       0.000546589618
  error estimate for blocks of size 2^( 7) =       0.000549307656

      target function =      -0.747184281569
              le_mean =     -22.662921055957
             les_mean =     514.055749626794
             stat err =       0.000541765901
             autocorr =       1.337011519334
   target nu stat err =       0.000541765901
   target dn stat err =       0.002855661511
      target stat err =       0.002437080113
              std dev =       0.662611684199
             le_variance =       0.439054244037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439105626019
                                         uncertainty =       0.002312583966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439105626019
                                         uncertainty =       0.002312583966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468537215
  error estimate for blocks of size 2^( 2) =       0.000493403257
  error estimate for blocks of size 2^( 3) =       0.000515307967
  error estimate for blocks of size 2^( 4) =       0.000531077510
  error estimate for blocks of size 2^( 5) =       0.000540088818
  error estimate for blocks of size 2^( 6) =       0.000546589618
  error estimate for blocks of size 2^( 7) =       0.000549307656

      target function =      -0.747184281569
              le_mean =     -22.662921055957
             les_mean =     514.055749626794
             stat err =       0.000541765901
             autocorr =       1.337011519333
   target nu stat err =       0.000541765901
   target dn stat err =       0.002855661511
      target stat err =       0.002437080113
              std dev =       0.662611684199
             le_variance =       0.439054244037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439105626019
                                         uncertainty =       0.002312583966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439105626019
                                         uncertainty =       0.002312583966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468537215
  error estimate for blocks of size 2^( 2) =       0.000493403257
  error estimate for blocks of size 2^( 3) =       0.000515307967
  error estimate for blocks of size 2^( 4) =       0.000531077510
  error estimate for blocks of size 2^( 5) =       0.000540088818
  error estimate for blocks of size 2^( 6) =       0.000546589618
  error estimate for blocks of size 2^( 7) =       0.000549307656

      target function =      -0.747184281569
              le_mean =     -22.662921055957
             les_mean =     514.055749626794
             stat err =       0.000541765901
             autocorr =       1.337011519336
   target nu stat err =       0.000541765901
   target dn stat err =       0.002855661511
      target stat err =       0.002437080113
              std dev =       0.662611684199
             le_variance =       0.439054244037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747184281569        initial
     5.8208e+10     5.8208e+11             3.0470e-15        -0.747184281569
     2.3283e+11     2.3283e+12             7.7667e-16        -0.747184281569  <--
     9.3132e+11     9.3132e+12             1.8678e-16        -0.747184281569

*****************************************************************************
Applying the update for shift_i =   2.3283e+11     and shift_s =   2.3283e+12
*****************************************************************************

  Execution time = 4.3918e+01
  </log>
  <optVariables href="FORM2.s052.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5218e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7552
    reference variance = 0.288146
====================================================
  Execution time = 2.6662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5258e-01
  Total weights = 1.955148154e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442541848030
                                         uncertainty =       0.002495525448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442541848030
                                         uncertainty =       0.002495525448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470370676
  error estimate for blocks of size 2^( 2) =       0.000494222767
  error estimate for blocks of size 2^( 3) =       0.000516525395
  error estimate for blocks of size 2^( 4) =       0.000532262511
  error estimate for blocks of size 2^( 5) =       0.000541976116
  error estimate for blocks of size 2^( 6) =       0.000546668495
  error estimate for blocks of size 2^( 7) =       0.000548570383

      target function =      -0.743212164644
              le_mean =     -22.661887187138
             les_mean =     514.013707563478
             stat err =       0.000542369376
             autocorr =       1.329565823145
   target nu stat err =       0.000542369376
   target dn stat err =       0.003496896402
      target stat err =       0.002919063478
              std dev =       0.665204588732
             le_variance =       0.442497144871


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266188718714e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743222631404       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743222631404       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743222631404       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743222631404       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743222631404       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743222631404       residual = 9.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743222631404       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743222631404       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743190744292       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743222631404       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743192830733       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743222631404       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743159464970       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743212318378       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743032730749       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743259131445       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743234364836       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743269590213       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743122540276       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742755548608       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743258615587       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743908870452       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743049402544       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744645786165       residual = 5.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746153351726       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742469678526       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741371817046       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.730124181137       residual = 1.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746910564875       residual = 3.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743260961597       residual = 7.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.722216974059       residual = 5.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.715036175325       residual = 8.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.751543836781       residual = 7.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+10 is 6.368458e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743222631404       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743222631404       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743222631404       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743222631404       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743222631404       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743222631404       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743222631404       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743322129654       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743401678644       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743693607364       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742928948525       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743469699649       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742885948867       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743384244522       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744185965895       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743454541565       residual = 6.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743955805597       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.751461966421       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746303411649       residual = 5.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.735231153434       residual = 4.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.737520711114       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.489330317323       residual = 4.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.792805288319       residual = 2.01e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.675749493357       residual = 2.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.321986780152       residual = 1.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       1.496589274551       residual = 1.22e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       5.236581048213       residual = 2.75e+04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.651325146031       residual = 7.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   28 stopping due to too large eigenvalue change
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+11 is 1.584057e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743222631404       residual = 6.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743222631404       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743222631404       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743222631404       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743222631404       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743496339884       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743222631404       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743218448356       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743222631404       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743222631404       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743222631404       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742951748564       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741003423800       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743147041753       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743377208656       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745395875836       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743696130184       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742993973519       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743038203276       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743663142952       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745283204705       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.770359551323       residual = 2.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.646530538533       residual = 3.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.860558738724       residual = 2.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.447444044708       residual = 4.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.824885841523       residual = 8.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.050948050542       residual = 2.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.111730125152       residual = 1.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.835721076082       residual = 7.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.382627037132       residual = 4.85e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.088286112249       residual = 3.64e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.091041664722       residual = 4.07e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.393348447312       residual = 3.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.123784076448       residual = 1.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       1.220123654033       residual = 2.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.599145163499       residual = 6.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.906003094234       residual = 2.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.781221713213       residual = 6.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -3.094642412899       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       0.050336488353       residual = 1.35e+03           smallest_sin_value = 9.99e-01
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.3132e+11 is 4.185570e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.694362 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1438e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -22.7215
    reference variance = 0.306119
====================================================
  Execution time = 2.5878e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4708e-01
  Total weights = 1.9553e+06
  Execution time = 3.6029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440633251716
                                         uncertainty =       0.002065800331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440633251716
                                         uncertainty =       0.002065800331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469367538
  error estimate for blocks of size 2^( 2) =       0.000493356913
  error estimate for blocks of size 2^( 3) =       0.000515236337
  error estimate for blocks of size 2^( 4) =       0.000531310701
  error estimate for blocks of size 2^( 5) =       0.000540187389
  error estimate for blocks of size 2^( 6) =       0.000545404454
  error estimate for blocks of size 2^( 7) =       0.000549228148

      target function =      -0.747749062318
              le_mean =     -22.662839732286
             les_mean =     514.051383081993
             stat err =       0.000541532673
             autocorr =       1.331138453846
   target nu stat err =       0.000541532673
   target dn stat err =       0.002367861493
      target stat err =       0.002051038978
              std dev =       0.663785937704
             le_variance =       0.440611771093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440633251716
                                         uncertainty =       0.002065800331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440633251716
                                         uncertainty =       0.002065800331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469367538
  error estimate for blocks of size 2^( 2) =       0.000493356913
  error estimate for blocks of size 2^( 3) =       0.000515236337
  error estimate for blocks of size 2^( 4) =       0.000531310701
  error estimate for blocks of size 2^( 5) =       0.000540187389
  error estimate for blocks of size 2^( 6) =       0.000545404454
  error estimate for blocks of size 2^( 7) =       0.000549228148

      target function =      -0.747749062318
              le_mean =     -22.662839732286
             les_mean =     514.051383081993
             stat err =       0.000541532673
             autocorr =       1.331138453839
   target nu stat err =       0.000541532673
   target dn stat err =       0.002367861493
      target stat err =       0.002051038978
              std dev =       0.663785937704
             le_variance =       0.440611771093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440633251716
                                         uncertainty =       0.002065800331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440633251716
                                         uncertainty =       0.002065800331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469367538
  error estimate for blocks of size 2^( 2) =       0.000493356913
  error estimate for blocks of size 2^( 3) =       0.000515236337
  error estimate for blocks of size 2^( 4) =       0.000531310701
  error estimate for blocks of size 2^( 5) =       0.000540187389
  error estimate for blocks of size 2^( 6) =       0.000545404454
  error estimate for blocks of size 2^( 7) =       0.000549228148

      target function =      -0.747749062318
              le_mean =     -22.662839732286
             les_mean =     514.051383081993
             stat err =       0.000541532673
             autocorr =       1.331138453840
   target nu stat err =       0.000541532673
   target dn stat err =       0.002367861493
      target stat err =       0.002051038978
              std dev =       0.663785937704
             le_variance =       0.440611771093

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440633251716
                                         uncertainty =       0.002065800331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440633251716
                                         uncertainty =       0.002065800331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469367538
  error estimate for blocks of size 2^( 2) =       0.000493356913
  error estimate for blocks of size 2^( 3) =       0.000515236337
  error estimate for blocks of size 2^( 4) =       0.000531310701
  error estimate for blocks of size 2^( 5) =       0.000540187389
  error estimate for blocks of size 2^( 6) =       0.000545404454
  error estimate for blocks of size 2^( 7) =       0.000549228148

      target function =      -0.747749062318
              le_mean =     -22.662839732286
             les_mean =     514.051383081993
             stat err =       0.000541532673
             autocorr =       1.331138453840
   target nu stat err =       0.000541532673
   target dn stat err =       0.002367861493
      target stat err =       0.002051038978
              std dev =       0.663785937704
             le_variance =       0.440611771093


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747749062318        initial
     5.8208e+10     5.8208e+11             6.3685e-15        -0.747749062318  <--
     2.3283e+11     2.3283e+12             1.5841e-15        -0.747749062318
     9.3132e+11     9.3132e+12             4.1856e-16        -0.747749062318

*****************************************************************************
Applying the update for shift_i =   5.8208e+10     and shift_s =   5.8208e+11
*****************************************************************************

  Execution time = 4.3920e+01
  </log>
  <optVariables href="FORM2.s053.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6189
    reference variance = 0.549858
====================================================
  Execution time = 2.6901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5331e-01
  Total weights = 1.955541853e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443708370396
                                         uncertainty =       0.002392138273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443708370396
                                         uncertainty =       0.002392138273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471056922
  error estimate for blocks of size 2^( 2) =       0.000494607065
  error estimate for blocks of size 2^( 3) =       0.000516565335
  error estimate for blocks of size 2^( 4) =       0.000531610826
  error estimate for blocks of size 2^( 5) =       0.000542363387
  error estimate for blocks of size 2^( 6) =       0.000546981374
  error estimate for blocks of size 2^( 7) =       0.000551289495

      target function =      -0.742623078450
              le_mean =     -22.663267315964
             les_mean =     514.076991029740
             stat err =       0.000543061270
             autocorr =       1.329079266304
   target nu stat err =       0.000543061270
   target dn stat err =       0.003208868786
      target stat err =       0.002690594147
              std dev =       0.666175087120
             le_variance =       0.443789246700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266326731596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742631967001       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742631967001       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742631967001       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742631967001       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742631967001       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742636041936       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742630916731       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742622112199       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742615906663       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742653175805       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742606397612       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742640048197       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742630693618       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742610466588       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742603969589       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742633139133       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+10 is 1.332172e-14

solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742631967001       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742631967001       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742631967001       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742631967002       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742655555301       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742598504784       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742628263178       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742674540418       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742705405775       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742712235461       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742528534092       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742644241655       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742687968497       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742401344290       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742612164320       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742621034384       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742741446096       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742658071061       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742571316976       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742455163243       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742184571240       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.737322732930       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741316066136       residual = 4.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.756410295216       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741661376519       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.731466815249       residual = 7.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.733631421539       residual = 2.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.760644942899       residual = 2.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.702358860206       residual = 1.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.790973709737       residual = 7.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.424346920074       residual = 8.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.522778495028       residual = 2.51e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.821232166588       residual = 3.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+10 is 3.344065e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742631967001       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742631967001       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742631967001       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742631967002       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742600357947       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742631972571       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742690118584       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742687688975       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742814003978       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742694968738       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743395294654       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743152236233       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742506900902       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744181319363       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742509043502       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743019221242       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742717497809       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742364422843       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742651721792       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742962906214       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742928275220       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742812246031       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.738884897813       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.735504413312       residual = 3.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.738491045024       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744236509111       residual = 4.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.570138315173       residual = 6.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.774151027134       residual = 9.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.057865785335       residual = 6.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.271624381329       residual = 2.90e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.759618491161       residual = 2.37e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.783661735495       residual = 5.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.864775664507       residual = 3.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       1.139981563265       residual = 2.27e+04           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+11 is 8.360135e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.728662 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1660e+01
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -22.6634
    reference variance = 0.309713
====================================================
  Execution time = 2.6065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4997e-01
  Total weights = 1.9553e+06
  Execution time = 3.5904e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440829488345
                                         uncertainty =       0.002050448371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440829488345
                                         uncertainty =       0.002050448371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469482110
  error estimate for blocks of size 2^( 2) =       0.000493921334
  error estimate for blocks of size 2^( 3) =       0.000516115429
  error estimate for blocks of size 2^( 4) =       0.000532009055
  error estimate for blocks of size 2^( 5) =       0.000541532013
  error estimate for blocks of size 2^( 6) =       0.000547051178
  error estimate for blocks of size 2^( 7) =       0.000547397997

      target function =      -0.745357723583
              le_mean =     -22.662262580720
             les_mean =     514.028112590816
             stat err =       0.000541997561
             autocorr =       1.332774170252
   target nu stat err =       0.000541997561
   target dn stat err =       0.002734172172
      target stat err =       0.002326552409
              std dev =       0.663947967839
             le_variance =       0.440826903997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440829488345
                                         uncertainty =       0.002050448371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440829488345
                                         uncertainty =       0.002050448371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469482110
  error estimate for blocks of size 2^( 2) =       0.000493921334
  error estimate for blocks of size 2^( 3) =       0.000516115429
  error estimate for blocks of size 2^( 4) =       0.000532009055
  error estimate for blocks of size 2^( 5) =       0.000541532013
  error estimate for blocks of size 2^( 6) =       0.000547051178
  error estimate for blocks of size 2^( 7) =       0.000547397997

      target function =      -0.745357723583
              le_mean =     -22.662262580720
             les_mean =     514.028112590816
             stat err =       0.000541997561
             autocorr =       1.332774170249
   target nu stat err =       0.000541997561
   target dn stat err =       0.002734172172
      target stat err =       0.002326552409
              std dev =       0.663947967839
             le_variance =       0.440826903997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440829488345
                                         uncertainty =       0.002050448371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440829488345
                                         uncertainty =       0.002050448371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469482110
  error estimate for blocks of size 2^( 2) =       0.000493921334
  error estimate for blocks of size 2^( 3) =       0.000516115429
  error estimate for blocks of size 2^( 4) =       0.000532009055
  error estimate for blocks of size 2^( 5) =       0.000541532013
  error estimate for blocks of size 2^( 6) =       0.000547051178
  error estimate for blocks of size 2^( 7) =       0.000547397997

      target function =      -0.745357723583
              le_mean =     -22.662262580720
             les_mean =     514.028112590816
             stat err =       0.000541997561
             autocorr =       1.332774170253
   target nu stat err =       0.000541997561
   target dn stat err =       0.002734172172
      target stat err =       0.002326552409
              std dev =       0.663947967839
             le_variance =       0.440826903997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440829488345
                                         uncertainty =       0.002050448371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440829488345
                                         uncertainty =       0.002050448371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469482110
  error estimate for blocks of size 2^( 2) =       0.000493921334
  error estimate for blocks of size 2^( 3) =       0.000516115429
  error estimate for blocks of size 2^( 4) =       0.000532009055
  error estimate for blocks of size 2^( 5) =       0.000541532013
  error estimate for blocks of size 2^( 6) =       0.000547051178
  error estimate for blocks of size 2^( 7) =       0.000547397997

      target function =      -0.745357723583
              le_mean =     -22.662262580720
             les_mean =     514.028112590816
             stat err =       0.000541997561
             autocorr =       1.332774170252
   target nu stat err =       0.000541997561
   target dn stat err =       0.002734172172
      target stat err =       0.002326552409
              std dev =       0.663947967839
             le_variance =       0.440826903997


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745357723583        initial  <--
     1.4552e+10     1.4552e+11             1.3322e-14        -0.745357723583
     5.8208e+10     5.8208e+11             3.3441e-15        -0.745357723583
     2.3283e+11     2.3283e+12             8.3601e-16        -0.745357723583

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.0695
  </log>
  <optVariables href="FORM2.s054.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5745e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6552
    reference variance = 0.266299
====================================================
  Execution time = 2.8729e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4820e-01
  Total weights = 1.955120899e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438159816929
                                         uncertainty =       0.002156062083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438159816929
                                         uncertainty =       0.002156062083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468033200
  error estimate for blocks of size 2^( 2) =       0.000491956102
  error estimate for blocks of size 2^( 3) =       0.000513908181
  error estimate for blocks of size 2^( 4) =       0.000530296805
  error estimate for blocks of size 2^( 5) =       0.000539754417
  error estimate for blocks of size 2^( 6) =       0.000545447084
  error estimate for blocks of size 2^( 7) =       0.000547679195

      target function =      -0.746811887134
              le_mean =     -22.661662298575
             les_mean =     513.999133271175
             stat err =       0.000540794375
             autocorr =       1.335091438526
   target nu stat err =       0.000540794375
   target dn stat err =       0.002686620306
      target stat err =       0.002295032350
              std dev =       0.661898898553
             le_variance =       0.438110151906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266166229858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+11, overlap shift 1.4552e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746817972419       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746817972419       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746817972419       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746817972418       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746755620804       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746862421611       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746711642524       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746700390241       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747169827010       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746658297918       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746797929231       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746683742413       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746623930096       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746153455912       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746854548505       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746891512172       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745825905566       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749131751502       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743370973701       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741180991299       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746529147352       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742251184041       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740769044374       residual = 8.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750950529196       residual = 1.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.632474675227       residual = 2.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.002404472661       residual = 1.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.460258284749       residual = 2.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.384524612034       residual = 5.90e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.413580309640       residual = 6.92e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       1.504262550314       residual = 5.76e+05           smallest_sin_value = 1.00e+00
davidson iteration   30 stopping due to too large eigenvalue change
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+11 is 1.853621e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746817972419       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746817972419       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746817972419       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746743919942       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746377144771       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746894857620       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746156813947       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746859599995       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745906091040       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745843100414       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747566105440       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747015737088       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746214411916       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746551632108       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745508448977       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746959660116       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746505085115       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.750123651391       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747788835774       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.749383388196       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745218163997       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746676974309       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745237151169       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.750798901828       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.734091642000       residual = 6.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.761358927914       residual = 6.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.765213154859       residual = 5.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.747108788272       residual = 5.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.667925384203       residual = 8.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.699179031645       residual = 4.84e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.721003985549       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.728780269438       residual = 4.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       1.391183932323       residual = 5.98e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -9.306030251983       residual = 3.39e+04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.637933087282       residual = 5.80e+04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -6.470066444015       residual = 4.12e+04           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+11 is 4.669617e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+12, overlap shift 2.3283e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746817972419       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746817972419       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746817972419       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746817972419       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746817972419       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745207220964       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746803844273       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.748667343870       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745852762610       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741634734765       residual = 8.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742806271863       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743039830432       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745581419485       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749186604988       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743962221566       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745631811923       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743387410816       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.722798262964       residual = 1.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.694084881522       residual = 4.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.630384266128       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.905409181713       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.086520823965       residual = 9.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.566221251194       residual = 1.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       0.944945976644       residual = 8.06e+03           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.3283e+12 is 1.172554e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.766595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3484e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -22.6412
    reference variance = 0.266484
====================================================
  Execution time = 2.5900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5329e-01
  Total weights = 1.9550e+06
  Execution time = 3.5923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443769175240
                                         uncertainty =       0.004311445086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443769175240
                                         uncertainty =       0.004311445086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471037685
  error estimate for blocks of size 2^( 2) =       0.000494753335
  error estimate for blocks of size 2^( 3) =       0.000516920606
  error estimate for blocks of size 2^( 4) =       0.000532385633
  error estimate for blocks of size 2^( 5) =       0.000541587988
  error estimate for blocks of size 2^( 6) =       0.000545572663
  error estimate for blocks of size 2^( 7) =       0.000548966276

      target function =      -0.742619564234
              le_mean =     -22.661635719095
             les_mean =     514.003022598983
             stat err =       0.000542128140
             autocorr =       1.324623923423
   target nu stat err =       0.000542128140
   target dn stat err =       0.004824122178
      target stat err =       0.003979147914
              std dev =       0.666147881970
             le_variance =       0.443753000654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443769175240
                                         uncertainty =       0.004311445086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443769175240
                                         uncertainty =       0.004311445086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471037685
  error estimate for blocks of size 2^( 2) =       0.000494753335
  error estimate for blocks of size 2^( 3) =       0.000516920606
  error estimate for blocks of size 2^( 4) =       0.000532385633
  error estimate for blocks of size 2^( 5) =       0.000541587988
  error estimate for blocks of size 2^( 6) =       0.000545572663
  error estimate for blocks of size 2^( 7) =       0.000548966276

      target function =      -0.742619564234
              le_mean =     -22.661635719095
             les_mean =     514.003022598983
             stat err =       0.000542128140
             autocorr =       1.324623923421
   target nu stat err =       0.000542128140
   target dn stat err =       0.004824122178
      target stat err =       0.003979147914
              std dev =       0.666147881970
             le_variance =       0.443753000654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443769175240
                                         uncertainty =       0.004311445086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443769175240
                                         uncertainty =       0.004311445086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471037685
  error estimate for blocks of size 2^( 2) =       0.000494753335
  error estimate for blocks of size 2^( 3) =       0.000516920606
  error estimate for blocks of size 2^( 4) =       0.000532385633
  error estimate for blocks of size 2^( 5) =       0.000541587988
  error estimate for blocks of size 2^( 6) =       0.000545572663
  error estimate for blocks of size 2^( 7) =       0.000548966276

      target function =      -0.742619564234
              le_mean =     -22.661635719095
             les_mean =     514.003022598983
             stat err =       0.000542128140
             autocorr =       1.324623923418
   target nu stat err =       0.000542128140
   target dn stat err =       0.004824122178
      target stat err =       0.003979147914
              std dev =       0.666147881970
             le_variance =       0.443753000654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443769175240
                                         uncertainty =       0.004311445086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443769175240
                                         uncertainty =       0.004311445086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471037685
  error estimate for blocks of size 2^( 2) =       0.000494753335
  error estimate for blocks of size 2^( 3) =       0.000516920606
  error estimate for blocks of size 2^( 4) =       0.000532385633
  error estimate for blocks of size 2^( 5) =       0.000541587988
  error estimate for blocks of size 2^( 6) =       0.000545572663
  error estimate for blocks of size 2^( 7) =       0.000548966276

      target function =      -0.742619564234
              le_mean =     -22.661635719095
             les_mean =     514.003022598983
             stat err =       0.000542128140
             autocorr =       1.324623923414
   target nu stat err =       0.000542128140
   target dn stat err =       0.004824122178
      target stat err =       0.003979147914
              std dev =       0.666147881970
             le_variance =       0.443753000654


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742619564234        initial
     1.4552e+11     1.4552e+12             1.8536e-15        -0.742619564234  <--
     5.8208e+11     5.8208e+12             4.6696e-16        -0.742619564234
     2.3283e+12     2.3283e+13             1.1726e-16        -0.742619564234

*****************************************************************************
Applying the update for shift_i =   1.4552e+11     and shift_s =   1.4552e+12
*****************************************************************************

  Execution time = 4.3908e+01
  </log>
  <optVariables href="FORM2.s055.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7398e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7004
    reference variance = 0.30716
====================================================
  Execution time = 2.6904e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5242e-01
  Total weights = 1.954951529e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443265493030
                                         uncertainty =       0.002548685275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443265493030
                                         uncertainty =       0.002548685275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470787043
  error estimate for blocks of size 2^( 2) =       0.000494780846
  error estimate for blocks of size 2^( 3) =       0.000517270204
  error estimate for blocks of size 2^( 4) =       0.000533493227
  error estimate for blocks of size 2^( 5) =       0.000542441452
  error estimate for blocks of size 2^( 6) =       0.000546856286
  error estimate for blocks of size 2^( 7) =       0.000550440039

      target function =      -0.743349221523
              le_mean =     -22.662851918510
             les_mean =     514.057275793309
             stat err =       0.000543307751
             autocorr =       1.331811614681
   target nu stat err =       0.000543307751
   target dn stat err =       0.002880957788
      target stat err =       0.002433122592
              std dev =       0.665793421314
             le_variance =       0.443280879865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266285191851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+10, overlap shift 3.6380e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743356255633       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743356255633       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743356255633       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743356255633       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743356255633       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743372004622       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743346269370       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743331241806       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743373732220       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743372630263       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743332901769       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743369290475       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743410220385       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743438153502       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743337345093       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743397279108       residual = 9.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743269486266       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743323681774       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743337112391       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743319786376       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743433163043       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743311504997       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743416661512       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741489539635       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744842452536       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.716165156131       residual = 2.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.788145447806       residual = 5.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.607924460986       residual = 2.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.704307797196       residual = 3.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.977307337662       residual = 3.91e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       3.779262330031       residual = 2.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+10 is 9.124216e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+11, overlap shift 1.4552e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743356255633       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743356255633       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743356255633       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743355796260       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743356255633       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743356253894       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743488181937       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743370762878       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743361437596       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743653640280       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743114416133       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743169402416       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743400390914       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743417273761       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743291166229       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743215165146       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743457154551       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743446503139       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743687632385       residual = 9.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743251484151       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743165475933       residual = 7.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743244471131       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745954354457       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742866006546       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745167103423       residual = 6.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740667136861       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743982906885       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.703913803412       residual = 6.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.788063743795       residual = 5.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749998930012       residual = 7.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.747922997242       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.907049232091       residual = 4.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.330527198944       residual = 7.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       5.530657119879       residual = 1.02e+04           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+11 is 2.349828e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743356255633       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743356255633       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743356255633       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743356255633       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743602991594       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743356255151       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743356268913       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743323759383       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743706277310       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743586386940       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743794392797       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744062060440       residual = 5.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741745353564       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743774483084       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743434679265       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.748339870400       residual = 9.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.744368405062       residual = 7.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740423728298       residual = 5.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746086008882       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741974261560       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.801650108470       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.035160200628       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.359961424368       residual = 8.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.017611770518       residual = 5.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.001948320976       residual = 2.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937462335122       residual = 2.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.953653606243       residual = 1.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.200345106825       residual = 2.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -3.540953328646       residual = 1.42e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       1.550701434268       residual = 7.14e+03           smallest_sin_value = 1.00e+00
davidson iteration   30 stopping due to too large eigenvalue change
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+11 is 5.647014e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.806710 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1682e+01
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -22.7365
    reference variance = 0.45181
====================================================
  Execution time = 2.6284e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4911e-01
  Total weights = 1.9554e+06
  Execution time = 3.5999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438597331367
                                         uncertainty =       0.001834679537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438597331367
                                         uncertainty =       0.001834679537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468307401
  error estimate for blocks of size 2^( 2) =       0.000492513080
  error estimate for blocks of size 2^( 3) =       0.000514034510
  error estimate for blocks of size 2^( 4) =       0.000529184609
  error estimate for blocks of size 2^( 5) =       0.000537585495
  error estimate for blocks of size 2^( 6) =       0.000542244220
  error estimate for blocks of size 2^( 7) =       0.000542163813

      target function =      -0.746066822529
              le_mean =     -22.662617384624
             les_mean =     514.043335054436
             stat err =       0.000537794534
             autocorr =       1.318775061350
   target nu stat err =       0.000537794534
   target dn stat err =       0.002932720791
      target stat err =       0.002489486270
              std dev =       0.662286677659
             le_variance =       0.438623643404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438597331367
                                         uncertainty =       0.001834679537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438597331367
                                         uncertainty =       0.001834679537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468307401
  error estimate for blocks of size 2^( 2) =       0.000492513080
  error estimate for blocks of size 2^( 3) =       0.000514034510
  error estimate for blocks of size 2^( 4) =       0.000529184609
  error estimate for blocks of size 2^( 5) =       0.000537585495
  error estimate for blocks of size 2^( 6) =       0.000542244220
  error estimate for blocks of size 2^( 7) =       0.000542163813

      target function =      -0.746066822529
              le_mean =     -22.662617384624
             les_mean =     514.043335054436
             stat err =       0.000537794534
             autocorr =       1.318775061356
   target nu stat err =       0.000537794534
   target dn stat err =       0.002932720791
      target stat err =       0.002489486270
              std dev =       0.662286677659
             le_variance =       0.438623643404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438597331367
                                         uncertainty =       0.001834679537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438597331367
                                         uncertainty =       0.001834679537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468307401
  error estimate for blocks of size 2^( 2) =       0.000492513080
  error estimate for blocks of size 2^( 3) =       0.000514034510
  error estimate for blocks of size 2^( 4) =       0.000529184609
  error estimate for blocks of size 2^( 5) =       0.000537585495
  error estimate for blocks of size 2^( 6) =       0.000542244220
  error estimate for blocks of size 2^( 7) =       0.000542163813

      target function =      -0.746066822529
              le_mean =     -22.662617384624
             les_mean =     514.043335054436
             stat err =       0.000537794534
             autocorr =       1.318775061355
   target nu stat err =       0.000537794534
   target dn stat err =       0.002932720791
      target stat err =       0.002489486270
              std dev =       0.662286677659
             le_variance =       0.438623643404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438597331367
                                         uncertainty =       0.001834679537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438597331367
                                         uncertainty =       0.001834679537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468307401
  error estimate for blocks of size 2^( 2) =       0.000492513080
  error estimate for blocks of size 2^( 3) =       0.000514034510
  error estimate for blocks of size 2^( 4) =       0.000529184609
  error estimate for blocks of size 2^( 5) =       0.000537585495
  error estimate for blocks of size 2^( 6) =       0.000542244220
  error estimate for blocks of size 2^( 7) =       0.000542163813

      target function =      -0.746066822529
              le_mean =     -22.662617384624
             les_mean =     514.043335054436
             stat err =       0.000537794534
             autocorr =       1.318775061357
   target nu stat err =       0.000537794534
   target dn stat err =       0.002932720791
      target stat err =       0.002489486270
              std dev =       0.662286677659
             le_variance =       0.438623643404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746066822529        initial  <--
     3.6380e+10     3.6380e+11             9.1242e-15        -0.746066822529
     1.4552e+11     1.4552e+12             2.3498e-15        -0.746066822529
     5.8208e+11     5.8208e+12             5.6470e-16        -0.746066822529

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 44.2884
  </log>
  <optVariables href="FORM2.s056.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6621
    reference variance = 0.353362
====================================================
  Execution time = 2.6756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -2.2664e+01
  VMC Evar = 4.5575e-01
  Total weights = 1.955299733e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441633538031
                                         uncertainty =       0.002336420953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441633538031
                                         uncertainty =       0.002336420953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469902664
  error estimate for blocks of size 2^( 2) =       0.000493887881
  error estimate for blocks of size 2^( 3) =       0.000515886161
  error estimate for blocks of size 2^( 4) =       0.000531976588
  error estimate for blocks of size 2^( 5) =       0.000540171700
  error estimate for blocks of size 2^( 6) =       0.000545163603
  error estimate for blocks of size 2^( 7) =       0.000546941376

      target function =      -0.740622168484
              le_mean =     -22.663501870642
             les_mean =     514.090065664344
             stat err =       0.000541063317
             autocorr =       1.325807176642
   target nu stat err =       0.000541063317
   target dn stat err =       0.004487845471
      target stat err =       0.003698551708
              std dev =       0.664542721066
             le_variance =       0.441617028121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266350187064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740639820030       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740639820030       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740639820030       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740639820030       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740608660353       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740639820030       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740639820030       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740639820030       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740639820030       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740922769926       residual = 8.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741794997853       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740137716372       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740153404806       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.739202076261       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739668489015       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738835334465       residual = 6.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740665659729       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.733822785169       residual = 7.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.727133124113       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.781613815766       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.754320814727       residual = 9.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.739695182192       residual = 2.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.726355706734       residual = 5.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.765656933239       residual = 2.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745332429861       residual = 3.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.754599656259       residual = 5.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742556942247       residual = 5.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.789465673043       residual = 7.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.724862942578       residual = 9.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.601238028116       residual = 2.03e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.963332590623       residual = 5.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.752850375318       residual = 4.67e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.700350980622       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       2.028232707197       residual = 4.52e+06           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+11 is 7.111300e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740639820030       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740639820030       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740639820030       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740639820030       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741964662961       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740639750826       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739429785519       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740842501317       residual = 4.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744391837940       residual = 9.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743360269594       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738220799806       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.728513722810       residual = 5.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.785714823264       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.860022428286       residual = 7.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.607356727942       residual = 4.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.650827655201       residual = 1.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.140951126553       residual = 2.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       0.690870777109       residual = 7.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.303982337597       residual = 1.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.295758241016       residual = 4.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.363316615843       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =     -10.155601062364       residual = 1.47e+04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -5.120630073148       residual = 3.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.477669276205       residual = 9.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+12 is 1.698590e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740639820030       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740639820030       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740639820030       residual = 9.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740694221441       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740639820013       residual = 9.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.737174053218       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740638073828       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.737529435836       residual = 7.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742336955891       residual = 6.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.752398199039       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743313640288       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.737431072323       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740525096589       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740063379205       residual = 8.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739516046201       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739346444640       residual = 5.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740644214579       residual = 3.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.726739961714       residual = 3.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745592224765       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.714623618522       residual = 7.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.787454263297       residual = 4.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.894919159560       residual = 1.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.671732600684       residual = 3.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.644481169856       residual = 6.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.723362013632       residual = 4.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.889628132081       residual = 2.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.705020195978       residual = 1.41e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.476276804530       residual = 4.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.877052521543       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.021259912955       residual = 8.77e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.846027687599       residual = 3.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.548344830401       residual = 3.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.899778233246       residual = 3.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.292035078181       residual = 7.45e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.770551275445       residual = 4.54e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.106885845787       residual = 1.29e+04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -2.029086236425       residual = 4.96e+04           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   tar_fn =       1.617194208456       residual = 1.13e+04           smallest_sin_value = 9.97e-01
davidson iteration   38 stopping due to too large eigenvalue change
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.8208e+12 is 4.423525e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.852082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1538e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -22.6212
    reference variance = 0.267353
====================================================
  Execution time = 2.6037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4909e-01
  Total weights = 1.9555e+06
  Execution time = 3.5935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439957918244
                                         uncertainty =       0.002012970043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439957918244
                                         uncertainty =       0.002012970043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469065197
  error estimate for blocks of size 2^( 2) =       0.000492990485
  error estimate for blocks of size 2^( 3) =       0.000514935623
  error estimate for blocks of size 2^( 4) =       0.000530866126
  error estimate for blocks of size 2^( 5) =       0.000540690154
  error estimate for blocks of size 2^( 6) =       0.000544538394
  error estimate for blocks of size 2^( 7) =       0.000546012134

      target function =      -0.746081287879
              le_mean =     -22.662135854441
             les_mean =     514.021488586324
             stat err =       0.000540526702
             autocorr =       1.327907685889
   target nu stat err =       0.000540526702
   target dn stat err =       0.002692408765
      target stat err =       0.002296829163
              std dev =       0.663358362914
             le_variance =       0.440044317648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439957918244
                                         uncertainty =       0.002012970043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439957918244
                                         uncertainty =       0.002012970043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469065197
  error estimate for blocks of size 2^( 2) =       0.000492990485
  error estimate for blocks of size 2^( 3) =       0.000514935623
  error estimate for blocks of size 2^( 4) =       0.000530866126
  error estimate for blocks of size 2^( 5) =       0.000540690154
  error estimate for blocks of size 2^( 6) =       0.000544538394
  error estimate for blocks of size 2^( 7) =       0.000546012134

      target function =      -0.746081287879
              le_mean =     -22.662135854441
             les_mean =     514.021488586324
             stat err =       0.000540526702
             autocorr =       1.327907685890
   target nu stat err =       0.000540526702
   target dn stat err =       0.002692408765
      target stat err =       0.002296829163
              std dev =       0.663358362914
             le_variance =       0.440044317648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439957918244
                                         uncertainty =       0.002012970043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439957918244
                                         uncertainty =       0.002012970043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469065197
  error estimate for blocks of size 2^( 2) =       0.000492990485
  error estimate for blocks of size 2^( 3) =       0.000514935623
  error estimate for blocks of size 2^( 4) =       0.000530866126
  error estimate for blocks of size 2^( 5) =       0.000540690154
  error estimate for blocks of size 2^( 6) =       0.000544538394
  error estimate for blocks of size 2^( 7) =       0.000546012134

      target function =      -0.746081287879
              le_mean =     -22.662135854441
             les_mean =     514.021488586324
             stat err =       0.000540526702
             autocorr =       1.327907685890
   target nu stat err =       0.000540526702
   target dn stat err =       0.002692408765
      target stat err =       0.002296829163
              std dev =       0.663358362914
             le_variance =       0.440044317648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439957918244
                                         uncertainty =       0.002012970043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439957918244
                                         uncertainty =       0.002012970043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469065197
  error estimate for blocks of size 2^( 2) =       0.000492990485
  error estimate for blocks of size 2^( 3) =       0.000514935623
  error estimate for blocks of size 2^( 4) =       0.000530866126
  error estimate for blocks of size 2^( 5) =       0.000540690154
  error estimate for blocks of size 2^( 6) =       0.000544538394
  error estimate for blocks of size 2^( 7) =       0.000546012134

      target function =      -0.746081287879
              le_mean =     -22.662135854441
             les_mean =     514.021488586324
             stat err =       0.000540526702
             autocorr =       1.327907685889
   target nu stat err =       0.000540526702
   target dn stat err =       0.002692408765
      target stat err =       0.002296829163
              std dev =       0.663358362914
             le_variance =       0.440044317648


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746081287879        initial
     3.6380e+11     3.6380e+12             7.1113e-16        -0.746081287879  <--
     1.4552e+12     1.4552e+13             1.6986e-16        -0.746081287879
     5.8208e+12     5.8208e+13             4.4235e-17        -0.746081287879

*****************************************************************************
Applying the update for shift_i =   3.6380e+11     and shift_s =   3.6380e+12
*****************************************************************************

  Execution time = 4.4079e+01
  </log>
  <optVariables href="FORM2.s057.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5628e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.6449
    reference variance = 0.296716
====================================================
  Execution time = 2.6542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5677e-01
  Total weights = 1.955204669e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446115993168
                                         uncertainty =       0.002688434635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446115993168
                                         uncertainty =       0.002688434635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472264397
  error estimate for blocks of size 2^( 2) =       0.000496174995
  error estimate for blocks of size 2^( 3) =       0.000518023038
  error estimate for blocks of size 2^( 4) =       0.000533693721
  error estimate for blocks of size 2^( 5) =       0.000544723341
  error estimate for blocks of size 2^( 6) =       0.000549752303
  error estimate for blocks of size 2^( 7) =       0.000553060481

      target function =      -0.739798182730
              le_mean =     -22.662849825095
             les_mean =     514.061535689382
             stat err =       0.000545307461
             autocorr =       1.333252687888
   target nu stat err =       0.000545307461
   target dn stat err =       0.003431737633
      target stat err =       0.002845977415
              std dev =       0.667882715204
             le_variance =       0.446067321268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266284982509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739808325937       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739808325937       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739808325937       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739808325937       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739750862123       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739808325937       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739788528771       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739916681292       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739804195616       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739731117735       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739845481911       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739900085535       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739477365759       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740073321906       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739899013774       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739858697195       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739801330605       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740678024528       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740614300632       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.748456931364       residual = 3.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.842130947477       residual = 2.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.582311984736       residual = 1.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.649647288781       residual = 2.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.376618342374       residual = 7.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -3.629597193928       residual = 3.52e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       2.323562422302       residual = 1.29e+05           smallest_sin_value = 1.00e+00
davidson iteration   26 stopping due to too large eigenvalue change
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+10 is 4.907312e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739808325937       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739808325937       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739808325937       residual = 7.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739940111737       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739808325937       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739808325937       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739681794657       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739491999914       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740840957753       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739727608368       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739750823036       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740080893762       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739347922942       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740024469535       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740162050349       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739375876512       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739527734258       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736700567572       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739383144507       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.734632275229       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.700961561185       residual = 3.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.754996622541       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.770911390929       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.686781704298       residual = 8.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939994613157       residual = 3.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.663018361696       residual = 4.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.617185976710       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       3.008978174559       residual = 1.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -7.508488865227       residual = 1.96e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.130841046807       residual = 2.77e+04           smallest_sin_value = 1.00e+00
davidson iteration   30 stopping due to too large eigenvalue change
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+11 is 1.222435e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739808325937       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739808325937       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739808325937       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739808325937       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739408894297       residual = 9.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739808325937       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740264654649       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740577386356       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739394930073       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741035033527       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749083981397       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.732715753573       residual = 9.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.735508409485       residual = 6.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.729705201230       residual = 4.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.565895866452       residual = 7.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.507299416968       residual = 2.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.828799832646       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.709959045584       residual = 1.57e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.491710520302       residual = 8.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.657757125601       residual = 7.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   20 stopping due to too large eigenvalue change
davidson solver did not converge after         20 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4552e+12 is 3.269726e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.876215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1280e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -22.7006
    reference variance = 0.299837
====================================================
  Execution time = 2.6138e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5360e-01
  Total weights = 1.9552e+06
  Execution time = 3.5936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443235887005
                                         uncertainty =       0.002138649314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443235887005
                                         uncertainty =       0.002138649314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470805172
  error estimate for blocks of size 2^( 2) =       0.000494592042
  error estimate for blocks of size 2^( 3) =       0.000516502132
  error estimate for blocks of size 2^( 4) =       0.000532669295
  error estimate for blocks of size 2^( 5) =       0.000543114349
  error estimate for blocks of size 2^( 6) =       0.000547917046
  error estimate for blocks of size 2^( 7) =       0.000551884486

      target function =      -0.742373852335
              le_mean =     -22.661188632600
             les_mean =     513.983074252338
             stat err =       0.000543896294
             autocorr =       1.334595785804
   target nu stat err =       0.000543896294
   target dn stat err =       0.002888956479
      target stat err =       0.002427442338
              std dev =       0.665819059483
             le_variance =       0.443315019971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443235887005
                                         uncertainty =       0.002138649314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443235887005
                                         uncertainty =       0.002138649314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470805172
  error estimate for blocks of size 2^( 2) =       0.000494592042
  error estimate for blocks of size 2^( 3) =       0.000516502132
  error estimate for blocks of size 2^( 4) =       0.000532669295
  error estimate for blocks of size 2^( 5) =       0.000543114349
  error estimate for blocks of size 2^( 6) =       0.000547917046
  error estimate for blocks of size 2^( 7) =       0.000551884486

      target function =      -0.742373852335
              le_mean =     -22.661188632600
             les_mean =     513.983074252338
             stat err =       0.000543896294
             autocorr =       1.334595785793
   target nu stat err =       0.000543896294
   target dn stat err =       0.002888956479
      target stat err =       0.002427442338
              std dev =       0.665819059483
             le_variance =       0.443315019971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443235887005
                                         uncertainty =       0.002138649314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443235887005
                                         uncertainty =       0.002138649314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470805172
  error estimate for blocks of size 2^( 2) =       0.000494592042
  error estimate for blocks of size 2^( 3) =       0.000516502132
  error estimate for blocks of size 2^( 4) =       0.000532669295
  error estimate for blocks of size 2^( 5) =       0.000543114349
  error estimate for blocks of size 2^( 6) =       0.000547917046
  error estimate for blocks of size 2^( 7) =       0.000551884486

      target function =      -0.742373852335
              le_mean =     -22.661188632600
             les_mean =     513.983074252338
             stat err =       0.000543896294
             autocorr =       1.334595785793
   target nu stat err =       0.000543896294
   target dn stat err =       0.002888956479
      target stat err =       0.002427442338
              std dev =       0.665819059483
             le_variance =       0.443315019971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443235887005
                                         uncertainty =       0.002138649314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443235887005
                                         uncertainty =       0.002138649314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470805172
  error estimate for blocks of size 2^( 2) =       0.000494592042
  error estimate for blocks of size 2^( 3) =       0.000516502132
  error estimate for blocks of size 2^( 4) =       0.000532669295
  error estimate for blocks of size 2^( 5) =       0.000543114349
  error estimate for blocks of size 2^( 6) =       0.000547917046
  error estimate for blocks of size 2^( 7) =       0.000551884486

      target function =      -0.742373852335
              le_mean =     -22.661188632600
             les_mean =     513.983074252338
             stat err =       0.000543896294
             autocorr =       1.334595785798
   target nu stat err =       0.000543896294
   target dn stat err =       0.002888956479
      target stat err =       0.002427442338
              std dev =       0.665819059483
             le_variance =       0.443315019971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742373852335        initial
     9.0949e+10     9.0949e+11             4.9073e-15        -0.742373852335  <--
     3.6380e+11     3.6380e+12             1.2224e-15        -0.742373852335
     1.4552e+12     1.4552e+13             3.2697e-16        -0.742373852335

*****************************************************************************
Applying the update for shift_i =   9.0949e+10     and shift_s =   9.0949e+11
*****************************************************************************

  Execution time = 4.4194e+01
  </log>
  <optVariables href="FORM2.s058.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5480e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.5671
    reference variance = 0.475158
====================================================
  Execution time = 2.8391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5277e-01
  Total weights = 1.955219734e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7322e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444592159890
                                         uncertainty =       0.002490703017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444592159890
                                         uncertainty =       0.002490703017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471479418
  error estimate for blocks of size 2^( 2) =       0.000495594399
  error estimate for blocks of size 2^( 3) =       0.000517230301
  error estimate for blocks of size 2^( 4) =       0.000532681515
  error estimate for blocks of size 2^( 5) =       0.000541779615
  error estimate for blocks of size 2^( 6) =       0.000545978508
  error estimate for blocks of size 2^( 7) =       0.000548025699

      target function =      -0.743061315567
              le_mean =     -22.662126828615
             les_mean =     514.024759168446
             stat err =       0.000542116334
             autocorr =       1.322085395790
   target nu stat err =       0.000542116334
   target dn stat err =       0.002905580413
      target stat err =       0.002447873470
              std dev =       0.666772587950
             le_variance =       0.444585684041


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266212682862e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+10, overlap shift 2.2737e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743068489241       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743068489241       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743068489241       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743062098886       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743067394284       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743068489241       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743047154154       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743056711204       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743103567640       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743096513631       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743032429885       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743077847180       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743150880292       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743061498403       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743060148676       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742997970858       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743068460545       residual = 6.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743206803918       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742957843259       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743147372911       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743075485052       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746501830516       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.754449391302       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.486163318371       residual = 7.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744323004669       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932193736566       residual = 2.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.550267672109       residual = 6.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.678822975899       residual = 4.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.805818701604       residual = 1.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.619916555399       residual = 1.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.724420108008       residual = 1.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       1.453100784534       residual = 2.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.755071997016       residual = 7.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+10 is 9.002365e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743068489241       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743068489241       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743068489241       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743064084964       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743078762890       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743068488480       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742969997170       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743135763277       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743154219607       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743081382984       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742780148687       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743051440751       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742933189368       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743184783436       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743048580514       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743042740612       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743217220844       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743045224972       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743333694459       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742827543088       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742890073726       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742967411142       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742798455804       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742829786370       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743387464581       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743217834329       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740807927652       residual = 8.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741570271468       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743628321221       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.742354819663       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742472860424       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.744012175193       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.745136327049       residual = 4.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.682447572217       residual = 6.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942611281866       residual = 1.13e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.655635777506       residual = 6.44e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.836288597457       residual = 3.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.707353613282       residual = 1.43e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -3.698233028348       residual = 4.37e+04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.237100099539       residual = 1.33e+04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =     -10.358024896305       residual = 1.04e+06           smallest_sin_value = 9.97e-01
davidson iteration   41:   krylov dim =  42   tar_fn =       0.153655146277       residual = 1.21e+05           smallest_sin_value = 9.93e-01
davidson iteration   42 stopping due to too large eigenvalue change
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+10 is 2.245623e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.6380e+11, overlap shift 3.6380e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743068489241       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743068489241       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743068489241       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743068517032       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743068489213       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743009436587       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743343105655       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743529467072       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742133564812       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743232152964       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743294261998       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741629330609       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743169688650       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742909390178       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745416622106       residual = 7.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.735496049472       residual = 6.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746519301325       residual = 4.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744292690395       residual = 5.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.733703803377       residual = 8.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.738350962489       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741631133858       residual = 2.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749521658616       residual = 4.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749396012968       residual = 1.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935859453017       residual = 1.60e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.785636360400       residual = 1.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944876125193       residual = 6.41e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.582424533496       residual = 7.70e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.338820783099       residual = 4.82e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       1.489070796393       residual = 8.66e+05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.385889203314       residual = 2.78e+05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.603267595476       residual = 8.87e+05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       5.373272005679       residual = 1.13e+09           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       5.677975691892       residual = 4.54e+07           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.6380e+11 is 5.663821e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.934657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3187e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -22.6384
    reference variance = 0.394994
====================================================
  Execution time = 2.5885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5544e-01
  Total weights = 1.9552e+06
  Execution time = 3.5997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444835725142
                                         uncertainty =       0.005211795507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444835725142
                                         uncertainty =       0.005211795507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471640004
  error estimate for blocks of size 2^( 2) =       0.000495740318
  error estimate for blocks of size 2^( 3) =       0.000517425628
  error estimate for blocks of size 2^( 4) =       0.000533273301
  error estimate for blocks of size 2^( 5) =       0.000543028557
  error estimate for blocks of size 2^( 6) =       0.000548177710
  error estimate for blocks of size 2^( 7) =       0.000550738146

      target function =      -0.740862948870
              le_mean =     -22.662191717435
             les_mean =     514.030368583058
             stat err =       0.000543804428
             autocorr =       1.329426133891
   target nu stat err =       0.000543804428
   target dn stat err =       0.006039164686
      target stat err =       0.004942234951
              std dev =       0.666999689585
             le_variance =       0.444888585906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444835725142
                                         uncertainty =       0.005211795507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444835725142
                                         uncertainty =       0.005211795507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471640004
  error estimate for blocks of size 2^( 2) =       0.000495740318
  error estimate for blocks of size 2^( 3) =       0.000517425628
  error estimate for blocks of size 2^( 4) =       0.000533273301
  error estimate for blocks of size 2^( 5) =       0.000543028557
  error estimate for blocks of size 2^( 6) =       0.000548177710
  error estimate for blocks of size 2^( 7) =       0.000550738146

      target function =      -0.740862948870
              le_mean =     -22.662191717435
             les_mean =     514.030368583058
             stat err =       0.000543804428
             autocorr =       1.329426133891
   target nu stat err =       0.000543804428
   target dn stat err =       0.006039164686
      target stat err =       0.004942234951
              std dev =       0.666999689585
             le_variance =       0.444888585906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444835725142
                                         uncertainty =       0.005211795507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444835725142
                                         uncertainty =       0.005211795507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471640004
  error estimate for blocks of size 2^( 2) =       0.000495740318
  error estimate for blocks of size 2^( 3) =       0.000517425628
  error estimate for blocks of size 2^( 4) =       0.000533273301
  error estimate for blocks of size 2^( 5) =       0.000543028557
  error estimate for blocks of size 2^( 6) =       0.000548177710
  error estimate for blocks of size 2^( 7) =       0.000550738146

      target function =      -0.740862948870
              le_mean =     -22.662191717435
             les_mean =     514.030368583058
             stat err =       0.000543804428
             autocorr =       1.329426133886
   target nu stat err =       0.000543804428
   target dn stat err =       0.006039164686
      target stat err =       0.004942234951
              std dev =       0.666999689585
             le_variance =       0.444888585906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444835725142
                                         uncertainty =       0.005211795507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444835725142
                                         uncertainty =       0.005211795507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471640004
  error estimate for blocks of size 2^( 2) =       0.000495740318
  error estimate for blocks of size 2^( 3) =       0.000517425628
  error estimate for blocks of size 2^( 4) =       0.000533273301
  error estimate for blocks of size 2^( 5) =       0.000543028557
  error estimate for blocks of size 2^( 6) =       0.000548177710
  error estimate for blocks of size 2^( 7) =       0.000550738146

      target function =      -0.740862948870
              le_mean =     -22.662191717435
             les_mean =     514.030368583058
             stat err =       0.000543804428
             autocorr =       1.329426133890
   target nu stat err =       0.000543804428
   target dn stat err =       0.006039164686
      target stat err =       0.004942234951
              std dev =       0.666999689585
             le_variance =       0.444888585906


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740862948870        initial
     2.2737e+10     2.2737e+11             9.0024e-15        -0.740862948870  <--
     9.0949e+10     9.0949e+11             2.2456e-15        -0.740862948870
     3.6380e+11     3.6380e+12             5.6638e-16        -0.740862948870

*****************************************************************************
Applying the update for shift_i =   2.2737e+10     and shift_s =   2.2737e+11
*****************************************************************************

  Execution time = 4.3944e+01
  </log>
  <optVariables href="FORM2.s059.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.7137e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.6348
    reference variance = 0.282434
====================================================
  Execution time = 2.6805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5453e-01
  Total weights = 1.955070463e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445105712363
                                         uncertainty =       0.002655840537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445105712363
                                         uncertainty =       0.002655840537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471720146
  error estimate for blocks of size 2^( 2) =       0.000495452084
  error estimate for blocks of size 2^( 3) =       0.000517267981
  error estimate for blocks of size 2^( 4) =       0.000533417444
  error estimate for blocks of size 2^( 5) =       0.000542051744
  error estimate for blocks of size 2^( 6) =       0.000549338423
  error estimate for blocks of size 2^( 7) =       0.000548472779

      target function =      -0.741622854830
              le_mean =     -22.662512445764
             les_mean =     514.043996692864
             stat err =       0.000543320098
             autocorr =       1.326608243684
   target nu stat err =       0.000543320098
   target dn stat err =       0.003674746337
      target stat err =       0.003051672700
              std dev =       0.667113028057
             le_variance =       0.445039792203


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266251244576e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+09, overlap shift 5.6843e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741634342396       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741634342396       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741634342396       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741634342396       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741634342396       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741634345249       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741636595748       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741636517737       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741626567760       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741625320999       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741627848867       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+09 is 2.988441e-14

solving harmonic davidson linear method for identity shift 2.2737e+10, overlap shift 2.2737e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741634342396       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741634342396       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741634342396       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741634342396       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741634342352       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741634340086       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741641735182       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741638887789       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741601451956       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741624746760       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741587524001       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741624991029       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741602850658       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741613550807       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741660355332       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741631231215       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741710639807       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741633541844       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741672081936       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741507601384       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741482514583       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741900113934       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741490032051       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741072632910       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741479664339       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.742242806226       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.739125328090       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742116685920       residual = 9.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.717494073212       residual = 3.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.707041231897       residual = 3.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.838882394124       residual = 2.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.803499810185       residual = 1.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.131267250394       residual = 1.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       0.029114852855       residual = 3.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       3.613314534057       residual = 4.82e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       2.192982250819       residual = 1.24e+04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.961443856494       residual = 8.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -3.365570261200       residual = 5.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.200492948259       residual = 2.33e+04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.715650102908       residual = 1.32e+04           smallest_sin_value = 1.00e+00
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+10 is 7.503250e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.0949e+10, overlap shift 9.0949e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741634342396       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741634342396       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741634342396       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741634342396       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741637830033       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741633619635       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741632540548       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741510687529       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741720035465       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741497177144       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741396411201       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741541592000       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741727813300       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741751025731       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741610530857       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741483351158       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741612999798       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.738702607567       residual = 9.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.738146948848       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.739112282467       residual = 7.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.758494622406       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.733805137908       residual = 5.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.730046277155       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.283766964567       residual = 2.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.204172092381       residual = 1.60e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.683979613320       residual = 2.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.885804652305       residual = 1.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.767646072522       residual = 6.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.475218361602       residual = 1.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -6.029383174784       residual = 4.87e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       7.472260892036       residual = 3.00e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.260221138288       residual = 6.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.884356195206       residual = 6.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -7.508561585609       residual = 9.46e+04           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 9.0949e+10 is 1.842537e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.977194 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1581e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -22.7893
    reference variance = 0.423925
====================================================
  Execution time = 2.5901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4870e-01
  Total weights = 1.9551e+06
  Execution time = 3.6053e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369531952
                                         uncertainty =       0.002099121410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369531952
                                         uncertainty =       0.002099121410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468694324
  error estimate for blocks of size 2^( 2) =       0.000492799709
  error estimate for blocks of size 2^( 3) =       0.000514581384
  error estimate for blocks of size 2^( 4) =       0.000530228111
  error estimate for blocks of size 2^( 5) =       0.000537913894
  error estimate for blocks of size 2^( 6) =       0.000541460367
  error estimate for blocks of size 2^( 7) =       0.000546198833

      target function =      -0.746400795831
              le_mean =     -22.662258722395
             les_mean =     514.026671551313
             stat err =       0.000538950301
             autocorr =       1.322263623096
   target nu stat err =       0.000538950301
   target dn stat err =       0.002642875978
      target stat err =       0.002259268630
              std dev =       0.662833869477
             le_variance =       0.439348738526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369531952
                                         uncertainty =       0.002099121410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369531952
                                         uncertainty =       0.002099121410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468694324
  error estimate for blocks of size 2^( 2) =       0.000492799709
  error estimate for blocks of size 2^( 3) =       0.000514581384
  error estimate for blocks of size 2^( 4) =       0.000530228111
  error estimate for blocks of size 2^( 5) =       0.000537913894
  error estimate for blocks of size 2^( 6) =       0.000541460367
  error estimate for blocks of size 2^( 7) =       0.000546198833

      target function =      -0.746400795831
              le_mean =     -22.662258722395
             les_mean =     514.026671551313
             stat err =       0.000538950301
             autocorr =       1.322263623092
   target nu stat err =       0.000538950301
   target dn stat err =       0.002642875978
      target stat err =       0.002259268630
              std dev =       0.662833869477
             le_variance =       0.439348738526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369531952
                                         uncertainty =       0.002099121410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369531952
                                         uncertainty =       0.002099121410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468694324
  error estimate for blocks of size 2^( 2) =       0.000492799709
  error estimate for blocks of size 2^( 3) =       0.000514581384
  error estimate for blocks of size 2^( 4) =       0.000530228111
  error estimate for blocks of size 2^( 5) =       0.000537913894
  error estimate for blocks of size 2^( 6) =       0.000541460367
  error estimate for blocks of size 2^( 7) =       0.000546198833

      target function =      -0.746400795831
              le_mean =     -22.662258722395
             les_mean =     514.026671551313
             stat err =       0.000538950301
             autocorr =       1.322263623096
   target nu stat err =       0.000538950301
   target dn stat err =       0.002642875978
      target stat err =       0.002259268630
              std dev =       0.662833869477
             le_variance =       0.439348738526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369531952
                                         uncertainty =       0.002099121410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439369531952
                                         uncertainty =       0.002099121410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468694324
  error estimate for blocks of size 2^( 2) =       0.000492799709
  error estimate for blocks of size 2^( 3) =       0.000514581384
  error estimate for blocks of size 2^( 4) =       0.000530228111
  error estimate for blocks of size 2^( 5) =       0.000537913894
  error estimate for blocks of size 2^( 6) =       0.000541460367
  error estimate for blocks of size 2^( 7) =       0.000546198833

      target function =      -0.746400795831
              le_mean =     -22.662258722395
             les_mean =     514.026671551313
             stat err =       0.000538950301
             autocorr =       1.322263623095
   target nu stat err =       0.000538950301
   target dn stat err =       0.002642875978
      target stat err =       0.002259268630
              std dev =       0.662833869477
             le_variance =       0.439348738526


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746400795831        initial
     5.6843e+09     5.6843e+10             2.9884e-14        -0.746400795831  <--
     2.2737e+10     2.2737e+11             7.5033e-15        -0.746400795831
     9.0949e+10     9.0949e+11             1.8425e-15        -0.746400795831

*****************************************************************************
Applying the update for shift_i =   5.6843e+09     and shift_s =   5.6843e+10
*****************************************************************************

  Execution time = 4.3948e+01
  </log>
  <optVariables href="FORM2.s060.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5536e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.6751
    reference variance = 0.389963
====================================================
  Execution time = 2.6860e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5357e-01
  Total weights = 1.954984951e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443223826177
                                         uncertainty =       0.002278417459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443223826177
                                         uncertainty =       0.002278417459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471036010
  error estimate for blocks of size 2^( 2) =       0.000494938967
  error estimate for blocks of size 2^( 3) =       0.000517042395
  error estimate for blocks of size 2^( 4) =       0.000532858946
  error estimate for blocks of size 2^( 5) =       0.000542877568
  error estimate for blocks of size 2^( 6) =       0.000547394782
  error estimate for blocks of size 2^( 7) =       0.000550158951

      target function =      -0.742403102453
              le_mean =     -22.662133878246
             les_mean =     514.025886572650
             stat err =       0.000543322562
             autocorr =       1.330476660240
   target nu stat err =       0.000543322562
   target dn stat err =       0.002637893907
      target stat err =       0.002232918203
              std dev =       0.666145513763
             le_variance =       0.443749845506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266213387825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+09, overlap shift 1.4211e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742408964016       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742408964016       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742408964016       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742408987169       residual = 7.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742408964018       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742408284692       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742409330568       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742408730826       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742405991398       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742405683691       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+09 is 1.413441e-13

solving harmonic davidson linear method for identity shift 5.6843e+09, overlap shift 5.6843e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742408964016       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742408964016       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742408964016       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742408964016       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742408963986       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742408964892       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742409823314       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742418401928       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742406080600       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742414845122       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+09 is 3.535044e-14

solving harmonic davidson linear method for identity shift 2.2737e+10, overlap shift 2.2737e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742408964016       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742408964016       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742408964016       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742408964016       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742408964016       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742409698497       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742406085078       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742444268990       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742331511535       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742407272874       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742405009999       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.742370603705       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.742358868015       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742462005175       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742324729657       residual = 9.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742487238849       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742389100434       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742445309366       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742483635217       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.742482535188       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.741650580247       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.742505057792       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741907829934       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749869025010       residual = 7.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748854297310       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743756884445       residual = 8.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.653094679595       residual = 2.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.738171546437       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.566697802104       residual = 3.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.779232381830       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.705440699827       residual = 8.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.839229697900       residual = 2.72e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.561275067540       residual = 5.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2737e+10 is 8.854051e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.994359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1627e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -22.6665
    reference variance = 0.340123
====================================================
  Execution time = 2.6100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5560e-01
  Total weights = 1.9550e+06
  Execution time = 3.6008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443298571484
                                         uncertainty =       0.003171798197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443298571484
                                         uncertainty =       0.003171798197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470750143
  error estimate for blocks of size 2^( 2) =       0.000494887513
  error estimate for blocks of size 2^( 3) =       0.000516815080
  error estimate for blocks of size 2^( 4) =       0.000532406809
  error estimate for blocks of size 2^( 5) =       0.000541552878
  error estimate for blocks of size 2^( 6) =       0.000544996040
  error estimate for blocks of size 2^( 7) =       0.000547409938

      target function =      -0.740746296430
              le_mean =     -22.661468194766
             les_mean =     513.997736813853
             stat err =       0.000541591416
             autocorr =       1.323617875986
   target nu stat err =       0.000541591416
   target dn stat err =       0.004349170131
      target stat err =       0.003577748056
              std dev =       0.665741236921
             le_variance =       0.443211394538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443298571484
                                         uncertainty =       0.003171798197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443298571484
                                         uncertainty =       0.003171798197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470750143
  error estimate for blocks of size 2^( 2) =       0.000494887513
  error estimate for blocks of size 2^( 3) =       0.000516815080
  error estimate for blocks of size 2^( 4) =       0.000532406809
  error estimate for blocks of size 2^( 5) =       0.000541552878
  error estimate for blocks of size 2^( 6) =       0.000544996040
  error estimate for blocks of size 2^( 7) =       0.000547409938

      target function =      -0.740746296430
              le_mean =     -22.661468194766
             les_mean =     513.997736813853
             stat err =       0.000541591416
             autocorr =       1.323617875993
   target nu stat err =       0.000541591416
   target dn stat err =       0.004349170131
      target stat err =       0.003577748056
              std dev =       0.665741236921
             le_variance =       0.443211394538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443298571484
                                         uncertainty =       0.003171798197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443298571484
                                         uncertainty =       0.003171798197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470750143
  error estimate for blocks of size 2^( 2) =       0.000494887513
  error estimate for blocks of size 2^( 3) =       0.000516815080
  error estimate for blocks of size 2^( 4) =       0.000532406809
  error estimate for blocks of size 2^( 5) =       0.000541552878
  error estimate for blocks of size 2^( 6) =       0.000544996040
  error estimate for blocks of size 2^( 7) =       0.000547409938

      target function =      -0.740746296430
              le_mean =     -22.661468194766
             les_mean =     513.997736813853
             stat err =       0.000541591416
             autocorr =       1.323617875995
   target nu stat err =       0.000541591416
   target dn stat err =       0.004349170131
      target stat err =       0.003577748056
              std dev =       0.665741236921
             le_variance =       0.443211394537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443298571484
                                         uncertainty =       0.003171798197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443298571484
                                         uncertainty =       0.003171798197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470750143
  error estimate for blocks of size 2^( 2) =       0.000494887513
  error estimate for blocks of size 2^( 3) =       0.000516815080
  error estimate for blocks of size 2^( 4) =       0.000532406809
  error estimate for blocks of size 2^( 5) =       0.000541552878
  error estimate for blocks of size 2^( 6) =       0.000544996040
  error estimate for blocks of size 2^( 7) =       0.000547409938

      target function =      -0.740746296430
              le_mean =     -22.661468194766
             les_mean =     513.997736813853
             stat err =       0.000541591416
             autocorr =       1.323617875988
   target nu stat err =       0.000541591416
   target dn stat err =       0.004349170131
      target stat err =       0.003577748056
              std dev =       0.665741236921
             le_variance =       0.443211394538


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740746296430        initial
     1.4211e+09     1.4211e+10             1.4134e-13        -0.740746296430  <--
     5.6843e+09     5.6843e+10             3.5350e-14        -0.740746296430
     2.2737e+10     2.2737e+11             8.8541e-15        -0.740746296430

*****************************************************************************
Applying the update for shift_i =   1.4211e+09     and shift_s =   1.4211e+10
*****************************************************************************

  Execution time = 4.4114e+01
  </log>
  <optVariables href="FORM2.s061.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5747e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.6265
    reference variance = 0.380949
====================================================
  Execution time = 2.6728e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4709e-01
  Total weights = 1.955229962e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438680894353
                                         uncertainty =       0.001986626748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438680894353
                                         uncertainty =       0.001986626748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468401387
  error estimate for blocks of size 2^( 2) =       0.000492370336
  error estimate for blocks of size 2^( 3) =       0.000513613399
  error estimate for blocks of size 2^( 4) =       0.000529513795
  error estimate for blocks of size 2^( 5) =       0.000538572450
  error estimate for blocks of size 2^( 6) =       0.000542835113
  error estimate for blocks of size 2^( 7) =       0.000547168585

      target function =      -0.747736201835
              le_mean =     -22.662799321130
             les_mean =     514.049565299004
             stat err =       0.000539522486
             autocorr =       1.326730624878
   target nu stat err =       0.000539522486
   target dn stat err =       0.002576401124
      target stat err =       0.002215994309
              std dev =       0.662419594432
             le_variance =       0.438799719088


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266279932113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747741840706       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747741840706       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747741840706       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747741840706       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747741911191       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747741840706       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747741762917       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747741840706       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747740951476       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747741426063       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747742661483       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+08 is 5.954456e-13

solving harmonic davidson linear method for identity shift 1.4211e+09, overlap shift 1.4211e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747741840706       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747741840706       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747741840706       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747741840706       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747741840706       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747741694032       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747743368098       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747742043316       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747742915918       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747741840706       residual = 5.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747744224910       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+09 is 1.488827e-13

solving harmonic davidson linear method for identity shift 5.6843e+09, overlap shift 5.6843e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747741840706       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747741840706       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747741840706       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747743848340       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747741720892       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747741095448       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747739839609       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747746656605       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747735336438       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747748319186       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747746052823       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.6843e+09 is 3.720821e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.998497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.1478e+01
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -22.6333
    reference variance = 0.340162
====================================================
  Execution time = 2.5922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4956e-01
  Total weights = 1.9554e+06
  Execution time = 3.5966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438574692683
                                         uncertainty =       0.002063653665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438574692683
                                         uncertainty =       0.002063653665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468300285
  error estimate for blocks of size 2^( 2) =       0.000492032290
  error estimate for blocks of size 2^( 3) =       0.000513541674
  error estimate for blocks of size 2^( 4) =       0.000529661016
  error estimate for blocks of size 2^( 5) =       0.000540374855
  error estimate for blocks of size 2^( 6) =       0.000546125561
  error estimate for blocks of size 2^( 7) =       0.000546454671

      target function =      -0.745690751381
              le_mean =     -22.662167373956
             les_mean =     514.023390658770
             stat err =       0.000540654026
             autocorr =       1.332876892621
   target nu stat err =       0.000540654026
   target dn stat err =       0.002902681438
      target stat err =       0.002462155771
              std dev =       0.662276613655
             le_variance =       0.438610312995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438574692683
                                         uncertainty =       0.002063653665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438574692683
                                         uncertainty =       0.002063653665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468300285
  error estimate for blocks of size 2^( 2) =       0.000492032290
  error estimate for blocks of size 2^( 3) =       0.000513541674
  error estimate for blocks of size 2^( 4) =       0.000529661016
  error estimate for blocks of size 2^( 5) =       0.000540374855
  error estimate for blocks of size 2^( 6) =       0.000546125561
  error estimate for blocks of size 2^( 7) =       0.000546454671

      target function =      -0.745690751383
              le_mean =     -22.662167373956
             les_mean =     514.023390658767
             stat err =       0.000540654026
             autocorr =       1.332876892615
   target nu stat err =       0.000540654026
   target dn stat err =       0.002902681436
      target stat err =       0.002462155770
              std dev =       0.662276613655
             le_variance =       0.438610312995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438574692683
                                         uncertainty =       0.002063653665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438574692683
                                         uncertainty =       0.002063653665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468300285
  error estimate for blocks of size 2^( 2) =       0.000492032290
  error estimate for blocks of size 2^( 3) =       0.000513541674
  error estimate for blocks of size 2^( 4) =       0.000529661016
  error estimate for blocks of size 2^( 5) =       0.000540374855
  error estimate for blocks of size 2^( 6) =       0.000546125561
  error estimate for blocks of size 2^( 7) =       0.000546454671

      target function =      -0.745690751382
              le_mean =     -22.662167373956
             les_mean =     514.023390658768
             stat err =       0.000540654026
             autocorr =       1.332876892614
   target nu stat err =       0.000540654026
   target dn stat err =       0.002902681437
      target stat err =       0.002462155771
              std dev =       0.662276613655
             le_variance =       0.438610312995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438574692683
                                         uncertainty =       0.002063653665

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438574692683
                                         uncertainty =       0.002063653665

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468300285
  error estimate for blocks of size 2^( 2) =       0.000492032290
  error estimate for blocks of size 2^( 3) =       0.000513541674
  error estimate for blocks of size 2^( 4) =       0.000529661016
  error estimate for blocks of size 2^( 5) =       0.000540374855
  error estimate for blocks of size 2^( 6) =       0.000546125561
  error estimate for blocks of size 2^( 7) =       0.000546454671

      target function =      -0.745690751381
              le_mean =     -22.662167373956
             les_mean =     514.023390658769
             stat err =       0.000540654026
             autocorr =       1.332876892613
   target nu stat err =       0.000540654026
   target dn stat err =       0.002902681438
      target stat err =       0.002462155771
              std dev =       0.662276613656
             le_variance =       0.438610312995


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745690751381        initial
     3.5527e+08     3.5527e+09             5.9545e-13        -0.745690751383  <--
     1.4211e+09     1.4211e+10             1.4888e-13        -0.745690751382
     5.6843e+09     5.6843e+10             3.7208e-14        -0.745690751381

*****************************************************************************
Applying the update for shift_i =   3.5527e+08     and shift_s =   3.5527e+09
*****************************************************************************

  Execution time = 4.3974e+01
  </log>
  <optVariables href="FORM2.s062.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5458e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.6073
    reference variance = 0.314131
====================================================
  Execution time = 2.8265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.7038e-01
  Total weights = 1.955223244e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445273200556
                                         uncertainty =       0.003934790050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445273200556
                                         uncertainty =       0.003934790050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471784324
  error estimate for blocks of size 2^( 2) =       0.000495948057
  error estimate for blocks of size 2^( 3) =       0.000518096688
  error estimate for blocks of size 2^( 4) =       0.000534420479
  error estimate for blocks of size 2^( 5) =       0.000543906757
  error estimate for blocks of size 2^( 6) =       0.000545694392
  error estimate for blocks of size 2^( 7) =       0.000549327199

      target function =      -0.728787274855
              le_mean =     -22.662358436648
             les_mean =     514.052866249761
             stat err =       0.000543337207
             autocorr =       1.326330872752
   target nu stat err =       0.000543337207
   target dn stat err =       0.013808540902
      target stat err =       0.010875589634
              std dev =       0.667203789253
             le_variance =       0.445160896394


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266235843665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+07, overlap shift 8.8818e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.728949000016       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.728949000017       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.728949000017       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.728948960714       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.728949000017       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.728949000017       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.728949000017       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.728949121364       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.728949020251       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.728948829770       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.728949000017       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.728948815739       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+07 is 2.576289e-12

solving harmonic davidson linear method for identity shift 3.5527e+08, overlap shift 3.5527e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.728949000016       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.728949000016       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.728949000016       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.728949057402       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.728948937259       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.728949000016       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.728949333110       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.728948870000       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.728947796991       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.728949180615       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.728947896671       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.728949575789       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+08 is 6.439500e-13

solving harmonic davidson linear method for identity shift 1.4211e+09, overlap shift 1.4211e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.728949000016       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.728949000016       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.728949000016       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.728949000016       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.728949000016       residual = 9.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.728950996874       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.728948674370       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.728949841202       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.728949000016       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.728949156665       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.728954356410       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.728951483909       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+09 is 1.611250e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.003266 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.3063e+01
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -22.5917
    reference variance = 0.587715
====================================================
  Execution time = 2.5052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5061e-01
  Total weights = 1.9552e+06
  Execution time = 3.6129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441224486660
                                         uncertainty =       0.002178571286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441224486660
                                         uncertainty =       0.002178571286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469679220
  error estimate for blocks of size 2^( 2) =       0.000493211546
  error estimate for blocks of size 2^( 3) =       0.000514668981
  error estimate for blocks of size 2^( 4) =       0.000531093589
  error estimate for blocks of size 2^( 5) =       0.000539831120
  error estimate for blocks of size 2^( 6) =       0.000543275606
  error estimate for blocks of size 2^( 7) =       0.000546571837

      target function =      -0.744831441087
              le_mean =     -22.662001352841
             les_mean =     514.016911869285
             stat err =       0.000540193038
             autocorr =       1.322803308373
   target nu stat err =       0.000540193038
   target dn stat err =       0.002545558587
      target stat err =       0.002172679117
              std dev =       0.664226723138
             le_variance =       0.441197139730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441224486660
                                         uncertainty =       0.002178571286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441224486660
                                         uncertainty =       0.002178571286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469679220
  error estimate for blocks of size 2^( 2) =       0.000493211546
  error estimate for blocks of size 2^( 3) =       0.000514668981
  error estimate for blocks of size 2^( 4) =       0.000531093589
  error estimate for blocks of size 2^( 5) =       0.000539831120
  error estimate for blocks of size 2^( 6) =       0.000543275606
  error estimate for blocks of size 2^( 7) =       0.000546571837

      target function =      -0.744831441087
              le_mean =     -22.662001352841
             les_mean =     514.016911869285
             stat err =       0.000540193038
             autocorr =       1.322803308377
   target nu stat err =       0.000540193038
   target dn stat err =       0.002545558587
      target stat err =       0.002172679117
              std dev =       0.664226723138
             le_variance =       0.441197139730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441224486660
                                         uncertainty =       0.002178571286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441224486660
                                         uncertainty =       0.002178571286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469679220
  error estimate for blocks of size 2^( 2) =       0.000493211546
  error estimate for blocks of size 2^( 3) =       0.000514668981
  error estimate for blocks of size 2^( 4) =       0.000531093589
  error estimate for blocks of size 2^( 5) =       0.000539831120
  error estimate for blocks of size 2^( 6) =       0.000543275606
  error estimate for blocks of size 2^( 7) =       0.000546571837

      target function =      -0.744831441087
              le_mean =     -22.662001352841
             les_mean =     514.016911869285
             stat err =       0.000540193038
             autocorr =       1.322803308380
   target nu stat err =       0.000540193038
   target dn stat err =       0.002545558587
      target stat err =       0.002172679117
              std dev =       0.664226723138
             le_variance =       0.441197139730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441224486660
                                         uncertainty =       0.002178571286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441224486660
                                         uncertainty =       0.002178571286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469679220
  error estimate for blocks of size 2^( 2) =       0.000493211546
  error estimate for blocks of size 2^( 3) =       0.000514668981
  error estimate for blocks of size 2^( 4) =       0.000531093589
  error estimate for blocks of size 2^( 5) =       0.000539831120
  error estimate for blocks of size 2^( 6) =       0.000543275606
  error estimate for blocks of size 2^( 7) =       0.000546571837

      target function =      -0.744831441087
              le_mean =     -22.662001352841
             les_mean =     514.016911869285
             stat err =       0.000540193038
             autocorr =       1.322803308377
   target nu stat err =       0.000540193038
   target dn stat err =       0.002545558587
      target stat err =       0.002172679117
              std dev =       0.664226723138
             le_variance =       0.441197139730


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744831441087        initial  <--
     8.8818e+07     8.8818e+08             2.5763e-12        -0.744831441087
     3.5527e+08     3.5527e+09             6.4395e-13        -0.744831441087
     1.4211e+09     1.4211e+10             1.6113e-13        -0.744831441087

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.1996
  </log>
  <optVariables href="FORM2.s063.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6288e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.7265
    reference variance = 0.45186
====================================================
  Execution time = 2.5840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5039e-01
  Total weights = 1.955480756e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441325241254
                                         uncertainty =       0.002445682348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441325241254
                                         uncertainty =       0.002445682348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469785665
  error estimate for blocks of size 2^( 2) =       0.000493363020
  error estimate for blocks of size 2^( 3) =       0.000514961480
  error estimate for blocks of size 2^( 4) =       0.000531886910
  error estimate for blocks of size 2^( 5) =       0.000540956109
  error estimate for blocks of size 2^( 6) =       0.000546891941
  error estimate for blocks of size 2^( 7) =       0.000551175755

      target function =      -0.745012380337
              le_mean =     -22.662488255610
             les_mean =     514.038764732070
             stat err =       0.000542727679
             autocorr =       1.334640869932
   target nu stat err =       0.000542727679
   target dn stat err =       0.002512022333
      target stat err =       0.002149544914
              std dev =       0.664377259046
             le_variance =       0.441397142338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266248825561e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745017651624       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745017651624       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745017651624       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745017651624       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745017651624       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745017916351       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745015282443       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745017318502       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745015028512       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745016858032       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745018052735       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745016877121       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+08 is 2.452026e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745017651624       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745017651624       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745017651624       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745017651624       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745017651624       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745017651640       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745016977289       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745024728986       residual = 4.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745017464026       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745022347913       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745012536573       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745007043063       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+09 is 6.125488e-14

solving harmonic davidson linear method for identity shift 1.4211e+10, overlap shift 1.4211e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745017651624       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745017651624       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745017651624       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745017651624       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745017651591       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745017697284       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745017429186       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745020845336       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744988007301       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744990213106       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744954303383       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745042796718       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745055980821       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745024763857       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745000157978       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.4211e+10 is 1.531837e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.008836 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0587e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -22.6499
    reference variance = 0.526758
====================================================
  Execution time = 2.5142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4842e-01
  Total weights = 1.9550e+06
  Execution time = 3.6334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439242017760
                                         uncertainty =       0.001853701695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439242017760
                                         uncertainty =       0.001853701695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468678883
  error estimate for blocks of size 2^( 2) =       0.000493139522
  error estimate for blocks of size 2^( 3) =       0.000515113275
  error estimate for blocks of size 2^( 4) =       0.000530478154
  error estimate for blocks of size 2^( 5) =       0.000539220863
  error estimate for blocks of size 2^( 6) =       0.000544237224
  error estimate for blocks of size 2^( 7) =       0.000544187656

      target function =      -0.746615140534
              le_mean =     -22.660954062369
             les_mean =     513.967262902340
             stat err =       0.000539530974
             autocorr =       1.325201726760
   target nu stat err =       0.000539530974
   target dn stat err =       0.002718592001
      target stat err =       0.002316537645
              std dev =       0.662812032038
             le_variance =       0.439319789814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439242017760
                                         uncertainty =       0.001853701695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439242017760
                                         uncertainty =       0.001853701695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468678883
  error estimate for blocks of size 2^( 2) =       0.000493139522
  error estimate for blocks of size 2^( 3) =       0.000515113275
  error estimate for blocks of size 2^( 4) =       0.000530478154
  error estimate for blocks of size 2^( 5) =       0.000539220863
  error estimate for blocks of size 2^( 6) =       0.000544237224
  error estimate for blocks of size 2^( 7) =       0.000544187656

      target function =      -0.746615140534
              le_mean =     -22.660954062369
             les_mean =     513.967262902340
             stat err =       0.000539530974
             autocorr =       1.325201726761
   target nu stat err =       0.000539530974
   target dn stat err =       0.002718592001
      target stat err =       0.002316537646
              std dev =       0.662812032037
             le_variance =       0.439319789814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439242017760
                                         uncertainty =       0.001853701695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439242017760
                                         uncertainty =       0.001853701695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468678883
  error estimate for blocks of size 2^( 2) =       0.000493139522
  error estimate for blocks of size 2^( 3) =       0.000515113275
  error estimate for blocks of size 2^( 4) =       0.000530478154
  error estimate for blocks of size 2^( 5) =       0.000539220863
  error estimate for blocks of size 2^( 6) =       0.000544237224
  error estimate for blocks of size 2^( 7) =       0.000544187656

      target function =      -0.746615140534
              le_mean =     -22.660954062369
             les_mean =     513.967262902340
             stat err =       0.000539530974
             autocorr =       1.325201726767
   target nu stat err =       0.000539530974
   target dn stat err =       0.002718592001
      target stat err =       0.002316537645
              std dev =       0.662812032037
             le_variance =       0.439319789814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439242017760
                                         uncertainty =       0.001853701695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439242017760
                                         uncertainty =       0.001853701695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468678883
  error estimate for blocks of size 2^( 2) =       0.000493139522
  error estimate for blocks of size 2^( 3) =       0.000515113275
  error estimate for blocks of size 2^( 4) =       0.000530478154
  error estimate for blocks of size 2^( 5) =       0.000539220863
  error estimate for blocks of size 2^( 6) =       0.000544237224
  error estimate for blocks of size 2^( 7) =       0.000544187656

      target function =      -0.746615140534
              le_mean =     -22.660954062369
             les_mean =     513.967262902340
             stat err =       0.000539530974
             autocorr =       1.325201726760
   target nu stat err =       0.000539530974
   target dn stat err =       0.002718592001
      target stat err =       0.002316537645
              std dev =       0.662812032038
             le_variance =       0.439319789814


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746615140534        initial
     8.8818e+08     8.8818e+09             2.4520e-13        -0.746615140534  <--
     3.5527e+09     3.5527e+10             6.1255e-14        -0.746615140534
     1.4211e+10     1.4211e+11             1.5318e-14        -0.746615140534

*****************************************************************************
Applying the update for shift_i =   8.8818e+08     and shift_s =   8.8818e+09
*****************************************************************************

  Execution time = 4.3353e+01
  </log>
  <optVariables href="FORM2.s064.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3946e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.7242
    reference variance = 0.494253
====================================================
  Execution time = 2.5809e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4920e-01
  Total weights = 1.954895177e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439654816860
                                         uncertainty =       0.002002732796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439654816860
                                         uncertainty =       0.002002732796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468826474
  error estimate for blocks of size 2^( 2) =       0.000492806204
  error estimate for blocks of size 2^( 3) =       0.000514867594
  error estimate for blocks of size 2^( 4) =       0.000530561955
  error estimate for blocks of size 2^( 5) =       0.000540550812
  error estimate for blocks of size 2^( 6) =       0.000546446324
  error estimate for blocks of size 2^( 7) =       0.000548107016

      target function =      -0.745990171592
              le_mean =     -22.662425698455
             les_mean =     514.034741006349
             stat err =       0.000541416527
             autocorr =       1.333640460414
   target nu stat err =       0.000541416527
   target dn stat err =       0.002421945212
      target stat err =       0.002083170112
              std dev =       0.663020757262
             le_variance =       0.439596524560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266242569846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745995027757       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745995027757       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745995027757       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745995025741       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745995027757       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745995027757       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745995093956       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745995071821       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745995027757       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745995447998       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745995404768       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+08 is 9.131640e-13

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745995027757       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745995027757       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745995027757       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745995027757       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745995290415       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745995106374       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745994809022       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745994343309       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745995967203       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745995662027       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745994503750       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+08 is 2.282985e-13

solving harmonic davidson linear method for identity shift 3.5527e+09, overlap shift 3.5527e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745995027757       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745995027757       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745995027757       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745993341235       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745993658103       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745994186495       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745995027757       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745998678162       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745994895660       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745993682495       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745995027757       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.5527e+09 is 5.705479e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.012979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0554e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521047e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -22.6761
    reference variance = 0.431449
====================================================
  Execution time = 2.5143e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5313e-01
  Total weights = 1.9554e+06
  Execution time = 3.6225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442788460760
                                         uncertainty =       0.002591091999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442788460760
                                         uncertainty =       0.002591091999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470504488
  error estimate for blocks of size 2^( 2) =       0.000494012960
  error estimate for blocks of size 2^( 3) =       0.000515514324
  error estimate for blocks of size 2^( 4) =       0.000531343013
  error estimate for blocks of size 2^( 5) =       0.000541038220
  error estimate for blocks of size 2^( 6) =       0.000547455720
  error estimate for blocks of size 2^( 7) =       0.000552356371

      target function =      -0.742755272942
              le_mean =     -22.661848825730
             les_mean =     514.012518621743
             stat err =       0.000543048331
             autocorr =       1.332138637399
   target nu stat err =       0.000543048331
   target dn stat err =       0.004584735607
      target stat err =       0.003788934525
              std dev =       0.665393828619
             le_variance =       0.442748947164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442788460759
                                         uncertainty =       0.002591091999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442788460759
                                         uncertainty =       0.002591091999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470504488
  error estimate for blocks of size 2^( 2) =       0.000494012960
  error estimate for blocks of size 2^( 3) =       0.000515514324
  error estimate for blocks of size 2^( 4) =       0.000531343013
  error estimate for blocks of size 2^( 5) =       0.000541038220
  error estimate for blocks of size 2^( 6) =       0.000547455720
  error estimate for blocks of size 2^( 7) =       0.000552356371

      target function =      -0.742755272942
              le_mean =     -22.661848825730
             les_mean =     514.012518621743
             stat err =       0.000543048331
             autocorr =       1.332138637404
   target nu stat err =       0.000543048331
   target dn stat err =       0.004584735607
      target stat err =       0.003788934525
              std dev =       0.665393828619
             le_variance =       0.442748947164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442788460760
                                         uncertainty =       0.002591091999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442788460760
                                         uncertainty =       0.002591091999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470504488
  error estimate for blocks of size 2^( 2) =       0.000494012960
  error estimate for blocks of size 2^( 3) =       0.000515514324
  error estimate for blocks of size 2^( 4) =       0.000531343013
  error estimate for blocks of size 2^( 5) =       0.000541038220
  error estimate for blocks of size 2^( 6) =       0.000547455720
  error estimate for blocks of size 2^( 7) =       0.000552356371

      target function =      -0.742755272942
              le_mean =     -22.661848825730
             les_mean =     514.012518621743
             stat err =       0.000543048331
             autocorr =       1.332138637393
   target nu stat err =       0.000543048331
   target dn stat err =       0.004584735607
      target stat err =       0.003788934525
              std dev =       0.665393828619
             le_variance =       0.442748947164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442788460760
                                         uncertainty =       0.002591091999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442788460760
                                         uncertainty =       0.002591091999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470504488
  error estimate for blocks of size 2^( 2) =       0.000494012960
  error estimate for blocks of size 2^( 3) =       0.000515514324
  error estimate for blocks of size 2^( 4) =       0.000531343013
  error estimate for blocks of size 2^( 5) =       0.000541038220
  error estimate for blocks of size 2^( 6) =       0.000547455720
  error estimate for blocks of size 2^( 7) =       0.000552356371

      target function =      -0.742755272942
              le_mean =     -22.661848825730
             les_mean =     514.012518621743
             stat err =       0.000543048331
             autocorr =       1.332138637395
   target nu stat err =       0.000543048331
   target dn stat err =       0.004584735607
      target stat err =       0.003788934525
              std dev =       0.665393828619
             le_variance =       0.442748947164


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742755272942        initial
     2.2204e+08     2.2204e+09             9.1316e-13        -0.742755272942  <--
     8.8818e+08     8.8818e+09             2.2830e-13        -0.742755272942
     3.5527e+09     3.5527e+10             5.7055e-14        -0.742755272942

*****************************************************************************
Applying the update for shift_i =   2.2204e+08     and shift_s =   2.2204e+09
*****************************************************************************

  Execution time = 4.3290e+01
  </log>
  <optVariables href="FORM2.s065.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7154
    reference variance = 0.724557
====================================================
  Execution time = 2.5881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5224e-01
  Total weights = 1.955412614e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443715997597
                                         uncertainty =       0.002419529571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443715997597
                                         uncertainty =       0.002419529571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471002300
  error estimate for blocks of size 2^( 2) =       0.000494609787
  error estimate for blocks of size 2^( 3) =       0.000515900740
  error estimate for blocks of size 2^( 4) =       0.000532302581
  error estimate for blocks of size 2^( 5) =       0.000541758506
  error estimate for blocks of size 2^( 6) =       0.000547487598
  error estimate for blocks of size 2^( 7) =       0.000550825220

      target function =      -0.743487591220
              le_mean =     -22.661346991786
             les_mean =     513.988886727016
             stat err =       0.000543093476
             autocorr =       1.329545233194
   target nu stat err =       0.000543093476
   target dn stat err =       0.002981967656
      target stat err =       0.002508616403
              std dev =       0.666097839892
             le_variance =       0.443686332309


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266134699179e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+07, overlap shift 5.5511e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743495170420       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743495170421       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743495170421       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743495170421       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743495170421       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743495169156       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743495249627       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743495184900       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743495170421       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743495170421       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743495176953       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+07 is 4.518010e-12

solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743495170420       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743495170421       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743495170421       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743495170421       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743494976010       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743495007147       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743494876195       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743495050777       residual = 7.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743495170421       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743495617954       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743494554339       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+08 is 1.129378e-12

solving harmonic davidson linear method for identity shift 8.8818e+08, overlap shift 8.8818e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743495170420       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743495170420       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743495170420       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743495170420       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743495170420       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743495170420       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743495170420       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743496115749       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743495170420       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743493152354       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743496591126       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.8818e+08 is 2.822873e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.017129 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0657e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -22.7031
    reference variance = 0.74066
====================================================
  Execution time = 2.5084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5220e-01
  Total weights = 1.9551e+06
  Execution time = 3.6187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443597339631
                                         uncertainty =       0.002742836689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443597339631
                                         uncertainty =       0.002742836689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470985075
  error estimate for blocks of size 2^( 2) =       0.000494957757
  error estimate for blocks of size 2^( 3) =       0.000517094603
  error estimate for blocks of size 2^( 4) =       0.000532649519
  error estimate for blocks of size 2^( 5) =       0.000541219203
  error estimate for blocks of size 2^( 6) =       0.000546777078
  error estimate for blocks of size 2^( 7) =       0.000551542994

      target function =      -0.743520020289
              le_mean =     -22.661397197703
             les_mean =     513.991119883553
             stat err =       0.000543047198
             autocorr =       1.329415888850
   target nu stat err =       0.000543047198
   target dn stat err =       0.003402185622
      target stat err =       0.002843743977
              std dev =       0.666073480583
             le_variance =       0.443653881536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443597339630
                                         uncertainty =       0.002742836689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443597339630
                                         uncertainty =       0.002742836689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470985075
  error estimate for blocks of size 2^( 2) =       0.000494957757
  error estimate for blocks of size 2^( 3) =       0.000517094603
  error estimate for blocks of size 2^( 4) =       0.000532649519
  error estimate for blocks of size 2^( 5) =       0.000541219203
  error estimate for blocks of size 2^( 6) =       0.000546777078
  error estimate for blocks of size 2^( 7) =       0.000551542994

      target function =      -0.743520020290
              le_mean =     -22.661397197703
             les_mean =     513.991119883552
             stat err =       0.000543047198
             autocorr =       1.329415888852
   target nu stat err =       0.000543047198
   target dn stat err =       0.003402185622
      target stat err =       0.002843743977
              std dev =       0.666073480582
             le_variance =       0.443653881535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443597339630
                                         uncertainty =       0.002742836689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443597339630
                                         uncertainty =       0.002742836689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470985075
  error estimate for blocks of size 2^( 2) =       0.000494957757
  error estimate for blocks of size 2^( 3) =       0.000517094603
  error estimate for blocks of size 2^( 4) =       0.000532649519
  error estimate for blocks of size 2^( 5) =       0.000541219203
  error estimate for blocks of size 2^( 6) =       0.000546777078
  error estimate for blocks of size 2^( 7) =       0.000551542994

      target function =      -0.743520020290
              le_mean =     -22.661397197703
             les_mean =     513.991119883553
             stat err =       0.000543047198
             autocorr =       1.329415888855
   target nu stat err =       0.000543047198
   target dn stat err =       0.003402185622
      target stat err =       0.002843743977
              std dev =       0.666073480583
             le_variance =       0.443653881536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443597339631
                                         uncertainty =       0.002742836689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443597339631
                                         uncertainty =       0.002742836689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470985075
  error estimate for blocks of size 2^( 2) =       0.000494957757
  error estimate for blocks of size 2^( 3) =       0.000517094603
  error estimate for blocks of size 2^( 4) =       0.000532649519
  error estimate for blocks of size 2^( 5) =       0.000541219203
  error estimate for blocks of size 2^( 6) =       0.000546777078
  error estimate for blocks of size 2^( 7) =       0.000551542994

      target function =      -0.743520020289
              le_mean =     -22.661397197703
             les_mean =     513.991119883553
             stat err =       0.000543047198
             autocorr =       1.329415888852
   target nu stat err =       0.000543047198
   target dn stat err =       0.003402185622
      target stat err =       0.002843743977
              std dev =       0.666073480583
             le_variance =       0.443653881536


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743520020289        initial
     5.5511e+07     5.5511e+08             4.5180e-12        -0.743520020290  <--
     2.2204e+08     2.2204e+09             1.1294e-12        -0.743520020290
     8.8818e+08     8.8818e+09             2.8229e-13        -0.743520020289

*****************************************************************************
Applying the update for shift_i =   5.5511e+07     and shift_s =   5.5511e+08
*****************************************************************************

  Execution time = 4.3307e+01
  </log>
  <optVariables href="FORM2.s066.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3970e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.549
    reference variance = 0.434768
====================================================
  Execution time = 2.7956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4522e-01
  Total weights = 1.955307335e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436283232498
                                         uncertainty =       0.001846874428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436283232498
                                         uncertainty =       0.001846874428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467058640
  error estimate for blocks of size 2^( 2) =       0.000491472379
  error estimate for blocks of size 2^( 3) =       0.000513563248
  error estimate for blocks of size 2^( 4) =       0.000529212431
  error estimate for blocks of size 2^( 5) =       0.000537631882
  error estimate for blocks of size 2^( 6) =       0.000541597185
  error estimate for blocks of size 2^( 7) =       0.000544547265

      target function =      -0.749281039147
              le_mean =     -22.661805955835
             les_mean =     514.002664594891
             stat err =       0.000538247191
             autocorr =       1.328069254716
   target nu stat err =       0.000538247191
   target dn stat err =       0.002407876834
      target stat err =       0.002086705543
              std dev =       0.660520662897
             le_variance =       0.436287546114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266180595583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+07, overlap shift 1.3878e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749285916463       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749285916464       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749285916464       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749285916464       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749285916733       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749285907646       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749285880435       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749285926548       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749285903101       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+07 is 1.216135e-11

solving harmonic davidson linear method for identity shift 5.5511e+07, overlap shift 5.5511e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749285916463       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749285916464       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749285916464       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749285916464       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749285916464       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749285946523       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749285953880       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749285943069       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749285901234       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+07 is 3.040346e-12

solving harmonic davidson linear method for identity shift 2.2204e+08, overlap shift 2.2204e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749285916463       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749285916463       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749285916463       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749285916463       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749285860865       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749285780632       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749286251867       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749286136408       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749285456735       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.2204e+08 is 7.600710e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.020285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2677e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -22.5533
    reference variance = 0.338421
====================================================
  Execution time = 2.5468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5190e-01
  Total weights = 1.9551e+06
  Execution time = 3.6140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948547984
                                         uncertainty =       0.002432224343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948547984
                                         uncertainty =       0.002432224343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470051925
  error estimate for blocks of size 2^( 2) =       0.000493951608
  error estimate for blocks of size 2^( 3) =       0.000515548166
  error estimate for blocks of size 2^( 4) =       0.000531160282
  error estimate for blocks of size 2^( 5) =       0.000541128766
  error estimate for blocks of size 2^( 6) =       0.000544221706
  error estimate for blocks of size 2^( 7) =       0.000545686022

      target function =      -0.743777187945
              le_mean =     -22.663385789084
             les_mean =     514.080952463657
             stat err =       0.000540549194
             autocorr =       1.322448525755
   target nu stat err =       0.000540549194
   target dn stat err =       0.003145003124
      target stat err =       0.002647552258
              std dev =       0.664753807759
             le_variance =       0.441897624930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948547981
                                         uncertainty =       0.002432224343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948547981
                                         uncertainty =       0.002432224343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470051925
  error estimate for blocks of size 2^( 2) =       0.000493951608
  error estimate for blocks of size 2^( 3) =       0.000515548166
  error estimate for blocks of size 2^( 4) =       0.000531160282
  error estimate for blocks of size 2^( 5) =       0.000541128766
  error estimate for blocks of size 2^( 6) =       0.000544221706
  error estimate for blocks of size 2^( 7) =       0.000545686022

      target function =      -0.743777187949
              le_mean =     -22.663385789084
             les_mean =     514.080952463648
             stat err =       0.000540549194
             autocorr =       1.322448525764
   target nu stat err =       0.000540549194
   target dn stat err =       0.003145003124
      target stat err =       0.002647552257
              std dev =       0.664753807756
             le_variance =       0.441897624927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948547983
                                         uncertainty =       0.002432224343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948547983
                                         uncertainty =       0.002432224343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470051925
  error estimate for blocks of size 2^( 2) =       0.000493951608
  error estimate for blocks of size 2^( 3) =       0.000515548166
  error estimate for blocks of size 2^( 4) =       0.000531160282
  error estimate for blocks of size 2^( 5) =       0.000541128766
  error estimate for blocks of size 2^( 6) =       0.000544221706
  error estimate for blocks of size 2^( 7) =       0.000545686022

      target function =      -0.743777187947
              le_mean =     -22.663385789084
             les_mean =     514.080952463652
             stat err =       0.000540549194
             autocorr =       1.322448525763
   target nu stat err =       0.000540549194
   target dn stat err =       0.003145003124
      target stat err =       0.002647552258
              std dev =       0.664753807758
             le_variance =       0.441897624928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948547984
                                         uncertainty =       0.002432224343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441948547984
                                         uncertainty =       0.002432224343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470051925
  error estimate for blocks of size 2^( 2) =       0.000493951608
  error estimate for blocks of size 2^( 3) =       0.000515548166
  error estimate for blocks of size 2^( 4) =       0.000531160282
  error estimate for blocks of size 2^( 5) =       0.000541128766
  error estimate for blocks of size 2^( 6) =       0.000544221706
  error estimate for blocks of size 2^( 7) =       0.000545686022

      target function =      -0.743777187945
              le_mean =     -22.663385789084
             les_mean =     514.080952463657
             stat err =       0.000540549194
             autocorr =       1.322448525760
   target nu stat err =       0.000540549194
   target dn stat err =       0.003145003124
      target stat err =       0.002647552258
              std dev =       0.664753807759
             le_variance =       0.441897624930


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743777187945        initial
     1.3878e+07     1.3878e+08             1.2161e-11        -0.743777187949  <--
     5.5511e+07     5.5511e+08             3.0403e-12        -0.743777187947
     2.2204e+08     2.2204e+09             7.6007e-13        -0.743777187945

*****************************************************************************
Applying the update for shift_i =   1.3878e+07     and shift_s =   1.3878e+08
*****************************************************************************

  Execution time = 4.3622e+01
  </log>
  <optVariables href="FORM2.s067.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6305e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.6125
    reference variance = 0.906616
====================================================
  Execution time = 2.5853e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5399e-01
  Total weights = 1.954916723e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441480232092
                                         uncertainty =       0.002159470438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441480232092
                                         uncertainty =       0.002159470438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469918287
  error estimate for blocks of size 2^( 2) =       0.000493781925
  error estimate for blocks of size 2^( 3) =       0.000516015738
  error estimate for blocks of size 2^( 4) =       0.000530996808
  error estimate for blocks of size 2^( 5) =       0.000540331708
  error estimate for blocks of size 2^( 6) =       0.000545915516
  error estimate for blocks of size 2^( 7) =       0.000547588493

      target function =      -0.742065417723
              le_mean =     -22.661896276328
             les_mean =     514.015529148327
             stat err =       0.000541208131
             autocorr =       1.326428771877
   target nu stat err =       0.000541208131
   target dn stat err =       0.002917412277
      target stat err =       0.002449784801
              std dev =       0.664564814299
             le_variance =       0.441646392404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266189627633e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+06, overlap shift 3.4694e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742072544867       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742072544872       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742072544874       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742072544874       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742072544874       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742072545811       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742072542319       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742072541578       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742072536314       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742072539065       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742072545981       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+06 is 6.075641e-11

solving harmonic davidson linear method for identity shift 1.3878e+07, overlap shift 1.3878e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742072544867       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742072544868       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742072544868       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742072544907       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742072544868       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742072544868       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742072544868       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742072569788       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742072544868       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742072537894       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742072513179       residual = 9.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+07 is 1.518913e-11

solving harmonic davidson linear method for identity shift 5.5511e+07, overlap shift 5.5511e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742072544867       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742072544867       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742072544867       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742072544867       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742072542956       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742072545530       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742072489593       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742072551116       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742072656012       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742072556964       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742072708604       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+07 is 3.797328e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.024409 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0577e+01
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -22.7885
    reference variance = 0.52199
====================================================
  Execution time = 2.5398e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5627e-01
  Total weights = 1.9555e+06
  Execution time = 3.6322e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443320103443
                                         uncertainty =       0.003505794133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443320103443
                                         uncertainty =       0.003505794133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470792696
  error estimate for blocks of size 2^( 2) =       0.000494829167
  error estimate for blocks of size 2^( 3) =       0.000516651750
  error estimate for blocks of size 2^( 4) =       0.000532161810
  error estimate for blocks of size 2^( 5) =       0.000541630681
  error estimate for blocks of size 2^( 6) =       0.000544691277
  error estimate for blocks of size 2^( 7) =       0.000545684399

      target function =      -0.740199497483
              le_mean =     -22.662622310990
             les_mean =     514.050723106311
             stat err =       0.000541042042
             autocorr =       1.320695184521
   target nu stat err =       0.000541042042
   target dn stat err =       0.004180603387
      target stat err =       0.003443726397
              std dev =       0.665801415181
             le_variance =       0.443291524457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443320103428
                                         uncertainty =       0.003505794133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443320103428
                                         uncertainty =       0.003505794133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470792696
  error estimate for blocks of size 2^( 2) =       0.000494829167
  error estimate for blocks of size 2^( 3) =       0.000516651750
  error estimate for blocks of size 2^( 4) =       0.000532161810
  error estimate for blocks of size 2^( 5) =       0.000541630681
  error estimate for blocks of size 2^( 6) =       0.000544691277
  error estimate for blocks of size 2^( 7) =       0.000545684399

      target function =      -0.740199497482
              le_mean =     -22.662622310990
             les_mean =     514.050723106310
             stat err =       0.000541042042
             autocorr =       1.320695184561
   target nu stat err =       0.000541042042
   target dn stat err =       0.004180603399
      target stat err =       0.003443726407
              std dev =       0.665801415170
             le_variance =       0.443291524443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443320103436
                                         uncertainty =       0.003505794133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443320103436
                                         uncertainty =       0.003505794133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470792696
  error estimate for blocks of size 2^( 2) =       0.000494829167
  error estimate for blocks of size 2^( 3) =       0.000516651750
  error estimate for blocks of size 2^( 4) =       0.000532161810
  error estimate for blocks of size 2^( 5) =       0.000541630681
  error estimate for blocks of size 2^( 6) =       0.000544691277
  error estimate for blocks of size 2^( 7) =       0.000545684399

      target function =      -0.740199497482
              le_mean =     -22.662622310990
             les_mean =     514.050723106311
             stat err =       0.000541042042
             autocorr =       1.320695184536
   target nu stat err =       0.000541042042
   target dn stat err =       0.004180603393
      target stat err =       0.003443726402
              std dev =       0.665801415176
             le_variance =       0.443291524450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443320103442
                                         uncertainty =       0.003505794133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443320103442
                                         uncertainty =       0.003505794133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470792696
  error estimate for blocks of size 2^( 2) =       0.000494829167
  error estimate for blocks of size 2^( 3) =       0.000516651750
  error estimate for blocks of size 2^( 4) =       0.000532161810
  error estimate for blocks of size 2^( 5) =       0.000541630681
  error estimate for blocks of size 2^( 6) =       0.000544691277
  error estimate for blocks of size 2^( 7) =       0.000545684399

      target function =      -0.740199497483
              le_mean =     -22.662622310990
             les_mean =     514.050723106311
             stat err =       0.000541042042
             autocorr =       1.320695184527
   target nu stat err =       0.000541042042
   target dn stat err =       0.004180603388
      target stat err =       0.003443726398
              std dev =       0.665801415181
             le_variance =       0.443291524456


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.740199497483        initial  <--
     3.4694e+06     3.4694e+07             6.0756e-11        -0.740199497482
     1.3878e+07     1.3878e+08             1.5189e-11        -0.740199497482
     5.5511e+07     5.5511e+08             3.7973e-12        -0.740199497483

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6151
  </log>
  <optVariables href="FORM2.s068.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.5426
    reference variance = 0.321449
====================================================
  Execution time = 2.5993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5767e-01
  Total weights = 1.955239320e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7558e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445440873718
                                         uncertainty =       0.002425275239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.445440873718
                                         uncertainty =       0.002425275239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472257566
  error estimate for blocks of size 2^( 2) =       0.000496372166
  error estimate for blocks of size 2^( 3) =       0.000518006389
  error estimate for blocks of size 2^( 4) =       0.000534186414
  error estimate for blocks of size 2^( 5) =       0.000543739666
  error estimate for blocks of size 2^( 6) =       0.000546357737
  error estimate for blocks of size 2^( 7) =       0.000551275593

      target function =      -0.739069839659
              le_mean =     -22.662201310988
             les_mean =     514.033043199637
             stat err =       0.000543889852
             autocorr =       1.326368084723
   target nu stat err =       0.000543889852
   target dn stat err =       0.003343727169
      target stat err =       0.002767915838
              std dev =       0.667873054663
             le_variance =       0.446054417145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266220131099e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739079372416       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739079372417       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739079372418       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739079372533       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739079372418       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739079381567       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739079438523       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739079322080       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739079351826       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739079393169       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739079383553       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739079291148       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+07 is 1.316748e-11

solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739079372416       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739079372417       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739079372417       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739079372417       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739079372417       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739079380033       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739079623946       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739079451852       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739079661533       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739079695341       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739079305460       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739079693064       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+08 is 3.291909e-12

solving harmonic davidson linear method for identity shift 5.5511e+08, overlap shift 5.5511e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739079372416       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739079372417       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739079372417       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739079372417       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739079373427       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739079134565       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739078619101       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739078986898       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739078468701       residual = 6.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739079957188       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739077611472       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739079645768       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.5511e+08 is 8.229632e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.029176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0762e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -22.6148
    reference variance = 0.534345
====================================================
  Execution time = 2.5347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4794e-01
  Total weights = 1.9550e+06
  Execution time = 3.6336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438283923869
                                         uncertainty =       0.001971976670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438283923869
                                         uncertainty =       0.001971976670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468125455
  error estimate for blocks of size 2^( 2) =       0.000492593154
  error estimate for blocks of size 2^( 3) =       0.000514599060
  error estimate for blocks of size 2^( 4) =       0.000530999275
  error estimate for blocks of size 2^( 5) =       0.000541499646
  error estimate for blocks of size 2^( 6) =       0.000544496935
  error estimate for blocks of size 2^( 7) =       0.000546266424

      target function =      -0.747034406762
              le_mean =     -22.662618574427
             les_mean =     514.042219048716
             stat err =       0.000540815570
             autocorr =       1.334669875864
   target nu stat err =       0.000540815570
   target dn stat err =       0.002556955573
      target stat err =       0.002196314203
              std dev =       0.662029366962
             le_variance =       0.438282882721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438283923867
                                         uncertainty =       0.001971976670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438283923867
                                         uncertainty =       0.001971976670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468125455
  error estimate for blocks of size 2^( 2) =       0.000492593154
  error estimate for blocks of size 2^( 3) =       0.000514599060
  error estimate for blocks of size 2^( 4) =       0.000530999275
  error estimate for blocks of size 2^( 5) =       0.000541499646
  error estimate for blocks of size 2^( 6) =       0.000544496935
  error estimate for blocks of size 2^( 7) =       0.000546266424

      target function =      -0.747034406767
              le_mean =     -22.662618574427
             les_mean =     514.042219048713
             stat err =       0.000540815570
             autocorr =       1.334669875853
   target nu stat err =       0.000540815570
   target dn stat err =       0.002556955572
      target stat err =       0.002196314202
              std dev =       0.662029366961
             le_variance =       0.438282882719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438283923868
                                         uncertainty =       0.001971976670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438283923868
                                         uncertainty =       0.001971976670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468125455
  error estimate for blocks of size 2^( 2) =       0.000492593154
  error estimate for blocks of size 2^( 3) =       0.000514599060
  error estimate for blocks of size 2^( 4) =       0.000530999275
  error estimate for blocks of size 2^( 5) =       0.000541499646
  error estimate for blocks of size 2^( 6) =       0.000544496935
  error estimate for blocks of size 2^( 7) =       0.000546266424

      target function =      -0.747034406765
              le_mean =     -22.662618574427
             les_mean =     514.042219048715
             stat err =       0.000540815570
             autocorr =       1.334669875855
   target nu stat err =       0.000540815570
   target dn stat err =       0.002556955572
      target stat err =       0.002196314202
              std dev =       0.662029366962
             le_variance =       0.438282882720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438283923869
                                         uncertainty =       0.001971976670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438283923869
                                         uncertainty =       0.001971976670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468125455
  error estimate for blocks of size 2^( 2) =       0.000492593154
  error estimate for blocks of size 2^( 3) =       0.000514599060
  error estimate for blocks of size 2^( 4) =       0.000530999275
  error estimate for blocks of size 2^( 5) =       0.000541499646
  error estimate for blocks of size 2^( 6) =       0.000544496935
  error estimate for blocks of size 2^( 7) =       0.000546266424

      target function =      -0.747034406763
              le_mean =     -22.662618574427
             les_mean =     514.042219048716
             stat err =       0.000540815570
             autocorr =       1.334669875860
   target nu stat err =       0.000540815570
   target dn stat err =       0.002556955573
      target stat err =       0.002196314203
              std dev =       0.662029366962
             le_variance =       0.438282882720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747034406762        initial
     3.4694e+07     3.4694e+08             1.3167e-11        -0.747034406767  <--
     1.3878e+08     1.3878e+09             3.2919e-12        -0.747034406765
     5.5511e+08     5.5511e+09             8.2296e-13        -0.747034406763

*****************************************************************************
Applying the update for shift_i =   3.4694e+07     and shift_s =   3.4694e+08
*****************************************************************************

  Execution time = 4.3560e+01
  </log>
  <optVariables href="FORM2.s069.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4328e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.6121
    reference variance = 0.417693
====================================================
  Execution time = 2.5894e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5007e-01
  Total weights = 1.955089785e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.6930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440246905229
                                         uncertainty =       0.002032121611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440246905229
                                         uncertainty =       0.002032121611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469261510
  error estimate for blocks of size 2^( 2) =       0.000493024298
  error estimate for blocks of size 2^( 3) =       0.000514727431
  error estimate for blocks of size 2^( 4) =       0.000530098035
  error estimate for blocks of size 2^( 5) =       0.000539575030
  error estimate for blocks of size 2^( 6) =       0.000543822153
  error estimate for blocks of size 2^( 7) =       0.000547373576

      target function =      -0.745273267484
              le_mean =     -22.662345797619
             les_mean =     514.031989471699
             stat err =       0.000540217198
             autocorr =       1.325277869793
   target nu stat err =       0.000540217198
   target dn stat err =       0.002486516078
      target stat err =       0.002129626181
              std dev =       0.663635991138
             le_variance =       0.440412728734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266234579762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+06, overlap shift 8.6736e+07 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745278333611       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745278333615       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745278333616       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745278333616       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745278335214       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745278333616       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745278334670       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745278335069       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745278332576       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745278333616       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745278343924       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745278318052       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+06 is 2.509563e-11

solving harmonic davidson linear method for identity shift 3.4694e+07, overlap shift 3.4694e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745278333611       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745278333612       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745278333613       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745278333613       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745278328779       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745278333613       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745278257221       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745278304805       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745278338337       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745278265807       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745278333613       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745278341098       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+07 is 6.273871e-12

solving harmonic davidson linear method for identity shift 1.3878e+08, overlap shift 1.3878e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745278333611       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745278333612       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745278333612       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745278333612       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745278333612       residual = 7.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745278333612       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745278333612       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745278333612       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745278333612       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745278333612       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745278333612       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745278731882       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+08 is 1.568464e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.034000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0597e+01
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -22.6477
    reference variance = 0.555614
====================================================
  Execution time = 2.5184e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4674e-01
  Total weights = 1.9555e+06
  Execution time = 3.6380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438330691107
                                         uncertainty =       0.001926274206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438330691107
                                         uncertainty =       0.001926274206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468173727
  error estimate for blocks of size 2^( 2) =       0.000492087946
  error estimate for blocks of size 2^( 3) =       0.000514651983
  error estimate for blocks of size 2^( 4) =       0.000529987944
  error estimate for blocks of size 2^( 5) =       0.000538673117
  error estimate for blocks of size 2^( 6) =       0.000542148198
  error estimate for blocks of size 2^( 7) =       0.000542415742

      target function =      -0.748010094679
              le_mean =     -22.661069110541
             les_mean =     513.970789198743
             stat err =       0.000538306250
             autocorr =       1.322040527123
   target nu stat err =       0.000538306250
   target dn stat err =       0.002554095660
      target stat err =       0.002193772077
              std dev =       0.662097634196
             le_variance =       0.438373277208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438330691101
                                         uncertainty =       0.001926274205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438330691101
                                         uncertainty =       0.001926274205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468173727
  error estimate for blocks of size 2^( 2) =       0.000492087946
  error estimate for blocks of size 2^( 3) =       0.000514651983
  error estimate for blocks of size 2^( 4) =       0.000529987944
  error estimate for blocks of size 2^( 5) =       0.000538673117
  error estimate for blocks of size 2^( 6) =       0.000542148198
  error estimate for blocks of size 2^( 7) =       0.000542415742

      target function =      -0.748010094596
              le_mean =     -22.661069110541
             les_mean =     513.970789198840
             stat err =       0.000538306250
             autocorr =       1.322040527136
   target nu stat err =       0.000538306250
   target dn stat err =       0.002554095656
      target stat err =       0.002193772073
              std dev =       0.662097634192
             le_variance =       0.438373277202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438330691104
                                         uncertainty =       0.001926274205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438330691104
                                         uncertainty =       0.001926274205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468173727
  error estimate for blocks of size 2^( 2) =       0.000492087946
  error estimate for blocks of size 2^( 3) =       0.000514651983
  error estimate for blocks of size 2^( 4) =       0.000529987944
  error estimate for blocks of size 2^( 5) =       0.000538673117
  error estimate for blocks of size 2^( 6) =       0.000542148198
  error estimate for blocks of size 2^( 7) =       0.000542415742

      target function =      -0.748010094638
              le_mean =     -22.661069110541
             les_mean =     513.970789198792
             stat err =       0.000538306250
             autocorr =       1.322040527138
   target nu stat err =       0.000538306250
   target dn stat err =       0.002554095658
      target stat err =       0.002193772075
              std dev =       0.662097634194
             le_variance =       0.438373277205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438330691107
                                         uncertainty =       0.001926274206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438330691107
                                         uncertainty =       0.001926274206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468173727
  error estimate for blocks of size 2^( 2) =       0.000492087946
  error estimate for blocks of size 2^( 3) =       0.000514651983
  error estimate for blocks of size 2^( 4) =       0.000529987944
  error estimate for blocks of size 2^( 5) =       0.000538673117
  error estimate for blocks of size 2^( 6) =       0.000542148198
  error estimate for blocks of size 2^( 7) =       0.000542415742

      target function =      -0.748010094674
              le_mean =     -22.661069110541
             les_mean =     513.970789198750
             stat err =       0.000538306250
             autocorr =       1.322040527127
   target nu stat err =       0.000538306250
   target dn stat err =       0.002554095660
      target stat err =       0.002193772077
              std dev =       0.662097634196
             le_variance =       0.438373277208


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748010094679        initial  <--
     8.6736e+06     8.6736e+07             2.5096e-11        -0.748010094596
     3.4694e+07     3.4694e+08             6.2739e-12        -0.748010094638
     1.3878e+08     1.3878e+09             1.5685e-12        -0.748010094674

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4410
  </log>
  <optVariables href="FORM2.s070.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4057e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.5855
    reference variance = 0.307918
====================================================
  Execution time = 2.7711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4999e-01
  Total weights = 1.955247130e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438930834037
                                         uncertainty =       0.002496411112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438930834037
                                         uncertainty =       0.002496411112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468518180
  error estimate for blocks of size 2^( 2) =       0.000492840770
  error estimate for blocks of size 2^( 3) =       0.000515323807
  error estimate for blocks of size 2^( 4) =       0.000530710483
  error estimate for blocks of size 2^( 5) =       0.000540132119
  error estimate for blocks of size 2^( 6) =       0.000544521776
  error estimate for blocks of size 2^( 7) =       0.000547964468

      target function =      -0.745333632647
              le_mean =     -22.662004960855
             les_mean =     514.016454220691
             stat err =       0.000540832212
             autocorr =       1.332515300150
   target nu stat err =       0.000540832212
   target dn stat err =       0.003936179890
      target stat err =       0.003289947903
              std dev =       0.662584764907
             le_variance =       0.439018570688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266200496085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+07, overlap shift 8.6736e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745347192486       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745347192486       residual = 6.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745347192486       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745347219449       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745347194149       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745347184516       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745347207957       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745347136749       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745347374768       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745347192486       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745347192486       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745347192486       residual = 1.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+07 is 4.322573e-12

solving harmonic davidson linear method for identity shift 3.4694e+08, overlap shift 3.4694e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745347192486       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745347192486       residual = 6.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745347192486       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745347192486       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745347231747       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745347192486       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745347830415       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745348010633       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745346637710       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745347632934       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745347192486       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745346473334       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+08 is 1.080649e-12

solving harmonic davidson linear method for identity shift 1.3878e+09, overlap shift 1.3878e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745347192486       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745347192486       residual = 6.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745347192486       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745347192486       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745346303237       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745347192486       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745347192486       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745347192486       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745347192486       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745347192486       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745348821127       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745348423436       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+09 is 2.700873e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.038848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2431e+01
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -22.7018
    reference variance = 0.4327
====================================================
  Execution time = 2.5424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4987e-01
  Total weights = 1.9550e+06
  Execution time = 3.6180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440757158103
                                         uncertainty =       0.002084764128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440757158103
                                         uncertainty =       0.002084764128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469431903
  error estimate for blocks of size 2^( 2) =       0.000493643751
  error estimate for blocks of size 2^( 3) =       0.000515574590
  error estimate for blocks of size 2^( 4) =       0.000531744217
  error estimate for blocks of size 2^( 5) =       0.000540543135
  error estimate for blocks of size 2^( 6) =       0.000546457651
  error estimate for blocks of size 2^( 7) =       0.000549629949

      target function =      -0.745436387958
              le_mean =     -22.661519669017
             les_mean =     513.994339254051
             stat err =       0.000542093738
             autocorr =       1.333532417813
   target nu stat err =       0.000542093738
   target dn stat err =       0.002474751069
      target stat err =       0.002119223453
              std dev =       0.663876964112
             le_variance =       0.440732623479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440757158103
                                         uncertainty =       0.002084764128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440757158103
                                         uncertainty =       0.002084764128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469431903
  error estimate for blocks of size 2^( 2) =       0.000493643751
  error estimate for blocks of size 2^( 3) =       0.000515574590
  error estimate for blocks of size 2^( 4) =       0.000531744217
  error estimate for blocks of size 2^( 5) =       0.000540543135
  error estimate for blocks of size 2^( 6) =       0.000546457651
  error estimate for blocks of size 2^( 7) =       0.000549629949

      target function =      -0.745436387955
              le_mean =     -22.661519669017
             les_mean =     513.994339254054
             stat err =       0.000542093738
             autocorr =       1.333532417811
   target nu stat err =       0.000542093738
   target dn stat err =       0.002474751069
      target stat err =       0.002119223453
              std dev =       0.663876964112
             le_variance =       0.440732623478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440757158103
                                         uncertainty =       0.002084764128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440757158103
                                         uncertainty =       0.002084764128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469431903
  error estimate for blocks of size 2^( 2) =       0.000493643751
  error estimate for blocks of size 2^( 3) =       0.000515574590
  error estimate for blocks of size 2^( 4) =       0.000531744217
  error estimate for blocks of size 2^( 5) =       0.000540543135
  error estimate for blocks of size 2^( 6) =       0.000546457651
  error estimate for blocks of size 2^( 7) =       0.000549629949

      target function =      -0.745436387957
              le_mean =     -22.661519669017
             les_mean =     513.994339254053
             stat err =       0.000542093738
             autocorr =       1.333532417819
   target nu stat err =       0.000542093738
   target dn stat err =       0.002474751069
      target stat err =       0.002119223453
              std dev =       0.663876964112
             le_variance =       0.440732623478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440757158103
                                         uncertainty =       0.002084764128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440757158103
                                         uncertainty =       0.002084764128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469431903
  error estimate for blocks of size 2^( 2) =       0.000493643751
  error estimate for blocks of size 2^( 3) =       0.000515574590
  error estimate for blocks of size 2^( 4) =       0.000531744217
  error estimate for blocks of size 2^( 5) =       0.000540543135
  error estimate for blocks of size 2^( 6) =       0.000546457651
  error estimate for blocks of size 2^( 7) =       0.000549629949

      target function =      -0.745436387958
              le_mean =     -22.661519669017
             les_mean =     513.994339254051
             stat err =       0.000542093738
             autocorr =       1.333532417813
   target nu stat err =       0.000542093738
   target dn stat err =       0.002474751069
      target stat err =       0.002119223453
              std dev =       0.663876964112
             le_variance =       0.440732623479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745436387958        initial  <--
     8.6736e+07     8.6736e+08             4.3226e-12        -0.745436387955
     3.4694e+08     3.4694e+09             1.0806e-12        -0.745436387957
     1.3878e+09     1.3878e+10             2.7009e-13        -0.745436387958

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5866
  </log>
  <optVariables href="FORM2.s071.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6024e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.6117
    reference variance = 0.297813
====================================================
  Execution time = 2.5913e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5262e-01
  Total weights = 1.955180924e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440890410896
                                         uncertainty =       0.002241777829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440890410896
                                         uncertainty =       0.002241777829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469626225
  error estimate for blocks of size 2^( 2) =       0.000493455561
  error estimate for blocks of size 2^( 3) =       0.000515523779
  error estimate for blocks of size 2^( 4) =       0.000531335331
  error estimate for blocks of size 2^( 5) =       0.000540330670
  error estimate for blocks of size 2^( 6) =       0.000544021481
  error estimate for blocks of size 2^( 7) =       0.000547490084

      target function =      -0.743174911299
              le_mean =     -22.661743611790
             les_mean =     514.007246209961
             stat err =       0.000540794392
             autocorr =       1.326049315570
   target nu stat err =       0.000540794392
   target dn stat err =       0.003298880153
      target stat err =       0.002759629985
              std dev =       0.664151777087
             le_variance =       0.441097583008


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266174361179e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+08, overlap shift 8.6736e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743184275796       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743184275796       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743184275796       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743184272667       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743184275796       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743184591890       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743184042524       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743184218674       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743184313707       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743187672902       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743183022798       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743182419328       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+08 is 3.070408e-13

solving harmonic davidson linear method for identity shift 3.4694e+09, overlap shift 3.4694e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743184275796       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743184275796       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743184275796       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743184275796       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743184275797       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743184237621       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743184275796       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743184450774       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743187166283       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743184166519       residual = 7.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743182772777       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743186342515       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+09 is 7.676300e-14

solving harmonic davidson linear method for identity shift 1.3878e+10, overlap shift 1.3878e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743184275796       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743184275796       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743184275796       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743184275796       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743184275792       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743186430214       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743172920903       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743185884551       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743154097154       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743175462311       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743199583163       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743196218207       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743168871521       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743201133334       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743156900113       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743170225402       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743170907155       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743149323608       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743143193500       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743168188127       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743183293234       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743229269109       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743205358479       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743165727396       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743112485572       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743178290354       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743134343617       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743073451755       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742959193992       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743152742993       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743209737007       residual = 9.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743343492605       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.744039833245       residual = 2.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.744773594570       residual = 9.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.741972301588       residual = 7.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.749683535249       residual = 6.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.736641693454       residual = 2.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.728174733942       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.819547954280       residual = 6.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.762553056784       residual = 3.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.187619154716       residual = 5.19e+03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -2.020962543319       residual = 3.37e+04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   tar_fn =      -1.404646587073       residual = 2.40e+04           smallest_sin_value = 9.99e-01
davidson iteration   43:   krylov dim =  44   tar_fn =       0.835983481402       residual = 7.55e+04           smallest_sin_value = 9.97e-01
davidson iteration   44:   krylov dim =  45   tar_fn =      -5.531847442454       residual = 9.31e+05           smallest_sin_value = 9.93e-01
davidson iteration   45 stopping due to too large eigenvalue change
davidson solver did not converge after         45 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3878e+10 is 1.915379e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.078291 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0677e+01
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -22.5543
    reference variance = 0.310728
====================================================
  Execution time = 2.5221e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5205e-01
  Total weights = 1.9554e+06
  Execution time = 3.6343e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441262246868
                                         uncertainty =       0.002060347077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441262246868
                                         uncertainty =       0.002060347077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469736763
  error estimate for blocks of size 2^( 2) =       0.000493678507
  error estimate for blocks of size 2^( 3) =       0.000516299102
  error estimate for blocks of size 2^( 4) =       0.000532552252
  error estimate for blocks of size 2^( 5) =       0.000541311003
  error estimate for blocks of size 2^( 6) =       0.000546838691
  error estimate for blocks of size 2^( 7) =       0.000550048856

      target function =      -0.743647696468
              le_mean =     -22.661586357176
             les_mean =     513.999541940666
             stat err =       0.000542687700
             autocorr =       1.334722116978
   target nu stat err =       0.000542687700
   target dn stat err =       0.002910137078
      target stat err =       0.002453431716
              std dev =       0.664308100351
             le_variance =       0.441305252192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441262246868
                                         uncertainty =       0.002060347077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441262246868
                                         uncertainty =       0.002060347077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469736763
  error estimate for blocks of size 2^( 2) =       0.000493678507
  error estimate for blocks of size 2^( 3) =       0.000516299102
  error estimate for blocks of size 2^( 4) =       0.000532552252
  error estimate for blocks of size 2^( 5) =       0.000541311003
  error estimate for blocks of size 2^( 6) =       0.000546838691
  error estimate for blocks of size 2^( 7) =       0.000550048856

      target function =      -0.743647696468
              le_mean =     -22.661586357176
             les_mean =     513.999541940666
             stat err =       0.000542687700
             autocorr =       1.334722116967
   target nu stat err =       0.000542687700
   target dn stat err =       0.002910137078
      target stat err =       0.002453431716
              std dev =       0.664308100351
             le_variance =       0.441305252192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441262246868
                                         uncertainty =       0.002060347077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441262246868
                                         uncertainty =       0.002060347077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469736763
  error estimate for blocks of size 2^( 2) =       0.000493678507
  error estimate for blocks of size 2^( 3) =       0.000516299102
  error estimate for blocks of size 2^( 4) =       0.000532552252
  error estimate for blocks of size 2^( 5) =       0.000541311003
  error estimate for blocks of size 2^( 6) =       0.000546838691
  error estimate for blocks of size 2^( 7) =       0.000550048856

      target function =      -0.743647696468
              le_mean =     -22.661586357177
             les_mean =     513.999541940666
             stat err =       0.000542687700
             autocorr =       1.334722116972
   target nu stat err =       0.000542687700
   target dn stat err =       0.002910137078
      target stat err =       0.002453431716
              std dev =       0.664308100351
             le_variance =       0.441305252192

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441262246868
                                         uncertainty =       0.002060347077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441262246868
                                         uncertainty =       0.002060347077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469736763
  error estimate for blocks of size 2^( 2) =       0.000493678507
  error estimate for blocks of size 2^( 3) =       0.000516299102
  error estimate for blocks of size 2^( 4) =       0.000532552252
  error estimate for blocks of size 2^( 5) =       0.000541311003
  error estimate for blocks of size 2^( 6) =       0.000546838691
  error estimate for blocks of size 2^( 7) =       0.000550048856

      target function =      -0.743647696468
              le_mean =     -22.661586357176
             les_mean =     513.999541940666
             stat err =       0.000542687700
             autocorr =       1.334722116973
   target nu stat err =       0.000542687700
   target dn stat err =       0.002910137078
      target stat err =       0.002453431716
              std dev =       0.664308100351
             le_variance =       0.441305252192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743647696468        initial
     8.6736e+08     8.6736e+09             3.0704e-13        -0.743647696468  <--
     3.4694e+09     3.4694e+10             7.6763e-14        -0.743647696468
     1.3878e+10     1.3878e+11             1.9154e-14        -0.743647696468

*****************************************************************************
Applying the update for shift_i =   8.6736e+08     and shift_s =   8.6736e+09
*****************************************************************************

  Execution time = 4.3449e+01
  </log>
  <optVariables href="FORM2.s072.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.6843
    reference variance = 0.29183
====================================================
  Execution time = 2.5915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5168e-01
  Total weights = 1.955275152e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444444663681
                                         uncertainty =       0.003720433390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444444663681
                                         uncertainty =       0.003720433390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471365084
  error estimate for blocks of size 2^( 2) =       0.000495171759
  error estimate for blocks of size 2^( 3) =       0.000517344559
  error estimate for blocks of size 2^( 4) =       0.000533029045
  error estimate for blocks of size 2^( 5) =       0.000542628894
  error estimate for blocks of size 2^( 6) =       0.000547637316
  error estimate for blocks of size 2^( 7) =       0.000550205257

      target function =      -0.743948893695
              le_mean =     -22.662696064416
             les_mean =     514.049469976717
             stat err =       0.000543375128
             autocorr =       1.328876719428
   target nu stat err =       0.000543375128
   target dn stat err =       0.004010121915
      target stat err =       0.003341419343
              std dev =       0.666610894017
             le_variance =       0.444370084022


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266269606442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+08, overlap shift 2.1684e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743963115099       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743963115099       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743963115099       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743963202023       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743963115099       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743963115099       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743963429207       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743963428181       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743962859912       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743963190499       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743963581320       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+08 is 1.191746e-12

solving harmonic davidson linear method for identity shift 8.6736e+08, overlap shift 8.6736e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743963115099       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743963115099       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743963115099       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743963115099       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743963115099       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743963115099       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743962603883       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743963374273       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743964206015       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743965730790       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743963115099       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+08 is 2.978828e-13

solving harmonic davidson linear method for identity shift 3.4694e+09, overlap shift 3.4694e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743963115099       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743963115099       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743963115099       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743963187780       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743963115099       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743963115099       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743963131644       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743968566081       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743955794455       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743963115099       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743953653306       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743961920658       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.4694e+09 is 7.454811e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.082616 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0655e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -22.7038
    reference variance = 0.356548
====================================================
  Execution time = 2.5288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5484e-01
  Total weights = 1.9551e+06
  Execution time = 3.6164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443882071362
                                         uncertainty =       0.002446098710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443882071362
                                         uncertainty =       0.002446098710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471115217
  error estimate for blocks of size 2^( 2) =       0.000494799225
  error estimate for blocks of size 2^( 3) =       0.000516918930
  error estimate for blocks of size 2^( 4) =       0.000532492389
  error estimate for blocks of size 2^( 5) =       0.000542358404
  error estimate for blocks of size 2^( 6) =       0.000549670843
  error estimate for blocks of size 2^( 7) =       0.000551018685

      target function =      -0.741369108518
              le_mean =     -22.662655425087
             les_mean =     514.050791201776
             stat err =       0.000543885080
             autocorr =       1.332784784841
   target nu stat err =       0.000543885080
   target dn stat err =       0.003403345943
      target stat err =       0.002834062168
              std dev =       0.666257529591
             le_variance =       0.443899095737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443882071362
                                         uncertainty =       0.002446098710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443882071362
                                         uncertainty =       0.002446098710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471115217
  error estimate for blocks of size 2^( 2) =       0.000494799225
  error estimate for blocks of size 2^( 3) =       0.000516918930
  error estimate for blocks of size 2^( 4) =       0.000532492389
  error estimate for blocks of size 2^( 5) =       0.000542358404
  error estimate for blocks of size 2^( 6) =       0.000549670843
  error estimate for blocks of size 2^( 7) =       0.000551018685

      target function =      -0.741369108519
              le_mean =     -22.662655425087
             les_mean =     514.050791201776
             stat err =       0.000543885080
             autocorr =       1.332784784834
   target nu stat err =       0.000543885080
   target dn stat err =       0.003403345943
      target stat err =       0.002834062168
              std dev =       0.666257529591
             le_variance =       0.443899095737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443882071362
                                         uncertainty =       0.002446098710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443882071362
                                         uncertainty =       0.002446098710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471115217
  error estimate for blocks of size 2^( 2) =       0.000494799225
  error estimate for blocks of size 2^( 3) =       0.000516918930
  error estimate for blocks of size 2^( 4) =       0.000532492389
  error estimate for blocks of size 2^( 5) =       0.000542358404
  error estimate for blocks of size 2^( 6) =       0.000549670843
  error estimate for blocks of size 2^( 7) =       0.000551018685

      target function =      -0.741369108518
              le_mean =     -22.662655425087
             les_mean =     514.050791201776
             stat err =       0.000543885080
             autocorr =       1.332784784843
   target nu stat err =       0.000543885080
   target dn stat err =       0.003403345943
      target stat err =       0.002834062168
              std dev =       0.666257529591
             le_variance =       0.443899095737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443882071362
                                         uncertainty =       0.002446098710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443882071362
                                         uncertainty =       0.002446098710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471115217
  error estimate for blocks of size 2^( 2) =       0.000494799225
  error estimate for blocks of size 2^( 3) =       0.000516918930
  error estimate for blocks of size 2^( 4) =       0.000532492389
  error estimate for blocks of size 2^( 5) =       0.000542358404
  error estimate for blocks of size 2^( 6) =       0.000549670843
  error estimate for blocks of size 2^( 7) =       0.000551018685

      target function =      -0.741369108518
              le_mean =     -22.662655425087
             les_mean =     514.050791201776
             stat err =       0.000543885080
             autocorr =       1.332784784834
   target nu stat err =       0.000543885080
   target dn stat err =       0.003403345943
      target stat err =       0.002834062168
              std dev =       0.666257529591
             le_variance =       0.443899095737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741369108518        initial
     2.1684e+08     2.1684e+09             1.1917e-12        -0.741369108519  <--
     8.6736e+08     8.6736e+09             2.9788e-13        -0.741369108518
     3.4694e+09     3.4694e+10             7.4548e-14        -0.741369108518

*****************************************************************************
Applying the update for shift_i =   2.1684e+08     and shift_s =   2.1684e+09
*****************************************************************************

  Execution time = 4.3424e+01
  </log>
  <optVariables href="FORM2.s073.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4084e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.6951
    reference variance = 0.295242
====================================================
  Execution time = 2.5961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4983e-01
  Total weights = 1.955217710e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088928482
                                         uncertainty =       0.002529841742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440088928482
                                         uncertainty =       0.002529841742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469071052
  error estimate for blocks of size 2^( 2) =       0.000493076346
  error estimate for blocks of size 2^( 3) =       0.000515016069
  error estimate for blocks of size 2^( 4) =       0.000531205958
  error estimate for blocks of size 2^( 5) =       0.000539203737
  error estimate for blocks of size 2^( 6) =       0.000542097765
  error estimate for blocks of size 2^( 7) =       0.000543962385

      target function =      -0.745463802696
              le_mean =     -22.662029164100
             les_mean =     514.017397108317
             stat err =       0.000539117461
             autocorr =       1.320959593754
   target nu stat err =       0.000539117461
   target dn stat err =       0.003443549166
      target stat err =       0.002893351346
              std dev =       0.663366642802
             le_variance =       0.440055302783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266202916410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+07, overlap shift 5.4210e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745474087771       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745474087771       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745474087771       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745474074250       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745474087773       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745474087771       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745474081459       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745474082840       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745474038397       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745474073521       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745474141086       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745474014744       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+07 is 5.985096e-12

solving harmonic davidson linear method for identity shift 2.1684e+08, overlap shift 2.1684e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745474087771       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745474087771       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745474087771       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745474101891       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745474087771       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745474083786       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745474085836       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745474417632       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745473713381       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745473932928       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745473891659       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745473838906       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+08 is 1.496311e-12

solving harmonic davidson linear method for identity shift 8.6736e+08, overlap shift 8.6736e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745474087771       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745474087771       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745474087771       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745474087771       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745474246340       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745473525364       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745474068720       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745475797920       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745474087771       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745476987753       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745472640301       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745474346075       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+08 is 3.740722e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.087397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0685e+01
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -22.5758
    reference variance = 0.253617
====================================================
  Execution time = 2.5517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4960e-01
  Total weights = 1.9548e+06
  Execution time = 3.6154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440211997955
                                         uncertainty =       0.002305262300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440211997955
                                         uncertainty =       0.002305262300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469149831
  error estimate for blocks of size 2^( 2) =       0.000493441888
  error estimate for blocks of size 2^( 3) =       0.000515864171
  error estimate for blocks of size 2^( 4) =       0.000532623145
  error estimate for blocks of size 2^( 5) =       0.000541531215
  error estimate for blocks of size 2^( 6) =       0.000548674686
  error estimate for blocks of size 2^( 7) =       0.000552431653

      target function =      -0.745650344676
              le_mean =     -22.661528699448
             les_mean =     513.994486830822
             stat err =       0.000543815175
             autocorr =       1.343629451936
   target nu stat err =       0.000543815175
   target dn stat err =       0.002742497780
      target stat err =       0.002332921792
              std dev =       0.663478054131
             le_variance =       0.440203128313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440211997953
                                         uncertainty =       0.002305262300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440211997953
                                         uncertainty =       0.002305262300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469149831
  error estimate for blocks of size 2^( 2) =       0.000493441888
  error estimate for blocks of size 2^( 3) =       0.000515864171
  error estimate for blocks of size 2^( 4) =       0.000532623145
  error estimate for blocks of size 2^( 5) =       0.000541531215
  error estimate for blocks of size 2^( 6) =       0.000548674686
  error estimate for blocks of size 2^( 7) =       0.000552431653

      target function =      -0.745650344675
              le_mean =     -22.661528699448
             les_mean =     513.994486830822
             stat err =       0.000543815175
             autocorr =       1.343629451943
   target nu stat err =       0.000543815175
   target dn stat err =       0.002742497780
      target stat err =       0.002332921792
              std dev =       0.663478054129
             le_variance =       0.440203128311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440211997954
                                         uncertainty =       0.002305262300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440211997954
                                         uncertainty =       0.002305262300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469149831
  error estimate for blocks of size 2^( 2) =       0.000493441888
  error estimate for blocks of size 2^( 3) =       0.000515864171
  error estimate for blocks of size 2^( 4) =       0.000532623145
  error estimate for blocks of size 2^( 5) =       0.000541531215
  error estimate for blocks of size 2^( 6) =       0.000548674686
  error estimate for blocks of size 2^( 7) =       0.000552431653

      target function =      -0.745650344675
              le_mean =     -22.661528699448
             les_mean =     513.994486830822
             stat err =       0.000543815175
             autocorr =       1.343629451940
   target nu stat err =       0.000543815175
   target dn stat err =       0.002742497780
      target stat err =       0.002332921792
              std dev =       0.663478054130
             le_variance =       0.440203128312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440211997955
                                         uncertainty =       0.002305262300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440211997955
                                         uncertainty =       0.002305262300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469149831
  error estimate for blocks of size 2^( 2) =       0.000493441888
  error estimate for blocks of size 2^( 3) =       0.000515864171
  error estimate for blocks of size 2^( 4) =       0.000532623145
  error estimate for blocks of size 2^( 5) =       0.000541531215
  error estimate for blocks of size 2^( 6) =       0.000548674686
  error estimate for blocks of size 2^( 7) =       0.000552431653

      target function =      -0.745650344675
              le_mean =     -22.661528699448
             les_mean =     513.994486830822
             stat err =       0.000543815174
             autocorr =       1.343629451929
   target nu stat err =       0.000543815175
   target dn stat err =       0.002742497780
      target stat err =       0.002332921792
              std dev =       0.663478054131
             le_variance =       0.440203128313


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745650344676        initial  <--
     5.4210e+07     5.4210e+08             5.9851e-12        -0.745650344675
     2.1684e+08     2.1684e+09             1.4963e-12        -0.745650344675
     8.6736e+08     8.6736e+09             3.7407e-13        -0.745650344675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.6618
  </log>
  <optVariables href="FORM2.s074.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.7109
    reference variance = 0.558677
====================================================
  Execution time = 2.8122e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5480e-01
  Total weights = 1.955502099e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444470381777
                                         uncertainty =       0.003140319206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444470381777
                                         uncertainty =       0.003140319206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471406214
  error estimate for blocks of size 2^( 2) =       0.000494886408
  error estimate for blocks of size 2^( 3) =       0.000516996147
  error estimate for blocks of size 2^( 4) =       0.000532404348
  error estimate for blocks of size 2^( 5) =       0.000542111707
  error estimate for blocks of size 2^( 6) =       0.000547231722
  error estimate for blocks of size 2^( 7) =       0.000548764185

      target function =      -0.741400825490
              le_mean =     -22.662465185507
             les_mean =     514.042127385081
             stat err =       0.000542627991
             autocorr =       1.324993592678
   target nu stat err =       0.000542627991
   target dn stat err =       0.003626409776
      target stat err =       0.003010946016
              std dev =       0.666669061906
             le_variance =       0.444447638102


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266246518551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+08, overlap shift 5.4210e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741412187256       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741412187257       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741412187257       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741412103250       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741412399558       residual = 8.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741412093022       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741412187257       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741412187257       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741412187257       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741411682087       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741412142651       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741410598592       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+08 is 5.150565e-13

solving harmonic davidson linear method for identity shift 2.1684e+09, overlap shift 2.1684e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741412187256       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741412187257       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741412187257       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741411793909       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741411343005       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741412187257       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741412587836       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741409864190       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741411108559       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741412256755       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741409701002       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741413366764       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+09 is 1.287224e-13

solving harmonic davidson linear method for identity shift 8.6736e+09, overlap shift 8.6736e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741412187256       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741412187257       residual = 5.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741412187257       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741412187256       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741412187328       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741412187262       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741406321364       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741398907053       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741422621563       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741445062883       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741389949364       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741374820359       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741389287004       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741419163071       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.741425537959       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741456595648       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741402722611       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+09 is 3.220830e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.093640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2909e+01
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -22.6966
    reference variance = 0.297033
====================================================
  Execution time = 2.5276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5144e-01
  Total weights = 1.9554e+06
  Execution time = 3.6139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441674212856
                                         uncertainty =       0.002749229674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441674212856
                                         uncertainty =       0.002749229674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469915751
  error estimate for blocks of size 2^( 2) =       0.000493687682
  error estimate for blocks of size 2^( 3) =       0.000515013807
  error estimate for blocks of size 2^( 4) =       0.000531288533
  error estimate for blocks of size 2^( 5) =       0.000541248752
  error estimate for blocks of size 2^( 6) =       0.000547641786
  error estimate for blocks of size 2^( 7) =       0.000549369603

      target function =      -0.744137669358
              le_mean =     -22.661792065591
             les_mean =     514.008264324439
             stat err =       0.000542387168
             autocorr =       1.332228774258
   target nu stat err =       0.000542387168
   target dn stat err =       0.003474642154
      target stat err =       0.002907936580
              std dev =       0.664561227536
             le_variance =       0.441641625144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441674212855
                                         uncertainty =       0.002749229674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441674212855
                                         uncertainty =       0.002749229674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469915751
  error estimate for blocks of size 2^( 2) =       0.000493687682
  error estimate for blocks of size 2^( 3) =       0.000515013807
  error estimate for blocks of size 2^( 4) =       0.000531288533
  error estimate for blocks of size 2^( 5) =       0.000541248752
  error estimate for blocks of size 2^( 6) =       0.000547641786
  error estimate for blocks of size 2^( 7) =       0.000549369603

      target function =      -0.744137669358
              le_mean =     -22.661792065591
             les_mean =     514.008264324439
             stat err =       0.000542387168
             autocorr =       1.332228774254
   target nu stat err =       0.000542387168
   target dn stat err =       0.003474642154
      target stat err =       0.002907936580
              std dev =       0.664561227535
             le_variance =       0.441641625143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441674212855
                                         uncertainty =       0.002749229674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441674212855
                                         uncertainty =       0.002749229674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469915751
  error estimate for blocks of size 2^( 2) =       0.000493687682
  error estimate for blocks of size 2^( 3) =       0.000515013807
  error estimate for blocks of size 2^( 4) =       0.000531288533
  error estimate for blocks of size 2^( 5) =       0.000541248752
  error estimate for blocks of size 2^( 6) =       0.000547641786
  error estimate for blocks of size 2^( 7) =       0.000549369603

      target function =      -0.744137669358
              le_mean =     -22.661792065591
             les_mean =     514.008264324439
             stat err =       0.000542387168
             autocorr =       1.332228774258
   target nu stat err =       0.000542387168
   target dn stat err =       0.003474642154
      target stat err =       0.002907936580
              std dev =       0.664561227536
             le_variance =       0.441641625144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441674212856
                                         uncertainty =       0.002749229674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441674212856
                                         uncertainty =       0.002749229674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469915751
  error estimate for blocks of size 2^( 2) =       0.000493687682
  error estimate for blocks of size 2^( 3) =       0.000515013807
  error estimate for blocks of size 2^( 4) =       0.000531288533
  error estimate for blocks of size 2^( 5) =       0.000541248752
  error estimate for blocks of size 2^( 6) =       0.000547641786
  error estimate for blocks of size 2^( 7) =       0.000549369603

      target function =      -0.744137669358
              le_mean =     -22.661792065591
             les_mean =     514.008264324439
             stat err =       0.000542387168
             autocorr =       1.332228774258
   target nu stat err =       0.000542387168
   target dn stat err =       0.003474642154
      target stat err =       0.002907936580
              std dev =       0.664561227536
             le_variance =       0.441641625144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744137669358        initial  <--
     5.4210e+08     5.4210e+09             5.1506e-13        -0.744137669358
     2.1684e+09     2.1684e+10             1.2872e-13        -0.744137669358
     8.6736e+09     8.6736e+10             3.2208e-14        -0.744137669358

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4227
  </log>
  <optVariables href="FORM2.s075.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6338e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.6444
    reference variance = 0.383355
====================================================
  Execution time = 2.5877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4693e-01
  Total weights = 1.955208434e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438272066404
                                         uncertainty =       0.001746887989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438272066404
                                         uncertainty =       0.001746887989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468092397
  error estimate for blocks of size 2^( 2) =       0.000491928278
  error estimate for blocks of size 2^( 3) =       0.000514125404
  error estimate for blocks of size 2^( 4) =       0.000530720720
  error estimate for blocks of size 2^( 5) =       0.000539593338
  error estimate for blocks of size 2^( 6) =       0.000544113060
  error estimate for blocks of size 2^( 7) =       0.000547444735

      target function =      -0.747872387151
              le_mean =     -22.662679870569
             les_mean =     514.043986603684
             stat err =       0.000540467963
             autocorr =       1.333143002006
   target nu stat err =       0.000540467963
   target dn stat err =       0.002320136198
      target stat err =       0.002013075092
              std dev =       0.661982616364
             le_variance =       0.438220984368


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266267987057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+09, overlap shift 5.4210e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747876848836       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747876848836       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747876848836       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747876848836       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747876848849       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747876871008       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747876872336       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747880523658       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747882494054       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747872576928       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+09 is 5.578923e-14

solving harmonic davidson linear method for identity shift 2.1684e+10, overlap shift 2.1684e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747876848836       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747876848836       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747876848836       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747876848836       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747876848836       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747876848839       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747878667755       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747905079323       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747858888881       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747917769880       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747897873061       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747862724898       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747864631025       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747945712266       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747930877601       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747808538685       residual = 7.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747932077457       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747899819158       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747866109548       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747902403005       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747984762181       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747727959146       residual = 8.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.748251457889       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.748023425990       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747174885342       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.748343267205       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.747952980347       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.746723008777       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747848252396       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748765627031       residual = 4.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736456535964       residual = 2.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.727813085363       residual = 5.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.727759372654       residual = 3.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.844703954439       residual = 2.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.671639257901       residual = 3.61e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       5.104942784053       residual = 1.83e+05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.564459803559       residual = 3.37e+04           smallest_sin_value = 1.00e+00
davidson iteration   37 stopping due to too large eigenvalue change
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+10 is 1.396419e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.6736e+10, overlap shift 8.6736e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747876848836       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747876848836       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747876848836       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747876848836       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747876848836       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747876849058       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747877217639       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747870609538       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747828169274       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747858967005       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747821842237       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748040381687       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748089890755       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747784323968       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747852990614       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747708871035       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747623942824       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.748193718470       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748776056435       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751995914288       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749920259365       residual = 7.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747538778904       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.751095915414       residual = 6.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742696341811       residual = 4.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.756399101638       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.645220533721       residual = 6.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.817615506746       residual = 2.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.758778938181       residual = 4.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.673881872235       residual = 2.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.956285199485       residual = 1.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.773351859746       residual = 1.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.148082804015       residual = 9.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.526143592118       residual = 4.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -2.208533289014       residual = 2.83e+05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.527937353502       residual = 4.41e+05           smallest_sin_value = 1.00e+00
davidson iteration   35 stopping due to too large eigenvalue change
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.6736e+10 is 3.478235e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.133003 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0652e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -22.7195
    reference variance = 0.492172
====================================================
  Execution time = 2.5312e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5330e-01
  Total weights = 1.9547e+06
  Execution time = 3.6300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443283899115
                                         uncertainty =       0.002544623538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443283899115
                                         uncertainty =       0.002544623538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470780490
  error estimate for blocks of size 2^( 2) =       0.000494429768
  error estimate for blocks of size 2^( 3) =       0.000516430782
  error estimate for blocks of size 2^( 4) =       0.000531902819
  error estimate for blocks of size 2^( 5) =       0.000540161919
  error estimate for blocks of size 2^( 6) =       0.000544273919
  error estimate for blocks of size 2^( 7) =       0.000547353010

      target function =      -0.742624571103
              le_mean =     -22.662176964773
             les_mean =     514.027564749807
             stat err =       0.000540922917
             autocorr =       1.320182128719
   target nu stat err =       0.000540922917
   target dn stat err =       0.003191571554
      target stat err =       0.002671974818
              std dev =       0.665784153723
             le_variance =       0.443268539348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443283899115
                                         uncertainty =       0.002544623538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443283899115
                                         uncertainty =       0.002544623538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470780490
  error estimate for blocks of size 2^( 2) =       0.000494429768
  error estimate for blocks of size 2^( 3) =       0.000516430782
  error estimate for blocks of size 2^( 4) =       0.000531902819
  error estimate for blocks of size 2^( 5) =       0.000540161919
  error estimate for blocks of size 2^( 6) =       0.000544273919
  error estimate for blocks of size 2^( 7) =       0.000547353010

      target function =      -0.742624571103
              le_mean =     -22.662176964773
             les_mean =     514.027564749807
             stat err =       0.000540922917
             autocorr =       1.320182128718
   target nu stat err =       0.000540922917
   target dn stat err =       0.003191571554
      target stat err =       0.002671974818
              std dev =       0.665784153723
             le_variance =       0.443268539349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443283899115
                                         uncertainty =       0.002544623538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443283899115
                                         uncertainty =       0.002544623538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470780490
  error estimate for blocks of size 2^( 2) =       0.000494429768
  error estimate for blocks of size 2^( 3) =       0.000516430782
  error estimate for blocks of size 2^( 4) =       0.000531902819
  error estimate for blocks of size 2^( 5) =       0.000540161919
  error estimate for blocks of size 2^( 6) =       0.000544273919
  error estimate for blocks of size 2^( 7) =       0.000547353010

      target function =      -0.742624571103
              le_mean =     -22.662176964773
             les_mean =     514.027564749807
             stat err =       0.000540922917
             autocorr =       1.320182128725
   target nu stat err =       0.000540922917
   target dn stat err =       0.003191571554
      target stat err =       0.002671974818
              std dev =       0.665784153723
             le_variance =       0.443268539349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443283899115
                                         uncertainty =       0.002544623538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443283899115
                                         uncertainty =       0.002544623538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470780490
  error estimate for blocks of size 2^( 2) =       0.000494429768
  error estimate for blocks of size 2^( 3) =       0.000516430782
  error estimate for blocks of size 2^( 4) =       0.000531902819
  error estimate for blocks of size 2^( 5) =       0.000540161919
  error estimate for blocks of size 2^( 6) =       0.000544273919
  error estimate for blocks of size 2^( 7) =       0.000547353010

      target function =      -0.742624571103
              le_mean =     -22.662176964773
             les_mean =     514.027564749807
             stat err =       0.000540922917
             autocorr =       1.320182128723
   target nu stat err =       0.000540922917
   target dn stat err =       0.003191571554
      target stat err =       0.002671974818
              std dev =       0.665784153723
             le_variance =       0.443268539349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742624571103        initial
     5.4210e+09     5.4210e+10             5.5789e-14        -0.742624571103  <--
     2.1684e+10     2.1684e+11             1.3964e-14        -0.742624571103
     8.6736e+10     8.6736e+11             3.4782e-15        -0.742624571103

*****************************************************************************
Applying the update for shift_i =   5.4210e+09     and shift_s =   5.4210e+10
*****************************************************************************

  Execution time = 4.3551e+01
  </log>
  <optVariables href="FORM2.s076.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4210e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.6488
    reference variance = 0.389192
====================================================
  Execution time = 2.6003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5606e-01
  Total weights = 1.955172896e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444493478325
                                         uncertainty =       0.002426927518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444493478325
                                         uncertainty =       0.002426927518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471407749
  error estimate for blocks of size 2^( 2) =       0.000495025287
  error estimate for blocks of size 2^( 3) =       0.000516942301
  error estimate for blocks of size 2^( 4) =       0.000533132850
  error estimate for blocks of size 2^( 5) =       0.000541921428
  error estimate for blocks of size 2^( 6) =       0.000546355446
  error estimate for blocks of size 2^( 7) =       0.000551046065

      target function =      -0.740379141493
              le_mean =     -22.662427229556
             les_mean =     514.041666271900
             stat err =       0.000543113947
             autocorr =       1.327359241541
   target nu stat err =       0.000543113947
   target dn stat err =       0.003359259265
      target stat err =       0.002790565646
              std dev =       0.666671231507
             le_variance =       0.444450530920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266242722956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+09, overlap shift 1.3553e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740388721677       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740388721677       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740388721677       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740388721677       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740388649558       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740388163423       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740388991645       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740385851625       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740388977816       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740388043056       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740386206777       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740385584803       residual = 2.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+09 is 1.913467e-13

solving harmonic davidson linear method for identity shift 5.4210e+09, overlap shift 5.4210e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740388721677       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740388721677       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740388721677       residual = 5.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740388721677       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740388480423       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740387979876       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740387398163       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740396441151       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740392123899       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740388272134       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740382319583       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740400695351       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+09 is 4.776108e-14

solving harmonic davidson linear method for identity shift 2.1684e+10, overlap shift 2.1684e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.740388721677       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.740388721677       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.740388721677       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.740388721677       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.740395630118       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.740390240417       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.740383259081       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740381988469       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740406740896       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.740417087792       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.740458806595       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740390832954       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.740421469131       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740487291917       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740380812802       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.740396773867       residual = 8.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740378167587       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740385660710       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740400672681       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.740361582219       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.740195277164       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740788811624       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.740321187867       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.740357431643       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740449499500       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.740387896508       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740826182391       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.741161550172       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739066012319       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741505763847       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.739438260351       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.773607668611       residual = 1.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.707083774137       residual = 5.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.769125553589       residual = 9.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.854797584993       residual = 5.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.838514529062       residual = 3.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.386308973665       residual = 1.29e+04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.468684985938       residual = 9.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       1.256709355899       residual = 2.56e+04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       5.509061478162       residual = 2.52e+05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.711744988655       residual = 3.78e+05           smallest_sin_value = 1.00e+00
davidson iteration   41 stopping due to too large eigenvalue change
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1684e+10 is 1.193180e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.163284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0785e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -22.6115
    reference variance = 0.526581
====================================================
  Execution time = 2.5419e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4990e-01
  Total weights = 1.9553e+06
  Execution time = 3.6224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440862238229
                                         uncertainty =       0.002242628190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440862238229
                                         uncertainty =       0.002242628190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469562124
  error estimate for blocks of size 2^( 2) =       0.000493214910
  error estimate for blocks of size 2^( 3) =       0.000515632238
  error estimate for blocks of size 2^( 4) =       0.000531187655
  error estimate for blocks of size 2^( 5) =       0.000541227224
  error estimate for blocks of size 2^( 6) =       0.000546137134
  error estimate for blocks of size 2^( 7) =       0.000548126769

      target function =      -0.745408120751
              le_mean =     -22.661930289220
             les_mean =     514.012987509054
             stat err =       0.000541669696
             autocorr =       1.330708591701
   target nu stat err =       0.000541669696
   target dn stat err =       0.002683019744
      target stat err =       0.002285006032
              std dev =       0.664061124491
             le_variance =       0.440977177061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440862238229
                                         uncertainty =       0.002242628190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440862238229
                                         uncertainty =       0.002242628190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469562124
  error estimate for blocks of size 2^( 2) =       0.000493214910
  error estimate for blocks of size 2^( 3) =       0.000515632238
  error estimate for blocks of size 2^( 4) =       0.000531187655
  error estimate for blocks of size 2^( 5) =       0.000541227224
  error estimate for blocks of size 2^( 6) =       0.000546137134
  error estimate for blocks of size 2^( 7) =       0.000548126769

      target function =      -0.745408120751
              le_mean =     -22.661930289220
             les_mean =     514.012987509054
             stat err =       0.000541669696
             autocorr =       1.330708591704
   target nu stat err =       0.000541669696
   target dn stat err =       0.002683019744
      target stat err =       0.002285006032
              std dev =       0.664061124492
             le_variance =       0.440977177061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440862238229
                                         uncertainty =       0.002242628190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440862238229
                                         uncertainty =       0.002242628190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469562124
  error estimate for blocks of size 2^( 2) =       0.000493214910
  error estimate for blocks of size 2^( 3) =       0.000515632238
  error estimate for blocks of size 2^( 4) =       0.000531187655
  error estimate for blocks of size 2^( 5) =       0.000541227224
  error estimate for blocks of size 2^( 6) =       0.000546137134
  error estimate for blocks of size 2^( 7) =       0.000548126769

      target function =      -0.745408120751
              le_mean =     -22.661930289220
             les_mean =     514.012987509054
             stat err =       0.000541669696
             autocorr =       1.330708591698
   target nu stat err =       0.000541669696
   target dn stat err =       0.002683019744
      target stat err =       0.002285006032
              std dev =       0.664061124491
             le_variance =       0.440977177061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440862238229
                                         uncertainty =       0.002242628190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440862238229
                                         uncertainty =       0.002242628190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469562124
  error estimate for blocks of size 2^( 2) =       0.000493214910
  error estimate for blocks of size 2^( 3) =       0.000515632238
  error estimate for blocks of size 2^( 4) =       0.000531187655
  error estimate for blocks of size 2^( 5) =       0.000541227224
  error estimate for blocks of size 2^( 6) =       0.000546137134
  error estimate for blocks of size 2^( 7) =       0.000548126769

      target function =      -0.745408120751
              le_mean =     -22.661930289220
             les_mean =     514.012987509054
             stat err =       0.000541669696
             autocorr =       1.330708591700
   target nu stat err =       0.000541669696
   target dn stat err =       0.002683019744
      target stat err =       0.002285006032
              std dev =       0.664061124491
             le_variance =       0.440977177061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745408120751        initial
     1.3553e+09     1.3553e+10             1.9135e-13        -0.745408120751  <--
     5.4210e+09     5.4210e+10             4.7761e-14        -0.745408120751
     2.1684e+10     2.1684e+11             1.1932e-14        -0.745408120751

*****************************************************************************
Applying the update for shift_i =   1.3553e+09     and shift_s =   1.3553e+10
*****************************************************************************

  Execution time = 4.3598e+01
  </log>
  <optVariables href="FORM2.s077.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6702
    reference variance = 0.383161
====================================================
  Execution time = 2.5819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5113e-01
  Total weights = 1.955004863e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439624418362
                                         uncertainty =       0.002036807223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439624418362
                                         uncertainty =       0.002036807223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468804991
  error estimate for blocks of size 2^( 2) =       0.000492972175
  error estimate for blocks of size 2^( 3) =       0.000514712232
  error estimate for blocks of size 2^( 4) =       0.000531422453
  error estimate for blocks of size 2^( 5) =       0.000540526221
  error estimate for blocks of size 2^( 6) =       0.000545600059
  error estimate for blocks of size 2^( 7) =       0.000549386780

      target function =      -0.744401125209
              le_mean =     -22.661974676163
             les_mean =     514.016223571686
             stat err =       0.000541733878
             autocorr =       1.335326716827
   target nu stat err =       0.000541733878
   target dn stat err =       0.003134182364
      target stat err =       0.002637997387
              std dev =       0.662990376444
             le_variance =       0.439556239257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266197467616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+08, overlap shift 3.3881e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744409476188       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744409476188       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744409476188       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744409476178       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744409476188       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744409476188       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744408982111       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744409476188       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744409476188       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744409476188       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744408542197       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744409454379       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+08 is 6.586566e-13

solving harmonic davidson linear method for identity shift 1.3553e+09, overlap shift 1.3553e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744409476188       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744409476188       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744409476188       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744409476188       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744409230405       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744409476188       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744405743241       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744408195801       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744406749835       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744412256235       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744407512806       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744408563450       residual = 1.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+09 is 1.646834e-13

solving harmonic davidson linear method for identity shift 5.4210e+09, overlap shift 5.4210e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744409476188       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744409476188       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744409476188       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744409476188       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744409476188       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744409521041       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744409476188       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744408028277       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744409476188       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744409306518       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744409476188       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744420380187       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.4210e+09 is 4.119503e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.168093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0576e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -22.6207
    reference variance = 0.347935
====================================================
  Execution time = 2.5276e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4777e-01
  Total weights = 1.9553e+06
  Execution time = 3.6276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437258121894
                                         uncertainty =       0.001892417798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437258121894
                                         uncertainty =       0.001892417798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467592641
  error estimate for blocks of size 2^( 2) =       0.000491776149
  error estimate for blocks of size 2^( 3) =       0.000513685491
  error estimate for blocks of size 2^( 4) =       0.000530041811
  error estimate for blocks of size 2^( 5) =       0.000538953202
  error estimate for blocks of size 2^( 6) =       0.000544277088
  error estimate for blocks of size 2^( 7) =       0.000548182032

      target function =      -0.747166606701
              le_mean =     -22.662603184763
             les_mean =     514.041356900444
             stat err =       0.000540363534
             autocorr =       1.335477978597
   target nu stat err =       0.000540363534
   target dn stat err =       0.003251140651
      target stat err =       0.002753571698
              std dev =       0.661275854404
             le_variance =       0.437285755618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437258121894
                                         uncertainty =       0.001892417798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437258121894
                                         uncertainty =       0.001892417798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467592641
  error estimate for blocks of size 2^( 2) =       0.000491776149
  error estimate for blocks of size 2^( 3) =       0.000513685491
  error estimate for blocks of size 2^( 4) =       0.000530041811
  error estimate for blocks of size 2^( 5) =       0.000538953202
  error estimate for blocks of size 2^( 6) =       0.000544277088
  error estimate for blocks of size 2^( 7) =       0.000548182032

      target function =      -0.747166606702
              le_mean =     -22.662603184763
             les_mean =     514.041356900443
             stat err =       0.000540363534
             autocorr =       1.335477978599
   target nu stat err =       0.000540363534
   target dn stat err =       0.003251140652
      target stat err =       0.002753571698
              std dev =       0.661275854404
             le_variance =       0.437285755618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437258121894
                                         uncertainty =       0.001892417798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437258121894
                                         uncertainty =       0.001892417798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467592641
  error estimate for blocks of size 2^( 2) =       0.000491776149
  error estimate for blocks of size 2^( 3) =       0.000513685491
  error estimate for blocks of size 2^( 4) =       0.000530041811
  error estimate for blocks of size 2^( 5) =       0.000538953202
  error estimate for blocks of size 2^( 6) =       0.000544277088
  error estimate for blocks of size 2^( 7) =       0.000548182032

      target function =      -0.747166606702
              le_mean =     -22.662603184763
             les_mean =     514.041356900444
             stat err =       0.000540363534
             autocorr =       1.335477978603
   target nu stat err =       0.000540363534
   target dn stat err =       0.003251140652
      target stat err =       0.002753571698
              std dev =       0.661275854404
             le_variance =       0.437285755618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437258121894
                                         uncertainty =       0.001892417798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437258121894
                                         uncertainty =       0.001892417798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467592641
  error estimate for blocks of size 2^( 2) =       0.000491776149
  error estimate for blocks of size 2^( 3) =       0.000513685491
  error estimate for blocks of size 2^( 4) =       0.000530041811
  error estimate for blocks of size 2^( 5) =       0.000538953202
  error estimate for blocks of size 2^( 6) =       0.000544277088
  error estimate for blocks of size 2^( 7) =       0.000548182032

      target function =      -0.747166606701
              le_mean =     -22.662603184763
             les_mean =     514.041356900444
             stat err =       0.000540363534
             autocorr =       1.335477978591
   target nu stat err =       0.000540363534
   target dn stat err =       0.003251140651
      target stat err =       0.002753571698
              std dev =       0.661275854404
             le_variance =       0.437285755618


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747166606701        initial
     3.3881e+08     3.3881e+09             6.5866e-13        -0.747166606702  <--
     1.3553e+09     1.3553e+10             1.6468e-13        -0.747166606702
     5.4210e+09     5.4210e+10             4.1195e-14        -0.747166606701

*****************************************************************************
Applying the update for shift_i =   3.3881e+08     and shift_s =   3.3881e+09
*****************************************************************************

  Execution time = 4.3497e+01
  </log>
  <optVariables href="FORM2.s078.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4079e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.603
    reference variance = 0.27628
====================================================
  Execution time = 2.7557e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5150e-01
  Total weights = 1.955090328e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7444e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441281934682
                                         uncertainty =       0.002505592810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441281934682
                                         uncertainty =       0.002505592810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469716913
  error estimate for blocks of size 2^( 2) =       0.000493636914
  error estimate for blocks of size 2^( 3) =       0.000515080870
  error estimate for blocks of size 2^( 4) =       0.000531071358
  error estimate for blocks of size 2^( 5) =       0.000542286233
  error estimate for blocks of size 2^( 6) =       0.000547780428
  error estimate for blocks of size 2^( 7) =       0.000549254778

      target function =      -0.744091656622
              le_mean =     -22.661406932657
             les_mean =     513.990862906763
             stat err =       0.000542598199
             autocorr =       1.334394676308
   target nu stat err =       0.000542598199
   target dn stat err =       0.003343937441
      target stat err =       0.002801357479
              std dev =       0.664280028477
             le_variance =       0.441267956233


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266140693266e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+07, overlap shift 8.4703e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744101183199       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744101183199       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744101183199       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744101183199       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744101157324       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744101183199       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744101183199       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744101062963       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744101464147       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744101227697       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744101169836       residual = 6.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+07 is 4.085130e-12

solving harmonic davidson linear method for identity shift 3.3881e+08, overlap shift 3.3881e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744101183199       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744101183199       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744101183199       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744101183199       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744101003710       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744101269352       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744101183199       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744100257120       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744101292412       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744101183199       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744101421017       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+08 is 1.021337e-12

solving harmonic davidson linear method for identity shift 1.3553e+09, overlap shift 1.3553e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744101183199       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744101183199       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744101183199       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744101183199       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744101183199       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744101382463       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744101117729       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744101441450       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744101596268       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744100187508       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744104855660       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3553e+09 is 2.551439e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.172254 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2311e+01
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -22.6692
    reference variance = 1.29795
====================================================
  Execution time = 2.5084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5098e-01
  Total weights = 1.9553e+06
  Execution time = 3.6105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440271754578
                                         uncertainty =       0.001833933135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440271754578
                                         uncertainty =       0.001833933135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469212046
  error estimate for blocks of size 2^( 2) =       0.000493272068
  error estimate for blocks of size 2^( 3) =       0.000515800629
  error estimate for blocks of size 2^( 4) =       0.000531142101
  error estimate for blocks of size 2^( 5) =       0.000539425894
  error estimate for blocks of size 2^( 6) =       0.000544688888
  error estimate for blocks of size 2^( 7) =       0.000545640316

      target function =      -0.744521799397
              le_mean =     -22.662262373070
             les_mean =     514.029118128468
             stat err =       0.000540224300
             autocorr =       1.325592153642
   target nu stat err =       0.000540224300
   target dn stat err =       0.003182226127
      target stat err =       0.002677998260
              std dev =       0.663566038732
             le_variance =       0.440319887759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440271754577
                                         uncertainty =       0.001833933135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440271754577
                                         uncertainty =       0.001833933135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469212046
  error estimate for blocks of size 2^( 2) =       0.000493272068
  error estimate for blocks of size 2^( 3) =       0.000515800629
  error estimate for blocks of size 2^( 4) =       0.000531142101
  error estimate for blocks of size 2^( 5) =       0.000539425894
  error estimate for blocks of size 2^( 6) =       0.000544688888
  error estimate for blocks of size 2^( 7) =       0.000545640316

      target function =      -0.744521799403
              le_mean =     -22.662262373070
             les_mean =     514.029118128462
             stat err =       0.000540224300
             autocorr =       1.325592153640
   target nu stat err =       0.000540224300
   target dn stat err =       0.003182226122
      target stat err =       0.002677998256
              std dev =       0.663566038732
             le_variance =       0.440319887759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440271754578
                                         uncertainty =       0.001833933135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440271754578
                                         uncertainty =       0.001833933135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469212046
  error estimate for blocks of size 2^( 2) =       0.000493272068
  error estimate for blocks of size 2^( 3) =       0.000515800629
  error estimate for blocks of size 2^( 4) =       0.000531142101
  error estimate for blocks of size 2^( 5) =       0.000539425894
  error estimate for blocks of size 2^( 6) =       0.000544688888
  error estimate for blocks of size 2^( 7) =       0.000545640316

      target function =      -0.744521799400
              le_mean =     -22.662262373070
             les_mean =     514.029118128465
             stat err =       0.000540224300
             autocorr =       1.325592153641
   target nu stat err =       0.000540224300
   target dn stat err =       0.003182226125
      target stat err =       0.002677998258
              std dev =       0.663566038732
             le_variance =       0.440319887759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440271754578
                                         uncertainty =       0.001833933135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440271754578
                                         uncertainty =       0.001833933135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469212046
  error estimate for blocks of size 2^( 2) =       0.000493272068
  error estimate for blocks of size 2^( 3) =       0.000515800629
  error estimate for blocks of size 2^( 4) =       0.000531142101
  error estimate for blocks of size 2^( 5) =       0.000539425894
  error estimate for blocks of size 2^( 6) =       0.000544688888
  error estimate for blocks of size 2^( 7) =       0.000545640316

      target function =      -0.744521799397
              le_mean =     -22.662262373070
             les_mean =     514.029118128468
             stat err =       0.000540224300
             autocorr =       1.325592153638
   target nu stat err =       0.000540224300
   target dn stat err =       0.003182226126
      target stat err =       0.002677998260
              std dev =       0.663566038732
             le_variance =       0.440319887759


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744521799397        initial
     8.4703e+07     8.4703e+08             4.0851e-12        -0.744521799403  <--
     3.3881e+08     3.3881e+09             1.0213e-12        -0.744521799400
     1.3553e+09     1.3553e+10             2.5514e-13        -0.744521799397

*****************************************************************************
Applying the update for shift_i =   8.4703e+07     and shift_s =   8.4703e+08
*****************************************************************************

  Execution time = 4.3226e+01
  </log>
  <optVariables href="FORM2.s079.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6189
    reference variance = 0.378174
====================================================
  Execution time = 2.5780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4802e-01
  Total weights = 1.955309602e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439525038192
                                         uncertainty =       0.001886437061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439525038192
                                         uncertainty =       0.001886437061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468767010
  error estimate for blocks of size 2^( 2) =       0.000492635500
  error estimate for blocks of size 2^( 3) =       0.000515360206
  error estimate for blocks of size 2^( 4) =       0.000530465356
  error estimate for blocks of size 2^( 5) =       0.000539507704
  error estimate for blocks of size 2^( 6) =       0.000543482917
  error estimate for blocks of size 2^( 7) =       0.000545501922

      target function =      -0.746969656912
              le_mean =     -22.662725142305
             les_mean =     514.047128319930
             stat err =       0.000539739475
             autocorr =       1.325727557733
   target nu stat err =       0.000539739475
   target dn stat err =       0.002639016864
      target stat err =       0.002261310937
              std dev =       0.662936662989
             le_variance =       0.439485019135


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266272514230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+07, overlap shift 2.1176e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746975611843       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746975611844       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746975611844       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746975611844       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746975611844       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746975611844       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746975611844       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746975629369       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746975611844       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746975611844       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+07 is 7.701006e-12

solving harmonic davidson linear method for identity shift 8.4703e+07, overlap shift 8.4703e+08 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746975611843       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746975611844       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746975611844       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746975611844       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746975611844       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746975611844       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746975611844       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746975611844       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746975611844       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746975611844       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+07 is 1.925251e-12

solving harmonic davidson linear method for identity shift 3.3881e+08, overlap shift 3.3881e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746975611843       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746975611843       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746975611843       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746975611843       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746975611843       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746975611843       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746975611843       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746975611843       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746975611843       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746975611843       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+08 is 4.813133e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.175808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0567e+01
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901968e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -22.6204
    reference variance = 0.311714
====================================================
  Execution time = 2.5207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4722e-01
  Total weights = 1.9554e+06
  Execution time = 3.6376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437036104432
                                         uncertainty =       0.001837854578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437036104432
                                         uncertainty =       0.001837854578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467514284
  error estimate for blocks of size 2^( 2) =       0.000491485682
  error estimate for blocks of size 2^( 3) =       0.000513396639
  error estimate for blocks of size 2^( 4) =       0.000528994401
  error estimate for blocks of size 2^( 5) =       0.000538662548
  error estimate for blocks of size 2^( 6) =       0.000545350763
  error estimate for blocks of size 2^( 7) =       0.000545761477

      target function =      -0.747615120144
              le_mean =     -22.661547310219
             les_mean =     513.992947920079
             stat err =       0.000539692297
             autocorr =       1.332608777896
   target nu stat err =       0.000539692297
   target dn stat err =       0.002532028436
      target stat err =       0.002175962657
              std dev =       0.661165041147
             le_variance =       0.437139211635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437036104429
                                         uncertainty =       0.001837854578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437036104429
                                         uncertainty =       0.001837854578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467514284
  error estimate for blocks of size 2^( 2) =       0.000491485682
  error estimate for blocks of size 2^( 3) =       0.000513396639
  error estimate for blocks of size 2^( 4) =       0.000528994401
  error estimate for blocks of size 2^( 5) =       0.000538662548
  error estimate for blocks of size 2^( 6) =       0.000545350763
  error estimate for blocks of size 2^( 7) =       0.000545761477

      target function =      -0.747615120137
              le_mean =     -22.661547310219
             les_mean =     513.992947920089
             stat err =       0.000539692297
             autocorr =       1.332608777900
   target nu stat err =       0.000539692297
   target dn stat err =       0.002532028437
      target stat err =       0.002175962657
              std dev =       0.661165041146
             le_variance =       0.437139211633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437036104430
                                         uncertainty =       0.001837854578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437036104430
                                         uncertainty =       0.001837854578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467514284
  error estimate for blocks of size 2^( 2) =       0.000491485682
  error estimate for blocks of size 2^( 3) =       0.000513396639
  error estimate for blocks of size 2^( 4) =       0.000528994401
  error estimate for blocks of size 2^( 5) =       0.000538662548
  error estimate for blocks of size 2^( 6) =       0.000545350763
  error estimate for blocks of size 2^( 7) =       0.000545761477

      target function =      -0.747615120141
              le_mean =     -22.661547310219
             les_mean =     513.992947920084
             stat err =       0.000539692297
             autocorr =       1.332608777898
   target nu stat err =       0.000539692297
   target dn stat err =       0.002532028436
      target stat err =       0.002175962657
              std dev =       0.661165041146
             le_variance =       0.437139211634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437036104432
                                         uncertainty =       0.001837854578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437036104432
                                         uncertainty =       0.001837854578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467514284
  error estimate for blocks of size 2^( 2) =       0.000491485682
  error estimate for blocks of size 2^( 3) =       0.000513396639
  error estimate for blocks of size 2^( 4) =       0.000528994401
  error estimate for blocks of size 2^( 5) =       0.000538662548
  error estimate for blocks of size 2^( 6) =       0.000545350763
  error estimate for blocks of size 2^( 7) =       0.000545761477

      target function =      -0.747615120144
              le_mean =     -22.661547310219
             les_mean =     513.992947920080
             stat err =       0.000539692297
             autocorr =       1.332608777894
   target nu stat err =       0.000539692297
   target dn stat err =       0.002532028436
      target stat err =       0.002175962657
              std dev =       0.661165041147
             le_variance =       0.437139211635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.747615120144        initial  <--
     2.1176e+07     2.1176e+08             7.7010e-12        -0.747615120137
     8.4703e+07     8.4703e+08             1.9253e-12        -0.747615120141
     3.3881e+08     3.3881e+09             4.8131e-13        -0.747615120144

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4640
  </log>
  <optVariables href="FORM2.s080.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4037e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.7447
    reference variance = 0.356462
====================================================
  Execution time = 2.5800e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5301e-01
  Total weights = 1.955231064e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638409678
                                         uncertainty =       0.002132570684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442638409678
                                         uncertainty =       0.002132570684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470412868
  error estimate for blocks of size 2^( 2) =       0.000493997824
  error estimate for blocks of size 2^( 3) =       0.000515916757
  error estimate for blocks of size 2^( 4) =       0.000529904866
  error estimate for blocks of size 2^( 5) =       0.000539919991
  error estimate for blocks of size 2^( 6) =       0.000544656388
  error estimate for blocks of size 2^( 7) =       0.000545594543

      target function =      -0.742863920590
              le_mean =     -22.662496467489
             les_mean =     514.041755122510
             stat err =       0.000540018947
             autocorr =       1.317830665271
   target nu stat err =       0.000540018947
   target dn stat err =       0.003096835109
      target stat err =       0.002599275622
              std dev =       0.665264257644
             le_variance =       0.442576532499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266249646749e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+08, overlap shift 2.1176e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742872124849       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742872124849       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742872124849       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742872124849       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742872124861       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742872124849       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742872484783       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742871915386       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742872089963       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742872148861       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742872109637       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+08 is 6.859953e-13

solving harmonic davidson linear method for identity shift 8.4703e+08, overlap shift 8.4703e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742872124849       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742872124849       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742872124849       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742872127662       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742872124849       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742872125885       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742870289346       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742872128720       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742871728802       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742873804194       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742868746074       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+08 is 1.714676e-13

solving harmonic davidson linear method for identity shift 3.3881e+09, overlap shift 3.3881e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.742872124849       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.742872124849       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.742872124849       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.742872124849       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.742872124849       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.742872126480       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.742872084119       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742872206368       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742867019727       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742873389293       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.742870701264       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+09 is 4.290263e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.179929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0571e+01
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -22.5965
    reference variance = 0.234196
====================================================
  Execution time = 2.5049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5369e-01
  Total weights = 1.9550e+06
  Execution time = 3.6295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444271518915
                                         uncertainty =       0.003082548905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444271518915
                                         uncertainty =       0.003082548905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471266214
  error estimate for blocks of size 2^( 2) =       0.000495446716
  error estimate for blocks of size 2^( 3) =       0.000516819362
  error estimate for blocks of size 2^( 4) =       0.000533052729
  error estimate for blocks of size 2^( 5) =       0.000541847198
  error estimate for blocks of size 2^( 6) =       0.000547195588
  error estimate for blocks of size 2^( 7) =       0.000548199405

      target function =      -0.742310738911
              le_mean =     -22.663281524135
             les_mean =     514.078016337654
             stat err =       0.000542573730
             autocorr =       1.325515819383
   target nu stat err =       0.000542573730
   target dn stat err =       0.003331027757
      target stat err =       0.002785709833
              std dev =       0.666471070643
             le_variance =       0.444183688003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444271518915
                                         uncertainty =       0.003082548905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444271518915
                                         uncertainty =       0.003082548905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471266214
  error estimate for blocks of size 2^( 2) =       0.000495446716
  error estimate for blocks of size 2^( 3) =       0.000516819362
  error estimate for blocks of size 2^( 4) =       0.000533052729
  error estimate for blocks of size 2^( 5) =       0.000541847198
  error estimate for blocks of size 2^( 6) =       0.000547195588
  error estimate for blocks of size 2^( 7) =       0.000548199405

      target function =      -0.742310738910
              le_mean =     -22.663281524135
             les_mean =     514.078016337655
             stat err =       0.000542573730
             autocorr =       1.325515819389
   target nu stat err =       0.000542573730
   target dn stat err =       0.003331027757
      target stat err =       0.002785709833
              std dev =       0.666471070642
             le_variance =       0.444183688003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444271518915
                                         uncertainty =       0.003082548905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444271518915
                                         uncertainty =       0.003082548905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471266214
  error estimate for blocks of size 2^( 2) =       0.000495446716
  error estimate for blocks of size 2^( 3) =       0.000516819362
  error estimate for blocks of size 2^( 4) =       0.000533052729
  error estimate for blocks of size 2^( 5) =       0.000541847198
  error estimate for blocks of size 2^( 6) =       0.000547195588
  error estimate for blocks of size 2^( 7) =       0.000548199405

      target function =      -0.742310738910
              le_mean =     -22.663281524135
             les_mean =     514.078016337655
             stat err =       0.000542573730
             autocorr =       1.325515819395
   target nu stat err =       0.000542573730
   target dn stat err =       0.003331027757
      target stat err =       0.002785709833
              std dev =       0.666471070643
             le_variance =       0.444183688003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444271518915
                                         uncertainty =       0.003082548905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444271518915
                                         uncertainty =       0.003082548905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471266214
  error estimate for blocks of size 2^( 2) =       0.000495446716
  error estimate for blocks of size 2^( 3) =       0.000516819362
  error estimate for blocks of size 2^( 4) =       0.000533052729
  error estimate for blocks of size 2^( 5) =       0.000541847198
  error estimate for blocks of size 2^( 6) =       0.000547195588
  error estimate for blocks of size 2^( 7) =       0.000548199405

      target function =      -0.742310738911
              le_mean =     -22.663281524135
             les_mean =     514.078016337654
             stat err =       0.000542573730
             autocorr =       1.325515819390
   target nu stat err =       0.000542573730
   target dn stat err =       0.003331027757
      target stat err =       0.002785709833
              std dev =       0.666471070643
             le_variance =       0.444183688003


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742310738911        initial  <--
     2.1176e+08     2.1176e+09             6.8600e-13        -0.742310738910
     8.4703e+08     8.4703e+09             1.7147e-13        -0.742310738910
     3.3881e+09     3.3881e+10             4.2903e-14        -0.742310738911

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.2430
  </log>
  <optVariables href="FORM2.s081.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3841e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2655e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.7338
    reference variance = 0.669325
====================================================
  Execution time = 2.5856e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4224e-01
  Total weights = 1.954974952e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434827078906
                                         uncertainty =       0.001785893134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.434827078906
                                         uncertainty =       0.001785893134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000466332470
  error estimate for blocks of size 2^( 2) =       0.000490263505
  error estimate for blocks of size 2^( 3) =       0.000512456992
  error estimate for blocks of size 2^( 4) =       0.000527133634
  error estimate for blocks of size 2^( 5) =       0.000535704316
  error estimate for blocks of size 2^( 6) =       0.000539422757
  error estimate for blocks of size 2^( 7) =       0.000543468901

      target function =      -0.751762141060
              le_mean =     -22.662061945413
             les_mean =     514.011296198305
             stat err =       0.000536432402
             autocorr =       1.323240225446
   target nu stat err =       0.000536432402
   target dn stat err =       0.002128635226
      target stat err =       0.001877475355
              std dev =       0.659493703013
             le_variance =       0.434931944314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266206194541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+09, overlap shift 2.1176e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751765839665       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751765839665       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751765839665       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751765839665       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751765839665       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751765839665       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751765839665       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751765839665       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751765839665       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751765839665       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751765839665       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751760829389       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+09 is 1.043114e-13

solving harmonic davidson linear method for identity shift 8.4703e+09, overlap shift 8.4703e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751765839665       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751765839665       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751765839665       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751765839665       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751765839665       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751765839665       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751765839665       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751765839665       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751762718103       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751765839665       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751765839665       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751765839665       residual = 1.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+09 is 2.607563e-14

solving harmonic davidson linear method for identity shift 3.3881e+10, overlap shift 3.3881e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.751765839665       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.751765839665       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.751765839665       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751765839665       residual = 9.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.751765839665       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.751765839665       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.751765839665       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.751765839665       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.751780365901       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751765839665       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751728767385       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.751661912762       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.751765839665       residual = 5.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+10 is 6.517563e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.184935 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0597e+01
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -22.7011
    reference variance = 0.472379
====================================================
  Execution time = 2.5164e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5104e-01
  Total weights = 1.9552e+06
  Execution time = 3.6341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440778089872
                                         uncertainty =       0.001894842173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440778089872
                                         uncertainty =       0.001894842173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469447379
  error estimate for blocks of size 2^( 2) =       0.000493862575
  error estimate for blocks of size 2^( 3) =       0.000515486902
  error estimate for blocks of size 2^( 4) =       0.000531864059
  error estimate for blocks of size 2^( 5) =       0.000541941470
  error estimate for blocks of size 2^( 6) =       0.000547473329
  error estimate for blocks of size 2^( 7) =       0.000548863206

      target function =      -0.744471244594
              le_mean =     -22.661750040141
             les_mean =     514.005956490736
             stat err =       0.000542535516
             autocorr =       1.335618754387
   target nu stat err =       0.000542535516
   target dn stat err =       0.002859080430
      target stat err =       0.002418682583
              std dev =       0.663898850861
             le_variance =       0.440761684174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440778089872
                                         uncertainty =       0.001894842173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440778089872
                                         uncertainty =       0.001894842173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469447379
  error estimate for blocks of size 2^( 2) =       0.000493862575
  error estimate for blocks of size 2^( 3) =       0.000515486902
  error estimate for blocks of size 2^( 4) =       0.000531864059
  error estimate for blocks of size 2^( 5) =       0.000541941470
  error estimate for blocks of size 2^( 6) =       0.000547473329
  error estimate for blocks of size 2^( 7) =       0.000548863206

      target function =      -0.744471244594
              le_mean =     -22.661750040141
             les_mean =     514.005956490736
             stat err =       0.000542535516
             autocorr =       1.335618754387
   target nu stat err =       0.000542535516
   target dn stat err =       0.002859080430
      target stat err =       0.002418682583
              std dev =       0.663898850861
             le_variance =       0.440761684174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440778089872
                                         uncertainty =       0.001894842173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440778089872
                                         uncertainty =       0.001894842173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469447379
  error estimate for blocks of size 2^( 2) =       0.000493862575
  error estimate for blocks of size 2^( 3) =       0.000515486902
  error estimate for blocks of size 2^( 4) =       0.000531864059
  error estimate for blocks of size 2^( 5) =       0.000541941470
  error estimate for blocks of size 2^( 6) =       0.000547473329
  error estimate for blocks of size 2^( 7) =       0.000548863206

      target function =      -0.744471244594
              le_mean =     -22.661750040141
             les_mean =     514.005956490736
             stat err =       0.000542535516
             autocorr =       1.335618754385
   target nu stat err =       0.000542535516
   target dn stat err =       0.002859080430
      target stat err =       0.002418682583
              std dev =       0.663898850861
             le_variance =       0.440761684174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440778089872
                                         uncertainty =       0.001894842173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440778089872
                                         uncertainty =       0.001894842173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469447379
  error estimate for blocks of size 2^( 2) =       0.000493862575
  error estimate for blocks of size 2^( 3) =       0.000515486902
  error estimate for blocks of size 2^( 4) =       0.000531864059
  error estimate for blocks of size 2^( 5) =       0.000541941470
  error estimate for blocks of size 2^( 6) =       0.000547473329
  error estimate for blocks of size 2^( 7) =       0.000548863206

      target function =      -0.744471244594
              le_mean =     -22.661750040141
             les_mean =     514.005956490736
             stat err =       0.000542535516
             autocorr =       1.335618754389
   target nu stat err =       0.000542535516
   target dn stat err =       0.002859080430
      target stat err =       0.002418682583
              std dev =       0.663898850861
             le_variance =       0.440761684174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.744471244594        initial  <--
     2.1176e+09     2.1176e+10             1.0431e-13        -0.744471244594
     8.4703e+09     8.4703e+10             2.6076e-14        -0.744471244594
     3.3881e+10     3.3881e+11             6.5176e-15        -0.744471244594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4247
  </log>
  <optVariables href="FORM2.s082.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2656e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.6739
    reference variance = 0.550376
====================================================
  Execution time = 2.7609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4739e-01
  Total weights = 1.955257479e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439110800803
                                         uncertainty =       0.001886290695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439110800803
                                         uncertainty =       0.001886290695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468571540
  error estimate for blocks of size 2^( 2) =       0.000492622144
  error estimate for blocks of size 2^( 3) =       0.000515307503
  error estimate for blocks of size 2^( 4) =       0.000531945690
  error estimate for blocks of size 2^( 5) =       0.000539634683
  error estimate for blocks of size 2^( 6) =       0.000543707758
  error estimate for blocks of size 2^( 7) =       0.000548198819

      target function =      -0.747481477993
              le_mean =     -22.661978429855
             les_mean =     514.012657085313
             stat err =       0.000540871737
             autocorr =       1.332406560575
   target nu stat err =       0.000540871737
   target dn stat err =       0.002289199915
      target stat err =       0.001984709771
              std dev =       0.662660227393
             le_variance =       0.439118576968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266197842986e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+10, overlap shift 2.1176e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747485774965       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747485774965       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747485774965       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747485774965       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747485775338       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747485774975       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747453518275       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747511135315       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747494045664       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747460153805       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747553390164       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747491528010       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747467575859       residual = 8.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747403487999       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747588011078       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747499698746       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747491281624       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.747482600159       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747474047902       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747461691233       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747488691854       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747476653621       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747256584170       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747940213978       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.747384279463       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747119517127       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.740717801643       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749473281021       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.746365215210       residual = 5.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749259438736       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749269480264       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.755577615254       residual = 3.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.749688700766       residual = 4.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.814362935214       residual = 2.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.747905449976       residual = 9.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.685859238359       residual = 2.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.747949266876       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.780699606588       residual = 2.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       0.492332505974       residual = 9.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.959274383652       residual = 3.80e+03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.697025900042       residual = 1.41e+03           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.543116861408       residual = 7.40e+02           smallest_sin_value = 9.98e-01
davidson iteration   42:   krylov dim =  43   tar_fn =       0.012611689287       residual = 1.21e+03           smallest_sin_value = 9.92e-01
davidson iteration   43 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         43 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+10 is 1.176009e-14

solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747485774965       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747485774965       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747485774965       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747489902372       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747474044302       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747366275557       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747460570160       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747599649655       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747592163777       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.747579671120       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747454220611       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747440773023       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747456891865       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747394994991       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747473449871       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747685453493       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747750970915       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746632887595       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747487604172       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747438696712       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746831023744       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.746107586865       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746481233298       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749362115040       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745154094380       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745424488708       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.721571891517       residual = 9.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.763705384277       residual = 1.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.645726062509       residual = 1.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.793872667390       residual = 3.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.540565580417       residual = 1.40e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936487054342       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.750174714797       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+10 is 2.956685e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.3881e+11, overlap shift 3.3881e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747485774965       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747485774965       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747485774965       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747569957962       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747608929285       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747480162138       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747558111850       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747153963412       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747686047007       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746988299304       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747766715623       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.747981096347       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747533705693       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747584353262       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746313711358       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746969068322       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747815474281       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746633306360       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.748687870130       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.747325271059       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.747690451789       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.748454385874       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.750340381447       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746817817528       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.745912690428       residual = 3.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747372072024       residual = 9.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.746355811880       residual = 7.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.707592830370       residual = 3.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743731981350       residual = 7.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741144179203       residual = 9.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.767606586469       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.752611339107       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.732389502266       residual = 8.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.926994144661       residual = 4.14e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.045093850680       residual = 7.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.798525446175       residual = 5.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -2.189028979422       residual = 2.06e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -9.802194293330       residual = 2.48e+05           smallest_sin_value = 9.98e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.584019214360       residual = 1.68e+04           smallest_sin_value = 9.97e-01
davidson iteration   39 stopping due to too large eigenvalue change
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3881e+11 is 7.260347e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.254709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2403e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -22.7507
    reference variance = 0.475872
====================================================
  Execution time = 2.5325e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5344e-01
  Total weights = 1.9552e+06
  Execution time = 3.6358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443934615146
                                         uncertainty =       0.002342815009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443934615146
                                         uncertainty =       0.002342815009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471115815
  error estimate for blocks of size 2^( 2) =       0.000494938849
  error estimate for blocks of size 2^( 3) =       0.000517192708
  error estimate for blocks of size 2^( 4) =       0.000532712731
  error estimate for blocks of size 2^( 5) =       0.000541259394
  error estimate for blocks of size 2^( 6) =       0.000545919290
  error estimate for blocks of size 2^( 7) =       0.000549652395

      target function =      -0.742511501074
              le_mean =     -22.661606793222
             les_mean =     514.001858734803
             stat err =       0.000542385952
             autocorr =       1.325444352602
   target nu stat err =       0.000542385952
   target dn stat err =       0.003091253178
      target stat err =       0.002589623982
              std dev =       0.666258375072
             le_variance =       0.443900222353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443934615146
                                         uncertainty =       0.002342815009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443934615146
                                         uncertainty =       0.002342815009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471115815
  error estimate for blocks of size 2^( 2) =       0.000494938849
  error estimate for blocks of size 2^( 3) =       0.000517192708
  error estimate for blocks of size 2^( 4) =       0.000532712731
  error estimate for blocks of size 2^( 5) =       0.000541259394
  error estimate for blocks of size 2^( 6) =       0.000545919290
  error estimate for blocks of size 2^( 7) =       0.000549652395

      target function =      -0.742511501074
              le_mean =     -22.661606793222
             les_mean =     514.001858734804
             stat err =       0.000542385952
             autocorr =       1.325444352602
   target nu stat err =       0.000542385952
   target dn stat err =       0.003091253178
      target stat err =       0.002589623982
              std dev =       0.666258375072
             le_variance =       0.443900222353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443934615146
                                         uncertainty =       0.002342815009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443934615146
                                         uncertainty =       0.002342815009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471115815
  error estimate for blocks of size 2^( 2) =       0.000494938849
  error estimate for blocks of size 2^( 3) =       0.000517192708
  error estimate for blocks of size 2^( 4) =       0.000532712731
  error estimate for blocks of size 2^( 5) =       0.000541259394
  error estimate for blocks of size 2^( 6) =       0.000545919290
  error estimate for blocks of size 2^( 7) =       0.000549652395

      target function =      -0.742511501074
              le_mean =     -22.661606793222
             les_mean =     514.001858734804
             stat err =       0.000542385952
             autocorr =       1.325444352604
   target nu stat err =       0.000542385952
   target dn stat err =       0.003091253178
      target stat err =       0.002589623982
              std dev =       0.666258375072
             le_variance =       0.443900222353

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443934615146
                                         uncertainty =       0.002342815009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443934615146
                                         uncertainty =       0.002342815009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471115815
  error estimate for blocks of size 2^( 2) =       0.000494938849
  error estimate for blocks of size 2^( 3) =       0.000517192708
  error estimate for blocks of size 2^( 4) =       0.000532712731
  error estimate for blocks of size 2^( 5) =       0.000541259394
  error estimate for blocks of size 2^( 6) =       0.000545919290
  error estimate for blocks of size 2^( 7) =       0.000549652395

      target function =      -0.742511501074
              le_mean =     -22.661606793222
             les_mean =     514.001858734804
             stat err =       0.000542385952
             autocorr =       1.325444352598
   target nu stat err =       0.000542385952
   target dn stat err =       0.003091253178
      target stat err =       0.002589623982
              std dev =       0.666258375072
             le_variance =       0.443900222353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.742511501074        initial
     2.1176e+10     2.1176e+11             1.1760e-14        -0.742511501074  <--
     8.4703e+10     8.4703e+11             2.9567e-15        -0.742511501074
     3.3881e+11     3.3881e+12             7.2603e-16        -0.742511501074

*****************************************************************************
Applying the update for shift_i =   2.1176e+10     and shift_s =   2.1176e+11
*****************************************************************************

  Execution time = 4.3566e+01
  </log>
  <optVariables href="FORM2.s083.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.7462
    reference variance = 1.26423
====================================================
  Execution time = 2.5872e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4501e-01
  Total weights = 1.955600178e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438469778502
                                         uncertainty =       0.001818380705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438469778502
                                         uncertainty =       0.001818380705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468210007
  error estimate for blocks of size 2^( 2) =       0.000491910002
  error estimate for blocks of size 2^( 3) =       0.000514178080
  error estimate for blocks of size 2^( 4) =       0.000529980734
  error estimate for blocks of size 2^( 5) =       0.000540948244
  error estimate for blocks of size 2^( 6) =       0.000546376852
  error estimate for blocks of size 2^( 7) =       0.000547312585

      target function =      -0.749448917400
              le_mean =     -22.661630357347
             les_mean =     513.994501663775
             stat err =       0.000541154604
             autocorr =       1.335861188235
   target nu stat err =       0.000541154604
   target dn stat err =       0.002218261150
      target stat err =       0.001937651159
              std dev =       0.662148941805
             le_variance =       0.438441221134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266163035735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.2940e+09, overlap shift 5.2940e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749452916049       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749452916049       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749452916049       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749452916049       residual = 7.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749455671034       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749452926464       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749448487090       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749456956048       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749460867256       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749453237167       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749447869528       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749449047557       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+09 is 3.446900e-14

solving harmonic davidson linear method for identity shift 2.1176e+10, overlap shift 2.1176e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749452916049       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749452916049       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749452916049       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749452916049       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749452916042       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749453795071       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749452926787       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749451156453       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749443489268       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749371076668       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749418197624       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749425997198       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749453531799       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749461726077       residual = 7.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749458078149       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749378326190       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749448245081       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749458082202       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749467112529       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.751905427994       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.749437425513       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749561210027       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749527550731       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749618797221       residual = 6.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749240487680       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.749483580380       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.749247782506       residual = 8.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.749667609041       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.749502331299       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.749729150643       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.749155050282       residual = 2.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.734315438908       residual = 3.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747089138922       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.712350946002       residual = 3.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.599191359082       residual = 1.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.235309912655       residual = 2.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.998703029070       residual = 6.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.911699671255       residual = 2.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.417108279642       residual = 1.03e+04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =       0.271954151537       residual = 1.12e+05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -5.625172792524       residual = 1.76e+05           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =       0.266200756754       residual = 2.06e+07           smallest_sin_value = 9.97e-01
davidson iteration   42 stopping due to too large eigenvalue change
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+10 is 8.617182e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.4703e+10, overlap shift 8.4703e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.749452916049       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.749452916049       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.749452916049       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.749412514084       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.749511872101       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.749452916049       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.749479061036       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.749364240136       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.749419075975       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.749370313327       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749635299703       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.749597352488       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749448638546       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.749304674939       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749523425104       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.749469842860       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.749459422531       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749407219737       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.749016168109       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.750094171001       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.748543225750       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.749415109407       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.749196748093       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749771969400       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.749201961501       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.750320970947       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.791125917601       residual = 3.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.795717882610       residual = 9.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.882834185554       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.714729006534       residual = 1.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.762750670391       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.696644077439       residual = 5.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.664246528521       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.270939934320       residual = 1.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.469617082068       residual = 5.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -2.924701716181       residual = 5.95e+04           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.4703e+10 is 2.163128e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.304473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0665e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -22.6116
    reference variance = 0.849123
====================================================
  Execution time = 2.5092e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5449e-01
  Total weights = 1.9549e+06
  Execution time = 3.6270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443570555066
                                         uncertainty =       0.002772364042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443570555066
                                         uncertainty =       0.002772364042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470893760
  error estimate for blocks of size 2^( 2) =       0.000495062829
  error estimate for blocks of size 2^( 3) =       0.000517660691
  error estimate for blocks of size 2^( 4) =       0.000533920050
  error estimate for blocks of size 2^( 5) =       0.000545266564
  error estimate for blocks of size 2^( 6) =       0.000547643312
  error estimate for blocks of size 2^( 7) =       0.000551846068

      target function =      -0.741653972278
              le_mean =     -22.661835554063
             les_mean =     514.013280205200
             stat err =       0.000544668999
             autocorr =       1.337887024964
   target nu stat err =       0.000544668999
   target dn stat err =       0.003188092408
      target stat err =       0.002661981568
              std dev =       0.665944342391
             le_variance =       0.443481867162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443570555066
                                         uncertainty =       0.002772364042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443570555066
                                         uncertainty =       0.002772364042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470893760
  error estimate for blocks of size 2^( 2) =       0.000495062829
  error estimate for blocks of size 2^( 3) =       0.000517660691
  error estimate for blocks of size 2^( 4) =       0.000533920050
  error estimate for blocks of size 2^( 5) =       0.000545266564
  error estimate for blocks of size 2^( 6) =       0.000547643312
  error estimate for blocks of size 2^( 7) =       0.000551846068

      target function =      -0.741653972278
              le_mean =     -22.661835554063
             les_mean =     514.013280205200
             stat err =       0.000544668999
             autocorr =       1.337887024964
   target nu stat err =       0.000544668999
   target dn stat err =       0.003188092408
      target stat err =       0.002661981568
              std dev =       0.665944342391
             le_variance =       0.443481867162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443570555066
                                         uncertainty =       0.002772364042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443570555066
                                         uncertainty =       0.002772364042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470893760
  error estimate for blocks of size 2^( 2) =       0.000495062829
  error estimate for blocks of size 2^( 3) =       0.000517660691
  error estimate for blocks of size 2^( 4) =       0.000533920050
  error estimate for blocks of size 2^( 5) =       0.000545266564
  error estimate for blocks of size 2^( 6) =       0.000547643312
  error estimate for blocks of size 2^( 7) =       0.000551846068

      target function =      -0.741653972278
              le_mean =     -22.661835554063
             les_mean =     514.013280205200
             stat err =       0.000544668999
             autocorr =       1.337887024964
   target nu stat err =       0.000544668999
   target dn stat err =       0.003188092408
      target stat err =       0.002661981568
              std dev =       0.665944342391
             le_variance =       0.443481867162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443570555066
                                         uncertainty =       0.002772364042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.443570555066
                                         uncertainty =       0.002772364042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470893760
  error estimate for blocks of size 2^( 2) =       0.000495062829
  error estimate for blocks of size 2^( 3) =       0.000517660691
  error estimate for blocks of size 2^( 4) =       0.000533920050
  error estimate for blocks of size 2^( 5) =       0.000545266564
  error estimate for blocks of size 2^( 6) =       0.000547643312
  error estimate for blocks of size 2^( 7) =       0.000551846068

      target function =      -0.741653972278
              le_mean =     -22.661835554063
             les_mean =     514.013280205200
             stat err =       0.000544668999
             autocorr =       1.337887024962
   target nu stat err =       0.000544668999
   target dn stat err =       0.003188092408
      target stat err =       0.002661981568
              std dev =       0.665944342391
             le_variance =       0.443481867162


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741653972278        initial
     5.2940e+09     5.2940e+10             3.4469e-14        -0.741653972278  <--
     2.1176e+10     2.1176e+11             8.6172e-15        -0.741653972278
     8.4703e+10     8.4703e+11             2.1631e-15        -0.741653972278

*****************************************************************************
Applying the update for shift_i =   5.2940e+09     and shift_s =   5.2940e+10
*****************************************************************************

  Execution time = 4.3316e+01
  </log>
  <optVariables href="FORM2.s084.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3988e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.7036
    reference variance = 0.309343
====================================================
  Execution time = 2.5777e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5324e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4899e-01
  Total weights = 1.955481292e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440311517697
                                         uncertainty =       0.002868230145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440311517697
                                         uncertainty =       0.002868230145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469234417
  error estimate for blocks of size 2^( 2) =       0.000492897217
  error estimate for blocks of size 2^( 3) =       0.000514309509
  error estimate for blocks of size 2^( 4) =       0.000530365970
  error estimate for blocks of size 2^( 5) =       0.000539686775
  error estimate for blocks of size 2^( 6) =       0.000545166622
  error estimate for blocks of size 2^( 7) =       0.000547771574

      target function =      -0.746162224399
              le_mean =     -22.662288333992
             les_mean =     514.028297760446
             stat err =       0.000540747735
             autocorr =       1.328035550428
   target nu stat err =       0.000540747735
   target dn stat err =       0.003499426787
      target stat err =       0.002945223681
              std dev =       0.663597676508
             le_variance =       0.440361876267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266228833399e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3235e+09, overlap shift 1.3235e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746172836341       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746172836341       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746172836341       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746172836341       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746172980356       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746174295733       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746172652614       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746175293435       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746172817101       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746176623444       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746171647159       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+09 is 1.991286e-13

solving harmonic davidson linear method for identity shift 5.2940e+09, overlap shift 5.2940e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746172836341       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746172836341       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746172836341       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746174116426       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746173665208       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746172836341       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746173521104       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746177012773       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746150009000       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746192007217       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746177169717       residual = 9.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+09 is 4.967671e-14

solving harmonic davidson linear method for identity shift 2.1176e+10, overlap shift 2.1176e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746172836341       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746172836341       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746172836341       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746180106907       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746143680223       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746167597219       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746128723377       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746192197668       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746220449399       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746122035500       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746164452998       residual = 5.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746202888019       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.746198432620       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746224111937       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746209372819       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746149740983       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746200801948       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.746169037452       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746149155977       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746336141221       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744925038312       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744452616220       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742039327430       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742118116831       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.751587263504       residual = 6.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.731749480993       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.737307145500       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.739826734096       residual = 6.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.739984857647       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747012599918       residual = 3.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.731317096744       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.797387116842       residual = 8.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.784961441549       residual = 5.85e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.430199401294       residual = 7.54e+06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.836702377310       residual = 1.70e+10           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -3.615391007150       residual = 1.17e+09           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.1176e+10 is 1.296421e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.326070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0548e+01
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -22.559
    reference variance = 0.284617
====================================================
  Execution time = 2.5103e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2660e+01
  VMC Evar = 4.5743e-01
  Total weights = 1.9554e+06
  Execution time = 3.6329e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447261895134
                                         uncertainty =       0.003287125653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447261895134
                                         uncertainty =       0.003287125653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472888306
  error estimate for blocks of size 2^( 2) =       0.000496402462
  error estimate for blocks of size 2^( 3) =       0.000517832681
  error estimate for blocks of size 2^( 4) =       0.000533435429
  error estimate for blocks of size 2^( 5) =       0.000542939304
  error estimate for blocks of size 2^( 6) =       0.000546121701
  error estimate for blocks of size 2^( 7) =       0.000547632916

      target function =      -0.739258879627
              le_mean =     -22.660415439316
             les_mean =     513.951859975818
             stat err =       0.000542532338
             autocorr =       1.316237042431
   target nu stat err =       0.000542532338
   target dn stat err =       0.004382380061
      target stat err =       0.003584645045
              std dev =       0.668765056441
             le_variance =       0.447246700717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447261895134
                                         uncertainty =       0.003287125653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447261895134
                                         uncertainty =       0.003287125653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472888306
  error estimate for blocks of size 2^( 2) =       0.000496402462
  error estimate for blocks of size 2^( 3) =       0.000517832681
  error estimate for blocks of size 2^( 4) =       0.000533435429
  error estimate for blocks of size 2^( 5) =       0.000542939304
  error estimate for blocks of size 2^( 6) =       0.000546121701
  error estimate for blocks of size 2^( 7) =       0.000547632916

      target function =      -0.739258879629
              le_mean =     -22.660415439316
             les_mean =     513.951859975816
             stat err =       0.000542532338
             autocorr =       1.316237042430
   target nu stat err =       0.000542532338
   target dn stat err =       0.004382380061
      target stat err =       0.003584645045
              std dev =       0.668765056441
             le_variance =       0.447246700717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447261895134
                                         uncertainty =       0.003287125653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447261895134
                                         uncertainty =       0.003287125653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472888306
  error estimate for blocks of size 2^( 2) =       0.000496402462
  error estimate for blocks of size 2^( 3) =       0.000517832681
  error estimate for blocks of size 2^( 4) =       0.000533435429
  error estimate for blocks of size 2^( 5) =       0.000542939304
  error estimate for blocks of size 2^( 6) =       0.000546121701
  error estimate for blocks of size 2^( 7) =       0.000547632916

      target function =      -0.739258879628
              le_mean =     -22.660415439316
             les_mean =     513.951859975817
             stat err =       0.000542532338
             autocorr =       1.316237042430
   target nu stat err =       0.000542532338
   target dn stat err =       0.004382380061
      target stat err =       0.003584645045
              std dev =       0.668765056441
             le_variance =       0.447246700717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447261895134
                                         uncertainty =       0.003287125653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447261895134
                                         uncertainty =       0.003287125653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472888306
  error estimate for blocks of size 2^( 2) =       0.000496402462
  error estimate for blocks of size 2^( 3) =       0.000517832681
  error estimate for blocks of size 2^( 4) =       0.000533435429
  error estimate for blocks of size 2^( 5) =       0.000542939304
  error estimate for blocks of size 2^( 6) =       0.000546121701
  error estimate for blocks of size 2^( 7) =       0.000547632916

      target function =      -0.739258879627
              le_mean =     -22.660415439316
             les_mean =     513.951859975817
             stat err =       0.000542532338
             autocorr =       1.316237042432
   target nu stat err =       0.000542532338
   target dn stat err =       0.004382380061
      target stat err =       0.003584645045
              std dev =       0.668765056441
             le_variance =       0.447246700717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739258879627        initial
     1.3235e+09     1.3235e+10             1.9913e-13        -0.739258879629  <--
     5.2940e+09     5.2940e+10             4.9677e-14        -0.739258879628
     2.1176e+10     2.1176e+11             1.2964e-14        -0.739258879627

*****************************************************************************
Applying the update for shift_i =   1.3235e+09     and shift_s =   1.3235e+10
*****************************************************************************

  Execution time = 4.3295e+01
  </log>
  <optVariables href="FORM2.s085.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.3861e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.6227
    reference variance = 0.395433
====================================================
  Execution time = 2.5826e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5102e-01
  Total weights = 1.955049151e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439586345110
                                         uncertainty =       0.002147066324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439586345110
                                         uncertainty =       0.002147066324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468866948
  error estimate for blocks of size 2^( 2) =       0.000492918069
  error estimate for blocks of size 2^( 3) =       0.000515724479
  error estimate for blocks of size 2^( 4) =       0.000532125757
  error estimate for blocks of size 2^( 5) =       0.000541017799
  error estimate for blocks of size 2^( 6) =       0.000545486282
  error estimate for blocks of size 2^( 7) =       0.000548651477

      target function =      -0.744486872034
              le_mean =     -22.661482455018
             les_mean =     513.993804085157
             stat err =       0.000541820329
             autocorr =       1.335399942184
   target nu stat err =       0.000541820329
   target dn stat err =       0.003319048511
      target stat err =       0.002784471207
              std dev =       0.663077996627
             le_variance =       0.439672429612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266148245502e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+08, overlap shift 3.3087e+09 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744496278731       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744496278731       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744496278731       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744496278731       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744496280072       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744496116537       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744496278731       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744496938545       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744496007663       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744495629213       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+08 is 6.737842e-13

solving harmonic davidson linear method for identity shift 1.3235e+09, overlap shift 1.3235e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744496278731       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744496278731       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744496278731       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744496283685       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744495448094       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744496278731       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744496278731       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744496278731       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744496664056       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744496278731       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+09 is 1.684633e-13

solving harmonic davidson linear method for identity shift 5.2940e+09, overlap shift 5.2940e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.744496278731       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.744496278731       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.744496278731       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.744495955801       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.744496278731       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744495360304       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744496278731       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744499628581       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744486626967       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744496278731       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+09 is 4.213095e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.329648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0577e+01
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -22.6856
    reference variance = 0.280945
====================================================
  Execution time = 2.5267e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5221e-01
  Total weights = 1.9556e+06
  Execution time = 3.6296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508044096
                                         uncertainty =       0.002221810919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508044096
                                         uncertainty =       0.002221810919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469284379
  error estimate for blocks of size 2^( 2) =       0.000493268184
  error estimate for blocks of size 2^( 3) =       0.000515930920
  error estimate for blocks of size 2^( 4) =       0.000530460260
  error estimate for blocks of size 2^( 5) =       0.000539775584
  error estimate for blocks of size 2^( 6) =       0.000544885874
  error estimate for blocks of size 2^( 7) =       0.000549027405

      target function =      -0.743509438645
              le_mean =     -22.661925617512
             les_mean =     514.015080020546
             stat err =       0.000541037281
             autocorr =       1.329175068300
   target nu stat err =       0.000541037281
   target dn stat err =       0.004171063969
      target stat err =       0.003462869819
              std dev =       0.663668333754
             le_variance =       0.440455657228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508044096
                                         uncertainty =       0.002221810919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508044096
                                         uncertainty =       0.002221810919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469284379
  error estimate for blocks of size 2^( 2) =       0.000493268184
  error estimate for blocks of size 2^( 3) =       0.000515930920
  error estimate for blocks of size 2^( 4) =       0.000530460260
  error estimate for blocks of size 2^( 5) =       0.000539775584
  error estimate for blocks of size 2^( 6) =       0.000544885874
  error estimate for blocks of size 2^( 7) =       0.000549027405

      target function =      -0.743509438645
              le_mean =     -22.661925617512
             les_mean =     514.015080020547
             stat err =       0.000541037281
             autocorr =       1.329175068303
   target nu stat err =       0.000541037281
   target dn stat err =       0.004171063969
      target stat err =       0.003462869820
              std dev =       0.663668333754
             le_variance =       0.440455657228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508044096
                                         uncertainty =       0.002221810919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508044096
                                         uncertainty =       0.002221810919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469284379
  error estimate for blocks of size 2^( 2) =       0.000493268184
  error estimate for blocks of size 2^( 3) =       0.000515930920
  error estimate for blocks of size 2^( 4) =       0.000530460260
  error estimate for blocks of size 2^( 5) =       0.000539775584
  error estimate for blocks of size 2^( 6) =       0.000544885874
  error estimate for blocks of size 2^( 7) =       0.000549027405

      target function =      -0.743509438645
              le_mean =     -22.661925617512
             les_mean =     514.015080020546
             stat err =       0.000541037281
             autocorr =       1.329175068306
   target nu stat err =       0.000541037281
   target dn stat err =       0.004171063969
      target stat err =       0.003462869820
              std dev =       0.663668333754
             le_variance =       0.440455657228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508044096
                                         uncertainty =       0.002221810919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440508044096
                                         uncertainty =       0.002221810919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469284379
  error estimate for blocks of size 2^( 2) =       0.000493268184
  error estimate for blocks of size 2^( 3) =       0.000515930920
  error estimate for blocks of size 2^( 4) =       0.000530460260
  error estimate for blocks of size 2^( 5) =       0.000539775584
  error estimate for blocks of size 2^( 6) =       0.000544885874
  error estimate for blocks of size 2^( 7) =       0.000549027405

      target function =      -0.743509438645
              le_mean =     -22.661925617512
             les_mean =     514.015080020546
             stat err =       0.000541037281
             autocorr =       1.329175068304
   target nu stat err =       0.000541037281
   target dn stat err =       0.004171063969
      target stat err =       0.003462869819
              std dev =       0.663668333754
             le_variance =       0.440455657228


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743509438645        initial  <--
     3.3087e+08     3.3087e+09             6.7378e-13        -0.743509438645
     1.3235e+09     1.3235e+10             1.6846e-13        -0.743509438645
     5.2940e+09     5.2940e+10             4.2131e-14        -0.743509438645

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4785
  </log>
  <optVariables href="FORM2.s086.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4077e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.7407
    reference variance = 0.346804
====================================================
  Execution time = 2.7755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5777e-01
  Total weights = 1.955284644e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447726227937
                                         uncertainty =       0.002424525615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.447726227937
                                         uncertainty =       0.002424525615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473125660
  error estimate for blocks of size 2^( 2) =       0.000496502835
  error estimate for blocks of size 2^( 3) =       0.000518539455
  error estimate for blocks of size 2^( 4) =       0.000534768297
  error estimate for blocks of size 2^( 5) =       0.000543760348
  error estimate for blocks of size 2^( 6) =       0.000547996015
  error estimate for blocks of size 2^( 7) =       0.000550901790

      target function =      -0.738991542584
              le_mean =     -22.663112771325
             les_mean =     514.074449549315
             stat err =       0.000544356612
             autocorr =       1.323774466044
   target nu stat err =       0.000544356612
   target dn stat err =       0.003363007536
      target stat err =       0.002786433159
              std dev =       0.669100725367
             le_variance =       0.447695780686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266311277133e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+09, overlap shift 3.3087e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739001240237       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739001240237       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739001240237       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739001240237       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739000422724       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739001902232       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739002607343       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.739003632715       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.739006724068       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739006440457       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739005282435       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738995567654       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+09 is 8.597715e-14

solving harmonic davidson linear method for identity shift 1.3235e+10, overlap shift 1.3235e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739001240237       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739001240237       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739001240237       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739001240237       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739004792103       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739001092493       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.738999873408       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738987826838       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738949560107       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739000271260       residual = 8.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.738997133689       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.739007281677       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739034787817       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.738960576623       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739022470287       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738997413883       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.738989092256       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.739006453976       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.739004661898       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+10 is 2.148833e-14

solving harmonic davidson linear method for identity shift 5.2940e+10, overlap shift 5.2940e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.739001240237       residual = 3.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.739001240237       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.739001240237       residual = 5.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.739001240237       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.739001240237       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.739001240313       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.739001358256       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.738994121413       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.738917368835       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738996020967       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739084476806       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.738826424335       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739131550496       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.738988032288       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739030177834       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738931621660       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.739038309494       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.738582416866       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742033160937       residual = 3.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.735311352724       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.739693034971       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743362111864       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.737733875491       residual = 5.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742669821296       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.740401291737       residual = 1.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.718596957792       residual = 5.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.708367109578       residual = 3.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.708098450011       residual = 2.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.790826828992       residual = 2.77e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.377778376396       residual = 3.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.061072918703       residual = 2.07e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -6.705359987786       residual = 1.95e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.621841144649       residual = 1.33e+03           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+10 is 5.344094e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.349962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2502e+01
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -22.7309
    reference variance = 0.713661
====================================================
  Execution time = 2.5279e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4830e-01
  Total weights = 1.9555e+06
  Execution time = 3.6158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665885729
                                         uncertainty =       0.003502303251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665885729
                                         uncertainty =       0.003502303251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469406901
  error estimate for blocks of size 2^( 2) =       0.000493760031
  error estimate for blocks of size 2^( 3) =       0.000515878636
  error estimate for blocks of size 2^( 4) =       0.000531283328
  error estimate for blocks of size 2^( 5) =       0.000540715998
  error estimate for blocks of size 2^( 6) =       0.000545134705
  error estimate for blocks of size 2^( 7) =       0.000546694327

      target function =      -0.746717662426
              le_mean =     -22.661407177548
             les_mean =     513.987676187580
             stat err =       0.000540957090
             autocorr =       1.328087514485
   target nu stat err =       0.000540957090
   target dn stat err =       0.003415909016
      target stat err =       0.002878343097
              std dev =       0.663841605617
             le_variance =       0.440685677349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665885729
                                         uncertainty =       0.003502303251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665885729
                                         uncertainty =       0.003502303251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469406901
  error estimate for blocks of size 2^( 2) =       0.000493760031
  error estimate for blocks of size 2^( 3) =       0.000515878636
  error estimate for blocks of size 2^( 4) =       0.000531283328
  error estimate for blocks of size 2^( 5) =       0.000540715998
  error estimate for blocks of size 2^( 6) =       0.000545134705
  error estimate for blocks of size 2^( 7) =       0.000546694327

      target function =      -0.746717662426
              le_mean =     -22.661407177548
             les_mean =     513.987676187580
             stat err =       0.000540957090
             autocorr =       1.328087514483
   target nu stat err =       0.000540957090
   target dn stat err =       0.003415909016
      target stat err =       0.002878343097
              std dev =       0.663841605617
             le_variance =       0.440685677349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665885729
                                         uncertainty =       0.003502303251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665885729
                                         uncertainty =       0.003502303251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469406901
  error estimate for blocks of size 2^( 2) =       0.000493760031
  error estimate for blocks of size 2^( 3) =       0.000515878636
  error estimate for blocks of size 2^( 4) =       0.000531283328
  error estimate for blocks of size 2^( 5) =       0.000540715998
  error estimate for blocks of size 2^( 6) =       0.000545134705
  error estimate for blocks of size 2^( 7) =       0.000546694327

      target function =      -0.746717662426
              le_mean =     -22.661407177548
             les_mean =     513.987676187580
             stat err =       0.000540957090
             autocorr =       1.328087514483
   target nu stat err =       0.000540957090
   target dn stat err =       0.003415909016
      target stat err =       0.002878343097
              std dev =       0.663841605617
             le_variance =       0.440685677349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665885729
                                         uncertainty =       0.003502303251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440665885729
                                         uncertainty =       0.003502303251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469406901
  error estimate for blocks of size 2^( 2) =       0.000493760031
  error estimate for blocks of size 2^( 3) =       0.000515878636
  error estimate for blocks of size 2^( 4) =       0.000531283328
  error estimate for blocks of size 2^( 5) =       0.000540715998
  error estimate for blocks of size 2^( 6) =       0.000545134705
  error estimate for blocks of size 2^( 7) =       0.000546694327

      target function =      -0.746717662426
              le_mean =     -22.661407177548
             les_mean =     513.987676187580
             stat err =       0.000540957090
             autocorr =       1.328087514485
   target nu stat err =       0.000540957090
   target dn stat err =       0.003415909016
      target stat err =       0.002878343097
              std dev =       0.663841605617
             le_variance =       0.440685677349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746717662426        initial  <--
     3.3087e+09     3.3087e+10             8.5977e-14        -0.746717662426
     1.3235e+10     1.3235e+11             2.1488e-14        -0.746717662426
     5.2940e+10     5.2940e+11             5.3441e-15        -0.746717662426

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4307
  </log>
  <optVariables href="FORM2.s087.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.5728
    reference variance = 0.461296
====================================================
  Execution time = 2.6061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5166e-01
  Total weights = 1.955741233e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440227335687
                                         uncertainty =       0.002725772552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440227335687
                                         uncertainty =       0.002725772552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469160982
  error estimate for blocks of size 2^( 2) =       0.000492841956
  error estimate for blocks of size 2^( 3) =       0.000514698373
  error estimate for blocks of size 2^( 4) =       0.000530514465
  error estimate for blocks of size 2^( 5) =       0.000539741220
  error estimate for blocks of size 2^( 6) =       0.000544478818
  error estimate for blocks of size 2^( 7) =       0.000547533667

      target function =      -0.743961264879
              le_mean =     -22.661945780461
             les_mean =     514.015445954396
             stat err =       0.000540567043
             autocorr =       1.327563657201
   target nu stat err =       0.000540567043
   target dn stat err =       0.003725694412
      target stat err =       0.003108356004
              std dev =       0.663493823599
             le_variance =       0.440224053954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266194578046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+10, overlap shift 3.3087e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743973331883       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743973331883       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743973331883       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743973331883       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743967020481       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743957092027       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744011956500       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744001040526       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743934035312       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743994408138       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743992535608       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744024764065       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744074953079       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743979510585       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743932819266       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743969023643       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743972909047       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744058478975       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743867795225       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744110001393       residual = 6.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743868933843       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743524251536       residual = 6.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745315876454       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.749702060787       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.741771763351       residual = 1.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745113022208       residual = 8.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.770155732518       residual = 6.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.777853578105       residual = 5.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.747639534546       residual = 3.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.776118991815       residual = 5.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.738185920764       residual = 1.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.089501911610       residual = 1.67e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.971222809480       residual = 3.03e+03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -8.493119075358       residual = 2.44e+04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -2.694737429864       residual = 7.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   35 stopping due to too large eigenvalue change
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+10 is 1.031593e-14

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+11, overlap shift 1.3235e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743973331883       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743973331883       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743973331883       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743973331883       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743876999983       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743973331883       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744045271322       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743874175443       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.744061684567       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743802231666       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744129216874       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743910991612       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744043922924       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744097367073       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744042009676       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.744521891788       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748000518219       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.730158538750       residual = 7.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745508509641       residual = 9.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.722390228453       residual = 2.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.827645031386       residual = 3.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.324739358010       residual = 7.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.546613238201       residual = 1.87e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -2.220212936697       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       4.783907080714       residual = 1.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -4.008184679534       residual = 5.59e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       1.081289859718       residual = 2.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.723386469868       residual = 3.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       0.268745972153       residual = 5.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       0.375055165647       residual = 4.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       4.734729618813       residual = 8.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       2.700649497404       residual = 1.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+11 is 2.593564e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.2940e+11, overlap shift 5.2940e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743973331883       residual = 7.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743973331883       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743973331883       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743973331883       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743973331804       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743973331877       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744019962618       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.744243909277       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743242121734       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741110747512       residual = 8.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743671415019       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743312298531       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744151413623       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744050204340       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743684587315       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742996684883       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.731211007945       residual = 6.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.725438652084       residual = 4.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.783561336146       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.731220561413       residual = 5.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.759395106372       residual = 2.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.901921923535       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.689604934874       residual = 4.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.628061307133       residual = 1.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -3.160111552436       residual = 1.59e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -3.109544753137       residual = 1.49e+04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.891880712053       residual = 1.83e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       8.564068192440       residual = 8.41e+04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -8.576253411136       residual = 2.41e+04           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to too large eigenvalue change
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+11 is 6.489565e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.391568 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0849e+01
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -22.6317
    reference variance = 0.340864
====================================================
  Execution time = 2.5129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4886e-01
  Total weights = 1.9554e+06
  Execution time = 3.6219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440542975560
                                         uncertainty =       0.001970015532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440542975560
                                         uncertainty =       0.001970015532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469310026
  error estimate for blocks of size 2^( 2) =       0.000493106665
  error estimate for blocks of size 2^( 3) =       0.000515375835
  error estimate for blocks of size 2^( 4) =       0.000531632972
  error estimate for blocks of size 2^( 5) =       0.000540766540
  error estimate for blocks of size 2^( 6) =       0.000546151065
  error estimate for blocks of size 2^( 7) =       0.000551381940

      target function =      -0.746268322807
              le_mean =     -22.662151049231
             les_mean =     514.021951911630
             stat err =       0.000542483129
             autocorr =       1.336142595240
   target nu stat err =       0.000542483129
   target dn stat err =       0.002453518317
      target stat err =       0.002109088812
              std dev =       0.663704603236
             le_variance =       0.440503800357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440542975560
                                         uncertainty =       0.001970015532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440542975560
                                         uncertainty =       0.001970015532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469310026
  error estimate for blocks of size 2^( 2) =       0.000493106665
  error estimate for blocks of size 2^( 3) =       0.000515375835
  error estimate for blocks of size 2^( 4) =       0.000531632972
  error estimate for blocks of size 2^( 5) =       0.000540766540
  error estimate for blocks of size 2^( 6) =       0.000546151065
  error estimate for blocks of size 2^( 7) =       0.000551381940

      target function =      -0.746268322807
              le_mean =     -22.662151049231
             les_mean =     514.021951911630
             stat err =       0.000542483129
             autocorr =       1.336142595244
   target nu stat err =       0.000542483129
   target dn stat err =       0.002453518317
      target stat err =       0.002109088812
              std dev =       0.663704603236
             le_variance =       0.440503800357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440542975560
                                         uncertainty =       0.001970015532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440542975560
                                         uncertainty =       0.001970015532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469310026
  error estimate for blocks of size 2^( 2) =       0.000493106665
  error estimate for blocks of size 2^( 3) =       0.000515375835
  error estimate for blocks of size 2^( 4) =       0.000531632972
  error estimate for blocks of size 2^( 5) =       0.000540766540
  error estimate for blocks of size 2^( 6) =       0.000546151065
  error estimate for blocks of size 2^( 7) =       0.000551381940

      target function =      -0.746268322807
              le_mean =     -22.662151049231
             les_mean =     514.021951911630
             stat err =       0.000542483129
             autocorr =       1.336142595241
   target nu stat err =       0.000542483129
   target dn stat err =       0.002453518317
      target stat err =       0.002109088812
              std dev =       0.663704603236
             le_variance =       0.440503800357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440542975560
                                         uncertainty =       0.001970015532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440542975560
                                         uncertainty =       0.001970015532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469310026
  error estimate for blocks of size 2^( 2) =       0.000493106665
  error estimate for blocks of size 2^( 3) =       0.000515375835
  error estimate for blocks of size 2^( 4) =       0.000531632972
  error estimate for blocks of size 2^( 5) =       0.000540766540
  error estimate for blocks of size 2^( 6) =       0.000546151065
  error estimate for blocks of size 2^( 7) =       0.000551381940

      target function =      -0.746268322807
              le_mean =     -22.662151049231
             les_mean =     514.021951911630
             stat err =       0.000542483129
             autocorr =       1.336142595241
   target nu stat err =       0.000542483129
   target dn stat err =       0.002453518317
      target stat err =       0.002109088812
              std dev =       0.663704603236
             le_variance =       0.440503800357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746268322807        initial
     3.3087e+10     3.3087e+11             1.0316e-14        -0.746268322807  <--
     1.3235e+11     1.3235e+12             2.5936e-15        -0.746268322807
     5.2940e+11     5.2940e+12             6.4896e-16        -0.746268322807

*****************************************************************************
Applying the update for shift_i =   3.3087e+10     and shift_s =   3.3087e+11
*****************************************************************************

  Execution time = 4.3325e+01
  </log>
  <optVariables href="FORM2.s088.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4181e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2657e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.778
    reference variance = 0.410381
====================================================
  Execution time = 2.6080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5319e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6267e-01
  Total weights = 1.955258346e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442904652727
                                         uncertainty =       0.002628962013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442904652727
                                         uncertainty =       0.002628962013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470598304
  error estimate for blocks of size 2^( 2) =       0.000494593258
  error estimate for blocks of size 2^( 3) =       0.000516378826
  error estimate for blocks of size 2^( 4) =       0.000532331184
  error estimate for blocks of size 2^( 5) =       0.000540709339
  error estimate for blocks of size 2^( 6) =       0.000545226247
  error estimate for blocks of size 2^( 7) =       0.000549063447

      target function =      -0.734998722971
              le_mean =     -22.662162369098
             les_mean =     514.036275124437
             stat err =       0.000541832554
             autocorr =       1.325651823025
   target nu stat err =       0.000541832554
   target dn stat err =       0.008537791768
      target stat err =       0.006852008428
              std dev =       0.665526504402
             le_variance =       0.442925528061


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266216236910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+09, overlap shift 8.2718e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735061805702       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735061805702       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735061805702       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735063503567       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735062627689       residual = 7.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735061163891       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735066277337       residual = 9.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735051588237       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735061805702       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735055214411       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735070416532       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735048459556       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.735057094966       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.735052899260       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.735093575056       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.735102034011       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.735082305912       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+09 is 3.609715e-14

solving harmonic davidson linear method for identity shift 3.3087e+10, overlap shift 3.3087e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735061805702       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735061805702       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735061805702       residual = 9.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735061805702       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.735061805702       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735061805702       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735067782396       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.735142363417       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735029609313       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.735152568892       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735025045568       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.734959634200       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.735083898124       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.735019878494       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.735200173011       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.735102654803       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.735050511820       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.734944289958       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.735011482323       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.735063720421       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.735044635193       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.735367000404       residual = 8.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.733918196714       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.736582864617       residual = 8.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.735145709961       residual = 5.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.738649803752       residual = 3.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.735391384440       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.726101783044       residual = 5.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.807598259438       residual = 2.86e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743675303194       residual = 6.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.803541074693       residual = 4.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.330893951448       residual = 3.28e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.685313853520       residual = 2.44e+04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       8.481023203742       residual = 3.86e+05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.193084443201       residual = 1.17e+05           smallest_sin_value = 1.00e+00
davidson iteration   35 stopping due to too large eigenvalue change
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+10 is 9.014189e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+11, overlap shift 1.3235e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.735061805702       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.735061805702       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.735061805702       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.735061805702       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.734914400232       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.735022312494       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.735055855753       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.734911319712       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.735174753497       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.734876129551       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.734825177610       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.735182190342       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.735155104722       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.735087645729       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.735211404136       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.735006760752       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.735109998472       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.735051080945       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.734999318056       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.735117337279       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.735324772590       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.740352739056       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.732261511453       residual = 6.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.742674421307       residual = 9.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.735758824447       residual = 3.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.734036292829       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743961553203       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.735191880527       residual = 4.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.722600429095       residual = 3.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.828365149903       residual = 5.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.735160428859       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.840971188402       residual = 2.51e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.775504998729       residual = 5.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.651460391997       residual = 1.00e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       5.348722588348       residual = 2.86e+04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.223585015853       residual = 1.90e+05           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+11 is 2.245683e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.430436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0833e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -22.7582
    reference variance = 0.399335
====================================================
  Execution time = 2.5385e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5195e-01
  Total weights = 1.9553e+06
  Execution time = 3.6368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441033712862
                                         uncertainty =       0.002837927808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441033712862
                                         uncertainty =       0.002837927808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469561444
  error estimate for blocks of size 2^( 2) =       0.000493776939
  error estimate for blocks of size 2^( 3) =       0.000515870013
  error estimate for blocks of size 2^( 4) =       0.000532292115
  error estimate for blocks of size 2^( 5) =       0.000542039005
  error estimate for blocks of size 2^( 6) =       0.000545533792
  error estimate for blocks of size 2^( 7) =       0.000548667465

      target function =      -0.743724996295
              le_mean =     -22.661785824995
             les_mean =     514.008482987850
             stat err =       0.000542133094
             autocorr =       1.332990267926
   target nu stat err =       0.000542133094
   target dn stat err =       0.003795441757
      target stat err =       0.003162037402
              std dev =       0.664060163162
             le_variance =       0.440975900299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441033712862
                                         uncertainty =       0.002837927808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441033712862
                                         uncertainty =       0.002837927808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469561444
  error estimate for blocks of size 2^( 2) =       0.000493776939
  error estimate for blocks of size 2^( 3) =       0.000515870013
  error estimate for blocks of size 2^( 4) =       0.000532292115
  error estimate for blocks of size 2^( 5) =       0.000542039005
  error estimate for blocks of size 2^( 6) =       0.000545533792
  error estimate for blocks of size 2^( 7) =       0.000548667465

      target function =      -0.743724996295
              le_mean =     -22.661785824995
             les_mean =     514.008482987850
             stat err =       0.000542133094
             autocorr =       1.332990267927
   target nu stat err =       0.000542133094
   target dn stat err =       0.003795441757
      target stat err =       0.003162037402
              std dev =       0.664060163162
             le_variance =       0.440975900299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441033712862
                                         uncertainty =       0.002837927808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441033712862
                                         uncertainty =       0.002837927808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469561444
  error estimate for blocks of size 2^( 2) =       0.000493776939
  error estimate for blocks of size 2^( 3) =       0.000515870013
  error estimate for blocks of size 2^( 4) =       0.000532292115
  error estimate for blocks of size 2^( 5) =       0.000542039005
  error estimate for blocks of size 2^( 6) =       0.000545533792
  error estimate for blocks of size 2^( 7) =       0.000548667465

      target function =      -0.743724996295
              le_mean =     -22.661785824995
             les_mean =     514.008482987850
             stat err =       0.000542133094
             autocorr =       1.332990267926
   target nu stat err =       0.000542133094
   target dn stat err =       0.003795441757
      target stat err =       0.003162037402
              std dev =       0.664060163162
             le_variance =       0.440975900299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441033712862
                                         uncertainty =       0.002837927808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441033712862
                                         uncertainty =       0.002837927808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469561444
  error estimate for blocks of size 2^( 2) =       0.000493776939
  error estimate for blocks of size 2^( 3) =       0.000515870013
  error estimate for blocks of size 2^( 4) =       0.000532292115
  error estimate for blocks of size 2^( 5) =       0.000542039005
  error estimate for blocks of size 2^( 6) =       0.000545533792
  error estimate for blocks of size 2^( 7) =       0.000548667465

      target function =      -0.743724996295
              le_mean =     -22.661785824995
             les_mean =     514.008482987850
             stat err =       0.000542133094
             autocorr =       1.332990267933
   target nu stat err =       0.000542133094
   target dn stat err =       0.003795441757
      target stat err =       0.003162037402
              std dev =       0.664060163162
             le_variance =       0.440975900299


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743724996295        initial
     8.2718e+09     8.2718e+10             3.6097e-14        -0.743724996295
     3.3087e+10     3.3087e+11             9.0142e-15        -0.743724996295
     1.3235e+11     1.3235e+12             2.2457e-15        -0.743724996295  <--

*****************************************************************************
Applying the update for shift_i =   1.3235e+11     and shift_s =   1.3235e+12
*****************************************************************************

  Execution time = 4.3634e+01
  </log>
  <optVariables href="FORM2.s089.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4473e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6554
    reference variance = 0.273896
====================================================
  Execution time = 2.5836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5186e-01
  Total weights = 1.955271129e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442802308842
                                         uncertainty =       0.002666200808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442802308842
                                         uncertainty =       0.002666200808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470505720
  error estimate for blocks of size 2^( 2) =       0.000494587728
  error estimate for blocks of size 2^( 3) =       0.000516787976
  error estimate for blocks of size 2^( 4) =       0.000532650448
  error estimate for blocks of size 2^( 5) =       0.000542476921
  error estimate for blocks of size 2^( 6) =       0.000546751416
  error estimate for blocks of size 2^( 7) =       0.000550171840

      target function =      -0.743801263647
              le_mean =     -22.662172826242
             les_mean =     514.025933817816
             stat err =       0.000543012656
             autocorr =       1.331956642990
   target nu stat err =       0.000543012656
   target dn stat err =       0.003686910244
      target stat err =       0.003077446019
              std dev =       0.665395571044
             le_variance =       0.442751265965


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266217282624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3087e+10, overlap shift 3.3087e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743813204945       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743813204945       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743813204945       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743830316793       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743787449573       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743818077353       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743817954056       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743770438436       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743855992740       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743819431247       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743813535153       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743776161280       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743879760044       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743777480430       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743827276204       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743777817505       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743703081067       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743834429912       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743857352337       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743810915447       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743676965182       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743446381631       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.745377203734       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743959332254       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743800713059       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743812314888       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.743624072289       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744403519767       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.742863543163       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.743393079992       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.743777592314       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.743643669146       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.746898559539       residual = 9.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.750892860310       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.698369255064       residual = 2.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.461616764744       residual = 2.66e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.244814816425       residual = 7.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -4.631306661854       residual = 6.77e+03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -2.720550612337       residual = 4.17e+04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.906628345878       residual = 1.01e+05           smallest_sin_value = 1.00e+00
davidson iteration   40 stopping due to too large eigenvalue change
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+10 is 7.083486e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+11, overlap shift 1.3235e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743813204945       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743813204945       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743813204945       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743799832155       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743815945491       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743936541511       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743654183285       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743778954340       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743505356049       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744059654383       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743646154527       residual = 8.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743757949171       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744089426225       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743793056888       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743514052782       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743629650297       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743387427852       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743871761007       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743848715157       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743676823157       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743717788709       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743800521159       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744170382925       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743700555978       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.743922547682       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744177466409       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744006663345       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742469965184       residual = 3.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.753210193923       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.756664487930       residual = 3.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.736574116594       residual = 1.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.671904802195       residual = 3.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.349493026964       residual = 4.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       1.369493533388       residual = 7.48e+04           smallest_sin_value = 1.00e+00
davidson iteration   34 stopping due to too large eigenvalue change
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+11 is 1.788036e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.2940e+11, overlap shift 5.2940e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743813204945       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743813204945       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743813204945       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743813204945       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743550620959       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743813212165       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.744176327529       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743789252125       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.742947315191       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743495041388       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.746390088428       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743413443721       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744987878185       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743771077346       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744765525244       residual = 8.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.746669725534       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.754316920381       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.299146423800       residual = 2.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.683564125388       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.979293622410       residual = 1.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =       7.100517658187       residual = 4.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       7.783910786178       residual = 2.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -4.172854314961       residual = 1.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -4.762250028287       residual = 8.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.863346530319       residual = 6.17e+04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -5.075411425184       residual = 3.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   26 stopping due to too large eigenvalue change
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.2940e+11 is 4.415031e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.479665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0628e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -22.6056
    reference variance = 0.348352
====================================================
  Execution time = 2.5321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5196e-01
  Total weights = 1.9555e+06
  Execution time = 3.6247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440412298382
                                         uncertainty =       0.003038168468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440412298382
                                         uncertainty =       0.003038168468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469291636
  error estimate for blocks of size 2^( 2) =       0.000493370682
  error estimate for blocks of size 2^( 3) =       0.000515627617
  error estimate for blocks of size 2^( 4) =       0.000531169068
  error estimate for blocks of size 2^( 5) =       0.000540363503
  error estimate for blocks of size 2^( 6) =       0.000544535477
  error estimate for blocks of size 2^( 7) =       0.000546526696

      target function =      -0.743715360835
              le_mean =     -22.661686797941
             les_mean =     514.004005527602
             stat err =       0.000540648686
             autocorr =       1.327225372340
   target nu stat err =       0.000540648686
   target dn stat err =       0.003854542231
      target stat err =       0.003208682341
              std dev =       0.663678596356
             le_variance =       0.440469279261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440412298382
                                         uncertainty =       0.003038168468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440412298382
                                         uncertainty =       0.003038168468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469291636
  error estimate for blocks of size 2^( 2) =       0.000493370682
  error estimate for blocks of size 2^( 3) =       0.000515627617
  error estimate for blocks of size 2^( 4) =       0.000531169068
  error estimate for blocks of size 2^( 5) =       0.000540363503
  error estimate for blocks of size 2^( 6) =       0.000544535477
  error estimate for blocks of size 2^( 7) =       0.000546526696

      target function =      -0.743715360835
              le_mean =     -22.661686797941
             les_mean =     514.004005527601
             stat err =       0.000540648686
             autocorr =       1.327225372335
   target nu stat err =       0.000540648686
   target dn stat err =       0.003854542231
      target stat err =       0.003208682341
              std dev =       0.663678596356
             le_variance =       0.440469279261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440412298382
                                         uncertainty =       0.003038168468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440412298382
                                         uncertainty =       0.003038168468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469291636
  error estimate for blocks of size 2^( 2) =       0.000493370682
  error estimate for blocks of size 2^( 3) =       0.000515627617
  error estimate for blocks of size 2^( 4) =       0.000531169068
  error estimate for blocks of size 2^( 5) =       0.000540363503
  error estimate for blocks of size 2^( 6) =       0.000544535477
  error estimate for blocks of size 2^( 7) =       0.000546526696

      target function =      -0.743715360835
              le_mean =     -22.661686797941
             les_mean =     514.004005527602
             stat err =       0.000540648686
             autocorr =       1.327225372340
   target nu stat err =       0.000540648686
   target dn stat err =       0.003854542231
      target stat err =       0.003208682341
              std dev =       0.663678596356
             le_variance =       0.440469279261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440412298382
                                         uncertainty =       0.003038168468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.440412298382
                                         uncertainty =       0.003038168468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469291636
  error estimate for blocks of size 2^( 2) =       0.000493370682
  error estimate for blocks of size 2^( 3) =       0.000515627617
  error estimate for blocks of size 2^( 4) =       0.000531169068
  error estimate for blocks of size 2^( 5) =       0.000540363503
  error estimate for blocks of size 2^( 6) =       0.000544535477
  error estimate for blocks of size 2^( 7) =       0.000546526696

      target function =      -0.743715360835
              le_mean =     -22.661686797941
             les_mean =     514.004005527602
             stat err =       0.000540648686
             autocorr =       1.327225372340
   target nu stat err =       0.000540648686
   target dn stat err =       0.003854542231
      target stat err =       0.003208682341
              std dev =       0.663678596356
             le_variance =       0.440469279261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.743715360835        initial
     3.3087e+10     3.3087e+11             7.0835e-15        -0.743715360835  <--
     1.3235e+11     1.3235e+12             1.7880e-15        -0.743715360835
     5.2940e+11     5.2940e+12             4.4150e-16        -0.743715360835

*****************************************************************************
Applying the update for shift_i =   3.3087e+10     and shift_s =   3.3087e+11
*****************************************************************************

  Execution time = 4.3507e+01
  </log>
  <optVariables href="FORM2.s090.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4144e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.6378
    reference variance = 0.378452
====================================================
  Execution time = 2.7830e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5244e-01
  Total weights = 1.955363930e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441302603704
                                         uncertainty =       0.002154697106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441302603704
                                         uncertainty =       0.002154697106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000469720640
  error estimate for blocks of size 2^( 2) =       0.000493176645
  error estimate for blocks of size 2^( 3) =       0.000515064814
  error estimate for blocks of size 2^( 4) =       0.000530441693
  error estimate for blocks of size 2^( 5) =       0.000539021850
  error estimate for blocks of size 2^( 6) =       0.000543683595
  error estimate for blocks of size 2^( 7) =       0.000547891941

      target function =      -0.743321565922
              le_mean =     -22.662369094063
             les_mean =     514.035416103028
             stat err =       0.000540259770
             autocorr =       1.322896815689
   target nu stat err =       0.000540259770
   target dn stat err =       0.003804426899
      target stat err =       0.003168227028
              std dev =       0.664285299089
             le_variance =       0.441274958586


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266236909406e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+09, overlap shift 8.2718e+10 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743334195870       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743334195870       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743334195870       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743334195870       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743334195870       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743334195870       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743339056330       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743314230098       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743360259597       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743371017526       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743358268310       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743308347872       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+09 is 2.316598e-14

solving harmonic davidson linear method for identity shift 3.3087e+10, overlap shift 3.3087e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743334195870       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743334195870       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743334195870       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743334195870       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743334195870       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743334945958       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743343515397       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743334195870       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743334195870       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743289355475       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743334195870       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+10 is 5.787216e-15

solving harmonic davidson linear method for identity shift 1.3235e+11, overlap shift 1.3235e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743334195870       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743334195870       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743334195870       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743334195870       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743334195870       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743334195870       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743334195870       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743334195870       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743319653038       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743334195870       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743330362020       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743184953894       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743222171728       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743472026745       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743098993723       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743349699616       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743405460378       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742986871028       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743612706168       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743537996965       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743373028164       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743148038578       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742663571351       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.744739324539       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746323962265       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744834852106       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.744158999853       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.744258969493       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.736421334528       residual = 2.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.737178550527       residual = 3.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.770828557001       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.784865034765       residual = 6.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.782992515186       residual = 2.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.058488184886       residual = 5.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.040537837970       residual = 4.49e+04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -4.664874277375       residual = 4.51e+05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -7.506367223092       residual = 8.10e+05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.293528976642       residual = 5.86e+05           smallest_sin_value = 1.00e+00
davidson iteration   38 stopping due to too large eigenvalue change
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+11 is 1.464069e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.504286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2567e+01
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -22.6392
    reference variance = 0.470726
====================================================
  Execution time = 2.5191e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5889e-01
  Total weights = 1.9553e+06
  Execution time = 3.6368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444353085068
                                         uncertainty =       0.002734973224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444353085068
                                         uncertainty =       0.002734973224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471416012
  error estimate for blocks of size 2^( 2) =       0.000495492132
  error estimate for blocks of size 2^( 3) =       0.000517134380
  error estimate for blocks of size 2^( 4) =       0.000533305204
  error estimate for blocks of size 2^( 5) =       0.000542416380
  error estimate for blocks of size 2^( 6) =       0.000547213931
  error estimate for blocks of size 2^( 7) =       0.000549792184

      target function =      -0.738074475512
              le_mean =     -22.662563997914
             les_mean =     514.050700573246
             stat err =       0.000543181925
             autocorr =       1.327644989394
   target nu stat err =       0.000543181925
   target dn stat err =       0.004811781262
      target stat err =       0.003926867705
              std dev =       0.666682917300
             le_variance =       0.444466112220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444353085068
                                         uncertainty =       0.002734973224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444353085068
                                         uncertainty =       0.002734973224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471416012
  error estimate for blocks of size 2^( 2) =       0.000495492132
  error estimate for blocks of size 2^( 3) =       0.000517134380
  error estimate for blocks of size 2^( 4) =       0.000533305204
  error estimate for blocks of size 2^( 5) =       0.000542416380
  error estimate for blocks of size 2^( 6) =       0.000547213931
  error estimate for blocks of size 2^( 7) =       0.000549792184

      target function =      -0.738074475512
              le_mean =     -22.662563997914
             les_mean =     514.050700573246
             stat err =       0.000543181925
             autocorr =       1.327644989395
   target nu stat err =       0.000543181925
   target dn stat err =       0.004811781262
      target stat err =       0.003926867705
              std dev =       0.666682917300
             le_variance =       0.444466112219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444353085068
                                         uncertainty =       0.002734973224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444353085068
                                         uncertainty =       0.002734973224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471416012
  error estimate for blocks of size 2^( 2) =       0.000495492132
  error estimate for blocks of size 2^( 3) =       0.000517134380
  error estimate for blocks of size 2^( 4) =       0.000533305204
  error estimate for blocks of size 2^( 5) =       0.000542416380
  error estimate for blocks of size 2^( 6) =       0.000547213931
  error estimate for blocks of size 2^( 7) =       0.000549792184

      target function =      -0.738074475512
              le_mean =     -22.662563997914
             les_mean =     514.050700573246
             stat err =       0.000543181925
             autocorr =       1.327644989396
   target nu stat err =       0.000543181925
   target dn stat err =       0.004811781262
      target stat err =       0.003926867705
              std dev =       0.666682917300
             le_variance =       0.444466112219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444353085068
                                         uncertainty =       0.002734973224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444353085068
                                         uncertainty =       0.002734973224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471416012
  error estimate for blocks of size 2^( 2) =       0.000495492132
  error estimate for blocks of size 2^( 3) =       0.000517134380
  error estimate for blocks of size 2^( 4) =       0.000533305204
  error estimate for blocks of size 2^( 5) =       0.000542416380
  error estimate for blocks of size 2^( 6) =       0.000547213931
  error estimate for blocks of size 2^( 7) =       0.000549792184

      target function =      -0.738074475512
              le_mean =     -22.662563997914
             les_mean =     514.050700573246
             stat err =       0.000543181925
             autocorr =       1.327644989395
   target nu stat err =       0.000543181925
   target dn stat err =       0.004811781262
      target stat err =       0.003926867705
              std dev =       0.666682917300
             le_variance =       0.444466112219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.738074475512        initial  <--
     8.2718e+09     8.2718e+10             2.3166e-14        -0.738074475512
     3.3087e+10     3.3087e+11             5.7872e-15        -0.738074475512
     1.3235e+11     1.3235e+12             1.4641e-15        -0.738074475512

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5128
  </log>
  <optVariables href="FORM2.s091.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6086e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.6966
    reference variance = 0.243761
====================================================
  Execution time = 2.6063e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.6087e-01
  Total weights = 1.955202873e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448088186437
                                         uncertainty =       0.003933936352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448088186437
                                         uncertainty =       0.003933936352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473301801
  error estimate for blocks of size 2^( 2) =       0.000497280986
  error estimate for blocks of size 2^( 3) =       0.000519584402
  error estimate for blocks of size 2^( 4) =       0.000535330995
  error estimate for blocks of size 2^( 5) =       0.000544134405
  error estimate for blocks of size 2^( 6) =       0.000547842656
  error estimate for blocks of size 2^( 7) =       0.000549572761

      target function =      -0.736475576340
              le_mean =     -22.662239687807
             les_mean =     514.037980478000
             stat err =       0.000544220204
             autocorr =       1.322126495407
   target nu stat err =       0.000544220204
   target dn stat err =       0.005644870518
      target stat err =       0.004570619815
              std dev =       0.669349825592
             le_variance =       0.448029189020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266223968781e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+10, overlap shift 8.2718e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736502845956       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736502845956       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736502845956       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736502845956       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736502845958       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736502845798       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736533989209       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736583636458       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736566917515       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736546881321       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.736524762162       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736439332878       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736359486280       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736494175722       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736393754519       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736905973875       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.736555359748       residual = 6.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.736470814214       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.736055099082       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736244841679       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.736476711680       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.736567623795       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.735376342304       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.734956956932       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.736953474199       residual = 3.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.739785470317       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.732787014970       residual = 6.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.742506788228       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.735896975655       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747786785002       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.722624084116       residual = 4.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.730625837030       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.739815471112       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.766164709864       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.672540325984       residual = 5.43e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.650002873116       residual = 4.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.690179030100       residual = 4.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.782471393841       residual = 5.94e-01           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.718602380819       residual = 1.94e+00           smallest_sin_value = 9.96e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.802004837243       residual = 9.98e+00           smallest_sin_value = 9.90e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+10 is 2.814908e-15

solving harmonic davidson linear method for identity shift 3.3087e+11, overlap shift 3.3087e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736502845956       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736502845956       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736502845956       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736502845956       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.736502845948       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736580282653       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736502736688       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736498542683       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.736013473426       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.736836198425       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.735821503562       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736123247026       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736625703512       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.737511429214       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.736472622786       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.736184349150       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.737776589103       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.723327466791       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743177482441       residual = 6.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.782358617405       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.800822769096       residual = 5.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.768294272841       residual = 3.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.731342656860       residual = 8.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.771117323281       residual = 3.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746810722779       residual = 8.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.724859399412       residual = 2.94e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.384792628745       residual = 2.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.370606128409       residual = 5.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.655255070237       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.626671866525       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       1.086909727638       residual = 8.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.300506943534       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.638526334424       residual = 2.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.517467936727       residual = 8.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.607763009292       residual = 3.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.549232617335       residual = 2.63e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       3.804165994792       residual = 1.52e+04           smallest_sin_value = 1.00e+00
davidson iteration   37 stopping due to too large eigenvalue change
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+11 is 6.915302e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+12, overlap shift 1.3235e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.736502845956       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.736502845956       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.736502845956       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.736502845956       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.737045171107       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.736160163203       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.736502821499       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.736401358246       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.737169299185       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.733676453152       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.739507327562       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.736139636077       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.736589626290       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.736129714687       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.739464175831       residual = 7.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.729589138600       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.730935404886       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.808634615789       residual = 8.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.254029349415       residual = 1.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -3.557360380129       residual = 4.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -5.843922102105       residual = 1.13e+04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       0.424004442942       residual = 5.39e+04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       1.421644725546       residual = 4.33e+04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -2.168231448949       residual = 5.61e+05           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+12 is 1.655597e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.557256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0861e+01
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -22.8171
    reference variance = 0.425868
====================================================
  Execution time = 2.5281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4872e-01
  Total weights = 1.9551e+06
  Execution time = 3.6231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439927804754
                                         uncertainty =       0.001713791314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439927804754
                                         uncertainty =       0.001713791314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468991352
  error estimate for blocks of size 2^( 2) =       0.000493294552
  error estimate for blocks of size 2^( 3) =       0.000514709068
  error estimate for blocks of size 2^( 4) =       0.000529826611
  error estimate for blocks of size 2^( 5) =       0.000538511364
  error estimate for blocks of size 2^( 6) =       0.000543122372
  error estimate for blocks of size 2^( 7) =       0.000544757300

      target function =      -0.746378223889
              le_mean =     -22.661456843513
             les_mean =     513.990345496538
             stat err =       0.000539054412
             autocorr =       1.321099534174
   target nu stat err =       0.000539054412
   target dn stat err =       0.002572817317
      target stat err =       0.002200880615
              std dev =       0.663253931288
             le_variance =       0.439905777370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439927804754
                                         uncertainty =       0.001713791314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439927804754
                                         uncertainty =       0.001713791314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468991352
  error estimate for blocks of size 2^( 2) =       0.000493294552
  error estimate for blocks of size 2^( 3) =       0.000514709068
  error estimate for blocks of size 2^( 4) =       0.000529826611
  error estimate for blocks of size 2^( 5) =       0.000538511364
  error estimate for blocks of size 2^( 6) =       0.000543122372
  error estimate for blocks of size 2^( 7) =       0.000544757300

      target function =      -0.746378223889
              le_mean =     -22.661456843513
             les_mean =     513.990345496538
             stat err =       0.000539054412
             autocorr =       1.321099534173
   target nu stat err =       0.000539054412
   target dn stat err =       0.002572817317
      target stat err =       0.002200880615
              std dev =       0.663253931288
             le_variance =       0.439905777370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439927804754
                                         uncertainty =       0.001713791314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439927804754
                                         uncertainty =       0.001713791314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468991352
  error estimate for blocks of size 2^( 2) =       0.000493294552
  error estimate for blocks of size 2^( 3) =       0.000514709068
  error estimate for blocks of size 2^( 4) =       0.000529826611
  error estimate for blocks of size 2^( 5) =       0.000538511364
  error estimate for blocks of size 2^( 6) =       0.000543122372
  error estimate for blocks of size 2^( 7) =       0.000544757300

      target function =      -0.746378223889
              le_mean =     -22.661456843513
             les_mean =     513.990345496538
             stat err =       0.000539054412
             autocorr =       1.321099534172
   target nu stat err =       0.000539054412
   target dn stat err =       0.002572817317
      target stat err =       0.002200880615
              std dev =       0.663253931289
             le_variance =       0.439905777370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439927804754
                                         uncertainty =       0.001713791314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439927804754
                                         uncertainty =       0.001713791314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468991352
  error estimate for blocks of size 2^( 2) =       0.000493294552
  error estimate for blocks of size 2^( 3) =       0.000514709068
  error estimate for blocks of size 2^( 4) =       0.000529826611
  error estimate for blocks of size 2^( 5) =       0.000538511364
  error estimate for blocks of size 2^( 6) =       0.000543122372
  error estimate for blocks of size 2^( 7) =       0.000544757300

      target function =      -0.746378223889
              le_mean =     -22.661456843513
             les_mean =     513.990345496538
             stat err =       0.000539054412
             autocorr =       1.321099534172
   target nu stat err =       0.000539054412
   target dn stat err =       0.002572817317
      target stat err =       0.002200880615
              std dev =       0.663253931289
             le_variance =       0.439905777370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.746378223889        initial  <--
     8.2718e+10     8.2718e+11             2.8149e-15        -0.746378223889
     3.3087e+11     3.3087e+12             6.9153e-16        -0.746378223889
     1.3235e+12     1.3235e+13             1.6556e-16        -0.746378223889

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.4751
  </log>
  <optVariables href="FORM2.s092.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.6994
    reference variance = 0.593737
====================================================
  Execution time = 2.5870e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4762e-01
  Total weights = 1.955225928e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439361607171
                                         uncertainty =       0.002410399271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439361607171
                                         uncertainty =       0.002410399271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468725165
  error estimate for blocks of size 2^( 2) =       0.000492574471
  error estimate for blocks of size 2^( 3) =       0.000514346158
  error estimate for blocks of size 2^( 4) =       0.000530872111
  error estimate for blocks of size 2^( 5) =       0.000539607632
  error estimate for blocks of size 2^( 6) =       0.000545339441
  error estimate for blocks of size 2^( 7) =       0.000549466819

      target function =      -0.747291242833
              le_mean =     -22.661964152473
             les_mean =     514.012238768355
             stat err =       0.000541321501
             autocorr =       1.333748711546
   target nu stat err =       0.000541321501
   target dn stat err =       0.002499214597
      target stat err =       0.002149930451
              std dev =       0.662877485509
             le_variance =       0.439406560795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266196415247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+11, overlap shift 8.2718e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747296526083       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747296526083       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747296526083       residual = 5.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747437222773       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747308468238       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747296527858       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747296526083       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747779949494       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746761653087       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746884827207       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748780619206       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746824610397       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747362189664       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746285964035       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.747208927027       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747225613680       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748196106099       residual = 6.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745840583193       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746447406650       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.760326262328       residual = 8.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745126818204       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743939247129       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.743539639373       residual = 4.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.756374351202       residual = 3.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.754828036291       residual = 3.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.744746470716       residual = 8.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.741471870819       residual = 5.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.762691199252       residual = 6.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.748072776595       residual = 5.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.747139187467       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.775289527651       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.772721073858       residual = 3.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.754320400591       residual = 9.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.440116822661       residual = 3.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       1.101386607791       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.655283813382       residual = 9.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.381020541568       residual = 3.53e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       0.426825019769       residual = 1.45e+04           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.169647755172       residual = 2.55e+03           smallest_sin_value = 9.98e-01
davidson iteration   39 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+11 is 3.030845e-16

solving harmonic davidson linear method for identity shift 3.3087e+12, overlap shift 3.3087e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747296526083       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747296526083       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.747296526083       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.747296526083       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.747770113573       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747296523269       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.747857765459       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747658347275       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741487831007       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.739927779383       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.751180254066       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748755058739       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741995738820       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744899752196       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.752252007104       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.762079686641       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.747160036103       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.772666901927       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.753302165314       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.758997029068       residual = 4.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.588915434289       residual = 1.58e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.652046292334       residual = 1.72e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.533850178077       residual = 1.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.771250971106       residual = 2.46e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.761370046617       residual = 2.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.249794837162       residual = 1.84e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.231331298348       residual = 7.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.533273452067       residual = 3.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       4.787213615407       residual = 1.45e+05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -3.503146648646       residual = 6.14e+04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       5.580018094707       residual = 7.91e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       6.481875836343       residual = 2.06e+05           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+12 is 6.872660e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+13, overlap shift 1.3235e+14 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.747296526083       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.747296526083       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.594711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0649e+01
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -22.6488
    reference variance = 0.374395
====================================================
  Execution time = 2.5302e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4404e-01
  Total weights = 1.9555e+06
  Execution time = 3.6196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436811547649
                                         uncertainty =       0.001950274263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436811547649
                                         uncertainty =       0.001950274263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467347783
  error estimate for blocks of size 2^( 2) =       0.000491293717
  error estimate for blocks of size 2^( 3) =       0.000513709373
  error estimate for blocks of size 2^( 4) =       0.000529400411
  error estimate for blocks of size 2^( 5) =       0.000537427583
  error estimate for blocks of size 2^( 6) =       0.000539775192
  error estimate for blocks of size 2^( 7) =       0.000542729303

      target function =      -0.750260837233
              le_mean =     -22.662066236107
             les_mean =     514.013289584046
             stat err =       0.000537333122
             autocorr =       1.321925101097
   target nu stat err =       0.000537333122
   target dn stat err =       0.002119126111
      target stat err =       0.001863187586
              std dev =       0.660929573747
             le_variance =       0.436827901453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436811547649
                                         uncertainty =       0.001950274263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436811547649
                                         uncertainty =       0.001950274263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467347783
  error estimate for blocks of size 2^( 2) =       0.000491293717
  error estimate for blocks of size 2^( 3) =       0.000513709373
  error estimate for blocks of size 2^( 4) =       0.000529400411
  error estimate for blocks of size 2^( 5) =       0.000537427583
  error estimate for blocks of size 2^( 6) =       0.000539775192
  error estimate for blocks of size 2^( 7) =       0.000542729303

      target function =      -0.750260837233
              le_mean =     -22.662066236107
             les_mean =     514.013289584046
             stat err =       0.000537333122
             autocorr =       1.321925101097
   target nu stat err =       0.000537333122
   target dn stat err =       0.002119126111
      target stat err =       0.001863187586
              std dev =       0.660929573747
             le_variance =       0.436827901453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436811547649
                                         uncertainty =       0.001950274263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436811547649
                                         uncertainty =       0.001950274263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467347783
  error estimate for blocks of size 2^( 2) =       0.000491293717
  error estimate for blocks of size 2^( 3) =       0.000513709373
  error estimate for blocks of size 2^( 4) =       0.000529400411
  error estimate for blocks of size 2^( 5) =       0.000537427583
  error estimate for blocks of size 2^( 6) =       0.000539775192
  error estimate for blocks of size 2^( 7) =       0.000542729303

      target function =      -0.750260837233
              le_mean =     -22.662066236107
             les_mean =     514.013289584046
             stat err =       0.000537333122
             autocorr =       1.321925101097
   target nu stat err =       0.000537333122
   target dn stat err =       0.002119126111
      target stat err =       0.001863187586
              std dev =       0.660929573747
             le_variance =       0.436827901453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436811547649
                                         uncertainty =       0.001950274263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.436811547649
                                         uncertainty =       0.001950274263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467347783
  error estimate for blocks of size 2^( 2) =       0.000491293717
  error estimate for blocks of size 2^( 3) =       0.000513709373
  error estimate for blocks of size 2^( 4) =       0.000529400411
  error estimate for blocks of size 2^( 5) =       0.000537427583
  error estimate for blocks of size 2^( 6) =       0.000539775192
  error estimate for blocks of size 2^( 7) =       0.000542729303

      target function =      -0.750260837233
              le_mean =     -22.662066236107
             les_mean =     514.013289584046
             stat err =       0.000537333122
             autocorr =       1.321925101097
   target nu stat err =       0.000537333122
   target dn stat err =       0.002119126111
      target stat err =       0.001863187586
              std dev =       0.660929573747
             le_variance =       0.436827901453


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.750260837233        initial
     8.2718e+11     8.2718e+12             3.0308e-16        -0.750260837233  <--
     3.3087e+12     3.3087e+13             6.8727e-17        -0.750260837233
     1.3235e+13     1.3235e+14             0.0000e+00        -0.750260837233

*****************************************************************************
Applying the update for shift_i =   8.2718e+11     and shift_s =   8.2718e+12
*****************************************************************************

  Execution time = 4.3485e+01
  </log>
  <optVariables href="FORM2.s093.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4140e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.5968
    reference variance = 0.239661
====================================================
  Execution time = 2.5925e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5177e-01
  Total weights = 1.955125480e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442544623724
                                         uncertainty =       0.002206469763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.442544623724
                                         uncertainty =       0.002206469763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470369561
  error estimate for blocks of size 2^( 2) =       0.000494535084
  error estimate for blocks of size 2^( 3) =       0.000517146956
  error estimate for blocks of size 2^( 4) =       0.000533209867
  error estimate for blocks of size 2^( 5) =       0.000543784788
  error estimate for blocks of size 2^( 6) =       0.000549547917
  error estimate for blocks of size 2^( 7) =       0.000552865123

      target function =      -0.743874236015
              le_mean =     -22.662047581800
             les_mean =     514.020172916411
             stat err =       0.000544851924
             autocorr =       1.341771484437
   target nu stat err =       0.000544851924
   target dn stat err =       0.002927859488
      target stat err =       0.002471213179
              std dev =       0.665203012791
             le_variance =       0.442495048226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266204758180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+11, overlap shift 2.0680e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743881494781       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743881494781       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743881494781       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743881494781       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743790494365       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743881495659       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743881593395       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743983590680       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743840225776       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743565965680       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743684600581       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743720111906       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743863842515       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743904464030       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743750799175       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742813545572       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743721542714       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743921817353       residual = 5.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741824073805       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.744209884122       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.744522700161       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747133185371       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747268215121       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.782828880707       residual = 9.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744792459186       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.741042812438       residual = 9.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.745314915130       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.751845759436       residual = 2.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.753296727588       residual = 9.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.738371931778       residual = 5.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.735510143950       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.738538538325       residual = 4.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.743711297691       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.740549098373       residual = 6.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.698769996633       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.737667341879       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.762584862428       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.792865303702       residual = 4.61e-01           smallest_sin_value = 9.99e-01
davidson iteration   38:   krylov dim =  39   tar_fn =      -3.177975512291       residual = 5.37e+02           smallest_sin_value = 9.97e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -5.256050795316       residual = 2.16e+03           smallest_sin_value = 9.91e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+11 is 8.931209e-16

solving harmonic davidson linear method for identity shift 8.2718e+11, overlap shift 8.2718e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743881494781       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743881494781       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743881494781       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743881494781       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743881494780       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743881494781       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743882174811       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743927159400       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741604179051       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743778525372       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743108297432       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743455845370       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743863758545       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743699574172       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742576249820       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747974758015       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.741827247759       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.742650475712       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.715267673882       residual = 8.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.779261079520       residual = 8.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.705153480608       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       0.336271831778       residual = 5.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -9.028660282176       residual = 1.47e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       0.550688972783       residual = 2.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   24 stopping due to too large eigenvalue change
davidson solver did not converge after         24 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+11 is 2.216471e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.3087e+12, overlap shift 3.3087e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743881494781       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743881494781       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743881494781       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743881494781       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743945959139       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.744735957362       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743440549321       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743933112579       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745410522294       residual = 6.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745795551785       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743654974608       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.753370146849       residual = 4.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748296657567       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.737998043042       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740439134499       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.712039083512       residual = 5.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.752411883888       residual = 9.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.806478753503       residual = 1.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.531130763967       residual = 5.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.676833153698       residual = 6.96e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.056886339163       residual = 3.65e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -6.818613617361       residual = 1.86e+05           smallest_sin_value = 1.00e+00
davidson iteration   22 stopping due to too large eigenvalue change
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+12 is 5.676088e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.632973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0714e+01
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -22.6064
    reference variance = 0.270708
====================================================
  Execution time = 2.5129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5964e-01
  Total weights = 1.9551e+06
  Execution time = 3.6162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448616507378
                                         uncertainty =       0.004825783810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448616507378
                                         uncertainty =       0.004825783810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473597383
  error estimate for blocks of size 2^( 2) =       0.000497270134
  error estimate for blocks of size 2^( 3) =       0.000519177614
  error estimate for blocks of size 2^( 4) =       0.000535409435
  error estimate for blocks of size 2^( 5) =       0.000544871993
  error estimate for blocks of size 2^( 6) =       0.000551330695
  error estimate for blocks of size 2^( 7) =       0.000553256792

      target function =      -0.737468202729
              le_mean =     -22.662012969398
             les_mean =     514.026471935784
             stat err =       0.000546217229
             autocorr =       1.330185474802
   target nu stat err =       0.000546217229
   target dn stat err =       0.005515191305
      target stat err =       0.004478134937
              std dev =       0.669767842140
             le_variance =       0.448588962365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448616507378
                                         uncertainty =       0.004825783810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448616507378
                                         uncertainty =       0.004825783810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473597383
  error estimate for blocks of size 2^( 2) =       0.000497270134
  error estimate for blocks of size 2^( 3) =       0.000519177614
  error estimate for blocks of size 2^( 4) =       0.000535409435
  error estimate for blocks of size 2^( 5) =       0.000544871993
  error estimate for blocks of size 2^( 6) =       0.000551330695
  error estimate for blocks of size 2^( 7) =       0.000553256792

      target function =      -0.737468202729
              le_mean =     -22.662012969398
             les_mean =     514.026471935784
             stat err =       0.000546217229
             autocorr =       1.330185474802
   target nu stat err =       0.000546217229
   target dn stat err =       0.005515191305
      target stat err =       0.004478134937
              std dev =       0.669767842140
             le_variance =       0.448588962365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448616507378
                                         uncertainty =       0.004825783810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448616507378
                                         uncertainty =       0.004825783810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473597383
  error estimate for blocks of size 2^( 2) =       0.000497270134
  error estimate for blocks of size 2^( 3) =       0.000519177614
  error estimate for blocks of size 2^( 4) =       0.000535409435
  error estimate for blocks of size 2^( 5) =       0.000544871993
  error estimate for blocks of size 2^( 6) =       0.000551330695
  error estimate for blocks of size 2^( 7) =       0.000553256792

      target function =      -0.737468202729
              le_mean =     -22.662012969398
             les_mean =     514.026471935784
             stat err =       0.000546217229
             autocorr =       1.330185474802
   target nu stat err =       0.000546217229
   target dn stat err =       0.005515191305
      target stat err =       0.004478134937
              std dev =       0.669767842140
             le_variance =       0.448588962365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448616507378
                                         uncertainty =       0.004825783810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.448616507378
                                         uncertainty =       0.004825783810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000473597383
  error estimate for blocks of size 2^( 2) =       0.000497270134
  error estimate for blocks of size 2^( 3) =       0.000519177614
  error estimate for blocks of size 2^( 4) =       0.000535409435
  error estimate for blocks of size 2^( 5) =       0.000544871993
  error estimate for blocks of size 2^( 6) =       0.000551330695
  error estimate for blocks of size 2^( 7) =       0.000553256792

      target function =      -0.737468202729
              le_mean =     -22.662012969398
             les_mean =     514.026471935784
             stat err =       0.000546217229
             autocorr =       1.330185474801
   target nu stat err =       0.000546217229
   target dn stat err =       0.005515191305
      target stat err =       0.004478134937
              std dev =       0.669767842140
             le_variance =       0.448588962365


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.737468202729        initial
     2.0680e+11     2.0680e+12             8.9312e-16        -0.737468202729
     8.2718e+11     8.2718e+12             2.2165e-16        -0.737468202729
     3.3087e+12     3.3087e+13             5.6761e-17        -0.737468202729  <--

*****************************************************************************
Applying the update for shift_i =   3.3087e+12     and shift_s =   3.3087e+13
*****************************************************************************

  Execution time = 4.3289e+01
  </log>
  <optVariables href="FORM2.s094.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4009e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.6553
    reference variance = 0.368677
====================================================
  Execution time = 2.7932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4827e-01
  Total weights = 1.955295668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438729120443
                                         uncertainty =       0.002226262139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438729120443
                                         uncertainty =       0.002226262139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468445836
  error estimate for blocks of size 2^( 2) =       0.000492594840
  error estimate for blocks of size 2^( 3) =       0.000514605858
  error estimate for blocks of size 2^( 4) =       0.000530189685
  error estimate for blocks of size 2^( 5) =       0.000539705295
  error estimate for blocks of size 2^( 6) =       0.000544327587
  error estimate for blocks of size 2^( 7) =       0.000546378772

      target function =      -0.746745599312
              le_mean =     -22.661462093938
             les_mean =     513.990135864224
             stat err =       0.000540150335
             autocorr =       1.329567937168
   target nu stat err =       0.000540150335
   target dn stat err =       0.002874890692
      target stat err =       0.002443987473
              std dev =       0.662482454634
             le_variance =       0.438883002698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266146209394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.2718e+11, overlap shift 8.2718e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746752663446       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746752663446       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746752663446       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746752663446       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746692604835       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746456658999       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746642661468       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745903833037       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.747641770741       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745918714614       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747711885388       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.748886025280       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.748072474628       residual = 8.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.746963534119       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.746722671441       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739142903701       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.773233544257       residual = 5.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.758923447991       residual = 6.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.623475572676       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.777637103744       residual = 6.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.876671718690       residual = 3.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913252174586       residual = 6.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.041478264226       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.527286754844       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.848103913539       residual = 7.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.520419226144       residual = 3.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.583854847670       residual = 6.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.076453808603       residual = 2.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.330988406561       residual = 1.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.431334239965       residual = 3.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.073903899062       residual = 3.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.731667472407       residual = 2.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.953432912776       residual = 7.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.505283113622       residual = 1.68e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.196645998679       residual = 1.47e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -5.055184386085       residual = 1.66e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.852011003555       residual = 2.63e+03           smallest_sin_value = 9.99e-01
davidson iteration   37 stopping due to too large eigenvalue change
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+11 is 3.382578e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.3087e+12, overlap shift 3.3087e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746752663446       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746752663446       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746752663446       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746752663446       residual = 9.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746752663446       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.746752662928       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746467588201       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747288621469       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746520935821       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.746501906702       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747785290761       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.754372811480       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745928933078       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.748588391021       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.749757106415       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743832066989       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748534198655       residual = 7.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749332206609       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.747769217330       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746552319495       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.766554184575       residual = 5.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.465657337677       residual = 1.70e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.330595905356       residual = 7.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =       1.039104577311       residual = 2.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       1.668931378879       residual = 6.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       3.191788253972       residual = 3.19e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -5.051101017668       residual = 1.96e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       4.418578860994       residual = 2.25e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.698787608143       residual = 1.54e+03           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to too large eigenvalue change
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+12 is 8.510596e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.3235e+13, overlap shift 1.3235e+14 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.746752663446       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.746752663446       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.746752663446       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746752663446       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.746752663447       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747915988743       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746062909764       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.747090642700       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745968468156       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.701864467849       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.748455744305       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.721267564086       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.750705469742       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.765410261282       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742564942596       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.738331380284       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746836303399       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744173639871       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751472356476       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745431163221       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742470975760       residual = 3.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.724412996275       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.727390703770       residual = 1.37e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.711286548924       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.710935365959       residual = 8.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.529291426279       residual = 3.36e+04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946595258635       residual = 4.03e+04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.730411928226       residual = 1.67e+05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.464508393770       residual = 1.22e+05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -6.407599704560       residual = 5.56e+06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -3.455345956122       residual = 8.23e+06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.477294040109       residual = 2.36e+06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.802256078904       residual = 4.87e+05           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.3235e+13 is 2.145641e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.679084 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2695e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -22.7657
    reference variance = 0.234199
====================================================
  Execution time = 2.5604e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.5440e-01
  Total weights = 1.9552e+06
  Execution time = 3.6169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446095454999
                                         uncertainty =       0.003328292499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446095454999
                                         uncertainty =       0.003328292499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472255574
  error estimate for blocks of size 2^( 2) =       0.000496428805
  error estimate for blocks of size 2^( 3) =       0.000518065494
  error estimate for blocks of size 2^( 4) =       0.000534187672
  error estimate for blocks of size 2^( 5) =       0.000543423931
  error estimate for blocks of size 2^( 6) =       0.000546958870
  error estimate for blocks of size 2^( 7) =       0.000547311993

      target function =      -0.741721418097
              le_mean =     -22.662924569571
             les_mean =     514.062554567101
             stat err =       0.000542970617
             autocorr =       1.321899597704
   target nu stat err =       0.000542970617
   target dn stat err =       0.003838123292
      target stat err =       0.003184976643
              std dev =       0.667870237833
             le_variance =       0.446050654583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446095454999
                                         uncertainty =       0.003328292499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446095454999
                                         uncertainty =       0.003328292499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472255574
  error estimate for blocks of size 2^( 2) =       0.000496428805
  error estimate for blocks of size 2^( 3) =       0.000518065494
  error estimate for blocks of size 2^( 4) =       0.000534187672
  error estimate for blocks of size 2^( 5) =       0.000543423931
  error estimate for blocks of size 2^( 6) =       0.000546958870
  error estimate for blocks of size 2^( 7) =       0.000547311993

      target function =      -0.741721418097
              le_mean =     -22.662924569571
             les_mean =     514.062554567101
             stat err =       0.000542970617
             autocorr =       1.321899597697
   target nu stat err =       0.000542970617
   target dn stat err =       0.003838123292
      target stat err =       0.003184976643
              std dev =       0.667870237833
             le_variance =       0.446050654583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446095454999
                                         uncertainty =       0.003328292499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446095454999
                                         uncertainty =       0.003328292499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472255574
  error estimate for blocks of size 2^( 2) =       0.000496428805
  error estimate for blocks of size 2^( 3) =       0.000518065494
  error estimate for blocks of size 2^( 4) =       0.000534187672
  error estimate for blocks of size 2^( 5) =       0.000543423931
  error estimate for blocks of size 2^( 6) =       0.000546958870
  error estimate for blocks of size 2^( 7) =       0.000547311993

      target function =      -0.741721418097
              le_mean =     -22.662924569571
             les_mean =     514.062554567101
             stat err =       0.000542970617
             autocorr =       1.321899597698
   target nu stat err =       0.000542970617
   target dn stat err =       0.003838123292
      target stat err =       0.003184976643
              std dev =       0.667870237833
             le_variance =       0.446050654583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446095454999
                                         uncertainty =       0.003328292499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.446095454999
                                         uncertainty =       0.003328292499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000472255574
  error estimate for blocks of size 2^( 2) =       0.000496428805
  error estimate for blocks of size 2^( 3) =       0.000518065494
  error estimate for blocks of size 2^( 4) =       0.000534187672
  error estimate for blocks of size 2^( 5) =       0.000543423931
  error estimate for blocks of size 2^( 6) =       0.000546958870
  error estimate for blocks of size 2^( 7) =       0.000547311993

      target function =      -0.741721418097
              le_mean =     -22.662924569571
             les_mean =     514.062554567101
             stat err =       0.000542970617
             autocorr =       1.321899597702
   target nu stat err =       0.000542970617
   target dn stat err =       0.003838123292
      target stat err =       0.003184976643
              std dev =       0.667870237833
             le_variance =       0.446050654583


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.741721418097        initial
     8.2718e+11     8.2718e+12             3.3826e-16        -0.741721418097  <--
     3.3087e+12     3.3087e+13             8.5106e-17        -0.741721418097
     1.3235e+13     1.3235e+14             2.1456e-17        -0.741721418097

*****************************************************************************
Applying the update for shift_i =   8.2718e+11     and shift_s =   8.2718e+12
*****************************************************************************

  Execution time = 4.3756e+01
  </log>
  <optVariables href="FORM2.s095.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.6457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.6151
    reference variance = 0.23426
====================================================
  Execution time = 2.5931e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.5522e-01
  Total weights = 1.955422964e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441980916905
                                         uncertainty =       0.002791293502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.441980916905
                                         uncertainty =       0.002791293502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000470131199
  error estimate for blocks of size 2^( 2) =       0.000494112404
  error estimate for blocks of size 2^( 3) =       0.000516602289
  error estimate for blocks of size 2^( 4) =       0.000532259337
  error estimate for blocks of size 2^( 5) =       0.000541208875
  error estimate for blocks of size 2^( 6) =       0.000546179190
  error estimate for blocks of size 2^( 7) =       0.000550817252

      target function =      -0.741048834916
              le_mean =     -22.661104082310
             les_mean =     513.980855517985
             stat err =       0.000542616164
             autocorr =       1.332132141186
   target nu stat err =       0.000542616164
   target dn stat err =       0.004831128794
      target stat err =       0.003965109819
              std dev =       0.664865917909
             le_variance =       0.442046688797


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266110408231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.0680e+11, overlap shift 2.0680e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741068948766       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741068948766       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741068948766       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741112512145       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741047812526       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741103633649       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741070206986       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741183851915       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.741225581890       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.741231645158       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.741162139773       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.741276315641       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.741074038729       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.741286736388       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.740539559463       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741255442515       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.740679837420       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740278605839       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.741543507175       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741048353198       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.742133970896       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.738626732830       residual = 8.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.708891675009       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.682926616493       residual = 1.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.803811722547       residual = 8.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.597377258931       residual = 2.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.627585008440       residual = 2.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.186513495851       residual = 6.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.219169935371       residual = 1.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to too large eigenvalue change
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+11 is 1.925788e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.2718e+11, overlap shift 8.2718e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741068948766       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741068948766       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741068948766       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741068948766       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741068948766       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741336766832       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741069444128       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.741125127427       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740900871249       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.738093278257       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737966461366       residual = 6.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.740200285931       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.739203057023       residual = 7.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742424945316       residual = 5.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743094251113       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.739988462959       residual = 9.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742369171782       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.740596123104       residual = 9.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.698931189220       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.736633176333       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.729880853457       residual = 7.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.776009301134       residual = 3.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.761179057909       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.741628373583       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.753388852489       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.788042274134       residual = 7.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.754655797770       residual = 1.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.733750292555       residual = 3.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.756698337843       residual = 3.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.748819207772       residual = 5.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.727968146798       residual = 3.93e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.733371157859       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.767207823457       residual = 5.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.020244780792       residual = 1.44e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.853817531412       residual = 8.42e+05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.956561026715       residual = 1.89e+05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -2.536229338321       residual = 1.16e+07           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.012621955942       residual = 1.86e+07           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       0.041693776191       residual = 7.25e+05           smallest_sin_value = 9.98e-01
davidson iteration   39 stopping due to too large eigenvalue change
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+11 is 5.178170e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.3087e+12, overlap shift 3.3087e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.741068948766       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.741068948766       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.741068948766       residual = 8.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.741068948766       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.741068948766       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.741070883204       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.741050381363       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.740511748898       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.733535139459       residual = 2.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745613940616       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.737084053857       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.729506589427       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.749493231862       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.740660022618       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.738355350651       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.742375809769       residual = 6.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.732226712710       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741364607110       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743614405137       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.738033002416       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.703167866932       residual = 7.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.701585842290       residual = 7.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.850132243936       residual = 2.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.581537976049       residual = 2.56e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.499355794783       residual = 1.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -4.166610130613       residual = 6.07e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       1.396617425943       residual = 3.30e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -2.186950929055       residual = 1.42e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.664014053870       residual = 2.45e+04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -5.040456074797       residual = 1.15e+05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       6.638075533711       residual = 5.89e+04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       0.886440568489       residual = 8.92e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -3.695486737834       residual = 1.36e+05           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 3.3087e+12 is 9.200148e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.727828 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0706e+01
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -22.6019
    reference variance = 0.468194
====================================================
  Execution time = 2.5448e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4594e-01
  Total weights = 1.9551e+06
  Execution time = 3.6261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437733657210
                                         uncertainty =       0.002201216803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437733657210
                                         uncertainty =       0.002201216803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467828411
  error estimate for blocks of size 2^( 2) =       0.000491797947
  error estimate for blocks of size 2^( 3) =       0.000513758051
  error estimate for blocks of size 2^( 4) =       0.000529638697
  error estimate for blocks of size 2^( 5) =       0.000538641892
  error estimate for blocks of size 2^( 6) =       0.000543598905
  error estimate for blocks of size 2^( 7) =       0.000546261652

      target function =      -0.748692470351
              le_mean =     -22.662721249943
             les_mean =     514.044871403190
             stat err =       0.000539535287
             autocorr =       1.330045569759
   target nu stat err =       0.000539535287
   target dn stat err =       0.002739813008
      target stat err =       0.002352154068
              std dev =       0.661609284252
             le_variance =       0.437726845008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437733657210
                                         uncertainty =       0.002201216803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437733657210
                                         uncertainty =       0.002201216803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467828411
  error estimate for blocks of size 2^( 2) =       0.000491797947
  error estimate for blocks of size 2^( 3) =       0.000513758051
  error estimate for blocks of size 2^( 4) =       0.000529638697
  error estimate for blocks of size 2^( 5) =       0.000538641892
  error estimate for blocks of size 2^( 6) =       0.000543598905
  error estimate for blocks of size 2^( 7) =       0.000546261652

      target function =      -0.748692470351
              le_mean =     -22.662721249943
             les_mean =     514.044871403190
             stat err =       0.000539535287
             autocorr =       1.330045569757
   target nu stat err =       0.000539535287
   target dn stat err =       0.002739813008
      target stat err =       0.002352154068
              std dev =       0.661609284252
             le_variance =       0.437726845008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437733657210
                                         uncertainty =       0.002201216803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437733657210
                                         uncertainty =       0.002201216803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467828411
  error estimate for blocks of size 2^( 2) =       0.000491797947
  error estimate for blocks of size 2^( 3) =       0.000513758051
  error estimate for blocks of size 2^( 4) =       0.000529638697
  error estimate for blocks of size 2^( 5) =       0.000538641892
  error estimate for blocks of size 2^( 6) =       0.000543598905
  error estimate for blocks of size 2^( 7) =       0.000546261652

      target function =      -0.748692470351
              le_mean =     -22.662721249943
             les_mean =     514.044871403190
             stat err =       0.000539535287
             autocorr =       1.330045569760
   target nu stat err =       0.000539535287
   target dn stat err =       0.002739813008
      target stat err =       0.002352154068
              std dev =       0.661609284252
             le_variance =       0.437726845008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437733657210
                                         uncertainty =       0.002201216803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437733657210
                                         uncertainty =       0.002201216803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467828411
  error estimate for blocks of size 2^( 2) =       0.000491797947
  error estimate for blocks of size 2^( 3) =       0.000513758051
  error estimate for blocks of size 2^( 4) =       0.000529638697
  error estimate for blocks of size 2^( 5) =       0.000538641892
  error estimate for blocks of size 2^( 6) =       0.000543598905
  error estimate for blocks of size 2^( 7) =       0.000546261652

      target function =      -0.748692470351
              le_mean =     -22.662721249943
             les_mean =     514.044871403190
             stat err =       0.000539535287
             autocorr =       1.330045569760
   target nu stat err =       0.000539535287
   target dn stat err =       0.002739813008
      target stat err =       0.002352154068
              std dev =       0.661609284252
             le_variance =       0.437726845008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.748692470351        initial
     2.0680e+11     2.0680e+12             1.9258e-15        -0.748692470351  <--
     8.2718e+11     8.2718e+12             5.1782e-16        -0.748692470351
     3.3087e+12     3.3087e+13             9.2001e-17        -0.748692470351

*****************************************************************************
Applying the update for shift_i =   2.0680e+11     and shift_s =   2.0680e+12
*****************************************************************************

  Execution time = 4.3658e+01
  </log>
  <optVariables href="FORM2.s096.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4370e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2658e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.6558
    reference variance = 0.277484
====================================================
  Execution time = 2.5918e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -2.2663e+01
  VMC Evar = 4.4943e-01
  Total weights = 1.954776989e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438999326500
                                         uncertainty =       0.002112879687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.438999326500
                                         uncertainty =       0.002112879687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468485512
  error estimate for blocks of size 2^( 2) =       0.000492556428
  error estimate for blocks of size 2^( 3) =       0.000514553250
  error estimate for blocks of size 2^( 4) =       0.000529784860
  error estimate for blocks of size 2^( 5) =       0.000538439495
  error estimate for blocks of size 2^( 6) =       0.000542231603
  error estimate for blocks of size 2^( 7) =       0.000544480586

      target function =      -0.745803291250
              le_mean =     -22.662502667768
             les_mean =     514.038452516550
             stat err =       0.000538734136
             autocorr =       1.322381180921
   target nu stat err =       0.000538734136
   target dn stat err =       0.003170586611
      target stat err =       0.002678241087
              std dev =       0.662538564914
             le_variance =       0.438957349998


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266250266777e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+10, overlap shift 5.1699e+11 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745812065391       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745812065391       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745812065391       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745812065391       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745812065391       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745814747581       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745792998165       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745759067096       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745796478029       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745881464683       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745834416531       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745786960841       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745840038259       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745668917696       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.745823700146       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745769138822       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745760774065       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.745596543015       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.746029330777       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.745789516031       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.746280567859       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.752302395800       residual = 4.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.747761048061       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.746856547264       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.746469118780       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.745567317251       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742241111209       residual = 6.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.743297353966       residual = 3.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.789821054675       residual = 5.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.741463712404       residual = 3.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.896297236969       residual = 6.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.842775624116       residual = 1.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.906470343271       residual = 6.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.200561087860       residual = 1.82e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.690086081243       residual = 6.91e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       4.312493013280       residual = 6.53e+05           smallest_sin_value = 1.00e+00
davidson iteration   36 stopping due to too large eigenvalue change
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+10 is 4.073439e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.0680e+11, overlap shift 2.0680e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745812065391       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745812065391       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745812065391       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745812065391       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745812065391       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745808492695       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745898494137       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.746424053018       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745796131045       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.745810788539       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745973963252       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744985761208       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.747241027208       residual = 7.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744979202603       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.743823912790       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747285073718       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746550438042       residual = 6.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.759694146470       residual = 6.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751092868368       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.746891982853       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.691643561793       residual = 5.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.855540520385       residual = 2.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.735969691151       residual = 7.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.168964031429       residual = 9.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.509018616969       residual = 3.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.900875327959       residual = 7.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -7.708266970219       residual = 2.83e+03           smallest_sin_value = 1.00e+00
davidson iteration   27 stopping due to too large eigenvalue change
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+11 is 1.031615e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.2718e+11, overlap shift 8.2718e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745812065391       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745812065391       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745812065391       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745812065391       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745812065391       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745812065391       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.746038752298       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745812065391       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.745812065391       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744368810287       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.749008016461       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745941565302       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744561422024       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.745884799640       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742527881210       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.747153633848       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.745343428975       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.744695707147       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743822745601       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.732066465447       residual = 6.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.754337601418       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.717682780858       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.767062601575       residual = 3.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.755042094599       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.769138044575       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.696673123091       residual = 5.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.762049075446       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -2.030974289363       residual = 1.32e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       0.051327850795       residual = 5.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -5.349060641323       residual = 5.91e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -8.586329293663       residual = 4.90e+05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =       3.324265411549       residual = 3.44e+06           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+11 is 2.567828e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.768922 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0696e+01
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -22.7513
    reference variance = 0.859188
====================================================
  Execution time = 2.5403e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5664e-01
  Total weights = 1.9553e+06
  Execution time = 3.6172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444930897220
                                         uncertainty =       0.002416822093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444930897220
                                         uncertainty =       0.002416822093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471663674
  error estimate for blocks of size 2^( 2) =       0.000495879097
  error estimate for blocks of size 2^( 3) =       0.000517732307
  error estimate for blocks of size 2^( 4) =       0.000533484561
  error estimate for blocks of size 2^( 5) =       0.000543077608
  error estimate for blocks of size 2^( 6) =       0.000548245892
  error estimate for blocks of size 2^( 7) =       0.000552198267

      target function =      -0.739904886707
              le_mean =     -22.661861966266
             les_mean =     514.016630464207
             stat err =       0.000544251582
             autocorr =       1.331479671833
   target nu stat err =       0.000544251582
   target dn stat err =       0.003442688560
      target stat err =       0.002851049415
              std dev =       0.667033165203
             le_variance =       0.444933243481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444930897220
                                         uncertainty =       0.002416822093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444930897220
                                         uncertainty =       0.002416822093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471663674
  error estimate for blocks of size 2^( 2) =       0.000495879097
  error estimate for blocks of size 2^( 3) =       0.000517732307
  error estimate for blocks of size 2^( 4) =       0.000533484561
  error estimate for blocks of size 2^( 5) =       0.000543077608
  error estimate for blocks of size 2^( 6) =       0.000548245892
  error estimate for blocks of size 2^( 7) =       0.000552198267

      target function =      -0.739904886707
              le_mean =     -22.661861966266
             les_mean =     514.016630464207
             stat err =       0.000544251582
             autocorr =       1.331479671833
   target nu stat err =       0.000544251582
   target dn stat err =       0.003442688560
      target stat err =       0.002851049415
              std dev =       0.667033165203
             le_variance =       0.444933243481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444930897220
                                         uncertainty =       0.002416822093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444930897220
                                         uncertainty =       0.002416822093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471663674
  error estimate for blocks of size 2^( 2) =       0.000495879097
  error estimate for blocks of size 2^( 3) =       0.000517732307
  error estimate for blocks of size 2^( 4) =       0.000533484561
  error estimate for blocks of size 2^( 5) =       0.000543077608
  error estimate for blocks of size 2^( 6) =       0.000548245892
  error estimate for blocks of size 2^( 7) =       0.000552198267

      target function =      -0.739904886707
              le_mean =     -22.661861966266
             les_mean =     514.016630464207
             stat err =       0.000544251582
             autocorr =       1.331479671833
   target nu stat err =       0.000544251582
   target dn stat err =       0.003442688560
      target stat err =       0.002851049415
              std dev =       0.667033165203
             le_variance =       0.444933243481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444930897220
                                         uncertainty =       0.002416822093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444930897220
                                         uncertainty =       0.002416822093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471663674
  error estimate for blocks of size 2^( 2) =       0.000495879097
  error estimate for blocks of size 2^( 3) =       0.000517732307
  error estimate for blocks of size 2^( 4) =       0.000533484561
  error estimate for blocks of size 2^( 5) =       0.000543077608
  error estimate for blocks of size 2^( 6) =       0.000548245892
  error estimate for blocks of size 2^( 7) =       0.000552198267

      target function =      -0.739904886707
              le_mean =     -22.661861966266
             les_mean =     514.016630464207
             stat err =       0.000544251582
             autocorr =       1.331479671834
   target nu stat err =       0.000544251582
   target dn stat err =       0.003442688560
      target stat err =       0.002851049415
              std dev =       0.667033165203
             le_variance =       0.444933243481


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.739904886707        initial  <--
     5.1699e+10     5.1699e+11             4.0734e-15        -0.739904886707
     2.0680e+11     2.0680e+12             1.0316e-15        -0.739904886707
     8.2718e+11     8.2718e+12             2.5678e-16        -0.739904886707

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.5357
  </log>
  <optVariables href="FORM2.s097.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.5715
    reference variance = 0.349888
====================================================
  Execution time = 2.5880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -2.2661e+01
  VMC Evar = 4.4995e-01
  Total weights = 1.955295505e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439735139438
                                         uncertainty =       0.002215522796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439735139438
                                         uncertainty =       0.002215522796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468868106
  error estimate for blocks of size 2^( 2) =       0.000492943919
  error estimate for blocks of size 2^( 3) =       0.000514733805
  error estimate for blocks of size 2^( 4) =       0.000530828276
  error estimate for blocks of size 2^( 5) =       0.000539955819
  error estimate for blocks of size 2^( 6) =       0.000544773368
  error estimate for blocks of size 2^( 7) =       0.000542784519

      target function =      -0.745360015581
              le_mean =     -22.661479151977
             les_mean =     513.992592167914
             stat err =       0.000539585495
             autocorr =       1.324399937016
   target nu stat err =       0.000539585495
   target dn stat err =       0.003006401683
      target stat err =       0.002539995613
              std dev =       0.663079633973
             le_variance =       0.439674600990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266147915198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.1699e+11, overlap shift 5.1699e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745367729127       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745367729127       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745367729127       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.745367729127       residual = 8.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745367729127       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.745367729127       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745367729127       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745367729127       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746278769115       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743687591809       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.745437578211       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.746642563960       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.745546885142       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.744747845613       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.744994543530       residual = 9.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745244906732       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.729601174014       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.749532562306       residual = 3.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.751609035246       residual = 3.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.726338424840       residual = 6.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.738635680653       residual = 2.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.755879100827       residual = 6.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.776917911634       residual = 5.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.542334887399       residual = 2.69e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       0.312782000102       residual = 2.86e+03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =       1.243650269222       residual = 1.56e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.912850313517       residual = 2.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.818092221249       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   28 stopping due to too large eigenvalue change
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+11 is 4.881312e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.0680e+12, overlap shift 2.0680e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745367729127       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745367729127       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.745367729127       residual = 8.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.746284933175       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.745536865428       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.747121368366       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.745591561898       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.745377184908       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.746066013405       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744147577532       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.747130849828       residual = 9.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.745693626683       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.744910193543       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.747235127810       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.748477394406       residual = 2.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.741121583012       residual = 4.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.748906902419       residual = 3.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.741663914547       residual = 4.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.745632934155       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.723821731691       residual = 7.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.694507589978       residual = 2.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.744975831874       residual = 5.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.873523677892       residual = 2.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.326152044082       residual = 1.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -3.832512403828       residual = 4.53e+04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -3.960710308942       residual = 3.46e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       0.614768769163       residual = 3.99e+05           smallest_sin_value = 1.00e+00
davidson iteration   27 stopping due to too large eigenvalue change
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+12 is 1.005503e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 8.2718e+12, overlap shift 8.2718e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.745367729127       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.745367729127       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.34e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 8.2718e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.787816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0648e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -22.7051
    reference variance = 0.327024
====================================================
  Execution time = 2.5150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5030e-01
  Total weights = 1.9550e+06
  Execution time = 3.6292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439662595896
                                         uncertainty =       0.002175983378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439662595896
                                         uncertainty =       0.002175983378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468859634
  error estimate for blocks of size 2^( 2) =       0.000492379563
  error estimate for blocks of size 2^( 3) =       0.000514028208
  error estimate for blocks of size 2^( 4) =       0.000528807896
  error estimate for blocks of size 2^( 5) =       0.000538145386
  error estimate for blocks of size 2^( 6) =       0.000544651484
  error estimate for blocks of size 2^( 7) =       0.000549800617

      target function =      -0.745083018491
              le_mean =     -22.661691509869
             les_mean =     514.002557611591
             stat err =       0.000540351346
             autocorr =       1.328210122479
   target nu stat err =       0.000540351346
   target dn stat err =       0.002833474333
      target stat err =       0.002401362500
              std dev =       0.663067653884
             le_variance =       0.439658713627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439662595896
                                         uncertainty =       0.002175983378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439662595896
                                         uncertainty =       0.002175983378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468859634
  error estimate for blocks of size 2^( 2) =       0.000492379563
  error estimate for blocks of size 2^( 3) =       0.000514028208
  error estimate for blocks of size 2^( 4) =       0.000528807896
  error estimate for blocks of size 2^( 5) =       0.000538145386
  error estimate for blocks of size 2^( 6) =       0.000544651484
  error estimate for blocks of size 2^( 7) =       0.000549800617

      target function =      -0.745083018491
              le_mean =     -22.661691509869
             les_mean =     514.002557611591
             stat err =       0.000540351346
             autocorr =       1.328210122480
   target nu stat err =       0.000540351346
   target dn stat err =       0.002833474333
      target stat err =       0.002401362500
              std dev =       0.663067653884
             le_variance =       0.439658713627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439662595896
                                         uncertainty =       0.002175983378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439662595896
                                         uncertainty =       0.002175983378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468859634
  error estimate for blocks of size 2^( 2) =       0.000492379563
  error estimate for blocks of size 2^( 3) =       0.000514028208
  error estimate for blocks of size 2^( 4) =       0.000528807896
  error estimate for blocks of size 2^( 5) =       0.000538145386
  error estimate for blocks of size 2^( 6) =       0.000544651484
  error estimate for blocks of size 2^( 7) =       0.000549800617

      target function =      -0.745083018491
              le_mean =     -22.661691509869
             les_mean =     514.002557611591
             stat err =       0.000540351346
             autocorr =       1.328210122482
   target nu stat err =       0.000540351346
   target dn stat err =       0.002833474333
      target stat err =       0.002401362500
              std dev =       0.663067653884
             le_variance =       0.439658713627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439662595896
                                         uncertainty =       0.002175983378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.439662595896
                                         uncertainty =       0.002175983378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000468859634
  error estimate for blocks of size 2^( 2) =       0.000492379563
  error estimate for blocks of size 2^( 3) =       0.000514028208
  error estimate for blocks of size 2^( 4) =       0.000528807896
  error estimate for blocks of size 2^( 5) =       0.000538145386
  error estimate for blocks of size 2^( 6) =       0.000544651484
  error estimate for blocks of size 2^( 7) =       0.000549800617

      target function =      -0.745083018491
              le_mean =     -22.661691509869
             les_mean =     514.002557611591
             stat err =       0.000540351346
             autocorr =       1.328210122479
   target nu stat err =       0.000540351346
   target dn stat err =       0.002833474333
      target stat err =       0.002401362500
              std dev =       0.663067653884
             le_variance =       0.439658713627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.745083018491        initial
     5.1699e+11     5.1699e+12             4.8813e-16        -0.745083018491  <--
     2.0680e+12     2.0680e+13             1.0055e-16        -0.745083018491
     8.2718e+12     8.2718e+13             0.0000e+00        -0.745083018491

*****************************************************************************
Applying the update for shift_i =   5.1699e+11     and shift_s =   5.1699e+12
*****************************************************************************

  Execution time = 4.3384e+01
  </log>
  <optVariables href="FORM2.s098.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.4038e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM2.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM2.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2659e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 29288 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.6765
    reference variance = 0.393978
====================================================
  Execution time = 2.7231e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM2.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.5253e-01
  Total weights = 1.955189157e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 4.7901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444257398928
                                         uncertainty =       0.002505782819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.444257398928
                                         uncertainty =       0.002505782819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000471286513
  error estimate for blocks of size 2^( 2) =       0.000494622568
  error estimate for blocks of size 2^( 3) =       0.000517028666
  error estimate for blocks of size 2^( 4) =       0.000532388285
  error estimate for blocks of size 2^( 5) =       0.000541476760
  error estimate for blocks of size 2^( 6) =       0.000547574541
  error estimate for blocks of size 2^( 7) =       0.000548696275

      target function =      -0.743256654777
              le_mean =     -22.662007443943
             les_mean =     514.019107660936
             stat err =       0.000542533965
             autocorr =       1.325207367705
   target nu stat err =       0.000542533965
   target dn stat err =       0.003037167982
      target stat err =       0.002553255749
              std dev =       0.666499778143
             le_variance =       0.444221954265


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.266200744394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 76
Check correct_vf_var_size: 231, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.2925e+11, overlap shift 1.2925e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743264456580       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743264456580       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743264456580       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743264456580       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743264456580       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743264456582       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743264534270       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743209424909       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743241229294       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.743112538816       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743115593598       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743556055039       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743150745103       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.742888379105       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742838558618       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.743231191858       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.743448686216       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743273204048       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.742884135353       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743336316989       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.743595446194       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.741957616186       residual = 7.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.746966920947       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.743476723320       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.739185414085       residual = 6.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.743599164025       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.757745527842       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.725012047354       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.745465373371       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.751729610124       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.782067976136       residual = 3.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.978061311032       residual = 4.00e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.866405118625       residual = 5.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 1.2925e+11 is 1.846599e-15

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.1699e+11, overlap shift 5.1699e+12 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743264456580       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743264456580       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743264456580       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743264456580       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743264456266       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743264456581       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743264457211       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.743304200320       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.743275998247       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.742717438247       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.743346269422       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.743064364785       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743296942790       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.743114737319       residual = 9.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.742662178914       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.745373586278       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.742974572626       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.743054287336       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.743761886223       residual = 9.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.743586210906       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.731502994161       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.743825039177       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.742691395804       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747005739645       residual = 5.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.748102304607       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.737536818120       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.736732661257       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745448810561       residual = 8.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.743414255969       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.745581231297       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.742535454618       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.745020664420       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.747367765162       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.745880437302       residual = 2.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.744997422366       residual = 4.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.744936070059       residual = 3.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.749447268186       residual = 4.02e-02           smallest_sin_value = 9.99e-01
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.732463488191       residual = 3.58e-02           smallest_sin_value = 9.96e-01
davidson iteration   38 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 5.1699e+11 is 4.590354e-16

solving harmonic davidson linear method for identity shift 2.0680e+12, overlap shift 2.0680e+13 and omega -2.3338e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.743264456580       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.743264456580       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.743264456580       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.743264456580       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.743264456580       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.743264455874       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.743264417681       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.742855710777       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.740952409554       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.744380096030       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.744575451878       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.744215066504       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.743431823383       residual = 4.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.734943165136       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.731530507955       residual = 3.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.735710055981       residual = 6.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.766364916044       residual = 8.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.770410952142       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.772843536932       residual = 1.47e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.741570116474       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.745330953487       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.747025212280       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.741388773896       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.752091051226       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.744292567671       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.747888127861       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.742150991573       residual = 4.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.745774190489       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.582311344509       residual = 3.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   29 stopping due to too large eigenvalue change
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 77 and evec_eigen.size(): 77
The largest weight on the derivative vector for shift 2.0680e+12 is 1.141940e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.834608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 77 and numParams is: 76

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.2073e+01
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -22.613
    reference variance = 0.327988
====================================================
  Execution time = 2.5085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM2.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2662e+01
  VMC Evar = 4.4532e-01
  Total weights = 1.9555e+06
  Execution time = 3.5693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437296740736
                                         uncertainty =       0.001920105758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437296740736
                                         uncertainty =       0.001920105758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467605558
  error estimate for blocks of size 2^( 2) =       0.000491748630
  error estimate for blocks of size 2^( 3) =       0.000513774340
  error estimate for blocks of size 2^( 4) =       0.000530140786
  error estimate for blocks of size 2^( 5) =       0.000539573400
  error estimate for blocks of size 2^( 6) =       0.000546286913
  error estimate for blocks of size 2^( 7) =       0.000545515577

      target function =      -0.749198590878
              le_mean =     -22.662242639122
             les_mean =     514.022564765851
             stat err =       0.000540379169
             autocorr =       1.335481477390
   target nu stat err =       0.000540379169
   target dn stat err =       0.002166636743
      target stat err =       0.001897166154
              std dev =       0.661294122004
             le_variance =       0.437309915797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437296740736
                                         uncertainty =       0.001920105758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437296740736
                                         uncertainty =       0.001920105758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467605558
  error estimate for blocks of size 2^( 2) =       0.000491748630
  error estimate for blocks of size 2^( 3) =       0.000513774340
  error estimate for blocks of size 2^( 4) =       0.000530140786
  error estimate for blocks of size 2^( 5) =       0.000539573400
  error estimate for blocks of size 2^( 6) =       0.000546286913
  error estimate for blocks of size 2^( 7) =       0.000545515577

      target function =      -0.749198590878
              le_mean =     -22.662242639122
             les_mean =     514.022564765851
             stat err =       0.000540379169
             autocorr =       1.335481477384
   target nu stat err =       0.000540379169
   target dn stat err =       0.002166636743
      target stat err =       0.001897166154
              std dev =       0.661294122004
             le_variance =       0.437309915797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437296740736
                                         uncertainty =       0.001920105758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437296740736
                                         uncertainty =       0.001920105758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467605558
  error estimate for blocks of size 2^( 2) =       0.000491748630
  error estimate for blocks of size 2^( 3) =       0.000513774340
  error estimate for blocks of size 2^( 4) =       0.000530140786
  error estimate for blocks of size 2^( 5) =       0.000539573400
  error estimate for blocks of size 2^( 6) =       0.000546286913
  error estimate for blocks of size 2^( 7) =       0.000545515577

      target function =      -0.749198590878
              le_mean =     -22.662242639122
             les_mean =     514.022564765851
             stat err =       0.000540379169
             autocorr =       1.335481477393
   target nu stat err =       0.000540379169
   target dn stat err =       0.002166636743
      target stat err =       0.001897166154
              std dev =       0.661294122004
             le_variance =       0.437309915797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437296740736
                                         uncertainty =       0.001920105758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.437296740736
                                         uncertainty =       0.001920105758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000467605558
  error estimate for blocks of size 2^( 2) =       0.000491748630
  error estimate for blocks of size 2^( 3) =       0.000513774340
  error estimate for blocks of size 2^( 4) =       0.000530140786
  error estimate for blocks of size 2^( 5) =       0.000539573400
  error estimate for blocks of size 2^( 6) =       0.000546286913
  error estimate for blocks of size 2^( 7) =       0.000545515577

      target function =      -0.749198590878
              le_mean =     -22.662242639122
             les_mean =     514.022564765851
             stat err =       0.000540379169
             autocorr =       1.335481477390
   target nu stat err =       0.000540379169
   target dn stat err =       0.002166636743
      target stat err =       0.001897166154
              std dev =       0.661294122004
             le_variance =       0.437309915797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.749198590878        initial  <--
     1.2925e+11     1.2925e+12             1.8466e-15        -0.749198590878
     5.1699e+11     5.1699e+12             4.5904e-16        -0.749198590878
     2.0680e+12     2.0680e+13             1.1419e-16        -0.749198590878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 43.0648
  </log>
  <optVariables href="FORM2.s099.opt.xml">
ci_001                -7.054733e-01 3 1  ON 0
ci_002                -7.030160e-01 3 1  ON 1
ci_003                -4.996657e-02 3 1  ON 2
ci_004                -5.097972e-02 3 1  ON 3
ci_005                 1.954875e-02 3 1  ON 4
ci_006                 1.990995e-02 3 1  ON 5
ci_007                 1.473749e-02 3 1  ON 6
ci_008                 1.564528e-02 3 1  ON 7
ci_009                -1.331662e-02 3 1  ON 8
ci_010                -1.213846e-02 3 1  ON 9
ci_011                -9.956742e-03 3 1  ON 10
ci_012                -9.107654e-03 3 1  ON 11
ci_013                 8.438012e-03 3 1  ON 12
ci_014                 9.446952e-03 3 1  ON 13
ci_015                 9.575635e-03 3 1  ON 14
ci_016                 9.511632e-03 3 1  ON 15
ci_017                 8.538158e-03 3 1  ON 16
ci_018                 8.364775e-03 3 1  ON 17
ci_019                -1.040060e-03 3 1  ON 18
ci_020                -1.340465e-03 3 1  ON 19
ci_021                -1.174246e-02 3 1  ON 20
ci_022                -1.169179e-02 3 1  ON 21
ci_023                 4.843386e-03 3 1  ON 22
ci_024                 4.944675e-03 3 1  ON 23
ci_025                 1.132062e-02 3 1  ON 24
ci_026                 1.141549e-02 3 1  ON 25
ci_027                 6.499821e-03 3 1  ON 26
ci_028                 6.245468e-03 3 1  ON 27
ci_029                -5.170459e-03 3 1  ON 28
ci_030                -4.217478e-03 3 1  ON 29
ci_031                 3.244242e-03 3 1  ON 30
ci_032                 4.393119e-03 3 1  ON 31
ci_033                 2.345208e-03 3 1  ON 32
ci_034                 4.175234e-03 3 1  ON 33
ci_035                 1.734773e-03 3 1  ON 34
ci_036                 2.193725e-03 3 1  ON 35
ci_037                 3.588198e-03 3 1  ON 36
ci_038                 3.702672e-03 3 1  ON 37
ci_039                 4.647467e-03 3 1  ON 38
ci_040                 4.988043e-03 3 1  ON 39
ci_041                 2.976336e-03 3 1  ON 40
ci_042                 2.735569e-03 3 1  ON 41
ci_043                 3.001555e-03 3 1  ON 42
ci_044                 3.197894e-03 3 1  ON 43
ci_045                 2.444172e-03 3 1  ON 44
ci_046                 2.684872e-03 3 1  ON 45
ci_047                -9.994619e-04 3 1  ON 46
ci_048                -8.375265e-04 3 1  ON 47
ci_049                 7.413377e-04 3 1  ON 48
ci_050                 1.074586e-03 3 1  ON 49
ci_051                -2.775489e-04 3 1  ON 50
ci_052                -1.208322e-03 3 1  ON 51
ci_053                -2.420271e-03 3 1  ON 52
ci_054                -2.639465e-03 3 1  ON 53
ci_055                -1.826578e-03 3 1  ON 54
ci_056                -1.960092e-03 3 1  ON 55
ci_057                -1.314460e-03 3 1  ON 56
ci_058                -9.790931e-04 3 1  ON 57
ci_059                -5.693721e-04 3 1  ON 58
ci_060                -7.765432e-04 3 1  ON 59
ci_061                -6.901969e-05 3 1  ON 60
ci_062                -9.469609e-04 3 1  ON 61
ci_063                -8.852748e-04 3 1  ON 62
ci_064                -5.148438e-04 3 1  ON 63
ci_065                -1.334472e-03 3 1  ON 64
ci_066                -1.932867e-03 3 1  ON 65
ci_067                -1.805299e-03 3 1  ON 66
ci_068                -1.576090e-03 3 1  ON 67
ci_069                -5.732174e-04 3 1  ON 68
ci_070                -4.401884e-04 3 1  ON 69
ci_071                -2.077525e-03 3 1  ON 70
ci_072                -1.995161e-03 3 1  ON 71
ci_073                 1.602354e-04 3 1  ON 72
ci_074                 2.017442e-04 3 1  ON 73
ci_075                 1.521048e-04 3 1  ON 74
ci_076                 8.314496e-04 3 1  ON 75
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.5155e+01 secs
  Total Execution time = 7.5460e+03 secs

=========================================================
  A new xml input file : FORM2.s099.cont.xml
